import{g as Ns,c as ne,r as $t,j as ht,d as Li,u as _i,e as ro,F as Fs,f as Rs,v as oo,B as Ln,A as ao,P as ls,h as ze,T as $s,i as lo,k as co,l as Bs,m as uo,n as ho,o as po,G as qs,p as fo,q as go,s as mo,M as vo,t as ei,C as yo,S as bo,L as xo,E as wo,N as So,w as cs,x as Eo,y as us,z as Co,D as _o,H as ae,I as ji,Q as Mi,J as Ii,K as Po,O as ko,U as Ao,V as Do,W as To,X as ds,Y as Oo,Z as Lo,_ as jo,$ as Mo,a0 as bi,a1 as Io,a2 as No,a3 as Fo,a4 as hs,a5 as Ro,a6 as jn,a7 as $o,a8 as zs,a9 as Pi,aa as be,ab as Bo,R as ps,ac as qo,ad as Ve,ae as zo,af as Vo,ag as ri,ah as oi,ai as fs,aj as Vs,ak as ai,al as Uo,am as ni,an as gs,ao as Ho,ap as Go,aq as ii,ar as Yo,as as Wo,at as Us,au as Xo,av as Ko,aw as An,ax as Wn,ay as Xn,az as ms,aA as Jo,aB as Zo,aC as Qo,aD as ta,aE as ea,aF as na,aG as ia,aH as We,aI as sa,aJ as ra,aK as oa,aL as aa,aM as le,aN as vs}from"./app.bundle.min.js";import*as vn from"@radix-ui/react-tabs";import"lodash";import"@radix-ui/react-slot";import"@radix-ui/react-select";import"@radix-ui/react-checkbox";import"@radix-ui/react-label";import"zod";import"@radix-ui/react-switch";import"date-fns";import"ag-grid-community/styles/ag-grid.css";import"ag-grid-community/styles/ag-theme-quartz.css";import"react-router";class mn extends Error{constructor(i,e){super("".concat(i," at position ").concat(e)),this.position=e}}const Hs=32,la=10,Gs=9,Ys=13,ca=160,ua=8192,da=8202,ha=8239,pa=8287,fa=12288;function ga(a){return/^[0-9A-Fa-f]$/.test(a)}function un(a){return a>="0"&&a<="9"}function ma(a){return a>=" "}function Kn(a){return`,:[]/{}()
+`.includes(a)}function ys(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"||a==="_"||a==="$"}function bs(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"||a==="_"||a==="$"||a>="0"&&a<="9"}const xs=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,ws=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function Ss(a){return`,[]/{}
+`.includes(a)}function Es(a){return si(a)||va.test(a)}const va=/^[[{\w-]$/;function ya(a){return a===`
`||a==="\r"||a==="	"||a==="\b"||a==="\f"}function dn(a,i){const e=a.charCodeAt(i);return e===Hs||e===la||e===Gs||e===Ys}function ba(a,i){const e=a.charCodeAt(i);return e===Hs||e===Gs||e===Ys}function xa(a,i){const e=a.charCodeAt(i);return e===ca||e>=ua&&e<=da||e===ha||e===pa||e===fa}function si(a){return Ws(a)||ki(a)}function Ws(a){return a==='"'||a==="\u201C"||a==="\u201D"}function Cs(a){return a==='"'}function ki(a){return a==="'"||a==="\u2018"||a==="\u2019"||a==="`"||a==="\xB4"}function _s(a){return a==="'"}function Pn(a,i){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=a.lastIndexOf(i);return d!==-1?a.substring(0,d)+(e?"":a.substring(d+1)):a}function $e(a,i){let e=a.length;if(!dn(a,e-1))return a+i;for(;dn(a,e-1);)e--;return a.substring(0,e)+i+a.substring(e)}function wa(a,i,e){return a.substring(0,i)+a.substring(i+e)}function Sa(a){return/[,\n][ \t\r]*$/.test(a)}const Ea={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},Ca={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function Xs(a){let i=0,e="";u(),g()||W(),u();const w=r(",");for(w&&S(),Es(a[i])&&Sa(e)?(w||(e=$e(e,",")),c()):w&&(e=Pn(e,","));a[i]==="}"||a[i]==="]";)i++,S();if(i>=a.length)return e;C();function g(){S();const q=D()||y()||F()||B()||M()||I(!1)||l();return S(),q}function S(){let q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const tt=i;let K=o(q);do K=v(),K&&(K=o(q));while(K);return i>tt}function o(q){const tt=q?dn:ba;let K="";for(;;)if(tt(a,i))K+=a[i],i++;else if(xa(a,i))K+=" ",i++;else break;return K.length>0?(e+=K,!0):!1}function v(){if(a[i]==="/"&&a[i+1]==="*"){for(;i<a.length&&!_a(a,i);)i++;return i+=2,!0}if(a[i]==="/"&&a[i+1]==="/"){for(;i<a.length&&a[i]!==`
`;)i++;return!0}return!1}function u(){if(a.slice(i,i+3)==="```"){if(i+=3,ys(a[i]))for(;i<a.length&&bs(a[i]);)i++;return S(),!0}return!1}function r(q){return a[i]===q?(e+=a[i],i++,!0):!1}function m(q){return a[i]===q?(i++,!0):!1}function E(){return m("\\")}function O(){return S(),a[i]==="."&&a[i+1]==="."&&a[i+2]==="."?(i+=3,S(),m(","),!0):!1}function D(){if(a[i]==="{"){e+="{",i++,S(),m(",")&&S();let q=!0;for(;i<a.length&&a[i]!=="}";){let tt;if(q?(tt=!0,q=!1):(tt=r(","),tt||(e=$e(e,",")),S()),O(),!(F()||I(!0))){a[i]==="}"||a[i]==="{"||a[i]==="]"||a[i]==="["||a[i]===void 0?e=Pn(e,","):V();break}S();const rt=r(":"),f=i>=a.length;rt||(Es(a[i])||f?e=$e(e,":"):Y()),g()||(rt||f?e+="null":Y())}return a[i]==="}"?(e+="}",i++):e=$e(e,"}"),!0}return!1}function y(){if(a[i]==="["){e+="[",i++,S(),m(",")&&S();let q=!0;for(;i<a.length&&a[i]!=="]";)if(q?q=!1:r(",")||(e=$e(e,",")),O(),!g()){e=Pn(e,",");break}return a[i]==="]"?(e+="]",i++):e=$e(e,"]"),!0}return!1}function c(){let q=!0,tt=!0;for(;tt;)q?q=!1:r(",")||(e=$e(e,",")),tt=g();tt||(e=Pn(e,",")),e=`[
`.concat(e,`
]`)}function F(){let q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,K=a[i]==="\\";if(K&&(i++,K=!0),si(a[i])){const rt=Cs(a[i])?Cs:_s(a[i])?_s:ki(a[i])?ki:Ws,f=i,_=e.length;let h='"';for(i++;;){if(i>=a.length){const N=T(i-1);return!q&&Kn(a.charAt(N))?(i=f,e=e.substring(0,_),F(!0)):(h=$e(h,'"'),e+=h,!0)}else{if(i===tt)return h=$e(h,'"'),e+=h,!0;if(rt(a[i])){const N=i,z=h.length;if(h+='"',i++,e+=h,S(!1),q||i>=a.length||Kn(a[i])||si(a[i])||un(a[i]))return k(),!0;const U=T(N-1),nt=a.charAt(U);if(nt===",")return i=f,e=e.substring(0,_),F(!1,U);if(Kn(nt))return i=f,e=e.substring(0,_),F(!0);e=e.substring(0,_),i=N+1,h="".concat(h.substring(0,z),"\\").concat(h.substring(z))}else if(q&&Ss(a[i])){if(a[i-1]===":"&&xs.test(a.substring(f+1,i+2)))for(;i<a.length&&ws.test(a[i]);)h+=a[i],i++;return h=$e(h,'"'),e+=h,k(),!0}else if(a[i]==="\\"){const N=a.charAt(i+1);if(Ca[N]!==void 0)h+=a.slice(i,i+2),i+=2;else if(N==="u"){let U=2;for(;U<6&&ga(a[i+U]);)U++;U===6?(h+=a.slice(i,i+6),i+=6):i+U>=a.length?i=a.length:L()}else h+=N,i+=2}else{const N=a.charAt(i);N==='"'&&a[i-1]!=="\\"?(h+="\\".concat(N),i++):ya(N)?(h+=Ea[N],i++):(ma(N)||G(N),h+=N,i++)}}K&&E()}}return!1}function k(){let q=!1;for(S();a[i]==="+";){q=!0,i++,S(),e=Pn(e,'"',!0);const tt=e.length;F()?e=wa(e,tt,1):e=$e(e,'"')}return q}function B(){const q=i;if(a[i]==="-"){if(i++,x())return R(q),!0;if(!un(a[i]))return i=q,!1}for(;un(a[i]);)i++;if(a[i]==="."){if(i++,x())return R(q),!0;if(!un(a[i]))return i=q,!1;for(;un(a[i]);)i++}if(a[i]==="e"||a[i]==="E"){if(i++,(a[i]==="-"||a[i]==="+")&&i++,x())return R(q),!0;if(!un(a[i]))return i=q,!1;for(;un(a[i]);)i++}if(!x())return i=q,!1;if(i>q){const tt=a.slice(q,i),K=/^0\d/.test(tt);return e+=K?'"'.concat(tt,'"'):tt,!0}return!1}function M(){return A("true","true")||A("false","false")||A("null","null")||A("True","true")||A("False","false")||A("None","null")}function A(q,tt){return a.slice(i,i+q.length)===q?(e+=tt,i+=q.length,!0):!1}function I(q){const tt=i;if(ys(a[i])){for(;i<a.length&&bs(a[i]);)i++;let K=i;for(;dn(a,K);)K++;if(a[K]==="(")return i=K+1,g(),a[i]===")"&&(i++,a[i]===";"&&i++),!0}for(;i<a.length&&!Ss(a[i])&&!si(a[i])&&(!q||a[i]!==":");)i++;if(a[i-1]===":"&&xs.test(a.substring(tt,i+2)))for(;i<a.length&&ws.test(a[i]);)i++;if(i>tt){for(;dn(a,i-1)&&i>0;)i--;const K=a.slice(tt,i);return e+=K==="undefined"?"null":JSON.stringify(K),a[i]==='"'&&i++,!0}}function l(){if(a[i]==="/"){const q=i;for(i++;i<a.length&&(a[i]!=="/"||a[i-1]==="\\");)i++;return i++,e+='"'.concat(a.substring(q,i),'"'),!0}}function T(q){let tt=q;for(;tt>0&&dn(a,tt);)tt--;return tt}function x(){return i>=a.length||Kn(a[i])||dn(a,i)}function R(q){e+="".concat(a.slice(q,i),"0")}function G(q){throw new mn("Invalid character ".concat(JSON.stringify(q)),i)}function C(){throw new mn("Unexpected character ".concat(JSON.stringify(a[i])),i)}function W(){throw new mn("Unexpected end of json string",a.length)}function V(){throw new mn("Object key expected",i)}function Y(){throw new mn("Colon expected",i)}function L(){const q=a.slice(i,i+6);throw new mn('Invalid unicode character "'.concat(q,'"'),i)}}function _a(a,i){return a[i]==="*"&&a[i+1]==="/"}class Ks{static send(i,e){let d=typeof i=="string"?i:JSON.stringify(i);const w=e.includes("all");(w||e.includes("chatbot"))&&this.sendChatbotMsg(d),(w||e.includes("swagger"))&&this.sendSwaggerMsg(d)}static sendChatbotMsg(i){const e=document.querySelector("#chatbot-iframe");e&&e.contentWindow.postMessage(i,"*")}static sendSwaggerMsg(i){const e=document.querySelector("#swagger-iframe");e&&e.contentWindow.postMessage(i,"*")}}var li={exports:{}};li.exports;(function(a,i){(function(e,d){a.exports=d()})(ne,function(){function e(n,t){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(n);t&&(p=p.filter(function(b){return Object.getOwnPropertyDescriptor(n,b).enumerable})),s.push.apply(s,p)}return s}function d(n){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?e(Object(s),!0).forEach(function(p){v(n,p,s[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach(function(p){Object.defineProperty(n,p,Object.getOwnPropertyDescriptor(s,p))})}return n}function w(n){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(n)}function g(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function S(n,t){for(var s=0;s<t.length;s++){var p=t[s];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(n,y(p.key),p)}}function o(n,t,s){return t&&S(n.prototype,t),s&&S(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function v(n,t,s){return(t=y(t))in n?Object.defineProperty(n,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[t]=s,n}function u(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&m(n,t)}function r(n){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(n)}function m(n,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,p){return s.__proto__=p,s},m(n,t)}function E(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function O(n){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var s,p=r(n);if(t){var b=r(this).constructor;s=Reflect.construct(p,arguments,b)}else s=p.apply(this,arguments);return function(j,H){if(H&&(typeof H=="object"||typeof H=="function"))return H;if(H!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(j)}(this,s)}}function D(){return D=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,t,s){var p=function(j,H){for(;!Object.prototype.hasOwnProperty.call(j,H)&&(j=r(j))!==null;);return j}(n,t);if(p){var b=Object.getOwnPropertyDescriptor(p,t);return b.get?b.get.call(arguments.length<3?n:s):b.value}},D.apply(this,arguments)}function y(n){var t=function(s,p){if(typeof s!="object"||s===null)return s;var b=s[Symbol.toPrimitive];if(b!==void 0){var j=b.call(s,p||"default");if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(s)}(n,"string");return typeof t=="symbol"?t:t+""}var c=function(n){return!(!n||!n.Window)&&n instanceof n.Window},F=void 0,k=void 0;function B(n){F=n;var t=n.document.createTextNode("");t.ownerDocument!==n.document&&typeof n.wrap=="function"&&n.wrap(t)===t&&(n=n.wrap(n)),k=n}function M(n){return c(n)?n:(n.ownerDocument||n).defaultView||k.window}typeof window<"u"&&window&&B(window);var A=function(n){return!!n&&w(n)==="object"},I=function(n){return typeof n=="function"},l={window:function(n){return n===k||c(n)},docFrag:function(n){return A(n)&&n.nodeType===11},object:A,func:I,number:function(n){return typeof n=="number"},bool:function(n){return typeof n=="boolean"},string:function(n){return typeof n=="string"},element:function(n){if(!n||w(n)!=="object")return!1;var t=M(n)||k;return/object|function/.test(typeof Element>"u"?"undefined":w(Element))?n instanceof Element||n instanceof t.Element:n.nodeType===1&&typeof n.nodeName=="string"},plainObject:function(n){return A(n)&&!!n.constructor&&/function Object\b/.test(n.constructor.toString())},array:function(n){return A(n)&&n.length!==void 0&&I(n.splice)}};function T(n){var t=n.interaction;if(t.prepared.name==="drag"){var s=t.prepared.axis;s==="x"?(t.coords.cur.page.y=t.coords.start.page.y,t.coords.cur.client.y=t.coords.start.client.y,t.coords.velocity.client.y=0,t.coords.velocity.page.y=0):s==="y"&&(t.coords.cur.page.x=t.coords.start.page.x,t.coords.cur.client.x=t.coords.start.client.x,t.coords.velocity.client.x=0,t.coords.velocity.page.x=0)}}function x(n){var t=n.iEvent,s=n.interaction;if(s.prepared.name==="drag"){var p=s.prepared.axis;if(p==="x"||p==="y"){var b=p==="x"?"y":"x";t.page[b]=s.coords.start.page[b],t.client[b]=s.coords.start.client[b],t.delta[b]=0}}}var R={id:"actions/drag",install:function(n){var t=n.actions,s=n.Interactable,p=n.defaults;s.prototype.draggable=R.draggable,t.map.drag=R,t.methodDict.drag="draggable",p.actions.drag=R.defaults},listeners:{"interactions:before-action-move":T,"interactions:action-resume":T,"interactions:action-move":x,"auto-start:check":function(n){var t=n.interaction,s=n.interactable,p=n.buttons,b=s.options.drag;if(b&&b.enabled&&(!t.pointerIsDown||!/mouse|pointer/.test(t.pointerType)||p&s.options.drag.mouseButtons))return n.action={name:"drag",axis:b.lockAxis==="start"?b.startAxis:b.lockAxis},!1}},draggable:function(n){return l.object(n)?(this.options.drag.enabled=n.enabled!==!1,this.setPerAction("drag",n),this.setOnEvents("drag",n),/^(xy|x|y|start)$/.test(n.lockAxis)&&(this.options.drag.lockAxis=n.lockAxis),/^(xy|x|y)$/.test(n.startAxis)&&(this.options.drag.startAxis=n.startAxis),this):l.bool(n)?(this.options.drag.enabled=n,this):this.options.drag},beforeMove:T,move:x,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(n){return n.search("drag")===0}},G=R,C={init:function(n){var t=n;C.document=t.document,C.DocumentFragment=t.DocumentFragment||W,C.SVGElement=t.SVGElement||W,C.SVGSVGElement=t.SVGSVGElement||W,C.SVGElementInstance=t.SVGElementInstance||W,C.Element=t.Element||W,C.HTMLElement=t.HTMLElement||C.Element,C.Event=t.Event,C.Touch=t.Touch||W,C.PointerEvent=t.PointerEvent||t.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function W(){}var V=C,Y={init:function(n){var t=V.Element,s=n.navigator||{};Y.supportsTouch="ontouchstart"in n||l.func(n.DocumentTouch)&&V.document instanceof n.DocumentTouch,Y.supportsPointerEvent=s.pointerEnabled!==!1&&!!V.PointerEvent,Y.isIOS=/iP(hone|od|ad)/.test(s.platform),Y.isIOS7=/iP(hone|od|ad)/.test(s.platform)&&/OS 7[^\d]/.test(s.appVersion),Y.isIe9=/MSIE 9/.test(s.userAgent),Y.isOperaMobile=s.appName==="Opera"&&Y.supportsTouch&&/Presto/.test(s.userAgent),Y.prefixedMatchesSelector="matches"in t.prototype?"matches":"webkitMatchesSelector"in t.prototype?"webkitMatchesSelector":"mozMatchesSelector"in t.prototype?"mozMatchesSelector":"oMatchesSelector"in t.prototype?"oMatchesSelector":"msMatchesSelector",Y.pEventTypes=Y.supportsPointerEvent?V.PointerEvent===n.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,Y.wheelEvent=V.document&&"onmousewheel"in V.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},L=Y;function q(n,t){if(n.contains)return n.contains(t);for(;t;){if(t===n)return!0;t=t.parentNode}return!1}function tt(n,t){for(;l.element(n);){if(rt(n,t))return n;n=K(n)}return null}function K(n){var t=n.parentNode;if(l.docFrag(t)){for(;(t=t.host)&&l.docFrag(t););return t}return t}function rt(n,t){return k!==F&&(t=t.replace(/\/deep\//g," ")),n[L.prefixedMatchesSelector](t)}var f=function(n){return n.parentNode||n.host};function _(n,t){for(var s,p=[],b=n;(s=f(b))&&b!==t&&s!==b.ownerDocument;)p.unshift(b),b=s;return p}function h(n,t,s){for(;l.element(n);){if(rt(n,t))return!0;if((n=K(n))===s)return rt(n,t)}return!1}function N(n){return n.correspondingUseElement||n}function z(n){var t=n instanceof V.SVGElement?n.getBoundingClientRect():n.getClientRects()[0];return t&&{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width||t.right-t.left,height:t.height||t.bottom-t.top}}function U(n){var t,s=z(n);if(!L.isIOS7&&s){var p={x:(t=(t=M(n))||k).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop};s.left+=p.x,s.right+=p.x,s.top+=p.y,s.bottom+=p.y}return s}function nt(n){for(var t=[];n;)t.push(n),n=K(n);return t}function ot(n){return!!l.string(n)&&(V.document.querySelector(n),!0)}function Z(n,t){for(var s in t)n[s]=t[s];return n}function ut(n,t,s){return n==="parent"?K(s):n==="self"?t.getRect(s):tt(s,n)}function dt(n,t,s,p){var b=n;return l.string(b)?b=ut(b,t,s):l.func(b)&&(b=b.apply(void 0,p)),l.element(b)&&(b=U(b)),b}function ft(n){return n&&{x:"x"in n?n.x:n.left,y:"y"in n?n.y:n.top}}function ct(n){return!n||"x"in n&&"y"in n||((n=Z({},n)).x=n.left||0,n.y=n.top||0,n.width=n.width||(n.right||0)-n.x,n.height=n.height||(n.bottom||0)-n.y),n}function xt(n,t,s){n.left&&(t.left+=s.x),n.right&&(t.right+=s.x),n.top&&(t.top+=s.y),n.bottom&&(t.bottom+=s.y),t.width=t.right-t.left,t.height=t.bottom-t.top}function Pt(n,t,s){var p=s&&n.options[s];return ft(dt(p&&p.origin||n.options.origin,n,t,[n&&t]))||{x:0,y:0}}function Ot(n,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(it){return!0},p=arguments.length>3?arguments[3]:void 0;if(p=p||{},l.string(n)&&n.search(" ")!==-1&&(n=Ct(n)),l.array(n))return n.forEach(function(it){return Ot(it,t,s,p)}),p;if(l.object(n)&&(t=n,n=""),l.func(t)&&s(n))p[n]=p[n]||[],p[n].push(t);else if(l.array(t))for(var b=0,j=t;b<j.length;b++){var H=j[b];Ot(n,H,s,p)}else if(l.object(t))for(var J in t)Ot(Ct(J).map(function(it){return"".concat(n).concat(it)}),t[J],s,p);return p}function Ct(n){return n.trim().split(/ +/)}var Rt=function(n,t){return Math.sqrt(n*n+t*t)},Mt=["webkit","moz"];function vt(n,t){n.__set||(n.__set={});var s=function(b){if(Mt.some(function(j){return b.indexOf(j)===0}))return 1;typeof n[b]!="function"&&b!=="__set"&&Object.defineProperty(n,b,{get:function(){return b in n.__set?n.__set[b]:n.__set[b]=t[b]},set:function(j){n.__set[b]=j},configurable:!0})};for(var p in t)s(p);return n}function mt(n,t){n.page=n.page||{},n.page.x=t.page.x,n.page.y=t.page.y,n.client=n.client||{},n.client.x=t.client.x,n.client.y=t.client.y,n.timeStamp=t.timeStamp}function wt(n){n.page.x=0,n.page.y=0,n.client.x=0,n.client.y=0}function Tt(n){return n instanceof V.Event||n instanceof V.Touch}function Ft(n,t,s){return n=n||"page",(s=s||{}).x=t[n+"X"],s.y=t[n+"Y"],s}function Jt(n,t){return t=t||{x:0,y:0},L.isOperaMobile&&Tt(n)?(Ft("screen",n,t),t.x+=window.scrollX,t.y+=window.scrollY):Ft("page",n,t),t}function ie(n){return l.number(n.pointerId)?n.pointerId:n.identifier}function fe(n,t,s){var p=t.length>1?we(t):t[0];Jt(p,n.page),function(b,j){j=j||{},L.isOperaMobile&&Tt(b)?Ft("screen",b,j):Ft("client",b,j)}(p,n.client),n.timeStamp=s}function ge(n){var t=[];return l.array(n)?(t[0]=n[0],t[1]=n[1]):n.type==="touchend"?n.touches.length===1?(t[0]=n.touches[0],t[1]=n.changedTouches[0]):n.touches.length===0&&(t[0]=n.changedTouches[0],t[1]=n.changedTouches[1]):(t[0]=n.touches[0],t[1]=n.touches[1]),t}function we(n){for(var t={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},s=0;s<n.length;s++){var p=n[s];for(var b in t)t[b]+=p[b]}for(var j in t)t[j]/=n.length;return t}function xe(n){if(!n.length)return null;var t=ge(n),s=Math.min(t[0].pageX,t[1].pageX),p=Math.min(t[0].pageY,t[1].pageY),b=Math.max(t[0].pageX,t[1].pageX),j=Math.max(t[0].pageY,t[1].pageY);return{x:s,y:p,left:s,top:p,right:b,bottom:j,width:b-s,height:j-p}}function Xe(n,t){var s=t+"X",p=t+"Y",b=ge(n),j=b[0][s]-b[1][s],H=b[0][p]-b[1][p];return Rt(j,H)}function Ke(n,t){var s=t+"X",p=t+"Y",b=ge(n),j=b[1][s]-b[0][s],H=b[1][p]-b[0][p];return 180*Math.atan2(H,j)/Math.PI}function rn(n){return l.string(n.pointerType)?n.pointerType:l.number(n.pointerType)?[void 0,void 0,"touch","pen","mouse"][n.pointerType]:/touch/.test(n.type||"")||n instanceof V.Touch?"touch":"mouse"}function Se(n){var t=l.func(n.composedPath)?n.composedPath():n.path;return[N(t?t[0]:n.target),N(n.currentTarget)]}var Me=function(){function n(t){g(this,n),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=t}return o(n,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),n}();Object.defineProperty(Me.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var Ee=function(n,t){for(var s=0;s<t.length;s++){var p=t[s];n.push(p)}return n},Ue=function(n){return Ee([],n)},Ie=function(n,t){for(var s=0;s<n.length;s++)if(t(n[s],s,n))return s;return-1},Ne=function(n,t){return n[Ie(n,t)]},te=function(n){u(s,n);var t=O(s);function s(p,b,j){var H;g(this,s),(H=t.call(this,b._interaction)).dropzone=void 0,H.dragEvent=void 0,H.relatedTarget=void 0,H.draggable=void 0,H.propagationStopped=!1,H.immediatePropagationStopped=!1;var J=j==="dragleave"?p.prev:p.cur,it=J.element,lt=J.dropzone;return H.type=j,H.target=it,H.currentTarget=it,H.dropzone=lt,H.dragEvent=b,H.relatedTarget=b.target,H.draggable=b.interactable,H.timeStamp=b.timeStamp,H}return o(s,[{key:"reject",value:function(){var p=this,b=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&b.cur.dropzone===this.dropzone&&b.cur.element===this.target)if(b.prev.dropzone=this.dropzone,b.prev.element=this.target,b.rejected=!0,b.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var j=b.activeDrops,H=Ie(j,function(it){var lt=it.dropzone,st=it.element;return lt===p.dropzone&&st===p.target});b.activeDrops.splice(H,1);var J=new s(b,this.dragEvent,"dropdeactivate");J.dropzone=this.dropzone,J.target=this.target,this.dropzone.fire(J)}else this.dropzone.fire(new s(b,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),s}(Me);function Ce(n,t){for(var s=0,p=n.slice();s<p.length;s++){var b=p[s],j=b.dropzone,H=b.element;t.dropzone=j,t.target=H,j.fire(t),t.propagationStopped=t.immediatePropagationStopped=!1}}function ue(n,t){for(var s=function(j,H){for(var J=[],it=0,lt=j.interactables.list;it<lt.length;it++){var st=lt[it];if(st.options.drop.enabled){var pt=st.options.drop.accept;if(!(l.element(pt)&&pt!==H||l.string(pt)&&!rt(H,pt)||l.func(pt)&&!pt({dropzone:st,draggableElement:H})))for(var yt=0,At=st.getAllElements();yt<At.length;yt++){var _t=At[yt];_t!==H&&J.push({dropzone:st,element:_t,rect:st.getRect(_t)})}}}return J}(n,t),p=0;p<s.length;p++){var b=s[p];b.rect=b.dropzone.getRect(b.element)}return s}function _e(n,t,s){for(var p=n.dropState,b=n.interactable,j=n.element,H=[],J=0,it=p.activeDrops;J<it.length;J++){var lt=it[J],st=lt.dropzone,pt=lt.element,yt=lt.rect,At=st.dropCheck(t,s,b,j,pt,yt);H.push(At?pt:null)}var _t=function(Dt){for(var Nt,It,qt,Wt=[],Zt=0;Zt<Dt.length;Zt++){var Ut=Dt[Zt],Xt=Dt[Nt];if(Ut&&Zt!==Nt)if(Xt){var ye=f(Ut),re=f(Xt);if(ye!==Ut.ownerDocument)if(re!==Ut.ownerDocument)if(ye!==re){Wt=Wt.length?Wt:_(Xt);var Pe=void 0;if(Xt instanceof V.HTMLElement&&Ut instanceof V.SVGElement&&!(Ut instanceof V.SVGSVGElement)){if(Ut===re)continue;Pe=Ut.ownerSVGElement}else Pe=Ut;for(var Re=_(Pe,Xt.ownerDocument),Ge=0;Re[Ge]&&Re[Ge]===Wt[Ge];)Ge++;var Yn=[Re[Ge-1],Re[Ge],Wt[Ge]];if(Yn[0])for(var _n=Yn[0].lastChild;_n;){if(_n===Yn[1]){Nt=Zt,Wt=Re;break}if(_n===Yn[2])break;_n=_n.previousSibling}}else qt=Xt,(parseInt(M(It=Ut).getComputedStyle(It).zIndex,10)||0)>=(parseInt(M(qt).getComputedStyle(qt).zIndex,10)||0)&&(Nt=Zt);else Nt=Zt}else Nt=Zt}return Nt}(H);return p.activeDrops[_t]||null}function Ae(n,t,s){var p=n.dropState,b={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return s.type==="dragstart"&&(b.activate=new te(p,s,"dropactivate"),b.activate.target=null,b.activate.dropzone=null),s.type==="dragend"&&(b.deactivate=new te(p,s,"dropdeactivate"),b.deactivate.target=null,b.deactivate.dropzone=null),p.rejected||(p.cur.element!==p.prev.element&&(p.prev.dropzone&&(b.leave=new te(p,s,"dragleave"),s.dragLeave=b.leave.target=p.prev.element,s.prevDropzone=b.leave.dropzone=p.prev.dropzone),p.cur.dropzone&&(b.enter=new te(p,s,"dragenter"),s.dragEnter=p.cur.element,s.dropzone=p.cur.dropzone)),s.type==="dragend"&&p.cur.dropzone&&(b.drop=new te(p,s,"drop"),s.dropzone=p.cur.dropzone,s.relatedTarget=p.cur.element),s.type==="dragmove"&&p.cur.dropzone&&(b.move=new te(p,s,"dropmove"),s.dropzone=p.cur.dropzone)),b}function St(n,t){var s=n.dropState,p=s.activeDrops,b=s.cur,j=s.prev;t.leave&&j.dropzone.fire(t.leave),t.enter&&b.dropzone.fire(t.enter),t.move&&b.dropzone.fire(t.move),t.drop&&b.dropzone.fire(t.drop),t.deactivate&&Ce(p,t.deactivate),s.prev.dropzone=b.dropzone,s.prev.element=b.element}function zt(n,t){var s=n.interaction,p=n.iEvent,b=n.event;if(p.type==="dragmove"||p.type==="dragend"){var j=s.dropState;t.dynamicDrop&&(j.activeDrops=ue(t,s.element));var H=p,J=_e(s,H,b);j.rejected=j.rejected&&!!J&&J.dropzone===j.cur.dropzone&&J.element===j.cur.element,j.cur.dropzone=J&&J.dropzone,j.cur.element=J&&J.element,j.events=Ae(s,0,H)}}var Ht={id:"actions/drop",install:function(n){var t=n.actions,s=n.interactStatic,p=n.Interactable,b=n.defaults;n.usePlugin(G),p.prototype.dropzone=function(j){return function(H,J){if(l.object(J)){if(H.options.drop.enabled=J.enabled!==!1,J.listeners){var it=Ot(J.listeners),lt=Object.keys(it).reduce(function(pt,yt){return pt[/^(enter|leave)/.test(yt)?"drag".concat(yt):/^(activate|deactivate|move)/.test(yt)?"drop".concat(yt):yt]=it[yt],pt},{}),st=H.options.drop.listeners;st&&H.off(st),H.on(lt),H.options.drop.listeners=lt}return l.func(J.ondrop)&&H.on("drop",J.ondrop),l.func(J.ondropactivate)&&H.on("dropactivate",J.ondropactivate),l.func(J.ondropdeactivate)&&H.on("dropdeactivate",J.ondropdeactivate),l.func(J.ondragenter)&&H.on("dragenter",J.ondragenter),l.func(J.ondragleave)&&H.on("dragleave",J.ondragleave),l.func(J.ondropmove)&&H.on("dropmove",J.ondropmove),/^(pointer|center)$/.test(J.overlap)?H.options.drop.overlap=J.overlap:l.number(J.overlap)&&(H.options.drop.overlap=Math.max(Math.min(1,J.overlap),0)),"accept"in J&&(H.options.drop.accept=J.accept),"checker"in J&&(H.options.drop.checker=J.checker),H}return l.bool(J)?(H.options.drop.enabled=J,H):H.options.drop}(this,j)},p.prototype.dropCheck=function(j,H,J,it,lt,st){return function(pt,yt,At,_t,Dt,Nt,It){var qt=!1;if(!(It=It||pt.getRect(Nt)))return!!pt.options.drop.checker&&pt.options.drop.checker(yt,At,qt,pt,Nt,_t,Dt);var Wt=pt.options.drop.overlap;if(Wt==="pointer"){var Zt=Pt(_t,Dt,"drag"),Ut=Jt(yt);Ut.x+=Zt.x,Ut.y+=Zt.y;var Xt=Ut.x>It.left&&Ut.x<It.right,ye=Ut.y>It.top&&Ut.y<It.bottom;qt=Xt&&ye}var re=_t.getRect(Dt);if(re&&Wt==="center"){var Pe=re.left+re.width/2,Re=re.top+re.height/2;qt=Pe>=It.left&&Pe<=It.right&&Re>=It.top&&Re<=It.bottom}return re&&l.number(Wt)&&(qt=Math.max(0,Math.min(It.right,re.right)-Math.max(It.left,re.left))*Math.max(0,Math.min(It.bottom,re.bottom)-Math.max(It.top,re.top))/(re.width*re.height)>=Wt),pt.options.drop.checker&&(qt=pt.options.drop.checker(yt,At,qt,pt,Nt,_t,Dt)),qt}(this,j,H,J,it,lt,st)},s.dynamicDrop=function(j){return l.bool(j)?(n.dynamicDrop=j,s):n.dynamicDrop},Z(t.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),t.methodDict.drop="dropzone",n.dynamicDrop=!1,b.actions.drop=Ht.defaults},listeners:{"interactions:before-action-start":function(n){var t=n.interaction;t.prepared.name==="drag"&&(t.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(n,t){var s=n.interaction,p=(n.event,n.iEvent);if(s.prepared.name==="drag"){var b=s.dropState;b.activeDrops=[],b.events={},b.activeDrops=ue(t,s.element),b.events=Ae(s,0,p),b.events.activate&&(Ce(b.activeDrops,b.events.activate),t.fire("actions/drop:start",{interaction:s,dragEvent:p}))}},"interactions:action-move":zt,"interactions:after-action-move":function(n,t){var s=n.interaction,p=n.iEvent;if(s.prepared.name==="drag"){var b=s.dropState;St(s,b.events),t.fire("actions/drop:move",{interaction:s,dragEvent:p}),b.events={}}},"interactions:action-end":function(n,t){if(n.interaction.prepared.name==="drag"){var s=n.interaction,p=n.iEvent;zt(n,t),St(s,s.dropState.events),t.fire("actions/drop:end",{interaction:s,dragEvent:p})}},"interactions:stop":function(n){var t=n.interaction;if(t.prepared.name==="drag"){var s=t.dropState;s&&(s.activeDrops=null,s.events=null,s.cur.dropzone=null,s.cur.element=null,s.prev.dropzone=null,s.prev.element=null,s.rejected=!1)}}},getActiveDrops:ue,getDrop:_e,getDropEvents:Ae,fireDropEvents:St,filterEventType:function(n){return n.search("drag")===0||n.search("drop")===0},defaults:{enabled:!1,accept:null,overlap:"pointer"}},Vt=Ht;function Yt(n){var t=n.interaction,s=n.iEvent,p=n.phase;if(t.prepared.name==="gesture"){var b=t.pointers.map(function(lt){return lt.pointer}),j=p==="start",H=p==="end",J=t.interactable.options.deltaSource;if(s.touches=[b[0],b[1]],j)s.distance=Xe(b,J),s.box=xe(b),s.scale=1,s.ds=0,s.angle=Ke(b,J),s.da=0,t.gesture.startDistance=s.distance,t.gesture.startAngle=s.angle;else if(H||t.pointers.length<2){var it=t.prevEvent;s.distance=it.distance,s.box=it.box,s.scale=it.scale,s.ds=0,s.angle=it.angle,s.da=0}else s.distance=Xe(b,J),s.box=xe(b),s.scale=s.distance/t.gesture.startDistance,s.angle=Ke(b,J),s.ds=s.scale-t.gesture.scale,s.da=s.angle-t.gesture.angle;t.gesture.distance=s.distance,t.gesture.angle=s.angle,l.number(s.scale)&&s.scale!==1/0&&!isNaN(s.scale)&&(t.gesture.scale=s.scale)}}var Qt={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(n){var t=n.actions,s=n.Interactable,p=n.defaults;s.prototype.gesturable=function(b){return l.object(b)?(this.options.gesture.enabled=b.enabled!==!1,this.setPerAction("gesture",b),this.setOnEvents("gesture",b),this):l.bool(b)?(this.options.gesture.enabled=b,this):this.options.gesture},t.map.gesture=Qt,t.methodDict.gesture="gesturable",p.actions.gesture=Qt.defaults},listeners:{"interactions:action-start":Yt,"interactions:action-move":Yt,"interactions:action-end":Yt,"interactions:new":function(n){n.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(n){if(!(n.interaction.pointers.length<2)){var t=n.interactable.options.gesture;if(t&&t.enabled)return n.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(n){return n.search("gesture")===0}},P=Qt;function Q(n,t,s,p,b,j,H){if(!t)return!1;if(t===!0){var J=l.number(j.width)?j.width:j.right-j.left,it=l.number(j.height)?j.height:j.bottom-j.top;if(H=Math.min(H,Math.abs((n==="left"||n==="right"?J:it)/2)),J<0&&(n==="left"?n="right":n==="right"&&(n="left")),it<0&&(n==="top"?n="bottom":n==="bottom"&&(n="top")),n==="left"){var lt=J>=0?j.left:j.right;return s.x<lt+H}if(n==="top"){var st=it>=0?j.top:j.bottom;return s.y<st+H}if(n==="right")return s.x>(J>=0?j.right:j.left)-H;if(n==="bottom")return s.y>(it>=0?j.bottom:j.top)-H}return!!l.element(p)&&(l.element(t)?t===p:h(p,t,b))}function X(n){var t=n.iEvent,s=n.interaction;if(s.prepared.name==="resize"&&s.resizeAxes){var p=t;s.interactable.options.resize.square?(s.resizeAxes==="y"?p.delta.x=p.delta.y:p.delta.y=p.delta.x,p.axes="xy"):(p.axes=s.resizeAxes,s.resizeAxes==="x"?p.delta.y=0:s.resizeAxes==="y"&&(p.delta.x=0))}}var et,at,gt={id:"actions/resize",before:["actions/drag"],install:function(n){var t=n.actions,s=n.browser,p=n.Interactable,b=n.defaults;gt.cursors=function(j){return j.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(s),gt.defaultMargin=s.supportsTouch||s.supportsPointerEvent?20:10,p.prototype.resizable=function(j){return function(H,J,it){return l.object(J)?(H.options.resize.enabled=J.enabled!==!1,H.setPerAction("resize",J),H.setOnEvents("resize",J),l.string(J.axis)&&/^x$|^y$|^xy$/.test(J.axis)?H.options.resize.axis=J.axis:J.axis===null&&(H.options.resize.axis=it.defaults.actions.resize.axis),l.bool(J.preserveAspectRatio)?H.options.resize.preserveAspectRatio=J.preserveAspectRatio:l.bool(J.square)&&(H.options.resize.square=J.square),H):l.bool(J)?(H.options.resize.enabled=J,H):H.options.resize}(this,j,n)},t.map.resize=gt,t.methodDict.resize="resizable",b.actions.resize=gt.defaults},listeners:{"interactions:new":function(n){n.interaction.resizeAxes="xy"},"interactions:action-start":function(n){(function(t){var s=t.iEvent,p=t.interaction;if(p.prepared.name==="resize"&&p.prepared.edges){var b=s,j=p.rect;p._rects={start:Z({},j),corrected:Z({},j),previous:Z({},j),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},b.edges=p.prepared.edges,b.rect=p._rects.corrected,b.deltaRect=p._rects.delta}})(n),X(n)},"interactions:action-move":function(n){(function(t){var s=t.iEvent,p=t.interaction;if(p.prepared.name==="resize"&&p.prepared.edges){var b=s,j=p.interactable.options.resize.invert,H=j==="reposition"||j==="negate",J=p.rect,it=p._rects,lt=it.start,st=it.corrected,pt=it.delta,yt=it.previous;if(Z(yt,st),H){if(Z(st,J),j==="reposition"){if(st.top>st.bottom){var At=st.top;st.top=st.bottom,st.bottom=At}if(st.left>st.right){var _t=st.left;st.left=st.right,st.right=_t}}}else st.top=Math.min(J.top,lt.bottom),st.bottom=Math.max(J.bottom,lt.top),st.left=Math.min(J.left,lt.right),st.right=Math.max(J.right,lt.left);for(var Dt in st.width=st.right-st.left,st.height=st.bottom-st.top,st)pt[Dt]=st[Dt]-yt[Dt];b.edges=p.prepared.edges,b.rect=st,b.deltaRect=pt}})(n),X(n)},"interactions:action-end":function(n){var t=n.iEvent,s=n.interaction;if(s.prepared.name==="resize"&&s.prepared.edges){var p=t;p.edges=s.prepared.edges,p.rect=s._rects.corrected,p.deltaRect=s._rects.delta}},"auto-start:check":function(n){var t=n.interaction,s=n.interactable,p=n.element,b=n.rect,j=n.buttons;if(b){var H=Z({},t.coords.cur.page),J=s.options.resize;if(J&&J.enabled&&(!t.pointerIsDown||!/mouse|pointer/.test(t.pointerType)||j&J.mouseButtons)){if(l.object(J.edges)){var it={left:!1,right:!1,top:!1,bottom:!1};for(var lt in it)it[lt]=Q(lt,J.edges[lt],H,t._latestPointer.eventTarget,p,b,J.margin||gt.defaultMargin);it.left=it.left&&!it.right,it.top=it.top&&!it.bottom,(it.left||it.right||it.top||it.bottom)&&(n.action={name:"resize",edges:it})}else{var st=J.axis!=="y"&&H.x>b.right-gt.defaultMargin,pt=J.axis!=="x"&&H.y>b.bottom-gt.defaultMargin;(st||pt)&&(n.action={name:"resize",axes:(st?"x":"")+(pt?"y":"")})}return!n.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(n){var t=n.edges,s=n.axis,p=n.name,b=gt.cursors,j=null;if(s)j=b[p+s];else if(t){for(var H="",J=0,it=["top","bottom","left","right"];J<it.length;J++){var lt=it[J];t[lt]&&(H+=lt)}j=b[H]}return j},filterEventType:function(n){return n.search("resize")===0},defaultMargin:null},Et=gt,jt={id:"actions",install:function(n){n.usePlugin(P),n.usePlugin(Et),n.usePlugin(G),n.usePlugin(Vt)}},kt=0,Lt={request:function(n){return et(n)},cancel:function(n){return at(n)},init:function(n){if(et=n.requestAnimationFrame,at=n.cancelAnimationFrame,!et)for(var t=["ms","moz","webkit","o"],s=0;s<t.length;s++){var p=t[s];et=n["".concat(p,"RequestAnimationFrame")],at=n["".concat(p,"CancelAnimationFrame")]||n["".concat(p,"CancelRequestAnimationFrame")]}et=et&&et.bind(n),at=at&&at.bind(n),et||(et=function(b){var j=Date.now(),H=Math.max(0,16-(j-kt)),J=n.setTimeout(function(){b(j+H)},H);return kt=j+H,J},at=function(b){return clearTimeout(b)})}},bt={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(n){bt.isScrolling=!0,Lt.cancel(bt.i),n.autoScroll=bt,bt.interaction=n,bt.prevTime=bt.now(),bt.i=Lt.request(bt.scroll)},stop:function(){bt.isScrolling=!1,bt.interaction&&(bt.interaction.autoScroll=null),Lt.cancel(bt.i)},scroll:function(){var n=bt.interaction,t=n.interactable,s=n.element,p=n.prepared.name,b=t.options[p].autoScroll,j=Gt(b.container,t,s),H=bt.now(),J=(H-bt.prevTime)/1e3,it=b.speed*J;if(it>=1){var lt={x:bt.x*it,y:bt.y*it};if(lt.x||lt.y){var st=Bt(j);l.window(j)?j.scrollBy(lt.x,lt.y):j&&(j.scrollLeft+=lt.x,j.scrollTop+=lt.y);var pt=Bt(j),yt={x:pt.x-st.x,y:pt.y-st.y};(yt.x||yt.y)&&t.fire({type:"autoscroll",target:s,interactable:t,delta:yt,interaction:n,container:j})}bt.prevTime=H}bt.isScrolling&&(Lt.cancel(bt.i),bt.i=Lt.request(bt.scroll))},check:function(n,t){var s;return(s=n.options[t].autoScroll)==null?void 0:s.enabled},onInteractionMove:function(n){var t=n.interaction,s=n.pointer;if(t.interacting()&&bt.check(t.interactable,t.prepared.name))if(t.simulation)bt.x=bt.y=0;else{var p,b,j,H,J=t.interactable,it=t.element,lt=t.prepared.name,st=J.options[lt].autoScroll,pt=Gt(st.container,J,it);if(l.window(pt))H=s.clientX<bt.margin,p=s.clientY<bt.margin,b=s.clientX>pt.innerWidth-bt.margin,j=s.clientY>pt.innerHeight-bt.margin;else{var yt=z(pt);H=s.clientX<yt.left+bt.margin,p=s.clientY<yt.top+bt.margin,b=s.clientX>yt.right-bt.margin,j=s.clientY>yt.bottom-bt.margin}bt.x=b?1:H?-1:0,bt.y=j?1:p?-1:0,bt.isScrolling||(bt.margin=st.margin,bt.speed=st.speed,bt.start(t))}}};function Gt(n,t,s){return(l.string(n)?ut(n,t,s):n)||M(s)}function Bt(n){return l.window(n)&&(n=window.document.body),{x:n.scrollLeft,y:n.scrollTop}}var Kt={id:"auto-scroll",install:function(n){var t=n.defaults,s=n.actions;n.autoScroll=bt,bt.now=function(){return n.now()},s.phaselessTypes.autoscroll=!0,t.perAction.autoScroll=bt.defaults},listeners:{"interactions:new":function(n){n.interaction.autoScroll=null},"interactions:destroy":function(n){n.interaction.autoScroll=null,bt.stop(),bt.interaction&&(bt.interaction=null)},"interactions:stop":bt.stop,"interactions:action-move":function(n){return bt.onInteractionMove(n)}}},ee=Kt;function se(n,t){var s=!1;return function(){return s||(k.console.warn(t),s=!0),n.apply(this,arguments)}}function Je(n,t){return n.name=t.name,n.axis=t.axis,n.edges=t.edges,n}function hn(n){return l.bool(n)?(this.options.styleCursor=n,this):n===null?(delete this.options.styleCursor,this):this.options.styleCursor}function Fe(n){return l.func(n)?(this.options.actionChecker=n,this):n===null?(delete this.options.actionChecker,this):this.options.actionChecker}var Rn={id:"auto-start/interactableMethods",install:function(n){var t=n.Interactable;t.prototype.getAction=function(s,p,b,j){var H=function(J,it,lt,st,pt){var yt=J.getRect(st),At=it.buttons||{0:1,1:4,3:8,4:16}[it.button],_t={action:null,interactable:J,interaction:lt,element:st,rect:yt,buttons:At};return pt.fire("auto-start:check",_t),_t.action}(this,p,b,j,n);return this.options.actionChecker?this.options.actionChecker(s,p,H,this,j,b):H},t.prototype.ignoreFrom=se(function(s){return this._backCompatOption("ignoreFrom",s)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),t.prototype.allowFrom=se(function(s){return this._backCompatOption("allowFrom",s)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),t.prototype.actionChecker=Fe,t.prototype.styleCursor=hn}};function bn(n,t,s,p,b){return t.testIgnoreAllow(t.options[n.name],s,p)&&t.options[n.name].enabled&&pn(t,s,n,b)?n:null}function he(n,t,s,p,b,j,H){for(var J=0,it=p.length;J<it;J++){var lt=p[J],st=b[J],pt=lt.getAction(t,s,n,st);if(pt){var yt=bn(pt,lt,st,j,H);if(yt)return{action:yt,interactable:lt,element:st}}}return{action:null,interactable:null,element:null}}function on(n,t,s,p,b){var j=[],H=[],J=p;function it(st){j.push(st),H.push(J)}for(;l.element(J);){j=[],H=[],b.interactables.forEachMatch(J,it);var lt=he(n,t,s,j,H,p,b);if(lt.action&&!lt.interactable.options[lt.action.name].manualStart)return lt;J=K(J)}return{action:null,interactable:null,element:null}}function xn(n,t,s){var p=t.action,b=t.interactable,j=t.element;p=p||{name:null},n.interactable=b,n.element=j,Je(n.prepared,p),n.rect=b&&p.name?b.getRect(j):null,an(n,s),s.fire("autoStart:prepared",{interaction:n})}function pn(n,t,s,p){var b=n.options,j=b[s.name].max,H=b[s.name].maxPerElement,J=p.autoStart.maxInteractions,it=0,lt=0,st=0;if(!(j&&H&&J))return!1;for(var pt=0,yt=p.interactions.list;pt<yt.length;pt++){var At=yt[pt],_t=At.prepared.name;if(At.interacting()&&(++it>=J||At.interactable===n&&((lt+=_t===s.name?1:0)>=j||At.element===t&&(st++,_t===s.name&&st>=H))))return!1}return J>0}function me(n,t){return l.number(n)?(t.autoStart.maxInteractions=n,this):t.autoStart.maxInteractions}function de(n,t,s){var p=s.autoStart.cursorElement;p&&p!==n&&(p.style.cursor=""),n.ownerDocument.documentElement.style.cursor=t,n.style.cursor=t,s.autoStart.cursorElement=t?n:null}function an(n,t){var s=n.interactable,p=n.element,b=n.prepared;if(n.pointerType==="mouse"&&s&&s.options.styleCursor){var j="";if(b.name){var H=s.options[b.name].cursorChecker;j=l.func(H)?H(b,s,p,n._interacting):t.actions.map[b.name].getCursor(b)}de(n.element,j||"",t)}else t.autoStart.cursorElement&&de(t.autoStart.cursorElement,"",t)}var qe={id:"auto-start/base",before:["actions"],install:function(n){var t=n.interactStatic,s=n.defaults;n.usePlugin(Rn),s.base.actionChecker=null,s.base.styleCursor=!0,Z(s.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),t.maxInteractions=function(p){return me(p,n)},n.autoStart={maxInteractions:1/0,withinInteractionLimit:pn,cursorElement:null}},listeners:{"interactions:down":function(n,t){var s=n.interaction,p=n.pointer,b=n.event,j=n.eventTarget;s.interacting()||xn(s,on(s,p,b,j,t),t)},"interactions:move":function(n,t){(function(s,p){var b=s.interaction,j=s.pointer,H=s.event,J=s.eventTarget;b.pointerType!=="mouse"||b.pointerIsDown||b.interacting()||xn(b,on(b,j,H,J,p),p)})(n,t),function(s,p){var b=s.interaction;if(b.pointerIsDown&&!b.interacting()&&b.pointerWasMoved&&b.prepared.name){p.fire("autoStart:before-start",s);var j=b.interactable,H=b.prepared.name;H&&j&&(j.options[H].manualStart||!pn(j,b.element,b.prepared,p)?b.stop():(b.start(b.prepared,j,b.element),an(b,p)))}}(n,t)},"interactions:stop":function(n,t){var s=n.interaction,p=s.interactable;p&&p.options.styleCursor&&de(s.element,"",t)}},maxInteractions:me,withinInteractionLimit:pn,validateAction:bn},He=qe,De={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(n,t){var s=n.interaction,p=n.eventTarget,b=n.dx,j=n.dy;if(s.prepared.name==="drag"){var H=Math.abs(b),J=Math.abs(j),it=s.interactable.options.drag,lt=it.startAxis,st=H>J?"x":H<J?"y":"xy";if(s.prepared.axis=it.lockAxis==="start"?st[0]:it.lockAxis,st!=="xy"&&lt!=="xy"&&lt!==st){s.prepared.name=null;for(var pt=p,yt=function(_t){if(_t!==s.interactable){var Dt=s.interactable.options.drag;if(!Dt.manualStart&&_t.testIgnoreAllow(Dt,pt,p)){var Nt=_t.getAction(s.downPointer,s.downEvent,s,pt);if(Nt&&Nt.name==="drag"&&function(It,qt){if(!qt)return!1;var Wt=qt.options.drag.startAxis;return It==="xy"||Wt==="xy"||Wt===It}(st,_t)&&He.validateAction(Nt,_t,pt,p,t))return _t}}};l.element(pt);){var At=t.interactables.forEachMatch(pt,yt);if(At){s.prepared.name="drag",s.interactable=At,s.element=pt;break}pt=K(pt)}}}}}};function Te(n){var t=n.prepared&&n.prepared.name;if(!t)return null;var s=n.interactable.options;return s[t].hold||s[t].delay}var fn={id:"auto-start/hold",install:function(n){var t=n.defaults;n.usePlugin(He),t.perAction.hold=0,t.perAction.delay=0},listeners:{"interactions:new":function(n){n.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(n){var t=n.interaction,s=Te(t);s>0&&(t.autoStartHoldTimer=setTimeout(function(){t.start(t.prepared,t.interactable,t.element)},s))},"interactions:move":function(n){var t=n.interaction,s=n.duplicate;t.autoStartHoldTimer&&t.pointerWasMoved&&!s&&(clearTimeout(t.autoStartHoldTimer),t.autoStartHoldTimer=null)},"autoStart:before-start":function(n){var t=n.interaction;Te(t)>0&&(t.prepared.name=null)}},getHoldDuration:Te},ln=fn,$n={id:"auto-start",install:function(n){n.usePlugin(He),n.usePlugin(ln),n.usePlugin(De)}},ur=function(n){return/^(always|never|auto)$/.test(n)?(this.options.preventDefault=n,this):l.bool(n)?(this.options.preventDefault=n?"always":"never",this):this.options.preventDefault};function dr(n){var t=n.interaction,s=n.event;t.interactable&&t.interactable.checkAndPreventDefault(s)}var Bi={id:"core/interactablePreventDefault",install:function(n){var t=n.Interactable;t.prototype.preventDefault=ur,t.prototype.checkAndPreventDefault=function(s){return function(p,b,j){var H=p.options.preventDefault;if(H!=="never")if(H!=="always"){if(b.events.supportsPassive&&/^touch(start|move)$/.test(j.type)){var J=M(j.target).document,it=b.getDocOptions(J);if(!it||!it.events||it.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(j.type)||l.element(j.target)&&rt(j.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||j.preventDefault()}else j.preventDefault()}(this,n,s)},n.interactions.docEvents.push({type:"dragstart",listener:function(s){for(var p=0,b=n.interactions.list;p<b.length;p++){var j=b[p];if(j.element&&(j.element===s.target||q(j.element,s.target)))return void j.interactable.checkAndPreventDefault(s)}}})},listeners:["down","move","up","cancel"].reduce(function(n,t){return n["interactions:".concat(t)]=dr,n},{})};function Bn(n,t){if(t.phaselessTypes[n])return!0;for(var s in t.map)if(n.indexOf(s)===0&&n.substr(s.length)in t.phases)return!0;return!1}function gn(n){var t={};for(var s in n){var p=n[s];l.plainObject(p)?t[s]=gn(p):l.array(p)?t[s]=Ue(p):t[s]=p}return t}var ui=function(){function n(t){g(this,n),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=t,this.result=qn(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return o(n,[{key:"start",value:function(t,s){var p,b,j=t.phase,H=this.interaction,J=function(lt){var st=lt.interactable.options[lt.prepared.name],pt=st.modifiers;return pt&&pt.length?pt:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(yt){var At=st[yt];return At&&At.enabled&&{options:At,methods:At._methods}}).filter(function(yt){return!!yt})}(H);this.prepareStates(J),this.startEdges=Z({},H.edges),this.edges=Z({},this.startEdges),this.startOffset=(p=H.rect,b=s,p?{left:b.x-p.left,top:b.y-p.top,right:p.right-b.x,bottom:p.bottom-b.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var it=this.fillArg({phase:j,pageCoords:s,preEnd:!1});return this.result=qn(),this.startAll(it),this.result=this.setAll(it)}},{key:"fillArg",value:function(t){var s=this.interaction;return t.interaction=s,t.interactable=s.interactable,t.element=s.element,t.rect||(t.rect=s.rect),t.edges||(t.edges=this.startEdges),t.startOffset=this.startOffset,t}},{key:"startAll",value:function(t){for(var s=0,p=this.states;s<p.length;s++){var b=p[s];b.methods.start&&(t.state=b,b.methods.start(t))}}},{key:"setAll",value:function(t){var s=t.phase,p=t.preEnd,b=t.skipModifiers,j=t.rect,H=t.edges;t.coords=Z({},t.pageCoords),t.rect=Z({},j),t.edges=Z({},H);for(var J=b?this.states.slice(b):this.states,it=qn(t.coords,t.rect),lt=0;lt<J.length;lt++){var st,pt=J[lt],yt=pt.options,At=Z({},t.coords),_t=null;(st=pt.methods)!=null&&st.set&&this.shouldDo(yt,p,s)&&(t.state=pt,_t=pt.methods.set(t),xt(t.edges,t.rect,{x:t.coords.x-At.x,y:t.coords.y-At.y})),it.eventProps.push(_t)}Z(this.edges,t.edges),it.delta.x=t.coords.x-t.pageCoords.x,it.delta.y=t.coords.y-t.pageCoords.y,it.rectDelta.left=t.rect.left-j.left,it.rectDelta.right=t.rect.right-j.right,it.rectDelta.top=t.rect.top-j.top,it.rectDelta.bottom=t.rect.bottom-j.bottom;var Dt=this.result.coords,Nt=this.result.rect;if(Dt&&Nt){var It=it.rect.left!==Nt.left||it.rect.right!==Nt.right||it.rect.top!==Nt.top||it.rect.bottom!==Nt.bottom;it.changed=It||Dt.x!==it.coords.x||Dt.y!==it.coords.y}return it}},{key:"applyToInteraction",value:function(t){var s=this.interaction,p=t.phase,b=s.coords.cur,j=s.coords.start,H=this.result,J=this.startDelta,it=H.delta;p==="start"&&Z(this.startDelta,H.delta);for(var lt=0,st=[[j,J],[b,it]];lt<st.length;lt++){var pt=st[lt],yt=pt[0],At=pt[1];yt.page.x+=At.x,yt.page.y+=At.y,yt.client.x+=At.x,yt.client.y+=At.y}var _t=this.result.rectDelta,Dt=t.rect||s.rect;Dt.left+=_t.left,Dt.right+=_t.right,Dt.top+=_t.top,Dt.bottom+=_t.bottom,Dt.width=Dt.right-Dt.left,Dt.height=Dt.bottom-Dt.top}},{key:"setAndApply",value:function(t){var s=this.interaction,p=t.phase,b=t.preEnd,j=t.skipModifiers,H=this.setAll(this.fillArg({preEnd:b,phase:p,pageCoords:t.modifiedCoords||s.coords.cur.page}));if(this.result=H,!H.changed&&(!j||j<this.states.length)&&s.interacting())return!1;if(t.modifiedCoords){var J=s.coords.cur.page,it={x:t.modifiedCoords.x-J.x,y:t.modifiedCoords.y-J.y};H.coords.x+=it.x,H.coords.y+=it.y,H.delta.x+=it.x,H.delta.y+=it.y}this.applyToInteraction(t)}},{key:"beforeEnd",value:function(t){var s=t.interaction,p=t.event,b=this.states;if(b&&b.length){for(var j=!1,H=0;H<b.length;H++){var J=b[H];t.state=J;var it=J.options,lt=J.methods,st=lt.beforeEnd&&lt.beforeEnd(t);if(st)return this.endResult=st,!1;j=j||!j&&this.shouldDo(it,!0,t.phase,!0)}j&&s.move({event:p,preEnd:!0})}}},{key:"stop",value:function(t){var s=t.interaction;if(this.states&&this.states.length){var p=Z({states:this.states,interactable:s.interactable,element:s.element,rect:null},t);this.fillArg(p);for(var b=0,j=this.states;b<j.length;b++){var H=j[b];p.state=H,H.methods.stop&&H.methods.stop(p)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(t){this.states=[];for(var s=0;s<t.length;s++){var p=t[s],b=p.options,j=p.methods,H=p.name;this.states.push({options:b,methods:j,index:s,name:H})}return this.states}},{key:"restoreInteractionCoords",value:function(t){var s=t.interaction,p=s.coords,b=s.rect,j=s.modification;if(j.result){for(var H=j.startDelta,J=j.result,it=J.delta,lt=J.rectDelta,st=0,pt=[[p.start,H],[p.cur,it]];st<pt.length;st++){var yt=pt[st],At=yt[0],_t=yt[1];At.page.x-=_t.x,At.page.y-=_t.y,At.client.x-=_t.x,At.client.y-=_t.y}b.left-=lt.left,b.right-=lt.right,b.top-=lt.top,b.bottom-=lt.bottom}}},{key:"shouldDo",value:function(t,s,p,b){return!(!t||t.enabled===!1||b&&!t.endOnly||t.endOnly&&!s||p==="start"&&!t.setStart)}},{key:"copyFrom",value:function(t){this.startOffset=t.startOffset,this.startDelta=t.startDelta,this.startEdges=t.startEdges,this.edges=t.edges,this.states=t.states.map(function(s){return gn(s)}),this.result=qn(Z({},t.result.coords),Z({},t.result.rect))}},{key:"destroy",value:function(){for(var t in this)this[t]=null}}]),n}();function qn(n,t){return{rect:t,coords:n,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Ze(n,t){var s=n.defaults,p={start:n.start,set:n.set,beforeEnd:n.beforeEnd,stop:n.stop},b=function(j){var H=j||{};for(var J in H.enabled=H.enabled!==!1,s)J in H||(H[J]=s[J]);var it={options:H,methods:p,name:t,enable:function(){return H.enabled=!0,it},disable:function(){return H.enabled=!1,it}};return it};return t&&typeof t=="string"&&(b._defaults=s,b._methods=p),b}function wn(n){var t=n.iEvent,s=n.interaction.modification.result;s&&(t.modifiers=s.eventProps)}var hr={id:"modifiers/base",before:["actions"],install:function(n){n.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(n){var t=n.interaction;t.modification=new ui(t)},"interactions:before-action-start":function(n){var t=n.interaction,s=n.interaction.modification;s.start(n,t.coords.start.page),t.edges=s.edges,s.applyToInteraction(n)},"interactions:before-action-move":function(n){var t=n.interaction,s=t.modification,p=s.setAndApply(n);return t.edges=s.edges,p},"interactions:before-action-end":function(n){var t=n.interaction,s=t.modification,p=s.beforeEnd(n);return t.edges=s.startEdges,p},"interactions:action-start":wn,"interactions:action-move":wn,"interactions:action-end":wn,"interactions:after-action-start":function(n){return n.interaction.modification.restoreInteractionCoords(n)},"interactions:after-action-move":function(n){return n.interaction.modification.restoreInteractionCoords(n)},"interactions:stop":function(n){return n.interaction.modification.stop(n)}}},qi=hr,zi={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},di=function(n){u(s,n);var t=O(s);function s(p,b,j,H,J,it,lt){var st;g(this,s),(st=t.call(this,p)).relatedTarget=null,st.screenX=void 0,st.screenY=void 0,st.button=void 0,st.buttons=void 0,st.ctrlKey=void 0,st.shiftKey=void 0,st.altKey=void 0,st.metaKey=void 0,st.page=void 0,st.client=void 0,st.delta=void 0,st.rect=void 0,st.x0=void 0,st.y0=void 0,st.t0=void 0,st.dt=void 0,st.duration=void 0,st.clientX0=void 0,st.clientY0=void 0,st.velocity=void 0,st.speed=void 0,st.swipe=void 0,st.axes=void 0,st.preEnd=void 0,J=J||p.element;var pt=p.interactable,yt=(pt&&pt.options||zi).deltaSource,At=Pt(pt,J,j),_t=H==="start",Dt=H==="end",Nt=_t?E(st):p.prevEvent,It=_t?p.coords.start:Dt?{page:Nt.page,client:Nt.client,timeStamp:p.coords.cur.timeStamp}:p.coords.cur;return st.page=Z({},It.page),st.client=Z({},It.client),st.rect=Z({},p.rect),st.timeStamp=It.timeStamp,Dt||(st.page.x-=At.x,st.page.y-=At.y,st.client.x-=At.x,st.client.y-=At.y),st.ctrlKey=b.ctrlKey,st.altKey=b.altKey,st.shiftKey=b.shiftKey,st.metaKey=b.metaKey,st.button=b.button,st.buttons=b.buttons,st.target=J,st.currentTarget=J,st.preEnd=it,st.type=lt||j+(H||""),st.interactable=pt,st.t0=_t?p.pointers[p.pointers.length-1].downTime:Nt.t0,st.x0=p.coords.start.page.x-At.x,st.y0=p.coords.start.page.y-At.y,st.clientX0=p.coords.start.client.x-At.x,st.clientY0=p.coords.start.client.y-At.y,st.delta=_t||Dt?{x:0,y:0}:{x:st[yt].x-Nt[yt].x,y:st[yt].y-Nt[yt].y},st.dt=p.coords.delta.timeStamp,st.duration=st.timeStamp-st.t0,st.velocity=Z({},p.coords.velocity[yt]),st.speed=Rt(st.velocity.x,st.velocity.y),st.swipe=Dt||H==="inertiastart"?st.getSwipe():null,st}return o(s,[{key:"getSwipe",value:function(){var p=this._interaction;if(p.prevEvent.speed<600||this.timeStamp-p.prevEvent.timeStamp>150)return null;var b=180*Math.atan2(p.prevEvent.velocityY,p.prevEvent.velocityX)/Math.PI;b<0&&(b+=360);var j=112.5<=b&&b<247.5,H=202.5<=b&&b<337.5;return{up:H,down:!H&&22.5<=b&&b<157.5,left:j,right:!j&&(292.5<=b||b<67.5),angle:b,speed:p.prevEvent.speed,velocity:{x:p.prevEvent.velocityX,y:p.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),s}(Me);Object.defineProperties(di.prototype,{pageX:{get:function(){return this.page.x},set:function(n){this.page.x=n}},pageY:{get:function(){return this.page.y},set:function(n){this.page.y=n}},clientX:{get:function(){return this.client.x},set:function(n){this.client.x=n}},clientY:{get:function(){return this.client.y},set:function(n){this.client.y=n}},dx:{get:function(){return this.delta.x},set:function(n){this.delta.x=n}},dy:{get:function(){return this.delta.y},set:function(n){this.delta.y=n}},velocityX:{get:function(){return this.velocity.x},set:function(n){this.velocity.x=n}},velocityY:{get:function(){return this.velocity.y},set:function(n){this.velocity.y=n}}});var pr=o(function n(t,s,p,b,j){g(this,n),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=t,this.pointer=s,this.event=p,this.downTime=b,this.downTarget=j}),fr=function(n){return n.interactable="",n.element="",n.prepared="",n.pointerIsDown="",n.pointerWasMoved="",n._proxy="",n}({}),Vi=function(n){return n.start="",n.move="",n.end="",n.stop="",n.interacting="",n}({}),gr=0,mr=function(){function n(t){var s=this,p=t.pointerType,b=t.scopeFire;g(this,n),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=se(function(st){this.move(st)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=gr++,this._scopeFire=b,this.pointerType=p;var j=this;this._proxy={};var H=function(st){Object.defineProperty(s._proxy,st,{get:function(){return j[st]}})};for(var J in fr)H(J);var it=function(st){Object.defineProperty(s._proxy,st,{value:function(){return j[st].apply(j,arguments)}})};for(var lt in Vi)it(lt);this._scopeFire("interactions:new",{interaction:this})}return o(n,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(t,s,p){var b=this.updatePointer(t,s,p,!0),j=this.pointers[b];this._scopeFire("interactions:down",{pointer:t,event:s,eventTarget:p,pointerIndex:b,pointerInfo:j,type:"down",interaction:this})}},{key:"start",value:function(t,s,p){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(t.name==="gesture"?2:1)||!s.options[t.name].enabled)&&(Je(this.prepared,t),this.interactable=s,this.element=p,this.rect=s.getRect(p),this.edges=this.prepared.edges?Z({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(t,s,p){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(t,s,p,!1);var b,j,H=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(b=this.coords.cur.client.x-this.coords.start.client.x,j=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=Rt(b,j)>this.pointerMoveTolerance);var J,it,lt,st=this.getPointerIndex(t),pt={pointer:t,pointerIndex:st,pointerInfo:this.pointers[st],event:s,type:"move",eventTarget:p,dx:b,dy:j,duplicate:H,interaction:this};H||(J=this.coords.velocity,it=this.coords.delta,lt=Math.max(it.timeStamp/1e3,.001),J.page.x=it.page.x/lt,J.page.y=it.page.y/lt,J.client.x=it.client.x/lt,J.client.y=it.client.y/lt,J.timeStamp=lt),this._scopeFire("interactions:move",pt),H||this.simulation||(this.interacting()&&(pt.type=null,this.move(pt)),this.pointerWasMoved&&mt(this.coords.prev,this.coords.cur))}},{key:"move",value:function(t){t&&t.event||wt(this.coords.delta),(t=Z({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},t||{})).phase="move",this._doPhase(t)}},{key:"pointerUp",value:function(t,s,p,b){var j=this.getPointerIndex(t);j===-1&&(j=this.updatePointer(t,s,p,!1));var H=/cancel$/i.test(s.type)?"cancel":"up";this._scopeFire("interactions:".concat(H),{pointer:t,pointerIndex:j,pointerInfo:this.pointers[j],event:s,eventTarget:p,type:H,curEventTarget:b,interaction:this}),this.simulation||this.end(s),this.removePointer(t,s)}},{key:"documentBlur",value:function(t){this.end(t),this._scopeFire("interactions:blur",{event:t,type:"blur",interaction:this})}},{key:"end",value:function(t){var s;this._ending=!0,t=t||this._latestPointer.event,this.interacting()&&(s=this._doPhase({event:t,interaction:this,phase:"end"})),this._ending=!1,s===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(t){var s=ie(t);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:Ie(this.pointers,function(p){return p.id===s})}},{key:"getPointerInfo",value:function(t){return this.pointers[this.getPointerIndex(t)]}},{key:"updatePointer",value:function(t,s,p,b){var j,H,J,it=ie(t),lt=this.getPointerIndex(t),st=this.pointers[lt];return b=b!==!1&&(b||/(down|start)$/i.test(s.type)),st?st.pointer=t:(st=new pr(it,t,s,null,null),lt=this.pointers.length,this.pointers.push(st)),fe(this.coords.cur,this.pointers.map(function(pt){return pt.pointer}),this._now()),j=this.coords.delta,H=this.coords.prev,J=this.coords.cur,j.page.x=J.page.x-H.page.x,j.page.y=J.page.y-H.page.y,j.client.x=J.client.x-H.client.x,j.client.y=J.client.y-H.client.y,j.timeStamp=J.timeStamp-H.timeStamp,b&&(this.pointerIsDown=!0,st.downTime=this.coords.cur.timeStamp,st.downTarget=p,vt(this.downPointer,t),this.interacting()||(mt(this.coords.start,this.coords.cur),mt(this.coords.prev,this.coords.cur),this.downEvent=s,this.pointerWasMoved=!1)),this._updateLatestPointer(t,s,p),this._scopeFire("interactions:update-pointer",{pointer:t,event:s,eventTarget:p,down:b,pointerInfo:st,pointerIndex:lt,interaction:this}),lt}},{key:"removePointer",value:function(t,s){var p=this.getPointerIndex(t);if(p!==-1){var b=this.pointers[p];this._scopeFire("interactions:remove-pointer",{pointer:t,event:s,eventTarget:null,pointerIndex:p,pointerInfo:b,interaction:this}),this.pointers.splice(p,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(t,s,p){this._latestPointer.pointer=t,this._latestPointer.event=s,this._latestPointer.eventTarget=p}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(t,s,p,b){return new di(this,t,this.prepared.name,s,this.element,p,b)}},{key:"_fireEvent",value:function(t){var s;(s=this.interactable)==null||s.fire(t),(!this.prevEvent||t.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=t)}},{key:"_doPhase",value:function(t){var s=t.event,p=t.phase,b=t.preEnd,j=t.type,H=this.rect;if(H&&p==="move"&&(xt(this.edges,H,this.coords.delta[this.interactable.options.deltaSource]),H.width=H.right-H.left,H.height=H.bottom-H.top),this._scopeFire("interactions:before-action-".concat(p),t)===!1)return!1;var J=t.iEvent=this._createPreparedEvent(s,p,b,j);return this._scopeFire("interactions:action-".concat(p),t),p==="start"&&(this.prevEvent=J),this._fireEvent(J),this._scopeFire("interactions:after-action-".concat(p),t),!0}},{key:"_now",value:function(){return Date.now()}}]),n}();function Ui(n){Hi(n.interaction)}function Hi(n){if(!function(s){return!(!s.offset.pending.x&&!s.offset.pending.y)}(n))return!1;var t=n.offset.pending;return hi(n.coords.cur,t),hi(n.coords.delta,t),xt(n.edges,n.rect,t),t.x=0,t.y=0,!0}function vr(n){var t=n.x,s=n.y;this.offset.pending.x+=t,this.offset.pending.y+=s,this.offset.total.x+=t,this.offset.total.y+=s}function hi(n,t){var s=n.page,p=n.client,b=t.x,j=t.y;s.x+=b,s.y+=j,p.x+=b,p.y+=j}Vi.offsetBy="";var yr={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(n){n.Interaction.prototype.offsetBy=vr},listeners:{"interactions:new":function(n){n.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(n){return function(t){t.pointerIsDown&&(hi(t.coords.cur,t.offset.total),t.offset.pending.x=0,t.offset.pending.y=0)}(n.interaction)},"interactions:before-action-start":Ui,"interactions:before-action-move":Ui,"interactions:before-action-end":function(n){var t=n.interaction;if(Hi(t))return t.move({offset:!0}),t.end(),!1},"interactions:stop":function(n){var t=n.interaction;t.offset.total.x=0,t.offset.total.y=0,t.offset.pending.x=0,t.offset.pending.y=0}}},Gi=yr,br=function(){function n(t){g(this,n),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=t}return o(n,[{key:"start",value:function(t){var s=this.interaction,p=zn(s);if(!p||!p.enabled)return!1;var b=s.coords.velocity.client,j=Rt(b.x,b.y),H=this.modification||(this.modification=new ui(s));if(H.copyFrom(s.modification),this.t0=s._now(),this.allowResume=p.allowResume,this.v0=j,this.currentOffset={x:0,y:0},this.startCoords=s.coords.cur.page,this.modifierArg=H.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-s.coords.cur.timeStamp<50&&j>p.minSpeed&&j>p.endSpeed)this.startInertia();else{if(H.result=H.setAll(this.modifierArg),!H.result.changed)return!1;this.startSmoothEnd()}return s.modification.result.rect=null,s.offsetBy(this.targetOffset),s._doPhase({interaction:s,event:t,phase:"inertiastart"}),s.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),s.modification.result.rect=null,this.active=!0,s.simulation=this,!0}},{key:"startInertia",value:function(){var t=this,s=this.interaction.coords.velocity.client,p=zn(this.interaction),b=p.resistance,j=-Math.log(p.endSpeed/this.v0)/b;this.targetOffset={x:(s.x-j)/b,y:(s.y-j)/b},this.te=j,this.lambda_v0=b/this.v0,this.one_ve_v0=1-p.endSpeed/this.v0;var H=this.modification,J=this.modifierArg;J.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},H.result=H.setAll(J),H.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+H.result.delta.x,y:this.targetOffset.y+H.result.delta.y}),this.onNextFrame(function(){return t.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var t=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return t.smoothEndTick()})}},{key:"onNextFrame",value:function(t){var s=this;this.timeout=Lt.request(function(){s.active&&t()})}},{key:"inertiaTick",value:function(){var t,s,p,b,j,H,J,it=this,lt=this.interaction,st=zn(lt).resistance,pt=(lt._now()-this.t0)/1e3;if(pt<this.te){var yt,At=1-(Math.exp(-st*pt)-this.lambda_v0)/this.one_ve_v0;this.isModified?(t=0,s=0,p=this.targetOffset.x,b=this.targetOffset.y,j=this.modifiedOffset.x,H=this.modifiedOffset.y,yt={x:Yi(J=At,t,p,j),y:Yi(J,s,b,H)}):yt={x:this.targetOffset.x*At,y:this.targetOffset.y*At};var _t={x:yt.x-this.currentOffset.x,y:yt.y-this.currentOffset.y};this.currentOffset.x+=_t.x,this.currentOffset.y+=_t.y,lt.offsetBy(_t),lt.move(),this.onNextFrame(function(){return it.inertiaTick()})}else lt.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var t=this,s=this.interaction,p=s._now()-this.t0,b=zn(s).smoothEndDuration;if(p<b){var j={x:Wi(p,0,this.targetOffset.x,b),y:Wi(p,0,this.targetOffset.y,b)},H={x:j.x-this.currentOffset.x,y:j.y-this.currentOffset.y};this.currentOffset.x+=H.x,this.currentOffset.y+=H.y,s.offsetBy(H),s.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return t.smoothEndTick()})}else s.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(t){var s=t.pointer,p=t.event,b=t.eventTarget,j=this.interaction;j.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),j.updatePointer(s,p,b,!0),j._doPhase({interaction:j,event:p,phase:"resume"}),mt(j.coords.prev,j.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Lt.cancel(this.timeout)}}]),n}();function zn(n){var t=n.interactable,s=n.prepared;return t&&t.options&&s.name&&t.options[s.name].inertia}var xr={id:"inertia",before:["modifiers","actions"],install:function(n){var t=n.defaults;n.usePlugin(Gi),n.usePlugin(qi),n.actions.phases.inertiastart=!0,n.actions.phases.resume=!0,t.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(n){var t=n.interaction;t.inertia=new br(t)},"interactions:before-action-end":function(n){var t=n.interaction,s=n.event;return(!t._interacting||t.simulation||!t.inertia.start(s))&&null},"interactions:down":function(n){var t=n.interaction,s=n.eventTarget,p=t.inertia;if(p.active)for(var b=s;l.element(b);){if(b===t.element){p.resume(n);break}b=K(b)}},"interactions:stop":function(n){var t=n.interaction.inertia;t.active&&t.stop()},"interactions:before-action-resume":function(n){var t=n.interaction.modification;t.stop(n),t.start(n,n.interaction.coords.cur.page),t.applyToInteraction(n)},"interactions:before-action-inertiastart":function(n){return n.interaction.modification.setAndApply(n)},"interactions:action-resume":wn,"interactions:action-inertiastart":wn,"interactions:after-action-inertiastart":function(n){return n.interaction.modification.restoreInteractionCoords(n)},"interactions:after-action-resume":function(n){return n.interaction.modification.restoreInteractionCoords(n)}}};function Yi(n,t,s,p){var b=1-n;return b*b*t+2*b*n*s+n*n*p}function Wi(n,t,s,p){return-s*(n/=p)*(n-2)+t}var wr=xr;function Xi(n,t){for(var s=0;s<t.length;s++){var p=t[s];if(n.immediatePropagationStopped)break;p(n)}}var Ki=function(){function n(t){g(this,n),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=Z({},t||{})}return o(n,[{key:"fire",value:function(t){var s,p=this.global;(s=this.types[t.type])&&Xi(t,s),!t.propagationStopped&&p&&(s=p[t.type])&&Xi(t,s)}},{key:"on",value:function(t,s){var p=Ot(t,s);for(t in p)this.types[t]=Ee(this.types[t]||[],p[t])}},{key:"off",value:function(t,s){var p=Ot(t,s);for(t in p){var b=this.types[t];if(b&&b.length)for(var j=0,H=p[t];j<H.length;j++){var J=H[j],it=b.indexOf(J);it!==-1&&b.splice(it,1)}}}},{key:"getRect",value:function(t){return null}}]),n}(),Sr=function(){function n(t){g(this,n),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=t,vt(this,t)}return o(n,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),n}();function Sn(n){return l.object(n)?{capture:!!n.capture,passive:!!n.passive}:{capture:!!n,passive:!1}}function Vn(n,t){return n===t||(typeof n=="boolean"?!!t.capture===n&&!t.passive:!!n.capture==!!t.capture&&!!n.passive==!!t.passive)}var Er={id:"events",install:function(n){var t,s=[],p={},b=[],j={add:H,remove:J,addDelegate:function(st,pt,yt,At,_t){var Dt=Sn(_t);if(!p[yt]){p[yt]=[];for(var Nt=0;Nt<b.length;Nt++){var It=b[Nt];H(It,yt,it),H(It,yt,lt,!0)}}var qt=p[yt],Wt=Ne(qt,function(Zt){return Zt.selector===st&&Zt.context===pt});Wt||(Wt={selector:st,context:pt,listeners:[]},qt.push(Wt)),Wt.listeners.push({func:At,options:Dt})},removeDelegate:function(st,pt,yt,At,_t){var Dt,Nt=Sn(_t),It=p[yt],qt=!1;if(It)for(Dt=It.length-1;Dt>=0;Dt--){var Wt=It[Dt];if(Wt.selector===st&&Wt.context===pt){for(var Zt=Wt.listeners,Ut=Zt.length-1;Ut>=0;Ut--){var Xt=Zt[Ut];if(Xt.func===At&&Vn(Xt.options,Nt)){Zt.splice(Ut,1),Zt.length||(It.splice(Dt,1),J(pt,yt,it),J(pt,yt,lt,!0)),qt=!0;break}}if(qt)break}}},delegateListener:it,delegateUseCapture:lt,delegatedEvents:p,documents:b,targets:s,supportsOptions:!1,supportsPassive:!1};function H(st,pt,yt,At){if(st.addEventListener){var _t=Sn(At),Dt=Ne(s,function(Nt){return Nt.eventTarget===st});Dt||(Dt={eventTarget:st,events:{}},s.push(Dt)),Dt.events[pt]||(Dt.events[pt]=[]),Ne(Dt.events[pt],function(Nt){return Nt.func===yt&&Vn(Nt.options,_t)})||(st.addEventListener(pt,yt,j.supportsOptions?_t:_t.capture),Dt.events[pt].push({func:yt,options:_t}))}}function J(st,pt,yt,At){if(st.addEventListener&&st.removeEventListener){var _t=Ie(s,function(ye){return ye.eventTarget===st}),Dt=s[_t];if(Dt&&Dt.events)if(pt!=="all"){var Nt=!1,It=Dt.events[pt];if(It){if(yt==="all"){for(var qt=It.length-1;qt>=0;qt--){var Wt=It[qt];J(st,pt,Wt.func,Wt.options)}return}for(var Zt=Sn(At),Ut=0;Ut<It.length;Ut++){var Xt=It[Ut];if(Xt.func===yt&&Vn(Xt.options,Zt)){st.removeEventListener(pt,yt,j.supportsOptions?Zt:Zt.capture),It.splice(Ut,1),It.length===0&&(delete Dt.events[pt],Nt=!0);break}}}Nt&&!Object.keys(Dt.events).length&&s.splice(_t,1)}else for(pt in Dt.events)Dt.events.hasOwnProperty(pt)&&J(st,pt,"all")}}function it(st,pt){for(var yt=Sn(pt),At=new Sr(st),_t=p[st.type],Dt=Se(st)[0],Nt=Dt;l.element(Nt);){for(var It=0;It<_t.length;It++){var qt=_t[It],Wt=qt.selector,Zt=qt.context;if(rt(Nt,Wt)&&q(Zt,Dt)&&q(Zt,Nt)){var Ut=qt.listeners;At.currentTarget=Nt;for(var Xt=0;Xt<Ut.length;Xt++){var ye=Ut[Xt];Vn(ye.options,yt)&&ye.func(At)}}}Nt=K(Nt)}}function lt(st){return it(st,!0)}return(t=n.document)==null||t.createElement("div").addEventListener("test",null,{get capture(){return j.supportsOptions=!0},get passive(){return j.supportsPassive=!0}}),n.events=j,j}},pi={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(n){for(var t=0,s=pi.methodOrder;t<s.length;t++){var p=s[t],b=pi[p](n);if(b)return b}return null},simulationResume:function(n){var t=n.pointerType,s=n.eventType,p=n.eventTarget,b=n.scope;if(!/down|start/i.test(s))return null;for(var j=0,H=b.interactions.list;j<H.length;j++){var J=H[j],it=p;if(J.simulation&&J.simulation.allowResume&&J.pointerType===t)for(;it;){if(it===J.element)return J;it=K(it)}}return null},mouseOrPen:function(n){var t,s=n.pointerId,p=n.pointerType,b=n.eventType,j=n.scope;if(p!=="mouse"&&p!=="pen")return null;for(var H=0,J=j.interactions.list;H<J.length;H++){var it=J[H];if(it.pointerType===p){if(it.simulation&&!Ji(it,s))continue;if(it.interacting())return it;t||(t=it)}}if(t)return t;for(var lt=0,st=j.interactions.list;lt<st.length;lt++){var pt=st[lt];if(!(pt.pointerType!==p||/down/i.test(b)&&pt.simulation))return pt}return null},hasPointer:function(n){for(var t=n.pointerId,s=0,p=n.scope.interactions.list;s<p.length;s++){var b=p[s];if(Ji(b,t))return b}return null},idle:function(n){for(var t=n.pointerType,s=0,p=n.scope.interactions.list;s<p.length;s++){var b=p[s];if(b.pointers.length===1){var j=b.interactable;if(j&&(!j.options.gesture||!j.options.gesture.enabled))continue}else if(b.pointers.length>=2)continue;if(!b.interacting()&&t===b.pointerType)return b}return null}};function Ji(n,t){return n.pointers.some(function(s){return s.id===t})}var Cr=pi,fi=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function Zi(n,t){return function(s){var p=t.interactions.list,b=rn(s),j=Se(s),H=j[0],J=j[1],it=[];if(/^touch/.test(s.type)){t.prevTouchTime=t.now();for(var lt=0,st=s.changedTouches;lt<st.length;lt++){var pt=st[lt],yt={pointer:pt,pointerId:ie(pt),pointerType:b,eventType:s.type,eventTarget:H,curEventTarget:J,scope:t},At=Qi(yt);it.push([yt.pointer,yt.eventTarget,yt.curEventTarget,At])}}else{var _t=!1;if(!L.supportsPointerEvent&&/mouse/.test(s.type)){for(var Dt=0;Dt<p.length&&!_t;Dt++)_t=p[Dt].pointerType!=="mouse"&&p[Dt].pointerIsDown;_t=_t||t.now()-t.prevTouchTime<500||s.timeStamp===0}if(!_t){var Nt={pointer:s,pointerId:ie(s),pointerType:b,eventType:s.type,curEventTarget:J,eventTarget:H,scope:t},It=Qi(Nt);it.push([Nt.pointer,Nt.eventTarget,Nt.curEventTarget,It])}}for(var qt=0;qt<it.length;qt++){var Wt=it[qt],Zt=Wt[0],Ut=Wt[1],Xt=Wt[2];Wt[3][n](Zt,s,Ut,Xt)}}}function Qi(n){var t=n.pointerType,s=n.scope,p={interaction:Cr.search(n),searchDetails:n};return s.fire("interactions:find",p),p.interaction||s.interactions.new({pointerType:t})}function gi(n,t){var s=n.doc,p=n.scope,b=n.options,j=p.interactions.docEvents,H=p.events,J=H[t];for(var it in p.browser.isIOS&&!b.events&&(b.events={passive:!1}),H.delegatedEvents)J(s,it,H.delegateListener),J(s,it,H.delegateUseCapture,!0);for(var lt=b&&b.events,st=0;st<j.length;st++){var pt=j[st];J(s,pt.type,pt.listener,lt)}}var _r={id:"core/interactions",install:function(n){for(var t={},s=0;s<fi.length;s++){var p=fi[s];t[p]=Zi(p,n)}var b,j=L.pEventTypes;function H(){for(var J=0,it=n.interactions.list;J<it.length;J++){var lt=it[J];if(lt.pointerIsDown&&lt.pointerType==="touch"&&!lt._interacting)for(var st=function(){var At=yt[pt];n.documents.some(function(_t){return q(_t.doc,At.downTarget)})||lt.removePointer(At.pointer,At.event)},pt=0,yt=lt.pointers;pt<yt.length;pt++)st()}}(b=V.PointerEvent?[{type:j.down,listener:H},{type:j.down,listener:t.pointerDown},{type:j.move,listener:t.pointerMove},{type:j.up,listener:t.pointerUp},{type:j.cancel,listener:t.pointerUp}]:[{type:"mousedown",listener:t.pointerDown},{type:"mousemove",listener:t.pointerMove},{type:"mouseup",listener:t.pointerUp},{type:"touchstart",listener:H},{type:"touchstart",listener:t.pointerDown},{type:"touchmove",listener:t.pointerMove},{type:"touchend",listener:t.pointerUp},{type:"touchcancel",listener:t.pointerUp}]).push({type:"blur",listener:function(J){for(var it=0,lt=n.interactions.list;it<lt.length;it++)lt[it].documentBlur(J)}}),n.prevTouchTime=0,n.Interaction=function(J){u(lt,J);var it=O(lt);function lt(){return g(this,lt),it.apply(this,arguments)}return o(lt,[{key:"pointerMoveTolerance",get:function(){return n.interactions.pointerMoveTolerance},set:function(st){n.interactions.pointerMoveTolerance=st}},{key:"_now",value:function(){return n.now()}}]),lt}(mr),n.interactions={list:[],new:function(J){J.scopeFire=function(lt,st){return n.fire(lt,st)};var it=new n.Interaction(J);return n.interactions.list.push(it),it},listeners:t,docEvents:b,pointerMoveTolerance:1},n.usePlugin(Bi)},listeners:{"scope:add-document":function(n){return gi(n,"add")},"scope:remove-document":function(n){return gi(n,"remove")},"interactable:unset":function(n,t){for(var s=n.interactable,p=t.interactions.list.length-1;p>=0;p--){var b=t.interactions.list[p];b.interactable===s&&(b.stop(),t.fire("interactions:destroy",{interaction:b}),b.destroy(),t.interactions.list.length>2&&t.interactions.list.splice(p,1))}}},onDocSignal:gi,doOnInteractions:Zi,methodNames:fi},Pr=_r,Qe=function(n){return n[n.On=0]="On",n[n.Off=1]="Off",n}(Qe||{}),kr=function(){function n(t,s,p,b){g(this,n),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new Ki,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=s.actions,this.target=t,this._context=s.context||p,this._win=M(ot(t)?this._context:t),this._doc=this._win.document,this._scopeEvents=b,this.set(s)}return o(n,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(t,s){return l.func(s.onstart)&&this.on("".concat(t,"start"),s.onstart),l.func(s.onmove)&&this.on("".concat(t,"move"),s.onmove),l.func(s.onend)&&this.on("".concat(t,"end"),s.onend),l.func(s.oninertiastart)&&this.on("".concat(t,"inertiastart"),s.oninertiastart),this}},{key:"updatePerActionListeners",value:function(t,s,p){var b,j=this,H=(b=this._actions.map[t])==null?void 0:b.filterEventType,J=function(it){return(H==null||H(it))&&Bn(it,j._actions)};(l.array(s)||l.object(s))&&this._onOff(Qe.Off,t,s,void 0,J),(l.array(p)||l.object(p))&&this._onOff(Qe.On,t,p,void 0,J)}},{key:"setPerAction",value:function(t,s){var p=this._defaults;for(var b in s){var j=b,H=this.options[t],J=s[j];j==="listeners"&&this.updatePerActionListeners(t,H.listeners,J),l.array(J)?H[j]=Ue(J):l.plainObject(J)?(H[j]=Z(H[j]||{},gn(J)),l.object(p.perAction[j])&&"enabled"in p.perAction[j]&&(H[j].enabled=J.enabled!==!1)):l.bool(J)&&l.object(p.perAction[j])?H[j].enabled=J:H[j]=J}}},{key:"getRect",value:function(t){return t=t||(l.element(this.target)?this.target:null),l.string(this.target)&&(t=t||this._context.querySelector(this.target)),U(t)}},{key:"rectChecker",value:function(t){var s=this;return l.func(t)?(this.getRect=function(p){var b=Z({},t.apply(s,p));return"width"in b||(b.width=b.right-b.left,b.height=b.bottom-b.top),b},this):t===null?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(t,s){if(ot(s)||l.object(s)){for(var p in this.options[t]=s,this._actions.map)this.options[p][t]=s;return this}return this.options[t]}},{key:"origin",value:function(t){return this._backCompatOption("origin",t)}},{key:"deltaSource",value:function(t){return t==="page"||t==="client"?(this.options.deltaSource=t,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var t=this.target;return l.string(t)?Array.from(this._context.querySelectorAll(t)):l.func(t)&&t.getAllElements?t.getAllElements():l.element(t)?[t]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(t){return this._context===t.ownerDocument||q(this._context,t)}},{key:"testIgnoreAllow",value:function(t,s,p){return!this.testIgnore(t.ignoreFrom,s,p)&&this.testAllow(t.allowFrom,s,p)}},{key:"testAllow",value:function(t,s,p){return!t||!!l.element(p)&&(l.string(t)?h(p,t,s):!!l.element(t)&&q(t,p))}},{key:"testIgnore",value:function(t,s,p){return!(!t||!l.element(p))&&(l.string(t)?h(p,t,s):!!l.element(t)&&q(t,p))}},{key:"fire",value:function(t){return this.events.fire(t),this}},{key:"_onOff",value:function(t,s,p,b,j){l.object(s)&&!l.array(s)&&(b=p,p=null);var H=Ot(s,p,j);for(var J in H){J==="wheel"&&(J=L.wheelEvent);for(var it=0,lt=H[J];it<lt.length;it++){var st=lt[it];Bn(J,this._actions)?this.events[t===Qe.On?"on":"off"](J,st):l.string(this.target)?this._scopeEvents[t===Qe.On?"addDelegate":"removeDelegate"](this.target,this._context,J,st,b):this._scopeEvents[t===Qe.On?"add":"remove"](this.target,J,st,b)}}return this}},{key:"on",value:function(t,s,p){return this._onOff(Qe.On,t,s,p)}},{key:"off",value:function(t,s,p){return this._onOff(Qe.Off,t,s,p)}},{key:"set",value:function(t){var s=this._defaults;for(var p in l.object(t)||(t={}),this.options=gn(s.base),this._actions.methodDict){var b=p,j=this._actions.methodDict[b];this.options[b]={},this.setPerAction(b,Z(Z({},s.perAction),s.actions[b])),this[j](t[b])}for(var H in t)H!=="getRect"?l.func(this[H])&&this[H](t[H]):this.rectChecker(t.getRect);return this}},{key:"unset",value:function(){if(l.string(this.target))for(var t in this._scopeEvents.delegatedEvents)for(var s=this._scopeEvents.delegatedEvents[t],p=s.length-1;p>=0;p--){var b=s[p],j=b.selector,H=b.context,J=b.listeners;j===this.target&&H===this._context&&s.splice(p,1);for(var it=J.length-1;it>=0;it--)this._scopeEvents.removeDelegate(this.target,this._context,t,J[it][0],J[it][1])}else this._scopeEvents.remove(this.target,"all")}}]),n}(),Ar=function(){function n(t){var s=this;g(this,n),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=t,t.addListeners({"interactable:unset":function(p){var b=p.interactable,j=b.target,H=l.string(j)?s.selectorMap[j]:j[s.scope.id],J=Ie(H,function(it){return it===b});H.splice(J,1)}})}return o(n,[{key:"new",value:function(t,s){s=Z(s||{},{actions:this.scope.actions});var p=new this.scope.Interactable(t,s,this.scope.document,this.scope.events);return this.scope.addDocument(p._doc),this.list.push(p),l.string(t)?(this.selectorMap[t]||(this.selectorMap[t]=[]),this.selectorMap[t].push(p)):(p.target[this.scope.id]||Object.defineProperty(t,this.scope.id,{value:[],configurable:!0}),t[this.scope.id].push(p)),this.scope.fire("interactable:new",{target:t,options:s,interactable:p,win:this.scope._win}),p}},{key:"getExisting",value:function(t,s){var p=s&&s.context||this.scope.document,b=l.string(t),j=b?this.selectorMap[t]:t[this.scope.id];if(j)return Ne(j,function(H){return H._context===p&&(b||H.inContext(t))})}},{key:"forEachMatch",value:function(t,s){for(var p=0,b=this.list;p<b.length;p++){var j=b[p],H=void 0;if((l.string(j.target)?l.element(t)&&rt(t,j.target):t===j.target)&&j.inContext(t)&&(H=s(j)),H!==void 0)return H}}}]),n}(),Dr=function(){function n(){var t=this;g(this,n),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=L,this.defaults=gn(zi),this.Eventable=Ki,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(p){var b=function j(H,J){var it=p.interactables.getExisting(H,J);return it||((it=p.interactables.new(H,J)).events.global=j.globalEvents),it};return b.getPointerAverage=we,b.getTouchBBox=xe,b.getTouchDistance=Xe,b.getTouchAngle=Ke,b.getElementRect=U,b.getElementClientRect=z,b.matchesSelector=rt,b.closest=tt,b.globalEvents={},b.version="1.10.27",b.scope=p,b.use=function(j,H){return this.scope.usePlugin(j,H),this},b.isSet=function(j,H){return!!this.scope.interactables.get(j,H&&H.context)},b.on=se(function(j,H,J){if(l.string(j)&&j.search(" ")!==-1&&(j=j.trim().split(/ +/)),l.array(j)){for(var it=0,lt=j;it<lt.length;it++){var st=lt[it];this.on(st,H,J)}return this}if(l.object(j)){for(var pt in j)this.on(pt,j[pt],H);return this}return Bn(j,this.scope.actions)?this.globalEvents[j]?this.globalEvents[j].push(H):this.globalEvents[j]=[H]:this.scope.events.add(this.scope.document,j,H,{options:J}),this},"The interact.on() method is being deprecated"),b.off=se(function(j,H,J){if(l.string(j)&&j.search(" ")!==-1&&(j=j.trim().split(/ +/)),l.array(j)){for(var it=0,lt=j;it<lt.length;it++){var st=lt[it];this.off(st,H,J)}return this}if(l.object(j)){for(var pt in j)this.off(pt,j[pt],H);return this}var yt;return Bn(j,this.scope.actions)?j in this.globalEvents&&(yt=this.globalEvents[j].indexOf(H))!==-1&&this.globalEvents[j].splice(yt,1):this.scope.events.remove(this.scope.document,j,H,J),this},"The interact.off() method is being deprecated"),b.debug=function(){return this.scope},b.supportsTouch=function(){return L.supportsTouch},b.supportsPointerEvent=function(){return L.supportsPointerEvent},b.stop=function(){for(var j=0,H=this.scope.interactions.list;j<H.length;j++)H[j].stop();return this},b.pointerMoveTolerance=function(j){return l.number(j)?(this.scope.interactions.pointerMoveTolerance=j,this):this.scope.interactions.pointerMoveTolerance},b.addDocument=function(j,H){this.scope.addDocument(j,H)},b.removeDocument=function(j){this.scope.removeDocument(j)},b}(this),this.InteractEvent=di,this.Interactable=void 0,this.interactables=new Ar(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(p){return t.removeDocument(p.target)};var s=this;this.Interactable=function(p){u(j,p);var b=O(j);function j(){return g(this,j),b.apply(this,arguments)}return o(j,[{key:"_defaults",get:function(){return s.defaults}},{key:"set",value:function(H){return D(r(j.prototype),"set",this).call(this,H),s.fire("interactable:set",{options:H,interactable:this}),this}},{key:"unset",value:function(){D(r(j.prototype),"unset",this).call(this);var H=s.interactables.list.indexOf(this);H<0||(s.interactables.list.splice(H,1),s.fire("interactable:unset",{interactable:this}))}}]),j}(kr)}return o(n,[{key:"addListeners",value:function(t,s){this.listenerMaps.push({id:s,map:t})}},{key:"fire",value:function(t,s){for(var p=0,b=this.listenerMaps;p<b.length;p++){var j=b[p].map[t];if(j&&j(s,this,t)===!1)return!1}}},{key:"init",value:function(t){return this.isInitialized?this:function(s,p){return s.isInitialized=!0,l.window(p)&&B(p),V.init(p),L.init(p),Lt.init(p),s.window=p,s.document=p.document,s.usePlugin(Pr),s.usePlugin(Er),s}(this,t)}},{key:"pluginIsInstalled",value:function(t){var s=t.id;return s?!!this._plugins.map[s]:this._plugins.list.indexOf(t)!==-1}},{key:"usePlugin",value:function(t,s){if(!this.isInitialized)return this;if(this.pluginIsInstalled(t))return this;if(t.id&&(this._plugins.map[t.id]=t),this._plugins.list.push(t),t.install&&t.install(this,s),t.listeners&&t.before){for(var p=0,b=this.listenerMaps.length,j=t.before.reduce(function(J,it){return J[it]=!0,J[ts(it)]=!0,J},{});p<b;p++){var H=this.listenerMaps[p].id;if(H&&(j[H]||j[ts(H)]))break}this.listenerMaps.splice(p,0,{id:t.id,map:t.listeners})}else t.listeners&&this.listenerMaps.push({id:t.id,map:t.listeners});return this}},{key:"addDocument",value:function(t,s){if(this.getDocIndex(t)!==-1)return!1;var p=M(t);s=s?Z({},s):{},this.documents.push({doc:t,options:s}),this.events.documents.push(t),t!==this.document&&this.events.add(p,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:t,window:p,scope:this,options:s})}},{key:"removeDocument",value:function(t){var s=this.getDocIndex(t),p=M(t),b=this.documents[s].options;this.events.remove(p,"unload",this.onWindowUnload),this.documents.splice(s,1),this.events.documents.splice(s,1),this.fire("scope:remove-document",{doc:t,window:p,scope:this,options:b})}},{key:"getDocIndex",value:function(t){for(var s=0;s<this.documents.length;s++)if(this.documents[s].doc===t)return s;return-1}},{key:"getDocOptions",value:function(t){var s=this.getDocIndex(t);return s===-1?null:this.documents[s].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),n}();function ts(n){return n&&n.replace(/\/.*$/,"")}var es=new Dr,ve=es.interactStatic,Tr=typeof globalThis<"u"?globalThis:window;es.init(Tr);var Or=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(n){var t=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(p){var b=p[0],j=p[1];return b in n||j in n}),s=function(p,b){for(var j=n.range,H=n.limits,J=H===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:H,it=n.offset,lt=it===void 0?{x:0,y:0}:it,st={range:j,grid:n,x:null,y:null},pt=0;pt<t.length;pt++){var yt=t[pt],At=yt[0],_t=yt[1],Dt=Math.round((p-lt.x)/n[At]),Nt=Math.round((b-lt.y)/n[_t]);st[At]=Math.max(J.left,Math.min(J.right,Dt*n[At]+lt.x)),st[_t]=Math.max(J.top,Math.min(J.bottom,Nt*n[_t]+lt.y))}return st};return s.grid=n,s.coordFields=t,s}}),Lr={id:"snappers",install:function(n){var t=n.interactStatic;t.snappers=Z(t.snappers||{},Or),t.createSnapGrid=t.snappers.grid}},jr=Lr,Mr={start:function(n){var t=n.state,s=n.rect,p=n.edges,b=n.pageCoords,j=t.options,H=j.ratio,J=j.enabled,it=t.options,lt=it.equalDelta,st=it.modifiers;H==="preserve"&&(H=s.width/s.height),t.startCoords=Z({},b),t.startRect=Z({},s),t.ratio=H,t.equalDelta=lt;var pt=t.linkedEdges={top:p.top||p.left&&!p.bottom,left:p.left||p.top&&!p.right,bottom:p.bottom||p.right&&!p.top,right:p.right||p.bottom&&!p.left};if(t.xIsPrimaryAxis=!(!p.left&&!p.right),t.equalDelta){var yt=(pt.left?1:-1)*(pt.top?1:-1);t.edgeSign={x:yt,y:yt}}else t.edgeSign={x:pt.left?-1:1,y:pt.top?-1:1};if(J!==!1&&Z(p,pt),st!=null&&st.length){var At=new ui(n.interaction);At.copyFrom(n.interaction.modification),At.prepareStates(st),t.subModification=At,At.startAll(d({},n))}},set:function(n){var t=n.state,s=n.rect,p=n.coords,b=t.linkedEdges,j=Z({},p),H=t.equalDelta?Ir:Nr;if(Z(n.edges,b),H(t,t.xIsPrimaryAxis,p,s),!t.subModification)return null;var J=Z({},s);xt(b,J,{x:p.x-j.x,y:p.y-j.y});var it=t.subModification.setAll(d(d({},n),{},{rect:J,edges:b,pageCoords:p,prevCoords:p,prevRect:J})),lt=it.delta;return it.changed&&(H(t,Math.abs(lt.x)>Math.abs(lt.y),it.coords,it.rect),Z(p,it.coords)),it.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function Ir(n,t,s){var p=n.startCoords,b=n.edgeSign;t?s.y=p.y+(s.x-p.x)*b.y:s.x=p.x+(s.y-p.y)*b.x}function Nr(n,t,s,p){var b=n.startRect,j=n.startCoords,H=n.ratio,J=n.edgeSign;if(t){var it=p.width/H;s.y=j.y+(it-b.height)*J.y}else{var lt=p.height*H;s.x=j.x+(lt-b.width)*J.x}}var Fr=Ze(Mr,"aspectRatio"),ns=function(){};ns._defaults={};var Un=ns;function cn(n,t,s){return l.func(n)?dt(n,t.interactable,t.element,[s.x,s.y,t]):dt(n,t.interactable,t.element)}var Hn={start:function(n){var t=n.rect,s=n.startOffset,p=n.state,b=n.interaction,j=n.pageCoords,H=p.options,J=H.elementRect,it=Z({left:0,top:0,right:0,bottom:0},H.offset||{});if(t&&J){var lt=cn(H.restriction,b,j);if(lt){var st=lt.right-lt.left-t.width,pt=lt.bottom-lt.top-t.height;st<0&&(it.left+=st,it.right+=st),pt<0&&(it.top+=pt,it.bottom+=pt)}it.left+=s.left-t.width*J.left,it.top+=s.top-t.height*J.top,it.right+=s.right-t.width*(1-J.right),it.bottom+=s.bottom-t.height*(1-J.bottom)}p.offset=it},set:function(n){var t=n.coords,s=n.interaction,p=n.state,b=p.options,j=p.offset,H=cn(b.restriction,s,t);if(H){var J=function(it){return!it||"left"in it&&"top"in it||((it=Z({},it)).left=it.x||0,it.top=it.y||0,it.right=it.right||it.left+it.width,it.bottom=it.bottom||it.top+it.height),it}(H);t.x=Math.max(Math.min(J.right-j.right,t.x),J.left+j.left),t.y=Math.max(Math.min(J.bottom-j.bottom,t.y),J.top+j.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},Rr=Ze(Hn,"restrict"),is={top:1/0,left:1/0,bottom:-1/0,right:-1/0},ss={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function rs(n,t){for(var s=0,p=["top","left","bottom","right"];s<p.length;s++){var b=p[s];b in n||(n[b]=t[b])}return n}var En={noInner:is,noOuter:ss,start:function(n){var t,s=n.interaction,p=n.startOffset,b=n.state,j=b.options;j&&(t=ft(cn(j.offset,s,s.coords.start.page))),t=t||{x:0,y:0},b.offset={top:t.y+p.top,left:t.x+p.left,bottom:t.y-p.bottom,right:t.x-p.right}},set:function(n){var t=n.coords,s=n.edges,p=n.interaction,b=n.state,j=b.offset,H=b.options;if(s){var J=Z({},t),it=cn(H.inner,p,J)||{},lt=cn(H.outer,p,J)||{};rs(it,is),rs(lt,ss),s.top?t.y=Math.min(Math.max(lt.top+j.top,J.y),it.top+j.top):s.bottom&&(t.y=Math.max(Math.min(lt.bottom+j.bottom,J.y),it.bottom+j.bottom)),s.left?t.x=Math.min(Math.max(lt.left+j.left,J.x),it.left+j.left):s.right&&(t.x=Math.max(Math.min(lt.right+j.right,J.x),it.right+j.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},$r=Ze(En,"restrictEdges"),Br=Z({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(n){}},Hn.defaults),qr=Ze({start:Hn.start,set:Hn.set,defaults:Br},"restrictRect"),zr={width:-1/0,height:-1/0},Vr={width:1/0,height:1/0},Ur=Ze({start:function(n){return En.start(n)},set:function(n){var t=n.interaction,s=n.state,p=n.rect,b=n.edges,j=s.options;if(b){var H=ct(cn(j.min,t,n.coords))||zr,J=ct(cn(j.max,t,n.coords))||Vr;s.options={endOnly:j.endOnly,inner:Z({},En.noInner),outer:Z({},En.noOuter)},b.top?(s.options.inner.top=p.bottom-H.height,s.options.outer.top=p.bottom-J.height):b.bottom&&(s.options.inner.bottom=p.top+H.height,s.options.outer.bottom=p.top+J.height),b.left?(s.options.inner.left=p.right-H.width,s.options.outer.left=p.right-J.width):b.right&&(s.options.inner.right=p.left+H.width,s.options.outer.right=p.left+J.width),En.set(n),s.options=j}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),mi={start:function(n){var t,s=n.interaction,p=n.interactable,b=n.element,j=n.rect,H=n.state,J=n.startOffset,it=H.options,lt=it.offsetWithOrigin?function(yt){var At=yt.interaction.element,_t=ft(dt(yt.state.options.origin,null,null,[At])),Dt=_t||Pt(yt.interactable,At,yt.interaction.prepared.name);return Dt}(n):{x:0,y:0};if(it.offset==="startCoords")t={x:s.coords.start.page.x,y:s.coords.start.page.y};else{var st=dt(it.offset,p,b,[s]);(t=ft(st)||{x:0,y:0}).x+=lt.x,t.y+=lt.y}var pt=it.relativePoints;H.offsets=j&&pt&&pt.length?pt.map(function(yt,At){return{index:At,relativePoint:yt,x:J.left-j.width*yt.x+t.x,y:J.top-j.height*yt.y+t.y}}):[{index:0,relativePoint:null,x:t.x,y:t.y}]},set:function(n){var t=n.interaction,s=n.coords,p=n.state,b=p.options,j=p.offsets,H=Pt(t.interactable,t.element,t.prepared.name),J=Z({},s),it=[];b.offsetWithOrigin||(J.x-=H.x,J.y-=H.y);for(var lt=0,st=j;lt<st.length;lt++)for(var pt=st[lt],yt=J.x-pt.x,At=J.y-pt.y,_t=0,Dt=b.targets.length;_t<Dt;_t++){var Nt=b.targets[_t],It=void 0;(It=l.func(Nt)?Nt(yt,At,t._proxy,pt,_t):Nt)&&it.push({x:(l.number(It.x)?It.x:yt)+pt.x,y:(l.number(It.y)?It.y:At)+pt.y,range:l.number(It.range)?It.range:b.range,source:Nt,index:_t,offset:pt})}for(var qt={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},Wt=0;Wt<it.length;Wt++){var Zt=it[Wt],Ut=Zt.range,Xt=Zt.x-J.x,ye=Zt.y-J.y,re=Rt(Xt,ye),Pe=re<=Ut;Ut===1/0&&qt.inRange&&qt.range!==1/0&&(Pe=!1),qt.target&&!(Pe?qt.inRange&&Ut!==1/0?re/Ut<qt.distance/qt.range:Ut===1/0&&qt.range!==1/0||re<qt.distance:!qt.inRange&&re<qt.distance)||(qt.target=Zt,qt.distance=re,qt.range=Ut,qt.inRange=Pe,qt.delta.x=Xt,qt.delta.y=ye)}return qt.inRange&&(s.x=qt.target.x,s.y=qt.target.y),p.closest=qt,qt},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},Hr=Ze(mi,"snap"),Gn={start:function(n){var t=n.state,s=n.edges,p=t.options;if(!s)return null;n.state={options:{targets:null,relativePoints:[{x:s.left?0:1,y:s.top?0:1}],offset:p.offset||"self",origin:{x:0,y:0},range:p.range}},t.targetFields=t.targetFields||[["width","height"],["x","y"]],mi.start(n),t.offsets=n.state.offsets,n.state=t},set:function(n){var t=n.interaction,s=n.state,p=n.coords,b=s.options,j=s.offsets,H={x:p.x-j[0].x,y:p.y-j[0].y};s.options=Z({},b),s.options.targets=[];for(var J=0,it=b.targets||[];J<it.length;J++){var lt=it[J],st=void 0;if(st=l.func(lt)?lt(H.x,H.y,t):lt){for(var pt=0,yt=s.targetFields;pt<yt.length;pt++){var At=yt[pt],_t=At[0],Dt=At[1];if(_t in st||Dt in st){st.x=st[_t],st.y=st[Dt];break}}s.options.targets.push(st)}}var Nt=mi.set(n);return s.options=b,Nt},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},Gr=Ze(Gn,"snapSize"),vi={aspectRatio:Fr,restrictEdges:$r,restrict:Rr,restrictRect:qr,restrictSize:Ur,snapEdges:Ze({start:function(n){var t=n.edges;return t?(n.state.targetFields=n.state.targetFields||[[t.left?"left":"right",t.top?"top":"bottom"]],Gn.start(n)):null},set:Gn.set,defaults:Z(gn(Gn.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:Hr,snapSize:Gr,spring:Un,avoid:Un,transform:Un,rubberband:Un},Yr={id:"modifiers",install:function(n){var t=n.interactStatic;for(var s in n.usePlugin(qi),n.usePlugin(jr),t.modifiers=vi,vi){var p=vi[s],b=p._defaults,j=p._methods;b._methods=j,n.defaults.perAction[s]=b}}},Wr=Yr,os=function(n){u(s,n);var t=O(s);function s(p,b,j,H,J,it){var lt;if(g(this,s),vt(E(lt=t.call(this,J)),j),j!==b&&vt(E(lt),b),lt.timeStamp=it,lt.originalEvent=j,lt.type=p,lt.pointerId=ie(b),lt.pointerType=rn(b),lt.target=H,lt.currentTarget=null,p==="tap"){var st=J.getPointerIndex(b);lt.dt=lt.timeStamp-J.pointers[st].downTime;var pt=lt.timeStamp-J.tapTime;lt.double=!!J.prevTap&&J.prevTap.type!=="doubletap"&&J.prevTap.target===lt.target&&pt<500}else p==="doubletap"&&(lt.dt=b.timeStamp-J.tapTime,lt.double=!0);return lt}return o(s,[{key:"_subtractOrigin",value:function(p){var b=p.x,j=p.y;return this.pageX-=b,this.pageY-=j,this.clientX-=b,this.clientY-=j,this}},{key:"_addOrigin",value:function(p){var b=p.x,j=p.y;return this.pageX+=b,this.pageY+=j,this.clientX+=b,this.clientY+=j,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),s}(Me),Cn={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(n){n.pointerEvents=Cn,n.defaults.actions.pointerEvents=Cn.defaults,Z(n.actions.phaselessTypes,Cn.types)},listeners:{"interactions:new":function(n){var t=n.interaction;t.prevTap=null,t.tapTime=0},"interactions:update-pointer":function(n){var t=n.down,s=n.pointerInfo;!t&&s.hold||(s.hold={duration:1/0,timeout:null})},"interactions:move":function(n,t){var s=n.interaction,p=n.pointer,b=n.event,j=n.eventTarget;n.duplicate||s.pointerIsDown&&!s.pointerWasMoved||(s.pointerIsDown&&yi(n),tn({interaction:s,pointer:p,event:b,eventTarget:j,type:"move"},t))},"interactions:down":function(n,t){(function(s,p){for(var b=s.interaction,j=s.pointer,H=s.event,J=s.eventTarget,it=s.pointerIndex,lt=b.pointers[it].hold,st=nt(J),pt={interaction:b,pointer:j,event:H,eventTarget:J,type:"hold",targets:[],path:st,node:null},yt=0;yt<st.length;yt++){var At=st[yt];pt.node=At,p.fire("pointerEvents:collect-targets",pt)}if(pt.targets.length){for(var _t=1/0,Dt=0,Nt=pt.targets;Dt<Nt.length;Dt++){var It=Nt[Dt].eventable.options.holdDuration;It<_t&&(_t=It)}lt.duration=_t,lt.timeout=setTimeout(function(){tn({interaction:b,eventTarget:J,pointer:j,event:H,type:"hold"},p)},_t)}})(n,t),tn(n,t)},"interactions:up":function(n,t){yi(n),tn(n,t),function(s,p){var b=s.interaction,j=s.pointer,H=s.event,J=s.eventTarget;b.pointerWasMoved||tn({interaction:b,eventTarget:J,pointer:j,event:H,type:"tap"},p)}(n,t)},"interactions:cancel":function(n,t){yi(n),tn(n,t)}},PointerEvent:os,fire:tn,collectEventTargets:as,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function tn(n,t){var s=n.interaction,p=n.pointer,b=n.event,j=n.eventTarget,H=n.type,J=n.targets,it=J===void 0?as(n,t):J,lt=new os(H,p,b,j,s,t.now());t.fire("pointerEvents:new",{pointerEvent:lt});for(var st={interaction:s,pointer:p,event:b,eventTarget:j,targets:it,type:H,pointerEvent:lt},pt=0;pt<it.length;pt++){var yt=it[pt];for(var At in yt.props||{})lt[At]=yt.props[At];var _t=Pt(yt.eventable,yt.node);if(lt._subtractOrigin(_t),lt.eventable=yt.eventable,lt.currentTarget=yt.node,yt.eventable.fire(lt),lt._addOrigin(_t),lt.immediatePropagationStopped||lt.propagationStopped&&pt+1<it.length&&it[pt+1].node!==lt.currentTarget)break}if(t.fire("pointerEvents:fired",st),H==="tap"){var Dt=lt.double?tn({interaction:s,pointer:p,event:b,eventTarget:j,type:"doubletap"},t):lt;s.prevTap=Dt,s.tapTime=Dt.timeStamp}return lt}function as(n,t){var s=n.interaction,p=n.pointer,b=n.event,j=n.eventTarget,H=n.type,J=s.getPointerIndex(p),it=s.pointers[J];if(H==="tap"&&(s.pointerWasMoved||!it||it.downTarget!==j))return[];for(var lt=nt(j),st={interaction:s,pointer:p,event:b,eventTarget:j,type:H,path:lt,targets:[],node:null},pt=0;pt<lt.length;pt++){var yt=lt[pt];st.node=yt,t.fire("pointerEvents:collect-targets",st)}return H==="hold"&&(st.targets=st.targets.filter(function(At){var _t,Dt;return At.eventable.options.holdDuration===((_t=s.pointers[J])==null||(Dt=_t.hold)==null?void 0:Dt.duration)})),st.targets}function yi(n){var t=n.interaction,s=n.pointerIndex,p=t.pointers[s].hold;p&&p.timeout&&(clearTimeout(p.timeout),p.timeout=null)}var Xr=Object.freeze({__proto__:null,default:Cn});function Kr(n){var t=n.interaction;t.holdIntervalHandle&&(clearInterval(t.holdIntervalHandle),t.holdIntervalHandle=null)}var Jr={id:"pointer-events/holdRepeat",install:function(n){n.usePlugin(Cn);var t=n.pointerEvents;t.defaults.holdRepeatInterval=0,t.types.holdrepeat=n.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(n,t){return n["pointerEvents:".concat(t)]=Kr,n},{"pointerEvents:new":function(n){var t=n.pointerEvent;t.type==="hold"&&(t.count=(t.count||0)+1)},"pointerEvents:fired":function(n,t){var s=n.interaction,p=n.pointerEvent,b=n.eventTarget,j=n.targets;if(p.type==="hold"&&j.length){var H=j[0].eventable.options.holdRepeatInterval;H<=0||(s.holdIntervalHandle=setTimeout(function(){t.pointerEvents.fire({interaction:s,eventTarget:b,type:"hold",pointer:p,event:p},t)},H))}}})},Zr=Jr,Qr={id:"pointer-events/interactableTargets",install:function(n){var t=n.Interactable;t.prototype.pointerEvents=function(p){return Z(this.events.options,p),this};var s=t.prototype._backCompatOption;t.prototype._backCompatOption=function(p,b){var j=s.call(this,p,b);return j===this&&(this.events.options[p]=b),j}},listeners:{"pointerEvents:collect-targets":function(n,t){var s=n.targets,p=n.node,b=n.type,j=n.eventTarget;t.interactables.forEachMatch(p,function(H){var J=H.events,it=J.options;J.types[b]&&J.types[b].length&&H.testIgnoreAllow(it,p,j)&&s.push({node:p,eventable:J,props:{interactable:H}})})},"interactable:new":function(n){var t=n.interactable;t.events.getRect=function(s){return t.getRect(s)}},"interactable:set":function(n,t){var s=n.interactable,p=n.options;Z(s.events.options,t.pointerEvents.defaults),Z(s.events.options,p.pointerEvents||{})}}},to=Qr,eo={id:"pointer-events",install:function(n){n.usePlugin(Xr),n.usePlugin(Zr),n.usePlugin(to)}},no=eo,io={id:"reflow",install:function(n){var t=n.Interactable;n.actions.phases.reflow=!0,t.prototype.reflow=function(s){return function(p,b,j){for(var H=p.getAllElements(),J=j.window.Promise,it=J?[]:null,lt=function(){var pt=H[st],yt=p.getRect(pt);if(!yt)return 1;var At,_t=Ne(j.interactions.list,function(It){return It.interacting()&&It.interactable===p&&It.element===pt&&It.prepared.name===b.name});if(_t)_t.move(),it&&(At=_t._reflowPromise||new J(function(It){_t._reflowResolve=It}));else{var Dt=ct(yt),Nt=function(It){return{coords:It,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:Dt.x,y:Dt.y},client:{x:Dt.x,y:Dt.y},timeStamp:j.now()});At=function(It,qt,Wt,Zt,Ut){var Xt=It.interactions.new({pointerType:"reflow"}),ye={interaction:Xt,event:Ut,pointer:Ut,eventTarget:Wt,phase:"reflow"};Xt.interactable=qt,Xt.element=Wt,Xt.prevEvent=Ut,Xt.updatePointer(Ut,Ut,Wt,!0),wt(Xt.coords.delta),Je(Xt.prepared,Zt),Xt._doPhase(ye);var re=It.window,Pe=re.Promise,Re=Pe?new Pe(function(Ge){Xt._reflowResolve=Ge}):void 0;return Xt._reflowPromise=Re,Xt.start(Zt,qt,Wt),Xt._interacting?(Xt.move(ye),Xt.end(Ut)):(Xt.stop(),Xt._reflowResolve()),Xt.removePointer(Ut,Ut),Re}(j,p,pt,b,Nt)}it&&it.push(At)},st=0;st<H.length&&!lt();st++);return it&&J.all(it).then(function(){return p})}(this,s,n)}},listeners:{"interactions:stop":function(n,t){var s=n.interaction;s.pointerType==="reflow"&&(s._reflowResolve&&s._reflowResolve(),function(p,b){p.splice(p.indexOf(b),1)}(t.interactions.list,s))}}},so=io;if(ve.use(Bi),ve.use(Gi),ve.use(no),ve.use(wr),ve.use(Wr),ve.use($n),ve.use(jt),ve.use(ee),ve.use(so),ve.default=ve,w(a)==="object"&&a)try{a.exports=ve}catch{}return ve.default=ve,ve})})(li,li.exports);var Pa=li.exports,Mn=Ns(Pa);typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(i,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var d=document.createEvent("CustomEvent");return d.initCustomEvent(i,e.bubbles,e.cancelable,e.detail),d}));var ka={};(function(a){(function(){typeof Math.sgn>"u"&&(Math.sgn=function(L){return L==0?0:L>0?1:-1});var i={subtract:function(L,q){return{x:L.x-q.x,y:L.y-q.y}},dotProduct:function(L,q){return L.x*q.x+L.y*q.y},square:function(L){return Math.sqrt(L.x*L.x+L.y*L.y)},scale:function(L,q){return{x:L.x*q,y:L.y*q}}},e=64,d=Math.pow(2,-e-1),w=function(L,q){for(var tt=[],K=S(L,q),rt=q.length-1,f=2*rt-1,_=o(K,f,tt,0),h=i.subtract(L,q[0]),N=i.square(h),z=0,U=0;U<_;U++){h=i.subtract(L,m(q,rt,tt[U],null,null));var nt=i.square(h);nt<N&&(N=nt,z=tt[U])}return h=i.subtract(L,q[rt]),nt=i.square(h),nt<N&&(N=nt,z=1),{location:z,distance:N}},g=function(L,q){var tt=w(L,q);return{point:m(q,q.length-1,tt.location,null,null),location:tt.location}},S=function(L,q){for(var tt=q.length-1,K=2*tt-1,rt=[],f=[],_=[],h=[],N=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],z=0;z<=tt;z++)rt[z]=i.subtract(q[z],L);for(var z=0;z<=tt-1;z++)f[z]=i.subtract(q[z+1],q[z]),f[z]=i.scale(f[z],3);for(var U=0;U<=tt-1;U++)for(var nt=0;nt<=tt;nt++)_[U]||(_[U]=[]),_[U][nt]=i.dotProduct(f[U],rt[nt]);for(z=0;z<=K;z++)h[z]||(h[z]=[]),h[z].y=0,h[z].x=parseFloat(z)/K;for(var ot=tt,Z=tt-1,ut=0;ut<=ot+Z;ut++){var dt=Math.max(0,ut-Z),ft=Math.min(ut,ot);for(z=dt;z<=ft;z++){var ct=ut-z;h[z+ct].y+=_[ct][z]*N[ct][z]}}return h},o=function(L,q,tt,K){var rt=[],f=[],_,h,N=[],z=[];switch(v(L,q)){case 0:return 0;case 1:{if(K>=e)return tt[0]=(L[0].x+L[q].x)/2,1;if(u(L,q))return tt[0]=r(L,q),1;break}}m(L,q,.5,rt,f),_=o(rt,q,N,K+1),h=o(f,q,z,K+1);for(var U=0;U<_;U++)tt[U]=N[U];for(var U=0;U<h;U++)tt[U+_]=z[U];return _+h},v=function(L,q){var tt=0,K,rt;K=rt=Math.sgn(L[0].y);for(var f=1;f<=q;f++)K=Math.sgn(L[f].y),K!=rt&&tt++,rt=K;return tt},u=function(L,q){var tt,K,rt,f,_,h,N,z,U,nt,ot,Z,ut,dt,ft,ct;h=L[0].y-L[q].y,N=L[q].x-L[0].x,z=L[0].x*L[q].y-L[q].x*L[0].y;var xt,Pt;xt=Pt=0;for(var Ot=1;Ot<q;Ot++){var Ct=h*L[Ot].x+N*L[Ot].y+z;Ct>xt?xt=Ct:Ct<Pt&&(Pt=Ct)}return ot=0,Z=1,ut=0,dt=h,ft=N,ct=z-xt,U=ot*ft-dt*Z,nt=1/U,K=(Z*ct-ft*ut)*nt,dt=h,ft=N,ct=z-Pt,U=ot*ft-dt*Z,nt=1/U,rt=(Z*ct-ft*ut)*nt,f=Math.min(K,rt),_=Math.max(K,rt),tt=_-f,tt<d?1:0},r=function(L,q){var tt=1,K=0,rt=L[q].x-L[0].x,f=L[q].y-L[0].y,_=L[0].x-0,h=L[0].y-0,N=rt*K-f*tt,z=1/N,U=(rt*h-f*_)*z;return 0+tt*U},m=function(L,q,tt,K,rt){for(var f=[[]],_=0;_<=q;_++)f[0][_]=L[_];for(var h=1;h<=q;h++)for(var _=0;_<=q-h;_++)f[h]||(f[h]=[]),f[h][_]||(f[h][_]={}),f[h][_].x=(1-tt)*f[h-1][_].x+tt*f[h-1][_+1].x,f[h][_].y=(1-tt)*f[h-1][_].y+tt*f[h-1][_+1].y;if(K!=null)for(_=0;_<=q;_++)K[_]=f[_][0];if(rt!=null)for(_=0;_<=q;_++)rt[_]=f[q-_][_];return f[q][0]},E={},O=function(L){var q=E[L];if(!q){q=[];var tt=function(){return function(nt){return Math.pow(nt,L)}},K=function(){return function(nt){return Math.pow(1-nt,L)}},rt=function(nt){return function(ot){return nt}},f=function(){return function(nt){return nt}},_=function(){return function(nt){return 1-nt}},h=function(nt){return function(ot){for(var Z=1,ut=0;ut<nt.length;ut++)Z=Z*nt[ut](ot);return Z}};q.push(new tt);for(var N=1;N<L;N++){for(var z=[new rt(L)],U=0;U<L-N;U++)z.push(new f);for(var U=0;U<N;U++)z.push(new _);q.push(new h(z))}q.push(new K),E[L]=q}return q},D=function(L,q){for(var tt=O(L.length-1),K=0,rt=0,f=0;f<L.length;f++)K=K+L[f].x*tt[f](q),rt=rt+L[f].y*tt[f](q);return{x:K,y:rt}},y=function(L,q){return Math.sqrt(Math.pow(L.x-q.x,2)+Math.pow(L.y-q.y,2))},c=function(L){return L[0].x===L[1].x&&L[0].y===L[1].y},F=function(L,q,tt){if(c(L))return{point:L[0],location:q};for(var K=D(L,q),rt=0,f=q,_=tt>0?1:-1,h=null;rt<Math.abs(tt);)f+=.005*_,h=D(L,f),rt+=y(h,K),K=h;return{point:h,location:f}},k=function(L){var q=new Date().getTime();if(c(L))return 0;for(var tt=D(L,0),K=0,rt=0,f=1,_=null;rt<1;)rt+=.005*f,_=D(L,rt),K+=y(_,tt),tt=_;return console.log("length",new Date().getTime()-q),K},B=function(L,q,tt){return F(L,q,tt).point},M=function(L,q,tt){return F(L,q,tt).location},A=function(L,q){var tt=D(L,q),K=D(L.slice(0,L.length-1),q),rt=K.y-tt.y,f=K.x-tt.x;return rt===0?1/0:Math.atan(rt/f)},I=function(L,q,tt){var K=F(L,q,tt);return K.location>1&&(K.location=1),K.location<0&&(K.location=0),A(L,K.location)},l=function(L,q,tt,K){K=K??0;var rt=F(L,q,K),f=A(L,rt.location),_=Math.atan(-1/f),h=tt/2*Math.sin(_),N=tt/2*Math.cos(_);return[{x:rt.point.x+N,y:rt.point.y+h},{x:rt.point.x-N,y:rt.point.y-h}]},T=function(L,q,tt,K,rt){var f=K-q,_=L-tt,h=L*(q-K)+q*(tt-L),N=C(rt),z=[f*N[0][0]+_*N[1][0],f*N[0][1]+_*N[1][1],f*N[0][2]+_*N[1][2],f*N[0][3]+_*N[1][3]+h],U=V.apply(null,z),nt=[];if(U!=null)for(var ot=0;ot<3;ot++){var Z=U[ot],ut=Math.pow(Z,2),dt=Math.pow(Z,3),ft=[N[0][0]*dt+N[0][1]*ut+N[0][2]*Z+N[0][3],N[1][0]*dt+N[1][1]*ut+N[1][2]*Z+N[1][3]],ct;tt-L!==0?ct=(ft[0]-L)/(tt-L):ct=(ft[1]-q)/(K-q),Z>=0&&Z<=1&&ct>=0&&ct<=1&&nt.push(ft)}return nt},x=function(L,q,tt,K,rt){var f=[];return f.push.apply(f,T(L,q,L+tt,q,rt)),f.push.apply(f,T(L+tt,q,L+tt,q+K,rt)),f.push.apply(f,T(L+tt,q+K,L,q+K,rt)),f.push.apply(f,T(L,q+K,L,q,rt)),f},R=function(L,q){var tt=[];return tt.push.apply(tt,T(L.x,L.y,L.x+L.w,L.y,q)),tt.push.apply(tt,T(L.x+L.w,L.y,L.x+L.w,L.y+L.h,q)),tt.push.apply(tt,T(L.x+L.w,L.y+L.h,L.x,L.y+L.h,q)),tt.push.apply(tt,T(L.x,L.y+L.h,L.x,L.y,q)),tt};function G(L,q){return[-L[0][q]+3*L[1][q]+-3*L[2][q]+L[3][q],3*L[0][q]-6*L[1][q]+3*L[2][q],-3*L[0][q]+3*L[1][q],L[0][q]]}function C(L){return[G(L,"x"),G(L,"y")]}function W(L){return L<0?-1:L>0?1:0}function V(L,q,tt,K){var rt=q/L,f=tt/L,_=K/L,h=(3*f-Math.pow(rt,2))/9,N=(9*rt*f-27*_-2*Math.pow(rt,3))/54,z=Math.pow(h,3)+Math.pow(N,2),U,nt,ot=[];if(z>=0)U=W(N+Math.sqrt(z))*Math.pow(Math.abs(N+Math.sqrt(z)),1/3),nt=W(N-Math.sqrt(z))*Math.pow(Math.abs(N-Math.sqrt(z)),1/3),ot[0]=-rt/3+(U+nt),ot[1]=-rt/3-(U+nt)/2,ot[2]=-rt/3-(U+nt)/2,Math.abs(Math.sqrt(3)*(U-nt)/2)!==0&&(ot[1]=-1,ot[2]=-1);else{var Z=Math.acos(N/Math.sqrt(-Math.pow(h,3)));ot[0]=2*Math.sqrt(-h)*Math.cos(Z/3)-rt/3,ot[1]=2*Math.sqrt(-h)*Math.cos((Z+2*Math.PI)/3)-rt/3,ot[2]=2*Math.sqrt(-h)*Math.cos((Z+4*Math.PI)/3)-rt/3}for(var ut=0;ut<3;ut++)(ot[ut]<0||ot[ut]>1)&&(ot[ut]=-1);return ot}var Y=this.jsBezier={distanceFromCurve:w,gradientAtPoint:A,gradientAtPointAlongCurveFrom:I,nearestPointOnCurve:g,pointOnCurve:D,pointAlongCurveFrom:B,perpendicularToCurveAt:l,locationAlongCurveFrom:M,getLength:k,lineIntersection:T,boxIntersection:x,boundingBoxIntersection:R,version:"0.9.0"};a.jsBezier=Y}).call(typeof window<"u"?window:ne),function(){var i=this,e=i.Biltong={version:"0.4.0"};a.Biltong=e;var d=function(u){return Object.prototype.toString.call(u)==="[object Array]"},w=function(u,r,m){return u=d(u)?u:[u.x,u.y],r=d(r)?r:[r.x,r.y],m(u,r)},g=e.gradient=function(u,r){return w(u,r,function(m,E){return E[0]==m[0]?E[1]>m[1]?1/0:-1/0:E[1]==m[1]?E[0]>m[0]?0:-0:(E[1]-m[1])/(E[0]-m[0])})};e.normal=function(u,r){return-1/g(u,r)},e.lineLength=function(u,r){return w(u,r,function(m,E){return Math.sqrt(Math.pow(E[1]-m[1],2)+Math.pow(E[0]-m[0],2))})};var S=e.quadrant=function(u,r){return w(u,r,function(m,E){return E[0]>m[0]||E[0]==m[0]?E[1]>m[1]?2:1:E[1]>m[1]?3:4})};e.theta=function(u,r){return w(u,r,function(m,E){var O=g(m,E),D=Math.atan(O),y=S(m,E);return(y==4||y==3)&&(D+=Math.PI),D<0&&(D+=2*Math.PI),D})},e.intersects=function(u,r){var m=u.x,E=u.x+u.w,O=u.y,D=u.y+u.h,y=r.x,c=r.x+r.w,F=r.y,k=r.y+r.h;return m<=y&&y<=E&&O<=F&&F<=D||m<=c&&c<=E&&O<=F&&F<=D||m<=y&&y<=E&&O<=k&&k<=D||m<=c&&y<=E&&O<=k&&k<=D||y<=m&&m<=c&&F<=O&&O<=k||y<=E&&E<=c&&F<=O&&O<=k||y<=m&&m<=c&&F<=D&&D<=k||y<=E&&m<=c&&F<=D&&D<=k},e.encloses=function(u,r,m){var E=u.x,O=u.x+u.w,D=u.y,y=u.y+u.h,c=r.x,F=r.x+r.w,k=r.y,B=r.y+r.h,M=function(A,I,l,T){return m?A<=I&&l>=T:A<I&&l>T};return M(E,c,O,F)&&M(D,k,y,B)};var o=[null,[1,-1],[1,1],[-1,1],[-1,-1]],v=[null,[-1,-1],[-1,1],[1,1],[1,-1]];e.pointOnLine=function(u,r,m){var E=g(u,r),O=S(u,r),D=m>0?o[O]:v[O],y=Math.atan(E),c=Math.abs(m*Math.sin(y))*D[1],F=Math.abs(m*Math.cos(y))*D[0];return{x:u.x+F,y:u.y+c}},e.perpendicularLineTo=function(u,r,m){var E=g(u,r),O=Math.atan(-1/E),D=m/2*Math.sin(O),y=m/2*Math.cos(O);return[{x:r.x+y,y:r.y+D},{x:r.x-y,y:r.y-D}]}}.call(typeof window<"u"?window:ne),function(){function i(f,_,h,N,z,U,nt,ot){return new Touch({target:_,identifier:rt(),pageX:h,pageY:N,screenX:z,screenY:U,clientX:nt||z,clientY:ot||U})}function e(){var f=[];return Array.prototype.push.apply(f,arguments),f.item=function(_){return this[_]},f}function d(f,_,h,N,z,U,nt,ot){return e(i.apply(null,arguments))}var w=this,g=function(f,_,h){h=h||f.parentNode;for(var N=h.querySelectorAll(_),z=0;z<N.length;z++)if(N[z]===f)return!0;return!1},S=function(f){return typeof f=="string"||f.constructor===String?document.getElementById(f):f},o=function(f){return f.srcElement||f.target},v=function(f,_,h,N){if(N){if(typeof f.path<"u"&&f.path.indexOf)return{path:f.path,end:f.path.indexOf(h)};var z={path:[],end:-1},U=function(nt){z.path.push(nt),nt===h?z.end=z.path.length-1:nt.parentNode!=null&&U(nt.parentNode)};return U(_),z}else return{path:[_],end:1}},u=function(f,_){for(var h=0,N=f.length;h<N&&f[h]!=_;h++);h<f.length&&f.splice(h,1)},r=1,m=function(f,_,h){var N=r++;return f.__ta=f.__ta||{},f.__ta[_]=f.__ta[_]||{},f.__ta[_][N]=h,h.__tauid=N,N},E=function(f,_,h){if(f.__ta&&f.__ta[_]&&delete f.__ta[_][h.__tauid],h.__taExtra){for(var N=0;N<h.__taExtra.length;N++)tt(f,h.__taExtra[N][0],h.__taExtra[N][1]);h.__taExtra.length=0}h.__taUnstore&&h.__taUnstore()},O=function(f,_,h,N){if(f==null)return h;var z=f.split(","),U=function(nt){U.__tauid=h.__tauid;var ot=o(nt),Z=ot,ut=v(nt,ot,_,f!=null);if(ut.end!=-1)for(var dt=0;dt<ut.end;dt++){Z=ut.path[dt];for(var ft=0;ft<z.length;ft++)g(Z,z[ft],_)&&h.apply(Z,arguments)}};return D(h,N,U),U},D=function(f,_,h){f.__taExtra=f.__taExtra||[],f.__taExtra.push([_,h])},y=function(f,_,h,N){if(A&&l[_]){var z=O(N,f,h,l[_]);q(f,l[_],z,h)}_==="focus"&&f.getAttribute("tabindex")==null&&f.setAttribute("tabindex","1"),q(f,_,O(N,f,h,_),h)},c=function(f,_,h,N){if(f.__taSmartClicks==null){var z=function(ot){f.__tad=G(ot)},U=function(ot){f.__tau=G(ot)},nt=function(ot){if(f.__tad&&f.__tau&&f.__tad[0]===f.__tau[0]&&f.__tad[1]===f.__tau[1])for(var Z=0;Z<f.__taSmartClicks.length;Z++)f.__taSmartClicks[Z].apply(o(ot),[ot])};y(f,"mousedown",z,N),y(f,"mouseup",U,N),y(f,"click",nt,N),f.__taSmartClicks=[]}f.__taSmartClicks.push(h),h.__taUnstore=function(){u(f.__taSmartClicks,h)}},F={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},k=function(f,_){return function(h,N,z,U){if(N=="contextmenu"&&I)y(h,N,z,U);else{if(h.__taTapHandler==null){var nt=h.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},ot=function(ft){for(var ct=o(ft),xt=v(ft,ct,h,U!=null),Pt=!1,Ot=0;Ot<xt.end;Ot++){if(Pt)return;ct=xt.path[Ot];for(var Ct=0;Ct<nt.downSelectors.length;Ct++)if(nt.downSelectors[Ct]==null||g(ct,nt.downSelectors[Ct],h)){nt.down=!0,setTimeout(ut,f),setTimeout(dt,_),Pt=!0;break}}},Z=function(ft){if(nt.down){var ct=o(ft),xt,Pt;nt.taps++;var Ot=L(ft);for(var Ct in F)if(F.hasOwnProperty(Ct)){var Rt=F[Ct];if(Rt.touches===Ot&&(Rt.taps===1||Rt.taps===nt.taps))for(var Mt=0;Mt<nt[Ct].length;Mt++){Pt=v(ft,ct,h,nt[Ct][Mt][1]!=null);for(var vt=0;vt<Pt.end;vt++)if(xt=Pt.path[vt],nt[Ct][Mt][1]==null||g(xt,nt[Ct][Mt][1],h)){nt[Ct][Mt][0].apply(xt,[ft]);break}}}}},ut=function(){nt.down=!1},dt=function(){nt.taps=0};y(h,"mousedown",ot),y(h,"mouseup",Z)}h.__taTapHandler.downSelectors.push(U),h.__taTapHandler[N].push([z,U]),z.__taUnstore=function(){u(h.__taTapHandler[N],z)}}}},B=function(f,_,h,N){for(var z in h.__tamee[f])h.__tamee[f].hasOwnProperty(z)&&h.__tamee[f][z].apply(N,[_])},M=function(){var f=[];return function(_,h,N,z){if(!_.__tamee){_.__tamee={over:!1,mouseenter:[],mouseexit:[]};var U=function(ot){var Z=o(ot);(z==null&&Z==_&&!_.__tamee.over||g(Z,z,_)&&(Z.__tamee==null||!Z.__tamee.over))&&(B("mouseenter",ot,_,Z),Z.__tamee=Z.__tamee||{},Z.__tamee.over=!0,f.push(Z))},nt=function(ot){for(var Z=o(ot),ut=0;ut<f.length;ut++)Z==f[ut]&&!g(ot.relatedTarget||ot.toElement,"*",Z)&&(Z.__tamee.over=!1,f.splice(ut,1),B("mouseexit",ot,_,Z))};q(_,"mouseover",O(z,_,U,"mouseover"),U),q(_,"mouseout",O(z,_,nt,"mouseout"),nt)}N.__taUnstore=function(){delete _.__tamee[h][N.__tauid]},m(_,h,N),_.__tamee[h][N.__tauid]=N}},A="ontouchstart"in document.documentElement||navigator.maxTouchPoints,I="onmousedown"in document.documentElement,l={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},T=function(){var f=-1;if(navigator.appName=="Microsoft Internet Explorer"){var _=navigator.userAgent,h=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");h.exec(_)!=null&&(f=parseFloat(RegExp.$1))}return f}(),x=T>-1&&T<9,R=function(f,_){if(f==null)return[0,0];var h=Y(f),N=V(h,0);return[N[_+"X"],N[_+"Y"]]},G=function(f){return f==null?[0,0]:x?[f.clientX+document.documentElement.scrollLeft,f.clientY+document.documentElement.scrollTop]:R(f,"page")},C=function(f){return R(f,"screen")},W=function(f){return R(f,"client")},V=function(f,_){return f.item?f.item(_):f[_]},Y=function(f){return f.touches&&f.touches.length>0?f.touches:f.changedTouches&&f.changedTouches.length>0?f.changedTouches:f.targetTouches&&f.targetTouches.length>0?f.targetTouches:[f]},L=function(f){return Y(f).length},q=function(f,_,h,N){if(m(f,_,h),N.__tauid=h.__tauid,f.addEventListener)f.addEventListener(_,h,!1);else if(f.attachEvent){var z=_+h.__tauid;f["e"+z]=h,f[z]=function(){f["e"+z]&&f["e"+z](window.event)},f.attachEvent("on"+_,f[z])}},tt=function(f,_,h){h!=null&&K(f,function(){var N=S(this);if(E(N,_,h),h.__tauid!=null){if(N.removeEventListener)N.removeEventListener(_,h,!1),A&&l[_]&&N.removeEventListener(l[_],h,!1);else if(this.detachEvent){var z=_+h.__tauid;N[z]&&N.detachEvent("on"+_,N[z]),N[z]=null,N["e"+z]=null}}h.__taTouchProxy&&tt(f,h.__taTouchProxy[1],h.__taTouchProxy[0])})},K=function(f,_){if(f!=null){f=typeof Window<"u"&&typeof f.top!="unknown"&&f==f.top?[f]:typeof f!="string"&&f.tagName==null&&f.length!=null?f:typeof f=="string"?document.querySelectorAll(f):[f];for(var h=0;h<f.length;h++)_.apply(f[h])}},rt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var _=Math.random()*16|0,h=f=="x"?_:_&3|8;return h.toString(16)})};w.Mottle=function(f){f=f||{};var _=f.clickThreshold||250,h=f.dblClickThreshold||450,N=new M,z=new k(_,h),U=f.smartClicks,nt=function(ot,Z,ut,dt){ut!=null&&K(ot,function(){var ft=S(this);U&&Z==="click"?c(ft,Z,ut,dt):Z==="tap"||Z==="dbltap"||Z==="contextmenu"?z(ft,Z,ut,dt):Z==="mouseenter"||Z=="mouseexit"?N(ft,Z,ut,dt):y(ft,Z,ut,dt)})};this.remove=function(ot){return K(ot,function(){var Z=S(this);if(Z.__ta){for(var ut in Z.__ta)if(Z.__ta.hasOwnProperty(ut))for(var dt in Z.__ta[ut])Z.__ta[ut].hasOwnProperty(dt)&&tt(Z,ut,Z.__ta[ut][dt])}Z.parentNode&&Z.parentNode.removeChild(Z)}),this},this.on=function(ot,Z,ut,dt){var ft=arguments[0],ct=arguments.length==4?arguments[2]:null,xt=arguments[1],Pt=arguments[arguments.length-1];return nt(ft,xt,Pt,ct),this},this.off=function(ot,Z,ut){return tt(ot,Z,ut),this},this.trigger=function(ot,Z,ut,dt){var ft=I&&(typeof MouseEvent>"u"||ut==null||ut.constructor===MouseEvent),ct=A&&!I&&l[Z]?l[Z]:Z,xt=!(A&&!I&&l[Z]),Pt=G(ut),Ot=C(ut),Ct=W(ut);return K(ot,function(){var Rt=S(this),Mt;ut=ut||{screenX:Ot[0],screenY:Ot[1],clientX:Ct[0],clientY:Ct[1]};var vt=function(Ft){dt&&(Ft.payload=dt)},mt={TouchEvent:function(Ft){var Jt=d(window,Rt,0,Pt[0],Pt[1],Ot[0],Ot[1],Ct[0],Ct[1]),ie=Ft.initTouchEvent||Ft.initEvent;ie(ct,!0,!0,window,null,Ot[0],Ot[1],Ct[0],Ct[1],!1,!1,!1,!1,Jt,Jt,Jt,1,0)},MouseEvents:function(Ft){Ft.initMouseEvent(ct,!0,!0,window,0,Ot[0],Ot[1],Ct[0],Ct[1],!1,!1,!1,!1,1,Rt)}};if(document.createEvent){var wt=!xt&&!ft&&A&&l[Z],Tt=wt?"TouchEvent":"MouseEvents";Mt=document.createEvent(Tt),mt[Tt](Mt),vt(Mt),Rt.dispatchEvent(Mt)}else document.createEventObject&&(Mt=document.createEventObject(),Mt.eventType=Mt.eventName=ct,Mt.screenX=Ot[0],Mt.screenY=Ot[1],Mt.clientX=Ct[0],Mt.clientY=Ct[1],vt(Mt),Rt.fireEvent("on"+ct,Mt))}),this}},w.Mottle.consume=function(f,_){f.stopPropagation?f.stopPropagation():f.returnValue=!1,!_&&f.preventDefault&&f.preventDefault()},w.Mottle.pageLocation=G,w.Mottle.setForceTouchEvents=function(f){A=f},w.Mottle.setForceMouseEvents=function(f){I=f},w.Mottle.version="0.8.0",a.Mottle=w.Mottle}.call(typeof window>"u"?ne:window),function(){var i=this,e=function(f,_,h){return f.indexOf(_)===-1?(h?f.unshift(_):f.push(_),!0):!1},d=function(f,_){var h=f.indexOf(_);h!==-1&&f.splice(h,1)},w=function(f,_){for(var h=[],N=0;N<f.length;N++)_.indexOf(f[N])===-1&&h.push(f[N]);return h},g=function(f){return f==null?!1:typeof f=="string"||f.constructor===String},S=function(f){var _=f.getBoundingClientRect(),h=document.body,N=document.documentElement,z=window.pageYOffset||N.scrollTop||h.scrollTop,U=window.pageXOffset||N.scrollLeft||h.scrollLeft,nt=N.clientTop||h.clientTop||0,ot=N.clientLeft||h.clientLeft||0,Z=_.top+z-nt,ut=_.left+U-ot;return{top:Math.round(Z),left:Math.round(ut)}},o=function(f,_,h){h=h||f.parentNode;for(var N=h.querySelectorAll(_),z=0;z<N.length;z++)if(N[z]===f)return!0;return!1},v=function(f,_,h){if(o(_,h,f))return _;for(var N=_.parentNode;N!=null&&N!==f;){if(o(N,h,f))return N;N=N.parentNode}},u=function(f,_,h){for(var N=null,z=_.getAttribute("katavorio-draggable"),U=z!=null?"[katavorio-draggable='"+z+"'] ":"",nt=0;nt<f.length;nt++)if(N=v(_,h,U+f[nt].selector),N!=null){if(f[nt].filter){var ot=o(h,f[nt].filter,N),Z=f[nt].filterExclude===!0;if(Z&&!ot||ot)return null}return[f[nt],N]}return null},r=function(){var f=-1;if(navigator.appName==="Microsoft Internet Explorer"){var _=navigator.userAgent,h=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");h.exec(_)!=null&&(f=parseFloat(RegExp.$1))}return f}(),m=10,E=10,O=r>-1&&r<9,D=r===9,y=function(f){if(O)return[f.clientX+document.documentElement.scrollLeft,f.clientY+document.documentElement.scrollTop];var _=F(f),h=c(_,0);return D?[h.pageX||h.clientX,h.pageY||h.clientY]:[h.pageX,h.pageY]},c=function(f,_){return f.item?f.item(_):f[_]},F=function(f){return f.touches&&f.touches.length>0?f.touches:f.changedTouches&&f.changedTouches.length>0?f.changedTouches:f.targetTouches&&f.targetTouches.length>0?f.targetTouches:[f]},k={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},B="katavorio-drag-scope",M=["stop","start","drag","drop","over","out","beforeStart"],A=function(){},I=function(){return!0},l=function(f,_,h){for(var N=0;N<f.length;N++)f[N]!=h&&_(f[N])},T=function(f,_,h,N){l(f,function(z){z.setActive(_),_&&z.updatePosition(),h&&z.setHover(N,_)})},x=function(f,_){if(f!=null){f=!g(f)&&f.tagName==null&&f.length!=null?f:[f];for(var h=0;h<f.length;h++)_.apply(f[h],[f[h]])}},R=function(f){f.stopPropagation?(f.stopPropagation(),f.preventDefault()):f.returnValue=!1},G="input,textarea,select,button,option",C=function(f,_,h){var N=f.srcElement||f.target;return!o(N,h.getInputFilterSelector(),_)},W=function(f,_,h,N){this.params=_||{},this.el=f,this.params.addClass(this.el,this._class),this.uuid=tt();var z=!0;return this.setEnabled=function(U){z=U},this.isEnabled=function(){return z},this.toggleEnabled=function(){z=!z},this.setScope=function(U){this.scopes=U?U.split(/\s+/):[N]},this.addScope=function(U){var nt={};x(this.scopes,function(Z){nt[Z]=!0}),x(U?U.split(/\s+/):[],function(Z){nt[Z]=!0}),this.scopes=[];for(var ot in nt)this.scopes.push(ot)},this.removeScope=function(U){var nt={};x(this.scopes,function(Z){nt[Z]=!0}),x(U?U.split(/\s+/):[],function(Z){delete nt[Z]}),this.scopes=[];for(var ot in nt)this.scopes.push(ot)},this.toggleScope=function(U){var nt={};x(this.scopes,function(Z){nt[Z]=!0}),x(U?U.split(/\s+/):[],function(Z){nt[Z]?delete nt[Z]:nt[Z]=!0}),this.scopes=[];for(var ot in nt)this.scopes.push(ot)},this.setScope(_.scope),this.k=_.katavorio,_.katavorio},V=function(){return!0},Y=function(){return!1},L=function(f,_,h,N){this._class=h.draggable;var z=W.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var U=[0,0],nt=null,ot=null,Z=[0,0],ut=!1,dt=[0,0],ft=this.params.consumeStartEvent!==!1,ct=this.el,xt=this.params.clone;this.params.scroll;var Pt=_.multipleDrop!==!1,Ot=!1,Ct,Rt,Mt=null,vt=[],mt=null,wt=_.ghostProxyParent,Tt,Ft,Jt,ie;if(_.ghostProxy===!0?Ct=V:_.ghostProxy&&typeof _.ghostProxy=="function"?Ct=_.ghostProxy:Ct=function(St,zt){return mt&&mt.useGhostProxy?mt.useGhostProxy(St,zt):!1},_.makeGhostProxy?Rt=_.makeGhostProxy:Rt=function(St){return mt&&mt.makeGhostProxy?mt.makeGhostProxy(St):St.cloneNode(!0)},_.selector){var fe=f.getAttribute("katavorio-draggable");fe==null&&(fe=""+new Date().getTime(),f.setAttribute("katavorio-draggable",fe)),vt.push(_)}var ge=_.snapThreshold,we=function(St,zt,Ht,Vt,Yt){var Qt=Math.floor(St[0]/zt),P=zt*Qt,Q=P+zt,X=Math.abs(St[0]-P)<=Vt?P:Math.abs(Q-St[0])<=Vt?Q:St[0],et=Math.floor(St[1]/Ht),at=Ht*et,gt=at+Ht,Et=Math.abs(St[1]-at)<=Yt?at:Math.abs(gt-St[1])<=Yt?gt:St[1];return[X,Et]};this.posses=[],this.posseRoles={},this.toGrid=function(St){if(this.params.grid==null)return St;var zt=this.params.grid?this.params.grid[0]/2:ge||m/2,Ht=this.params.grid?this.params.grid[1]/2:ge||E/2;return we(St,this.params.grid[0],this.params.grid[1],zt,Ht)},this.snap=function(St,zt){if(ct!=null){St=St||(this.params.grid?this.params.grid[0]:m),zt=zt||(this.params.grid?this.params.grid[1]:E);var Ht=this.params.getPosition(ct),Vt=this.params.grid?this.params.grid[0]/2:ge,Yt=this.params.grid?this.params.grid[1]/2:ge,Qt=we(Ht,St,zt,Vt,Yt);return this.params.setPosition(ct,Qt),Qt}},this.setUseGhostProxy=function(St){Ct=St?V:Y};var xe,Xe=function(St){return _.allowNegative===!1?[Math.max(0,St[0]),Math.max(0,St[1])]:St},Ke=function(St){xe=typeof St=="function"?St:St?function(zt,Ht,Vt,Yt){return Xe([Math.max(0,Math.min(Vt.w-Yt[0],zt[0])),Math.max(0,Math.min(Vt.h-Yt[1],zt[1]))])}.bind(this):function(zt){return Xe(zt)}}.bind(this);Ke(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(St){Ke(St)};var rn=function(St,zt,Ht,Vt){return mt!=null&&mt.constrain&&typeof mt.constrain=="function"?mt.constrain(St,zt,Ht,Vt):xe(St,zt,Ht,Vt)},Se;this.setRevert=function(St){Se=St},this.params.revert&&(Se=this.params.revert);var Me=function(St){return typeof St=="function"?(St._katavorioId=tt(),St._katavorioId):St},Ee={},Ue=function(St){for(var zt in Ee){var Ht=Ee[zt],Vt=Ht[0](St);if(Ht[1]&&(Vt=!Vt),!Vt)return!1}return!0},Ie=this.setFilter=function(St,zt){if(St){var Ht=Me(St);Ee[Ht]=[function(Vt){var Yt=Vt.srcElement||Vt.target,Qt;return g(St)?Qt=o(Yt,St,f):typeof St=="function"&&(Qt=St(Vt,f)),Qt},zt!==!1]}};this.addFilter=Ie,this.removeFilter=function(St){var zt=typeof St=="function"?St._katavorioId:St;delete Ee[zt]},this.clearAllFilters=function(){Ee={}},this.canDrag=this.params.canDrag||I;var Ne,te=[],Ce=[];this.addSelector=function(St){St.selector&&vt.push(St)},this.downListener=function(St){if(!St.defaultPrevented){var zt=this.rightButtonCanDrag||St.which!==3&&St.button!==2;if(zt&&this.isEnabled()&&this.canDrag()){var Ht=Ue(St)&&C(St,this.el,this.k);if(Ht){if(mt=null,Mt=null,vt.length>0){var Vt=u(vt,this.el,St.target||St.srcElement);if(Vt!=null&&(mt=Vt[0],Mt=Vt[1]),Mt==null)return}else Mt=this.el;if(xt)if(ct=Mt.cloneNode(!0),this.params.addClass(ct,k.clonedDrag),ct.setAttribute("id",null),ct.style.position="absolute",this.params.parent!=null){var Yt=this.params.getPosition(this.el);ct.style.left=Yt[0]+"px",ct.style.top=Yt[1]+"px",this.params.parent.appendChild(ct)}else{var Qt=S(Mt);ct.style.left=Qt.left+"px",ct.style.top=Qt.top+"px",document.body.appendChild(ct)}else ct=Mt;ft&&R(St),U=y(St),ct&&ct.parentNode&&(dt=[ct.parentNode.scrollLeft,ct.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),z.markSelection(this),z.markPosses(this),this.params.addClass(document.body,h.noSelect),_e("beforeStart",{el:this.el,pos:nt,e:St,drag:this})}else this.params.consumeFilteredEvents&&R(St)}}}.bind(this),this.moveListener=function(St){if(U){if(!ut){var zt=_e("start",{el:this.el,pos:nt,e:St,drag:this});if(zt!==!1){if(!U)return;this.mark(!0),ut=!0}else this.abort()}if(U){Ce.length=0;var Ht=y(St),Vt=Ht[0]-U[0],Yt=Ht[1]-U[1],Qt=this.params.ignoreZoom?1:z.getZoom();ct&&ct.parentNode&&(Vt+=ct.parentNode.scrollLeft-dt[0],Yt+=ct.parentNode.scrollTop-dt[1]),Vt/=Qt,Yt/=Qt,this.moveBy(Vt,Yt,St),z.updateSelection(Vt,Yt,this),z.updatePosses(Vt,Yt,this)}}}.bind(this),this.upListener=function(St){U&&(U=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,h.noSelect),this.unmark(St),z.unmarkSelection(this,St),z.unmarkPosses(this,St),this.stop(St),z.notifyPosseDragStop(this,St),ut=!1,Ce.length=0,xt?(ct&&ct.parentNode&&ct.parentNode.removeChild(ct),ct=null):Se&&Se(ct,this.params.getPosition(ct))===!0&&(this.params.setPosition(ct,nt),_e("revert",ct)))}.bind(this),this.getFilters=function(){return Ee},this.abort=function(){U!=null&&this.upListener()},this.getDragElement=function(St){return St?Mt||this.el:ct||this.el};var ue={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};_.events.start&&ue.start.push(_.events.start),_.events.beforeStart&&ue.beforeStart.push(_.events.beforeStart),_.events.stop&&ue.stop.push(_.events.stop),_.events.drag&&ue.drag.push(_.events.drag),_.events.revert&&ue.revert.push(_.events.revert),this.on=function(St,zt){ue[St]&&ue[St].push(zt)},this.off=function(St,zt){if(ue[St]){for(var Ht=[],Vt=0;Vt<ue[St].length;Vt++)ue[St][Vt]!==zt&&Ht.push(ue[St][Vt]);ue[St]=Ht}};var _e=function(St,zt){var Ht=null;if(mt&&mt[St])Ht=mt[St](zt);else if(ue[St])for(var Vt=0;Vt<ue[St].length;Vt++)try{var Yt=ue[St][Vt](zt);Yt!=null&&(Ht=Yt)}catch{}return Ht};this.notifyStart=function(St){_e("start",{el:this.el,pos:this.params.getPosition(ct),e:St,drag:this})},this.stop=function(St,zt){if(zt||ut){var Ht=[],Vt=z.getSelection(),Yt=this.params.getPosition(ct);if(Vt.length>0)for(var Qt=0;Qt<Vt.length;Qt++){var P=this.params.getPosition(Vt[Qt].el);Ht.push([Vt[Qt].el,{left:P[0],top:P[1]},Vt[Qt]])}else Ht.push([ct,{left:Yt[0],top:Yt[1]},this]);_e("stop",{el:ct,pos:Ae||Yt,finalPos:Yt,e:St,drag:this,selection:Ht})}},this.mark=function(St){nt=this.params.getPosition(ct),ot=this.params.getPosition(ct,!0),Z=[ot[0]-nt[0],ot[1]-nt[1]],this.size=this.params.getSize(ct),te=z.getMatchingDroppables(this),T(te,!0,!1,this),this.params.addClass(ct,this.params.dragClass||h.drag);var zt;this.params.getConstrainingRectangle?zt=this.params.getConstrainingRectangle(ct):zt=this.params.getSize(ct.parentNode),Ne={w:zt[0],h:zt[1]},Jt=0,ie=0,St&&z.notifySelectionDragStart(this)};var Ae;this.unmark=function(St,zt){if(T(te,!1,!0,this),Ot&&Ct(Mt,ct)?(Ae=[ct.offsetLeft-Jt,ct.offsetTop-ie],ct.parentNode.removeChild(ct),ct=Mt):Ae=null,this.params.removeClass(ct,this.params.dragClass||h.drag),te.length=0,Ot=!1,!zt){Ce.length>0&&Ae&&_.setPosition(Mt,Ae),Ce.sort(K);for(var Ht=0;Ht<Ce.length;Ht++){var Vt=Ce[Ht].drop(this,St);if(Vt===!0)break}}},this.moveBy=function(St,zt,Ht){Ce.length=0;var Vt=this.toGrid([nt[0]+St,nt[1]+zt]),Yt=rn(Vt,ct,Ne,this.size);if(Ct(this.el,ct))if(Vt[0]!==Yt[0]||Vt[1]!==Yt[1]){if(!Ot){var Qt=Rt(Mt);_.addClass(Qt,k.ghostProxy),wt?(wt.appendChild(Qt),Tt=_.getPosition(Mt.parentNode,!0),Ft=_.getPosition(_.ghostProxyParent,!0),Jt=Tt[0]-Ft[0],ie=Tt[1]-Ft[1]):Mt.parentNode.appendChild(Qt),ct=Qt,Ot=!0}Yt=Vt}else Ot&&(ct.parentNode.removeChild(ct),ct=Mt,Ot=!1,Tt=null,Ft=null,Jt=0,ie=0);var P={x:Yt[0],y:Yt[1],w:this.size[0],h:this.size[1]},Q={x:P.x+Z[0],y:P.y+Z[1],w:P.w,h:P.h},X=null;this.params.setPosition(ct,[Yt[0]+Jt,Yt[1]+ie]);for(var et=0;et<te.length;et++){var at={x:te[et].pagePosition[0],y:te[et].pagePosition[1],w:te[et].size[0],h:te[et].size[1]};this.params.intersects(Q,at)&&(Pt||X==null||X===te[et].el)&&te[et].canDrop(this)?(X||(X=te[et].el),Ce.push(te[et]),te[et].setHover(this,!0,Ht)):te[et].isHover()&&te[et].setHover(this,!1,Ht)}_e("drag",{el:this.el,pos:Yt,e:Ht,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?Ie(this.params.handle,!1):Ie(this.params.filter,this.params.filterExclude)},q=function(f,_,h,N){this._class=h.droppable,this.params=_||{},this.rank=_.rank||0,this._activeClass=this.params.activeClass||h.active,this._hoverClass=this.params.hoverClass||h.hover,W.apply(this,arguments);var z=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(U){this.params[U?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(U){return!0},this.isHover=function(){return z},this.setHover=function(U,nt,ot){(nt||this.el._katavorioDragHover==null||this.el._katavorioDragHover===U.el._katavorio)&&(this.params[nt?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=nt?U.el._katavorio:null,z!==nt&&this.params.events[nt?"over":"out"]({el:this.el,e:ot,drag:U,drop:this}),z=nt)},this.drop=function(U,nt){return this.params.events.drop({drag:U,e:nt,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,z=null}},tt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var _=Math.random()*16|0,h=f==="x"?_:_&3|8;return h.toString(16)})},K=function(f,_){return f.rank<_.rank?1:f.rank>_.rank?-1:0},rt=function(f){return f==null||(f=typeof f=="string"||f.constructor===String?document.getElementById(f):f,f==null)?null:(f._katavorio=f._katavorio||tt(),f)};i.Katavorio=function(f){var _=[],h={};this._dragsByScope={},this._dropsByScope={};var N=1,z=function(vt,mt){x(vt,function(wt){for(var Tt=0;Tt<wt.scopes.length;Tt++)mt[wt.scopes[Tt]]=mt[wt.scopes[Tt]]||[],mt[wt.scopes[Tt]].push(wt)})},U=function(vt,mt){var wt=0;return x(vt,function(Tt){for(var Ft=0;Ft<Tt.scopes.length;Ft++)if(mt[Tt.scopes[Ft]]){var Jt=f.indexOf(mt[Tt.scopes[Ft]],Tt);Jt!==-1&&(mt[Tt.scopes[Ft]].splice(Jt,1),wt++)}}),wt>0};this.getMatchingDroppables=function(vt){for(var mt=[],wt={},Tt=0;Tt<vt.scopes.length;Tt++){var Ft=this._dropsByScope[vt.scopes[Tt]];if(Ft)for(var Jt=0;Jt<Ft.length;Jt++)Ft[Jt].canDrop(vt)&&!wt[Ft[Jt].uuid]&&(Ft[Jt].allowLoopback||Ft[Jt].el!==vt.el)&&(wt[Ft[Jt].uuid]=!0,mt.push(Ft[Jt]))}return mt.sort(K),mt};var nt=function(vt){vt=vt||{};var mt={events:{}},wt;for(wt in f)mt[wt]=f[wt];for(wt in vt)mt[wt]=vt[wt];for(wt=0;wt<M.length;wt++)mt.events[M[wt]]=vt[M[wt]]||A;return mt.katavorio=this,mt}.bind(this),ot=function(vt,mt){for(var wt=0;wt<M.length;wt++)mt[M[wt]]&&vt.on(M[wt],mt[M[wt]])}.bind(this),Z={},ut=f.css||{},dt=f.scope||B;for(var ft in k)Z[ft]=k[ft];for(var ft in ut)Z[ft]=ut[ft];var ct=f.inputFilterSelector||G;this.getInputFilterSelector=function(){return ct},this.setInputFilterSelector=function(vt){return ct=vt,this},this.draggable=function(vt,mt){var wt=[];return x(vt,function(Tt){if(Tt=rt(Tt),Tt!=null)if(Tt._katavorioDrag==null){var Ft=nt(mt);Tt._katavorioDrag=new L(Tt,Ft,Z,dt),z(Tt._katavorioDrag,this._dragsByScope),wt.push(Tt._katavorioDrag),f.addClass(Tt,Ft.selector?Z.delegatedDraggable:Z.draggable)}else ot(Tt._katavorioDrag,mt)}.bind(this)),wt},this.droppable=function(vt,mt){var wt=[];return x(vt,function(Tt){if(Tt=rt(Tt),Tt!=null){var Ft=new q(Tt,nt(mt),Z,dt);Tt._katavorioDrop=Tt._katavorioDrop||[],Tt._katavorioDrop.push(Ft),z(Ft,this._dropsByScope),wt.push(Ft),f.addClass(Tt,Z.droppable)}}.bind(this)),wt},this.select=function(vt){return x(vt,function(){var mt=rt(this);mt&&mt._katavorioDrag&&(h[mt._katavorio]||(_.push(mt._katavorioDrag),h[mt._katavorio]=[mt,_.length-1],f.addClass(mt,Z.selected)))}),this},this.deselect=function(vt){return x(vt,function(){var mt=rt(this);if(mt&&mt._katavorio){var wt=h[mt._katavorio];if(wt){for(var Tt=[],Ft=0;Ft<_.length;Ft++)_[Ft].el!==mt&&Tt.push(_[Ft]);_=Tt,delete h[mt._katavorio],f.removeClass(mt,Z.selected)}}}),this},this.deselectAll=function(){for(var vt in h){var mt=h[vt];f.removeClass(mt[0],Z.selected)}_.length=0,h={}},this.markSelection=function(vt){l(_,function(mt){mt.mark()},vt)},this.markPosses=function(vt){vt.posses&&x(vt.posses,function(mt){vt.posseRoles[mt]&&Rt[mt]&&l(Rt[mt].members,function(wt){wt.mark()},vt)})},this.unmarkSelection=function(vt,mt){l(_,function(wt){wt.unmark(mt)},vt)},this.unmarkPosses=function(vt,mt){vt.posses&&x(vt.posses,function(wt){vt.posseRoles[wt]&&Rt[wt]&&l(Rt[wt].members,function(Tt){Tt.unmark(mt,!0)},vt)})},this.getSelection=function(){return _.slice(0)},this.updateSelection=function(vt,mt,wt){l(_,function(Tt){Tt.moveBy(vt,mt)},wt)};var xt=function(vt,mt){mt.posses&&x(mt.posses,function(wt){mt.posseRoles[wt]&&Rt[wt]&&l(Rt[wt].members,function(Tt){vt(Tt)},mt)})};this.updatePosses=function(vt,mt,wt){xt(function(Tt){Tt.moveBy(vt,mt)},wt)},this.notifyPosseDragStop=function(vt,mt){xt(function(wt){wt.stop(mt,!0)},vt)},this.notifySelectionDragStop=function(vt,mt){l(_,function(wt){wt.stop(mt,!0)},vt)},this.notifySelectionDragStart=function(vt,mt){l(_,function(wt){wt.notifyStart(mt)},vt)},this.setZoom=function(vt){N=vt},this.getZoom=function(){return N};var Pt=function(vt,mt,wt,Tt){x(vt,function(Ft){U(Ft,wt),Ft[Tt](mt),z(Ft,wt)})};x(["set","add","remove","toggle"],function(vt){this[vt+"Scope"]=function(mt,wt){Pt(mt._katavorioDrag,wt,this._dragsByScope,vt+"Scope"),Pt(mt._katavorioDrop,wt,this._dropsByScope,vt+"Scope")}.bind(this),this[vt+"DragScope"]=function(mt,wt){Pt(mt.constructor===L?mt:mt._katavorioDrag,wt,this._dragsByScope,vt+"Scope")}.bind(this),this[vt+"DropScope"]=function(mt,wt){Pt(mt.constructor===q?mt:mt._katavorioDrop,wt,this._dropsByScope,vt+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(vt,mt){for(var wt in this._dragsByScope)l(this._dragsByScope[wt],function(Tt){Tt.snap(vt,mt)})},this.getDragsForScope=function(vt){return this._dragsByScope[vt]},this.getDropsForScope=function(vt){return this._dropsByScope[vt]};var Ot=function(vt,mt,wt){if(vt=rt(vt),vt[mt]){var Tt=_.indexOf(vt[mt]);Tt>=0&&_.splice(Tt,1),U(vt[mt],wt)&&x(vt[mt],function(Ft){Ft.destroy()}),delete vt[mt]}},Ct=function(vt,mt,wt,Tt){vt=rt(vt),vt[mt]&&vt[mt].off(wt,Tt)};this.elementRemoved=function(vt){vt._katavorioDrag&&this.destroyDraggable(vt),vt._katavorioDrop&&this.destroyDroppable(vt)},this.destroyDraggable=function(vt,mt,wt){arguments.length===1?Ot(vt,"_katavorioDrag",this._dragsByScope):Ct(vt,"_katavorioDrag",mt,wt)},this.destroyDroppable=function(vt,mt,wt){arguments.length===1?Ot(vt,"_katavorioDrop",this._dropsByScope):Ct(vt,"_katavorioDrop",mt,wt)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},_=[],h={},Rt={}};var Rt={},Mt=function(vt,mt,wt){var Tt=g(mt)?mt:mt.id,Ft=g(mt)?!0:mt.active!==!1,Jt=Rt[Tt]||function(){var ie={name:Tt,members:[]};return Rt[Tt]=ie,ie}();return x(vt,function(ie){if(ie._katavorioDrag){if(wt&&ie._katavorioDrag.posseRoles[Jt.name]!=null)return;e(Jt.members,ie._katavorioDrag),e(ie._katavorioDrag.posses,Jt.name),ie._katavorioDrag.posseRoles[Jt.name]=Ft}}),Jt};this.addToPosse=function(vt,mt){for(var wt=[],Tt=1;Tt<arguments.length;Tt++)wt.push(Mt(vt,arguments[Tt]));return wt.length===1?wt[0]:wt},this.setPosse=function(vt,mt){for(var wt=[],Tt=1;Tt<arguments.length;Tt++)wt.push(Mt(vt,arguments[Tt],!0).name);return x(vt,function(Ft){if(Ft._katavorioDrag){var Jt=w(Ft._katavorioDrag.posses,wt),ie=[];Array.prototype.push.apply(ie,Ft._katavorioDrag.posses);for(var fe=0;fe<Jt.length;fe++)this.removeFromPosse(Ft,Jt[fe])}}.bind(this)),wt.length===1?wt[0]:wt},this.removeFromPosse=function(vt,mt){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var wt=1;wt<arguments.length;wt++)mt=arguments[wt],x(vt,function(Tt){if(Tt._katavorioDrag&&Tt._katavorioDrag.posses){var Ft=Tt._katavorioDrag;x(mt,function(Jt){d(Rt[Jt].members,Ft),d(Ft.posses,Jt),delete Ft.posseRoles[Jt]})}})},this.removeFromAllPosses=function(vt){x(vt,function(mt){if(mt._katavorioDrag&&mt._katavorioDrag.posses){var wt=mt._katavorioDrag;x(wt.posses,function(Tt){d(Rt[Tt].members,wt)}),wt.posses.length=0,wt.posseRoles={}}})},this.setPosseState=function(vt,mt,wt){var Tt=Rt[mt];Tt&&x(vt,function(Ft){Ft._katavorioDrag&&Ft._katavorioDrag.posses&&(Ft._katavorioDrag.posseRoles[Tt.name]=wt)})}},i.Katavorio.version="1.0.0",a.Katavorio=i.Katavorio}.call(typeof window<"u"?window:ne),function(){var i=this;i.jsPlumbUtil=i.jsPlumbUtil||{};var e=i.jsPlumbUtil;a.jsPlumbUtil=e;function d(f){return Object.prototype.toString.call(f)==="[object Array]"}e.isArray=d;function w(f){return Object.prototype.toString.call(f)==="[object Number]"}e.isNumber=w;function g(f){return typeof f=="string"}e.isString=g;function S(f){return typeof f=="boolean"}e.isBoolean=S;function o(f){return f==null}e.isNull=o;function v(f){return f==null?!1:Object.prototype.toString.call(f)==="[object Object]"}e.isObject=v;function u(f){return Object.prototype.toString.call(f)==="[object Date]"}e.isDate=u;function r(f){return Object.prototype.toString.call(f)==="[object Function]"}e.isFunction=r;function m(f){return r(f)&&f.name!=null&&f.name.length>0}e.isNamedFunction=m;function E(f){for(var _ in f)if(f.hasOwnProperty(_))return!1;return!0}e.isEmpty=E;function O(f){if(g(f))return""+f;if(S(f))return!!f;if(u(f))return new Date(f.getTime());if(r(f))return f;if(d(f)){for(var _=[],h=0;h<f.length;h++)_.push(O(f[h]));return _}else if(v(f)){var N={};for(var z in f)N[z]=O(f[z]);return N}else return f}e.clone=O;function D(f,_,h,N){var z={},U,nt,ot={};for(h=h||[],N=N||[],nt=0;nt<h.length;nt++)z[h[nt]]=!0;for(nt=0;nt<N.length;nt++)ot[N[nt]]=!0;var Z=O(f);for(nt in _)if(Z[nt]==null||ot[nt])Z[nt]=_[nt];else if(g(_[nt])||S(_[nt]))z[nt]?(U=[],U.push.apply(U,d(Z[nt])?Z[nt]:[Z[nt]]),U.push.apply(U,S(_[nt])?_[nt]:[_[nt]]),Z[nt]=U):Z[nt]=_[nt];else if(d(_[nt]))U=[],d(Z[nt])&&U.push.apply(U,Z[nt]),U.push.apply(U,_[nt]),Z[nt]=U;else if(v(_[nt])){v(Z[nt])||(Z[nt]={});for(var ut in _[nt])Z[nt][ut]=_[nt][ut]}return Z}e.merge=D;function y(f,_,h){if(f!=null){var N=f,z=N;return _.replace(/([^\.])+/g,function(U,nt,ot,Z){var ut=U.match(/([^\[0-9]+){1}(\[)([0-9+])/),dt=ot+U.length>=Z.length,ft=function(){return z[ut[1]]||function(){return z[ut[1]]=[],z[ut[1]]}()};if(dt)ut?ft()[ut[3]]=h:z[U]=h;else if(ut){var ct=ft();z=ct[ut[3]]||function(){return ct[ut[3]]={},ct[ut[3]]}()}else z=z[U]||function(){return z[U]={},z[U]}();return""}),f}}e.replace=y;function c(f,_,h){for(var N=0;N<h.length;N++){var z=h[N][0][h[N][1]].apply(h[N][0],h[N][2]);if(z===_)return z}return f}e.functionChain=c;function F(f,_,h,N){var z=function(nt){var ot=nt.match(/(\${.*?})/g);if(ot!=null)for(var Z=0;Z<ot.length;Z++){var ut=_[ot[Z].substring(2,ot[Z].length-1)]||"";ut!=null&&(nt=nt.replace(ot[Z],ut))}return nt},U=function(nt){if(nt!=null){if(g(nt))return z(nt);if(r(nt)&&!N&&(h==null||(nt.name||"").indexOf(h)===0))return nt(_);if(d(nt)){for(var ot=[],Z=0;Z<nt.length;Z++)ot.push(U(nt[Z]));return ot}else if(v(nt)){var ut={};for(var dt in nt)ut[dt]=U(nt[dt]);return ut}else return nt}};return U(f)}e.populate=F;function k(f,_){if(f){for(var h=0;h<f.length;h++)if(_(f[h]))return h}return-1}e.findWithFunction=k;function B(f,_){var h=k(f,_);return h>-1&&f.splice(h,1),h!==-1}e.removeWithFunction=B;function M(f,_){var h=f.indexOf(_);return h>-1&&f.splice(h,1),h!==-1}e.remove=M;function A(f,_,h){k(f,h)===-1&&f.push(_)}e.addWithFunction=A;function I(f,_,h,N){var z=f[_];return z==null&&(z=[],f[_]=z),z[N?"unshift":"push"](h),z}e.addToList=I;function l(f,_,h){return f.indexOf(_)===-1?(h?f.unshift(_):f.push(_),!0):!1}e.suggest=l;function T(f,_,h){var N;_=d(_)?_:[_];var z=function(Z){for(var ut=Z.__proto__;ut!=null;)if(ut.prototype!=null){for(var dt in ut.prototype)ut.prototype.hasOwnProperty(dt)&&!f.prototype.hasOwnProperty(dt)&&(f.prototype[dt]=ut.prototype[dt]);ut=ut.prototype.__proto__}else ut=null};for(N=0;N<_.length;N++){for(var U in _[N].prototype)_[N].prototype.hasOwnProperty(U)&&!f.prototype.hasOwnProperty(U)&&(f.prototype[U]=_[N].prototype[U]);z(_[N])}var nt=function(Z,ut){return function(){for(N=0;N<_.length;N++)_[N].prototype[Z]&&_[N].prototype[Z].apply(this,arguments);return ut.apply(this,arguments)}},ot=function(Z){for(var ut in Z)f.prototype[ut]=nt(ut,Z[ut])};if(arguments.length>2)for(N=2;N<arguments.length;N++)ot(arguments[N]);return f}e.extend=T;for(var x=[],R=0;R<256;R++)x[R]=(R<16?"0":"")+R.toString(16);function G(){var f=Math.random()*4294967295|0,_=Math.random()*4294967295|0,h=Math.random()*4294967295|0,N=Math.random()*4294967295|0;return x[f&255]+x[f>>8&255]+x[f>>16&255]+x[f>>24&255]+"-"+x[_&255]+x[_>>8&255]+"-"+x[_>>16&15|64]+x[_>>24&255]+"-"+x[h&63|128]+x[h>>8&255]+"-"+x[h>>16&255]+x[h>>24&255]+x[N&255]+x[N>>8&255]+x[N>>16&255]+x[N>>24&255]}e.uuid=G;function C(f){if(f==null)return null;for(var _=f.replace(/^\s\s*/,""),h=/\s/,N=_.length;h.test(_.charAt(--N)););return _.slice(0,N+1)}e.fastTrim=C;function W(f,_){f=f.length==null||typeof f=="string"?[f]:f;for(var h=0;h<f.length;h++)_(f[h])}e.each=W;function V(f,_){for(var h=[],N=0;N<f.length;N++)h.push(_(f[N]));return h}e.map=V;function Y(f,_,h){h=h||"parent";var N=function(Z){return Z?_[Z]:null},z=function(Z){return Z?N(Z[h]):null},U=function(Z,ut){if(Z==null)return ut;var dt=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];ut.mergeStrategy==="override"&&Array.prototype.push.apply(dt,["events","overlays"]);var ft=D(Z,ut,[],dt);return U(z(Z),ft)},nt=function(Z){if(Z==null)return{};if(typeof Z=="string")return N(Z);if(Z.length){for(var ut=!1,dt=0,ft=void 0;!ut&&dt<Z.length;)ft=nt(Z[dt]),ft?ut=!0:dt++;return ft}},ot=nt(f);return ot?U(z(ot),ot):{}}e.mergeWithParents=Y,e.logEnabled=!0;function L(){if(e.logEnabled&&typeof console<"u")try{var f=arguments[arguments.length-1];console.log(f)}catch{}}e.log=L;function q(f,_,h){return function(){var N=null;try{_!=null&&(N=_.apply(this,arguments))}catch(z){L("jsPlumb function failed : "+z)}if(f!=null&&(h==null||N!==h))try{N=f.apply(this,arguments)}catch(z){L("wrapped function failed : "+z)}return N}}e.wrap=q;var tt=function(){function f(){var _=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(h,N,z){var U=function(ot){I(_._listeners,ot,N,z),N.__jsPlumb=N.__jsPlumb||{},N.__jsPlumb[G()]=ot};if(typeof h=="string")U(h);else if(h.length!=null)for(var nt=0;nt<h.length;nt++)U(h[nt]);return _},this.fire=function(h,N,z){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[h]){var U=this._listeners[h].length,nt=0,ot=!1,Z=null;if(!this.shouldFireEvent||this.shouldFireEvent(h,N,z))for(;!ot&&nt<U&&Z!==!1;){if(this.eventsToDieOn[h])this._listeners[h][nt].apply(this,[N,z]);else try{Z=this._listeners[h][nt].apply(this,[N,z])}catch(ut){L("jsPlumb: fire failed for event "+h+" : "+ut)}nt++,(this._listeners==null||this._listeners[h]==null)&&(ot=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var h=_.queue.pop();h&&_.fire.apply(_,h)},this.unbind=function(h,N){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof h=="string")delete this._listeners[h];else if(h.__jsPlumb){var z=void 0;for(var U in h.__jsPlumb)z=h.__jsPlumb[U],M(this._listeners[z]||[],h)}}else arguments.length===2&&M(this._listeners[h]||[],N);return this},this.getListener=function(h){return _._listeners[h]},this.setSuspendEvents=function(h){_.eventsSuspended=h},this.isSuspendEvents=function(){return _.eventsSuspended},this.silently=function(h){_.setSuspendEvents(!0);try{h()}catch(N){L("Cannot execute silent function "+N)}_.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var h in _._listeners)_._listeners[h]=null}}return f}();e.EventGenerator=tt;function K(f,_,h){var N=[f[0]-_[0],f[1]-_[1]],z=Math.cos(h/360*Math.PI*2),U=Math.sin(h/360*Math.PI*2);return[N[0]*z-N[1]*U+_[0],N[1]*z+N[0]*U+_[1],z,U]}e.rotatePoint=K;function rt(f,_){var h=K(f,[0,0],_);return[Math.round(h[0]),Math.round(h[1])]}e.rotateAnchorOrientation=rt}.call(typeof window<"u"?window:ne),function(){var i=this;i.jsPlumbUtil.matchesSelector=function(e,d,w){w=w||e.parentNode;for(var g=w.querySelectorAll(d),S=0;S<g.length;S++)if(g[S]===e)return!0;return!1},i.jsPlumbUtil.consume=function(e,d){e.stopPropagation?e.stopPropagation():e.returnValue=!1,!d&&e.preventDefault&&e.preventDefault()},i.jsPlumbUtil.sizeElement=function(e,d,w,g,S){e&&(e.style.height=S+"px",e.height=S,e.style.width=g+"px",e.width=g,e.style.left=d+"px",e.style.top=w+"px")}}.call(typeof window<"u"?window:ne),function(){var i={deriveAnchor:function(g,S,o,v){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[g][S]}},e=this,d=function(g,S){this.count=0,this.instance=g,this.lists={},this.options=S||{},this.instance.addList=function(o,v){return this.listManager.addList(o,v)},this.instance.removeList=function(o){this.listManager.removeList(o)},this.instance.bind("manageElement",function(o){for(var v=this.instance.getSelector(o.el,"[jtk-scrollable-list]"),u=0;u<v.length;u++)this.addList(v[u])}.bind(this)),this.instance.bind("unmanageElement",function(o){this.removeList(o.el)}),this.instance.bind("connection",function(o,v){v==null&&(this._maybeUpdateParentList(o.source),this._maybeUpdateParentList(o.target))}.bind(this))};e.jsPlumbListManager=d,d.prototype={addList:function(g,S){var o=this.instance.extend({},i);this.instance.extend(o,this.options),S=this.instance.extend(o,S||{});var v=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[v]=new w(this.instance,g,S,v)},removeList:function(g){var S=this.lists[g._jsPlumbList];S&&(S.destroy(),delete this.lists[g._jsPlumbList])},_maybeUpdateParentList:function(g){for(var S=g.parentNode,o=this.instance.getContainer();S!=null&&S!==o;){if(S._jsPlumbList!=null&&this.lists[S._jsPlumbList]!=null){S._jsPlumbScrollHandler();return}S=S.parentNode}}};var w=function(g,S,o,v){S._jsPlumbList=v;function u(O,D,y,c){return o.anchor?o.anchor:o.deriveAnchor(O,D,y,c)}function r(O,D,y,c){return o.deriveEndpoint?o.deriveEndpoint(O,D,y,c):o.endpoint?o.endpoint:y.type}function m(O){for(var D=O.parentNode,y=g.getContainer();D!=null&&D!==y;){if(g.hasClass(D,"jtk-managed")){g.recalculateOffsets(D);return}D=D.parentNode}}var E=function(O){for(var D=g.getSelector(S,".jtk-managed"),y=g.getId(S),c=0;c<D.length;c++){if(D[c].offsetTop<S.scrollTop)D[c]._jsPlumbProxies||(D[c]._jsPlumbProxies=D[c]._jsPlumbProxies||[],g.select({source:D[c]}).each(function(k){g.proxyConnection(k,0,S,y,function(){return r("top",0,k.endpoints[0],k)},function(){return u("top",0,k.endpoints[0],k)}),D[c]._jsPlumbProxies.push([k,0])}),g.select({target:D[c]}).each(function(k){g.proxyConnection(k,1,S,y,function(){return r("top",1,k.endpoints[1],k)},function(){return u("top",1,k.endpoints[1],k)}),D[c]._jsPlumbProxies.push([k,1])}));else if(D[c].offsetTop+D[c].offsetHeight>S.scrollTop+S.offsetHeight)D[c]._jsPlumbProxies||(D[c]._jsPlumbProxies=D[c]._jsPlumbProxies||[],g.select({source:D[c]}).each(function(k){g.proxyConnection(k,0,S,y,function(){return r("bottom",0,k.endpoints[0],k)},function(){return u("bottom",0,k.endpoints[0],k)}),D[c]._jsPlumbProxies.push([k,0])}),g.select({target:D[c]}).each(function(k){g.proxyConnection(k,1,S,y,function(){return r("bottom",1,k.endpoints[1],k)},function(){return u("bottom",1,k.endpoints[1],k)}),D[c]._jsPlumbProxies.push([k,1])}));else if(D[c]._jsPlumbProxies){for(var F=0;F<D[c]._jsPlumbProxies.length;F++)g.unproxyConnection(D[c]._jsPlumbProxies[F][0],D[c]._jsPlumbProxies[F][1],y);delete D[c]._jsPlumbProxies}g.revalidate(D[c])}m(S)};g.setAttribute(S,"jtk-scrollable-list","true"),S._jsPlumbScrollHandler=E,g.on(S,"scroll",E),E(),this.destroy=function(){g.off(S,"scroll",E),delete S._jsPlumbScrollHandler;for(var O=g.getSelector(S,".jtk-managed"),D=g.getId(S),y=0;y<O.length;y++)if(O[y]._jsPlumbProxies){for(var c=0;c<O[y]._jsPlumbProxies.length;c++)g.unproxyConnection(O[y]._jsPlumbProxies[c][0],O[y]._jsPlumbProxies[c][1],D);delete O[y]._jsPlumbProxies}}}}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumbUtil,d=function(y){if(y._jsPlumb.paintStyle&&y._jsPlumb.hoverPaintStyle){var c={};D.extend(c,y._jsPlumb.paintStyle),D.extend(c,y._jsPlumb.hoverPaintStyle),delete y._jsPlumb.hoverPaintStyle,c.gradient&&y._jsPlumb.paintStyle.fill&&delete c.gradient,y._jsPlumb.hoverPaintStyle=c}},w=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],g=function(y,c,F,k){var B=y.getAttachedElements();if(B)for(var M=0,A=B.length;M<A;M++)(!k||k!==B[M])&&B[M].setHover(c,!0,F)},S=function(y){return y==null?null:y.split(" ")},o=function(y,c,F){for(var k in c)y[k]=F},v=function(y,c,F){if(y.getDefaultType){var k=y.getTypeDescriptor(),B={},M=y.getDefaultType(),A=e.merge({},M);o(B,M,"__default");for(var I=0,l=y._jsPlumb.types.length;I<l;I++){var T=y._jsPlumb.types[I];if(T!=="__default"){var x=y._jsPlumb.instance.getType(T,k);if(x!=null){var R=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],G=[];x.mergeStrategy==="override"?Array.prototype.push.apply(R,["events","overlays","cssClass"]):G.push("cssClass"),A=e.merge(A,x,G,R),o(B,x,T)}}}c&&(A=e.populate(A,c,"_")),y.applyType(A,F,B),F||y.repaint()}},u=i.jsPlumbUIComponent=function(y){e.EventGenerator.apply(this,arguments);var c=this,F=arguments,k=c.idPrefix,B=k+new Date().getTime();this._jsPlumb={instance:y._jsPlumb,parameters:y.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:y.beforeDetach,beforeDrop:y.beforeDrop,overlayPlacements:[],hoverClass:y.hoverClass||y._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(G,C,W){this._jsPlumb.typeCache[W]=this._jsPlumb.typeCache[W]||{},this._jsPlumb.typeCache[W][G]=C},this.getCachedTypeItem=function(G,C){return this._jsPlumb.typeCache[C]?this._jsPlumb.typeCache[C][G]:null},this.getId=function(){return B};var M=y.overlays||[],A={};if(this.defaultOverlayKeys){for(var I=0;I<this.defaultOverlayKeys.length;I++)Array.prototype.push.apply(M,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[I]]||[]);for(I=0;I<M.length;I++){var l=D.convertToFullOverlaySpec(M[I]);A[l[1].id]=l}}var T={overlays:A,parameters:y.parameters||{},scope:y.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return T},this.appendToDefaultType=function(G){for(var C in G)T[C]=G[C]},y.events)for(var x in y.events)c.bind(x,y.events[x]);this.clone=function(){var G=Object.create(this.constructor.prototype);return this.constructor.apply(G,F),G}.bind(this),this.isDetachAllowed=function(G){var C=!0;if(this._jsPlumb.beforeDetach)try{C=this._jsPlumb.beforeDetach(G)}catch(W){e.log("jsPlumb: beforeDetach callback failed",W)}return C},this.isDropAllowed=function(G,C,W,V,Y,L,q){var tt=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:G,targetId:C,scope:W,connection:V,dropEndpoint:Y,source:L,target:q});if(this._jsPlumb.beforeDrop)try{tt=this._jsPlumb.beforeDrop({sourceId:G,targetId:C,scope:W,connection:V,dropEndpoint:Y,source:L,target:q})}catch(K){e.log("jsPlumb: beforeDrop callback failed",K)}return tt};var R=[];this.setListenerComponent=function(G){for(var C=0;C<R.length;C++)R[C][3]=G}},r=function(y,c){var F=y._jsPlumb.types[c],k=y._jsPlumb.instance.getType(F,y.getTypeDescriptor());k!=null&&k.cssClass&&y.canvas&&y._jsPlumb.instance.removeClass(y.canvas,k.cssClass)};e.extend(i.jsPlumbUIComponent,e.EventGenerator,{getParameter:function(y){return this._jsPlumb.parameters[y]},setParameter:function(y,c){this._jsPlumb.parameters[y]=c},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(y){this._jsPlumb.parameters=y},getClass:function(){return D.getClass(this.canvas)},hasClass:function(y){return D.hasClass(this.canvas,y)},addClass:function(y){D.addClass(this.canvas,y)},removeClass:function(y){D.removeClass(this.canvas,y)},updateClasses:function(y,c){D.updateClasses(this.canvas,y,c)},setType:function(y,c,F){this.clearTypes(),this._jsPlumb.types=S(y)||[],v(this,c,F)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(y,c){v(this,y,c)},hasType:function(y){return this._jsPlumb.types.indexOf(y)!==-1},addType:function(y,c,F){var k=S(y),B=!1;if(k!=null){for(var M=0,A=k.length;M<A;M++)this.hasType(k[M])||(this._jsPlumb.types.push(k[M]),B=!0);B&&v(this,c,F)}},removeType:function(y,c,F){var k=S(y),B=!1,M=function(l){var T=this._jsPlumb.types.indexOf(l);return T!==-1?(r(this,T),this._jsPlumb.types.splice(T,1),!0):!1}.bind(this);if(k!=null){for(var A=0,I=k.length;A<I;A++)B=M(k[A])||B;B&&v(this,c,F)}},clearTypes:function(y,c){for(var F=this._jsPlumb.types.length,k=0;k<F;k++)r(this,0),this._jsPlumb.types.splice(0,1);v(this,y,c)},toggleType:function(y,c,F){var k=S(y);if(k!=null){for(var B=0,M=k.length;B<M;B++){var A=this._jsPlumb.types.indexOf(k[B]);A!==-1?(r(this,A),this._jsPlumb.types.splice(A,1)):this._jsPlumb.types.push(k[B])}v(this,c,F)}},applyType:function(y,c){if(this.setPaintStyle(y.paintStyle,c),this.setHoverPaintStyle(y.hoverPaintStyle,c),y.parameters)for(var F in y.parameters)this.setParameter(F,y.parameters[F]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(y,c){this._jsPlumb.paintStyle=y,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,d(this),c||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(y,c){this._jsPlumb.hoverPaintStyle=y,d(this),c||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(y){(y||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(y,c,F){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=y;var k=y?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[k](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[k](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=y?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(F=F||jsPlumbUtil.uuid(),this.repaint({timestamp:F,recalc:!1}))),this.getAttachedElements&&!c&&g(this,y,jsPlumbUtil.uuid(),this)}}});var m=0,E=function(){var y=m+1;return m++,y},O=i.jsPlumbInstance=function(y){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},y&&D.extend(this.Defaults,y),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},e.EventGenerator.apply(this);var c=this,F=E(),k=c.bind,B={},M=1,A=function(P){if(P==null)return null;if(P.nodeType===3||P.nodeType===8)return{el:P,text:!0};var Q=c.getElement(P);return{el:Q,id:e.isString(P)&&Q==null?P:Ct(Q)}};this.getInstanceIndex=function(){return F},this.setZoom=function(P,Q){return M=P,c.fire("zoom",M),Q&&c.repaintEverything(),!0},this.getZoom=function(){return M};for(var I in this.Defaults)B[I]=this.Defaults[I];var l,T=[];this.unbindContainer=function(){if(l!=null&&T.length>0)for(var P=0;P<T.length;P++)c.off(l,T[P][0],T[P][1])},this.setContainer=function(P){this.unbindContainer(),P=this.getElement(P),this.select().each(function(Lt){Lt.moveParent(P)}),this.selectEndpoints().each(function(Lt){Lt.moveParent(P)});var Q=l;l=P,T.length=0;for(var X={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},et=function(Lt,bt,Gt){var Bt=bt.srcElement||bt.target,Kt=(Bt&&Bt.parentNode?Bt.parentNode._jsPlumb:null)||(Bt?Bt._jsPlumb:null)||(Bt&&Bt.parentNode&&Bt.parentNode.parentNode?Bt.parentNode.parentNode._jsPlumb:null);if(Kt){Kt.fire(Lt,Kt,bt);var ee=Gt&&X[Gt+Lt]||Lt;c.fire(ee,Kt.component||Kt,bt)}},at=function(Lt,bt,Gt){T.push([Lt,Gt]),c.on(l,Lt,bt,Gt)},gt=function(Lt){at(Lt,".jtk-connector",function(bt){et(Lt,bt)}),at(Lt,".jtk-endpoint",function(bt){et(Lt,bt,"endpoint")}),at(Lt,".jtk-overlay",function(bt){et(Lt,bt)})},Et=0;Et<w.length;Et++)gt(w[Et]);for(var jt in V){var kt=V[jt].el;kt.parentNode===Q&&(Q.removeChild(kt),l.appendChild(kt))}},this.getContainer=function(){return l},this.bind=function(P,Q){P==="ready"&&R?Q():k.apply(c,[P,Q])},c.importDefaults=function(P){for(var Q in P)c.Defaults[Q]=P[Q];return P.Container&&c.setContainer(P.Container),c},c.restoreDefaults=function(){return c.Defaults=D.extend({},B),c};var x=null,R=!1,G=[],C={},W={},V={},Y={},L={},q=!1,tt=[],K=!1,rt=null,f=this.Defaults.Scope,_=1,h=function(){return""+_++},N=function(P,Q){l?l.appendChild(P):Q?this.getElement(Q).appendChild(P):this.appendToRoot(P)}.bind(this),z=function(P,Q,X,et){var at={c:[],e:[]};if(!K&&(P=c.getElement(P),P!=null)){var gt=Ct(P),Et=P.querySelectorAll(".jtk-managed");X==null&&(X=jsPlumbUtil.uuid()),te({elId:gt,offset:Q,recalc:!1,timestamp:X});for(var jt=0;jt<Et.length;jt++)te({elId:Et[jt].getAttribute("id"),recalc:!0,timestamp:X});var kt=c.router.redraw(gt,Q,X,null,et);if(Array.prototype.push.apply(at.c,kt.c),Array.prototype.push.apply(at.e,kt.e),Et)for(var Lt=0;Lt<Et.length;Lt++)kt=c.router.redraw(Et[Lt].getAttribute("id"),null,X,null,et,!0),Array.prototype.push.apply(at.c,kt.c),Array.prototype.push.apply(at.e,kt.e)}return at},U=function(P){return W[P]},nt=function(P,Q){for(var X=P.scope.split(/\s/),et=Q.scope.split(/\s/),at=0;at<X.length;at++)for(var gt=0;gt<et.length;gt++)if(et[gt]===X[at])return!0;return!1},ot=function(P,Q){var X=D.extend({},P);for(var et in Q)Q[et]&&(X[et]=Q[et]);return X},Z=function(P,Q){var X=D.extend({},P);if(Q&&D.extend(X,Q),X.source&&(X.source.endpoint?X.sourceEndpoint=X.source:X.source=c.getElement(X.source)),X.target&&(X.target.endpoint?X.targetEndpoint=X.target:X.target=c.getElement(X.target)),P.uuids&&(X.sourceEndpoint=U(P.uuids[0]),X.targetEndpoint=U(P.uuids[1])),X.sourceEndpoint&&X.sourceEndpoint.isFull()){e.log(c,"could not add connection; source endpoint is full");return}if(X.targetEndpoint&&X.targetEndpoint.isFull()){e.log(c,"could not add connection; target endpoint is full");return}if(!X.type&&X.sourceEndpoint&&(X.type=X.sourceEndpoint.connectionType),X.sourceEndpoint&&X.sourceEndpoint.connectorOverlays){X.overlays=X.overlays||[];for(var et=0,at=X.sourceEndpoint.connectorOverlays.length;et<at;et++)X.overlays.push(X.sourceEndpoint.connectorOverlays[et])}X.sourceEndpoint&&X.sourceEndpoint.scope&&(X.scope=X.sourceEndpoint.scope),!X["pointer-events"]&&X.sourceEndpoint&&X.sourceEndpoint.connectorPointerEvents&&(X["pointer-events"]=X.sourceEndpoint.connectorPointerEvents);var gt=function(jt,kt,Lt){var bt=ot(kt,{anchor:X.anchors?X.anchors[Lt]:X.anchor,endpoint:X.endpoints?X.endpoints[Lt]:X.endpoint,paintStyle:X.endpointStyles?X.endpointStyles[Lt]:X.endpointStyle,hoverPaintStyle:X.endpointHoverStyles?X.endpointHoverStyles[Lt]:X.endpointHoverStyle});return c.addEndpoint(jt,bt)},Et=function(jt,kt,Lt,bt){if(X[jt]&&!X[jt].endpoint&&!X[jt+"Endpoint"]&&!X.newConnection){var Gt=Ct(X[jt]),Bt=Lt[Gt];if(Bt=Bt?Bt[bt]:null,Bt){if(!Bt.enabled)return!1;var Kt=D.extend({},Bt.def);delete Kt.label;var ee=Bt.endpoint!=null&&Bt.endpoint._jsPlumb?Bt.endpoint:gt(X[jt],Kt,kt);if(ee.isFull())return!1;X[jt+"Endpoint"]=ee,!X.scope&&Kt.scope&&(X.scope=Kt.scope),Bt.uniqueEndpoint?Bt.endpoint?ee.finalEndpoint=Bt.endpoint:(Bt.endpoint=ee,ee.setDeleteOnEmpty(!1)):ee.setDeleteOnEmpty(!0),kt===0&&Bt.def.connectorOverlays&&(X.overlays=X.overlays||[],Array.prototype.push.apply(X.overlays,Bt.def.connectorOverlays))}}};if(Et("source",0,this.sourceEndpointDefinitions,X.type||"default")!==!1&&Et("target",1,this.targetEndpointDefinitions,X.type||"default")!==!1)return X.sourceEndpoint&&X.targetEndpoint&&(nt(X.sourceEndpoint,X.targetEndpoint)||(X=null)),X}.bind(c),ut=function(P){var Q=c.Defaults.ConnectionType||c.getDefaultConnectionType();P._jsPlumb=c,P.newConnection=ut,P.newEndpoint=ft,P.endpointsByUUID=W,P.endpointsByElement=C,P.finaliseConnection=dt,P.id="con_"+h();var X=new Q(P);return X.isDetachable()&&(X.endpoints[0].initDraggable("_jsPlumbSource"),X.endpoints[1].initDraggable("_jsPlumbTarget")),X},dt=c.finaliseConnection=function(P,Q,X,et){if(Q=Q||{},P.suspendedEndpoint||G.push(P),P.pending=null,P.endpoints[0].isTemporarySource=!1,et!==!1&&c.router.newConnection(P),z(P.source),!Q.doNotFireConnectionEvent&&Q.fireEvent!==!1){var at={connection:P,source:P.source,target:P.target,sourceId:P.sourceId,targetId:P.targetId,sourceEndpoint:P.endpoints[0],targetEndpoint:P.endpoints[1]};c.fire("connection",at,X)}},ft=function(P,Q){var X=c.Defaults.EndpointType||D.Endpoint,et=D.extend({},P);et._jsPlumb=c,et.newConnection=ut,et.newEndpoint=ft,et.endpointsByUUID=W,et.endpointsByElement=C,et.fireDetachEvent=vt,et.elementId=Q||Ct(et.source);var at=new X(et);return at.id="ep_"+h(),Ne(et.elementId,et.source),D.headless||c.getDragManager().endpointAdded(et.source,Q),at},ct=function(P,Q,X){var et=C[P];if(et&&et.length)for(var at=0,gt=et.length;at<gt;at++){for(var Et=0,jt=et[at].connections.length;Et<jt;Et++){var kt=Q(et[at].connections[Et]);if(kt)return}X&&X(et[at])}},xt=function(P,Q,X){Q=Q==="block";var et=null;X&&(et=function(gt){gt.setVisible(Q,!0,!0)});var at=A(P);ct(at.id,function(gt){if(Q&&X){var Et=gt.sourceId===at.id?1:0;gt.endpoints[Et].isVisible()&&gt.setVisible(!0)}else gt.setVisible(Q)},et)},Pt=function(P,Q){var X=null;Q&&(X=function(et){var at=et.isVisible();et.setVisible(!at)}),ct(P,function(et){var at=et.isVisible();et.setVisible(!at)},X)},Ot=function(P){var Q=Y[P];return Q?{o:Q,s:tt[P]}:te({elId:P})},Ct=function(P,Q,X){if(e.isString(P))return P;if(P==null)return null;var et=c.getAttribute(P,"id");return(!et||et==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?et=Q:(arguments.length===1||arguments.length===3&&!arguments[2])&&(et="jsPlumb_"+F+"_"+h()),X||c.setAttribute(P,"id",et)),et};this.setConnectionBeingDragged=function(P){q=P},this.isConnectionBeingDragged=function(){return q},this.getManagedElements=function(){return V},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(P,Q,X){X=X||{};var et=D.extend({},X);D.extend(et,Q),et.endpoint=et.endpoint||c.Defaults.Endpoint,et.paintStyle=et.paintStyle||c.Defaults.EndpointStyle;for(var at=[],gt=e.isArray(P)||P.length!=null&&!e.isString(P)?P:[P],Et=0,jt=gt.length;Et<jt;Et++){et.source=c.getElement(gt[Et]),Ue(et.source);var kt=Ct(et.source),Lt=ft(et,kt),bt=Ne(kt,et.source,null,!K).info.o;e.addToList(C,kt,Lt),K||Lt.paint({anchorLoc:Lt.anchor.compute({xy:[bt.left,bt.top],wh:tt[kt],element:Lt,timestamp:rt,rotation:this.getRotation(kt)}),timestamp:rt}),at.push(Lt)}return at.length===1?at[0]:at},this.addEndpoints=function(P,Q,X){for(var et=[],at=0,gt=Q.length;at<gt;at++){var Et=c.addEndpoint(P,Q[at],X);e.isArray(Et)?Array.prototype.push.apply(et,Et):et.push(Et)}return et},this.animate=function(P,Q,X){if(!this.animationSupported)return!1;X=X||{};var et=c.getElement(P),at=Ct(et),gt=D.animEvents.step,Et=D.animEvents.complete;X[gt]=e.wrap(X[gt],function(){c.revalidate(at)}),X[Et]=e.wrap(X[Et],function(){c.revalidate(at)}),c.doAnimate(et,Q,X)},this.checkCondition=function(P,Q){var X=c.getListener(P),et=!0;if(X&&X.length>0){var at=Array.prototype.slice.call(arguments,1);try{for(var gt=0,Et=X.length;gt<Et;gt++)et=et&&X[gt].apply(X[gt],at)}catch(jt){e.log(c,"cannot check condition ["+P+"]"+jt)}}return et},this.connect=function(P,Q){var X=Z(P,Q),et;if(X){if(X.source==null&&X.sourceEndpoint==null){e.log("Cannot establish connection - source does not exist");return}if(X.target==null&&X.targetEndpoint==null){e.log("Cannot establish connection - target does not exist");return}Ue(X.source),et=ut(X),dt(et,X)}return et};var Rt=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Mt=function(P,Q,X,et){var at,gt=Rt[X],Et=P[gt.elId];P[gt.el];var jt,kt,Lt=P.endpoints[X],bt={index:X,originalSourceId:X===0?Et:P.sourceId,newSourceId:P.sourceId,originalTargetId:X===1?Et:P.targetId,newTargetId:P.targetId,connection:P};if(Q.constructor===D.Endpoint)at=Q,at.addConnection(P),Q=at.element;else if(jt=Ct(Q),kt=this[gt.epDefs][jt],jt===P[gt.elId])at=null;else if(kt)for(var Gt in kt){if(!kt[Gt].enabled)return;at=kt[Gt].endpoint!=null&&kt[Gt].endpoint._jsPlumb?kt[Gt].endpoint:this.addEndpoint(Q,kt[Gt].def),kt[Gt].uniqueEndpoint&&(kt[Gt].endpoint=at),at.addConnection(P)}else at=P.makeEndpoint(X===0,Q,jt);return at!=null&&(Lt.detachFromConnection(P),P.endpoints[X]=at,P[gt.el]=at.element,P[gt.elId]=at.elementId,bt[X===0?"newSourceId":"newTargetId"]=at.elementId,mt(bt),et||P.repaint()),bt.element=Q,bt}.bind(this);this.setSource=function(P,Q,X){var et=Mt(P,Q,0,X);this.router.sourceOrTargetChanged(et.originalSourceId,et.newSourceId,P,et.el,0)},this.setTarget=function(P,Q,X){var et=Mt(P,Q,1,X);this.router.sourceOrTargetChanged(et.originalTargetId,et.newTargetId,P,et.el,1)},this.deleteEndpoint=function(P,Q,X){var et=typeof P=="string"?W[P]:P;return et&&c.deleteObject({endpoint:et,dontUpdateHover:Q,deleteAttachedObjects:X}),c},this.deleteEveryEndpoint=function(){var P=c.setSuspendDrawing(!0);for(var Q in C){var X=C[Q];if(X&&X.length)for(var et=0,at=X.length;et<at;et++)c.deleteEndpoint(X[et],!0)}C={},V={},W={},Y={},L={},c.router.reset();var gt=c.getDragManager();return gt&&gt.reset(),P||c.setSuspendDrawing(!1),c};var vt=function(P,Q,X){var et=c.Defaults.ConnectionType||c.getDefaultConnectionType(),at=P.constructor===et,gt=at?{connection:P,source:P.source,target:P.target,sourceId:P.sourceId,targetId:P.targetId,sourceEndpoint:P.endpoints[0],targetEndpoint:P.endpoints[1]}:P;Q&&c.fire("connectionDetached",gt,X),c.fire("internal.connectionDetached",gt,X),c.router.connectionDetached(gt)},mt=c.fireMoveEvent=function(P,Q){c.fire("connectionMoved",P,Q)};this.unregisterEndpoint=function(P){P._jsPlumb.uuid&&(W[P._jsPlumb.uuid]=null),c.router.deleteEndpoint(P);for(var Q in C){var X=C[Q];if(X){for(var et=[],at=0,gt=X.length;at<gt;at++)X[at]!==P&&et.push(X[at]);C[Q]=et}C[Q].length<1&&delete C[Q]}};var wt="isDetachAllowed",Tt="beforeDetach",Ft="checkCondition";this.deleteConnection=function(P,Q){return P!=null&&(Q=Q||{},Q.force||e.functionChain(!0,!1,[[P.endpoints[0],wt,[P]],[P.endpoints[1],wt,[P]],[P,wt,[P]],[c,Ft,[Tt,P]]]))?(P.setHover(!1),vt(P,!P.pending&&Q.fireEvent!==!1,Q.originalEvent),P.endpoints[0].detachFromConnection(P),P.endpoints[1].detachFromConnection(P),e.removeWithFunction(G,function(X){return P.id===X.id}),P.cleanup(),P.destroy(),!0):!1},this.deleteEveryConnection=function(P){P=P||{};var Q=G.length,X=0;return c.batch(function(){for(var et=0;et<Q;et++)X+=c.deleteConnection(G[0],P)?1:0}),X},this.deleteConnectionsForElement=function(P,Q){Q=Q||{},P=c.getElement(P);var X=Ct(P),et=C[X];if(et&&et.length)for(var at=0,gt=et.length;at<gt;at++)et[at].deleteEveryConnection(Q);return c},this.deleteObject=function(P){var Q={endpoints:{},connections:{},endpointCount:0,connectionCount:0},X=P.deleteAttachedObjects!==!1,et=function(bt){bt!=null&&Q.connections[bt.id]==null&&(!P.dontUpdateHover&&bt._jsPlumb!=null&&bt.setHover(!1),Q.connections[bt.id]=bt,Q.connectionCount++)},at=function(bt){if(bt!=null&&Q.endpoints[bt.id]==null&&(!P.dontUpdateHover&&bt._jsPlumb!=null&&bt.setHover(!1),Q.endpoints[bt.id]=bt,Q.endpointCount++,X))for(var Gt=0;Gt<bt.connections.length;Gt++){var Bt=bt.connections[Gt];et(Bt)}};P.connection?et(P.connection):at(P.endpoint);for(var gt in Q.connections){var Et=Q.connections[gt];if(Et._jsPlumb){e.removeWithFunction(G,function(bt){return Et.id===bt.id}),vt(Et,P.fireEvent===!1?!1:!Et.pending,P.originalEvent);var jt=P.deleteAttachedObjects==null?null:!P.deleteAttachedObjects;Et.endpoints[0].detachFromConnection(Et,null,jt),Et.endpoints[1].detachFromConnection(Et,null,jt),Et.cleanup(!0),Et.destroy(!0)}}for(var kt in Q.endpoints){var Lt=Q.endpoints[kt];Lt._jsPlumb&&(c.unregisterEndpoint(Lt),Lt.cleanup(!0),Lt.destroy(!0))}return Q};var Jt=function(P,Q,X,et){for(var at=0,gt=P.length;at<gt;at++)P[at][Q].apply(P[at],X);return et(P)},ie=function(P,Q,X){for(var et=[],at=0,gt=P.length;at<gt;at++)et.push([P[at][Q].apply(P[at],X),P[at]]);return et},fe=function(P,Q,X){return function(){return Jt(P,Q,arguments,X)}},ge=function(P,Q){return function(){return ie(P,Q,arguments)}},we=function(P,Q){var X=[];if(P)if(typeof P=="string"){if(P==="*")return P;X.push(P)}else if(Q)X=P;else if(P.length)for(var et=0,at=P.length;et<at;et++)X.push(A(P[et]).id);else X.push(A(P).id);return X},xe=function(P,Q,X){return P==="*"?!0:P.length>0?P.indexOf(Q)!==-1:!X};this.getConnections=function(P,Q){P?P.constructor===String&&(P={scope:P}):P={};for(var X=P.scope||c.getDefaultScope(),et=we(X,!0),at=we(P.source),gt=we(P.target),Et=!Q&&et.length>1?{}:[],jt=function(Kt,ee){if(!Q&&et.length>1){var se=Et[Kt];se==null&&(se=Et[Kt]=[]),se.push(ee)}else Et.push(ee)},kt=0,Lt=G.length;kt<Lt;kt++){var bt=G[kt],Gt=bt.proxies&&bt.proxies[0]?bt.proxies[0].originalEp.elementId:bt.sourceId,Bt=bt.proxies&&bt.proxies[1]?bt.proxies[1].originalEp.elementId:bt.targetId;xe(et,bt.scope)&&xe(at,Gt)&&xe(gt,Bt)&&jt(bt.scope,bt)}return Et};var Xe=function(P,Q){return function(X){for(var et=0,at=P.length;et<at;et++)X(P[et]);return Q(P)}},Ke=function(P){return function(Q){return P[Q]}},rn=function(P,Q){var X={length:P.length,each:Xe(P,Q),get:Ke(P)},et=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],at=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],gt,Et;for(gt=0,Et=et.length;gt<Et;gt++)X[et[gt]]=fe(P,et[gt],Q);for(gt=0,Et=at.length;gt<Et;gt++)X[at[gt]]=ge(P,at[gt]);return X},Se=function(P){var Q=rn(P,Se);return D.extend(Q,{setDetachable:fe(P,"setDetachable",Se),setReattach:fe(P,"setReattach",Se),setConnector:fe(P,"setConnector",Se),delete:function(){for(var X=0,et=P.length;X<et;X++)c.deleteConnection(P[X])},isDetachable:ge(P,"isDetachable"),isReattach:ge(P,"isReattach")})},Me=function(P){var Q=rn(P,Me);return D.extend(Q,{setEnabled:fe(P,"setEnabled",Me),setAnchor:fe(P,"setAnchor",Me),isEnabled:ge(P,"isEnabled"),deleteEveryConnection:function(){for(var X=0,et=P.length;X<et;X++)P[X].deleteEveryConnection()},delete:function(){for(var X=0,et=P.length;X<et;X++)c.deleteEndpoint(P[X])}})};this.select=function(P){return P=P||{},P.scope=P.scope||"*",Se(P.connections||c.getConnections(P,!0))},this.selectEndpoints=function(P){P=P||{},P.scope=P.scope||"*";var Q=!P.element&&!P.source&&!P.target,X=Q?"*":we(P.element),et=Q?"*":we(P.source),at=Q?"*":we(P.target),gt=we(P.scope,!0),Et=[];for(var jt in C){var kt=xe(X,jt,!0),Lt=xe(et,jt,!0),bt=et!=="*",Gt=xe(at,jt,!0),Bt=at!=="*";if(kt||Lt||Gt)t:for(var Kt=0,ee=C[jt].length;Kt<ee;Kt++){var se=C[jt][Kt];if(xe(gt,se.scope,!0)){var Je=bt&&et.length>0&&!se.isSource,hn=Bt&&at.length>0&&!se.isTarget;if(Je||hn)continue t;Et.push(se)}}}return Me(Et)},this.getAllConnections=function(){return G},this.getDefaultScope=function(){return f},this.getEndpoint=U,this.getEndpoints=function(P){return C[A(P).id]||[]},this.getDefaultEndpointType=function(){return D.Endpoint},this.getDefaultConnectionType=function(){return D.Connection},this.getId=Ct,this.draw=z,this.info=A,this.appendElement=N;var Ee=!1;this.isHoverSuspended=function(){return Ee},this.setHoverSuspended=function(P){Ee=P},this.hide=function(P,Q){return xt(P,"none",Q),c},this.idstamp=h;var Ue=function(P){if(!l&&P){var Q=c.getElement(P);Q.offsetParent&&c.setContainer(Q.offsetParent)}},Ie=function(){c.Defaults.Container&&c.setContainer(c.Defaults.Container)},Ne=c.manage=function(P,Q,X,et){return V[P]?et&&(V[P].info=te({elId:P,timestamp:rt,recalc:!0})):(V[P]={el:Q,endpoints:[],connections:[],rotation:0},V[P].info=te({elId:P,timestamp:rt}),c.addClass(Q,"jtk-managed"),X||c.fire("manageElement",{id:P,info:V[P].info,el:Q})),V[P]};this.unmanage=function(P){if(V[P]){var Q=V[P].el;c.removeClass(Q,"jtk-managed"),delete V[P],c.fire("unmanageElement",{id:P,el:Q})}},this.rotate=function(P,Q,X){return V[P]&&(V[P].rotation=Q,V[P].el.style.transform="rotate("+Q+"deg)",V[P].el.style.transformOrigin="center center",X!==!0)?this.revalidate(P):{c:[],e:[]}},this.getRotation=function(P){return V[P]&&V[P].rotation||0};var te=function(P){var Q=P.timestamp,X=P.recalc,et=P.offset,at=P.elId,gt;return K&&!Q&&(Q=rt),!X&&Q&&Q===L[at]?{o:P.offset||Y[at],s:tt[at]}:(X||!et&&Y[at]==null?(gt=V[at]?V[at].el:null,gt!=null&&(tt[at]=c.getSize(gt),Y[at]=c.getOffset(gt),L[at]=Q)):(Y[at]=et||Y[at],tt[at]==null&&(gt=V[at].el,gt!=null&&(tt[at]=c.getSize(gt))),L[at]=Q),Y[at]&&!Y[at].right&&(Y[at].right=Y[at].left+tt[at][0],Y[at].bottom=Y[at].top+tt[at][1],Y[at].width=tt[at][0],Y[at].height=tt[at][1],Y[at].centerx=Y[at].left+Y[at].width/2,Y[at].centery=Y[at].top+Y[at].height/2),{o:Y[at],s:tt[at]})};this.updateOffset=te,this.init=function(){R||(Ie(),c.router=new i.jsPlumb.DefaultRouter(c),c.anchorManager=c.router.anchorManager,R=!0,c.fire("ready",c))}.bind(this),this.log=x,this.jsPlumbUIComponent=u,this.makeAnchor=function(){var P,Q=function(Et,jt){if(i.jsPlumb.Anchors[Et])return new i.jsPlumb.Anchors[Et](jt);if(!c.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+Et+"'"}};if(arguments.length===0)return null;var X=arguments[0],et=arguments[1],at=null;if(X.compute&&X.getOrientation)return X;if(typeof X=="string")at=Q(arguments[0],{elementId:et,jsPlumbInstance:c});else if(e.isArray(X))if(e.isArray(X[0])||e.isString(X[0]))X.length===2&&e.isObject(X[1])?e.isString(X[0])?(P=i.jsPlumb.extend({elementId:et,jsPlumbInstance:c},X[1]),at=Q(X[0],P)):(P=i.jsPlumb.extend({elementId:et,jsPlumbInstance:c,anchors:X[0]},X[1]),at=new i.jsPlumb.DynamicAnchor(P)):at=new D.DynamicAnchor({anchors:X,selector:null,elementId:et,jsPlumbInstance:c});else{var gt={x:X[0],y:X[1],orientation:X.length>=4?[X[2],X[3]]:[0,0],offsets:X.length>=6?[X[4],X[5]]:[0,0],elementId:et,jsPlumbInstance:c,cssClass:X.length===7?X[6]:null};at=new i.jsPlumb.Anchor(gt),at.clone=function(){return new i.jsPlumb.Anchor(gt)}}return at.id||(at.id="anchor_"+h()),at},this.makeAnchors=function(P,Q,X){for(var et=[],at=0,gt=P.length;at<gt;at++)typeof P[at]=="string"?et.push(i.jsPlumb.Anchors[P[at]]({elementId:Q,jsPlumbInstance:X})):e.isArray(P[at])&&et.push(c.makeAnchor(P[at],Q,X));return et},this.makeDynamicAnchor=function(P,Q){return new i.jsPlumb.DynamicAnchor({anchors:P,selector:Q,elementId:null,jsPlumbInstance:c})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var Ce=function(P,Q,X,et,at){for(var gt=P.target||P.srcElement,Et=!1,jt=et.getSelector(Q,X),kt=0;kt<jt.length;kt++)if(jt[kt]===gt){Et=!0;break}return at?!Et:Et},ue=function(P,Q,X,et,at){var gt=new u(Q),Et=Q._jsPlumb.EndpointDropHandler({jsPlumb:c,enabled:function(){return P.def.enabled},isFull:function(){var kt=c.select({target:P.id}).length;return P.def.maxConnections>0&&kt>=P.def.maxConnections},element:P.el,elementId:P.id,isSource:et,isTarget:at,addClass:function(kt){c.addClass(P.el,kt)},removeClass:function(kt){c.removeClass(P.el,kt)},onDrop:function(kt){var Lt=kt.endpoints[0];Lt.anchor.locked=!1},isDropAllowed:function(){return gt.isDropAllowed.apply(gt,arguments)},isRedrop:function(kt){return kt.suspendedElement!=null&&kt.suspendedEndpoint!=null&&kt.suspendedEndpoint.element===P.el},getEndpoint:function(kt){var Lt=P.def.endpoint;if(Lt==null||Lt._jsPlumb==null){var bt=c.deriveEndpointAndAnchorSpec(kt.getType().join(" "),!0),Gt=bt.endpoints?i.jsPlumb.extend(Q,{endpoint:P.def.def.endpoint||bt.endpoints[1]}):Q;bt.anchors&&(Gt=i.jsPlumb.extend(Gt,{anchor:P.def.def.anchor||bt.anchors[1]})),Lt=c.addEndpoint(P.el,Gt),Lt._mtNew=!0}if(Q.uniqueEndpoint&&(P.def.endpoint=Lt),Lt.setDeleteOnEmpty(!0),kt.isDetachable()&&Lt.initDraggable(),Lt.anchor.positionFinder!=null){var Bt=c.getUIPosition(arguments,c.getZoom()),Kt=c.getOffset(P.el),ee=c.getSize(P.el),se=Bt==null?[0,0]:Lt.anchor.positionFinder(Bt,Kt,ee,Lt.anchor.constructorParams);Lt.anchor.x=se[0],Lt.anchor.y=se[1]}return Lt},maybeCleanup:function(kt){kt._mtNew&&kt.connections.length===0?c.deleteObject({endpoint:kt}):delete kt._mtNew}}),jt=i.jsPlumb.dragEvents.drop;return X.scope=X.scope||Q.scope||c.Defaults.Scope,X[jt]=e.wrap(X[jt],Et,!0),X.rank=Q.rank||0,at&&(X[i.jsPlumb.dragEvents.over]=function(){return!0}),Q.allowLoopback===!1&&(X.canDrop=function(kt){var Lt=kt.getDragElement()._jsPlumbRelatedElement;return Lt!==P.el}),c.initDroppable(P.el,X,"internal"),Et};this.makeTarget=function(P,Q,X){var et=i.jsPlumb.extend({_jsPlumb:this},X);i.jsPlumb.extend(et,Q);for(var at=et.maxConnections||-1,gt=function(Lt){var bt=A(Lt),Gt=bt.id,Bt=i.jsPlumb.extend({},et.dropOptions||{}),Kt=et.connectionType||"default";this.targetEndpointDefinitions[Gt]=this.targetEndpointDefinitions[Gt]||{},Ue(Gt),bt.el._isJsPlumbGroup&&Bt.rank==null&&(Bt.rank=-1);var ee={def:i.jsPlumb.extend({},et),uniqueEndpoint:et.uniqueEndpoint,maxConnections:at,enabled:!0};et.createEndpoint&&(ee.uniqueEndpoint=!0,ee.endpoint=c.addEndpoint(Lt,ee.def),ee.endpoint.setDeleteOnEmpty(!1)),bt.def=ee,this.targetEndpointDefinitions[Gt][Kt]=ee,ue(bt,et,Bt,et.isSource===!0,!0),bt.el._katavorioDrop[bt.el._katavorioDrop.length-1].targetDef=ee}.bind(this),Et=P.length&&P.constructor!==String?P:[P],jt=0,kt=Et.length;jt<kt;jt++)gt(Et[jt]);return this},this.unmakeTarget=function(P,Q){var X=A(P);return c.destroyDroppable(X.el,"internal"),Q||delete this.targetEndpointDefinitions[X.id],this},this.makeSource=function(P,Q,X){var et=i.jsPlumb.extend({_jsPlumb:this},X);i.jsPlumb.extend(et,Q);var at=et.connectionType||"default",gt=c.deriveEndpointAndAnchorSpec(at);et.endpoint=et.endpoint||gt.endpoints[0],et.anchor=et.anchor||gt.anchors[0];for(var Et=et.maxConnections||-1,jt=et.onMaxConnections,kt=function(Bt){var Kt=Bt.id,ee=this.getElement(Bt.el);this.sourceEndpointDefinitions[Kt]=this.sourceEndpointDefinitions[Kt]||{},Ue(Kt);var se={def:i.jsPlumb.extend({},et),uniqueEndpoint:et.uniqueEndpoint,maxConnections:Et,enabled:!0};et.createEndpoint&&(se.uniqueEndpoint=!0,se.endpoint=c.addEndpoint(P,se.def),se.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[Kt][at]=se,Bt.def=se;var Je=i.jsPlumb.dragEvents.stop,hn=i.jsPlumb.dragEvents.drag,Fe=i.jsPlumb.extend({},et.dragOptions||{}),Rn=Fe.drag,bn=Fe.stop,he=null,on=!1;Fe.scope=Fe.scope||et.scope,Fe[hn]=e.wrap(Fe[hn],function(){Rn&&Rn.apply(this,arguments),on=!1}),Fe[Je]=e.wrap(Fe[Je],function(){if(bn&&bn.apply(this,arguments),this.currentlyDragging=!1,he._jsPlumb!=null){var me=et.anchor||this.Defaults.Anchor,de=he.anchor,an=he.connections[0],qe=this.makeAnchor(me,Kt,this),He=he.element;if(qe.positionFinder!=null){var De=c.getOffset(He),Te=this.getSize(He),fn={left:De.left+de.x*Te[0],top:De.top+de.y*Te[1]},ln=qe.positionFinder(fn,De,Te,qe.constructorParams);qe.x=ln[0],qe.y=ln[1]}he.setAnchor(qe,!0),he.repaint(),this.repaint(he.elementId),an!=null&&this.repaint(an.targetId)}}.bind(this));var xn=function(me){if(!(me.which===3||me.button===2)){Kt=this.getId(this.getElement(Bt.el));var de=this.sourceEndpointDefinitions[Kt][at];if(de.enabled){if(et.filter){var an=e.isString(et.filter)?Ce(me,Bt.el,et.filter,this,et.filterExclude):et.filter(me,Bt.el);if(an===!1)return}var qe=this.select({source:Kt}).length;if(de.maxConnections>=0&&qe>=de.maxConnections)return jt&&jt({element:Bt.el,maxConnections:Et},me),!1;var He=i.jsPlumb.getPositionOnElement(me,ee,M),De={};i.jsPlumb.extend(De,de.def),De.isTemporarySource=!0,De.anchor=[He[0],He[1],0,0],De.dragOptions=Fe,de.def.scope&&(De.scope=de.def.scope),he=this.addEndpoint(Kt,De),on=!0,he.setDeleteOnEmpty(!0),de.uniqueEndpoint&&(de.endpoint?he.finalEndpoint=de.endpoint:(de.endpoint=he,he.setDeleteOnEmpty(!1)));var Te=function(){c.off(he.canvas,"mouseup",Te),c.off(Bt.el,"mouseup",Te),on&&(on=!1,c.deleteEndpoint(he))};c.on(he.canvas,"mouseup",Te),c.on(Bt.el,"mouseup",Te);var fn={};if(de.def.extract)for(var ln in de.def.extract){var $n=(me.srcElement||me.target).getAttribute(ln);$n&&(fn[de.def.extract[ln]]=$n)}c.trigger(he.canvas,"mousedown",me,fn),e.consume(me)}}}.bind(this);this.on(Bt.el,"mousedown",xn),se.trigger=xn,et.filter&&(e.isString(et.filter)||e.isFunction(et.filter))&&c.setDragFilter(Bt.el,et.filter);var pn=i.jsPlumb.extend({},et.dropOptions||{});ue(Bt,et,pn,!0,et.isTarget===!0)}.bind(this),Lt=P.length&&P.constructor!==String?P:[P],bt=0,Gt=Lt.length;bt<Gt;bt++)kt(A(Lt[bt]));return this},this.unmakeSource=function(P,Q,X){var et=A(P);c.destroyDroppable(et.el,"internal");var at=this.sourceEndpointDefinitions[et.id];if(at){for(var gt in at)if(Q==null||Q===gt){var Et=at[gt].trigger;Et&&c.off(et.el,"mousedown",Et),X||delete this.sourceEndpointDefinitions[et.id][gt]}}return this},this.unmakeEverySource=function(){for(var P in this.sourceEndpointDefinitions)c.unmakeSource(P,null,!0);return this.sourceEndpointDefinitions={},this};var _e=function(P,Q,X){Q=e.isArray(Q)?Q:[Q];var et=Ct(P);X=X||"default";for(var at=0;at<Q.length;at++){var gt=this[Q[at]][et];if(gt&&gt[X])return gt[X].def.scope||this.Defaults.Scope}}.bind(this),Ae=function(P,Q,X,et){X=e.isArray(X)?X:[X];var at=Ct(P);et=et||"default";for(var gt=0;gt<X.length;gt++){var Et=this[X[gt]][at];Et&&Et[et]&&(Et[et].def.scope=Q)}}.bind(this);this.getScope=function(P,Q){return _e(P,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(P){return _e(P,"sourceEndpointDefinitions")},this.getTargetScope=function(P){return _e(P,"targetEndpointDefinitions")},this.setScope=function(P,Q,X){this.setSourceScope(P,Q,X),this.setTargetScope(P,Q,X)},this.setSourceScope=function(P,Q,X){Ae(P,Q,"sourceEndpointDefinitions",X),this.setDragScope(P,Q)},this.setTargetScope=function(P,Q,X){Ae(P,Q,"targetEndpointDefinitions",X),this.setDropScope(P,Q)},this.unmakeEveryTarget=function(){for(var P in this.targetEndpointDefinitions)c.unmakeTarget(P,!0);return this.targetEndpointDefinitions={},this};var St=function(P,Q,X,et,at){var gt=P==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,Et,jt,kt;if(at=at||"default",Q.length&&!e.isString(Q)){Et=[];for(var Lt=0,bt=Q.length;Lt<bt;Lt++)jt=A(Q[Lt]),gt[jt.id]&&gt[jt.id][at]&&(Et[Lt]=gt[jt.id][at].enabled,kt=et?!Et[Lt]:X,gt[jt.id][at].enabled=kt,c[kt?"removeClass":"addClass"](jt.el,"jtk-"+P+"-disabled"))}else{jt=A(Q);var Gt=jt.id;gt[Gt]&&gt[Gt][at]&&(Et=gt[Gt][at].enabled,kt=et?!Et:X,gt[Gt][at].enabled=kt,c[kt?"removeClass":"addClass"](jt.el,"jtk-"+P+"-disabled"))}return Et}.bind(this),zt=function(P,Q){if(P!=null){if(e.isString(P)||!P.length)return Q.apply(this,[P]);if(P.length)return Q.apply(this,[P[0]])}}.bind(this);this.toggleSourceEnabled=function(P,Q){return St("source",P,null,!0,Q),this.isSourceEnabled(P,Q)},this.setSourceEnabled=function(P,Q,X){return St("source",P,Q,null,X)},this.isSource=function(P,Q){return Q=Q||"default",zt(P,function(X){var et=this.sourceEndpointDefinitions[A(X).id];return et!=null&&et[Q]!=null}.bind(this))},this.isSourceEnabled=function(P,Q){return Q=Q||"default",zt(P,function(X){var et=this.sourceEndpointDefinitions[A(X).id];return et&&et[Q]&&et[Q].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(P,Q){return St("target",P,null,!0,Q),this.isTargetEnabled(P,Q)},this.isTarget=function(P,Q){return Q=Q||"default",zt(P,function(X){var et=this.targetEndpointDefinitions[A(X).id];return et!=null&&et[Q]!=null}.bind(this))},this.isTargetEnabled=function(P,Q){return Q=Q||"default",zt(P,function(X){var et=this.targetEndpointDefinitions[A(X).id];return et&&et[Q]&&et[Q].enabled===!0}.bind(this))},this.setTargetEnabled=function(P,Q,X){return St("target",P,Q,null,X)},this.ready=function(P){c.bind("ready",P)};var Ht=function(P,Q){if(typeof P=="object"&&P.length)for(var X=0,et=P.length;X<et;X++)Q(P[X]);else Q(P);return c};this.repaint=function(P,Q,X){return Ht(P,function(et){z(et,Q,X)})},this.revalidate=function(P,Q,X){var et=X?P:c.getId(P);c.updateOffset({elId:et,recalc:!0,timestamp:Q});var at=c.getDragManager();return at&&at.updateOffsets(et),z(P,null,Q)},this.repaintEverything=function(){var P=jsPlumbUtil.uuid(),Q;for(Q in C)c.updateOffset({elId:Q,recalc:!0,timestamp:P});for(Q in C)z(Q,null,P);return this},this.removeAllEndpoints=function(P,Q,X){X=X||[];var et=function(at){var gt=A(at),Et=C[gt.id],jt,kt;if(Et)for(X.push(gt),jt=0,kt=Et.length;jt<kt;jt++)c.deleteEndpoint(Et[jt],!1);if(delete C[gt.id],Q&&gt.el&&gt.el.nodeType!==3&&gt.el.nodeType!==8)for(jt=0,kt=gt.el.childNodes.length;jt<kt;jt++)et(gt.el.childNodes[jt])};return et(P),this};var Vt=function(P,Q){c.removeAllEndpoints(P.id,!0,Q);for(var X=c.getDragManager(),et=function(gt){X&&X.elementRemoved(gt.id),c.router.elementRemoved(gt.id),c.isSource(gt.el)&&c.unmakeSource(gt.el),c.isTarget(gt.el)&&c.unmakeTarget(gt.el),c.destroyDraggable(gt.el),c.destroyDroppable(gt.el),delete c.floatingConnections[gt.id],delete V[gt.id],delete Y[gt.id],gt.el&&(c.removeElement(gt.el),gt.el._jsPlumb=null)},at=1;at<Q.length;at++)et(Q[at]);et(P)};this.remove=function(P,Q){var X=A(P),et=[];return X.text&&X.el.parentNode?X.el.parentNode.removeChild(X.el):X.id&&c.batch(function(){Vt(X,et)},Q===!0),c},this.empty=function(P,Q){var X=[],et=function(at,gt){var Et=A(at);if(Et.text)Et.el.parentNode.removeChild(Et.el);else if(Et.el){for(;Et.el.childNodes.length>0;)et(Et.el.childNodes[0]);gt||Vt(Et,X)}};return c.batch(function(){et(P,!0)},Q===!1),c},this.reset=function(P){c.silently(function(){Ee=!1,c.removeAllGroups(),c.removeGroupManager(),c.deleteEveryEndpoint(),P||c.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},G.length=0,this.doReset&&this.doReset()}.bind(this))},this.destroy=function(){this.reset(),l=null,T=null};var Yt=function(P){P.canvas&&P.canvas.parentNode&&P.canvas.parentNode.removeChild(P.canvas),P.cleanup(),P.destroy()};this.clear=function(){c.select().each(Yt),c.selectEndpoints().each(Yt),C={},W={}},this.setDefaultScope=function(P){return f=P,c},this.deriveEndpointAndAnchorSpec=function(P,Q){for(var X=((Q?"":"default ")+P).split(/[\s]/),et=null,at=null,gt=null,Et=null,jt=0;jt<X.length;jt++){var kt=c.getType(X[jt],"connection");kt&&(kt.endpoints&&(et=kt.endpoints),kt.endpoint&&(at=kt.endpoint),kt.anchors&&(Et=kt.anchors),kt.anchor&&(gt=kt.anchor))}return{endpoints:et||[at,at],anchors:Et||[gt,gt]}},this.setId=function(P,Q,X){var et;e.isString(P)?et=P:(P=this.getElement(P),et=this.getId(P));var at=this.getConnections({source:et,scope:"*"},!0),gt=this.getConnections({target:et,scope:"*"},!0);Q=""+Q,X?P=this.getElement(Q):(P=this.getElement(et),this.setAttribute(P,"id",Q)),C[Q]=C[et]||[];for(var Et=0,jt=C[Q].length;Et<jt;Et++)C[Q][Et].setElementId(Q),C[Q][Et].setReferenceElement(P);delete C[et],this.sourceEndpointDefinitions[Q]=this.sourceEndpointDefinitions[et],delete this.sourceEndpointDefinitions[et],this.targetEndpointDefinitions[Q]=this.targetEndpointDefinitions[et],delete this.targetEndpointDefinitions[et],this.router.changeId(et,Q);var kt=this.getDragManager();kt&&kt.changeId(et,Q),V[Q]=V[et],delete V[et];var Lt=function(bt,Gt,Bt){for(var Kt=0,ee=bt.length;Kt<ee;Kt++)bt[Kt].endpoints[Gt].setElementId(Q),bt[Kt].endpoints[Gt].setReferenceElement(P),bt[Kt][Bt+"Id"]=Q,bt[Kt][Bt]=P};Lt(at,0,"source"),Lt(gt,1,"target"),this.repaint(Q)},this.setDebugLog=function(P){x=P},this.setSuspendDrawing=function(P,Q){var X=K;return K=P,P?rt=new Date().getTime():rt=null,Q&&this.repaintEverything(),X},this.isSuspendDrawing=function(){return K},this.getSuspendedAt=function(){return rt},this.batch=function(P,Q){var X=this.isSuspendDrawing();X||this.setSuspendDrawing(!0);try{P()}catch(et){e.log("Function run while suspended failed",et)}X||this.setSuspendDrawing(!1,!Q)},this.doWhileSuspended=this.batch,this.getCachedData=Ot,this.show=function(P,Q){return xt(P,"block",Q),c},this.toggleVisible=Pt,this.addListener=this.bind;var Qt=[];this.registerFloatingConnection=function(P,Q,X){Qt[P.id]=Q,e.addToList(C,P.id,X)},this.getFloatingConnectionFor=function(P){return Qt[P]},this.listManager=new i.jsPlumbListManager(this,this.Defaults.ListStyle)};e.extend(i.jsPlumbInstance,e.EventGenerator,{setAttribute:function(y,c,F){this.setAttribute(y,c,F)},getAttribute:function(y,c){return this.getAttribute(i.jsPlumb.getElement(y),c)},convertToFullOverlaySpec:function(y){return e.isString(y)&&(y=[y,{}]),y[1].id=y[1].id||e.uuid(),y},registerConnectionType:function(y,c){if(this._connectionTypes[y]=i.jsPlumb.extend({},c),c.overlays){for(var F={},k=0;k<c.overlays.length;k++){var B=this.convertToFullOverlaySpec(c.overlays[k]);F[B[1].id]=B}this._connectionTypes[y].overlays=F}},registerConnectionTypes:function(y){for(var c in y)this.registerConnectionType(c,y[c])},registerEndpointType:function(y,c){if(this._endpointTypes[y]=i.jsPlumb.extend({},c),c.overlays){for(var F={},k=0;k<c.overlays.length;k++){var B=this.convertToFullOverlaySpec(c.overlays[k]);F[B[1].id]=B}this._endpointTypes[y].overlays=F}},registerEndpointTypes:function(y){for(var c in y)this.registerEndpointType(c,y[c])},getType:function(y,c){return c==="connection"?this._connectionTypes[y]:this._endpointTypes[y]},setIdChanged:function(y,c){this.setId(y,c,!0)},setParent:function(y,c){var F=this.getElement(y),k=this.getId(F),B=this.getElement(c),M=this.getId(B),A=this.getDragManager();F.parentNode.removeChild(F),B.appendChild(F),A&&A.setParent(F,k,B,M)},extend:function(y,c,F){var k;if(F)for(k=0;k<F.length;k++)y[F[k]]=c[F[k]];else for(k in c)y[k]=c[k];return y},floatingConnections:{},getFloatingAnchorIndex:function(y){return y.endpoints[0].isFloating()?0:y.endpoints[1].isFloating()?1:-1},proxyConnection:function(y,c,F,k,B,M){var A,I=y.endpoints[c].elementId,l=y.endpoints[c];y.proxies=y.proxies||[],y.proxies[c]?A=y.proxies[c].ep:A=this.addEndpoint(F,{endpoint:B(y,c),anchor:M(y,c),parameters:{isProxyEndpoint:!0}}),A.setDeleteOnEmpty(!0),y.proxies[c]={ep:A,originalEp:l},c===0?this.router.sourceOrTargetChanged(I,k,y,F,0):this.router.sourceOrTargetChanged(I,k,y,F,1),l.detachFromConnection(y,null,!0),A.connections=[y],y.endpoints[c]=A,l.setVisible(!1),y.setVisible(!0),this.revalidate(F)},unproxyConnection:function(y,c,F){if(!(y._jsPlumb==null||y.proxies==null||y.proxies[c]==null)){var k=y.proxies[c].originalEp.element,B=y.proxies[c].originalEp.elementId;y.endpoints[c]=y.proxies[c].originalEp,c===0?this.router.sourceOrTargetChanged(F,B,y,k,0):this.router.sourceOrTargetChanged(F,B,y,k,1),y.proxies[c].ep.detachFromConnection(y,null),y.proxies[c].originalEp.addConnection(y),y.isVisible()&&y.proxies[c].originalEp.setVisible(!0),delete y.proxies[c]}}});var D=new O;i.jsPlumb=D,D.getInstance=function(y,c){var F=new O(y);if(c)for(var k in c)F[k]=c[k];return F.init(),F},D.each=function(y,c){if(y!=null)if(typeof y=="string")c(D.getElement(y));else if(y.length!=null)for(var F=0;F<y.length;F++)c(D.getElement(y[F]));else c(y)},a.jsPlumb=D}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w="__label",g=function(o,v){var u={cssClass:v.cssClass,labelStyle:o.labelStyle,id:w,component:o,_jsPlumb:o._jsPlumb.instance},r=e.extend(u,v);return new e.Overlays[o._jsPlumb.instance.getRenderMode()].Label(r)},S=function(o,v){var u=null;if(d.isArray(v)){var r=v[0],m=e.extend({component:o,_jsPlumb:o._jsPlumb.instance},v[1]);v.length===3&&e.extend(m,v[2]),u=new e.Overlays[o._jsPlumb.instance.getRenderMode()][r](m)}else v.constructor===String?u=new e.Overlays[o._jsPlumb.instance.getRenderMode()][v]({component:o,_jsPlumb:o._jsPlumb.instance}):u=v;return u.id=u.id||d.uuid(),o.cacheTypeItem("overlay",u,u.id),o._jsPlumb.overlays[u.id]=u,u};e.OverlayCapableJsPlumbUIComponent=function(o){i.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},o.label&&(this.getDefaultType().overlays[w]=["Label",{label:o.label,location:o.labelLocation||this.defaultLabelLocation||.5,labelStyle:o.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:w}]),this.setListenerComponent=function(v){if(this._jsPlumb)for(var u in this._jsPlumb.overlays)this._jsPlumb.overlays[u].setListenerComponent(v)}},e.OverlayCapableJsPlumbUIComponent.applyType=function(o,v){if(v.overlays){var u={},r;for(r in v.overlays){var m=o._jsPlumb.overlays[v.overlays[r][1].id];if(m)m.updateFrom(v.overlays[r][1]),u[v.overlays[r][1].id]=!0,m.reattach(o._jsPlumb.instance,o);else{var E=o.getCachedTypeItem("overlay",v.overlays[r][1].id);E!=null?(E.reattach(o._jsPlumb.instance,o),E.setVisible(!0),E.updateFrom(v.overlays[r][1]),o._jsPlumb.overlays[E.id]=E):E=o.addOverlay(v.overlays[r],!0),u[E.id]=!0}}for(r in o._jsPlumb.overlays)u[o._jsPlumb.overlays[r].id]==null&&o.removeOverlay(o._jsPlumb.overlays[r].id,!0)}},d.extend(e.OverlayCapableJsPlumbUIComponent,i.jsPlumbUIComponent,{setHover:function(o,v){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var u in this._jsPlumb.overlays)this._jsPlumb.overlays[u][o?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(o,v){var u=S(this,o);if(this.getData&&u.type==="Label"&&d.isArray(o)){var r=this.getData(),m=o[1];if(r){var E=m.labelLocationAttribute||"labelLocation",O=r?r[E]:null;O&&(u.loc=O)}}return v||this.repaint(),u},getOverlay:function(o){return this._jsPlumb.overlays[o]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(o){var v=this.getOverlay(o);v&&v.hide()},hideOverlays:function(){for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o].hide()},showOverlay:function(o){var v=this.getOverlay(o);v&&v.show()},showOverlays:function(){for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o].show()},removeAllOverlays:function(o){for(var v in this._jsPlumb.overlays)this._jsPlumb.overlays[v].cleanup&&this._jsPlumb.overlays[v].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},o||this.repaint()},removeOverlay:function(o,v){var u=this._jsPlumb.overlays[o];u&&(u.setVisible(!1),!v&&u.cleanup&&u.cleanup(),delete this._jsPlumb.overlays[o],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[o],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[o])},removeOverlays:function(){for(var o=0,v=arguments.length;o<v;o++)this.removeOverlay(arguments[o])},moveParent:function(o){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),o.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),o.appendChild(this.canvas);for(var v in this._jsPlumb.overlays)if(this._jsPlumb.overlays[v].isAppendedAtTopLevel){var u=this._jsPlumb.overlays[v].getElement();u.parentNode.removeChild(u),o.appendChild(u)}}},getLabel:function(){var o=this.getOverlay(w);return o!=null?o.getLabel():null},getLabelOverlay:function(){return this.getOverlay(w)},setLabel:function(o){var v=this.getOverlay(w);if(v)o.constructor===String||o.constructor===Function?v.setLabel(o):(o.label&&v.setLabel(o.label),o.location&&v.setLocation(o.location));else{var u=o.constructor===String||o.constructor===Function?{label:o}:o;v=g(this,u),this._jsPlumb.overlays[w]=v}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(o){for(var v in this._jsPlumb.overlays)this._jsPlumb.overlays[v].cleanup(o),this._jsPlumb.overlays[v].destroy(o);o&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(o){this[o?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(o,v){this._jsPlumb.overlayPositions[o.id]=v},getAbsoluteOverlayPosition:function(o){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[o.id]:null},_clazzManip:function(o,v,u){if(!u)for(var r in this._jsPlumb.overlays)this._jsPlumb.overlays[r][o+"Class"](v)},addClass:function(o,v){this._clazzManip("add",o,v)},removeClass:function(o,v){this._clazzManip("remove",o,v)}})}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w=function(u,r,m){var E=!1;return{drag:function(){if(E)return E=!1,!0;if(r.element){var O=m.getUIPosition(arguments,m.getZoom());O!=null&&m.setPosition(r.element,O),m.repaint(r.element,O),u.paint({anchorPoint:u.anchor.getCurrentLocation({element:u})})}},stopDrag:function(){E=!0}}},g=function(u,r,m,E){var O=r.createElement("div",{position:"absolute"});r.appendElement(O);var D=r.getId(O);r.setPosition(O,m),O.style.width=E[0]+"px",O.style.height=E[1]+"px",r.manage(D,O,!0),u.id=D,u.element=O},S=function(u,r,m,E,O,D,y,c){var F=new e.FloatingAnchor({reference:r,referenceCanvas:E,jsPlumbInstance:D});return y({paintStyle:u,endpoint:m,anchor:F,source:O,scope:c})},o=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],v=function(u,r){var m=0;if(r!=null){for(var E=0;E<u.connections.length;E++)if(u.connections[E].sourceId===r||u.connections[E].targetId===r){m=E;break}}return u.connections[m]};e.Endpoint=function(u){var r=u._jsPlumb,m=u.newConnection,E=u.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:u.connectionType,maxConnections:u.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:u.maxConnections,paintStyle:u.endpointStyle||u.paintStyle||u.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:u.endpointHoverStyle||u.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:u.connectorStyle,connectorHoverStyle:u.connectorHoverStyle,connectorClass:u.connectorClass,connectorHoverClass:u.connectorHoverClass,connectorOverlays:u.connectorOverlays,connector:u.connector,connectorTooltip:u.connectorTooltip}),this._jsPlumb.enabled=u.enabled!==!1,this._jsPlumb.visible=!0,this.element=e.getElement(u.source),this._jsPlumb.uuid=u.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(u.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=u.elementId,this.dragProxy=u.dragProxy,this._jsPlumb.connectionCost=u.connectionCost,this._jsPlumb.connectionsDirected=u.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var O=u.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(A){O=A};var D=function(){var A=r.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var I=r.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(A),this.addClass(I),e.updateClasses(this.element,I,A)}.bind(this);this.prepareAnchor=function(A){var I=this._jsPlumb.instance.makeAnchor(A,this.elementId,r);return I.bind("anchorChanged",function(l){this.fire("anchorChanged",{endpoint:this,anchor:l}),D()}.bind(this)),I},this.setPreparedAnchor=function(A,I){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=A,D(),I||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(A,I){var l=this.prepareAnchor(A);return this.setPreparedAnchor(l,I),this};var y=function(A){if(this.connections.length>0)for(var I=0;I<this.connections.length;I++)this.connections[I].setHover(A,!1);else this.setHover(A)}.bind(this);this.bind("mouseover",function(){y(!0)}),this.bind("mouseout",function(){y(!1)}),u._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(A,I){var l=function(R,G){var C=r.getRenderMode();if(e.Endpoints[C][R])return new e.Endpoints[C][R](G);if(!r.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+R+"'"}},T={_jsPlumb:this._jsPlumb.instance,cssClass:u.cssClass,container:u.container,tooltip:u.tooltip,connectorTooltip:u.connectorTooltip,endpoint:this},x;return d.isString(A)?x=l(A,T):d.isArray(A)?(T=d.merge(A[1],T),x=l(A[0],T)):x=A.clone(),x.clone=function(){if(d.isString(A))return l(A,T);if(d.isArray(A))return T=d.merge(A[1],T),l(A[0],T)}.bind(this),x.typeId=I,x},this.setEndpoint=function(A,I){var l=this.prepareEndpoint(A);this.setPreparedEndpoint(l,!0)},this.setPreparedEndpoint=function(A,I){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=A,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},e.extend(this,u,o),this.isSource=u.isSource||!1,this.isTemporarySource=u.isTemporarySource||!1,this.isTarget=u.isTarget||!1,this.connections=u.connections||[],this.connectorPointerEvents=u["connector-pointer-events"],this.scope=u.scope||r.getDefaultScope(),this.timestamp=null,this.reattachConnections=u.reattach||r.Defaults.ReattachConnections,this.connectionsDetachable=r.Defaults.ConnectionsDetachable,(u.connectionsDetachable===!1||u.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=u.dragAllowedWhenFull!==!1,u.onMaxConnections&&this.bind("maxConnections",u.onMaxConnections),this.addConnection=function(A){this.connections.push(A),this[(this.connections.length>0?"add":"remove")+"Class"](r.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](r.endpointFullClass)},this.detachFromConnection=function(A,I,l){I=I??this.connections.indexOf(A),I>=0&&(this.connections.splice(I,1),this[(this.connections.length>0?"add":"remove")+"Class"](r.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](r.endpointFullClass)),!l&&O&&this.connections.length===0&&r.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:l!==!0})},this.deleteEveryConnection=function(A){for(var I=this.connections.length,l=0;l<I;l++)r.deleteConnection(this.connections[0],A)},this.detachFrom=function(A,I,l){for(var T=[],x=0;x<this.connections.length;x++)(this.connections[x].endpoints[1]===A||this.connections[x].endpoints[0]===A)&&T.push(this.connections[x]);for(var R=0,G=T.length;R<G;R++)r.deleteConnection(T[0]);return this},this.getElement=function(){return this.element},this.setElement=function(A){var I=this._jsPlumb.instance.getId(A),l=this.elementId;return d.removeWithFunction(u.endpointsByElement[this.elementId],function(T){return T.id===this.id}.bind(this)),this.element=e.getElement(A),this.elementId=r.getId(this.element),r.router.rehomeEndpoint(this,l,this.element),r.dragManager.endpointAdded(this.element),d.addToList(u.endpointsByElement,I,this),this},this.makeInPlaceCopy=function(){var A=this.anchor.getCurrentLocation({element:this}),I=this.anchor.getOrientation(this),l=this.anchor.getCssClass(),T={bind:function(){},compute:function(){return[A[0],A[1]]},getCurrentLocation:function(){return[A[0],A[1]]},getOrientation:function(){return I},getCssClass:function(){return l}};return E({dropOptions:u.dropOptions,anchor:T,source:this.element,paintStyle:this.getPaintStyle(),endpoint:u.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(A){A=A||{};var I=A.timestamp,l=A.recalc!==!1;if(!I||this.timestamp!==I){var T=r.updateOffset({elId:this.elementId,timestamp:I}),x=A.offset?A.offset.o:T.o;if(x!=null){var R=A.anchorPoint,G=A.connectorPaintStyle;if(R==null){var C=A.dimensions||T.s,W={xy:[x.left,x.top],wh:C,element:this,timestamp:I};if(l&&this.anchor.isDynamic&&this.connections.length>0){var V=v(this,A.elementWithPrecedence),Y=V.endpoints[0]===this?1:0,L=Y===0?V.sourceId:V.targetId,q=r.getCachedData(L),tt=q.o,K=q.s;W.index=Y===0?1:0,W.connection=V,W.txy=[tt.left,tt.top],W.twh=K,W.tElement=V.endpoints[Y],W.tRotation=r.getRotation(L)}else this.connections.length>0&&(W.connection=this.connections[0]);W.rotation=r.getRotation(this.elementId),R=this.anchor.compute(W)}this.endpoint.compute(R,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,G||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=I;for(var rt in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(rt)){var f=this._jsPlumb.overlays[rt];f.isVisible()&&(this._jsPlumb.overlayPlacements[rt]=f.draw(this.endpoint,this._jsPlumb.paintStyleInUse),f.paint(this._jsPlumb.overlayPlacements[rt]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var c=!1;this.initDraggable=function(){if(!c&&e.isDragSupported(this.element)){var A={id:null,element:null},I=null,l=!1,T=null,x=w(this,A,r),R=u.dragOptions||{},G={},C=e.dragEvents.start,W=e.dragEvents.stop,V=e.dragEvents.drag,Y=e.dragEvents.beforeStart,L,q=function(rt){L=rt.e.payload||{}},tt=function(rt){I=this.connectorSelector();var f=!0;this.isEnabled()||(f=!1),I==null&&!this.isSource&&!this.isTemporarySource&&(f=!1),this.isSource&&this.isFull()&&!(I!=null&&this.dragAllowedWhenFull)&&(f=!1),I!=null&&!I.isDetachable(this)&&(this.isFull()?f=!1:I=null);var _=r.checkCondition(I==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:I});if(_===!1?f=!1:typeof _=="object"?e.extend(_,L||{}):_=L||{},f===!1)return r.stopDrag&&r.stopDrag(this.canvas),x.stopDrag(),!1;for(var h=0;h<this.connections.length;h++)this.connections[h].setHover(!1);this.addClass("endpointDrag"),r.setConnectionBeingDragged(!0),I&&!this.isFull()&&this.isSource&&(I=null),r.updateOffset({elId:this.elementId});var N=this._jsPlumb.instance.getOffset(this.canvas),z=this.canvas,U=this._jsPlumb.instance.getSize(this.canvas);g(A,r,N,U),r.setAttributes(this.canvas,{dragId:A.id,elId:this.elementId});var nt=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var ot=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);ot.endpoints[1]&&(nt=ot.endpoints[1])}var Z=this._jsPlumb.instance.makeAnchor("Center");Z.isFloating=!0,this._jsPlumb.floatingEndpoint=S(this.getPaintStyle(),Z,nt,this.canvas,A.element,r,E,this.scope);var ut=this._jsPlumb.floatingEndpoint.anchor;if(I==null)this.setHover(!1,!1),I=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:A.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:u.connectorStyle,hoverPaintStyle:u.connectorHoverStyle,connector:u.connector,overlays:u.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:u.scope,data:_}),I.pending=!0,I.addClass(r.draggingClass),this._jsPlumb.floatingEndpoint.addClass(r.draggingClass),this._jsPlumb.floatingEndpoint.anchor=ut,r.fire("connectionDrag",I),r.router.newConnection(I);else{l=!0,I.setHover(!1);var dt=I.endpoints[0].id===this.id?0:1;this.detachFromConnection(I,null,!0);var ft=r.getDragScope(z);r.setAttribute(this.canvas,"originalScope",ft),r.fire("connectionDrag",I),dt===0?(T=[I.source,I.sourceId,z,ft],r.router.sourceOrTargetChanged(I.endpoints[dt].elementId,A.id,I,A.element,0)):(T=[I.target,I.targetId,z,ft],r.router.sourceOrTargetChanged(I.endpoints[dt].elementId,A.id,I,A.element,1)),I.suspendedEndpoint=I.endpoints[dt],I.suspendedElement=I.endpoints[dt].getElement(),I.suspendedElementId=I.endpoints[dt].elementId,I.suspendedElementType=dt===0?"source":"target",I.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=I.suspendedEndpoint,I.endpoints[dt]=this._jsPlumb.floatingEndpoint,I.addClass(r.draggingClass),this._jsPlumb.floatingEndpoint.addClass(r.draggingClass)}r.registerFloatingConnection(A,I,this._jsPlumb.floatingEndpoint),r.currentlyDragging=!0}.bind(this),K=function(){if(r.setConnectionBeingDragged(!1),I&&I.endpoints!=null){var rt=r.getDropEvent(arguments),f=r.getFloatingAnchorIndex(I);if(I.endpoints[f===0?1:0].anchor.locked=!1,I.removeClass(r.draggingClass),this._jsPlumb&&(I.deleteConnectionNow||I.endpoints[f]===this._jsPlumb.floatingEndpoint)&&l&&I.suspendedEndpoint){f===0?(I.floatingElement=I.source,I.floatingId=I.sourceId,I.floatingEndpoint=I.endpoints[0],I.floatingIndex=0,I.source=T[0],I.sourceId=T[1]):(I.floatingElement=I.target,I.floatingId=I.targetId,I.floatingEndpoint=I.endpoints[1],I.floatingIndex=1,I.target=T[0],I.targetId=T[1]);var _=this._jsPlumb.floatingEndpoint;r.setDragScope(T[2],T[3]),I.endpoints[f]=I.suspendedEndpoint,I.isReattach()||I._forceReattach||I._forceDetach||!r.deleteConnection(I,{originalEvent:rt})?(I.setHover(!1),I._forceDetach=null,I._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(I),I.suspendedEndpoint.addConnection(I),f===1?r.router.sourceOrTargetChanged(I.floatingId,I.targetId,I,I.target,f):r.router.sourceOrTargetChanged(I.floatingId,I.sourceId,I,I.source,f),r.repaint(T[1])):r.deleteObject({endpoint:_})}this.deleteAfterDragStop?r.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),r.fire("connectionDragStop",I,rt),I.pending&&r.fire("connectionAborted",I,rt),r.currentlyDragging=!1,I.suspendedElement=null,I.suspendedEndpoint=null,I=null}A&&A.element&&r.remove(A.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);R=e.extend(G,R),R.scope=this.scope||R.scope,R[Y]=d.wrap(R[Y],q,!1),R[C]=d.wrap(R[C],tt,!1),R[V]=d.wrap(R[V],x.drag),R[W]=d.wrap(R[W],K),R.multipleDrop=!1,R.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),r.initDraggable(this.canvas,R,"internal"),this.canvas._jsPlumbRelatedElement=this.element,c=!0}};var F=u.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(F,!0);var k=u.anchor?u.anchor:u.anchors?u.anchors:r.Defaults.Anchor||"Top";this.setAnchor(k,!0);var B=["default",u.type||""].join(" ");this.addType(B,u.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var M=function(A,I,l,T){if(e.isDropSupported(this.element)){var x=u.dropOptions||r.Defaults.DropOptions||e.Defaults.DropOptions;x=e.extend({},x),x.scope=x.scope||this.scope;var R=e.dragEvents.drop,G=e.dragEvents.over,C=e.dragEvents.out,W=this,V=r.EndpointDropHandler({getEndpoint:function(){return W},jsPlumb:r,enabled:function(){return l!=null?l.isEnabled():!0},isFull:function(){return l.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(Y){W.addClass(Y)},removeClass:function(Y){W.removeClass(Y)},isDropAllowed:function(){return W.isDropAllowed.apply(W,arguments)},reference:T,isRedrop:function(Y,L){return Y.suspendedEndpoint&&L.reference&&Y.suspendedEndpoint.id===L.reference.id}});x[R]=d.wrap(x[R],V,!0),x[G]=d.wrap(x[G],function(){var Y=e.getDragObject(arguments),L=r.getAttribute(e.getElement(Y),"dragId"),q=r.getFloatingConnectionFor(L);if(q!=null){var tt=r.getFloatingAnchorIndex(q),K=this.isTarget&&tt!==0||q.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===q.suspendedEndpoint.id;if(K){var rt=r.checkCondition("checkDropAllowed",{sourceEndpoint:q.endpoints[tt],targetEndpoint:this,connection:q});this[(rt?"add":"remove")+"Class"](r.endpointDropAllowedClass),this[(rt?"remove":"add")+"Class"](r.endpointDropForbiddenClass),q.endpoints[tt].anchor.over(this.anchor,this)}}}.bind(this)),x[C]=d.wrap(x[C],function(){var Y=e.getDragObject(arguments),L=Y==null?null:r.getAttribute(e.getElement(Y),"dragId"),q=L?r.getFloatingConnectionFor(L):null;if(q!=null){var tt=r.getFloatingAnchorIndex(q),K=this.isTarget&&tt!==0||q.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===q.suspendedEndpoint.id;K&&(this.removeClass(r.endpointDropAllowedClass),this.removeClass(r.endpointDropForbiddenClass),q.endpoints[tt].anchor.out())}}.bind(this)),r.initDroppable(A,x,"internal",I)}}.bind(this);return this.anchor.isFloating||M(this.canvas,!(u._transient||this.anchor.isFloating),this,u.reference),this},d.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(u,r,m){if(this._jsPlumb.visible=u,this.canvas&&(this.canvas.style.display=u?"block":"none"),this[u?"showOverlays":"hideOverlays"](),!r){for(var E=0;E<this.connections.length;E++)if(this.connections[E].setVisible(u),!m){var O=this===this.connections[E].endpoints[0]?1:0;this.connections[E].endpoints[O].connections.length===1&&this.connections[E].endpoints[O].setVisible(u,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(u,r){this.setPaintStyle(u.endpointStyle||u.paintStyle,r),this.setHoverPaintStyle(u.endpointHoverStyle||u.hoverPaintStyle,r),u.maxConnections!=null&&(this._jsPlumb.maxConnections=u.maxConnections),u.scope&&(this.scope=u.scope),e.extend(this,u,o),u.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,u.cssClass),e.OverlayCapableJsPlumbUIComponent.applyType(this,u)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(u){this._jsPlumb.enabled=u},cleanup:function(){var u=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");e.removeClass(this.element,u),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(u){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(u)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(u){var r=!1;if(u){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===u||this.connections[m].endpoints[0]===u){r=!0;break}}return r},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(u){this._jsPlumb.connectionCost=u},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(u){this._jsPlumb.connectionsDirected=u},setElementId:function(u){this.elementId=u,this.anchor.elementId=u},setReferenceElement:function(u){this.element=e.getElement(u)},setDragAllowedWhenFull:function(u){this.dragAllowedWhenFull=u},equals:function(u){return this.anchor.equals(u.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(u){return this.anchor.compute(u)}}),i.jsPlumbInstance.prototype.EndpointDropHandler=function(u){return function(r){var m=u.jsPlumb;u.removeClass(m.endpointDropAllowedClass),u.removeClass(m.endpointDropForbiddenClass);var E=m.getDropEvent(arguments),O=m.getDragObject(arguments),D=m.getAttribute(O,"dragId");m.getAttribute(O,"elId");var y=m.getAttribute(O,"originalScope"),c=m.getFloatingConnectionFor(D);if(c!=null){var F=c.suspendedEndpoint!=null;if(!(F&&c.suspendedEndpoint._jsPlumb==null)){var k=u.getEndpoint(c);if(k!=null){if(u.isRedrop(c,u)){c._forceReattach=!0,c.setHover(!1),u.maybeCleanup&&u.maybeCleanup(k);return}var B=m.getFloatingAnchorIndex(c);if(B===0&&!u.isSource||B===1&&!u.isTarget){u.maybeCleanup&&u.maybeCleanup(k);return}u.onDrop&&u.onDrop(c),y&&m.setDragScope(O,y);var M=u.isFull(r);if(M&&k.fire("maxConnections",{endpoint:this,connection:c,maxConnections:k._jsPlumb.maxConnections},E),!M&&u.enabled()){var A=!0;B===0?(c.floatingElement=c.source,c.floatingId=c.sourceId,c.floatingEndpoint=c.endpoints[0],c.floatingIndex=0,c.source=u.element,c.sourceId=m.getId(u.element)):(c.floatingElement=c.target,c.floatingId=c.targetId,c.floatingEndpoint=c.endpoints[1],c.floatingIndex=1,c.target=u.element,c.targetId=m.getId(u.element)),F&&c.suspendedEndpoint.id!==k.id&&(!c.isDetachAllowed(c)||!c.endpoints[B].isDetachAllowed(c)||!c.suspendedEndpoint.isDetachAllowed(c)||!m.checkCondition("beforeDetach",c))&&(A=!1);var I=function(T){c.endpoints[B].detachFromConnection(c),c.suspendedEndpoint&&c.suspendedEndpoint.detachFromConnection(c),c.endpoints[B]=k,k.addConnection(c);var x=k.getParameters();for(var R in x)c.setParameter(R,x[R]);if(!F)x.draggable&&m.initDraggable(this.element,u.dragOptions,"internal",m);else{var G=c.suspendedEndpoint.elementId;m.fireMoveEvent({index:B,originalSourceId:B===0?G:c.sourceId,newSourceId:B===0?k.elementId:c.sourceId,originalTargetId:B===1?G:c.targetId,newTargetId:B===1?k.elementId:c.targetId,originalSourceEndpoint:B===0?c.suspendedEndpoint:c.endpoints[0],newSourceEndpoint:B===0?k:c.endpoints[0],originalTargetEndpoint:B===1?c.suspendedEndpoint:c.endpoints[1],newTargetEndpoint:B===1?k:c.endpoints[1],connection:c},E)}if(B===1?m.router.sourceOrTargetChanged(c.floatingId,c.targetId,c,c.target,1):m.router.sourceOrTargetChanged(c.floatingId,c.sourceId,c,c.source,0),c.endpoints[0].finalEndpoint){var C=c.endpoints[0];C.detachFromConnection(c),c.endpoints[0]=c.endpoints[0].finalEndpoint,c.endpoints[0].addConnection(c)}d.isObject(T)&&c.mergeData(T),m.finaliseConnection(c,null,E,!1),c.setHover(!1),m.revalidate(c.endpoints[0].element)}.bind(this),l=function(){c.suspendedEndpoint&&(c.endpoints[B]=c.suspendedEndpoint,c.setHover(!1),c._forceDetach=!0,B===0?(c.source=c.suspendedEndpoint.element,c.sourceId=c.suspendedEndpoint.elementId):(c.target=c.suspendedEndpoint.element,c.targetId=c.suspendedEndpoint.elementId),c.suspendedEndpoint.addConnection(c),B===1?m.router.sourceOrTargetChanged(c.floatingId,c.targetId,c,c.target,1):m.router.sourceOrTargetChanged(c.floatingId,c.sourceId,c,c.source,0),m.repaint(c.sourceId),c._forceDetach=!1)};if(A=A&&u.isDropAllowed(c.sourceId,c.targetId,c.scope,c,k),A)return I(A),!0;l()}u.maybeCleanup&&u.maybeCleanup(k),m.currentlyDragging=!1}}}}}}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w=function(o,v,u,r,m){if(e.Connectors[v]=e.Connectors[v]||{},e.Connectors[v][u]==null){if(e.Connectors[u]==null){if(o.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+u+"'")}e.Connectors[v][u]=function(){e.Connectors[u].apply(this,arguments),e.ConnectorRenderers[v].apply(this,arguments)},d.extend(e.Connectors[v][u],[e.Connectors[u],e.ConnectorRenderers[v]])}return new e.Connectors[v][u](r,m)},g=function(o,v,u){return o?u.makeAnchor(o,v,u):null},S=function(o,v,u,r){v!=null&&(v._jsPlumbConnections=v._jsPlumbConnections||{},r?delete v._jsPlumbConnections[o.id]:v._jsPlumbConnections[o.id]=!0,d.isEmpty(v._jsPlumbConnections)?u.removeClass(v,u.connectedClass):u.addClass(v,u.connectedClass))};e.Connection=function(o){var v=o.newEndpoint;this.id=o.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=o.previousConnection,this.source=e.getElement(o.source),this.target=e.getElement(o.target),e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),o.sourceEndpoint?(this.source=o.sourceEndpoint.getElement(),this.sourceId=o.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),o.targetEndpoint?(this.target=o.targetEndpoint.getElement(),this.targetId=o.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=o.scope,this.endpoints=[],this.endpointStyles=[];var u=this._jsPlumb.instance;u.manage(this.sourceId,this.source),u.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:o.cssClass,container:o.container,"pointer-events":o["pointer-events"],editorParams:o.editorParams,overlays:o.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(R,G,C,W,V){return C=C||this._jsPlumb.instance.getId(G),this.prepareEndpoint(u,v,this,W,R?0:1,o,G,C,V)},o.type&&(o.endpoints=o.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(o.type).endpoints);var r=this.makeEndpoint(!0,this.source,this.sourceId,o.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,o.targetEndpoint);r&&d.addToList(o.endpointsByElement,this.sourceId,r),m&&d.addToList(o.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),o.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(o.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(o.deleteEndpointsOnEmpty));var E=u.Defaults.ConnectionsDetachable;o.detachable===!1&&(E=!1),this.endpoints[0].connectionsDetachable===!1&&(E=!1),this.endpoints[1].connectionsDetachable===!1&&(E=!1);var O=o.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||u.Defaults.ReattachConnections;this.appendToDefaultType({detachable:E,reattach:O,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||o.paintStyle||u.Defaults.PaintStyle||e.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||o.hoverPaintStyle||u.Defaults.HoverPaintStyle||e.Defaults.HoverPaintStyle});var D=u.getSuspendedAt();if(!u.isSuspendDrawing()){var y=u.getCachedData(this.sourceId),c=y.o,F=y.s,k=u.getCachedData(this.targetId),B=k.o,M=k.s,A=D||jsPlumbUtil.uuid(),I=this.endpoints[0].anchor.compute({xy:[c.left,c.top],wh:F,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[B.left,B.top],twh:M,tElement:this.endpoints[1],timestamp:A,rotation:u.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:I,timestamp:A}),I=this.endpoints[1].anchor.compute({xy:[B.left,B.top],wh:M,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[c.left,c.top],twh:F,tElement:this.endpoints[0],timestamp:A,rotation:u.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:I,timestamp:A})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(R){return this._jsPlumb.detachable===!1?!1:R!=null?R.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(R){this._jsPlumb.detachable=R===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(R){this._jsPlumb.reattach=R===!0},this._jsPlumb.cost=o.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=o.directed,o.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var l=e.extend({},this.endpoints[1].getParameters());e.extend(l,this.endpoints[0].getParameters()),e.extend(l,this.getParameters()),this.setParameters(l),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||o.connector||u.Defaults.Connector||e.Defaults.Connector,!0);var T=o.data==null||!d.isObject(o.data)?{}:o.data;this.getData=function(){return T},this.setData=function(R){T=R||{}},this.mergeData=function(R){T=e.extend(T,R)};var x=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,o.type].join(" ");/[^\s]/.test(x)&&this.addType(x,o.data,!0),this.updateConnectedClass()},d.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(o,v,u){var r=null;o.connector!=null&&(r=this.getCachedTypeItem("connector",u.connector),r==null&&(r=this.prepareConnector(o.connector,u.connector),this.cacheTypeItem("connector",r,u.connector)),this.setPreparedConnector(r)),o.detachable!=null&&this.setDetachable(o.detachable),o.reattach!=null&&this.setReattach(o.reattach),o.scope&&(this.scope=o.scope),o.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,o.cssClass);var m=null;o.anchor?(m=this.getCachedTypeItem("anchors",u.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(o.anchor),this._jsPlumb.instance.makeAnchor(o.anchor)],this.cacheTypeItem("anchors",m,u.anchor))):o.anchors&&(m=this.getCachedTypeItem("anchors",u.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(o.anchors[0]),this._jsPlumb.instance.makeAnchor(o.anchors[1])],this.cacheTypeItem("anchors",m,u.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),e.OverlayCapableJsPlumbUIComponent.applyType(this,o)},addClass:function(o,v){v&&(this.endpoints[0].addClass(o),this.endpoints[1].addClass(o),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(o)),this.connector&&this.connector.addClass(o)},removeClass:function(o,v){v&&(this.endpoints[0].removeClass(o),this.endpoints[1].removeClass(o),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(o)),this.connector&&this.connector.removeClass(o)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(o){this._jsPlumb.visible=o,this.connector&&this.connector.setVisible(o),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(o){this._jsPlumb&&(S(this,this.source,this._jsPlumb.instance,o),S(this,this.target,this._jsPlumb.instance,o))},setHover:function(o){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(o),i.jsPlumb[o?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),i.jsPlumb[o?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(o){this._jsPlumb.cost=o},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(o,v){var u={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},r=this._jsPlumb.instance.getRenderMode(),m;return d.isString(o)?m=w(this._jsPlumb.instance,r,o,u,this):d.isArray(o)&&(o.length===1?m=w(this._jsPlumb.instance,r,o[0],u,this):m=w(this._jsPlumb.instance,r,o[0],d.merge(o[1],u),this)),v!=null&&(m.typeId=v),m},setPreparedConnector:function(o,v,u,r){if(this.connector!==o){var m,E="";if(this.connector!=null&&(m=this.connector,E=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=o,r&&this.cacheTypeItem("connector",o,r),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(E),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var O=this.getOverlays(),D=0;D<O.length;D++)O[D].transfer&&O[D].transfer(this.connector);u||this.setListenerComponent(this.connector),v||this.repaint()}},setConnector:function(o,v,u,r){var m=this.prepareConnector(o,r);this.setPreparedConnector(m,v,u,r)},paint:function(o){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){o=o||{};var v=o.timestamp,u=!1,r=u?this.sourceId:this.targetId,m=u?this.targetId:this.sourceId,E=u?0:1,O=u?1:0;if(v==null||v!==this._jsPlumb.lastPaintedAt){var D=this._jsPlumb.instance.updateOffset({elId:m}).o,y=this._jsPlumb.instance.updateOffset({elId:r}).o,c=this.endpoints[O],F=this.endpoints[E],k=c.anchor.getCurrentLocation({xy:[D.left,D.top],wh:[D.width,D.height],element:c,timestamp:v,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),B=F.anchor.getCurrentLocation({xy:[y.left,y.top],wh:[y.width,y.height],element:F,timestamp:v,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:k,targetPos:B,sourceOrientation:c.anchor.getOrientation(c),targetOrientation:F.anchor.getOrientation(F),sourceEndpoint:this.endpoints[O],targetEndpoint:this.endpoints[E],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:D,targetInfo:y});var M={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var A in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(A)){var I=this._jsPlumb.overlays[A];I.isVisible()&&(this._jsPlumb.overlayPlacements[A]=I.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(I)),M.minX=Math.min(M.minX,this._jsPlumb.overlayPlacements[A].minX),M.maxX=Math.max(M.maxX,this._jsPlumb.overlayPlacements[A].maxX),M.minY=Math.min(M.minY,this._jsPlumb.overlayPlacements[A].minY),M.maxY=Math.max(M.maxY,this._jsPlumb.overlayPlacements[A].maxY))}var l=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,T=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),x={xmin:Math.min(this.connector.bounds.minX-(l+T),M.minX),ymin:Math.min(this.connector.bounds.minY-(l+T),M.minY),xmax:Math.max(this.connector.bounds.maxX+(l+T),M.maxX),ymax:Math.max(this.connector.bounds.maxY+(l+T),M.maxY)};this.connector.paintExtents=x,this.connector.paint(this._jsPlumb.paintStyleInUse,null,x);for(var R in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(R)){var G=this._jsPlumb.overlays[R];G.isVisible()&&G.paint(this._jsPlumb.overlayPlacements[R],x)}}this._jsPlumb.lastPaintedAt=v}},repaint:function(o){var v=jsPlumb.extend(o||{},{});v.elId=this.sourceId,this.paint(v)},prepareEndpoint:function(o,v,u,r,m,E,O,D,y){var c;if(r)u.endpoints[m]=r,r.addConnection(u);else{E.endpoints||(E.endpoints=[null,null]);var F=y||E.endpoints[m]||E.endpoint||o.Defaults.Endpoints[m]||e.Defaults.Endpoints[m]||o.Defaults.Endpoint||e.Defaults.Endpoint;E.endpointStyles||(E.endpointStyles=[null,null]),E.endpointHoverStyles||(E.endpointHoverStyles=[null,null]);var k=E.endpointStyles[m]||E.endpointStyle||o.Defaults.EndpointStyles[m]||e.Defaults.EndpointStyles[m]||o.Defaults.EndpointStyle||e.Defaults.EndpointStyle;k.fill==null&&E.paintStyle!=null&&(k.fill=E.paintStyle.stroke),k.outlineStroke==null&&E.paintStyle!=null&&(k.outlineStroke=E.paintStyle.outlineStroke),k.outlineWidth==null&&E.paintStyle!=null&&(k.outlineWidth=E.paintStyle.outlineWidth);var B=E.endpointHoverStyles[m]||E.endpointHoverStyle||o.Defaults.EndpointHoverStyles[m]||e.Defaults.EndpointHoverStyles[m]||o.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle;E.hoverPaintStyle!=null&&(B==null&&(B={}),B.fill==null&&(B.fill=E.hoverPaintStyle.stroke));var M=E.anchors?E.anchors[m]:E.anchor?E.anchor:g(o.Defaults.Anchors[m],D,o)||g(e.Defaults.Anchors[m],D,o)||g(o.Defaults.Anchor,D,o)||g(e.Defaults.Anchor,D,o),A=E.uuids?E.uuids[m]:null;c=v({paintStyle:k,hoverPaintStyle:B,endpoint:F,connections:[u],uuid:A,anchor:M,source:O,scope:E.scope,reattach:E.reattach||o.Defaults.ReattachConnections,detachable:E.detachable||o.Defaults.ConnectionsDetachable}),r==null&&c.setDeleteOnEmpty(!0),u.endpoints[m]=c,E.drawEndpoints===!1&&c.setVisible(!1,!0,!0)}return c},replaceEndpoint:function(o,v){var u=this.endpoints[o],r=u.elementId,m=this._jsPlumb.instance.getEndpoints(r),E=m.indexOf(u),O=this.makeEndpoint(o===0,u.element,r,null,v);this.endpoints[o]=O,m.splice(E,1,O),this._jsPlumb.instance.deleteObject({endpoint:u,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:u,current:O}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumbUtil,d=i.jsPlumb;d.AnchorManager=function(o){var v={},u={},r={},m={},E=this,O={},D=o.jsPlumbInstance,y={},c=function(x,R,G,C,W,V,Y,L){for(var q=[],tt=R[W?0:1]/(C.length+1),K=0;K<C.length;K++){var rt=(K+1)*tt,f=V*R[W?1:0];Y&&(rt=R[W?0:1]-rt);var _=W?rt:f,h=G.left+_,N=_/R[0],z=W?f:rt,U=G.top+z,nt=z/R[1];if(L!==0){var ot=jsPlumbUtil.rotatePoint([h,U],[G.centerx,G.centery],L);h=ot[0],U=ot[1]}q.push([h,U,N,nt,C[K][1],C[K][2]])}return q},F=function(x,R){return R[0][0]-x[0][0]},k=function(x,R){var G=x[0][0]<0?-Math.PI-x[0][0]:Math.PI-x[0][0],C=R[0][0]<0?-Math.PI-R[0][0]:Math.PI-R[0][0];return G-C},B={top:k,right:F,bottom:F,left:k},M=function(x,R){return x.sort(R)},A=function(x,R){var G=D.getCachedData(x),C=G.s,W=G.o,V=function(Y,L,q,tt,K,rt,f){if(tt.length>0)for(var _=M(tt,B[Y]),h=Y==="right"||Y==="top",N=D.getRotation(x),z=c(Y,L,q,_,K,rt,h,N),U=function(dt,ft){u[dt.id]=[ft[0],ft[1],ft[2],ft[3]],r[dt.id]=f},nt=0;nt<z.length;nt++){var ot=z[nt][4],Z=ot.endpoints[0].elementId===x,ut=ot.endpoints[1].elementId===x;Z&&U(ot.endpoints[0],z[nt]),ut&&U(ot.endpoints[1],z[nt])}};V("bottom",C,W,R.bottom,!0,1,[0,1]),V("top",C,W,R.top,!0,0,[0,-1]),V("left",C,W,R.left,!1,0,[-1,0]),V("right",C,W,R.right,!1,1,[1,0])};this.reset=function(){v={},m={},O={}},this.addFloatingConnection=function(x,R){y[x]=R},this.newConnection=function(x){var R=x.sourceId,G=x.targetId,C=x.endpoints,W=!0,V=function(Y,L,q,tt,K){R===G&&q.isContinuous&&(x._jsPlumb.instance.removeElement(C[1].canvas),W=!1),e.addToList(m,tt,[K,L,q.constructor===d.DynamicAnchor])};V(0,C[0],C[0].anchor,G,x),W&&V(1,C[1],C[1].anchor,R,x)};var I=function(x){(function(R,G){if(R){var C=function(W){return W[4]===G};e.removeWithFunction(R.top,C),e.removeWithFunction(R.left,C),e.removeWithFunction(R.bottom,C),e.removeWithFunction(R.right,C)}})(O[x.elementId],x.id)};this.connectionDetached=function(x,R){var G=x.connection||x,C=x.sourceId,W=x.targetId,V=G.endpoints,Y=function(L,q,tt,K,rt){e.removeWithFunction(m[K],function(f){return f[0].id===rt.id})};Y(1,V[1],V[1].anchor,C,G),Y(0,V[0],V[0].anchor,W,G),G.floatingId&&(Y(G.floatingIndex,G.floatingEndpoint,G.floatingEndpoint.anchor,G.floatingId,G),I(G.floatingEndpoint)),I(G.endpoints[0]),I(G.endpoints[1]),R||(E.redraw(G.sourceId),G.targetId!==G.sourceId&&E.redraw(G.targetId))},this.addEndpoint=function(x,R){e.addToList(v,R,x)},this.changeId=function(x,R){m[R]=m[x],v[R]=v[x],delete m[x],delete v[x]},this.getConnectionsFor=function(x){return m[x]||[]},this.getEndpointsFor=function(x){return v[x]||[]},this.deleteEndpoint=function(x){e.removeWithFunction(v[x.elementId],function(R){return R.id===x.id}),I(x)},this.elementRemoved=function(x){delete y[x],delete v[x],v[x]=[]};var l=function(x,R,G,C,W,V,Y,L,q,tt,K,rt){var f=-1,_=C.endpoints[Y],h=_.id,N=[1,0][Y],z=[[R,G],C,W,V,h],U=x[q],nt=_._continuousAnchorEdge?x[_._continuousAnchorEdge]:null,ot,Z;if(nt){var ut=e.findWithFunction(nt,function(ft){return ft[4]===h});if(ut!==-1)for(nt.splice(ut,1),ot=0;ot<nt.length;ot++)Z=nt[ot][1],e.addWithFunction(K,Z,function(ft){return ft.id===Z.id}),e.addWithFunction(rt,nt[ot][1].endpoints[Y],function(ft){return ft.id===Z.endpoints[Y].id}),e.addWithFunction(rt,nt[ot][1].endpoints[N],function(ft){return ft.id===Z.endpoints[N].id})}for(ot=0;ot<U.length;ot++)Z=U[ot][1],o.idx===1&&U[ot][3]===V&&f===-1&&(f=ot),e.addWithFunction(K,Z,function(ft){return ft.id===Z.id}),e.addWithFunction(rt,U[ot][1].endpoints[Y],function(ft){return ft.id===Z.endpoints[Y].id}),e.addWithFunction(rt,U[ot][1].endpoints[N],function(ft){return ft.id===Z.endpoints[N].id});{var dt=L?f!==-1?f:0:U.length;U.splice(dt,0,z)}_._continuousAnchorEdge=q};this.sourceOrTargetChanged=function(x,R,G,C,W){if(W===0){if(x!==R){G.sourceId=R,G.source=C,e.removeWithFunction(m[x],function(tt){return tt[0].id===G.id});var V=e.findWithFunction(m[G.targetId],function(tt){return tt[0].id===G.id});V>-1&&(m[G.targetId][V][0]=G,m[G.targetId][V][1]=G.endpoints[0],m[G.targetId][V][2]=G.endpoints[0].anchor.constructor===d.DynamicAnchor),e.addToList(m,R,[G,G.endpoints[1],G.endpoints[1].anchor.constructor===d.DynamicAnchor]),G.endpoints[1].anchor.isContinuous&&(G.source===G.target?G._jsPlumb.instance.removeElement(G.endpoints[1].canvas):G.endpoints[1].canvas.parentNode==null&&G._jsPlumb.instance.appendElement(G.endpoints[1].canvas)),G.updateConnectedClass()}}else if(W===1){var Y=G.endpoints[0].elementId;G.target=C,G.targetId=R;var L=e.findWithFunction(m[Y],function(tt){return tt[0].id===G.id}),q=e.findWithFunction(m[x],function(tt){return tt[0].id===G.id});L!==-1&&(m[Y][L][0]=G,m[Y][L][1]=G.endpoints[1],m[Y][L][2]=G.endpoints[1].anchor.constructor===d.DynamicAnchor),q>-1&&(m[x].splice(q,1),e.addToList(m,R,[G,G.endpoints[0],G.endpoints[0].anchor.constructor===d.DynamicAnchor])),G.updateConnectedClass()}},this.rehomeEndpoint=function(x,R,G){var C=v[R]||[],W=D.getId(G);if(W!==R){var V=C.indexOf(x);if(V>-1){var Y=C.splice(V,1)[0];E.add(Y,W)}}for(var L=0;L<x.connections.length;L++)x.connections[L].sourceId===R?E.sourceOrTargetChanged(R,x.elementId,x.connections[L],x.element,0):x.connections[L].targetId===R&&E.sourceOrTargetChanged(R,x.elementId,x.connections[L],x.element,1)},this.redraw=function(x,R,G,C,W,V){var Y=[],L=[],q=[];if(!D.isSuspendDrawing()){var tt=v[x]||[],K=m[x]||[];G=G||jsPlumbUtil.uuid(),C=C||{left:0,top:0},R&&(R={left:R.left+C.left,top:R.top+C.top});for(var rt=D.updateOffset({elId:x,offset:R,recalc:!1,timestamp:G}),f={},_=0;_<K.length;_++){var h=K[_][0],N=h.sourceId,z=h.targetId,U=h.endpoints[0].anchor.isContinuous,nt=h.endpoints[1].anchor.isContinuous;if(U||nt){var ot=N+"_"+z,Z=f[ot],ut=h.sourceId===x?1:0,dt=D.getRotation(z),ft=D.getRotation(N);U&&!O[N]&&(O[N]={top:[],right:[],bottom:[],left:[]}),nt&&!O[z]&&(O[z]={top:[],right:[],bottom:[],left:[]}),x!==z&&D.updateOffset({elId:z,timestamp:G}),x!==N&&D.updateOffset({elId:N,timestamp:G});var ct=D.getCachedData(z),xt=D.getCachedData(N);z===N&&(U||nt)?(l(O[N],-Math.PI/2,0,h,!1,z,0,!1,"top",N,Y,L),l(O[z],-Math.PI/2,0,h,!1,N,1,!1,"top",z,Y,L)):(Z||(Z=this.calculateOrientation(N,z,xt.o,ct.o,h.endpoints[0].anchor,h.endpoints[1].anchor,h,ft,dt),f[ot]=Z),U&&l(O[N],Z.theta,0,h,!1,z,0,!1,Z.a[0],N,Y,L),nt&&l(O[z],Z.theta2,-1,h,!0,N,1,!0,Z.a[1],z,Y,L)),U&&e.addWithFunction(q,N,function(Mt){return Mt===N}),nt&&e.addWithFunction(q,z,function(Mt){return Mt===z}),e.addWithFunction(Y,h,function(Mt){return Mt.id===h.id}),(U&&ut===0||nt&&ut===1)&&e.addWithFunction(L,h.endpoints[ut],function(Mt){return Mt.id===h.endpoints[ut].id})}}for(_=0;_<tt.length;_++)tt[_].connections.length===0&&tt[_].anchor.isContinuous&&(O[x]||(O[x]={top:[],right:[],bottom:[],left:[]}),l(O[x],-Math.PI/2,0,{endpoints:[tt[_],tt[_]],paint:function(){}},!1,x,0,!1,tt[_].anchor.getDefaultFace(),x,Y,L),e.addWithFunction(q,x,function(Mt){return Mt===x}));for(_=0;_<q.length;_++)A(q[_],O[q[_]]);for(_=0;_<tt.length;_++)tt[_].paint({timestamp:G,offset:rt,dimensions:rt.s,recalc:V!==!0});for(_=0;_<L.length;_++){var Pt=D.getCachedData(L[_].elementId);L[_].paint({timestamp:null,offset:Pt,dimensions:Pt.s})}for(_=0;_<K.length;_++){var Ot=K[_][1];if(Ot.anchor.constructor===d.DynamicAnchor){Ot.paint({elementWithPrecedence:x,timestamp:G}),e.addWithFunction(Y,K[_][0],function(Mt){return Mt.id===K[_][0].id});for(var Ct=0;Ct<Ot.connections.length;Ct++)Ot.connections[Ct]!==K[_][0]&&e.addWithFunction(Y,Ot.connections[Ct],function(Mt){return Mt.id===Ot.connections[Ct].id})}else e.addWithFunction(Y,K[_][0],function(Mt){return Mt.id===K[_][0].id})}var Rt=y[x];for(Rt&&Rt.paint({timestamp:G,recalc:!1,elId:x}),_=0;_<Y.length;_++)Y[_].paint({elId:x,timestamp:null,recalc:!1,clearEdits:W})}return{c:Y,e:L}};var T=function(x){e.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var R=x.faces||["top","right","bottom","left"],G=x.clockwise!==!1,C={},W={top:"bottom",right:"left",left:"right",bottom:"top"},V={top:"right",right:"bottom",left:"top",bottom:"left"},Y={top:"left",right:"top",left:"bottom",bottom:"right"},L=G?V:Y,q=G?Y:V,tt=x.cssClass||"",K=null,rt=null,f=["left","right"],_=["top","bottom"],h=null,N=0;N<R.length;N++)C[R[N]]=!0;this.getDefaultFace=function(){return R.length===0?"top":R[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(z){return C[z]?z:C[W[z]]?W[z]:C[L[z]]?L[z]:C[q[z]]?q[z]:z},this.isEdgeSupported=function(z){return h==null?rt==null?C[z]===!0:rt===z:h.indexOf(z)!==-1},this.setCurrentFace=function(z,U){K=z,U&&rt!=null&&(rt=K)},this.getCurrentFace=function(){return K},this.getSupportedFaces=function(){var z=[];for(var U in C)C[U]&&z.push(U);return z},this.lock=function(){rt=K},this.unlock=function(){rt=null},this.isLocked=function(){return rt!=null},this.lockCurrentAxis=function(){K!=null&&(h=K==="left"||K==="right"?f:_)},this.unlockCurrentAxis=function(){h=null},this.compute=function(z){return u[z.element.id]||[0,0]},this.getCurrentLocation=function(z){return u[z.element.id]||[0,0]},this.getOrientation=function(z){return r[z.id]||[0,0]},this.getCssClass=function(){return tt}};D.continuousAnchorFactory={get:function(x){return new T(x)},clear:function(x){delete u[x]}}},d.AnchorManager.prototype.calculateOrientation=function(o,v,u,r,m,E,O,D,y){var c={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},F=["left","top","right","bottom"];if(o===v)return{orientation:c.IDENTITY,a:["top","top"]};var k=Math.atan2(r.centery-u.centery,r.centerx-u.centerx),B=Math.atan2(u.centery-r.centery,u.centerx-r.centerx),M=[],A={};(function(G,C){for(var W=0;W<G.length;W++)if(A[G[W]]={left:[C[W][0].left,C[W][0].centery],right:[C[W][0].right,C[W][0].centery],top:[C[W][0].centerx,C[W][0].top],bottom:[C[W][0].centerx,C[W][0].bottom]},C[W][1]!==0)for(var V in A[G[W]])A[G[W]][V]=jsPlumbUtil.rotatePoint(A[G[W]][V],[C[W][0].centerx,C[W][0].centery],C[W][1])})(["source","target"],[[u,D],[r,y]]);for(var I=0;I<F.length;I++)for(var l=0;l<F.length;l++)M.push({source:F[I],target:F[l],dist:Biltong.lineLength(A.source[F[I]],A.target[F[l]])});M.sort(function(G,C){return G.dist<C.dist?-1:G.dist>C.dist?1:0});for(var T=M[0].source,x=M[0].target,R=0;R<M.length&&(m.isContinuous&&m.locked?T=m.getCurrentFace():!m.isContinuous||m.isEdgeSupported(M[R].source)?T=M[R].source:T=null,E.isContinuous&&E.locked?x=E.getCurrentFace():!E.isContinuous||E.isEdgeSupported(M[R].target)?x=M[R].target:x=null,!(T!=null&&x!=null));R++);return m.isContinuous&&m.setCurrentFace(T),E.isContinuous&&E.setCurrentFace(x),{a:[T,x],theta:k,theta2:B}},d.Anchor=function(o){this.x=o.x||0,this.y=o.y||0,this.elementId=o.elementId,this.cssClass=o.cssClass||"",this.orientation=o.orientation||[0,0],this.lastReturnValue=null,this.offsets=o.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=o.relocatable!==!1,this.snapOnRelocate=o.snapOnRelocate!==!1,this.locked=!1,e.EventGenerator.apply(this),this.compute=function(v){var u=v.xy,r=v.wh,m=v.timestamp;if(m&&m===this.timestamp)return this.lastReturnValue;var E=[u[0]+this.x*r[0]+this.offsets[0],u[1]+this.y*r[1]+this.offsets[1],this.x,this.y],O=v.rotation;if(O!=null&&O!==0){var D=jsPlumbUtil.rotatePoint(E,[u[0]+r[0]/2,u[1]+r[1]/2],O);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*D[2]-this._unrotatedOrientation[1]*D[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*D[2]+this._unrotatedOrientation[0]*D[3]),this.lastReturnValue=[D[0],D[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=E;return this.timestamp=m,this.lastReturnValue},this.getCurrentLocation=function(v){return v=v||{},this.lastReturnValue==null||v.timestamp!=null&&this.timestamp!==v.timestamp?this.compute(v):this.lastReturnValue},this.setPosition=function(v,u,r,m,E){(!this.locked||E)&&(this.x=v,this.y=u,this.orientation=[r,m],this.lastReturnValue=null)}},e.extend(d.Anchor,e.EventGenerator,{equals:function(o){if(!o)return!1;var v=o.getOrientation(),u=this.getOrientation();return this.x===o.x&&this.y===o.y&&this.offsets[0]===o.offsets[0]&&this.offsets[1]===o.offsets[1]&&u[0]===v[0]&&u[1]===v[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),d.FloatingAnchor=function(o){d.Anchor.apply(this,arguments);var v=o.reference,u=o.referenceCanvas,r=d.getSize(u),m=0,E=0,O=null,D=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(y){var c=y.xy,F=[c[0]+r[0]/2,c[1]+r[1]/2];return D=F,F},this.getOrientation=function(y){if(O)return O;var c=v.getOrientation(y);return[Math.abs(c[0])*m*-1,Math.abs(c[1])*E*-1]},this.over=function(y,c){O=y.getOrientation(c)},this.out=function(){O=null},this.getCurrentLocation=function(y){return D??this.compute(y)}},e.extend(d.FloatingAnchor,d.Anchor);var w=function(o,v,u){return o.constructor===d.Anchor?o:v.makeAnchor(o,u,v)};d.DynamicAnchor=function(o){d.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=o.elementId,this.jsPlumbInstance=o.jsPlumbInstance;for(var v=0;v<o.anchors.length;v++)this.anchors[v]=w(o.anchors[v],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var u=this.anchors.length>0?this.anchors[0]:null,r=u,m=function(O,D,y,c,F,k,B){var M=c[0]+O.x*F[0],A=c[1]+O.y*F[1],I=c[0]+F[0]/2,l=c[1]+F[1]/2;if(k!=null&&k!==0){var T=jsPlumbUtil.rotatePoint([M,A],[I,l],k);M=T[0],A=T[1]}return Math.sqrt(Math.pow(D-M,2)+Math.pow(y-A,2))+Math.sqrt(Math.pow(I-M,2)+Math.pow(l-A,2))},E=o.selector||function(O,D,y,c,F,k,B){for(var M=y[0]+c[0]/2,A=y[1]+c[1]/2,I=-1,l=1/0,T=0;T<B.length;T++){var x=m(B[T],M,A,O,D,F);x<l&&(I=T+0,l=x)}return B[I]};this.compute=function(O){var D=O.xy,y=O.wh,c=O.txy,F=O.twh,k=O.rotation,B=O.tRotation;return this.timestamp=O.timestamp,this.locked||c==null||F==null?(this.lastReturnValue=u.compute(O),this.lastReturnValue):(O.timestamp=null,u=E(D,y,c,F,k,B,this.anchors),this.x=u.x,this.y=u.y,u!==r&&this.fire("anchorChanged",u),r=u,this.lastReturnValue=u.compute(O),this.lastReturnValue)},this.getCurrentLocation=function(O){return u!=null?u.getCurrentLocation(O):null},this.getOrientation=function(O){return u!=null?u.getOrientation(O):[0,0]},this.over=function(O,D){u?.over(O,D)},this.out=function(){u?.out()},this.setAnchor=function(O){u=O},this.getCssClass=function(){return u&&u.getCssClass()||""},this.setAnchorCoordinates=function(O){var D=jsPlumbUtil.findWithFunction(this.anchors,function(y){return y.x===O[0]&&y.y===O[1]});return D!==-1?(this.setAnchor(this.anchors[D]),!0):!1}},e.extend(d.DynamicAnchor,d.Anchor);var g=function(o,v,u,r,m,E){d.Anchors[m]=function(O){var D=O.jsPlumbInstance.makeAnchor([o,v,u,r,0,0],O.elementId,O.jsPlumbInstance);return D.type=m,E&&E(D,O),D}};g(.5,0,0,-1,"TopCenter"),g(.5,1,0,1,"BottomCenter"),g(0,.5,-1,0,"LeftMiddle"),g(1,.5,1,0,"RightMiddle"),g(.5,0,0,-1,"Top"),g(.5,1,0,1,"Bottom"),g(0,.5,-1,0,"Left"),g(1,.5,1,0,"Right"),g(.5,.5,0,0,"Center"),g(1,0,0,-1,"TopRight"),g(1,1,0,1,"BottomRight"),g(0,0,0,-1,"TopLeft"),g(0,1,0,1,"BottomLeft"),d.Defaults.DynamicAnchors=function(o){return o.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],o.elementId,o.jsPlumbInstance)},d.Anchors.AutoDefault=function(o){var v=o.jsPlumbInstance.makeDynamicAnchor(d.Defaults.DynamicAnchors(o));return v.type="AutoDefault",v};var S=function(o,v){d.Anchors[o]=function(u){var r=u.jsPlumbInstance.makeAnchor(["Continuous",{faces:v}],u.elementId,u.jsPlumbInstance);return r.type=o,r}};d.Anchors.Continuous=function(o){return o.jsPlumbInstance.continuousAnchorFactory.get(o)},S("ContinuousLeft",["left"]),S("ContinuousTop",["top"]),S("ContinuousBottom",["bottom"]),S("ContinuousRight",["right"]),g(0,0,0,0,"Assign",function(o,v){var u=v.position||"Fixed";o.positionFinder=u.constructor===String?v.jsPlumbInstance.AnchorPositionFinders[u]:u,o.constructorParams=v}),i.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(o,v,u){return[(o.left-v.left)/u[0],(o.top-v.top)/u[1]]},Grid:function(o,v,u,r){var m=o.left-v.left,E=o.top-v.top,O=u[0]/r.grid[0],D=u[1]/r.grid[1],y=Math.floor(m/O),c=Math.floor(E/D);return[(y*O+O/2)/u[0],(c*D+D/2)/u[1]]}},d.Anchors.Perimeter=function(o){o=o||{};var v=o.anchorCount||60,u=o.shape;if(!u)throw new Error("no shape supplied to Perimeter Anchor type");var r=function(){for(var k=.5,B=Math.PI*2/v,M=0,A=[],I=0;I<v;I++){var l=k+k*Math.sin(M),T=k+k*Math.cos(M);A.push([l,T,0,0]),M+=B}return A},m=function(k){for(var B=v/k.length,M=[],A=function(l,T,x,R,G,C,W){B=v*G;for(var V=(x-l)/B,Y=(R-T)/B,L=0;L<B;L++)M.push([l+V*L,T+Y*L,C??0,W??0])},I=0;I<k.length;I++)A.apply(null,k[I]);return M},E=function(k){for(var B=[],M=0;M<k.length;M++)B.push([k[M][0],k[M][1],k[M][2],k[M][3],1/k.length,k[M][4],k[M][5]]);return m(B)},O=function(){return E([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},D={Circle:r,Ellipse:r,Diamond:function(){return E([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:O,Square:O,Triangle:function(){return E([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(k){for(var B=k.points,M=[],A=0,I=0;I<B.length-1;I++){var l=Math.sqrt(Math.pow(B[I][2]-B[I][0])+Math.pow(B[I][3]-B[I][1]));A+=l,M.push([B[I][0],B[I][1],B[I+1][0],B[I+1][1],l])}for(var T=0;T<M.length;T++)M[T][4]=M[T][4]/A;return m(M)}},y=function(k,B){for(var M=[],A=B/180*Math.PI,I=0;I<k.length;I++){var l=k[I][0]-.5,T=k[I][1]-.5;M.push([.5+(l*Math.cos(A)-T*Math.sin(A)),.5+(l*Math.sin(A)+T*Math.cos(A)),k[I][2],k[I][3]])}return M};if(!D[u])throw new Error("Shape ["+u+"] is unknown by Perimeter Anchor type");var c=D[u](o);o.rotation&&(c=y(c,o.rotation));var F=o.jsPlumbInstance.makeDynamicAnchor(c);return F.type="Perimeter",F}}.call(typeof window<"u"?window:ne),function(){var i=this;i.jsPlumbUtil;var e=i.jsPlumb;e.DefaultRouter=function(d){this.jsPlumbInstance=d,this.anchorManager=new e.AnchorManager({jsPlumbInstance:d}),this.sourceOrTargetChanged=function(w,g,S,o,v){this.anchorManager.sourceOrTargetChanged(w,g,S,o,v)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(w,g){this.anchorManager.changeId(w,g)},this.elementRemoved=function(w){this.anchorManager.elementRemoved(w)},this.newConnection=function(w){this.anchorManager.newConnection(w)},this.connectionDetached=function(w,g){this.anchorManager.connectionDetached(w,g)},this.redraw=function(w,g,S,o,v,u){return this.anchorManager.redraw(w,g,S,o,v,u)},this.deleteEndpoint=function(w){this.anchorManager.deleteEndpoint(w)},this.rehomeEndpoint=function(w,g,S){this.anchorManager.rehomeEndpoint(w,g,S)},this.addEndpoint=function(w,g){this.anchorManager.addEndpoint(w,g)}}}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w=i.Biltong;e.Segments={AbstractSegment:function(r){this.params=r,this.findClosestPointOnPath=function(m,E){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(r.x1,r.x2),minY:Math.min(r.y1,r.y2),maxX:Math.max(r.x1,r.x2),maxY:Math.max(r.y1,r.y2)}},this.lineIntersection=function(m,E,O,D){return[]},this.boxIntersection=function(m,E,O,D){var y=[];return y.push.apply(y,this.lineIntersection(m,E,m+O,E)),y.push.apply(y,this.lineIntersection(m+O,E,m+O,E+D)),y.push.apply(y,this.lineIntersection(m+O,E+D,m,E+D)),y.push.apply(y,this.lineIntersection(m,E+D,m,E)),y},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(r){e.Segments.AbstractSegment.apply(this,arguments);var m,E,O,D,y,c,F,k=function(){m=Math.sqrt(Math.pow(y-D,2)+Math.pow(F-c,2)),E=w.gradient({x:D,y:c},{x:y,y:F}),O=-1/E};this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return E},this.getCoordinates=function(){return{x1:D,y1:c,x2:y,y2:F}},this.setCoordinates=function(l){D=l.x1,c=l.y1,y=l.x2,F=l.y2,k()},this.setCoordinates({x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2}),this.getBounds=function(){return{minX:Math.min(D,y),minY:Math.min(c,F),maxX:Math.max(D,y),maxY:Math.max(c,F)}},this.pointOnPath=function(l,T){if(l===0&&!T)return{x:D,y:c};if(l===1&&!T)return{x:y,y:F};var x=T?l>0?l:m+l:l*m;return w.pointOnLine({x:D,y:c},{x:y,y:F},x)},this.gradientAtPoint=function(l){return E},this.pointAlongPathFrom=function(l,T,x){var R=this.pointOnPath(l,x),G=T<=0?{x:D,y:c}:{x:y,y:F};return T<=0&&Math.abs(T)>1&&(T*=-1),w.pointOnLine(R,G,T)};var B=function(l,T,x){return x>=Math.min(l,T)&&x<=Math.max(l,T)},M=function(l,T,x){return Math.abs(x-l)<Math.abs(x-T)?l:T};this.findClosestPointOnPath=function(l,T){var x={d:1/0,x:null,y:null,l:null,x1:D,x2:y,y1:c,y2:F};if(E===0)x.y=c,x.x=B(D,y,l)?l:M(D,y,l);else if(E===1/0||E===-1/0)x.x=D,x.y=B(c,F,T)?T:M(c,F,T);else{var R=c-E*D,G=T-O*l,C=(G-R)/(E-O),W=E*C+R;x.x=B(D,y,C)?C:M(D,y,C),x.y=B(c,F,W)?W:M(c,F,W)}var V=w.lineLength([x.x,x.y],[D,c]);return x.d=w.lineLength([l,T],[x.x,x.y]),x.l=V/m,x};var A=function(l,T,x){return x>T?T<=l&&l<=x:T>=l&&l>=x},I=A;this.lineIntersection=function(l,T,x,R){var G=Math.abs(w.gradient({x:l,y:T},{x,y:R})),C=Math.abs(E),W=C===1/0?D:c-C*D,V=[],Y=G===1/0?l:T-G*l;if(G!==C)if(G===1/0&&C===0)I(l,D,y)&&I(c,T,R)&&(V=[l,c]);else if(G===0&&C===1/0)I(T,c,F)&&I(D,l,x)&&(V=[D,T]);else{var L,q;G===1/0?(L=l,I(L,D,y)&&(q=C*l+W,I(q,T,R)&&(V=[L,q]))):G===0?(q=T,I(q,c,F)&&(L=(T-W)/C,I(L,l,x)&&(V=[L,q]))):(L=(Y-W)/(C-G),q=C*L+W,I(L,D,y)&&I(q,c,F)&&(V=[L,q]))}return V},this.boxIntersection=function(l,T,x,R){var G=[];return G.push.apply(G,this.lineIntersection(l,T,l+x,T)),G.push.apply(G,this.lineIntersection(l+x,T,l+x,T+R)),G.push.apply(G,this.lineIntersection(l+x,T+R,l,T+R)),G.push.apply(G,this.lineIntersection(l,T+R,l,T)),G},this.boundingBoxIntersection=function(l){return this.boxIntersection(l.x,l.y,l.w,l.h)}},Arc:function(r){e.Segments.AbstractSegment.apply(this,arguments);var m=function(M,A){return w.theta([r.cx,r.cy],[M,A])},E=function(M,A){if(M.anticlockwise){var I=M.startAngle<M.endAngle?M.startAngle+O:M.startAngle,l=Math.abs(I-M.endAngle);return I-l*A}else{var T=M.endAngle<M.startAngle?M.endAngle+O:M.endAngle,x=Math.abs(T-M.startAngle);return M.startAngle+x*A}},O=2*Math.PI;this.radius=r.r,this.anticlockwise=r.ac,this.type="Arc",r.startAngle&&r.endAngle?(this.startAngle=r.startAngle,this.endAngle=r.endAngle,this.x1=r.cx+this.radius*Math.cos(r.startAngle),this.y1=r.cy+this.radius*Math.sin(r.startAngle),this.x2=r.cx+this.radius*Math.cos(r.endAngle),this.y2=r.cy+this.radius*Math.sin(r.endAngle)):(this.startAngle=m(r.x1,r.y1),this.endAngle=m(r.x2,r.y2),this.x1=r.x1,this.y1=r.y1,this.x2=r.x2,this.y2=r.y2),this.endAngle<0&&(this.endAngle+=O),this.startAngle<0&&(this.startAngle+=O);var D=this.endAngle<this.startAngle?this.endAngle+O:this.endAngle;this.sweep=Math.abs(D-this.startAngle),this.anticlockwise&&(this.sweep=O-this.sweep);var y=2*Math.PI*this.radius,c=this.sweep/O,F=y*c;this.getLength=function(){return F},this.getBounds=function(){return{minX:r.cx-r.r,maxX:r.cx+r.r,minY:r.cy-r.r,maxY:r.cy+r.r}};var k=1e-10,B=function(M){var A=Math.floor(M),I=Math.ceil(M);return M-A<k?A:I-M<k?I:M};this.pointOnPath=function(M,A){if(M===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(M===1)return{x:this.x2,y:this.y2,theta:this.endAngle};A&&(M=M/F);var I=E(this,M),l=r.cx+r.r*Math.cos(I),T=r.cy+r.r*Math.sin(I);return{x:B(l),y:B(T),theta:I}},this.gradientAtPoint=function(M,A){var I=this.pointOnPath(M,A),l=w.normal([r.cx,r.cy],[I.x,I.y]);return!this.anticlockwise&&(l===1/0||l===-1/0)&&(l*=-1),l},this.pointAlongPathFrom=function(M,A,I){var l=this.pointOnPath(M,I),T=A/y*2*Math.PI,x=this.anticlockwise?-1:1,R=l.theta+x*T,G=r.cx+this.radius*Math.cos(R),C=r.cy+this.radius*Math.sin(R);return{x:G,y:C}}},Bezier:function(r){this.curve=[{x:r.x1,y:r.y1},{x:r.cp1x,y:r.cp1y},{x:r.cp2x,y:r.cp2y},{x:r.x2,y:r.y2}];var m=function(F){return F[0].x===F[1].x&&F[0].y===F[1].y},E=function(F,k){return Math.sqrt(Math.pow(F.x-k.x,2)+Math.pow(F.y-k.y,2))},O=function(F){var k={x:0,y:0};if(F===0)return this.curve[0];var B=this.curve.length-1;if(F===1)return this.curve[B];var M=this.curve,A=1-F;if(B===0)return this.curve[0];if(B===1)return{x:A*M[0].x+F*M[1].x,y:A*M[0].y+F*M[1].y};if(B<4){var I=A*A,l=F*F,T=0,x,R,G;return B===2?(M=[M[0],M[1],M[2],k],x=I,R=2*(A*F),G=l):B===3&&(x=I*A,R=3*(I*F),G=3*(A*l),T=F*l),{x:x*M[0].x+R*M[1].x+G*M[2].x+T*M[3].x,y:x*M[0].y+R*M[1].y+G*M[2].y+T*M[3].y}}else return k}.bind(this),D=function(F){var k=[];F--;for(var B=0;B<=F;B++)k.push(O(B/F));return k},y=function(){m(this.curve)&&(this.length=0);var F=16,k=D(F);this.length=0;for(var B=0;B<F-1;B++){var M=k[B],A=k[B+1];this.length+=E(M,A)}}.bind(this);e.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(r.x1,r.x2,r.cp1x,r.cp2x),minY:Math.min(r.y1,r.y2,r.cp1y,r.cp2y),maxX:Math.max(r.x1,r.x2,r.cp1x,r.cp2x),maxY:Math.max(r.y1,r.y2,r.cp1y,r.cp2y)},this.type="Bezier",y();var c=function(F,k,B){return B&&(k=i.jsBezier.locationAlongCurveFrom(F,k>0?0:1,k)),k};this.pointOnPath=function(F,k){return F=c(this.curve,F,k),i.jsBezier.pointOnCurve(this.curve,F)},this.gradientAtPoint=function(F,k){return F=c(this.curve,F,k),i.jsBezier.gradientAtPoint(this.curve,F)},this.pointAlongPathFrom=function(F,k,B){return F=c(this.curve,F,B),i.jsBezier.pointAlongCurveFrom(this.curve,F,k)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(F,k){var B=i.jsBezier.nearestPointOnCurve({x:F,y:k},this.curve);return{d:Math.sqrt(Math.pow(B.point.x-F,2)+Math.pow(B.point.y-k,2)),x:B.point.x,y:B.point.y,l:1-B.location,s:this}},this.lineIntersection=function(F,k,B,M){return i.jsBezier.lineIntersection(F,k,B,M,this.curve)}}},e.SegmentRenderer={getPath:function(r,m){return{Straight:function(E){var O=r.getCoordinates();return(E?"M "+O.x1+" "+O.y1+" ":"")+"L "+O.x2+" "+O.y2},Bezier:function(E){var O=r.params;return(E?"M "+O.x2+" "+O.y2+" ":"")+"C "+O.cp2x+" "+O.cp2y+" "+O.cp1x+" "+O.cp1y+" "+O.x1+" "+O.y1},Arc:function(E){var O=r.params,D=r.sweep>Math.PI?1:0,y=r.anticlockwise?0:1;return(E?"M"+r.x1+" "+r.y1+" ":"")+"A "+r.radius+" "+O.r+" 0 "+D+","+y+" "+r.x2+" "+r.y2}}[r.type](m)}};var g=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};e.Connectors.AbstractConnector=function(r){g.apply(this,arguments);var m=[],E=0,O=[],D=[],y=r.stub||0,c=d.isArray(y)?y[0]:y,F=d.isArray(y)?y[1]:y,k=r.gap||0,B=d.isArray(k)?k[0]:k,M=d.isArray(k)?k[1]:k,A=null,I=null;this.getPathData=function(){for(var C="",W=0;W<m.length;W++)C+=e.SegmentRenderer.getPath(m[W],W===0),C+=" ";return C},this.findSegmentForPoint=function(C,W){for(var V={d:1/0,s:null,x:null,y:null,l:null},Y=0;Y<m.length;Y++){var L=m[Y].findClosestPointOnPath(C,W);L.d<V.d&&(V.d=L.d,V.l=L.l,V.x=L.x,V.y=L.y,V.s=m[Y],V.x1=L.x1,V.x2=L.x2,V.y1=L.y1,V.y2=L.y2,V.index=Y,V.connectorLocation=O[Y][0]+L.l*(O[Y][1]-O[Y][0]))}return V},this.lineIntersection=function(C,W,V,Y){for(var L=[],q=0;q<m.length;q++)L.push.apply(L,m[q].lineIntersection(C,W,V,Y));return L},this.boxIntersection=function(C,W,V,Y){for(var L=[],q=0;q<m.length;q++)L.push.apply(L,m[q].boxIntersection(C,W,V,Y));return L},this.boundingBoxIntersection=function(C){for(var W=[],V=0;V<m.length;V++)W.push.apply(W,m[V].boundingBoxIntersection(C));return W};var l=function(){for(var C=0,W=0;W<m.length;W++){var V=m[W].getLength();D[W]=V/E,O[W]=[C,C+=V/E]}},T=function(C,W){var V,Y,L;if(W&&(C=C>0?C/E:(E+C)/E),C===1)V=m.length-1,L=1;else if(C===0)L=0,V=0;else if(C>=.5){for(V=0,L=0,Y=O.length-1;Y>-1;Y--)if(O[Y][1]>=C&&O[Y][0]<=C){V=Y,L=(C-O[Y][0])/D[Y];break}}else for(V=O.length-1,L=1,Y=0;Y<O.length;Y++)if(O[Y][1]>=C){V=Y,L=(C-O[Y][0])/D[Y];break}return{segment:m[V],proportion:L,index:V}},x=function(C,W,V){if(!(V.x1===V.x2&&V.y1===V.y2)){var Y=new e.Segments[W](V);m.push(Y),E+=Y.getLength(),C.updateBounds(Y)}},R=function(){E=m.length=O.length=D.length=0};this.setSegments=function(C){A=[],E=0;for(var W=0;W<C.length;W++)A.push(C[W]),E+=C[W].getLength()},this.getLength=function(){return E};var G=function(C){this.strokeWidth=C.strokeWidth;var W=w.quadrant(C.sourcePos,C.targetPos),V=C.targetPos[0]<C.sourcePos[0],Y=C.targetPos[1]<C.sourcePos[1],L=C.strokeWidth||1,q=C.sourceEndpoint.anchor.getOrientation(C.sourceEndpoint),tt=C.targetEndpoint.anchor.getOrientation(C.targetEndpoint),K=V?C.targetPos[0]:C.sourcePos[0],rt=Y?C.targetPos[1]:C.sourcePos[1],f=Math.abs(C.targetPos[0]-C.sourcePos[0]),_=Math.abs(C.targetPos[1]-C.sourcePos[1]);if(q[0]===0&&q[1]===0||tt[0]===0&&tt[1]===0){var h=f>_?0:1,N=[1,0][h];q=[],tt=[],q[h]=C.sourcePos[h]>C.targetPos[h]?-1:1,tt[h]=C.sourcePos[h]>C.targetPos[h]?1:-1,q[N]=0,tt[N]=0}var z=V?f+B*q[0]:B*q[0],U=Y?_+B*q[1]:B*q[1],nt=V?M*tt[0]:f+M*tt[0],ot=Y?M*tt[1]:_+M*tt[1],Z=q[0]*tt[0]+q[1]*tt[1],ut={sx:z,sy:U,tx:nt,ty:ot,lw:L,xSpan:Math.abs(nt-z),ySpan:Math.abs(ot-U),mx:(z+nt)/2,my:(U+ot)/2,so:q,to:tt,x:K,y:rt,w:f,h:_,segment:W,startStubX:z+q[0]*c,startStubY:U+q[1]*c,endStubX:nt+tt[0]*F,endStubY:ot+tt[1]*F,isXGreaterThanStubTimes2:Math.abs(z-nt)>c+F,isYGreaterThanStubTimes2:Math.abs(U-ot)>c+F,opposite:Z===-1,perpendicular:Z===0,orthogonal:Z===1,sourceAxis:q[0]===0?"y":"x",points:[K,rt,f,_,z,U,nt,ot],stubs:[c,F]};return ut.anchorOrientation=ut.opposite?"opposite":ut.orthogonal?"orthogonal":"perpendicular",ut};return this.getSegments=function(){return m},this.updateBounds=function(C){var W=C.getBounds();this.bounds.minX=Math.min(this.bounds.minX,W.minX),this.bounds.maxX=Math.max(this.bounds.maxX,W.maxX),this.bounds.minY=Math.min(this.bounds.minY,W.minY),this.bounds.maxY=Math.max(this.bounds.maxY,W.maxY)},this.pointOnPath=function(C,W){var V=T(C,W);return V.segment&&V.segment.pointOnPath(V.proportion,!1)||[0,0]},this.gradientAtPoint=function(C,W){var V=T(C,W);return V.segment&&V.segment.gradientAtPoint(V.proportion,!1)||0},this.pointAlongPathFrom=function(C,W,V){var Y=T(C,V);return Y.segment&&Y.segment.pointAlongPathFrom(Y.proportion,W,!1)||[0,0]},this.compute=function(C){I=G.call(this,C),R(),this._compute(I,C),this.x=I.points[0],this.y=I.points[1],this.w=I.points[2],this.h=I.points[3],this.segment=I.segment,l()},{addSegment:x,prepareCompute:G,sourceStub:c,targetStub:F,maxStub:Math.max(c,F),sourceGap:B,targetGap:M,maxGap:Math.max(B,M)}},d.extend(e.Connectors.AbstractConnector,g),e.Endpoints.AbstractEndpoint=function(r){g.apply(this,arguments);var m=this.compute=function(E,O,D,y){var c=this._compute.apply(this,arguments);return this.x=c[0],this.y=c[1],this.w=c[2],this.h=c[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,c};return{compute:m,cssClass:r.cssClass}},d.extend(e.Endpoints.AbstractEndpoint,g),e.Endpoints.Dot=function(r){this.type="Dot",e.Endpoints.AbstractEndpoint.apply(this,arguments),r=r||{},this.radius=r.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,E,O,D){this.radius=O.radius||this.radius;var y=m[0]-this.radius,c=m[1]-this.radius,F=this.radius*2,k=this.radius*2;if(O.stroke){var B=O.strokeWidth||1;y-=B,c-=B,F+=B*2,k+=B*2}return[y,c,F,k,this.radius]}},d.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint),e.Endpoints.Rectangle=function(r){this.type="Rectangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),r=r||{},this.width=r.width||20,this.height=r.height||20,this._compute=function(m,E,O,D){var y=O.width||this.width,c=O.height||this.height,F=m[0]-y/2,k=m[1]-c/2;return[F,k,y,c]}},d.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var S=function(r){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};d.extend(S,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(r){this._jsPlumb.displayElements.push(r)}}),e.Endpoints.Image=function(r){this.type="Image",S.apply(this,arguments),e.Endpoints.AbstractEndpoint.apply(this,arguments);var m=r.onload,E=r.src||r.url,O=r.cssClass?" "+r.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=r.width,this._jsPlumb.heightToUse=r.height,this._jsPlumb.endpoint=r.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(D,y){var c=D.constructor===String?D:D.src;m=y,this._jsPlumb.img.src=c,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(E,m),this._compute=function(D,y,c,F){return this.anchorPoint=D,this._jsPlumb.ready?[D[0]-this._jsPlumb.widthToUse/2,D[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=e.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+O),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(D,y,c){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var F=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,k=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;d.sizeElement(this.canvas,F,k,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(D,y){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(D,y):i.setTimeout(function(){this.paint(D,y)}.bind(this),200))}},d.extend(e.Endpoints.Image,[S,e.Endpoints.AbstractEndpoint],{cleanup:function(r){r&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),e.Endpoints.Blank=function(r){e.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",S.apply(this,arguments),this._compute=function(E,O,D,y){return[E[0],E[1],10,0]};var m=r.cssClass?" "+r.cssClass:"";this.canvas=e.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(E,O){d.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},d.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,S],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),e.Endpoints.Triangle=function(r){this.type="Triangle",e.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;r=r||{},r.width=r.width||55,r.height=r.height||55,this.width=r.width,this.height=r.height,this._compute=function(E,O,D,y){var c=D.width||m.width,F=D.height||m.height,k=E[0]-c/2,B=E[1]-F/2;return[k,B,c,F]}};var o=e.Overlays.AbstractOverlay=function(r){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=r.component,this.loc=r.location==null?.5:r.location,this.endpointLoc=r.endpointLocation==null?[.5,.5]:r.endpointLocation,this.visible=r.visible!==!1};o.prototype={cleanup:function(r){r&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(r,m){},setVisible:function(r){this.visible=r,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(r){this.loc+=r,this.component.repaint()},setLocation:function(r){this.loc=r,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},e.Overlays.Arrow=function(r){this.type="Arrow",o.apply(this,arguments),this.isAppendedAtTopLevel=!1,r=r||{};var m=this;this.length=r.length||20,this.width=r.width||20,this.id=r.id,this.direction=(r.direction||1)<0?-1:1;var E=r.paintStyle||{"stroke-width":1},O=r.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(D,y){if(this.path=D,r.events)for(var c in r.events)e.on(D,c,r.events[c])},this.draw=function(D,y){var c,F,k,B,M;if(D.pointAlongPathFrom){if(d.isString(this.loc)||this.loc>1||this.loc<0){var A=parseInt(this.loc,10),I=this.loc<0?1:0;c=D.pointAlongPathFrom(I,A,!1),F=D.pointAlongPathFrom(I,A-this.direction*this.length/2,!1),k=w.pointOnLine(c,F,this.length)}else if(this.loc===1){if(c=D.pointOnPath(this.loc),F=D.pointAlongPathFrom(this.loc,-this.length),k=w.pointOnLine(c,F,this.length),this.direction===-1){var l=k;k=c,c=l}}else if(this.loc===0){if(k=D.pointOnPath(this.loc),F=D.pointAlongPathFrom(this.loc,this.length),c=w.pointOnLine(k,F,this.length),this.direction===-1){var T=k;k=c,c=T}}else c=D.pointAlongPathFrom(this.loc,this.direction*this.length/2),F=D.pointOnPath(this.loc),k=w.pointOnLine(c,F,this.length);B=w.perpendicularLineTo(c,k,this.width),M=w.pointOnLine(c,k,O*this.length);var x={hxy:c,tail:B,cxy:M},R=E.stroke||y.stroke,G=E.fill||y.stroke,C=E.strokeWidth||y.strokeWidth;return{component:D,d:x,"stroke-width":C,stroke:R,fill:G,minX:Math.min(c.x,B[0].x,B[1].x),maxX:Math.max(c.x,B[0].x,B[1].x),minY:Math.min(c.y,B[0].y,B[1].y),maxY:Math.max(c.y,B[0].y,B[1].y)}}else return{component:D,minX:0,maxX:0,minY:0,maxY:0}}},d.extend(e.Overlays.Arrow,o,{updateFrom:function(r){this.length=r.length||this.length,this.width=r.width||this.width,this.direction=r.direction!=null?r.direction:this.direction,this.foldback=r.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),e.Overlays.PlainArrow=function(r){r=r||{};var m=e.extend(r,{foldback:1});e.Overlays.Arrow.call(this,m),this.type="PlainArrow"},d.extend(e.Overlays.PlainArrow,e.Overlays.Arrow),e.Overlays.Diamond=function(r){r=r||{};var m=r.length||40,E=e.extend(r,{length:m/2,foldback:2});e.Overlays.Arrow.call(this,E),this.type="Diamond"},d.extend(e.Overlays.Diamond,e.Overlays.Arrow);var v=function(r,m){return(r._jsPlumb.cachedDimensions==null||m)&&(r._jsPlumb.cachedDimensions=r.getDimensions()),r._jsPlumb.cachedDimensions},u=function(r){e.jsPlumbUIComponent.apply(this,arguments),o.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=r.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=r.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=r.create,this._jsPlumb.initiallyInvisible=r.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var E=this._jsPlumb.div=e.getElement(this._jsPlumb.create(this._jsPlumb.component));E.style.position="absolute",jsPlumb.addClass(E,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:r.cssClass?r.cssClass:"")),this._jsPlumb.instance.appendElement(E),this._jsPlumb.instance.getId(E),this.canvas=E;var O="translate(-50%, -50%)";E.style.webkitTransform=O,E.style.mozTransform=O,E.style.msTransform=O,E.style.oTransform=O,E.style.transform=O,E._jsPlumb=this,r.visible===!1&&(E.style.display="none")}return this._jsPlumb.div},this.draw=function(E,O,D){var y=v(this);if(y!=null&&y.length===2){var c={x:0,y:0};if(D)c={x:D[0],y:D[1]};else if(E.pointOnPath){var F=this.loc,k=!1;(d.isString(this.loc)||this.loc<0||this.loc>1)&&(F=parseInt(this.loc,10),k=!0),c=E.pointOnPath(F,k)}else{var B=this.loc.constructor===Array?this.loc:this.endpointLoc;c={x:B[0]*E.w,y:B[1]*E.h}}var M=c.x-y[0]/2,A=c.y-y[1]/2;return{component:E,d:{minx:M,miny:A,td:y,cxy:c},minX:M,maxX:M+y[0],minY:A,maxY:A+y[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};d.extend(u,[e.jsPlumbUIComponent,o],{getDimensions:function(){return[1,1]},setVisible:function(r){this._jsPlumb.div&&(this._jsPlumb.div.style.display=r?"block":"none",r&&this._jsPlumb.initiallyInvisible&&(v(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(r){r?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(r,m){this._jsPlumb.div!=null&&r.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var r=v(this);return Math.max(r[0],r[1])},paint:function(r,m){this._jsPlumb.initialised||(this.getElement(),r.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=r.component.x+r.d.minx+"px",this._jsPlumb.div.style.top=r.component.y+r.d.miny+"px"}}),e.Overlays.Custom=function(r){this.type="Custom",u.apply(this,arguments)},d.extend(e.Overlays.Custom,u),e.Overlays.GuideLines=function(){var r=this;r.length=50,r.strokeWidth=5,this.type="GuideLines",o.apply(this,arguments),e.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,E){var O=m.pointAlongPathFrom(r.loc,r.length/2),D=m.pointOnPath(r.loc),y=w.pointOnLine(O,D,r.length),c=w.perpendicularLineTo(O,y,40),F=w.perpendicularLineTo(y,O,20);return{connector:m,head:O,tail:y,headLine:F,tailLine:c,minX:Math.min(O.x,y.x,F[0].x,F[1].x),minY:Math.min(O.y,y.y,F[0].y,F[1].y),maxX:Math.max(O.x,y.x,F[0].x,F[1].x),maxY:Math.max(O.y,y.y,F[0].y,F[1].y)}}},e.Overlays.Label=function(r){this.labelStyle=r.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=e.extend({create:function(){return e.createElement("div")}},r);if(e.Overlays.Custom.call(this,m),this.type="Label",this.label=r.label||"",this.labelText=null,this.labelStyle){var E=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",E.style.font=this.labelStyle.font,E.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(E.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var O=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";E.style.border=this.labelStyle.borderWidth+"px solid "+O}this.labelStyle.padding&&(E.style.padding=this.labelStyle.padding)}},d.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(r){r&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(r){this.label=r,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),u.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var r=this.label(this);this.getElement().innerHTML=r.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(r){r.label!=null&&this.setLabel(r.label)}})}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumbUtil,d=i.jsPlumbInstance,w="jtk-group-collapsed",g="jtk-group-expanded",S="[jtk-group-content]",o="elementDraggable",v="stop",u="revert",r="_groupManager",m="_jsPlumbGroup",E="_jsPlumbGroupDrag",O="group:addMember",D="group:removeMember",y="group:add",c="group:remove",F="group:expand",k="group:collapse",B="groupDragStop",M="connectionMoved",A="internal.connectionDetached",I="removeAll",l="orphanAll",T="show",x="hide",R=function(C){var W={},V={},Y={},L=this;function q(h,N){for(var z=C.getContainer(),U=!1;!U;){if(h==null||h===z)return!1;if(h===N)return!0;h=h.parentNode}}C.bind("connection",function(h){var N=C.getGroupFor(h.source),z=C.getGroupFor(h.target);N!=null&&z!=null&&N===z?(V[h.connection.id]=N,Y[h.connection.id]=N):(N!=null&&(e.suggest(N.connections.source,h.connection),V[h.connection.id]=N),z!=null&&(e.suggest(z.connections.target,h.connection),Y[h.connection.id]=z))});function tt(h){delete h.proxies;var N=V[h.id],z;N!=null&&(z=function(U){return U.id===h.id},e.removeWithFunction(N.connections.source,z),e.removeWithFunction(N.connections.target,z),delete V[h.id]),N=Y[h.id],N!=null&&(z=function(U){return U.id===h.id},e.removeWithFunction(N.connections.source,z),e.removeWithFunction(N.connections.target,z),delete Y[h.id])}C.bind(A,function(h){tt(h.connection)}),C.bind(M,function(h){var N=h.index===0?V:Y,z=N[h.connection.id];if(z){var U=z.connections[h.index===0?"source":"target"],nt=U.indexOf(h.connection);nt!==-1&&U.splice(nt,1)}}),this.addGroup=function(h){C.addClass(h.getEl(),g),W[h.id]=h,h.manager=this,_(h),C.fire(y,{group:h})},this.addToGroup=function(h,N,z){if(h=this.getGroup(h),h){var U=h.getEl();if(N._isJsPlumbGroup)return;var nt=N._jsPlumbGroup;if(nt!==h){C.removeFromDragSelection(N);var ot=C.getOffset(N,!0),Z=h.collapsed?C.getOffset(U,!0):C.getOffset(h.getDragArea(),!0);nt!=null&&(nt.remove(N,!1,z,!1,h),L.updateConnectionsForGroup(nt)),h.add(N,z);var ut=function(xt,Pt){var Ot=Pt===0?1:0;xt.each(function(Ct){Ct.setVisible(!1),Ct.endpoints[Ot].element._jsPlumbGroup===h?(Ct.endpoints[Ot].setVisible(!1),f(Ct,Ot,h)):(Ct.endpoints[Pt].setVisible(!1),rt(Ct,Pt,h))})};h.collapsed&&(ut(C.select({source:N}),0),ut(C.select({target:N}),1));var dt=C.getId(N);C.dragManager.setParent(N,dt,U,C.getId(U),ot);var ft={left:ot.left-Z.left,top:ot.top-Z.top};if(C.setPosition(N,ft),C.dragManager.revalidateParent(N,dt,ot),L.updateConnectionsForGroup(h),C.revalidate(dt),!z){var ct={group:h,el:N,pos:ft};nt&&(ct.sourceGroup=nt),C.fire(O,ct)}}}},this.removeFromGroup=function(h,N,z){if(h=this.getGroup(h),h){if(h.collapsed){var U=function(nt,ot){for(var Z=0;Z<nt.length;Z++){var ut=nt[Z];if(ut.proxies){for(var dt=0;dt<ut.proxies.length;dt++)if(ut.proxies[dt]!=null){var ft=ut.proxies[dt].originalEp.element;(ft===N||q(ft,N))&&f(ut,ot,h)}}}};U(h.connections.source.slice(),0),U(h.connections.target.slice(),1)}h.remove(N,null,z)}},this.getGroup=function(h){var N=h;if(e.isString(h)&&(N=W[h],N==null))throw new TypeError("No such group ["+h+"]");return N},this.getGroups=function(){var h=[];for(var N in W)h.push(W[N]);return h},this.removeGroup=function(h,N,z,U){h=this.getGroup(h),this.expandGroup(h,!0);var nt=h[N?I:l](z,U);return C.remove(h.getEl()),delete W[h.id],delete C._groups[h.id],C.fire(c,{group:h}),nt},this.removeAllGroups=function(h,N,z){for(var U in W)this.removeGroup(W[U],h,N,z)};function K(h,N){for(var z=h.getEl().querySelectorAll(".jtk-managed"),U=0;U<z.length;U++)C[N?T:x](z[U],!0)}var rt=function(h,N,z){var U=h.endpoints[N===0?1:0].element;if(!(U[m]&&!U[m].shouldProxy()&&U[m].collapsed)){var nt=z.getEl(),ot=C.getId(nt);C.proxyConnection(h,N,nt,ot,function(Z,ut){return z.getEndpoint(Z,ut)},function(Z,ut){return z.getAnchor(Z,ut)})}};this.collapseGroup=function(h){if(h=this.getGroup(h),!(h==null||h.collapsed)){var N=h.getEl();if(K(h,!1),h.shouldProxy()){var z=function(U,nt){for(var ot=0;ot<U.length;ot++){var Z=U[ot];rt(Z,nt,h)}};z(h.connections.source,0),z(h.connections.target,1)}h.collapsed=!0,C.removeClass(N,g),C.addClass(N,w),C.revalidate(N),C.fire(k,{group:h})}};var f=function(h,N,z){C.unproxyConnection(h,N,C.getId(z.getEl()))};this.expandGroup=function(h,N){if(h=this.getGroup(h),!(h==null||!h.collapsed)){var z=h.getEl();if(K(h,!0),h.shouldProxy()){var U=function(nt,ot){for(var Z=0;Z<nt.length;Z++){var ut=nt[Z];f(ut,ot,h)}};U(h.connections.source,0),U(h.connections.target,1)}h.collapsed=!1,C.addClass(z,g),C.removeClass(z,w),C.revalidate(z),this.repaintGroup(h),N||C.fire(F,{group:h})}},this.repaintGroup=function(h){h=this.getGroup(h);for(var N=h.getMembers(),z=0;z<N.length;z++)C.revalidate(N[z])};function _(h){for(var N=h.getMembers().slice(),z=[],U=0;U<N.length;U++)Array.prototype.push.apply(z,N[U].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(N,z);var nt=C.getConnections({source:N,scope:"*"},!0),ot=C.getConnections({target:N,scope:"*"},!0),Z={};h.connections.source.length=0,h.connections.target.length=0;var ut=function(dt){for(var ft=0;ft<dt.length;ft++)if(!Z[dt[ft].id]){Z[dt[ft].id]=!0;var ct=C.getGroupFor(dt[ft].source),xt=C.getGroupFor(dt[ft].target);ct===h?(xt!==h&&h.connections.source.push(dt[ft]),V[dt[ft].id]=h):xt===h&&(h.connections.target.push(dt[ft]),Y[dt[ft].id]=h)}};ut(nt),ut(ot)}this.updateConnectionsForGroup=_,this.refreshAllGroups=function(){for(var h in W)_(W[h]),C.dragManager.updateOffsets(C.getId(W[h].getEl()))}},G=function(C,W){var V=this,Y=W.el;this.getEl=function(){return Y},this.id=W.id||e.uuid(),Y._isJsPlumbGroup=!0;var L=this.getDragArea=function(){var xt=C.getSelector(Y,S);return xt&&xt.length>0?xt[0]:Y},q=W.ghost===!0,tt=q||W.constrain===!0,K=W.revert!==!1,rt=W.orphan===!0,f=W.prune===!0,_=W.dropOverride===!0,h=W.proxied!==!1,N=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(xt,Pt){return W.anchor||"Continuous"},this.getEndpoint=function(xt,Pt){return W.endpoint||["Dot",{radius:10}]},this.collapsed=!1,W.draggable!==!1){var z={drag:function(){for(var xt=0;xt<N.length;xt++)C.draw(N[xt])},stop:function(xt){C.fire(B,jsPlumb.extend(xt,{group:V}))},scope:E};W.dragOptions&&i.jsPlumb.extend(z,W.dragOptions),C.draggable(W.el,z)}W.droppable!==!1&&C.droppable(W.el,{drop:function(xt){var Pt=xt.drag.el;if(!Pt._isJsPlumbGroup){var Ot=Pt._jsPlumbGroup;if(Ot!==V){if(Ot!=null&&Ot.overrideDrop(Pt,V))return;C.getGroupManager().addToGroup(V,Pt,!1)}}}});var U=function(xt,Pt){for(var Ot=xt.nodeType==null?xt:[xt],Ct=0;Ct<Ot.length;Ct++)Pt(Ot[Ct])};this.overrideDrop=function(xt,Pt){return _&&(K||f||rt)},this.add=function(xt,Pt){var Ot=L();U(xt,function(Ct){if(Ct._jsPlumbGroup!=null){if(Ct._jsPlumbGroup===V)return;Ct._jsPlumbGroup.remove(Ct,!0,Pt,!1)}Ct._jsPlumbGroup=V,N.push(Ct),C.isAlreadyDraggable(Ct)&&ct(Ct),Ct.parentNode!==Ot&&Ot.appendChild(Ct)}),C.getGroupManager().updateConnectionsForGroup(V)},this.remove=function(xt,Pt,Ot,Ct,Rt){U(xt,function(Mt){if(Mt._jsPlumbGroup===V){if(delete Mt._jsPlumbGroup,e.removeWithFunction(N,function(mt){return mt===Mt}),Pt)try{V.getDragArea().removeChild(Mt)}catch(mt){jsPlumbUtil.log("Could not remove element from Group "+mt)}if(ft(Mt),!Ot){var vt={group:V,el:Mt};Rt&&(vt.targetGroup=Rt),C.fire(D,vt)}}}),Ct||C.getGroupManager().updateConnectionsForGroup(V)},this.removeAll=function(xt,Pt){for(var Ot=0,Ct=N.length;Ot<Ct;Ot++){var Rt=N[0];V.remove(Rt,xt,Pt,!0),C.remove(Rt,!0)}N.length=0,C.getGroupManager().updateConnectionsForGroup(V)},this.orphanAll=function(){for(var xt={},Pt=0;Pt<N.length;Pt++){var Ot=Z(N[Pt]);xt[Ot[0]]=Ot[1]}return N.length=0,xt},this.getMembers=function(){return N},Y[m]=this,C.bind(o,function(xt){xt.el._jsPlumbGroup===this&&ct(xt.el)}.bind(this));function nt(xt){return xt.offsetParent}function ot(xt,Pt){var Ot=nt(xt),Ct=C.getSize(Ot),Rt=C.getSize(xt),Mt=Pt[0],vt=Mt+Rt[0],mt=Pt[1],wt=mt+Rt[1];return vt>0&&Mt<Ct[0]&&wt>0&&mt<Ct[1]}function Z(xt){var Pt=C.getId(xt),Ot=C.getOffset(xt);return xt.parentNode.removeChild(xt),C.getContainer().appendChild(xt),C.setPosition(xt,Ot),ft(xt),C.dragManager.clearParent(xt,Pt),[Pt,Ot]}function ut(xt){var Pt=[];function Ot(Rt,Mt,vt){var mt=null;if(!ot(Rt,[Mt,vt])){var wt=Rt._jsPlumbGroup;f?C.remove(Rt):mt=Z(Rt),wt.remove(Rt)}return mt}for(var Ct=0;Ct<xt.selection.length;Ct++)Pt.push(Ot(xt.selection[Ct][0],xt.selection[Ct][1].left,xt.selection[Ct][1].top));return Pt.length===1?Pt[0]:Pt}function dt(xt){var Pt=C.getId(xt);C.revalidate(xt),C.dragManager.revalidateParent(xt,Pt)}function ft(xt){xt._katavorioDrag&&((f||rt)&&xt._katavorioDrag.off(v,ut),!f&&!rt&&K&&(xt._katavorioDrag.off(u,dt),xt._katavorioDrag.setRevert(null)))}function ct(xt){xt._katavorioDrag&&((f||rt)&&xt._katavorioDrag.on(v,ut),tt&&xt._katavorioDrag.setConstrain(!0),q&&xt._katavorioDrag.setUseGhostProxy(!0),!f&&!rt&&K&&(xt._katavorioDrag.on(u,dt),xt._katavorioDrag.setRevert(function(Pt,Ot){return!ot(Pt,Ot)})))}this.shouldProxy=function(){return h},C.getGroupManager().addGroup(this)};d.prototype.addGroup=function(C){var W=this;if(W._groups=W._groups||{},W._groups[C.id]!=null)throw new TypeError("cannot create Group ["+C.id+"]; a Group with that ID exists");if(C.el[m]!=null)throw new TypeError("cannot create Group ["+C.id+"]; the given element is already a Group");var V=new G(W,C);return W._groups[V.id]=V,C.collapsed&&this.collapseGroup(V),V},d.prototype.addToGroup=function(C,W,V){var Y=function(q){var tt=this.getId(q);this.manage(tt,q),this.getGroupManager().addToGroup(C,q,V)}.bind(this);if(Array.isArray(W))for(var L=0;L<W.length;L++)Y(W[L]);else Y(W)},d.prototype.removeFromGroup=function(C,W,V){this.getGroupManager().removeFromGroup(C,W,V),this.getContainer().appendChild(W)},d.prototype.removeGroup=function(C,W,V,Y){return this.getGroupManager().removeGroup(C,W,V,Y)},d.prototype.removeAllGroups=function(C,W,V){this.getGroupManager().removeAllGroups(C,W,V)},d.prototype.getGroup=function(C){return this.getGroupManager().getGroup(C)},d.prototype.getGroups=function(){return this.getGroupManager().getGroups()},d.prototype.expandGroup=function(C){this.getGroupManager().expandGroup(C)},d.prototype.collapseGroup=function(C){this.getGroupManager().collapseGroup(C)},d.prototype.repaintGroup=function(C){this.getGroupManager().repaintGroup(C)},d.prototype.toggleGroup=function(C){C=this.getGroupManager().getGroup(C),C!=null&&this.getGroupManager()[C.collapsed?"expandGroup":"collapseGroup"](C)},d.prototype.getGroupManager=function(){var C=this[r];return C==null&&(C=this[r]=new R(this)),C},d.prototype.removeGroupManager=function(){delete this[r]},d.prototype.getGroupFor=function(C){if(C=this.getElement(C),C){for(var W=this.getContainer(),V=!1,Y=null;!V;)C==null||C===W?V=!0:C[m]?(Y=C[m],V=!0):C=C.parentNode;return Y}}}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w="Straight",g="Arc",S=function(o){this.type="Flowchart",o=o||{},o.stub=o.stub==null?30:o.stub;var v,u=e.Connectors.AbstractConnector.apply(this,arguments),r=o.midpoint==null||isNaN(o.midpoint)?.5:o.midpoint,m=o.alwaysRespectStubs===!0,E=null,O=null,D=o.cornerRadius!=null?o.cornerRadius:0;o.loopbackRadius;var y=function(A){return A<0?-1:A===0?0:1},c=function(A){return[y(A[2]-A[0]),y(A[3]-A[1])]},F=function(A,I,l,T){if(!(E===I&&O===l)){var x=E??T.sx,R=O??T.sy,G=x===I?"v":"h";E=I,O=l,A.push([x,R,I,l,G])}},k=function(A){return Math.sqrt(Math.pow(A[0]-A[2],2)+Math.pow(A[1]-A[3],2))},B=function(A){var I=[];return I.push.apply(I,A),I},M=function(A,I,l){for(var T=null,x,R,G,C=0;C<I.length-1;C++){if(T=T||B(I[C]),x=B(I[C+1]),R=c(T),G=c(x),D>0&&T[4]!==x[4]){var W=Math.min(k(T),k(x)),V=Math.min(D,W/2);T[2]-=R[0]*V,T[3]-=R[1]*V,x[0]+=G[0]*V,x[1]+=G[1]*V;var Y=R[1]===G[0]&&G[0]===1||R[1]===G[0]&&G[0]===0&&R[0]!==G[1]||R[1]===G[0]&&G[0]===-1,L=x[1]>T[3]?1:-1,q=x[0]>T[2]?1:-1,tt=L===q,K=tt&&Y||!tt&&!Y?x[0]:T[2],rt=tt&&Y||!tt&&!Y?T[3]:x[1];u.addSegment(A,w,{x1:T[0],y1:T[1],x2:T[2],y2:T[3]}),u.addSegment(A,g,{r:V,x1:T[2],y1:T[3],x2:x[0],y2:x[1],cx:K,cy:rt,ac:Y})}else{var f=T[2]===T[0]?0:T[2]>T[0]?l.lw/2:-(l.lw/2),_=T[3]===T[1]?0:T[3]>T[1]?l.lw/2:-(l.lw/2);u.addSegment(A,w,{x1:T[0]-f,y1:T[1]-_,x2:T[2]+f,y2:T[3]+_})}T=x}x!=null&&u.addSegment(A,w,{x1:x[0],y1:x[1],x2:x[2],y2:x[3]})};this.midpoint=r,this._compute=function(A,I){v=[],E=null,O=null;var l=function(){return[A.startStubX,A.startStubY,A.endStubX,A.endStubY]},T={perpendicular:l,orthogonal:l,opposite:function(_){var h=A,N=_==="x"?0:1,z={x:function(){return h.so[N]===1&&(h.startStubX>h.endStubX&&h.tx>h.startStubX||h.sx>h.endStubX&&h.tx>h.sx)||h.so[N]===-1&&(h.startStubX<h.endStubX&&h.tx<h.startStubX||h.sx<h.endStubX&&h.tx<h.sx)},y:function(){return h.so[N]===1&&(h.startStubY>h.endStubY&&h.ty>h.startStubY||h.sy>h.endStubY&&h.ty>h.sy)||h.so[N]===-1&&(h.startStubY<h.endStubY&&h.ty<h.startStubY||h.sy<h.endStubY&&h.ty<h.sy)}};return!m&&z[_]()?{x:[(A.sx+A.tx)/2,A.startStubY,(A.sx+A.tx)/2,A.endStubY],y:[A.startStubX,(A.sy+A.ty)/2,A.endStubX,(A.sy+A.ty)/2]}[_]:[A.startStubX,A.startStubY,A.endStubX,A.endStubY]}},x=T[A.anchorOrientation](A.sourceAxis),R=A.sourceAxis==="x"?0:1,G=A.sourceAxis==="x"?1:0,C=x[R],W=x[G],V=x[R+2],Y=x[G+2];F(v,x[0],x[1],A);var L=A.startStubX+(A.endStubX-A.startStubX)*r,q=A.startStubY+(A.endStubY-A.startStubY)*r,tt={x:[0,1],y:[1,0]},K={perpendicular:function(_){var h=A,N={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},z={x:[[h.startStubX,h.endStubX],null,[h.endStubX,h.startStubX]],y:[[h.startStubY,h.endStubY],null,[h.endStubY,h.startStubY]]},U={x:[[L,h.startStubY],[L,h.endStubY]],y:[[h.startStubX,q],[h.endStubX,q]]},nt={x:[[h.endStubX,h.startStubY]],y:[[h.startStubX,h.endStubY]]},ot={x:[[h.startStubX,h.endStubY],[h.endStubX,h.endStubY]],y:[[h.endStubX,h.startStubY],[h.endStubX,h.endStubY]]},Z={x:[[h.startStubX,q],[h.endStubX,q],[h.endStubX,h.endStubY]],y:[[L,h.startStubY],[L,h.endStubY],[h.endStubX,h.endStubY]]},ut={x:[h.startStubY,h.endStubY],y:[h.startStubX,h.endStubX]},dt=tt[_][0],ft=tt[_][1],ct=h.so[dt]+1,xt=h.to[ft]+1,Pt=h.to[ft]===-1&&ut[_][1]<ut[_][0]||h.to[ft]===1&&ut[_][1]>ut[_][0],Ot=z[_][ct][0],Ct=z[_][ct][1],Rt=N[_][ct][xt];if(h.segment===Rt[3]||h.segment===Rt[2]&&Pt)return U[_];if(h.segment===Rt[2]&&Ct<Ot)return nt[_];if(h.segment===Rt[2]&&Ct>=Ot||h.segment===Rt[1]&&!Pt)return Z[_];if(h.segment===Rt[0]||h.segment===Rt[1]&&Pt)return ot[_]},orthogonal:function(_,h,N,z,U){var nt=A,ot={x:nt.so[0]===-1?Math.min(h,z):Math.max(h,z),y:nt.so[1]===-1?Math.min(h,z):Math.max(h,z)}[_];return{x:[[ot,N],[ot,U],[z,U]],y:[[N,ot],[U,ot],[U,z]]}[_]},opposite:function(_,h,N,z){var U=A,nt={x:"y",y:"x"}[_],ot={x:"height",y:"width"}[_],Z=U["is"+_.toUpperCase()+"GreaterThanStubTimes2"];if(I.sourceEndpoint.elementId===I.targetEndpoint.elementId){var ut=N+(1-I.sourceEndpoint.anchor[nt])*I.sourceInfo[ot]+u.maxStub;return{x:[[h,ut],[z,ut]],y:[[ut,h],[ut,z]]}[_]}else{if(!Z||U.so[R]===1&&h>z||U.so[R]===-1&&h<z)return{x:[[h,q],[z,q]],y:[[L,h],[L,z]]}[_];if(U.so[R]===1&&h<z||U.so[R]===-1&&h>z)return{x:[[L,U.sy],[L,U.ty]],y:[[U.sx,q],[U.tx,q]]}[_]}}},rt=K[A.anchorOrientation](A.sourceAxis,C,W,V,Y);if(rt)for(var f=0;f<rt.length;f++)F(v,rt[f][0],rt[f][1],A);F(v,x[2],x[3],A),F(v,A.tx,A.ty,A),M(this,v,A)}};e.Connectors.Flowchart=S,d.extend(e.Connectors.Flowchart,e.Connectors.AbstractConnector)}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil;e.Connectors.AbstractBezierConnector=function(g){g=g||{};var S=g.showLoopback!==!1;g.curviness;var o=g.margin||5;g.proximityLimit;var v=g.orientation&&g.orientation==="clockwise",u=g.loopbackRadius||25,r;return this._compute=function(m,E){var O=E.sourcePos,D=E.targetPos,y=Math.abs(O[0]-D[0]),c=Math.abs(O[1]-D[1]);if(!S||E.sourceEndpoint.elementId!==E.targetEndpoint.elementId)this._computeBezier(m,E,O,D,y,c);else{var F=E.sourcePos[0],k=E.sourcePos[1]-o,B=F,M=k-u,A=B-u,I=M-u;y=2*u,c=2*u,m.points[0]=A,m.points[1]=I,m.points[2]=y,m.points[3]=c,r.addSegment(this,"Arc",{loopback:!0,x1:F-A+4,y1:k-I,startAngle:0,endAngle:2*Math.PI,r:u,ac:!v,x2:F-A-4,y2:k-I,cx:B-A,cy:M-I})}},r=e.Connectors.AbstractConnector.apply(this,arguments),r},d.extend(e.Connectors.AbstractBezierConnector,e.Connectors.AbstractConnector);var w=function(g){g=g||{},this.type="Bezier";var S=e.Connectors.AbstractBezierConnector.apply(this,arguments),o=g.curviness||150,v=10;this.getCurviness=function(){return o},this._findControlPoint=function(u,r,m,E,O,D,y){var c=D[0]!==y[0]||D[1]===y[1],F=[];return c?(y[0]===0?F.push(m[0]<r[0]?u[0]+v:u[0]-v):F.push(u[0]+o*y[0]),y[1]===0?F.push(m[1]<r[1]?u[1]+v:u[1]-v):F.push(u[1]+o*D[1])):(D[0]===0?F.push(r[0]<m[0]?u[0]+v:u[0]-v):F.push(u[0]-o*D[0]),D[1]===0?F.push(r[1]<m[1]?u[1]+v:u[1]-v):F.push(u[1]+o*y[1])),F},this._computeBezier=function(u,r,m,E,O,D){var y,c,F=m[0]<E[0]?O:0,k=m[1]<E[1]?D:0,B=m[0]<E[0]?0:O,M=m[1]<E[1]?0:D;y=this._findControlPoint([F,k],m,E,r.sourceEndpoint,r.targetEndpoint,u.so,u.to),c=this._findControlPoint([B,M],E,m,r.targetEndpoint,r.sourceEndpoint,u.to,u.so),S.addSegment(this,"Bezier",{x1:F,y1:k,x2:B,y2:M,cp1x:y[0],cp1y:y[1],cp2x:c[0],cp2y:c[1]})}};e.Connectors.Bezier=w,d.extend(w,e.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w=function(o,v,u,r){return o<=u&&r<=v?1:o<=u&&v<=r?2:u<=o&&r>=v?3:4},g=function(o,v,u,r,m,E,O,D,y){if(D<=y)return[o,v];if(u===1)return r[3]<=0&&m[3]>=1?[o+(r[2]<.5?-1*E:E),v]:r[2]>=1&&m[2]<=0?[o,v+(r[3]<.5?-1*O:O)]:[o+-1*E,v+-1*O];if(u===2)return r[3]>=1&&m[3]<=0?[o+(r[2]<.5?-1*E:E),v]:r[2]>=1&&m[2]<=0?[o,v+(r[3]<.5?-1*O:O)]:[o+E,v+-1*O];if(u===3)return r[3]>=1&&m[3]<=0?[o+(r[2]<.5?-1*E:E),v]:r[2]<=0&&m[2]>=1?[o,v+(r[3]<.5?-1*O:O)]:[o+-1*E,v+-1*O];if(u===4)return r[3]<=0&&m[3]>=1?[o+(r[2]<.5?-1*E:E),v]:r[2]<=0&&m[2]>=1?[o,v+(r[3]<.5?-1*O:O)]:[o+E,v+-1*O]},S=function(o){o=o||{},this.type="StateMachine";var v=e.Connectors.AbstractBezierConnector.apply(this,arguments),u=o.curviness||10,r=o.margin||5,m=o.proximityLimit||80;o.orientation&&o.orientation;var E;this._computeBezier=function(O,D,y,c,F,k){var B=D.sourcePos[0]<D.targetPos[0]?0:F,M=D.sourcePos[1]<D.targetPos[1]?0:k,A=D.sourcePos[0]<D.targetPos[0]?F:0,I=D.sourcePos[1]<D.targetPos[1]?k:0;D.sourcePos[2]===0&&(B-=r),D.sourcePos[2]===1&&(B+=r),D.sourcePos[3]===0&&(M-=r),D.sourcePos[3]===1&&(M+=r),D.targetPos[2]===0&&(A-=r),D.targetPos[2]===1&&(A+=r),D.targetPos[3]===0&&(I-=r),D.targetPos[3]===1&&(I+=r);var l=(B+A)/2,T=(M+I)/2,x=w(B,M,A,I),R=Math.sqrt(Math.pow(A-B,2)+Math.pow(I-M,2)),G,C,W,V;E=g(l,T,x,D.sourcePos,D.targetPos,u,u,R,m),G=E[0],C=E[0],W=E[1],V=E[1],v.addSegment(this,"Bezier",{x1:A,y1:I,x2:B,y2:M,cp1x:G,cp1y:W,cp2x:C,cp2y:V})}};e.Connectors.StateMachine=S,d.extend(S,e.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w="Straight",g=function(S){this.type=w;var o=e.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(v,u){o.addSegment(this,w,{x1:v.sx,y1:v.sy,x2:v.startStubX,y2:v.startStubY}),o.addSegment(this,w,{x1:v.startStubX,y1:v.startStubY,x2:v.endStubX,y2:v.endStubY}),o.addSegment(this,w,{x1:v.endStubX,y1:v.endStubY,x2:v.tx,y2:v.ty})}};e.Connectors.Straight=g,d.extend(g,e.Connectors.AbstractConnector)}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},g="stroke-dasharray",S="dashstyle",o="linearGradient",v="radialGradient",u="defs",r="fill",m="stop",E="stroke",O="stroke-width",D="style",y="none",c="jsplumb_gradient_",F="strokeWidth",k={svg:"http://www.w3.org/2000/svg"},B=function(V,Y){for(var L in Y)V.setAttribute(L,""+Y[L])},M=function(V,Y){return Y=Y||{},Y.version="1.1",Y.xmlns=k.svg,e.createElementNS(k.svg,V,null,null,Y)},A=function(V){return"position:absolute;left:"+V[0]+"px;top:"+V[1]+"px"},I=function(V){for(var Y=V.querySelectorAll(" defs,linearGradient,radialGradient"),L=0;L<Y.length;L++)Y[L].parentNode.removeChild(Y[L])},l=function(V,Y,L,q,tt){var K=c+tt._jsPlumb.instance.idstamp();I(V);var rt;L.gradient.offset?rt=M(v,{id:K}):rt=M(o,{id:K,gradientUnits:"userSpaceOnUse"});var f=M(u);V.appendChild(f),f.appendChild(rt);for(var _=0;_<L.gradient.stops.length;_++){var h=tt.segment===1||tt.segment===2?_:L.gradient.stops.length-1-_,N=L.gradient.stops[h][1],z=M(m,{offset:Math.floor(L.gradient.stops[_][0]*100)+"%","stop-color":N});rt.appendChild(z)}var U=L.stroke?E:r;Y.setAttribute(U,"url(#"+K+")")},T=function(V,Y,L,q,tt){if(Y.setAttribute(r,L.fill?L.fill:y),Y.setAttribute(E,L.stroke?L.stroke:y),L.gradient?l(V,Y,L,q,tt):(I(V),Y.setAttribute(D,"")),L.strokeWidth&&Y.setAttribute(O,L.strokeWidth),L[S]&&L[F]&&!L[g]){var K=L[S].indexOf(",")===-1?" ":",",rt=L[S].split(K),f="";rt.forEach(function(h){f+=Math.floor(h*L.strokeWidth)+K}),Y.setAttribute(g,f)}else L[g]&&Y.setAttribute(g,L[g]);for(var _ in w)L[_]&&Y.setAttribute(w[_],L[_])},x=function(V,Y,L){V.childNodes.length>L?V.insertBefore(Y,V.childNodes[L]):V.appendChild(Y)};d.svg={node:M,attr:B,pos:A};var R=function(V){var Y=V.pointerEventsSpec||"all",L={};e.jsPlumbUIComponent.apply(this,V.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var q=V.cssClass+" "+(V.originalArgs[0].cssClass||""),tt={style:"",width:0,height:0,"pointer-events":Y,position:"absolute"};this.svg=M("svg",tt),V.useDivWrapper?(this.canvas=e.createElement("div",{position:"absolute"}),d.sizeElement(this.canvas,0,0,1,1),this.canvas.className=q):(B(this.svg,{class:q}),this.canvas=this.svg),V._jsPlumb.appendElement(this.canvas,V.originalArgs[0].parent),V.useDivWrapper&&this.canvas.appendChild(this.svg);var K=[this.canvas];return this.getDisplayElements=function(){return K},this.appendDisplayElement=function(rt){K.push(rt)},this.paint=function(rt,f,_){if(rt!=null){var h=[this.x,this.y],N=[this.w,this.h],z;_!=null&&(_.xmin<0&&(h[0]+=_.xmin),_.ymin<0&&(h[1]+=_.ymin),N[0]=_.xmax+(_.xmin<0?-_.xmin:0),N[1]=_.ymax+(_.ymin<0?-_.ymin:0)),V.useDivWrapper?(d.sizeElement(this.canvas,h[0],h[1],N[0]>0?N[0]:1,N[1]>0?N[1]:1),h[0]=0,h[1]=0,z=A([0,0])):z=A([h[0],h[1]]),L.paint.apply(this,arguments),B(this.svg,{style:z,width:N[0]||1,height:N[1]||1})}},{renderer:L}};d.extend(R,e.jsPlumbUIComponent,{cleanup:function(V){V||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(V){var Y=V.getContainer();this.canvas&&this.canvas.parentNode==null&&Y.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&Y.appendChild(this.bgCanvas)},setVisible:function(V){this.canvas&&(this.canvas.style.display=V?"block":"none")}}),e.ConnectorRenderers.svg=function(V){var Y=this,L=R.apply(this,[{cssClass:V._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:V._jsPlumb}]);L.renderer.paint=function(q,tt,K){var rt=Y.getSegments(),f="",_=[0,0];if(K.xmin<0&&(_[0]=-K.xmin),K.ymin<0&&(_[1]=-K.ymin),rt.length>0){f=Y.getPathData();var h={d:f,transform:"translate("+_[0]+","+_[1]+")","pointer-events":V["pointer-events"]||"visibleStroke"},N=null,z=[Y.x,Y.y,Y.w,Y.h];if(q.outlineStroke){var U=q.outlineWidth||1,nt=q.strokeWidth+2*U;N=e.extend({},q),delete N.gradient,N.stroke=q.outlineStroke,N.strokeWidth=nt,Y.bgPath==null?(Y.bgPath=M("path",h),e.addClass(Y.bgPath,e.connectorOutlineClass),x(Y.svg,Y.bgPath,0)):B(Y.bgPath,h),T(Y.svg,Y.bgPath,N,z,Y)}Y.path==null?(Y.path=M("path",h),x(Y.svg,Y.path,q.outlineStroke?1:0)):B(Y.path,h),T(Y.svg,Y.path,q,z,Y)}}},d.extend(e.ConnectorRenderers.svg,R);var G=e.SvgEndpoint=function(V){var Y=R.apply(this,[{cssClass:V._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:V._jsPlumb}]);Y.renderer.paint=function(L){var q=e.extend({},L);q.outlineStroke&&(q.stroke=q.outlineStroke),this.node==null?(this.node=this.makeNode(q),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),T(this.svg,this.node,q,[this.x,this.y,this.w,this.h],this),A(this.node,[this.x,this.y])}.bind(this)};d.extend(G,R),e.Endpoints.svg.Dot=function(){e.Endpoints.Dot.apply(this,arguments),G.apply(this,arguments),this.makeNode=function(V){return M("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(V){B(V,{cx:this.w/2,cy:this.h/2,r:this.radius})}},d.extend(e.Endpoints.svg.Dot,[e.Endpoints.Dot,G]),e.Endpoints.svg.Rectangle=function(){e.Endpoints.Rectangle.apply(this,arguments),G.apply(this,arguments),this.makeNode=function(V){return M("rect",{width:this.w,height:this.h})},this.updateNode=function(V){B(V,{width:this.w,height:this.h})}},d.extend(e.Endpoints.svg.Rectangle,[e.Endpoints.Rectangle,G]),e.Endpoints.svg.Image=e.Endpoints.Image,e.Endpoints.svg.Blank=e.Endpoints.Blank,e.Overlays.svg.Label=e.Overlays.Label,e.Overlays.svg.Custom=e.Overlays.Custom;var C=function(V,Y){V.apply(this,Y),e.jsPlumbUIComponent.apply(this,Y),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(q,tt){if(q.component.svg&&tt){this.path==null&&(this.path=M("path",{"pointer-events":"all"}),q.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,q.component),this.canvas=q.component.svg);var K=Y&&Y.length===1&&Y[0].cssClass||"",rt=[0,0];tt.xmin<0&&(rt[0]=-tt.xmin),tt.ymin<0&&(rt[1]=-tt.ymin),B(this.path,{d:L(q.d),class:K,stroke:q.stroke?q.stroke:null,fill:q.fill?q.fill:null,transform:"translate("+rt[0]+","+rt[1]+")"})}};var L=function(q){return isNaN(q.cxy.x)||isNaN(q.cxy.y)?"":"M"+q.hxy.x+","+q.hxy.y+" L"+q.tail[0].x+","+q.tail[0].y+" L"+q.cxy.x+","+q.cxy.y+" L"+q.tail[1].x+","+q.tail[1].y+" L"+q.hxy.x+","+q.hxy.y};this.transfer=function(q){q.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),q.canvas.appendChild(this.path))}},W={cleanup:function(V){this.path!=null&&(V?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(V,Y){this.path&&Y.canvas&&Y.canvas.appendChild(this.path)},setVisible:function(V){this.path!=null&&(this.path.style.display=V?"block":"none")}};d.extend(C,[e.jsPlumbUIComponent,e.Overlays.AbstractOverlay]),e.Overlays.svg.Arrow=function(){C.apply(this,[e.Overlays.Arrow,arguments])},d.extend(e.Overlays.svg.Arrow,[e.Overlays.Arrow,C],W),e.Overlays.svg.PlainArrow=function(){C.apply(this,[e.Overlays.PlainArrow,arguments])},d.extend(e.Overlays.svg.PlainArrow,[e.Overlays.PlainArrow,C],W),e.Overlays.svg.Diamond=function(){C.apply(this,[e.Overlays.Diamond,arguments])},d.extend(e.Overlays.svg.Diamond,[e.Overlays.Diamond,C],W),e.Overlays.svg.GuideLines=function(){var V=null,Y=this,L,q;e.Overlays.GuideLines.apply(this,arguments),this.paint=function(K,rt){V==null&&(V=M("path"),K.connector.svg.appendChild(V),Y.attachListeners(V,K.connector),Y.attachListeners(V,Y),L=M("path"),K.connector.svg.appendChild(L),Y.attachListeners(L,K.connector),Y.attachListeners(L,Y),q=M("path"),K.connector.svg.appendChild(q),Y.attachListeners(q,K.connector),Y.attachListeners(q,Y));var f=[0,0];rt.xmin<0&&(f[0]=-rt.xmin),rt.ymin<0&&(f[1]=-rt.ymin),B(V,{d:tt(K.head,K.tail),stroke:"red",fill:null,transform:"translate("+f[0]+","+f[1]+")"}),B(L,{d:tt(K.tailLine[0],K.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+f[0]+","+f[1]+")"}),B(q,{d:tt(K.headLine[0],K.headLine[1]),stroke:"green",fill:null,transform:"translate("+f[0]+","+f[1]+")"})};var tt=function(K,rt){return"M "+K.x+","+K.y+" L"+rt.x+","+rt.y}},d.extend(e.Overlays.svg.GuideLines,e.Overlays.GuideLines)}.call(typeof window<"u"?window:ne),function(){var i=this,e=i.jsPlumb,d=i.jsPlumbUtil,w=i.Katavorio,g=i.Biltong,S=function(l){var T=l._mottle;return T||(T=l._mottle=new i.Mottle),T},o=function(l,T){T=T||"main";var x="_katavorio_"+T,R=l[x],G=l.getEventManager();return R||(R=new w({bind:G.on,unbind:G.off,getSize:e.getSize,getConstrainingRectangle:function(C){return[C.parentNode.scrollWidth,C.parentNode.scrollHeight]},getPosition:function(C,W){var V=l.getOffset(C,W,C._katavorioDrag?C.offsetParent:null);return[V.left,V.top]},setPosition:function(C,W){C.style.left=W[0]+"px",C.style.top=W[1]+"px"},addClass:e.addClass,removeClass:e.removeClass,intersects:g.intersects,indexOf:function(C,W){return C.indexOf(W)},scope:l.getDefaultScope(),css:{noSelect:l.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),R.setZoom(l.getZoom()),l[x]=R,l.bind("zoom",R.setZoom)),R},v=function(l){var T=l.el._jsPlumbDragOptions,x=!0;return T.canDrag&&(x=T.canDrag()),x&&(this.setHoverSuspended(!0),this.select({source:l.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:l.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),x},u=function(l){var T=this.getUIPosition(arguments,this.getZoom());if(T!=null){var x=l.el._jsPlumbDragOptions;this.draw(l.el,T,null,!0),x._dragging&&this.addClass(l.el,"jtk-dragged"),x._dragging=!0}},r=function(l){for(var T=l.selection,x,R=function(C){var W;C[1]!=null&&(x=this.getUIPosition([{el:C[2].el,pos:[C[1].left,C[1].top]}]),W=this.draw(C[2].el,x)),C[0]._jsPlumbDragOptions!=null&&delete C[0]._jsPlumbDragOptions._dragging,this.removeClass(C[0],"jtk-dragged"),this.select({source:C[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:C[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),l.e._drawResult=l.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(l.e._drawResult.c,W.c),Array.prototype.push.apply(l.e._drawResult.e,W.e),Array.prototype.push.apply(l.e._drawResult.a,W.a),this.getDragManager().dragEnded(C[2].el)}.bind(this),G=0;G<T.length;G++)R(T[G]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},m=function(l,T){var x=function(R){if(T[R]!=null)if(d.isString(T[R])){var G=T[R].match(/-=/)?-1:1,C=T[R].substring(2);return l[R]+G*C}else return T[R];else return l[R]};return[x("left"),x("top")]},E=function(l,T){if(T==null)return[0,0];var x=F(T),R=c(x,0);return[R[l+"X"],R[l+"Y"]]},O=E.bind(this,"page"),D=E.bind(this,"screen"),y=E.bind(this,"client"),c=function(l,T){return l.item?l.item(T):l[T]},F=function(l){return l.touches&&l.touches.length>0?l.touches:l.changedTouches&&l.changedTouches.length>0?l.changedTouches:l.targetTouches&&l.targetTouches.length>0?l.targetTouches:[l]},k=function(l){var T={},x=[],R={},G={},C={};this.register=function(W){var V=l.getId(W),Y;T[V]||(T[V]=W,x.push(W),R[V]={});var L=function(q){if(q){for(var tt=0;tt<q.childNodes.length;tt++)if(q.childNodes[tt].nodeType!==3&&q.childNodes[tt].nodeType!==8){var K=jsPlumb.getElement(q.childNodes[tt]),rt=l.getId(q.childNodes[tt],null,!0);if(rt&&G[rt]&&G[rt]>0){Y||(Y=l.getOffset(W));var f=l.getOffset(K);R[V][rt]={id:rt,offset:{left:f.left-Y.left,top:f.top-Y.top}},C[rt]=V}L(q.childNodes[tt])}}};L(W)},this.updateOffsets=function(W,V){if(W!=null){V=V||{};var Y=jsPlumb.getElement(W),L=l.getId(Y),q=R[L],tt;if(q){for(var K in q)if(q.hasOwnProperty(K)){var rt=jsPlumb.getElement(K),f=V[K]||l.getOffset(rt);if(rt.offsetParent==null&&R[L][K]!=null)continue;tt||(tt=l.getOffset(Y)),R[L][K]={id:K,offset:{left:f.left-tt.left,top:f.top-tt.top}},C[K]=L}}}},this.endpointAdded=function(W,V){V=V||l.getId(W);var Y=document.body,L=W.parentNode;for(G[V]=G[V]?G[V]+1:1;L!=null&&L!==Y;){var q=l.getId(L,null,!0);if(q&&T[q]){var tt=l.getOffset(L);if(R[q][V]==null){var K=l.getOffset(W);R[q][V]={id:V,offset:{left:K.left-tt.left,top:K.top-tt.top}},C[V]=q}break}L=L.parentNode}},this.endpointDeleted=function(W){if(G[W.elementId]&&(G[W.elementId]--,G[W.elementId]<=0))for(var V in R)R.hasOwnProperty(V)&&R[V]&&(delete R[V][W.elementId],delete C[W.elementId])},this.changeId=function(W,V){R[V]=R[W],R[W]={},C[V]=C[W],C[W]=null},this.getElementsForDraggable=function(W){return R[W]},this.elementRemoved=function(W){var V=C[W];V&&(R[V]&&delete R[V][W],delete C[W])},this.reset=function(){T={},x=[],R={},G={}},this.dragEnded=function(W){if(W.offsetParent!=null){var V=l.getId(W),Y=C[V];Y&&this.updateOffsets(Y)}},this.setParent=function(W,V,Y,L,q){var tt=C[V];R[L]||(R[L]={});var K=l.getOffset(Y),rt=q||l.getOffset(W);tt&&R[tt]&&delete R[tt][V],R[L][V]={id:V,offset:{left:rt.left-K.left,top:rt.top-K.top}},C[V]=L},this.clearParent=function(W,V){var Y=C[V];Y&&(delete R[Y][V],delete C[V])},this.revalidateParent=function(W,V,Y){var L=C[V];if(L){var q={};q[V]=Y,this.updateOffsets(L,q),l.revalidate(L)}},this.getDragAncestor=function(W){var V=jsPlumb.getElement(W),Y=l.getId(V),L=C[Y];return L?jsPlumb.getElement(L):null}},B=function(l,T,x){T=d.fastTrim(T),typeof l.className.baseVal<"u"?l.className.baseVal=T:l.className=T;try{var R=l.classList;if(R!=null){for(;R.length>0;)R.remove(R.item(0));for(var G=0;G<x.length;G++)x[G]&&R.add(x[G])}}catch(C){d.log("JSPLUMB: cannot set class list",C)}},M=function(l){return typeof l.className.baseVal>"u"?l.className:l.className.baseVal},A=function(l,T,x){T=T==null?[]:d.isArray(T)?T:T.split(/\s+/),x=x==null?[]:d.isArray(x)?x:x.split(/\s+/);var R=M(l),G=R.split(/\s+/),C=function(W,V){for(var Y=0;Y<V.length;Y++)if(W)G.indexOf(V[Y])===-1&&G.push(V[Y]);else{var L=G.indexOf(V[Y]);L!==-1&&G.splice(L,1)}};C(!0,T),C(!1,x),B(l,G.join(" "),G)};i.jsPlumb.extend(i.jsPlumbInstance.prototype,{headless:!1,pageLocation:O,screenLocation:D,clientLocation:y,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new k(this)),this.dragManager},recalculateOffsets:function(l){this.getDragManager().updateOffsets(l)},createElement:function(l,T,x,R){return this.createElementNS(null,l,T,x,R)},createElementNS:function(l,T,x,R,G){var C=l==null?document.createElement(T):document.createElementNS(l,T),W;x=x||{};for(W in x)C.style[W]=x[W];R&&(C.className=R),G=G||{};for(W in G)C.setAttribute(W,""+G[W]);return C},getAttribute:function(l,T){return l.getAttribute!=null?l.getAttribute(T):null},setAttribute:function(l,T,x){l.setAttribute!=null&&l.setAttribute(T,x)},setAttributes:function(l,T){for(var x in T)T.hasOwnProperty(x)&&l.setAttribute(x,T[x])},appendToRoot:function(l){document.body.appendChild(l)},getRenderModes:function(){return["svg"]},getClass:M,addClass:function(l,T){jsPlumb.each(l,function(x){A(x,T)})},hasClass:function(l,T){return l=jsPlumb.getElement(l),l.classList?l.classList.contains(T):M(l).indexOf(T)!==-1},removeClass:function(l,T){jsPlumb.each(l,function(x){A(x,null,T)})},toggleClass:function(l,T){jsPlumb.hasClass(l,T)?jsPlumb.removeClass(l,T):jsPlumb.addClass(l,T)},updateClasses:function(l,T,x){jsPlumb.each(l,function(R){A(R,T,x)})},setClass:function(l,T){T!=null&&jsPlumb.each(l,function(x){B(x,T,T.split(/\s+/))})},setPosition:function(l,T){l.style.left=T.left+"px",l.style.top=T.top+"px"},getPosition:function(l){var T=function(x){var R=l.style[x];return R?R.substring(0,R.length-2):0};return{left:T("left"),top:T("top")}},getStyle:function(l,T){return typeof window.getComputedStyle<"u"?getComputedStyle(l,null).getPropertyValue(T):l.currentStyle[T]},getSelector:function(l,T){var x=null;return arguments.length===1?x=l.nodeType!=null?l:document.querySelectorAll(l):x=l.querySelectorAll(T),x},getOffset:function(l,T,x){l=jsPlumb.getElement(l),x=x||this.getContainer();for(var R={left:l.offsetLeft,top:l.offsetTop},G=T||x!=null&&l!==x&&l.offsetParent!==x?l.offsetParent:null,C=function(Y){Y!=null&&Y!==document.body&&(Y.scrollTop>0||Y.scrollLeft>0)&&(R.left-=Y.scrollLeft,R.top-=Y.scrollTop)}.bind(this);G!=null;)R.left+=G.offsetLeft,R.top+=G.offsetTop,C(G),G=T?G.offsetParent:G.offsetParent===x?null:G.offsetParent;if(x!=null&&!T&&(x.scrollTop>0||x.scrollLeft>0)){var W=l.offsetParent!=null?this.getStyle(l.offsetParent,"position"):"static",V=this.getStyle(l,"position");V!=="absolute"&&V!=="fixed"&&W!=="absolute"&&W!=="fixed"&&(R.left-=x.scrollLeft,R.top-=x.scrollTop)}return R},getPositionOnElement:function(l,T,x){var R=typeof T.getBoundingClientRect<"u"?T.getBoundingClientRect():{left:0,top:0,width:0,height:0},G=document.body,C=document.documentElement,W=window.pageYOffset||C.scrollTop||G.scrollTop,V=window.pageXOffset||C.scrollLeft||G.scrollLeft,Y=C.clientTop||G.clientTop||0,L=C.clientLeft||G.clientLeft||0,q=0,tt=0,K=R.top+W-Y+q*x,rt=R.left+V-L+tt*x,f=jsPlumb.pageLocation(l),_=R.width||T.offsetWidth*x,h=R.height||T.offsetHeight*x,N=(f[0]-rt)/_,z=(f[1]-K)/h;return[N,z]},getAbsolutePosition:function(l){var T=function(x){var R=l.style[x];if(R)return parseFloat(R.substring(0,R.length-2))};return[T("left"),T("top")]},setAbsolutePosition:function(l,T,x,R){x?this.animate(l,{left:"+="+(T[0]-x[0]),top:"+="+(T[1]-x[1])},R):(l.style.left=T[0]+"px",l.style.top=T[1]+"px")},getSize:function(l){return[l.offsetWidth,l.offsetHeight]},getWidth:function(l){return l.offsetWidth},getHeight:function(l){return l.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(l,T){var x;return l=d.isArray(l)||l.length!=null&&!d.isString(l)?l:[l],Array.prototype.slice.call(l).forEach(function(R){x=this.info(R),x.el&&this._initDraggableIfNecessary(x.el,!0,T,x.id,!0)}.bind(this)),this},snapToGrid:function(l,T,x){var R=[],G=function(V){var Y=this.info(V);if(Y.el!=null&&Y.el._katavorioDrag){var L=Y.el._katavorioDrag.snap(T,x);this.revalidate(Y.el),R.push([Y.el,L])}}.bind(this);if(arguments.length===1||arguments.length===3)G(l,T,x);else{var C=this.getManagedElements();for(var W in C)G(W,arguments[0],arguments[1])}return R},initDraggable:function(l,T,x){o(this,x).draggable(l,T),l._jsPlumbDragOptions=T},destroyDraggable:function(l,T){o(this,T).destroyDraggable(l),l._jsPlumbDragOptions=null,l._jsPlumbRelatedElement=null},unbindDraggable:function(l,T,x,R){o(this,R).destroyDraggable(l,T,x)},setDraggable:function(l,T){return jsPlumb.each(l,function(x){this.isDragSupported(x)&&(this._draggableStates[this.getAttribute(x,"id")]=T,this.setElementDraggable(x,T))}.bind(this))},_draggableStates:{},toggleDraggable:function(l){var T;return jsPlumb.each(l,function(x){var R=this.getAttribute(x,"id");return T=this._draggableStates[R]==null?!1:this._draggableStates[R],T=!T,this._draggableStates[R]=T,this.setDraggable(x,T),T}.bind(this)),T},_initDraggableIfNecessary:function(l,T,x,R,G){if(!jsPlumb.headless){var C=T??!1;if(C&&jsPlumb.isDragSupported(l,this)){var W=x||this.Defaults.DragOptions;if(W=jsPlumb.extend({},W),jsPlumb.isAlreadyDraggable(l,this))x.force&&this.initDraggable(l,W);else{var V=jsPlumb.dragEvents.drag,Y=jsPlumb.dragEvents.stop,L=jsPlumb.dragEvents.start;this.manage(R,l),W[L]=d.wrap(W[L],v.bind(this)),W[V]=d.wrap(W[V],u.bind(this)),W[Y]=d.wrap(W[Y],r.bind(this));var q=this.getId(l);this._draggableStates[q]=!0;var tt=this._draggableStates[q];W.disabled=tt==null?!1:!tt,this.initDraggable(l,W),this.getDragManager().register(l),G&&this.fire("elementDraggable",{el:l,options:W})}}}},animationSupported:!0,getElement:function(l){return l==null?null:(l=typeof l=="string"?l:l.tagName==null&&l.length!=null&&l.enctype==null?l[0]:l,typeof l=="string"?document.getElementById(l):l)},removeElement:function(l){o(this).elementRemoved(l),this.getEventManager().remove(l)},doAnimate:function(l,T,x){x=x||{};var R=this.getOffset(l),G=m(R,T),C=G[0]-R.left,W=G[1]-R.top,V=x.duration||250,Y=15,L=V/Y,q=Y/V*C,tt=Y/V*W,K=0,rt=setInterval(function(){e.setPosition(l,{left:R.left+q*(K+1),top:R.top+tt*(K+1)}),x.step!=null&&x.step(K,Math.ceil(L)),K++,K>=L&&(window.clearInterval(rt),x.complete!=null&&x.complete())},Y)},destroyDroppable:function(l,T){o(this,T).destroyDroppable(l)},unbindDroppable:function(l,T,x,R){o(this,R).destroyDroppable(l,T,x)},droppable:function(l,T){l=d.isArray(l)||l.length!=null&&!d.isString(l)?l:[l];var x;return T=T||{},T.allowLoopback=!1,Array.prototype.slice.call(l).forEach(function(R){x=this.info(R),x.el&&this.initDroppable(x.el,T)}.bind(this)),this},initDroppable:function(l,T,x){o(this,x).droppable(l,T)},isAlreadyDraggable:function(l){return l._katavorioDrag!=null},isDragSupported:function(l,T){return!0},isDropSupported:function(l,T){return!0},isElementDraggable:function(l){return l=e.getElement(l),l._katavorioDrag&&l._katavorioDrag.isEnabled()},getDragObject:function(l){return l[0].drag.getDragElement()},getDragScope:function(l){return l._katavorioDrag&&l._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(l){return l[0].e},getUIPosition:function(l,T){var x=l[0].el;if(x.offsetParent==null)return null;var R=l[0].finalPos||l[0].pos,G={left:R[0],top:R[1]};if(x._katavorioDrag&&x.offsetParent!==this.getContainer()){var C=this.getOffset(x.offsetParent);G.left+=C.left,G.top+=C.top}return G},setDragFilter:function(l,T,x){l._katavorioDrag&&l._katavorioDrag.setFilter(T,x)},setElementDraggable:function(l,T){l=e.getElement(l),l._katavorioDrag&&l._katavorioDrag.setEnabled(T)},setDragScope:function(l,T){l._katavorioDrag&&l._katavorioDrag.k.setDragScope(l,T)},setDropScope:function(l,T){l._katavorioDrop&&l._katavorioDrop.length>0&&l._katavorioDrop[0].k.setDropScope(l,T)},addToPosse:function(l,T){var x=Array.prototype.slice.call(arguments,1),R=o(this);e.each(l,function(G){G=[e.getElement(G)],G.push.apply(G,x),R.addToPosse.apply(R,G)})},setPosse:function(l,T){var x=Array.prototype.slice.call(arguments,1),R=o(this);e.each(l,function(G){G=[e.getElement(G)],G.push.apply(G,x),R.setPosse.apply(R,G)})},removeFromPosse:function(l,T){var x=Array.prototype.slice.call(arguments,1),R=o(this);e.each(l,function(G){G=[e.getElement(G)],G.push.apply(G,x),R.removeFromPosse.apply(R,G)})},removeFromAllPosses:function(l){var T=o(this);e.each(l,function(x){T.removeFromAllPosses(e.getElement(x))})},setPosseState:function(l,T,x){var R=o(this);e.each(l,function(G){R.setPosseState(e.getElement(G),T,x)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(l){l._katavorioDrag&&l._katavorioDrag.abort()},addToDragSelection:function(l){var T=this.getElement(l);T!=null&&(T._isJsPlumbGroup||T._jsPlumbGroup==null)&&o(this).select(l)},removeFromDragSelection:function(l){o(this).deselect(l)},getDragSelection:function(){return o(this).getSelection()},clearDragSelection:function(){o(this).deselectAll()},trigger:function(l,T,x,R){this.getEventManager().trigger(l,T,x,R)},doReset:function(){for(var l in this)l.indexOf("_katavorio_")===0&&this[l].reset()},getEventManager:function(){return S(this)},on:function(l,T,x){return this.getEventManager().on.apply(this,arguments),this},off:function(l,T,x){return this.getEventManager().off.apply(this,arguments),this}});var I=function(l){var T=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?l():setTimeout(T,9)};T()};I(e.init)}.call(typeof window<"u"?window:ne)})(ka);var Aa=Object.defineProperty,Da=(a,i,e)=>i in a?Aa(a,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[i]=e,Jn=(a,i,e)=>(Da(a,typeof i!="symbol"?i+"":i,e),e);class Js{constructor(i,e){Jn(this,"element"),Jn(this,"options"),Jn(this,"isVisible",!1),Jn(this,"hideTimeoutId",null),this.element=i,this.options=e,this.init()}init(){this.element.style.position="relative",this.element.setAttribute("data-tooltip",this.options.text),this.element.setAttribute("data-tooltip-position",this.options.position),this.element.classList.add("tooltip-trigger"),this.options.tooltipClass&&this.element.classList.add(this.options.tooltipClass),this.options.showWhen==="hover"?(this.element.addEventListener("mouseenter",()=>this.show()),this.element.addEventListener("mouseleave",()=>this.hide())):this.options.showWhen==="click"&&(this.element.addEventListener("click",()=>this.toggle()),document.addEventListener("click",i=>{this.element.contains(i.target)||this.hide()}))}show(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!0,this.element.classList.add("tooltip-active")}hide(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!1,this.element.classList.remove("tooltip-active")}toggle(){this.isVisible?this.hide():this.show()}destroy(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.element.removeAttribute("data-tooltip"),this.element.removeAttribute("data-tooltip-position"),this.element.classList.remove("tooltip-trigger","tooltip-active"),this.options.tooltipClass&&this.element.classList.remove(this.options.tooltipClass)}}var Ta=(a=>(a.LOGS="logs",a.SOURCE="source",a.NETWORK="network",a))(Ta||{});$t.createContext(null);const Oa=$t.forwardRef(({className:a,...i},e)=>ht.jsx(vn.List,{ref:e,className:Li("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...i}));Oa.displayName=vn.List.displayName;const La=$t.forwardRef(({className:a,...i},e)=>ht.jsx(vn.Trigger,{ref:e,className:Li("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...i}));La.displayName=vn.Trigger.displayName;const ja=$t.forwardRef(({className:a,...i},e)=>ht.jsx(vn.Content,{ref:e,className:Li("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i}));ja.displayName=vn.Content.displayName;const Ma=$t.createContext(void 0);window.__SHARED_APP_STATE__||(window.__SHARED_APP_STATE__={isDeployModalOpen:!1,isShareAgentModalOpen:!1});const xi="APP_STATE_CHANGED",Ia=({children:a})=>{const[i,e]=$t.useState(window.__SHARED_APP_STATE__.isDeployModalOpen),[d,w]=$t.useState(window.__SHARED_APP_STATE__.isShareAgentModalOpen),g=(o,v,u)=>{window.__SHARED_APP_STATE__[o]=v,u(v),window.dispatchEvent(new CustomEvent(xi))};$t.useEffect(()=>{const o=()=>{const{isDeployModalOpen:v,isShareAgentModalOpen:u}=window.__SHARED_APP_STATE__;v!==i&&e(v),u!==d&&w(u)};return window.addEventListener(xi,o),()=>window.removeEventListener(xi,o)},[i,d]),$t.useEffect(()=>{window.handleDeployModalOpen=o=>{g("isDeployModalOpen",o,e)},window.handleShareAgentModalOpen=o=>{g("isShareAgentModalOpen",o,w)}},[]);const S={isDeployModalOpen:i,setIsDeployModalOpen:o=>g("isDeployModalOpen",o,e),toggleDeployModal:()=>g("isDeployModalOpen",!i,e),isShareAgentModalOpen:d,setIsShareAgentModalOpen:o=>g("isShareAgentModalOpen",o,w),toggleShareAgentModal:()=>g("isShareAgentModalOpen",!d,w)};return ht.jsx(Ma.Provider,{value:S,children:a})};$t.createContext(null);const Zs=$t.createContext(void 0),Na=({children:a,mode:i})=>{const e=$t.useRef(null),[d,w]=$t.useState(null),[g,S]=$t.useState([]),[o,v]=$t.useState("form"),[u,r]=$t.useState(null),[m,E]=$t.useState(null),[O,D]=$t.useState([]);$t.useEffect(()=>{D([...i.props.defaultSkill?.details?.skillErrors?.errors||[]]);function B(M){D([...M])}return i.props.defaultSkill?.details?.skillErrors?.on("changed",B),()=>{i.props.defaultSkill?.details?.skillErrors?.off("changed",B)}},[i]);const y=async B=>Promise.reject("Not implemented"),c=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),F=_i({mutationFn:async B=>(e.current?.abort(),e.current=new AbortController,await fetch(`/api/page/builder/ai-agent/${i.props.agentId}/skill-call`,{method:"POST",body:JSON.stringify({payload:B,componentId:d?.skillId,version:"dev"}),signal:e.current?.signal,headers:{"Content-Type":"application/json","X-MONITOR-ID":window.currentMonitorId}}).then(M=>M.json()).then(M=>(console.log("setLastResponse",M),E(M),M))),mutationKey:["call_skill",d?.skillId]}),k={selectedSkill:d,setSelectedSkill:w,requests:g,setRequests:S,getSkill:y,mode:i,uuid:c,callSkillMutation:F,view:o,setView:v,lastFormValues:u,setLastFormValues:r,abortController:e,lastResponse:m,agentSkillErrors:O};return ht.jsx(Zs.Provider,{value:k,children:a})},ci=()=>{const a=$t.useContext(Zs);if(a===void 0)throw new Error("useEndpointFormPreview must be used within a EndpointFormPreviewProvider");return a},Fa=({setIsFormVisible:a})=>{const i=$t.useRef(null),{selectedSkill:e,callSkillMutation:d,setView:w,setLastFormValues:g,mode:S,agentSkillErrors:o}=ci(),v=ro(e?.inputsTypes),u=async(m,{resetForm:E})=>{a(!1),ao.track("app_form_preview_run_button_click",{}),d.mutate(m,{onSuccess:()=>{ls.track("app_workflow_test_completed",{status:"success",source:"form preview"}),g(m),w("home")},onError:()=>{ls.track("app_workflow_test_completed",{status:"failed",source:"form preview"}),g(m),w("home")}})};$t.useEffect(()=>{!d.isLoading&&o.length>0&&a(!0)},[d.isLoading,o]),$t.useEffect(()=>{i.current&&i.current.focus()},[i]);const r=e?.inputsTypes.reduce((m,E)=>({...m,[E.name]:e?.autoFillDataJson?.[E.name]||""}),{});return ht.jsxs("div",{children:[ht.jsx(Fs,{initialValues:r,validationSchema:v,onSubmit:u,enableReinitialize:!0,children:({resetForm:m,isSubmitting:E,dirty:O,setFieldValue:D,isValid:y,values:c,errors:F,handleChange:k,handleBlur:B,touched:M})=>ht.jsxs(Rs,{className:"flex flex-col justify-between mt-2 gap-4",children:[e?.inputsTypes.map(A=>ht.jsx(oo,{placeholder:"value",input:A,error:F[A.name]&&M[A.name]&&(console.log(M,F)||!0)&&typeof F[A.name]=="string"&&F[A.name],value:c[A.name]||"",onChange:k,onBlur:B,onFocus:I=>{const l=c[A.name],T=e?.autoFillDataJson?.[A.name];l===T&&I.target.select()},fileOps:{inputVersion:"v2",onChange:I=>{D(A.name,I)}},...A},A.name)),ht.jsx("div",{className:"flex gap-3 mt-4 ",children:ht.jsx(Ln,{type:"submit",className:"justify-center flex-1",disabled:d.isLoading||o.length>0,btnRef:i,label:"Run",variant:"primary",fullWidth:!0,dataAttributes:{"data-test":"form-preview-run-button"}})})]})}),ht.jsx("div",{className:"flex flex-col gap-2 mt-4",children:o.map(m=>ht.jsx("div",{className:"text-gray-500",children:m.error_message},m.error_slug))})]})};function Ra(a){return a?a.startsWith("image/")?"image":a.startsWith("audio/")?"audio":a.startsWith("video/")?"video":a.startsWith("text/")?"text":a.startsWith("application/")?"application":"other":"unknown"}function $a(a){try{const i=new URL(a).pathname,e=i.lastIndexOf(".");return e===-1||e===i.length-1?"":i.slice(e).toLowerCase()}catch(i){return console.error("Invalid URL:",i),""}}const Ba=a=>{const i={".html":"text/html",".css":"text/css",".js":"application/javascript",".json":"application/json",".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".svg":"image/svg+xml",".webp":"image/webp",".bmp":"image/bmp",".tif":"image/tiff",".tiff":"image/tiff",".ico":"image/vnd.microsoft.icon",".avif":"image/avif",".heif":"image/heif",".heic":"image/heic",".mp4":"video/mp4",".mp3":"audio/mpeg",".wav":"audio/wav",".pdf":"application/pdf",".txt":"text/plain",".xml":"application/xml",".zip":"application/zip",".tar":"application/x-tar",".gz":"application/gzip"},e=$a(a);return e?{mimetype:i[e]}:{mimetype:""}},qa=({asset:a})=>{const[i,e]=$t.useState({isContentLoaded:!1,fileType:""}),[d,w]=$t.useState(!1),g=()=>{e({...i,isContentLoaded:!0})};$t.useEffect(()=>{async function o(v){try{const u=Ba(v.trim());if(!u.mimetype)return;let r=Ra(u.mimetype)||"";e(m=>({...m,fileType:r}))}catch(u){console.error(u)}}o(a)},[a]);let S;switch(i.fileType){case"image":S=ht.jsx("div",{children:ht.jsx("img",{src:a,className:"max-w-full m-auto rounded-lg",onError:g,onLoad:g})});break;case"audio":S=ht.jsx("audio",{controls:!0,crossOrigin:"anonymous",src:a,className:"max-w-full m-auto",onError:g,onCanPlay:g});break;case"video":S=ht.jsxs("video",{controls:!0,className:"max-w-full m-auto",onError:g,onCanPlay:g,children:[ht.jsx("source",{src:a,type:"video/mp4"}),"Your browser does not support the video tag."]});break;case"pdf":S=ht.jsx("embed",{src:a+"#toolbar=0",type:"application/pdf",className:"w-full h-[80vh]",onError:g,onLoad:g});break;default:S=ht.jsx("div",{className:"text-center",children:ht.jsx("a",{href:a,target:"_blank",download:!0,className:"btn btn-primary fallback-file-download-link font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Download File"})});break}return ht.jsxs("div",{className:"mt-5 relative",children:[!i.isContentLoaded&&ht.jsx("div",{className:"h-1 mt-1",children:ht.jsx("div",{"data-role":"progress","data-type":"line","data-small":"true","data-cls-back":"bg-gray-300",className:"file-preloader h-1"})}),ht.jsx("div",{className:ze("mt-4 transition-opacity duration-300",{"opacity-0":!i.isContentLoaded}),children:S}),ht.jsxs("div",{className:"mt-5 relative",children:[ht.jsx($s,{name:"rawContent",type:"text",defaultValue:a,readOnly:!0,className:"text-gray-800"}),ht.jsx("div",{className:ze("absolute right-2 flex gap-2 top-1/2 -translate-y-1/2"),children:ht.jsx("span",{onClick:()=>{navigator.clipboard.writeText(a),w(!0)},onMouseLeave:()=>{w(!1)},className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900",children:d?ht.jsx(lo,{}):ht.jsx(co,{})})})]})]})},za=()=>{const{callSkillMutation:a,lastFormValues:i,abortController:e,lastResponse:d,mode:w,agentSkillErrors:g}=ci(),[S,o]=$t.useState(!1),v=$t.useRef(null),u=w.props.dbg_url;$t.useEffect(()=>{v.current&&(v.current.style.height="auto",v.current.style.height=Math.min(v.current.scrollHeight,400)+"px")},[v]);const r=D=>{const y=/\b(?:https?|ftp):\/\/[^\s/$.?#].[^\s]*(?:\.(?:jpg|jpeg|png|gif|bmp|webp|svg|mp3|wav|flac|aac|mp4|mkv|mov|avi|webm|ogg|m4a|m4v|m3u8|ts|wmv))(?:\?[^\s"']*)?\b|\bsmythfs:\/\/[^\s/$.?#].[^\s"']*\b/g,c=D.match(y)?.map(F=>F.trim())?.map(F=>F.startsWith("smythfs://")?`${u}/file-proxy?url=${F}`:F)||[];return[...new Set(c)]};function m(D){return typeof D=="string"?D:JSON.stringify(D,null,2)}const E=$t.useMemo(()=>d?.response?r(m(d?.response)):[],[d]),O=()=>{const D=new Blob([d?.response],{type:"text/plain"}),y=URL.createObjectURL(D),c=document.createElement("a");c.href=y,c.download="output.txt",c.click()};return ht.jsxs("div",{children:[a.isLoading&&ht.jsx("button",{onClick:()=>{e.current?.abort()},className:"bg-transparent font-bold border border-gray-300 text-gray-500 px-4 py-3 rounded-md w-full mt-4",children:"Stop Testing"}),g.length>0&&ht.jsx("div",{className:"flex flex-col gap-2 mt-4",children:g.map(D=>ht.jsx("div",{className:"text-gray-500",children:D.error_message},D.error_slug))}),ht.jsxs("div",{className:"mt-8",children:[d&&ht.jsxs("div",{children:[ht.jsx("h3",{className:"font-semibold",children:"Agent Output"}),ht.jsx("div",{className:"text-sm",children:ht.jsxs("div",{children:[E.map(D=>ht.jsx(qa,{asset:D},D)),ht.jsxs("div",{className:"mt-5 relative",children:[ht.jsx(Bs,{ref:v,readOnly:!0,className:" text-gray-800 resize-none",defaultValue:m(d?.response),rows:10}),ht.jsxs("div",{className:ze("absolute right-2 flex gap-2 top-2 [&:hover_actionicons]:opacity-100"),children:[ht.jsx("span",{onClick:O,className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900 opacity-50 hover:opacity-100",children:ht.jsx(uo,{})}),ht.jsx("span",{onClick:()=>{navigator.clipboard.writeText(m(d?.response)),o(!0)},onMouseLeave:()=>{o(!1)},className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900 opacity-50 hover:opacity-100",children:S?ht.jsx(ho,{}):ht.jsx(po,{})})]})]})]})})]}),ht.jsxs("div",{className:"py-4 text-gray-500",children:["Something went wrong? try"," ",ht.jsx("span",{className:"font-semibold border-b border-gray-500 border-solid pb-0.5 cursor-pointer",onClick:()=>{const D=document.querySelector(".debug-switcher");D&&!D?.classList.contains("active")&&D.dispatchEvent(new Event("click",{bubbles:!0}))},children:"debugging"})," ","to fix errors."]}),a.isError&&ht.jsxs("div",{children:[ht.jsx("h3",{className:"font-semibold",children:"Error"}),ht.jsx("div",{children:typeof a?.error?.error=="string"?a?.error?.error:"We encountered an error while processing your request. Please try again later."})]})]})]})};function Va(a){return qs({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M134,32V64a6,6,0,0,1-12,0V32a6,6,0,0,1,12,0Zm39.25,56.75A6,6,0,0,0,177.5,87l22.62-22.63a6,6,0,0,0-8.48-8.48L169,78.5a6,6,0,0,0,4.24,10.25ZM224,122H192a6,6,0,0,0,0,12h32a6,6,0,0,0,0-12Zm-46.5,47A6,6,0,0,0,169,177.5l22.63,22.62a6,6,0,0,0,8.48-8.48ZM128,186a6,6,0,0,0-6,6v32a6,6,0,0,0,12,0V192A6,6,0,0,0,128,186ZM78.5,169,55.88,191.64a6,6,0,1,0,8.48,8.48L87,177.5A6,6,0,1,0,78.5,169ZM70,128a6,6,0,0,0-6-6H32a6,6,0,0,0,0,12H64A6,6,0,0,0,70,128ZM64.36,55.88a6,6,0,0,0-8.48,8.48L78.5,87A6,6,0,1,0,87,78.5Z"}}]})(a)}const Ua=({showBackButton:a=!0,onBackButtonClick:i})=>{const[e,d]=$t.useState(null),[w,g]=$t.useState(!0),[S,o]=$t.useState("auto"),v=$t.useRef(null),{selectedSkill:u,callSkillMutation:r,view:m,setView:E,abortController:O}=ci();return $t.useEffect(()=>{o(w?"auto":0)},[w,u?.inputsTypes]),$t.useEffect(()=>{(r.isSuccess||r.isError)&&E("view_response")},[r.isSuccess,r.isError]),ht.jsxs("div",{className:"home-view",children:[a&&ht.jsxs("button",{onClick:i,className:"mb-4 cursor-pointer flex items-center gap-2",children:[ht.jsx(fo,{className:"w-4 h-4 text-smythos-blue-500"})," Skills List"]}),ht.jsxs("div",{className:ze("",m==="home"&&r.isLoading&&"hidden"),children:[ht.jsxs("button",{onClick:()=>{m==="view_response"&&g(!w)},className:ze("flex items-center justify-between w-full",m!=="view_response"&&"cursor-default pointer-events-none"),children:[ht.jsx("h3",{className:"font-semibold",children:"Inputs and Files"}),m==="view_response"&&ht.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${w?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:ht.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),ht.jsx("div",{ref:v,className:"transition-all duration-200 overflow-hidden",style:{height:typeof S=="number"?`${S}px`:S},children:u?.inputsTypes&&ht.jsx(Fa,{setIsFormVisible:g})})]}),m==="home"&&ht.jsxs("div",{children:[ht.jsxs("button",{ref:d,className:ze("bg-slate-100 px-4 py-3 rounded-lg flex items-center justify-between w-full",(r.isSuccess||r.isError)&&"cursor-pointer"),onClick:()=>{(r.isSuccess||r.isError)&&E("view_response")},children:[ht.jsxs("div",{className:"flex items-center",children:[ht.jsx("span",{className:"icon svg-icon APIEndpoint w-6 mr-2"}),ht.jsxs("div",{className:"flex flex-col",children:[ht.jsx("h4",{className:"font-bold text-[#3E3E3E] text-sm",children:u.details.name}),ht.jsx("p",{className:"text-gray-500 text-xs",children:u.details.description})]})]}),ht.jsxs("div",{className:"flex flex-col",children:[r.isLoading&&ht.jsxs("div",{className:" p-2 rounded-md flex items-center gap-2",children:[ht.jsx("span",{children:"Processing..."}),ht.jsx(Va,{className:"animate-spin",size:18})]}),r.isSuccess&&ht.jsx("div",{className:"p-2 rounded-md flex items-center gap-2",children:ht.jsx(go,{className:"text-green-500",size:20})}),r.isError&&ht.jsx("div",{className:"p-2 rounded-md flex items-center gap-2",children:ht.jsx(mo,{className:"text-red-500",size:20})})]})]},u.skillId),r.isLoading&&ht.jsx("button",{onClick:()=>{O.current?.abort(),r.reset(),E("form"),g(!0)},className:"bg-transparent font-bold border border-gray-300 text-gray-500 px-4 py-3 rounded-md w-full mt-8",children:"Stop Testing"})]}),m==="view_response"&&ht.jsx(za,{})]})},Ha=({mode:a})=>{const i=ci(),e=a.props.defaultSkill,[d,w]=$t.useState([]),[g,S]=$t.useState(null),[o,v]=$t.useState(!1),[u,r]=$t.useState(!0),m=$t.useCallback(y=>{v(!0);try{const c=document.getElementById(y);if(!c)throw new Error("Component element not found");const F=c.querySelector(".form-preview-button");if(!F)throw new Error("Form preview button not found");F.click()}catch(c){v(!1),console.error("Failed to trigger form preview:",c)}},[]),E=$t.useCallback(y=>{try{const c=d.find(k=>k.skillId===y)||null;S(c);const F=document.getElementById(y);if(!F)return;a.props.workspace?.scrollToComponent(F)}catch(c){console.error("Failed to scroll to skill:",c)}},[d,a.props.workspace]),O=$t.useCallback(()=>{const y=a.props.getAvailableSkills?.()||[];w(y)},[a.props.getAvailableSkills]),D=$t.useCallback(()=>{O()},[O]);return $t.useEffect(()=>{S(d?.[0]||null),d.length===1&&!i.selectedSkill&&u&&(m(d[0].skillId),r(!1))},[d,i.selectedSkill,u]),$t.useEffect(()=>(a.props.workspace?.addEventListener("AgentSaved",D),()=>{a.props.workspace?.removeEventListener("AgentSaved",D)}),[a]),$t.useEffect(()=>{i.setSelectedSkill(e?{skillId:e?.skillId,inputsTypes:e?.inputsTypes,formData:{},details:e?.details,autoFillDataJson:e?.autoFillDataJson}:null),O();const y=document.getElementById("embodiment-sidebar-title");y&&e?.details?.name&&(y.textContent=e.details.name)},[]),ht.jsx("div",{className:"endpoint-form-preview-sidebar",children:o?ht.jsx("div",{className:"flex justify-center items-center h-full",children:ht.jsx(ei,{})}):i.selectedSkill&&d.length>0?ht.jsx(Ua,{showBackButton:d.length>1,onBackButtonClick:()=>i.setSelectedSkill(null)}):d.length===0?ht.jsx("div",{className:"text-gray-600 py-4",children:ht.jsxs("p",{children:[ht.jsx("b",{children:"No testable skills available."}),ht.jsx("br",{}),"Please add skills to your agent and configure inputs to test."]})}):ht.jsxs("div",{children:[ht.jsx("p",{className:"pb-2",children:"Select one of your agent's skills from the list, then click Test."}),ht.jsxs("div",{className:"flex gap-2",children:[ht.jsx("select",{className:"h-9 w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal px-[10px] border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500 appearance-none cursor-pointer",value:g?.skillId,onChange:y=>E(y.target.value),children:d.map(y=>ht.jsx("option",{value:y.skillId,className:"py-2",children:y.details.name},y.skillId))}),ht.jsx(Ln,{handleClick:()=>m(g?.skillId||""),disabled:!g,children:"Test"})]})]})})};function Ga({mode:a}){return ht.jsx(Na,{mode:a,children:ht.jsx(vo,{initialEntries:["/home"],initialIndex:0,children:ht.jsx(Ha,{mode:a})})})}const Ya=a=>{if(!a)return{props:{},style:{}};const i=a.style?a.style.split(";").reduce((d,w)=>{const[g,S]=w.split(":").map(o=>o.trim());if(g&&S){const o=g.replace(/-([a-z])/g,v=>v[1].toUpperCase());d[o]=S}return d},{}):{},e={...a};return delete e.style,{props:e,style:i}},Wa=({fieldId:a,fieldConfig:i,formikProps:e})=>{const d=$t.useRef(null),{handleChange:w,handleBlur:g,setFieldValue:S,values:o,errors:v,touched:u}=e,{props:r,style:m}=Ya(i.attributes),{events:E}=i;$t.useEffect(()=>{E&&d.current&&Object.entries(E).forEach(([F,k])=>{console.log("Adding event listener",F,k),d.current.addEventListener(F,k)})},[E]);const O={id:a,name:a,onChange:w,onBlur:g,color:u[a]&&v[a]?"failure":void 0,style:m,...r},D=()=>ht.jsx("div",{className:ze("mb-2 block"),children:ht.jsx(xo,{htmlFor:a,value:i.label||a,children:i.help&&ht.jsx("span",{className:"ml-1 text-sm text-gray-500",title:i.help,children:"\u24D8"})})}),y=()=>ht.jsx(wo,{name:a,component:"div",className:"mt-1 text-sm text-red-500"}),c=F=>ht.jsxs("div",{className:ze("mb-4",i.class,"form-box"),"data-field-name":a,children:[D(),F,y()]},a);switch(i.type){case"textarea":return c(ht.jsx(Bs,{...O,value:o[a]?.toString()??"",rows:4,className:ze("resize-y"),ref:d}));case"select":return c(ht.jsx(bo,{...O,value:o[a]?.toString()??"",ref:d,children:i.options?.map(F=>ht.jsx("option",{value:F.value,children:F.text},F.value))}));case"checkbox":return c(ht.jsx(yo,{...O,checked:!!o[a],onChange:F=>S(a,F.target.checked),ref:d}));case"color":return c(ht.jsx("input",{type:"color",...O,value:o[a]?.toString()??"#000000",className:ze("h-[38px] w-full rounded-lg"),ref:d}));default:return c(ht.jsx($s,{...O,value:o[a]?.toString()??"",type:i.type,ref:d}))}};function Xa({config:a,onSubmit:i}){const e=v=>{const u={};return Object.entries(v).forEach(([r,m])=>{let E=Eo();switch((m.validate==="required"||m.required)&&(E=E.required(m.validateMessage||`${m.label||r} is required`)),m.type){case"checkbox":E=Co();break;case"color":E=us().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,"Invalid color format");break;default:E=us()}u[r]=E}),_o().shape(u)},d=v=>Object.entries(v).reduce((u,[r,m])=>({...u,[r]:m.value??""}),{}),w=async(v,{setSubmitting:u})=>{try{i?.(v)}catch(r){console.error("Form submission error:",r),ae("An error occurred while submitting the form")}finally{u(!1)}};if(!a.fields)return null;const g=e(a.fields),S=d(a.fields),o=Object.entries(a.fields).reduce((v,[u,r])=>{const m=r.section||"Default";return v[m]||(v[m]=[]),v[m].push({id:u,config:r}),v},{});return ht.jsx(So,{onClose:()=>i?.(null),title:a.title,panelWrapperClasses:"lg:w-[35vw] md:w-[40vw]",applyMaxWidth:!1,children:ht.jsxs("div",{className:"p-4",children:[a.content&&ht.jsx("div",{className:"mb-4",children:a.content}),ht.jsx(Fs,{initialValues:S,validationSchema:g,onSubmit:w,children:v=>ht.jsxs(Rs,{className:"space-y-4",children:[Object.entries(o).map(([u,r])=>ht.jsxs("div",{className:"space-y-4",children:[u!=="Default"&&ht.jsx("h3",{className:"text-lg font-medium text-gray-900",children:u}),r.map(({id:m,config:E})=>ht.jsx(Wa,{fieldId:m,fieldConfig:E,formikProps:v},m))]},u)),ht.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[ht.jsx(cs,{color:"gray",onClick:()=>i?.(null),type:"button",children:"Cancel"}),ht.jsx(cs,{type:"submit",className:"bg-primary-100",disabled:v.isSubmitting||!v.isValid,children:a.btnSaveLabel||"Save"})]})]})})]})})}const Ka=a=>{const i=(d="modal")=>`${d}-${Math.random().toString(36).substring(2,9)}`,e=document.createElement("div");return e.id=a||i(),document.body.appendChild(e),{root:ji(e),id:e.id}};async function Ja({config:a}){const{root:i,id:e}=Ka(),d=()=>{i.unmount();const w=document.getElementById(e);w&&w.remove()};return new Promise(w=>{i.render(ht.jsx(Xa,{config:a,onSubmit:g=>{d(),console.log(g),w(g)}}))})}function Za({rootID:a,skill:i}){const e=ji(document.getElementById(a)),d=window.workspace;e.render(ht.jsx(Mi,{client:Ii,children:ht.jsx(Ga,{mode:{name:"in-builder",props:{defaultSkill:i,workspace:d,agentId:d.agent.id,dbg_url:d.serverData.dbgUrl,getAvailableSkills:()=>d.agent?.data?.components?.filter(w=>w.name==="APIEndpoint"&&w.inputs?.length>0)?.map(w=>({skillId:w.id,details:{name:w.title||""}}))||[]}}})}))}function Qa({rootID:a}){const i=window.workspace;ji(document.getElementById(a)).render(ht.jsx(Mi,{client:Ii,children:ht.jsx(Ia,{children:ht.jsx(Po,{children:ht.jsx(ko,{workspace:i,workspaceAgentId:i.agent.id,children:ht.jsx(Ao,{})})})})}))}function tl(a){return qs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"path",attr:{d:"M12 16v-4"}},{tag:"path",attr:{d:"M12 8h.01"}}]})(a)}const el=({agentId:a,workspace:i})=>{const{getPageAccess:e,loading:d}=Do(),w=e("/builder",!1),[g,S]=$t.useState(!1),o=To(),v=$t.useRef([]),u=$t.useRef(null),[r,m]=$t.useState([{key:"",value:""}]),[E,O]=$t.useState(null),[D,y]=$t.useState(null),[c,F]=$t.useState(!1),[k,B]=$t.useState({name:"",key:""}),[M,A]=$t.useState({}),[I,l]=$t.useState(!1),[T,x]=$t.useState(!1),[R,G]=$t.useState([]),[C,W]=$t.useState(!1),{data:V,isSuccess:Y,isLoading:L}=ds({queryKey:["agent_data_settings"],queryFn:()=>Oo(a),cacheTime:0,staleTime:0,refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!1,retry:!1}),{data:q}=ds({queryKey:["vaultKeys"],queryFn:async()=>(await fetch("/api/page/builder/keys?fields=name,scope&excludeScope=global,AgentLLM")).json(),staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,onError:()=>{ae("Failed to load vault keys")}}),tt=q?.data||{},K=_i({mutationFn:async dt=>{const ft=await fetch("/api/page/builder/keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dt)});if(!ft.ok)throw new Error("Failed to save key");return ft.json()},onSuccess:async()=>{await o.invalidateQueries({queryKey:["vaultKeys"]});const dt=k.name,ft=D;if(F(!1),B({name:"",key:""}),ft!==null){const ct=[...r];ct[ft]={...ct[ft],value:`{{KEY(${dt})}}`,error:!1},m(ct)}O(null)},onError:()=>{ae("Failed to save key. Please try again.")},onSettled:()=>{x(!1)}}),rt=_i({mutationFn:async({variables:dt,lockId:ft})=>{const ct=await fetch("/api/agent",{method:"POST",body:JSON.stringify({...V,data:{...V?.data,variables:dt},id:a,lockId:ft}),headers:{"Content-Type":"application/json"}});if(!ct.ok)throw new Error("Failed to save variables");return ct.json()},onSuccess:()=>{o.invalidateQueries({queryKey:["agent",a]})},onError:()=>{ae("Failed to update agent variables. Please try again.")},onSettled:async(dt,ft,ct)=>{await Lo(a,ct.lockId).catch(xt=>console.error(xt))}}),f=(dt,ft,ct)=>{const xt=[...r];xt[dt]={...xt[dt],[ft]:ct,error:!1},dt===r.length-1&&ct!==""&&(xt.push({key:"",value:""}),v.current=[...v.current,null]),m(xt),W(JSON.stringify(xt)!==JSON.stringify(R)),ft==="value"&&Z(v.current[dt],document.activeElement===v.current[dt])},_=(dt,ft)=>{dt?.stopPropagation();const ct=r.filter((xt,Pt)=>Pt!==ft);ct.length===0&&ct.push({key:"",value:""}),m(ct),W(JSON.stringify(ct)!==JSON.stringify(R))},h=(dt,ft)=>{f(dt,"value",`{{KEY(${ft})}}`),O(null)},N=()=>{F(!0),B({name:"",key:""}),A({}),O(null);const dt=setTimeout(()=>{u.current&&u.current?.scrollIntoView({behavior:"smooth",block:"center"}),clearTimeout(dt)},0)},z=()=>{const dt={};return k.name.trim()?Object.values(tt).some(ft=>ft.name===k.name.trim())&&(dt.name="Key name already exists"):dt.name="Name is required",k.key.trim()?k.key.length>1e4&&(dt.key="Key length cannot exceed 10,000 characters"):dt.key="Key is required",A(dt),Object.keys(dt).length===0},U=async()=>{z()&&(x(!0),K.mutate({keyName:k.name,key:k.key,scope:["ALL_NON_GLOBAL_KEYS"]}))},nt=async()=>{let dt=!1;const ft=r.map((ct,xt)=>{if(ct.key===""&&ct.value==="")return ct;const Pt=ct.key===""&&ct.value!==""||ct.key!==""&&ct.value==="",Ot=ct.key!==""&&r.some((Rt,Mt)=>Mt!==xt&&Rt.key===ct.key),Ct=Pt||Ot;return dt=dt||Ct,console.log("error",Ct),{...ct,error:Ct}});if(m(ft),!dt){l(!0);try{const ct=r.filter(Pt=>Pt.key!==""&&Pt.value!=="");let xt={};ct.forEach(Pt=>{xt[Pt.key]=Pt.value}),await ot(xt),G(r),W(!1)}catch(ct){console.error(ct)}finally{l(!1)}}};async function ot(dt){if(!(L||!Y||!V||!V.data))try{if(i)try{i.agent.data.variables=dt,await i.saveAgent(void 0,void 0,i.agent.data),W(!1)}catch(ft){console.error(ft)}finally{}else{const ft=await Ro(a);await rt.mutateAsync({variables:dt,lockId:ft.lockId}),W(!1)}jn("Variables saved successfully")}catch(ft){ft.errKey===$o.AGENT_LOCK_FAIL?ae("Failed to update agent variables as the agent is being edited by another user. Please try again later."):ae("Failed to update agent variables. Please try again.")}}const Z=(dt,ft)=>{if(dt){if(!ft){dt.style.height="40px";return}dt.style.height="40px",dt.style.height=`${Math.max(40,dt.scrollHeight)}px`}},ut=()=>{const dt=i.domElement.querySelector(".agent-settings-button");dt&&dt?.click()};return $t.useEffect(()=>{const dt=ft=>{const ct=ft.target;ct.closest("#vault-key-button")||E!==null&&!ct.closest(".vault-keys-dropdown")&&O(null)};return E!==null&&document.addEventListener("mousedown",dt,!0),()=>{document.removeEventListener("mousedown",dt,!0)}},[E]),$t.useEffect(()=>{if(Y&&V?.data){const dt=V?.data,ft=Object.entries(dt.variables||{}).map(([ct,xt])=>({key:ct,value:String(xt)})).concat([{key:"",value:""}]);m(ft),G(ft)}},[Y,V?.data]),$t.useEffect(()=>{function dt(ft){S(ft.detail.writeAccess)}return window.addEventListener("update-widget-access",dt),S(w?.write),document.querySelector("#workspace-container")?.classList.contains("locked")&&S(!1),()=>{window.removeEventListener("update-widget-access",dt)}},[w?.write]),d?ht.jsx("div",{className:"bg-[#F3F4F6] mt-3 p-4 rounded-xl border border-solid border-gray-200 flex items-center justify-center",children:ht.jsx(ei,{})}):ht.jsxs(jo,{title:"",isWriteAccess:g,hasBorder:!1,showOverflow:!0,children:[ht.jsxs("div",{className:"bg-[#FFFF] text-[#5A5A5A] p-4 rounded-xl border border-solid border-gray-200",children:[ht.jsxs("div",{className:"flex items-center justify-between mb-2",children:[ht.jsxs("h2",{className:"text-base font-semibold flex items-center",children:[ht.jsx(Mo,{className:"mr-2"})," Global Variables"]}),ht.jsxs("div",{id:"variables-widget-actions",className:`flex gap-3  ${g?"opacity-100":"opacity-0"}`,children:[ht.jsx(bi,{content:ht.jsx("div",{style:{minWidth:"300px"},children:"The Agent Variables you declare here can be accessed and used across all components. These variables act like global variables throughout your AI agent."}),placement:"top",children:ht.jsx(tl,{size:20})}),ht.jsx(bi,{content:"Close",placement:"top",children:ht.jsx(Io,{className:"cursor-pointer",size:22,onClick:dt=>{dt?.stopPropagation(),ut()}})})]})]}),ht.jsx("p",{className:"text-sm mb-4",children:"Define reusable values to use across your workflow."}),ht.jsx("div",{className:"space-y-2",children:r.map((dt,ft)=>ht.jsxs("div",{className:"flex gap-2 group relative",children:[ht.jsxs("div",{className:"relative flex-1",children:[ht.jsx("input",{type:"text",placeholder:"Key",value:dt.key,onChange:ct=>f(ft,"key",ct.target.value),className:`w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal ${dt.error?"!border-smyth-red focus:border-smyth-red":"border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500"}`}),ft<r.length-1&&ht.jsx("button",{onClick:ct=>_(ct,ft),className:"absolute right-2 top-3.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-gray-500 hover:text-red-500",type:"button","aria-label":"Delete variable",children:ht.jsx(bi,{content:ht.jsx("div",{style:{width:"120px"},children:"Delete Variable"}),placement:"top",children:ht.jsx(No,{className:"text-red-500"})})})]}),ht.jsxs("div",{className:"relative w-1/2",children:[ht.jsxs("div",{className:"relative",children:[ht.jsx("textarea",{ref:ct=>v.current[ft]=ct,placeholder:"Value",value:dt.value,onChange:ct=>f(ft,"value",ct.target.value),onFocus:ct=>Z(ct.target,!0),onBlur:ct=>Z(ct.target,!1),className:`w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal ${dt.error?"!border-smyth-red focus:border-smyth-red":"border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500"} pr-10`,style:{height:"40px",minHeight:"40px",lineHeight:"1.25rem"}}),ht.jsx("button",{onClick:()=>{O(ft),y(ft)},className:"absolute right-2 top-0 bottom-0 my-auto h-7 w-7 hover:bg-gray-100 rounded flex items-center justify-center",type:"button",id:"vault-key-button",children:ht.jsx(Fo,{className:"text-[#424242]  scale-x-[-1]"})}),ht.jsx("div",{className:"absolute bottom-[7px] left-2 w-[calc(100%-16px)] h-1 bg-white"})]}),E===ft&&ht.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-md shadow-lg vault-keys-dropdown",children:ht.jsx("ul",{className:"max-h-[200px] overflow-y-auto",onWheel:ct=>{ct.stopPropagation()},children:Object.entries(tt).length>0?ht.jsxs(ht.Fragment,{children:[Object.entries(tt).map(([ct,xt])=>ht.jsx("li",{className:"px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer",onClick:()=>h(ft,xt.name),children:xt.name},ct)),ht.jsx("li",{className:"border-t",children:ht.jsx("button",{className:"w-full text-left text-sm px-4 py-2 text-blue-500 hover:bg-gray-100",onClick:N,children:"Add Key"})})]}):ht.jsx("li",{children:ht.jsx("button",{className:"w-full text-left px-4 py-2 text-blue-500 hover:bg-gray-100",onClick:N,children:"Add Key"})})})})]})]},ft))}),C&&ht.jsx("div",{className:"flex justify-end mt-4",children:ht.jsx(Ln,{label:"Save",variant:"primary",handleClick:nt,disabled:I,addIcon:I,Icon:ht.jsx(ei,{classes:"w-4 h-4 mr-2"})})})]}),c&&ht.jsx("div",{ref:u,className:"mt-4 flex items-center justify-center rounded-lg border border-solid border-gray-200",children:ht.jsxs("div",{className:"bg-[#FFFF] text-[#5A5A5A] rounded-xl p-6 w-full max-w-md modal-content",children:[ht.jsx("h2",{className:"text-base font-semibold mb-4",children:"Save Key to the Vault"}),ht.jsx("div",{className:"mb-4",children:ht.jsx(hs,{label:"Name",required:!0,value:k.name,onChange:dt=>B({...k,name:dt.target.value}),error:!!M.name,errorMessage:M.name,fullWidth:!0})}),ht.jsx("div",{className:"mb-4",children:ht.jsx(hs,{label:"Key",required:!0,value:k.key,onChange:dt=>B({...k,key:dt.target.value}),error:!!M.key,errorMessage:M.key,fullWidth:!0})}),ht.jsxs("div",{className:"flex justify-end gap-3",children:[ht.jsx(Ln,{label:"Cancel",variant:"secondary",handleClick:dt=>{dt?.stopPropagation(),F(!1)}}),ht.jsx(Ln,{label:"Save",variant:"primary",handleClick:U,disabled:T,addIcon:T,Icon:ht.jsx(ei,{classes:"w-4 h-4 mr-2"})})]})]})})]})},Ps={},nl=class Dn extends zs{constructor(i,e={data:{},top:"20px",left:"20px",width:"",height:"",uid:null},d={}){super(),this.workspace=i,this.properties=e,this.configuration=d,this.settings={},this.data={},this.drawSettings={cssClass:"agent-card",shortDescription:"",color:"#3B82F6"},this._destroyed=!1,this.variablesPlaceholder=null,this.variablesReactRoot=null,this.isVariablesComponentMounted=!1,this.skills=[],this._init_state_populated=!1,this._uid=this.properties.uid||"A"+Pi(),this.properties||(this.properties={top:"",left:""}),this.data=this.properties.data||{},this.prepare().then(this.init.bind(this)).then(()=>{this.redraw().then(()=>{this.handleSkillsConnections(this.configuration).then(()=>{this._init_state_populated=!0}),this.workspace.addEventListener("componentAdded",w=>{w.displayName==="APIEndpoint"&&this.handleCompConn(w.uid)})})}).catch(w=>{console.error("Error initializing agent card:",w)}),Ps[this.uid]=this}get uid(){return this._uid}async prepare(){return Promise.resolve()}async init(){return Promise.resolve()}async redraw(){const i=this.workspace,e=document.createElement("div");e.className=`agent-card exclude-panzoom ${this.drawSettings.cssClass||""}`,e.id=`agent-card-${this._uid}`,e.style.position="absolute",e.style.left=this.properties.left||"20px",e.style.top=this.properties.top||"20px",this.properties.width&&(e.style.width=this.properties.width),this.properties.height&&(e.style.height=this.properties.height);let d=null;const w=document.querySelector("#agent-avatar");w?d=w.src:(d=window.sessionStorage.getItem(`agent-avatar-${this.workspace.agent?.id}`),window.sessionStorage.removeItem(`agent-avatar-${this.workspace.agent?.id}`));const g=document.createElement("div");g.className="agent-card-content";const S=document.createElement("div");S.className="agent-image-container";const o=document.createElement("img");o.src=d||"",o.alt="Agent",o.className=`agent-image ${d?"":"hidden"}`,o.id="agent-card-avatar",S.appendChild(o);const v=document.createElement("div");v.id="agent-card-avatar-placeholder",v.className=`h-full w-full flex items-center justify-center bg-uipink rounded-[7px]  w-8 h-8 flex items-center justify-center text-white font-medium truncate ${d?"hidden":""}`,v.style.fontSize="77px",setTimeout(()=>{v.textContent=this.workspace.agent?.data?.name?.charAt(0)||document.querySelector(".agent-avatar-placeholder-topbar")?.textContent||""},200),S.appendChild(v);const u=document.createElement("div");u.className="agent-info";const r=document.createElement("div");r.className="agent-header";const m=document.createElement("div"),E=document.createElement("h2");E.className="agent-name",setTimeout(()=>{E.textContent=this.workspace.agent?.data?.name||""},200),m.appendChild(E);const O=document.createElement("div");O.className="p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors cursor-pointer menu-button",O.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="1"></circle>
        <circle cx="12" cy="5" r="1"></circle>
        <circle cx="12" cy="19" r="1"></circle>
      </svg>
    `,r.appendChild(m),r.appendChild(O),u.appendChild(r);const D=document.createElement("div");D.className="agent-actions py-2";const y=document.createElement("div");y.className="ep-control inputs justify-self-end flex items-center ";const c=document.createElement("span");c.className="text-[#5A5A5A] font-medium pr-2",c.textContent="Add skill",y.appendChild(c);const F=document.createElement("button");F.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",F.id="add-skill-button",F.style.fontSize="20px",F.textContent="+",y.appendChild(F);const k=document.createElement("div");k.className="flex justify-self-end mt-2 agent-card-connection",k.setAttribute("smt-name","Skills"),k.setAttribute("smt-color","#3C89F9");const B=document.createElement("span");B.className="name",B.style.borderImage="linear-gradient(90deg, transparent 20%, rgb(60, 137, 249)) 1 / 1 / 0 stretch",B.innerHTML='<span class="label text-gray-500"># Skills</span>',k.appendChild(B);const M=document.createElement("span");M.className="block absolute ep w-[15px] h-[15px] rounded-full -right-[23px] float-left border-0 top-1/2 -translate-y-1/2",M.style.backgroundColor="#3C89F9",k.appendChild(M);const A=document.createElement("div");A.className="preview-button-container flex items-center gap-2 bg-[#F5F5F5] rounded-lg p-1 pl-2 border border-[#EDE8E8]";const I=document.createElement("button");I.className="agent-settings-button flex items-center justify-center hover:bg-[#D3D3D3] rounded-lg p-1",I.innerHTML=`
     <svg xmlns="http://www.w3.org/2000/svg" width="28" height="27" viewBox="0 0 17 16" fill="none">
      <path d="M5.41467 3.44531C2.1001 3.44531 5.41467 8.00267 2.1001 8.00267C5.41467 8.00267 2.1001 12.5601 5.41467 12.5601" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7.13867 6.26562L9.43354 9.37743" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M9.43354 6.26562L7.13867 9.37743" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M10.7856 3.44531C14.1002 3.44531 10.7856 8.00267 14.1002 8.00267C10.7856 8.00267 14.1002 12.5601 10.7856 12.5601" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `,new Js(I,{text:"Global Variables",position:"top",showWhen:"hover"});const l=document.createElement("button");l.className="preview-button w-full bg-white rounded border border-[#C7C7C7]",l.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 13 12" fill="none">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M9.99811 9.27993C9.08886 10.3587 7.81286 10.8942 6.53776 10.8898C6.09116 10.8878 4.10195 10.8893 2.92807 10.8898C2.57878 10.8898 2.37251 10.4998 2.56662 10.2089C2.6751 10.0453 2.81424 9.84668 2.92418 9.69193C3.03364 9.53673 3.04337 9.33318 2.94851 9.16818C2.78164 8.87823 2.53354 8.43698 2.46883 8.27638C1.69825 6.60503 1.99549 4.56074 3.37077 3.1808C5.25248 1.29273 8.39416 1.42793 10.0949 3.58644C11.4016 5.24413 11.3583 7.66618 9.99811 9.27993Z" stroke="#3C89F9" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Preview as Chatbot</span>
    `,A.appendChild(I),A.appendChild(l),D.appendChild(y),D.appendChild(k),u.appendChild(D),u.appendChild(A),g.appendChild(S),g.appendChild(u),await be(50);const T=this.workspace.jsPlumbInstance.addEndpoint(k,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:-1,cssClass:"exclude-panzoom"});k.endpoint=T,T._domElement=k;const x=document.createElement("div");x.id=`agent-card-variables-placeholder-${this._uid}`,x.className="hidden agent-card-variables",e.appendChild(x),e.appendChild(g),this.domElement=e,this.variablesPlaceholder=x,e._control=this,i.domElement.appendChild(e),this.makeDraggable(),this.addEventListeners(),this.emit("AgentCardCreated")}makeDraggable(){const i=this.workspace,e=this;Mn(this.domElement).draggable({allowFrom:".agent-card",ignoreFrom:".agent-name",listeners:{start(d){if(i?.locked)return!1;e.domElement.classList.add("dragging"),e.domElement.style.cursor="grabbing"},move(d){if(i?.locked)return!1;if(!d.target)return;let w=[d.target];for(let g of w){const S=(parseFloat(g.style.left)||0)+d.dx/i.scale,o=(parseFloat(g.style.top)||0)+d.dy/i.scale;g.style.left=S+"px",g.style.top=o+"px",g._control.repaint()}},end(d){if(i?.locked)return!1;e.repaint(!0),e.domElement.style.cursor="",setTimeout(()=>{e.workspace.saveAgent(),e.domElement.classList.remove("dragging")},200)}},inertia:!0}).styleCursor(!1)}mountVariablesComponent(){this.variablesPlaceholder&&(this.variablesPlaceholder.classList.remove("hidden"),this.variablesReactRoot=Bo.createRoot(this.variablesPlaceholder),this.variablesReactRoot.render(ps.createElement(Mi,{client:Ii},ps.createElement(el,{agentId:this.workspace.agent?.id,workspace:this.workspace}))),this.isVariablesComponentMounted=!0)}unmountVariablesComponent(){this.variablesReactRoot&&(this.variablesReactRoot.unmount(),this.variablesReactRoot=null,this.variablesPlaceholder&&this.variablesPlaceholder.classList.add("hidden"),this.isVariablesComponentMounted=!1)}addEventListeners(){const i=this.domElement.querySelector("#add-skill-button");i&&i.addEventListener("click",async g=>{g.stopPropagation();const S=this.workspace.agent?.data?.components?.filter(m=>m.name==="APIEndpoint");if(S.length===0){const m=this.domElement.getBoundingClientRect(),E=await this.workspace.addComponent("APIEndpoint",{top:Number(this.properties.top.split("px")[0])+m.height+100+"px",left:Number(this.properties.left.split("px")[0])+m.width+450+"px"},!0);this.workspace.scrollToComponent(E),this.workspace.refreshComponentSelection(E);return}const o=S.reduce((m,E)=>Number(m.top.split("px")[0]||0)<Number(E.top.split("px")[0]||0)?E:m),v=document.querySelector(`#${o.id}`);let u;if(v){const m=v.getBoundingClientRect();u=Number(o.top.split("px")[0])+m.height+200+"px"}else u=Number(o.top.split("px")[0])+400+"px";const r=await this.workspace.addComponent("APIEndpoint",{top:u,left:o.left},!0);this.workspace.scrollToComponent(r),this.workspace.refreshComponentSelection(r)});const e=this.domElement.querySelector(".agent-settings-button");e&&e.addEventListener("click",g=>{g.stopPropagation(),this.isVariablesComponentMounted?this.variablesPlaceholder.classList.toggle("hidden"):this.mountVariablesComponent(),this.workspace.jsPlumbInstance.revalidate(this.domElement)}),this.domElement.addEventListener("click",g=>{g.stopPropagation();const S=g.target;S.closest(`#agent-card-variables-placeholder-${this._uid}`)||S.closest(".vault-keys-dropdown")||(qo(),Qa({rootID:"agent-settings-in-right-sidebar-root"}))});const d=this.domElement.querySelector(".preview-button");d&&d.addEventListener("click",g=>{g.stopPropagation(),Ve.track("app_preview_as_chatbot_click");const S=document.querySelector("#btn-emb-chatbot-main");!document.querySelector("#right-container.open #embodiment-sidebar:not(.hidden)")&&S&&S?.click();const o=document.querySelector("[data-embodiment-type='chat']");o&&o?.click()});const w=this.domElement.querySelector(".agent-name");this.domElement.addEventListener("mousedown",g=>{g.stopPropagation()}),this.workspace.addEventListener("AgentSaved",()=>{w&&this.workspace.agent?.data?.name!=w.textContent&&(w.textContent=this.workspace.agent?.data?.name||""),document.querySelector("#agent-card-avatar"),document.querySelector("#agent-card-avatar-placeholder")}),this.workspace.agent.addEventListener("AvatarUpdated",g=>{const S=document.querySelector("#agent-card-avatar");S&&(S.src=g)})}makeAgentNameEditable(i){}destroy(){this._destroyed||(this.isVariablesComponentMounted&&this.unmountVariablesComponent(),this.domElement&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),delete Ps[this.uid],this._destroyed=!0)}async repaint(i=!1){if(i){let e=[...this.domElement.querySelectorAll(".endpoint")].map(d=>d?.endpoint?.connections).flat(1/0);e=[...new Set(e)],e.forEach(d=>{this.workspace.updateConnectionStyle(d)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async handleSkillsConnections(i){const e=i?.components?.filter(d=>d.name==="APIEndpoint");if(e)for(const d of e)await this.handleCompConn(d.id)}async handleCompConn(i){const e=document.querySelector(".agent-card .agent-card-connection");if(!e)return;const d=document.querySelector(`#${i} `);if(!d)return;const w=()=>{const v=d.querySelector(".agent-card-connection");v&&this.workspace.jsPlumbInstance.getConnections({source:e.id,target:v.id}).length===0&&this.workspace.jsPlumbInstance.connect({source:e.endpoint,target:v.endpoint,detachable:!0,cssClass:"exclude-panzoom",paintStyle:Dn.connPaintStyles})},g=()=>{const v=d.querySelector(".agent-card-connection");v&&this.workspace.jsPlumbInstance.getConnections({source:e.id,target:v.id}).forEach(u=>{this.workspace.jsPlumbInstance.deleteConnection(u)})};if(!d._control)return;const S=(v=>{v?.ai_exposed?w():g()}).bind(this),o=g.bind(this);d._control.removeEventListener("settingsSaved",S),d._control.removeEventListener("settingsDraftUpdated",S),d._control.removeEventListener("beforeDelete",o),d._control.addEventListener("settingsSaved",S),d._control.addEventListener("settingsDraftUpdated",S),d._control.addEventListener("beforeDelete",o),d._control.data.ai_exposed?w():g(),d._control.addEventListener("connectionDetached",async(v,u,r)=>{this._init_state_populated&&r.source.classList.contains("agent-card-connection")&&(d._control.data.ai_exposed=!1,await be(100),this.workspace.saveAgent())}),d._control.addEventListener("connectionAttached",async(v,u,r)=>{this._init_state_populated&&r.source.classList.contains("agent-card-connection")&&(d._control.data.ai_exposed=!0,await be(100),this.workspace.saveAgent())})}static checkConnValidity(i){return!i.target.classList.contains("agent-card-connection")&&i.source.classList.contains("agent-card-connection")||!i.source.classList.contains("agent-card-connection")&&i.target.classList.contains("agent-card-connection")?(zo("Unsupported Connection",'You can only connect skill components directly to the agent. Please add a skill component first and then connect it to the agent card. <a href="https://smythos.com/documentation/#/" target="_blank" class="text-v2-blue underline hover:text-v2-blue/80">Read documentation</a>.',"OK","error"),!1):!0}static setConnPaintStyles(i){i.__smt_color=Dn.connPaintStyles.stroke,i.__smt_dashstyle=Dn.connPaintStyles.dashstyle,i.__smt_thickness=Dn.connPaintStyles.strokeWidth}static isCardConn(i){return i.source.classList.contains("agent-card-connection")}};nl.connPaintStyles={stroke:"#8F8F8F",strokeWidth:2,dashstyle:"4 4"};var Qs={exports:{}};(function(a){var i=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var e=function(d){var w=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,g=0,S={},o={manual:d.Prism&&d.Prism.manual,disableWorkerMessageHandler:d.Prism&&d.Prism.disableWorkerMessageHandler,util:{encode:function k(B){return B instanceof v?new v(B.type,k(B.content),B.alias):Array.isArray(B)?B.map(k):B.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++g}),k.__id},clone:function k(B,M){M=M||{};var A,I;switch(o.util.type(B)){case"Object":if(I=o.util.objId(B),M[I])return M[I];A={},M[I]=A;for(var l in B)B.hasOwnProperty(l)&&(A[l]=k(B[l],M));return A;case"Array":return I=o.util.objId(B),M[I]?M[I]:(A=[],M[I]=A,B.forEach(function(T,x){A[x]=k(T,M)}),A);default:return B}},getLanguage:function(k){for(;k;){var B=w.exec(k.className);if(B)return B[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,B){k.className=k.className.replace(RegExp(w,"gi"),""),k.classList.add("language-"+B)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(A){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(A.stack)||[])[1];if(k){var B=document.getElementsByTagName("script");for(var M in B)if(B[M].src==k)return B[M]}return null}},isActive:function(k,B,M){for(var A="no-"+B;k;){var I=k.classList;if(I.contains(B))return!0;if(I.contains(A))return!1;k=k.parentElement}return!!M}},languages:{plain:S,plaintext:S,text:S,txt:S,extend:function(k,B){var M=o.util.clone(o.languages[k]);for(var A in B)M[A]=B[A];return M},insertBefore:function(k,B,M,A){A=A||o.languages;var I=A[k],l={};for(var T in I)if(I.hasOwnProperty(T)){if(T==B)for(var x in M)M.hasOwnProperty(x)&&(l[x]=M[x]);M.hasOwnProperty(T)||(l[T]=I[T])}var R=A[k];return A[k]=l,o.languages.DFS(o.languages,function(G,C){C===R&&G!=k&&(this[G]=l)}),l},DFS:function k(B,M,A,I){I=I||{};var l=o.util.objId;for(var T in B)if(B.hasOwnProperty(T)){M.call(B,T,B[T],A||T);var x=B[T],R=o.util.type(x);R==="Object"&&!I[l(x)]?(I[l(x)]=!0,k(x,M,null,I)):R==="Array"&&!I[l(x)]&&(I[l(x)]=!0,k(x,M,T,I))}}},plugins:{},highlightAll:function(k,B){o.highlightAllUnder(document,k,B)},highlightAllUnder:function(k,B,M){var A={callback:M,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",A),A.elements=Array.prototype.slice.apply(A.container.querySelectorAll(A.selector)),o.hooks.run("before-all-elements-highlight",A);for(var I=0,l;l=A.elements[I++];)o.highlightElement(l,B===!0,A.callback)},highlightElement:function(k,B,M){var A=o.util.getLanguage(k),I=o.languages[A];o.util.setLanguage(k,A);var l=k.parentElement;l&&l.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(l,A);var T=k.textContent,x={element:k,language:A,grammar:I,code:T};function R(C){x.highlightedCode=C,o.hooks.run("before-insert",x),x.element.innerHTML=x.highlightedCode,o.hooks.run("after-highlight",x),o.hooks.run("complete",x),M&&M.call(x.element)}if(o.hooks.run("before-sanity-check",x),l=x.element.parentElement,l&&l.nodeName.toLowerCase()==="pre"&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!x.code){o.hooks.run("complete",x),M&&M.call(x.element);return}if(o.hooks.run("before-highlight",x),!x.grammar){R(o.util.encode(x.code));return}if(B&&d.Worker){var G=new Worker(o.filename);G.onmessage=function(C){R(C.data)},G.postMessage(JSON.stringify({language:x.language,code:x.code,immediateClose:!0}))}else R(o.highlight(x.code,x.grammar,x.language))},highlight:function(k,B,M){var A={code:k,grammar:B,language:M};if(o.hooks.run("before-tokenize",A),!A.grammar)throw new Error('The language "'+A.language+'" has no grammar.');return A.tokens=o.tokenize(A.code,A.grammar),o.hooks.run("after-tokenize",A),v.stringify(o.util.encode(A.tokens),A.language)},tokenize:function(k,B){var M=B.rest;if(M){for(var A in M)B[A]=M[A];delete B.rest}var I=new m;return E(I,I.head,k),r(k,I,B,I.head,0),D(I)},hooks:{all:{},add:function(k,B){var M=o.hooks.all;M[k]=M[k]||[],M[k].push(B)},run:function(k,B){var M=o.hooks.all[k];if(!(!M||!M.length))for(var A=0,I;I=M[A++];)I(B)}},Token:v};d.Prism=o;function v(k,B,M,A){this.type=k,this.content=B,this.alias=M,this.length=(A||"").length|0}v.stringify=function k(B,M){if(typeof B=="string")return B;if(Array.isArray(B)){var A="";return B.forEach(function(R){A+=k(R,M)}),A}var I={type:B.type,content:k(B.content,M),tag:"span",classes:["token",B.type],attributes:{},language:M},l=B.alias;l&&(Array.isArray(l)?Array.prototype.push.apply(I.classes,l):I.classes.push(l)),o.hooks.run("wrap",I);var T="";for(var x in I.attributes)T+=" "+x+'="'+(I.attributes[x]||"").replace(/"/g,"&quot;")+'"';return"<"+I.tag+' class="'+I.classes.join(" ")+'"'+T+">"+I.content+"</"+I.tag+">"};function u(k,B,M,A){k.lastIndex=B;var I=k.exec(M);if(I&&A&&I[1]){var l=I[1].length;I.index+=l,I[0]=I[0].slice(l)}return I}function r(k,B,M,A,I,l){for(var T in M)if(!(!M.hasOwnProperty(T)||!M[T])){var x=M[T];x=Array.isArray(x)?x:[x];for(var R=0;R<x.length;++R){if(l&&l.cause==T+","+R)return;var G=x[R],C=G.inside,W=!!G.lookbehind,V=!!G.greedy,Y=G.alias;if(V&&!G.pattern.global){var L=G.pattern.toString().match(/[imsuy]*$/)[0];G.pattern=RegExp(G.pattern.source,L+"g")}for(var q=G.pattern||G,tt=A.next,K=I;tt!==B.tail&&!(l&&K>=l.reach);K+=tt.value.length,tt=tt.next){var rt=tt.value;if(B.length>k.length)return;if(!(rt instanceof v)){var f=1,_;if(V){if(_=u(q,K,k,W),!_||_.index>=k.length)break;var U=_.index,h=_.index+_[0].length,N=K;for(N+=tt.value.length;U>=N;)tt=tt.next,N+=tt.value.length;if(N-=tt.value.length,K=N,tt.value instanceof v)continue;for(var z=tt;z!==B.tail&&(N<h||typeof z.value=="string");z=z.next)f++,N+=z.value.length;f--,rt=k.slice(K,N),_.index-=K}else if(_=u(q,0,rt,W),!_)continue;var U=_.index,nt=_[0],ot=rt.slice(0,U),Z=rt.slice(U+nt.length),ut=K+rt.length;l&&ut>l.reach&&(l.reach=ut);var dt=tt.prev;ot&&(dt=E(B,dt,ot),K+=ot.length),O(B,dt,f);var ft=new v(T,C?o.tokenize(nt,C):nt,Y,nt);if(tt=E(B,dt,ft),Z&&E(B,tt,Z),f>1){var ct={cause:T+","+R,reach:ut};r(k,B,M,tt.prev,K,ct),l&&ct.reach>l.reach&&(l.reach=ct.reach)}}}}}}function m(){var k={value:null,prev:null,next:null},B={value:null,prev:k,next:null};k.next=B,this.head=k,this.tail=B,this.length=0}function E(k,B,M){var A=B.next,I={value:M,prev:B,next:A};return B.next=I,A.prev=I,k.length++,I}function O(k,B,M){for(var A=B.next,I=0;I<M&&A!==k.tail;I++)A=A.next;B.next=A,A.prev=B,k.length-=I}function D(k){for(var B=[],M=k.head.next;M!==k.tail;)B.push(M.value),M=M.next;return B}if(!d.document)return d.addEventListener&&(o.disableWorkerMessageHandler||d.addEventListener("message",function(k){var B=JSON.parse(k.data),M=B.language,A=B.code,I=B.immediateClose;d.postMessage(o.highlight(A,o.languages[M],M)),I&&d.close()},!1)),o;var y=o.util.currentScript();y&&(o.filename=y.src,y.hasAttribute("data-manual")&&(o.manual=!0));function c(){o.manual||o.highlightAll()}if(!o.manual){var F=document.readyState;F==="loading"||F==="interactive"&&y&&y.defer?document.addEventListener("DOMContentLoaded",c):window.requestAnimationFrame?window.requestAnimationFrame(c):window.setTimeout(c,16)}return o}(i);a.exports&&(a.exports=e),typeof ne<"u"&&(ne.Prism=e),e.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},e.languages.markup.tag.inside["attr-value"].inside.entity=e.languages.markup.entity,e.languages.markup.doctype.inside["internal-subset"].inside=e.languages.markup,e.hooks.add("wrap",function(d){d.type==="entity"&&(d.attributes.title=d.content.replace(/&amp;/,"&"))}),Object.defineProperty(e.languages.markup.tag,"addInlined",{value:function(w,g){var S={};S["language-"+g]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:e.languages[g]},S.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:S}};o["language-"+g]={pattern:/[\s\S]+/,inside:e.languages[g]};var v={};v[w]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return w}),"i"),lookbehind:!0,greedy:!0,inside:o},e.languages.insertBefore("markup","cdata",v)}}),Object.defineProperty(e.languages.markup.tag,"addAttribute",{value:function(d,w){e.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+d+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[w,"language-"+w],inside:e.languages[w]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),e.languages.html=e.languages.markup,e.languages.mathml=e.languages.markup,e.languages.svg=e.languages.markup,e.languages.xml=e.languages.extend("markup",{}),e.languages.ssml=e.languages.xml,e.languages.atom=e.languages.xml,e.languages.rss=e.languages.xml,function(d){var w=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;d.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+w.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+w.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+w.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+w.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:w,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},d.languages.css.atrule.inside.rest=d.languages.css;var g=d.languages.markup;g&&(g.tag.addInlined("style","css"),g.tag.addAttribute("style","css"))}(e),e.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},e.languages.javascript=e.languages.extend("clike",{"class-name":[e.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),e.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,e.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:e.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:e.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:e.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:e.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:e.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),e.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:e.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),e.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),e.languages.markup&&(e.languages.markup.tag.addInlined("script","javascript"),e.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),e.languages.js=e.languages.javascript,function(){if(typeof e>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var d="Loading\u2026",w=function(y,c){return"\u2716 Error "+y+" while fetching file: "+c},g="\u2716 Error: File does not exist or is empty",S={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",v="loading",u="loaded",r="failed",m="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+v+'"])';function E(y,c,F){var k=new XMLHttpRequest;k.open("GET",y,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?c(k.responseText):k.status>=400?F(w(k.status,k.statusText)):F(g))},k.send(null)}function O(y){var c=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(y||"");if(c){var F=Number(c[1]),k=c[2],B=c[3];return k?B?[F,Number(B)]:[F,void 0]:[F,F]}}e.hooks.add("before-highlightall",function(y){y.selector+=", "+m}),e.hooks.add("before-sanity-check",function(y){var c=y.element;if(c.matches(m)){y.code="",c.setAttribute(o,v);var F=c.appendChild(document.createElement("CODE"));F.textContent=d;var k=c.getAttribute("data-src"),B=y.language;if(B==="none"){var M=(/\.(\w+)$/.exec(k)||[,"none"])[1];B=S[M]||M}e.util.setLanguage(F,B),e.util.setLanguage(c,B);var A=e.plugins.autoloader;A&&A.loadLanguages(B),E(k,function(I){c.setAttribute(o,u);var l=O(c.getAttribute("data-range"));if(l){var T=I.split(/\r\n?|\n/g),x=l[0],R=l[1]==null?T.length:l[1];x<0&&(x+=T.length),x=Math.max(0,Math.min(x-1,T.length)),R<0&&(R+=T.length),R=Math.max(0,Math.min(R,T.length)),I=T.slice(x,R).join(`
`),c.hasAttribute("data-start")||c.setAttribute("data-start",String(x+1))}F.textContent=I,e.highlightElement(F)},function(I){c.setAttribute(o,r),F.textContent=I})}}),e.plugins.fileHighlight={highlight:function(c){for(var F=(c||document).querySelectorAll(m),k=0,B;B=F[k++];)e.highlightElement(B)}};var D=!1;e.fileHighlight=function(){D||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),D=!0),e.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(Qs);var il=Qs.exports,ks=Ns(il);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;var sl=`/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
`;Vo(sl);const rl=a=>/^-?\d+(\.\d+)?$/.test(a.trim()),ol=a=>{const i=parseFloat(a);return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER&&i.toString()===a.trim()};function al(a){if(!a)return null;if(rl(a)&&!ol(a)||!a.trim().startsWith("{")&&!a.trim().startsWith("["))return a;try{return JSON.parse(a)}catch{try{return JSON.parse(Xs(a))}catch(i){return console.error("Error on parseJson: ",i.toString()),console.error("   Tried to parse: ",a),null}}}class ll{constructor(i,e={}){this.wrapper=i,this.options={debounceDelay:300,mutatingClass:"mutating",mutatingWrapperClass:"jfs_has_mutating",mutationDuration:300,jsonFieldClass:"jfs_json_field",...e},this.parentMap=new Map,this.previousValues=new Map,this.initializeStructure(),this.bindEvents()}initializeStructure(){Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression]`)).filter(i=>!/[\.\[\]]/.test(i.dataset.expression)).forEach(i=>{const e=i.dataset.expression,d=this.findChildren(e),w=d.some(g=>g.path.includes("["));this.parentMap.set(i,{data:w?[]:{},children:d,isArray:w})})}findChildren(i){return Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression^="${i}["], .${this.options.jsonFieldClass}[data-expression^="${i}."]`)).map(e=>({element:e,path:e.dataset.expression.replace(i,"")}))}bindEvents(){this.parentMap.forEach((i,e)=>{let d;e.addEventListener("input",()=>{clearTimeout(d),d=setTimeout(()=>this.handleParentUpdate(e,i),this.options.debounceDelay)}),i.children.forEach(w=>{w.element.addEventListener("input",()=>this.handleChildUpdate(e,w,i)),w.element.addEventListener("focus",()=>this.handleFocus(w.element,e)),w.element.addEventListener("blur",()=>this.handleBlur(w.element,e))}),e.addEventListener("focus",()=>this.handleFocus(e,e)),e.addEventListener("blur",()=>this.handleBlur(e,e))})}handleParentUpdate(i,e){const d=i.value?.trim()||"";try{let w,g=!0;if(e.data&&(e.isArray&&!Array.isArray(e.data)&&(g=!1),!e.isArray&&typeof e.data!="object"&&(g=!1)),g||(e.data=e.isArray?[]:{}),d)try{w=JSON.parse(d)}catch{try{const S=v=>{try{return JSON.parse(v)}catch{try{if(!o(v))return v.startsWith("[")?[]:{};let u=v;u=u.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let r=!1,m=!1,E="";for(let D=0;D<u.length;D++){const y=u[D];y==='"'&&(D===0||u[D-1]!=="\\")?(m||(r=!r),E+=y):y==="'"&&(D===0||u[D-1]!=="\\")?r?E+=y:(m=!m,E+='"'):E+=y}u=E.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const O=u.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(O)}catch{return v.startsWith("[")?[]:{}}}},o=v=>{let u=!1,r=!1,m=[];for(let E=0;E<v.length;E++){const O=v[E],D=E>0?v[E-1]:"";if(O==='"'&&D!=="\\"?r||(u=!u):O==="'"&&D!=="\\"&&(u||(r=!r)),!(u||r)){if(O==="{"||O==="[")m.push(O);else if(O==="}"){if(m.length===0||m.pop()!=="{")return!1}else if(O==="]"&&(m.length===0||m.pop()!=="["))return!1}}return!u&&!r&&m.length===0};w=S(d)}catch{w=e.isArray?[]:{}}}else w=e.isArray?[]:{};e.data=w,typeof w!="object"||w===null?e.children.forEach(S=>{S.element.value=""}):this.updateChildren(e,i),i.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass)}catch{e.data=e.isArray?[]:{},e.children.forEach(w=>{w.element.value=""})}}handleChildUpdate(i,e,d){let w=e.element.value?.trim()||"";try{let g;try{if(g=JSON.parse(i.value),d.isArray&&!Array.isArray(g))throw new Error("Parent data structure mismatch");if(!d.isArray&&typeof g!="object")throw new Error("Parent data structure mismatch")}catch{g=d.isArray?[]:{}}d.data=g;const S=this.parsePath(e.path,d.isArray);this.clearAllMutations(),i.classList.add(this.options.mutatingClass),e.element.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass);let o=w;if(w&&(w.startsWith("{")&&w.endsWith("}")||w.startsWith("[")&&w.endsWith("]")))try{o=JSON.parse(w)}catch{try{o=(v=>{try{return JSON.parse(v)}catch{try{let u=v;u=u.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let r=!1,m=!1,E="";for(let D=0;D<u.length;D++){const y=u[D],c=u[D+1]||"";y==='"'&&(D===0||u[D-1]!=="\\")?(m||(r=!r),E+=y):y==="'"&&(D===0||u[D-1]!=="\\")?r?E+=y:(m=!m,E+='"'):E+=y}u=E.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const O=u.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(O)}catch{return v}}})(w)}catch{}}this.updateValue(d.data,S,o),i.value=JSON.stringify(d.data,null,2),typeof o=="object"&&o!==null?this.previousValues.set(e.element,JSON.stringify(o)):this.previousValues.set(e.element,String(o)),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration)}catch{}}updateValue(i,e,d){if(e.isArray){let w=i;for(let S=0;S<e.indices.length-1;S++){const o=e.indices[S];for(;w.length<=o;)w.push(S===e.indices.length-2?[]:{});Array.isArray(w[o])||(w[o]=[]),w=w[o]}const g=e.indices[e.indices.length-1];for(;w.length<=g;)w.push({});if(e.props.length>0){let S=w[g];for(let o=0;o<e.props.length-1;o++){const v=e.props[o];(!S[v]||typeof S[v]!="object")&&(S[v]={}),S=S[v]}S[e.props[e.props.length-1]]=d}else w[g]=d}else{let w=i;e.props.length>0&&(e.props.slice(0,-1).forEach(g=>{(!w[g]||typeof w[g]!="object")&&(w[g]={}),w=w[g]}),w[e.props[e.props.length-1]]=d)}}parsePath(i,e){const d=[...i.matchAll(/\[(\d+)\]/g)].map(w=>parseInt(w[1]));if(d.length>0){const w=i.replace(/\[\d+\]/g,"").replace(/^\./,""),g=w?w.split(".").filter(Boolean):[];return{isArray:!0,indices:d,props:g}}return{isArray:!1,props:i.replace(/^\./,"").split(".").filter(Boolean)}}updateChildren(i,e){if(this.clearAllMutations(),typeof i.data!="object"||i.data===null){i.children.forEach(w=>{w.element.value=""});return}let d=!1;i.children.forEach(w=>{try{const g=this.parsePath(w.path,i.isArray),S=this.previousValues.get(w.element)||"",o=this.getValue(i.data,g);let v=!1;if(o.startsWith("{")||o.startsWith("["))try{const u=S?JSON.parse(S):null,r=o?JSON.parse(o):null;v=JSON.stringify(u)!==JSON.stringify(r)}catch{v=o!==S}else v=o!==S;v&&(w.element.classList.add(this.options.mutatingClass),d=!0,this.previousValues.set(w.element,o)),w.element.value=o}catch(g){console.error("Child update error:",g),w.element.value=""}}),d&&(e.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration))}getValue(i,e){if(!i||typeof i!="object")return"";let d=i;if(e.isArray){for(const w of e.indices){if(!Array.isArray(d)||w>=d.length)return"";d=d[w]}for(const w of e.props)if(!d||typeof d!="object"||(d=d[w],d===void 0))return"";return this.formatValueForDisplay(d)}else{for(let w=0;w<e.props.length;w++){const g=e.props[w];if(!d||typeof d!="object"||(d=d[g],d===void 0))return""}return this.formatValueForDisplay(d)}}formatValueForDisplay(i){return i==null?"":typeof i=="object"?JSON.stringify(i,null,2):String(i)}handleFocus(i,e){clearTimeout(this.blurTimeout),this.wrapper.classList.add("jfs_has_focused"),this.wrapper.querySelectorAll(".focused").forEach(d=>d.classList.remove("focused")),i.classList.add("focused"),i===e?this.parentMap.get(e).children.forEach(d=>d.element.classList.add("focused")):e.classList.add("focused")}handleBlur(i,e){this.blurTimeout=setTimeout(()=>{const d=[e,...this.parentMap.get(e).children.map(w=>w.element)];d.some(w=>w.matches(":focus"))||(d.forEach(w=>w.classList.remove("focused")),this.wrapper.querySelector(".focused")||this.wrapper.classList.remove("jfs_has_focused"))},50)}clearAllMutations(){this.wrapper.querySelectorAll(`.${this.options.mutatingClass}`).forEach(i=>i.classList.remove(this.options.mutatingClass)),this.wrapper.classList.remove(this.options.mutatingWrapperClass)}}async function Ai(a){return(await Ni(a))?.enabled===!0}async function Ni(a){const i=ri.get(oi)||{};let e=i?.[a];if(!e)try{const d=workspace?.agent?.id;e=(await(await fetch(`/api/page/builder/mock-data/${d}/${a}`)).json())?.data,ri.set(oi,{...i,[a]:e})}catch{console.warn("Failed to fetch mock data:")}return e||{}}async function tr(a,i){const e={...i,updatedAt:new Date().toISOString()};try{const d=workspace?.agent?.id;if((await fetch(`/api/page/builder/mock-data/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[a]:e})})).ok){const w=ri.get(oi)||{},g={...w?.[a]||{},...e};w[a]=g,ri.set(oi,w)}}catch{console.warn("Failed to save Mock Data")}}const en={BUTTON_CLASS:"_mock_data_toggle_btn",SAVE_BTN_CLASS:"_mock_data_save_btn",SAVE_BTN_LABEL_CLASS:"_mock_data_save_btn__label",LABEL_CLASS:"_btn_label",ICON_CLASS:"_btn_icon"},ke={ENABLED:{icon:"fa-toggle-on",label:"Mock Data Enabled",color:"text-[#3C89F9]"},DISABLED:{icon:"fa-toggle-off",label:"Use Mock Data",color:"text-grey-600"}};function er(a){return new Promise(async(i,e)=>{const d=async(S,o)=>{const v=(await Ni(a.uid))?.data?.outputs||{};return S.map((u,r)=>{let m=v?.[u?.name]??"";m=typeof m=="object"?JSON.stringify(m,null,2):String(m);const E=u?.fieldClasses||"",O=Object.entries(u?.attributes||{}).map(([D,y])=>`${D}="${y}"`).join(" ");return u.type==="file"?`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${u.name}
                </span>
                <input type="file" name="${u.name}" id="${o}-input-${r}" class="${o}-input input
                  block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4 file:rounded-md
                  file:border-0 file:text-sm file:font-semibold
                  file:bg-gray-200 file:text-gray-900
                  hover:file:bg-gray-300 pl-5
                " multiple>
              </div>`:`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${u.name}
                </span>
                <textarea id="${o}-input-${r}" name="${u.name}" class="${o}-input input block p-1 w-full text-sm text-gray-900 bg-gray-50 rounded-e-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 ${E}" style="min-height:44px; height: 44px;" ${O}>${m}</textarea>
              </div>`}).join("")},w=[...a.domElement.querySelectorAll(".output-endpoint")].map(S=>{const o=S.getAttribute("smt-name"),v=S.getAttribute("smt-expression")||o;return{name:o,expression:v,fieldClasses:fs,attributes:{"data-expression":v}}}),g=await d(w,"outputs");Vs({title:"Configure Mock Output Data",content:`
        <div class="mb-4">
          <p class="text-xs text-gray-500">
            Mock output data allows you to test your component without requiring actual API keys or credentials. 
            Configure sample responses below to simulate the component's behavior.
          </p>
        </div>
        ${g}
      `,actions:[{label:`<span class="flex items-center gap-2">
                  <span class="fa-solid fa-save"></span>
                  <span class="!text-[#3b82f6] group-hover:!text-white ${en.SAVE_BTN_LABEL_CLASS}">Save</span>
                </span>`,cssClass:`border border-[#3b82f6] bg-white hover:bg-[#3b82f6] group transition-all duration-200 !text-[#3b82f6] hover:!text-white ${en.SAVE_BTN_CLASS}`,callback:async(S,o)=>{const v=o.querySelector(`.${en.SAVE_BTN_CLASS}`),u=v.querySelector(`.${en.SAVE_BTN_LABEL_CLASS}`);v.disabled=!0,v?.classList.add("cursor-not-allowed"),u.textContent="Saving...";const r={},m=Array.from(o.querySelectorAll(".outputs-input.input")).reduce((E,O,D)=>{let y;try{r[D]?y=r[D].value:y=al(O.value)||O.value}catch{y=O.value}return E[w[D].name]=y,E},{});try{await tr(a.uid,{enabled:!0,data:{outputs:m}}),Ve.track("app_set_mock_data"),i("saved")}finally{v.disabled=!1,v?.classList.remove("cursor-not-allowed"),u.textContent="Save",ai(o)}}}],onCloseClick:(S,o)=>{e("close"),ai(o)},onDOMReady:function(S){new ll(S.querySelector(".__content"),{jsonFieldClass:fs});const o=S.querySelector(".__actions");o.classList.remove("justify-center"),o.classList.add("justify-end")}})})}async function Fi(a){const i=[...a.domElement.querySelectorAll(".output-endpoint")];if(await Ai(a.uid)){const e=await Ni(a.uid);for(const d of i){const w=d.getAttribute("smt-name");let g=e?.data?.outputs?.[w];g&&d.setAttribute("smt-mock-data",typeof g=="object"?JSON.stringify(g):g)}}else i.forEach(e=>{e.removeAttribute("smt-mock-data")})}const Tn={elements(a){return{button:a.domElement.querySelector(`.${en.BUTTON_CLASS}`),label:a.domElement.querySelector(`.${en.LABEL_CLASS}`),icon:a.domElement.querySelector(`.${en.ICON_CLASS}`)}},turnOn(a){const{button:i,label:e,icon:d}=this.elements(a);i.classList.remove(ke.DISABLED.color),i.classList.add(ke.ENABLED.color),e.textContent=ke.ENABLED.label,d.classList.remove(ke.DISABLED.icon),d.classList.add(ke.ENABLED.icon)},turnOff(a){const{button:i,label:e,icon:d}=this.elements(a);i.classList.remove(ke.ENABLED.color),i.classList.add(ke.DISABLED.color),e.textContent=ke.DISABLED.label,d.classList.remove(ke.ENABLED.icon),d.classList.add(ke.DISABLED.icon)},setLoadingState(a){const{button:i}=this.elements(a);i.classList.contains("text-[#3C89F9]")&&i.classList.remove("text-[#3C89F9]"),i.disabled=!0,i.classList.add("cursor-not-allowed")},clearLoadingState(a){const{button:i}=this.elements(a);i.disabled=!1,i.classList.remove("cursor-not-allowed")}},wi=new Set;async function cl(a){const i=a.uid;if(!wi.has(i)){wi.add(i);try{const e=await Ai(i)?"ENABLED":"DISABLED";let d=ke[e].label,w=ke[e].icon,g=ke[e].color;a.addComponentButton(`<div class="fa-solid ${w} text-base _btn_icon"></div>
       <span class="ml-2 font-semibold _btn_label">${d}</span>`," ",{class:`${en.BUTTON_CLASS} ${g} transition-opacity duration-300`,customStyle:"toggle",position:"top"},async()=>{try{const S=async()=>{await Ai(i)?(await tr(a.uid,{enabled:!1}),Tn.turnOff(a)):(Ve.track("app_mock_screen_impression",{source:"use_mock_data_button"}),await er(a),Tn.turnOn(a))};Tn.setLoadingState(a),await S(),await Fi(a)}catch{console.error("Failed to toggle mock data")}finally{Tn.clearLoadingState(a)}})}finally{wi.delete(i)}}}function As(a,i,e){if(!i)return;const d=Array.isArray(i)?i:i.trim().split(/\s+/);a.classList[e](...d)}function Ri(a={step:{enable:!1},run:{enable:!1,tooltipText:"Run",icon:"mif-play"},stop:{enable:!1},attach:{enable:!1}},i={}){for(const[g,S]of Object.entries(a)){if(!S)continue;const o=document.getElementById(`debug-menubtn-${g}`);if(!o)continue;const{enable:v,classesToAdd:u,classesToRemove:r,tooltipText:m,icon:E}=S;if(v?o.removeAttribute("disabled"):o.setAttribute("disabled","true"),As(o,u,"add"),As(o,r,"remove"),m){const O=document.querySelector(`#tooltip-${g}`);O&&(O.textContent=m)}if(E){o.querySelectorAll(".debug-btn-icon").forEach(D=>D.classList.add("hidden"));const O=o.querySelector(`.${E}`);O&&O.classList.remove("hidden")}}const e=document.getElementById("debug-controls-overlay"),d=document.getElementById("tooltip-controls-overlay"),w=i.controlsOverlay;w?.enable?(e?.classList.remove("hidden"),w.tooltipText&&d&&(d.textContent=w.tooltipText)):e?.classList.add("hidden")}function nr(a={}){Ri({run:{enable:!0},step:{enable:!0},stop:{enable:!0},attach:{enable:!0}},a)}function Ds(){const a=!!document.querySelector(".component.selected"),i=!!document.querySelector(".component.dbg-active"),e=!!document.querySelector(".component.dbg-running"),d=ul()==="error";if(i||e)return;const w=document.getElementById("debug-menu-tgl")?.checked;a&&w?nr({controlsOverlay:{enable:!1}}):Ri({run:{enable:!1},step:{enable:!1},stop:{enable:d},attach:{enable:w}},{controlsOverlay:{enable:!w||!a&&!d,tooltipText:w?"Please select a component":"Click to toggle debug"}})}ks.languages.smythLog={error:{pattern:/^Error\s:.*$/m,inside:{keyword:/^Error/},greedy:!0},json:{pattern:/{[^{}]*}/,inside:ks.languages.json,greedy:!0}};function ul(){if(document.querySelectorAll(".component.dbg-active").length>0)return"inprogress";const a=(document.querySelector("#debug-status pre")?.innerHTML||"").trim().split(`
`)?.[0],i=document.querySelectorAll(".component .btn-debug-log:not(.hidden)");if(a.includes("Debug session completed successfully")&&i.length>0)return"success";const e=document.querySelectorAll(".component .error");return(a.includes("Debug session failed")||a.includes("An error occured"))&&e.length>0?"error":"default"}function dl(a){var i=a.jsPlumb,e=a.jsPlumbUtil,d="Straight",w="Arc",g=function(S){this.type="SmythFlowchart",S=S||{},S.stub=S.stub==null?30:S.stub;var o,v=i.Connectors.AbstractConnector.apply(this,arguments),u=S.midpoint==null||isNaN(S.midpoint)?.5:S.midpoint,r=S.alwaysRespectStubs===!0,m=null,E=null,O=S.cornerRadius!=null?S.cornerRadius:0;S.loopbackRadius;var D=function(M){return M<0?-1:M===0?0:1},y=function(M){return[D(M[2]-M[0]),D(M[3]-M[1])]},c=function(M,A,I,l){if(!(m===A&&E===I)){var T=m??l.sx,x=E??l.sy,R=T===A?"v":"h";m=A,E=I,M.push([T,x,A,I,R])}},F=function(M){return Math.sqrt(Math.pow(M[0]-M[2],2)+Math.pow(M[1]-M[3],2))},k=function(M){var A=[];return A.push.apply(A,M),A},B=function(M,A,I){for(var l=null,T,x,R,G=0;G<A.length-1;G++){if(l=l||k(A[G]),T=k(A[G+1]),x=y(l),R=y(T),O>0&&l[4]!==T[4]){var C=Math.min(F(l),F(T)),W=Math.min(O,C/1.5);l[2]-=x[0]*W,l[3]-=x[1]*W,T[0]+=R[0]*W,T[1]+=R[1]*W;var V=x[1]===R[0]&&R[0]===1||x[1]===R[0]&&R[0]===0&&x[0]!==R[1]||x[1]===R[0]&&R[0]===-1,Y=T[1]>l[3]?1:-1,L=T[0]>l[2]?1:-1,q=Y===L,tt=q&&V||!q&&!V?T[0]:l[2],K=q&&V||!q&&!V?l[3]:T[1];v.addSegment(M,d,{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),v.addSegment(M,w,{r:W,x1:l[2],y1:l[3],x2:T[0],y2:T[1],cx:tt,cy:K,ac:V})}else{var rt=l[2]===l[0]?0:l[2]>l[0]?I.lw/2:-(I.lw/2),f=l[3]===l[1]?0:l[3]>l[1]?I.lw/2:-(I.lw/2);v.addSegment(M,d,{x1:l[0]-rt,y1:l[1]-f,x2:l[2]+rt,y2:l[3]+f})}l=T}T!=null&&v.addSegment(M,d,{x1:T[0],y1:T[1],x2:T[2],y2:T[3]})};this.midpoint=u,this._compute=function(M,A){o=[],m=null,E=null,M._meta||(M._meta={});var I=A.sourceEndpoint._domElement,l=A.targetEndpoint._domElement;I.classList.contains("output-endpoint")||([I,l]=[l,I]);let T=0;const x=this._jsPlumb.instance.getZoom();if(I&&l){const z=I.getBoundingClientRect(),U=l.getBoundingClientRect(),nt=M._meta.sourceComponentElement||I.closest(".component");M._meta.sourceComponentElement=nt;const ot=nt.getBoundingClientRect(),Z=M._meta.targetComponentElement||l.closest(".component");M._meta.targetComponentElement=Z;const ut=Z.getBoundingClientRect(),dt=M._meta.outputsElement||nt.querySelector(".ep-control.outputs");M._meta.outputsElement=dt;const ft=M._meta.inputsElement||Z.querySelector(".ep-control.inputs");M._meta.inputsElement=ft;const ct=dt.getBoundingClientRect(),xt=ft.getBoundingClientRect();if(U.left<=z.right){const Pt=(ot.bottom-z.top)/(ot.bottom-ct.bottom);u=(ot.bottom-15*x-z.top)/(U.bottom-z.bottom),u+=ut.bottom>ot.bottom?Pt/10:-Pt/10,ut.bottom<ot.top&&(u=(z.top-ot.top+15*x)/(z.bottom-U.bottom),u+=ut.bottom<ot.bottom?Pt/10:-Pt/10),T=26*Pt}else{const Pt=U.left-z.right;u=(ot.bottom-z.top)/(ot.bottom-ct.bottom),xt.bottom<ct.top&&(u=1-u),Pt>110&&(u*=1/Pt*100*.6),u*=x}}var R=function(){return[M.startStubX,M.startStubY,M.endStubX,M.endStubY]},G={perpendicular:R,orthogonal:R,opposite:function(z){var U=M,nt=z==="x"?0:1,ot={x:function(){return U.so[nt]===1&&(U.startStubX>U.endStubX&&U.tx>U.startStubX||U.sx>U.endStubX&&U.tx>U.sx)||U.so[nt]===-1&&(U.startStubX<U.endStubX&&U.tx<U.startStubX||U.sx<U.endStubX&&U.tx<U.sx)},y:function(){return U.so[nt]===1&&(U.startStubY>U.endStubY&&U.ty>U.startStubY||U.sy>U.endStubY&&U.ty>U.sy)||U.so[nt]===-1&&(U.startStubY<U.endStubY&&U.ty<U.startStubY||U.sy<U.endStubY&&U.ty<U.sy)}};return!r&&ot[z]()?{x:[(M.sx+M.tx)/2,M.startStubY,(M.sx+M.tx)/2,M.endStubY],y:[M.startStubX,(M.sy+M.ty)/2,M.endStubX,(M.sy+M.ty)/2]}[z]:[M.startStubX+T,M.startStubY,M.endStubX+T-20,M.endStubY]}},C=G[M.anchorOrientation](M.sourceAxis),W=M.sourceAxis==="x"?0:1,V=M.sourceAxis==="x"?1:0,Y=C[W],L=C[V],q=C[W+2],tt=C[V+2];c(o,C[0],C[1],M);var K=M.startStubX+(M.endStubX-M.startStubX)*u,rt=M.startStubY+(M.endStubY-M.startStubY)*u,f={x:[0,1],y:[1,0]},_={perpendicular:function(z){var U=M,nt={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},ot={x:[[U.startStubX,U.endStubX],null,[U.endStubX,U.startStubX]],y:[[U.startStubY,U.endStubY],null,[U.endStubY,U.startStubY]]},Z={x:[[K,U.startStubY],[K,U.endStubY]],y:[[U.startStubX,rt],[U.endStubX,rt]]},ut={x:[[U.endStubX,U.startStubY]],y:[[U.startStubX,U.endStubY]]},dt={x:[[U.startStubX,U.endStubY],[U.endStubX,U.endStubY]],y:[[U.endStubX,U.startStubY],[U.endStubX,U.endStubY]]},ft={x:[[U.startStubX,rt],[U.endStubX,rt],[U.endStubX,U.endStubY]],y:[[K,U.startStubY],[K,U.endStubY],[U.endStubX,U.endStubY]]},ct={x:[U.startStubY,U.endStubY],y:[U.startStubX,U.endStubX]},xt=f[z][0],Pt=f[z][1],Ot=U.so[xt]+1,Ct=U.to[Pt]+1,Rt=U.to[Pt]===-1&&ct[z][1]<ct[z][0]||U.to[Pt]===1&&ct[z][1]>ct[z][0],Mt=ot[z][Ot][0],vt=ot[z][Ot][1],mt=nt[z][Ot][Ct];if(U.segment===mt[3]||U.segment===mt[2]&&Rt)return Z[z];if(U.segment===mt[2]&&vt<Mt)return ut[z];if(U.segment===mt[2]&&vt>=Mt||U.segment===mt[1]&&!Rt)return ft[z];if(U.segment===mt[0]||U.segment===mt[1]&&Rt)return dt[z]},orthogonal:function(z,U,nt,ot,Z){var ut=M,dt={x:ut.so[0]===-1?Math.min(U,ot):Math.max(U,ot),y:ut.so[1]===-1?Math.min(U,ot):Math.max(U,ot)}[z];return{x:[[dt,nt],[dt,Z],[ot,Z]],y:[[nt,dt],[Z,dt],[Z,ot]]}[z]},opposite:function(z,U,nt,ot){var Z=M,ut={x:"y",y:"x"}[z],dt={x:"height",y:"width"}[z],ft=Z["is"+z.toUpperCase()+"GreaterThanStubTimes2"];if(A.sourceEndpoint.elementId===A.targetEndpoint.elementId){var ct=nt+(1-A.sourceEndpoint.anchor[ut])*A.sourceInfo[dt]+v.maxStub;return{x:[[U,ct],[ot,ct]],y:[[ct,U],[ct,ot]]}[z]}else{if(!ft||Z.so[W]===1&&U>ot||Z.so[W]===-1&&U<ot)return{x:[[U,rt],[ot,rt]],y:[[K,U],[K,ot]]}[z];if(Z.so[W]===1&&U<ot||Z.so[W]===-1&&U>ot)return{x:[[K,Z.sy],[K,Z.ty]],y:[[Z.sx,rt],[Z.tx,rt]]}[z]}}},h=_[M.anchorOrientation](M.sourceAxis,Y,L,q,tt);if(h)for(var N=0;N<h.length;N++)c(o,h[N][0],h[N][1],M);c(o,C[2],C[3],M),c(o,M.tx,M.ty,M),B(this,o,M)}};i.Connectors.SmythFlowchart=g,e.extend(i.Connectors.SmythFlowchart,i.Connectors.AbstractConnector)}function hl(a){var i=a.jsPlumb,e=a.jsPlumbUtil,d=function(w){w=w||{},this.type="SmythBezier";var g=i.Connectors.AbstractBezierConnector.apply(this,arguments),S=w.curviness||150,o=10;this.getCurviness=function(){return S},this._findControlPoint=function(v,u,r,m,E,O,D){let y=S,c=m._domElement,F=E._domElement;try{if(c&&F){c.classList.contains("output-endpoint")||([c,F]=[F,c]);var k=c.closest(".component").getBoundingClientRect(),B=F.closest(".component").getBoundingClientRect();const I=B.left-k.right,l=k.bottom<B.top||B.bottom<k.top,T=Math.min(Math.abs(k.top-B.bottom),Math.abs(k.bottom-B.top));y=l||I>150?S:50}else y=o}catch(I){console.log("Error in _findControlPoint",I)}var M=O[0]!==D[0]||O[1]===D[1],A=[];return M?(D[0]===0?A.push(r[0]<u[0]?v[0]+o:v[0]-o):A.push(v[0]+y*D[0]),D[1]===0?A.push(r[1]<u[1]?v[1]+o:v[1]-o):A.push(v[1]+y*O[1])):(O[0]===0?A.push(u[0]<r[0]?v[0]+o:v[0]-o):A.push(v[0]-y*O[0]),O[1]===0?A.push(u[1]<r[1]?v[1]+o:v[1]-o):A.push(v[1]+y*D[1])),A},this._computeBezier=function(v,u,r,m,E,O){var D,y,c=r[0]<m[0]?E:0,F=r[1]<m[1]?O:0,k=r[0]<m[0]?0:E,B=r[1]<m[1]?0:O;D=this._findControlPoint([c,F],r,m,u.sourceEndpoint,u.targetEndpoint,v.so,v.to),y=this._findControlPoint([k,B],m,r,u.targetEndpoint,u.sourceEndpoint,v.to,v.so),g.addSegment(this,"Bezier",{x1:c,y1:F,x2:k,y2:B,cp1x:D[0],cp1y:D[1],cp2x:y[0],cp2y:y[1]})}};i.Connectors.SmythBezier=d,e.extend(d,i.Connectors.AbstractBezierConnector)}function pl(){dl(window),hl(window)}window.__GLOBAL_TEMPLATE_VARIABLES__=new Map;const Si=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ei(a,i,e,d){a.addEventListener?a.addEventListener(i,e,d):a.attachEvent&&a.attachEvent("on".concat(i),e)}function kn(a,i,e,d){a.removeEventListener?a.removeEventListener(i,e,d):a.detachEvent&&a.detachEvent("on".concat(i),e)}function ir(a,i){const e=i.slice(0,i.length-1);for(let d=0;d<e.length;d++)e[d]=a[e[d].toLowerCase()];return e}function sr(a){typeof a!="string"&&(a=""),a=a.replace(/\s/g,"");const i=a.split(",");let e=i.lastIndexOf("");for(;e>=0;)i[e-1]+=",",i.splice(e,1),e=i.lastIndexOf("");return i}function fl(a,i){const e=a.length>=i.length?a:i,d=a.length>=i.length?i:a;let w=!0;for(let g=0;g<e.length;g++)d.indexOf(e[g])===-1&&(w=!1);return w}const Nn={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":Si?173:189,"=":Si?61:187,";":Si?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},Be={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,meta:91,command:91},On={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},pe={16:!1,18:!1,17:!1,91:!1},ce={};for(let a=1;a<20;a++)Nn["f".concat(a)]=111+a;let oe=[],In=null,rr="all";const Ye=new Map,yn=a=>Nn[a.toLowerCase()]||Be[a.toLowerCase()]||a.toUpperCase().charCodeAt(0),gl=a=>Object.keys(Nn).find(i=>Nn[i]===a),ml=a=>Object.keys(Be).find(i=>Be[i]===a);function or(a){rr=a||"all"}function Fn(){return rr||"all"}function vl(){return oe.slice(0)}function yl(){return oe.map(a=>gl(a)||ml(a)||String.fromCharCode(a))}function bl(){const a=[];return Object.keys(ce).forEach(i=>{ce[i].forEach(e=>{let{key:d,scope:w,mods:g,shortcut:S}=e;a.push({scope:w,shortcut:S,mods:g,keys:d.split("+").map(o=>yn(o))})})}),a}function xl(a){const i=a.target||a.srcElement,{tagName:e}=i;let d=!0;const w=e==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(i.type);return(i.isContentEditable||(w||e==="TEXTAREA"||e==="SELECT")&&!i.readOnly)&&(d=!1),d}function wl(a){return typeof a=="string"&&(a=yn(a)),oe.indexOf(a)!==-1}function Sl(a,i){let e,d;a||(a=Fn());for(const w in ce)if(Object.prototype.hasOwnProperty.call(ce,w))for(e=ce[w],d=0;d<e.length;)e[d].scope===a?e.splice(d,1).forEach(S=>{let{element:o}=S;return $i(o)}):d++;Fn()===a&&or(i||"all")}function El(a){let i=a.keyCode||a.which||a.charCode;a.key&&a.key.toLowerCase()==="capslock"&&(i=yn(a.key));const e=oe.indexOf(i);if(e>=0&&oe.splice(e,1),a.key&&a.key.toLowerCase()==="meta"&&oe.splice(0,oe.length),(i===93||i===224)&&(i=91),i in pe){pe[i]=!1;for(const d in Be)Be[d]===i&&(nn[d]=!1)}}function ar(a){if(typeof a>"u")Object.keys(ce).forEach(w=>{Array.isArray(ce[w])&&ce[w].forEach(g=>Zn(g)),delete ce[w]}),$i(null);else if(Array.isArray(a))a.forEach(w=>{w.key&&Zn(w)});else if(typeof a=="object")a.key&&Zn(a);else if(typeof a=="string"){for(var i=arguments.length,e=new Array(i>1?i-1:0),d=1;d<i;d++)e[d-1]=arguments[d];let[w,g]=e;typeof w=="function"&&(g=w,w=""),Zn({key:a,scope:w,method:g,splitKey:"+"})}}const Zn=a=>{let{key:i,scope:e,method:d,splitKey:w="+"}=a;sr(i).forEach(S=>{const o=S.split(w),v=o.length,u=o[v-1],r=u==="*"?"*":yn(u);if(!ce[r])return;e||(e=Fn());const m=v>1?ir(Be,o):[],E=[];ce[r]=ce[r].filter(O=>{const y=(d?O.method===d:!0)&&O.scope===e&&fl(O.mods,m);return y&&E.push(O.element),!y}),E.forEach(O=>$i(O))})};function Ts(a,i,e,d){if(i.element!==d)return;let w;if(i.scope===e||i.scope==="all"){w=i.mods.length>0;for(const g in pe)Object.prototype.hasOwnProperty.call(pe,g)&&(!pe[g]&&i.mods.indexOf(+g)>-1||pe[g]&&i.mods.indexOf(+g)===-1)&&(w=!1);(i.mods.length===0&&!pe[16]&&!pe[18]&&!pe[17]&&!pe[91]||w||i.shortcut==="*")&&(i.keys=[],i.keys=i.keys.concat(oe),i.method(a,i)===!1&&(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.cancelBubble&&(a.cancelBubble=!0)))}}function Os(a,i){const e=ce["*"];let d=a.keyCode||a.which||a.charCode;if(a.key&&a.key.toLowerCase()==="capslock"||!nn.filter.call(this,a))return;if((d===93||d===224)&&(d=91),oe.indexOf(d)===-1&&d!==229&&oe.push(d),["metaKey","ctrlKey","altKey","shiftKey"].forEach(o=>{const v=On[o];a[o]&&oe.indexOf(v)===-1?oe.push(v):!a[o]&&oe.indexOf(v)>-1?oe.splice(oe.indexOf(v),1):o==="metaKey"&&a[o]&&(oe=oe.filter(u=>u in On||u===d))}),d in pe){pe[d]=!0;for(const o in Be)if(Object.prototype.hasOwnProperty.call(Be,o)){const v=On[Be[o]];nn[o]=a[v]}if(!e)return}for(const o in pe)Object.prototype.hasOwnProperty.call(pe,o)&&(pe[o]=a[On[o]]);a.getModifierState&&!(a.altKey&&!a.ctrlKey)&&a.getModifierState("AltGraph")&&(oe.indexOf(17)===-1&&oe.push(17),oe.indexOf(18)===-1&&oe.push(18),pe[17]=!0,pe[18]=!0);const w=Fn();if(e)for(let o=0;o<e.length;o++)e[o].scope===w&&(a.type==="keydown"&&e[o].keydown||a.type==="keyup"&&e[o].keyup)&&Ts(a,e[o],w,i);if(!(d in ce))return;const g=ce[d],S=g.length;for(let o=0;o<S;o++)if((a.type==="keydown"&&g[o].keydown||a.type==="keyup"&&g[o].keyup)&&g[o].key){const v=g[o],{splitKey:u}=v,r=v.key.split(u),m=[];for(let E=0;E<r.length;E++)m.push(yn(r[E]));m.sort().join("")===oe.sort().join("")&&Ts(a,v,w,i)}}function nn(a,i,e){oe=[];const d=sr(a);let w=[],g="all",S=document,o=0,v=!1,u=!0,r="+",m=!1,E=!1;for(e===void 0&&typeof i=="function"&&(e=i),Object.prototype.toString.call(i)==="[object Object]"&&(i.scope&&(g=i.scope),i.element&&(S=i.element),i.keyup&&(v=i.keyup),i.keydown!==void 0&&(u=i.keydown),i.capture!==void 0&&(m=i.capture),typeof i.splitKey=="string"&&(r=i.splitKey),i.single===!0&&(E=!0)),typeof i=="string"&&(g=i),E&&ar(a,g);o<d.length;o++)a=d[o].split(r),w=[],a.length>1&&(w=ir(Be,a)),a=a[a.length-1],a=a==="*"?"*":yn(a),a in ce||(ce[a]=[]),ce[a].push({keyup:v,keydown:u,scope:g,mods:w,shortcut:d[o],method:e,key:d[o],splitKey:r,element:S});if(typeof S<"u"&&window){if(!Ye.has(S)){const O=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Os(y,S)},D=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Os(y,S),El(y)};Ye.set(S,{keydownListener:O,keyupListenr:D,capture:m}),Ei(S,"keydown",O,m),Ei(S,"keyup",D,m)}if(!In){const O=()=>{oe=[]};In={listener:O,capture:m},Ei(window,"focus",O,m)}}}function Cl(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(ce).forEach(e=>{ce[e].filter(w=>w.scope===i&&w.shortcut===a).forEach(w=>{w&&w.method&&w.method()})})}function $i(a){const i=Object.values(ce).flat();if(i.findIndex(d=>{let{element:w}=d;return w===a})<0){const{keydownListener:d,keyupListenr:w,capture:g}=Ye.get(a)||{};d&&w&&(kn(a,"keyup",w,g),kn(a,"keydown",d,g),Ye.delete(a))}if((i.length<=0||Ye.size<=0)&&(Object.keys(Ye).forEach(w=>{const{keydownListener:g,keyupListenr:S,capture:o}=Ye.get(w)||{};g&&S&&(kn(w,"keyup",S,o),kn(w,"keydown",g,o),Ye.delete(w))}),Ye.clear(),Object.keys(ce).forEach(w=>delete ce[w]),In)){const{listener:w,capture:g}=In;kn(window,"focus",w,g),In=null}}const Ci={getPressedKeyString:yl,setScope:or,getScope:Fn,deleteScope:Sl,getPressedKeyCodes:vl,getAllKeyCodes:bl,isPressed:wl,filter:xl,trigger:Cl,unbind:ar,keyMap:Nn,modifier:Be,modifierMap:On};for(const a in Ci)Object.prototype.hasOwnProperty.call(Ci,a)&&(nn[a]=Ci[a]);if(typeof window<"u"){const a=window.hotkeys;nn.noConflict=i=>(i&&window.hotkeys===nn&&(window.hotkeys=a),nn),window.hotkeys=nn}var _l={exports:{}};(function(a,i){(function(e,d){d()})(ne,function(){function e(u,r){return typeof r>"u"?r={autoBom:!1}:typeof r!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function d(u,r,m){var E=new XMLHttpRequest;E.open("GET",u),E.responseType="blob",E.onload=function(){v(E.response,r,m)},E.onerror=function(){console.error("could not download file")},E.send()}function w(u){var r=new XMLHttpRequest;r.open("HEAD",u,!1);try{r.send()}catch{}return 200<=r.status&&299>=r.status}function g(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(r)}}var S=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ne=="object"&&ne.global===ne?ne:void 0,o=S.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=S.saveAs||(typeof window!="object"||window!==S?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(u,r,m){var E=S.URL||S.webkitURL,O=document.createElement("a");r=r||u.name||"download",O.download=r,O.rel="noopener",typeof u=="string"?(O.href=u,O.origin===location.origin?g(O):w(O.href)?d(u,r,m):g(O,O.target="_blank")):(O.href=E.createObjectURL(u),setTimeout(function(){E.revokeObjectURL(O.href)},4e4),setTimeout(function(){g(O)},0))}:"msSaveOrOpenBlob"in navigator?function(u,r,m){if(r=r||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(e(u,m),r);else if(w(u))d(u,r,m);else{var E=document.createElement("a");E.href=u,E.target="_blank",setTimeout(function(){g(E)})}}:function(u,r,m,E){if(E=E||open("","_blank"),E&&(E.document.title=E.document.body.innerText="downloading..."),typeof u=="string")return d(u,r,m);var O=u.type==="application/octet-stream",D=/constructor/i.test(S.HTMLElement)||S.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||O&&D||o)&&typeof FileReader<"u"){var c=new FileReader;c.onloadend=function(){var B=c.result;B=y?B:B.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=B:location=B,E=null},c.readAsDataURL(u)}else{var F=S.URL||S.webkitURL,k=F.createObjectURL(u);E?E.location=k:location.href=k,E=null,setTimeout(function(){F.revokeObjectURL(k)},4e4)}});S.saveAs=v.saveAs=v,a.exports=v})})(_l);pl();const Oe={conStartColor:"#3C89F9",conEndColor:"#F35063"};var lr=(a=>(a.APIEndpoint="/agent-studio/components/base/agent-skill",a.APIOutput="/agent-studio/components/base/api-output",a.Classifier="/agent-studio/components/base/classifier",a.GenAILLM="/agent-studio/components/base/gen-ai-llm",a.ImageGenerator="/agent-studio/components/base/image-generator",a.Note="/agent-studio/components/base/note",a.APICall="/agent-studio/components/advanced/api-call",a.Async="/agent-studio/components/advanced/async",a.Await="/agent-studio/components/advanced/await",a.Code="/agent-studio/components/advanced/code",a.ForEach="/agent-studio/components/advanced/for-each",a.JSONFilter="/agent-studio/components/advanced/json-filter",a.LLMAssistant="/agent-studio/components/advanced/llm-assistant",a.FSleep="/agent-studio/components/advanced/sleep",a.ComputerUse="/agent-studio/components/tools/computer-use",a.MCPClient="/agent-studio/components/tools/mcp-client",a.ServerlessCode="/agent-studio/components/tools/node-js",a.WebScrape="/agent-studio/components/tools/web-scrape",a.WebSearch="/agent-studio/components/tools/web-search",a.FEncDec="/agent-studio/components/crypto/encode-decode",a.FHash="/agent-studio/components/crypto/hash",a.FSign="/agent-studio/components/crypto/sign",a.FTimestamp="/agent-studio/components/crypto/timestamp",a.DataSourceCleaner="/agent-studio/components/rag-data/rag-forget",a.DataSourceIndexer="/agent-studio/components/rag-data/rag-remember",a.DataSourceLookup="/agent-studio/components/rag-data/rag-search",a.LogicAND="/agent-studio/components/logic/logical-and",a.LogicOR="/agent-studio/components/logic/logical-or",a.LogicXOR="/agent-studio/components/logic/logical-xor",a.LogicAtLeast="/agent-studio/components/logic/logical-at-least",a.LogicAtMost="/agent-studio/components/logic/logical-at-most",a.PromptGenerator="/agent-studio/components/legacy/llm-prompts",a.MultimodalLLM="/agent-studio/components/legacy/multimodal-llm",a.VisionLLM="/agent-studio/components/legacy/vision-llm",a.GPTPlugin="/agent-studio/integrations/openapi-integration",a.AgentPlugin="/agent-studio/integrations/smythos-agents-integration",a.HuggingFace="/agent-studio/integrations/hugging-face-integration",a.ZapierAction="/agent-studio/integrations/zapier-integration",a))(lr||{});function Pl(a){const i=this;a.querySelector(".title");const e=a.querySelector(".dialog-actions");a.querySelector(".title-right-buttons");const d=a.querySelector(".title-left-buttons"),w=e.querySelector("button.del-btn");w.classList.remove("hidden"),w.onclick=i.delete.bind(this,!1);const g=i.properties?.template?.templateInfo?.docPath||"/not-set",S=i.properties?.template?i.workspace.serverData.docUrl+g:i.docUrl,o=d.querySelector(".action-help");o.onclick=()=>{window.open(S,"_blank")},i.properties?.template&&!i.properties?.template?.templateInfo?.docPath&&o.classList.add("hidden"),i.workspace?.locked?(Ho(a,["close-btn","action-help"]),a.querySelector(".save-btn").classList.add("hidden"),a.querySelector(".del-btn").classList.add("hidden")):(a.querySelector(".save-btn").classList.remove("hidden"),a.querySelector(".del-btn").classList.remove("hidden"));const v=a.querySelector("form");function u(m){Tl(i)}const r=Yo(u,500);v.addEventListener("input",function(m){(m.target.tagName==="INPUT"||m.target.tagName==="TEXTAREA")&&r(m)}),v.addEventListener("change",function(m){(m.target.tagName==="SELECT"||m.target.tagName==="INPUT"&&(m.target.type==="checkbox"||m.target.type==="radio"))&&r(m)}),i.emit("settingsOpened",a,this)}function kl(a){const i=this;i.properties.template,a.querySelector(".title");const e=a.querySelector(".dialog-actions"),d=a.querySelector(".title-right-buttons"),w=a.querySelector(".title-left-buttons");d.querySelector("button.close-btn").classList.remove("hidden"),d.querySelector("button.save-btn").classList.add("hidden"),e.querySelector("button.del-btn").classList.add("hidden"),w.querySelector(".action-help").classList.add("hidden"),i.data._templateVars;const g=i.properties?.template?.templateInfo,S=a.querySelector("form.Settings");if(S){const o=[...S.querySelectorAll(".form-box")],v=(u,r)=>{let m=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm.exec(u.value);const E=u.closest(".form-box").querySelector(".chk-bind-setting");if(!E)return;const O=E?.previousElementSibling;m?(E.checked=!1,E.disabled=!0,E.classList.add("hidden"),O.innerHTML="Override Not allowed With Custom Variables"):(E.disabled=!1,E.classList.remove("hidden"),O.innerText="Allow Override")};for(let u of o){const r=document.createElement("div");u.appendChild(r);const m=u.querySelectorAll("input, textarea");m?.forEach(B=>{B.addEventListener("change",M=>{console.log("Change Event",M),v(M.target)}),B.addEventListener("mouseout",M=>v(M.target)),B.addEventListener("keyup",M=>{(M.ctrlKey||M.metaKey)&&v(M.target)}),setTimeout(()=>v(B),1e3)}),S.addEventListener("mouseout",B=>{m.forEach(M=>{v(M)})});const E=document.createElement("div");E.className="float-right inline-block rounded-full",E.style.pointerEvents="auto";const O=document.createElement("div");O.className="bg-gray-300 rounded-full pr-6 pl-2 py-1 absolute inset-0",O.style.pointerEvents="none";const D=document.createElement("div");D.className="relative flex items-center gap-2",D.style.pointerEvents="none";const y=document.createElement("label");y.innerText="Allow Override",y.className="px-1 cursor-pointer";const c=document.createElement("input");c.type="checkbox",c.className="chk-bind-setting w-4 h-4 text-gray-600 focus:outline-none cursor-pointer relative z-10",c.style.pointerEvents="auto";const F=`chk-${u.getAttribute("data-field-name")}`;c.id=F,y.htmlFor=F,D.appendChild(y),D.appendChild(c),E.appendChild(O),E.appendChild(D),r.appendChild(E);const k=u.getAttribute("data-field-name");c.checked=k&&g?.includedSettings?.includes(k)}}}async function Ls(a){if(!a){console.log("Invalid form");return}const i=this,e=a.Settings;if(i.emit("settingsSaving",e),e?.prompt&&(i.title===i.displayName||i.aiTitle===i.title)){const d=i.settingsEntries;e?.prompt&&e?.prompt!==d?.prompt?.value&&await i.updateTitle()}if(!await i.save(e)){ae("Error saving settings");return}if(i.properties.template){const d=i.templateSettings;i.data._templateVars;const w=i.properties?.template?.templateInfo?.includedSettings||[];for(let g of w)i.data[g]=e[g];i.data._templateVars={};for(let g in d)i.data._templateVars[g]=e[g]}else for(let d in i.settings)i.data[d]=e[d];i.emit("settingsSaved",e),i.emit("settingsClosed"),i.domElement.classList.remove("active"),Le.curComponentSettings=null,await be(100),i.workspace.saveAgent(),i.unsetTemplateEditMode()}async function Al(a){const i=this,e=a.Settings;let d={};for(let w in e)d[w]=e[w]?.value||"";i.emit("settingsDraftUpdated",d)}const Dl={html1:{type:"div",classOverride:"all-initial p-2 px-4",html:`
<h1 class="text-lg font-bold text-emerald-600 mt-6">Component Template Builder Help</h1>

<div class="bg-gray-200 p-4 rounded-md" ><b>Note : </b> This help section explains the usage of custom template variables, this is an MVP implementation, a <b>Visual Editor</b> will replace it later</div>

<p class="mt-4">You can use the following annotations inside text inputs in order to generate additional fields in the new component : </p>
<ul>
<li><b class="w-8"> * Select</b> : {{<span class="font-bold text-indigo-700">SELECT</span>:<span class="font-bold text-emerald-700">Select label</span>:<span class="font-bold text-blue-700">["value1", "value2", "value3"]</span>}}</li>
<li><b class="w-8"> * Range</b> : {{<span class="font-bold text-indigo-700">RANGE</span>:<span class="font-bold text-emerald-700">Range label</span>:<span class="font-bold text-blue-700">{"min":0,"max":10,"step":1,"value":5}</span>}}</li>
<li><b class="w-8"> * Key-Value</b> : {{<span class="font-bold text-indigo-700">KVJSON</span>:<span class="font-bold text-emerald-700">KV label</span>:<span class="font-bold text-blue-700">{"field1":"value1","field2":10,"field3":""}</span>}}</li>
<li><b class="w-8"> * Text Input</b> : {{<span class="font-bold text-indigo-700">INPUT</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}} </li>
<li><b class="w-8"> * Text Area</b> : {{<span class="font-bold text-indigo-700">TEXTAREA</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
<li><b class="w-8"> * Password</b> : {{<span class="font-bold text-indigo-700">PASSWORD</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
</ul>


<p class="mt-4">

The <span class="font-bold text-indigo-700">first field</span> (in CAPITAL letters) is the field type, it should always be one of the following : SELECT, INPUT, TEXTAREA, PASSWORD.<br/>
you can use variant annotations like : <br />
 - VARINPUT, VARTEXTAREA for an text inputs that accepts variables<br />
 - VAULTPASSWORD for a password field that can be managed using the vault <br />
</p>

<p class="mt-4">
The <span class="font-bold text-emerald-700">second field</span> is the label that will be displayed in the component settings, this is a free text, but keep it short.
</p>

<p class="mt-4">
The <span class="font-bold text-blue-700">last field</span> should be an array of possible values for SELECT input, or an empty element [""].<br/>
<b>It's important to use the empty element [""] even if no value is configured.</b>
</p>

        `}};async function Tl(a){const i=a.getSettingsSidebar();if(!i)return;const e=await Wo(i);if(!e)return;const d=e.Settings;if(!a.properties.template)for(let w in a.settings)d[w]&&d[w].valid&&(a.data[w]=d[w].value);a.checkSettings()}async function Ol(a,i=!1){const e=a.settingsChanged();!i&&e&&(await a.confirmSaveSettings(),await be(100)),await Uo(),Le.curComponentSettings=null,a.domElement.classList.remove("active")}async function Ll(a){Le.curComponentSettings=a,a.workspace.domElement.querySelectorAll(".component.active").forEach(O=>{O.classList.remove("active")}),a.domElement.classList.add("active");const i={};for(let O in a.settings){const D=a.settings[O],y={...D,value:a.data[O]};D?.type==="composite"?i[O]=ni(y):i[O]=y}let e=null;if(a.properties.template){e={};const O=a.properties?.template?.templateInfo?.includedSettings||[];for(let y of O)e[y]=a.settings[y],e[y].value=a.data[y];const D=a.data._templateVars;for(let y in a.templateSettings){const c=a.templateSettings[y],F={...c,value:D[y]||c.value||""};c?.type==="composite"?e[y]=ni(F):e[y]=F}}a.settingsEntries=a.properties.template?e:i;const d=a.properties?.template?.templateInfo?.name||a.title||"",w=async()=>(await a.confirmSaveSettings(),!0),g=()=>{Le.curComponentSettings=null,a.emit("settingsClosed"),a.domElement.classList.remove("active"),a.unsetTemplateEditMode()},S=O=>{const D=O.target.value,y=D.match(/<i class="([^"]+)"/),c=y?y[1]:D;O.target.value=c;const F=O.target.closest(".form-box");if(F){let k=F.querySelector(".tpl-icon-preview");k||(k=document.createElement("div"),k.classList.add("tpl-icon-preview","absolute","bottom-0","right-0","w-12","h-12"),F.appendChild(k)),c.startsWith("fa")?k.innerHTML=`<i class="icon tpl-fa-icon ${c}"></i>`:k.innerHTML=`<div class="w-8 h-8">${c}</div>`}};sn=null;async function o(O,D="#000000",y=""){try{const c=await fetch("/api/page/collection/create-collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:O,color:D,icon:y})});if(!c.ok)throw new Error("Failed to add new collection");const F=await c.json();return F.error?(ae("Error adding new collection"),null):F}catch{return ae("Error adding new collection"),null}}const v={name:{type:"input",label:"Name",value:a.properties?.template?.templateInfo?.name||a.title||""},description:{type:"textarea",label:"Description",value:a.properties?.template?.templateInfo?.description||a.description||""},icon:{type:"textarea",label:"Font Awesome Class or SVG",value:a.properties?.template?.templateInfo?.icon||"",events:{change:S,mouseup:S,keyup:O=>{(O.ctrlKey||O.metaKey)&&S(O)}}},color:{type:"color",value:a.properties?.template?.templateInfo?.color||"#000000"},docPath:{type:"input",label:"Documentation Path",value:a.properties?.template?.templateInfo?.docPath||""},ytLink:{type:"input",label:"Youtube Tutorial Link",value:a.properties?.template?.templateInfo?.ytLink||""},newCollectionCheckbox:{type:"checkbox",label:"Do you want to create a new collection?",value:!1,events:{change:O=>{const D=document.querySelector('[data-field-name="newCollectionInput"]'),y=document.querySelector('[data-field-name="newCollectionButton"]');O.target.checked?(D.classList.remove("invisible","hidden"),D.classList.add("block","visible"),y.classList.remove("invisible","hidden"),y.classList.add("inline-block","visible")):(D.classList.remove("block","visible"),D.classList.add("invisible","hidden"),y.classList.remove("inline-block","visible"),y.classList.add("invisible","hidden"))}}},newCollectionInput:{type:"input",label:"New Collection Name",value:"",class:"invisible hidden"},newCollectionButton:{type:"button",label:"Add Collection",class:"invisible hidden",attributes:{},events:{click:async O=>{const D=O.target,y=D.innerHTML,c=document.querySelector('[data-field-name="newCollectionInput"]'),F=c.querySelector("input").value.trim(),k=document.getElementById("color").value.trim(),B=document.getElementById("icon").value.trim();if(F){D.innerHTML='<i class="fas fa-spinner fa-spin"></i>',D.disabled=!0;const M=await o(F,k,B);if(D.innerHTML=y,D.disabled=!1,M){c.querySelector("input").value="";const A=document.getElementById("newCollectionCheckbox");A.checked=!1;const I=document.querySelector('[data-field-name="newCollectionButton"]');c.classList.remove("block","visible"),c.classList.add("invisible","hidden"),I.classList.remove("inline-block","visible"),I.classList.add("invisible","hidden"),jn("New collection added")}}else ae("Please enter a collection name")}}},collection:{type:"select",label:"Collection",value:a.properties?.template?.templateInfo?.collection||"",options:jl.bind(a),events:{change:O=>{const D=sn.find(B=>B.value===O.target.value),y=document.querySelector('.form-box[data-field-name="icon"] #icon'),c=a.properties?.template?.templateInfo?.icon||"",F=a.properties?.template?.templateInfo?.color||"#000000";(y&&!c||!y?.value)&&(y.value=D.icon);const k=document.querySelector('.form-box[data-field-name="color"] #color');if(!F||F=="#000000"||k.value=="#000000"){k.value=D.color,k.setAttribute("value",D.color);const B=k.closest(".clr-field");B&&(B.style.color=D.color)}}}},version:{type:"input",label:"Version",validate:"custom=isValidSemVer",validateMessage:"Invalid version number. Must be in the format x.x.x",value:a.properties?.template?.templateInfo?.version||"1.0.0"},published:{type:"checkbox",class:"w-32",label:"Published",value:a.properties?.template?.templateInfo?.published||!1}},u=a?.templateSupport&&a.workspace?.userData?.acl?.["/templates"]=="rw"&&a.workspace?.userData?.isSmythStaff?{template:{type:"button",label:a.properties.template?'<i class="fa-solid fa-pen-to-square"></i>':'<i class="fa-solid fa-screwdriver-wrench"></i>',icon:"",hint:a.properties.template?"Edit This Template":"Create Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async()=>{let O=!0;a.properties.template&&(O=!1,a.settingsEntries=i);const D={Info:v,Settings:a.settingsEntries,Help:Dl},y={template:{type:"button",label:'<i class="fa-regular fa-floppy-disk"></i>',icon:"",hint:"Save Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async c=>{console.log("collecting settings data");const F=c.target.closest(".right-sidebar")?.querySelector("form.Settings");let k={};F&&(k=[...F.querySelectorAll(".chk-bind-setting")].filter(l=>l.checked).map(l=>l.closest(".form-box").getAttribute("data-field-name")),console.log(k));const B={};for(let l in D){const T=document.querySelector(`#right-sidebar form.${l}`),x=D[l];if(Go(T),await be(30),T.querySelector(".invalid"))return;const R=ii(T,x);B[l]=R}const M=B.Settings;if(a.emit("settingsSaving",M),!await a.save(M)){ae("Error saving settings");return}if(!a.properties.template||!O)for(let l in a.settings)a.data[l]=M[l];else{const l=a.templateSettings,T=a.data._templateVars,x=a.properties?.template?.templateInfo?.includedSettings||[];for(let R of x)a.data[R]=M[R];for(let R in l)T[R]=M[R]}console.log("template save settings",a.settings);const A=a.exportTemplate();A.templateInfo={...a.properties.template?.templateInfo,...B.Info,includedSettings:k},A.data={...A.data,...a.data},A.templateInfo.icon,a.emit("settingsSaved",M);let I=O?null:A?.templateInfo?.id;try{const l=sn.find(C=>C.value===A.templateInfo.collection);let T=A.templateInfo.icon||"";T||(A.templateInfo.icon=l?l.icon:T);let x=A.templateInfo.color||"#000000";x==="#000000"&&(A.templateInfo.color=l?l.color:x);const R=await Ml(I,A,A.templateInfo?.published||!1).catch(C=>({error:C}));if(R.error){console.log("error saving template",R.error),ae(R.error?.error?.message||"Cannot save component","Error Saving template");return}A.templateInfo.id=R.component.id,a.properties.template=A,a.title=A.templateInfo.name,a.description=A.templateInfo.description,a.domElement.querySelector(".internal-name").textContent=`T: ${A.templateInfo.name}`;const G=a.domElement.querySelector(".title-bar");if(G){G.querySelector(".title .text").textContent=A.templateInfo.name,G.querySelector(".description .text").textContent=A.templateInfo.description;const C=sn.find(L=>L.value===A.templateInfo.collection),W=G.querySelector(".icon");let V=A.templateInfo.icon||"",Y=A.templateInfo.color||"#000000";if(V.startsWith("<svg")){W.className="icon w-6 h-6";const L=V.replace(/<path/g,"<path");W.innerHTML=`${L}`;const q=W.querySelectorAll("path");[...q].find(tt=>tt.getAttribute("fill")&&tt.getAttribute("fill")!=="none")||q.forEach(tt=>tt.setAttribute("fill",Y))}else W.className=`icon tpl-fa-icon ${V}`,W.innerHTML="",W.style.backgroundColor="",W.style.color=Y}if(O){a.data._templateVars=a.data._templateVars||{};let C=null;if(a.properties.template){C={};const W=a.data._templateVars;for(let V in a.templateSettings){const Y=a.templateSettings[V],L={...Y,value:W[V]};Y?.type==="composite"?C[V]=ni(L):C[V]=L}}a.settingsEntries=C}O=!1,a.workspace.saveAgent(),O?jn("Component Template Created"):jn("Component Template Updated")}catch(l){console.log("error saving template",l),ae("Error saving template")}}}};a.setTemplateEditMode(),gs({title:`Template Editor : ${d}`,entriesObject:D,features:{templateVars:!0},actions:y,onSave:Ls.bind(a),onBeforeCancel:w,onCancel:g,onLoad:kl.bind(a)})}}}:null,r=Il(a),m=a.constructor.name;let E="";switch(m){case"ServerlessCode":E="Run scalable, cloud-based code. This option supports npm packages and third-party libraries, making it perfect for more complex, enterprise-level workflows.";break;case"Code":E="Execute pure JavaScript in a secure, sandboxed environment\u2014ideal for lightweight tasks.";break;default:E=""}gs({title:r,entriesObject:{Settings:a.settingsEntries},features:{templateVars:!0},actions:u,onSave:Ls.bind(a),onDraft:Al.bind(a),onBeforeCancel:w,onCancel:g,onLoad:Pl.bind(a),helpTooltip:E}),a.emit("settingsOpened",a.getSettingsSidebar())}let sn;async function jl(){if(sn)return sn;console.log("getComponentsCollections");const a=await fetch("/api/page/builder/app-config/collections").then(i=>i.json());return a.error?(ae("Error fetching collections"),[]):(console.log("collectionResult",a),sn=(a?.collections||[]).map(i=>({value:i.id,text:i.name,color:i.color||"#000000",icon:i.icon})),sn)}async function Ml(a,i,e=!1){let d="/api/page/builder/app-config/components";a&&(d+=`/${a}`);const w=i?.templateInfo?.name||i.name,g=i?.templateInfo?.collection||null,S={name:w,data:JSON.stringify(i),collectionId:g,visible:e};return await fetch(d,{method:a?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}).then(o=>o.json())}function Il(a){const i=a.properties?.template?.templateInfo?.name||a.title||"";let e=a.data?.logoUrl||a?.logoUrl,d="";const w=["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost","Await","MultimodalLLM","LLMAssistant"],g=["APIEndpoint","GenAILLM","ImageGenerator","Classifier","Note","APIOutput"];let S="w-6 h-6",o="";if(!e&&a?.drawSettings?.iconCSSClass==="svg-icon HuggingFace"&&(e="https://huggingface.co/front/assets/huggingface_logo-noborder.svg"),typeof e=="string"&&e.trim()!=="")w.some(v=>i.includes(v))&&(S="w-8 h-8"),d=`<img src="${e}" alt="${i} icon" class="inline-block align-middle ${S} object-contain rounded">`;else{let v=a.drawSettings.iconCSSClass||"";o=v;const u="#242424";if(w.some(r=>o.includes(r))&&(S="w-8 h-8"),v.startsWith("fa"))d=`<i class="${v.includes("tpl-fa-icon")?v:`tpl-fa-icon ${v}`} inline-block align-middle" style="color: ${u}; font-size: 1.5rem; vertical-align: middle;"></i>`;else if(v.trim().startsWith("<svg")){let r=v;r=r.replace(/<path[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),r=r.replace(/<svg[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),r.includes('class="')?(r=r.replace("<svg",`<svg fill="${u}"`),r.includes("w-full")||(r=r.replace(/class="([^"]*)"/,'class="$1 w-full"')),r.includes("h-full")||(r=r.replace(/class="([^"]*)"/,'class="$1 h-full"'))):r=r.replace("<svg",`<svg fill="${u}" class="w-full h-full"`),d=`<span class="inline-block align-middle ${S}">${r}</span>`}else if(v){v.includes("svg-icon")||(v=`svg-icon ${v}`);const r=g.some(E=>v.includes(E)),m=`background-color: ${u}${r?" !important":""};`;d=`<span class="${v} ${S} inline-block align-middle" style="${m}"></span>`}}return`
    <div class="flex items-center gap-2">
      ${d}
      <span class="truncate">${i}</span>
    </div>
  `}const Di={},Nl=a=>{if(localStorage.getItem("sidebarOpen"),localStorage.getItem("currentSidebarTab"),window._fixWithAIBtnDispatched)return;window._fixWithAIBtnDispatched=!0;const i=new CustomEvent("fixWithAIBtn",{detail:{data:a},bubbles:!0,composed:!0});window.dispatchEvent(i),setTimeout(()=>{window._fixWithAIBtnDispatched=!1},100)},Fl={VANILLA:Qo,REACT:a=>Ja({config:a})};window.__INPUT_TEMPLATE_VARIABLES__={};window.__FIELD_TEMPLATE_VARIABLES__={};window.interact=Mn;function Rl(a){const i=d=>/^-?\d+(\.\d+)?$/.test(d.trim()),e=d=>{const w=parseFloat(d);return!isNaN(w)&&w<=Number.MAX_SAFE_INTEGER&&w>=Number.MIN_SAFE_INTEGER&&w.toString()===d.trim()};if(!a)return null;if(i(a)&&!e(a)||!a.trim().startsWith("{")&&!a.trim().startsWith("["))return a;try{return JSON.parse(a)}catch{return JSON.parse(Xs(a))}}function Ti(a){if(Array.isArray(a)){for(let e=0;e<a.length;e++)a[e]=Ti(a[e]);return a}if(typeof a=="object"&&a!==null){for(let e in a)a[e]=Ti(a[e]);return a}const i=typeof a=="string"?a:JSON.stringify(a);return i.length>100?i.substring(0,100)+"...(long content truncated)":i}class Le extends zs{constructor(i,e={outputs:[],inputs:[],data:{},top:"",left:"",width:"",height:"",title:"",description:"",sender:null,uid:null,template:null,aiTitle:"",displayName:""},d=!0){if(super(),this.workspace=i,this.properties=e,this.settings={},this.inputEditor=Fl.VANILLA,this.inputSettings={defaultVal:{type:"string",default:"",allowDefaultEdit:!0,editConfig:{type:"textarea",label:"Default Value",fieldCls:"min-h-[50px] px-3 py-1 resize-y",attributes:{"data-agent-vars":"true","data-auto-size":"false",style:"height: 34px;"},section:"Advanced_Options",hint:"Value assigned if no specific value provided by user.",hintPosition:"after_label"}}},this.outputSettings={expression:{type:"string",default:"",editConfig:{type:"input",section:"Advanced_Options",help:"JSON path"}}},this.data={},this.drawSettings={displayName:this.constructor.name,cssClass:"",iconCSSClass:"mif-cog",showSettings:!0,addOutputButton:"Outputs",addInputButton:"Inputs",inputMaxConnections:-1,outputMaxConnections:-1,firendlyName:this.constructor.name,category:"Base",componentDescription:"",shortDescription:"",color:"#fff"},this._destroyed=!1,this.docUrl=Us+(lr[this.constructor.name]||""),this.settingsEntries={},this.async=!1,this.templateSupport=!1,this.templateEditing=!1,this._ready=!1,this.displayName=this.constructor.name,this._uid=this.properties.uid||"C"+Pi(),this.properties||(this.properties={top:"",left:""}),this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=[],this.properties.outputs||(this.properties.outputs=[]),this.properties.inputs||(this.properties.inputs=[]),this.properties.inputProps||(this.properties.inputProps=[]),this.properties.outputProps||(this.properties.outputProps=[]),this.data=this.properties.data||{},this.properties.template){const w=this.properties.template;this.properties.inputs=[...new Set([...this.properties.inputs,...w.inputs?.map(o=>o.name)||[]])],this.properties.outputs=[...new Set([...this.properties.outputs,...w.outputs?.map(o=>o.name)||[]])];const g=[];for(let o of this.properties.inputs){const v=w.inputs?.find(r=>r.name===o),u=this.properties.inputProps.find(r=>r.name===o);g.push({...v,...u})}this.properties.inputProps=g;const S=[];for(let o of this.properties.outputs){const v=w.outputs?.find(r=>r.name===o),u=this.properties.outputProps.find(r=>r.name===o);S.push({...v,...u})}this.properties.outputProps=S}this.prepare().then(this.init.bind(this)).then(()=>{this.title=this.properties.aiTitle||this.properties.title||this.drawSettings.displayName,this.aiTitle=this.properties.aiTitle||"",this.description=this.properties.description||this.drawSettings.shortDescription||this.drawSettings.componentDescription||"";const w=this.properties.defaultOutputs.reverse();for(let S of w)this.properties.outputs.indexOf(S)===-1&&this.properties.outputs.unshift(S);const g=this.properties.defaultInputs.reverse();for(let S of g)this.properties.inputs.indexOf(S)===-1&&this.properties.inputs.unshift(S);this.redraw(d),this._ready=!0}).then(this.run.bind(this)).finally(()=>{this.syncTemplateVars()}),Di[this.uid]=this}get uid(){return this._uid}get settingsOpen(){return Le.curComponentSettings==this}get templateSettings(){return this.properties?.template?.settings}set templateSettings(i){this.properties?.template&&(this.properties.template.settings=i)}async prepare(){return!0}async run(){return!0}syncTemplateVars(){window.__INPUT_TEMPLATE_VARIABLES__[this._uid]=new Map;const i=(g,S="Any")=>{const o={var:`{{${g}}}`,type:S};window.__INPUT_TEMPLATE_VARIABLES__[this._uid].set(g,o)},e=g=>{window.__INPUT_TEMPLATE_VARIABLES__[this._uid].delete(g)},d=()=>{const g=window.__INPUT_TEMPLATE_VARIABLES__?.[this._uid]||new Map,S=window.__LAST_FIELD_WITH_TEMPLATE_VARS__,o=window.__FIELD_TEMPLATE_VARIABLES__?.[S]||new Map,v=new Map([...g,...o]);ta(v,this._uid)};this.properties.inputProps?.forEach(g=>i(g.name,g.type));const w=g=>g.classList.contains("input-endpoint");this.addEventListener("endpointAdded",(g,S)=>{w(S)&&(setTimeout(()=>{const o=S.getAttribute("smt-type");i(g,o)},100),d())}),this.addEventListener("endpointChanged",(g,S,o,v)=>{w(S)&&((g==="name"||g==="type")&&setTimeout(()=>{const u=g==="name"?v:S.getAttribute("smt-name"),r=g==="type"?v:S.getAttribute("smt-type");g==="name"&&e(o),i(u,r)},100),d())}),this.addEventListener("endpointRemoved",(g,S)=>{w(S)&&(e(g),d())})}addFieldVariable(i,e){const d=window.__FIELD_TEMPLATE_VARIABLES__?.[i]||new Map;for(const[w,g]of Object.entries(e))d.set(w,{var:g,type:"field"});window.__FIELD_TEMPLATE_VARIABLES__[i]=d}ready(i){return new Promise((e,d)=>{if(this._ready)return e(!0);const w=setInterval(()=>{this._ready&&(clearInterval(w),i&&i(),e(!0))},15)})}async repaint(i=!1){if(i){let e=[...this.domElement.querySelectorAll(".endpoint")].map(d=>d?.endpoint?.connections).flat(1/0);e=[...new Set(e)],e.forEach(d=>{this.workspace.updateConnectionStyle(d)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async init(){}async clean(){return!0}isFunctionalComponent(){return["FSign","FEncDec","FSleep","FTimestamp","FHash"].includes(this.constructor.name)}isLogicalComponent(){return["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost"].includes(this.constructor.name)}addDebugButton(){if(!this.domElement)return;const i=this.domElement.querySelector(".title-bar");if(!i)return;i.querySelector(".btn-debug")?.remove();const e=document.createElement("button");e.className="btn-debug button-icon absolute z-10",this.isFunctionalComponent()?(e.style.top="1px",e.style.right="4px"):(e.style.top="9px",e.style.right="7px");const d=document.createElement("div");d.className="debug-icon-container",d.innerHTML=`
          <img src="" class="debug-icon default-icon w-8 h-8" alt="Debug" style="opacity: 1;" />
      `,e.appendChild(d),e.onclick=this.openDebugDialog.bind(this),new Js(e,{text:"Run with Debug",position:this.isLogicalComponent()?"left":"top",showWhen:"hover"}),i.appendChild(e)}async checkSettings(){this.clearComponentMessages();const{data:i}=await Xo({scope:void 0}),e=Object.values(i);let d=[];for(let r in this.settings){const m=this.settings[r];m.validate?.includes("required")&&d.push({id:r,name:m.label||r})}const w=d.filter(r=>!this.data[r.id]);w.length>0&&this.addComponentMessage(`Missing Settings ${w.map(r=>r.name).join(", ")}`,"alert pointer",()=>{Ve.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});const g="_manage_keys_message",S=this.hasComponentMessage(`.${g}`),o=async({addMockToggle:r=!1,addManageMessage:m=!1})=>{try{m&&this?.addComponentMessage("Manage keys","info pointer",()=>window.open("/vault","_blank"),g),r&&(await cl(this),await Fi(this))}catch{console.error("Failed to update UI for vault keys")}};if(this.properties.template){let r=null;if(this.properties.template){r={};const m=this.properties?.template?.templateInfo?.includedSettings||[];for(let O of m)this.settings?.[O]?.type!=="button"&&(r[O]=this.settings[O],r[O].value=this.data[O]);const E=this.data._templateVars;for(let O in this.templateSettings){const D=this.templateSettings[O],y={...D,value:E[O]||D.value||""};D?.type==="composite"?r[O]=ni(y):r[O]=y}}if(Object.keys(r||{}).filter(m=>{const E=this.data?._templateVars?.[m],O=this.data?.[m],D=y=>y==null||typeof y=="string"&&y.trim()==="";return D(E)&&D(O)}).length>0)this.addComponentMessage("Missing Settings","alert pointer",()=>{Ve.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});else{const m=Object.keys(r||[]).filter(D=>Ko(this.data?._templateVars?.[D]));let E=!1,O=!1;for(let D of m){const y=this.data?._templateVars?.[D],c=await this.checkVaultKeys(y,e);c?.allKeys?.size>0&&(E=!0),c?.existKeys?.size>0&&!S&&(O=!0)}o({addMockToggle:E,addManageMessage:O})}}let v=!1,u=!1;for(let r in this.settings){let m="";try{m=decodeURIComponent(this.data[r])}catch{m=this.data[r]}const E=await this.checkVaultKeys(m,e);E?.allKeys?.size>0&&(v=!0),E?.existKeys?.size>0&&!S&&(u=!0)}o({addMockToggle:v,addManageMessage:u});for(let r in this.settings){let m="";try{m=decodeURI(this.data[r])}catch{m=this.data[r]}const E=/{{INFO\:([^}]*)}}/g;let O;for(;(O=E.exec(m))!==null;){const D=O[1];this.addComponentMessage(D,"warning pointer",()=>{window.open("/vault","_blank")})}}}async checkVaultKeys(i="",e){const d=/{{KEY\(([^}]*)\)}}/g;let w=[],g;for(;(g=d.exec(i))!==null;)g[1]&&w.push(g[1]);const S=new Set(w),o=new Set,v=new Set;for(let u of w)if(u&&e.find(r=>r.name===u||r.name===u.replace(/\+/g," ")))console.log("Vault Key Found",u),o.add(u);else{if(console.log("Vault Key Missing",u),v.add(u),this.hasComponentMessage(`.${Oi(u)}`))continue;this.addComponentMessage(`Missing Key "${u}"`,"alert pointer",()=>{Ve.track("app_component_alert_click",{type:"missing key"}),ql.bind(this,u)()},Oi(u))}return{allKeys:S,existKeys:o,missingKeys:v}}async save(i){return this.checkSettings(),setTimeout(async()=>{this.checkSettings()},1e3),!0}destroy(){this._destroyed=!0,this.domElement.remove()}getSettingsSidebar(){return Le.curComponentSettings!==this?null:document.querySelector("#right-sidebar")}async deleteEndpoint(i){this.workspace.jsPlumbInstance.deleteEndpoint(i.endpoint),i.classList.contains("input-endpoint")&&(this.properties.inputs=this.properties.inputs.filter(e=>e!==i.getAttribute("smt-name")),this.properties.inputProps=this.properties.inputProps.filter(e=>e.name!==i.getAttribute("smt-name"))),i.classList.contains("output-endpoint")&&(this.properties.outputs=this.properties.outputs.filter(e=>e!==i.getAttribute("smt-name")),this.properties.outputProps=this.properties.outputProps.filter(e=>e.name!==i.getAttribute("smt-name"))),i.remove(),this.workspace.redraw(),this.workspace.saveAgent()}syncProps(i,e,d){const w=i==="input"?"inputs":"outputs",g=i==="input"?"inputProps":"outputProps",S=this.properties[w].findIndex(u=>u===e),o=this.properties[g],v=o.findIndex(u=>u?.name===e);if(S>=0&&v>=0){this.properties[w][S]=d.name;const u=o.find(r=>r?.name===e);this.properties[g][v]={...u,...d}}}inputNameExists(i){return!!this.inputContainer.querySelector(`.input-endpoint[smt-name="${i}"]`)}outputNameExists(i){return!!this.outputContainer.querySelector(`.output-endpoint[smt-name="${i}"]`)}parseOutputProp(i,e,d){if(!this.outputSettings[e])return;const w=this.properties.outputProps?.find(S=>S.name===i),g=this.outputSettings[e];switch(g?.type){case"string":return w?.[e]||g?.default||d;case"number":return w?.[e]||g?.default||d;case"boolean":return w?.[e]||g?.default||d}}async addOutput(i,e,d={},w={}){if(this.outputNameExists(e)){ae(`${e} already exists`);return}const g=this.workspace.jsPlumbInstance,S=document.createElement("div");S.className=`smyth endpoint output-endpoint ${this.constructor.name}`,S.setAttribute("smt-name",e);const o=this.properties.outputProps?.find(k=>k.name===e),v=o?.color||`${Oe.conStartColor}`;S.setAttribute("smt-color",v);for(let k in this.outputSettings)S.setAttribute(`smt-${k}`,this.parseOutputProp(e,k,""));for(let k in d)this.inputSettings[k]&&S.setAttribute(`smt-${k}`,d[k]);for(let k in d)this.outputSettings[k]&&S.setAttribute(`smt-${k}`,d[k]);Object.keys(d)?.length>0&&this.properties.outputs.push(e),i.appendChild(S),await be(50);const u=g.addEndpoint(S,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:this.drawSettings.outputMaxConnections,cssClass:"exclude-panzoom"}),r=document.createElement("span");r.className="name",r.innerHTML=`<span class="label">${e}</span>`,S.appendChild(r);const m=this.properties.defaultOutputs.includes(e),E=!this.templateEditing&&this.properties.template?.outputs?.find(k=>k.name==e),O=document.createElement("button");O.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",O.innerHTML='<span class="icon mif-pencil"></span>',O.setAttribute("rel",S.id),O.addEventListener("click",async k=>{k.stopPropagation();let B=!0;if(w.onEditBtnClick&&(B=await w.onEditBtnClick(k),B===!1))return;k.stopImmediatePropagation();const M=S.getAttribute("smt-name"),A=!this.templateEditing&&this.properties.template?.outputs?.find(G=>G.name==M),I=S.getAttribute("smt-color")||`${Oe.conStartColor}`,l={name:{label:"Output Name",type:"text",class:"stg-output stg-name",value:M,readonly:m||A,validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:ti(I)};for(let G in this.outputSettings){const C=this.outputSettings[G];if(C){let W=S.getAttribute(`smt-${G}`);W==="true"&&(W=!0),W==="false"&&(W=!1),l[G]={...C.editConfig,value:W},C.allowDefaultEdit||(l[G].readonly=m||A,l[G].class+=m||A?" hidden":"")}}l?.description&&(l.description.section="Advanced_Options");const T=this.constructor.name===An.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Output</span>':'<span class="text-xl">Edit Output</span>',x=Qn(l,["description","expression","additionalOptionsLabel","color"]),R=await this.inputEditor({title:T,fields:x,onDOMReady:G=>{const C=G.querySelector("#name"),W=G.querySelector(".agent-skill-dialog-title"),V=document.querySelector("#add-skill-input-info-icon");W&&V&&(V.classList.remove("hidden"),W.appendChild(V)),be(50).then(()=>Wn(C))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(R){if(R.name!=M){if(this.outputNameExists(R.name)){ae(`${R.name} already used`);return}S.setAttribute("smt-name",R.name),S.querySelector(".name").innerHTML=R.name,this.emit("endpointChanged","name",S,M,R.name)}if(S&&R.color!=I){S.setAttribute("smt-color",R.color),S.querySelector(".ep").style.backgroundColor=R.color||`${Oe.conStartColor}`,S.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${R.color}) 1`;const G=S.endpoint;if(G&&G.connections)for(let C of G.connections)this.workspace.updateConnectionColors(C);this.emit("endpointChanged","color",S,I,R.color)}for(let G in this.outputSettings){const C=this.outputSettings[G];if(S&&C){const W=S.getAttribute(`smt-${G}`);R[G]!==W&&R[G]!=null&&(S.setAttribute(`smt-${G}`,R[G]),this.emit("endpointChanged",G,S,W,R[G]))}}this.syncProps("output",M,R),this.workspace.saveAgent()}});const D=document.createElement("button");D.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",D.innerHTML='<span class="icon mif-bin"></span>',D.setAttribute("rel",S.id),D.addEventListener("click",async k=>{const B=S.getAttribute("smt-name"),M=!this.templateEditing&&this.properties.template?.outputs?.find(A=>A.name==B);if(!(m||M))return k.stopPropagation(),k.stopImmediatePropagation(),await Xn("Deleting Output. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})?this.deleteEndpoint(S):!1}),!m&&E&&D.setAttribute("templateEditable","true"),S.appendChild(D),D.classList.add("hidden"),!m&&!E?D.classList.remove("hidden"):S.classList.add("default"),S.appendChild(O);const y=document.createElement("button");y.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",y.innerHTML='<span class="icon mif-arrow-up"></span>',y.addEventListener("click",async k=>{k.stopPropagation(),S.parentElement.insertBefore(S,S.previousSibling),this.repaint(),this.workspace.saveAgent()}),S.appendChild(y);const c=document.createElement("button");c.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",c.innerHTML='<span class="icon mif-arrow-down"></span>',c.addEventListener("click",async k=>{k.stopPropagation(),S?.parentElement?.insertBefore(S?.nextSibling,S),this.repaint(),this.workspace.saveAgent()}),S.appendChild(c);const F=document.createElement("span");F.className=`ep ep-Output ep-${e}`,F.innerHTML=" ",F.style.backgroundColor=o?.color||`${Oe.conStartColor}`,S.appendChild(F),S.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${v}) 1`;for(let k of u.connections)this.workspace.updateConnectionColors(k);return S.endpoint=u,u._domElement=S,!o&&d.name&&(d.default||(d.default=!1),this.properties.outputProps.push(d)),this.emit("endpointAdded",e,S),this.workspace.saveAgent(),S}setTemplateEditMode(){this.templateEditing=!0,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(i=>i.classList.remove("hidden"))}unsetTemplateEditMode(){this.templateEditing=!1,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(i=>i.classList.add("hidden"))}parseInputProp(i,e,d){if(!this.inputSettings[e])return;const w=this.properties.inputProps?.find(S=>S.name===i),g=this.inputSettings[e];switch(g?.type){case"string":return w?.[e]||g?.default||d;case"number":return w?.[e]||g?.default||d;case"boolean":return w?.[e]||g?.default||d}}async addInput(i,e,d={}){if(this.inputNameExists(e)){ae(`${e} already exists`);return}const w=this.workspace.jsPlumbInstance,g=document.createElement("div");g.className=`smyth endpoint input-endpoint ${this.constructor.name}`,g.setAttribute("smt-name",e);const S=this.properties.inputProps?.find(c=>c.name===e);g.setAttribute("smt-optional",S?.optional||"false"),g.setAttribute("smt-color",S?.color||`${Oe.conEndColor}`),g.setAttribute("smt-type",S?.type||"Any"),g.setAttribute("smt-friendly-input-type",S?.friendlyInputType||""),g.setAttribute("smt-core-input-type",S?.coreInputType||""),S?.optional?g.classList.add("optional"):g.classList.remove("optional");for(let c in this.inputSettings)g.setAttribute(`smt-${c}`,this.parseInputProp(e,c,""));for(let c in d)this.inputSettings[c]&&g.setAttribute(`smt-${c}`,d[c]);Object.keys(d)?.length>0&&this.properties.inputs.push(e),i.appendChild(g),await be(50);const o=w.addEndpoint(g,{paintStyle:{fill:"transparent"},endpoint:["Dot",{radius:10}],anchor:["Left",{dx:40}],isTarget:!0,maxConnections:this.drawSettings.inputMaxConnections,cssClass:"exclude-panzoom"});o._listeners.mouseup||(o._listeners.mouseup=[]),o._listeners.mouseup.push(()=>{if(this.workspace._draggingConnection){const c=this.workspace._draggingConnection.source.endpoint;if(c.connections.find(F=>F.endpoints.includes(o)))return;this.workspace.jsPlumbInstance.connect({source:c,target:o,cssClass:"exclude-panzoom"}),this.workspace.jsPlumbInstance.deleteConnection(this.workspace._draggingConnection)}document.querySelectorAll(".endpoint.active").forEach(c=>c.classList.remove("active"))});const v=document.createElement("span");v.className=`ep ep-Input ep-${e}`,v.innerHTML=" ",v.style.backgroundColor=S?.color||`${Oe.conEndColor}`,g.appendChild(v);const u=document.createElement("span");u.className="name",u.innerHTML=e,g.appendChild(u);const r=this.properties.defaultInputs.includes(e),m=!this.templateEditing&&this.properties.template?.inputs?.find(c=>c.name==e),E=document.createElement("button");E.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",E.innerHTML='<span class="icon mif-pencil"></span>',E.setAttribute("rel",g.id),E.addEventListener("click",async c=>{c.stopPropagation();const F=g.getAttribute("smt-name"),k=this.properties.inputProps?.find(L=>L.name===F),B=!this.templateEditing&&this.properties.template?.inputs?.find(L=>L.name==F),M=g.getAttribute("smt-optional")=="true",A=g.getAttribute("smt-color")||`${Oe.conEndColor}`;let I=g.getAttribute("smt-type")&&g.getAttribute("smt-type")!=="undefined"?g.getAttribute("smt-type"):"",l=g.getAttribute("smt-friendly-input-type")||"",T=g.getAttribute("smt-core-input-type")||"";I&&!l&&(l="Others",T=I);const x=g.getAttribute("smt-isfile")=="true";let R=!1;x&&(R=!0,I="Binary");const G=r||B,C={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:F,readonly:r||B,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores."}};if(!G){const L=Is({compName:this.constructor.name,values:{friendlyInputType:l,coreInputType:k?.type||T,type:k?.type||I}});L?.friendlyInputType&&(C.friendlyInputType=L.friendlyInputType),L?.coreInputType&&(C.coreInputType=L.coreInputType),L?.type&&(C.type=L.type)}C.additionalOptionsLabel={type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},C.optional=Ms(M,r||B),C.color=ti(A);for(let L in this.inputSettings){const q=this.inputSettings[L];if(q){let tt=g.getAttribute(`smt-${L}`);tt==="true"&&(tt=!0),tt==="false"&&(tt=!1),C[L]={...q.editConfig,value:tt},q.allowDefaultEdit||(C[L].readonly=r||B,C[L].class+=r||B?" hidden":"")}}const W=this.constructor.name===An.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Input</span>':'<span class="text-xl">Edit Input</span>';C?.description&&(C.description.section="Advanced_Options");const V=Qn(C,["name","type","description","additionalOptionsLabel","optional","color"]),Y=await this.inputEditor({title:W,fields:V,onDOMReady:L=>{const q=L.querySelector("#name"),tt=L.querySelector(".agent-skill-dialog-title"),K=document.querySelector("#add-skill-input-info-icon");tt&&K&&(K.classList.remove("hidden"),tt.appendChild(K)),be(50).then(()=>Wn(q))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(Y){if(Y.name!==F){if(this.inputNameExists(Y.name)){ae(`${Y.name} already used`);return}g.setAttribute("smt-name",Y.name),g.querySelector(".name").innerHTML=Y.name,this.emit("endpointChanged","name",g,F,Y.name)}if(Y.optional!==M&&(g.setAttribute("smt-optional",Y.optional),Y.optional?g.classList.add("optional"):g.classList.remove("optional"),this.emit("endpointChanged","optional",g,M,Y.optional)),g&&Y.color!==A){g.setAttribute("smt-color",Y.color),g.querySelector(".ep").style.backgroundColor=Y.color||`${Oe.conEndColor}`,g.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${Y.color}) 1`;const L=g.endpoint;if(L&&L.connections)for(let q of L.connections)this.workspace.updateConnectionColors(q);this.emit("endpointChanged","color",g,A,Y.color)}Y.type||(Y.type="Any"),(g&&Y.type!==I||R)&&(g.setAttribute("smt-type",Y.type),this.emit("endpointChanged","type",g,I,Y.type)),g?.setAttribute("smt-friendly-input-type",Y?.friendlyInputType||""),g?.setAttribute("smt-core-input-type",Y?.coreInputType||"");for(let L in this.inputSettings){const q=this.inputSettings[L];if(g&&q){const tt=g.getAttribute(`smt-${L}`);Y[L]!==tt&&Y[L]!=null&&(g.setAttribute(`smt-${L}`,Y[L]),this.emit("endpointChanged",L,g,tt,Y[L]))}}this.syncProps("input",F,Y),this.workspace.saveAgent()}});const O=document.createElement("button");O.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",O.innerHTML='<span class="icon mif-bin"></span>',O.setAttribute("rel",g.id),O.addEventListener("click",async c=>{const F=g.getAttribute("smt-name"),k=!this.templateEditing&&this.properties.template?.inputs?.find(B=>B.name==F);if(!(r||k)){if(c.stopPropagation(),c.stopImmediatePropagation(),await Xn("Deleting Input. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){this.deleteEndpoint(g);const B=g.getAttribute("smt-name");return this.emit("endpointRemoved",B,g),!0}return!1}}),!r&&m&&O.setAttribute("templateEditable","true"),g.appendChild(O),O.classList.add("hidden"),!r&&!m?O.classList.remove("hidden"):g.classList.add("default"),g.appendChild(E);const D=document.createElement("button");D.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",D.innerHTML='<span class="icon mif-arrow-up"></span>',D.addEventListener("click",async c=>{c.stopPropagation(),g.parentElement.insertBefore(g,g.previousSibling),this.repaint(),this.workspace.saveAgent()}),g.appendChild(D);const y=document.createElement("button");y.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",y.innerHTML='<span class="icon mif-arrow-down"></span>',y.addEventListener("click",async c=>{c.stopPropagation(),g.parentElement.insertBefore(g.nextSibling,g),this.repaint(),this.workspace.saveAgent()}),g.appendChild(y);for(let c of o.connections)this.workspace.updateConnectionColors(c);return g.endpoint=o,o._domElement=g,!S&&d.name&&(d.default||(d.default=!1),this.properties.inputProps.push(d)),this.emit("endpointAdded",e,g),this.workspace.saveAgent(),g}refreshSettingsSidebar(){this.settingsOpen&&this.editSettings()}parseTemplateString(i,e){let d=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm,w=/{{([A-Z]+):([\w\s]+):(\{.*?\})}}/gm;const g=i.matchAll(d),S=i.matchAll(w),o=[...g,...S];for(const v of o){const u={"data-template-vars":"false"};let r=v[1].toUpperCase();const m=`${r}-${Pi()}`;r.startsWith("VAR")&&(r=r.replace("VAR",""),u["data-template-vars"]="true"),r.startsWith("VAULT")&&(r=r.replace("VAULT",""),u["data-vault"]=`${this.constructor.name},All`);const E=v[2];let O,D;if(v[3].trim().startsWith("{")&&v[3].trim().endsWith("}"))try{D=JSON.parse(v[3])}catch{}if(!D)try{const F=JSON.parse(`[${v[3]||""}]`);F.length>1?(O=F.map(k=>({text:k,value:k})),O.unshift({text:" ",value:""})):O=F}catch{O=[]}let y=O?.[0]||"",c={};switch(r){case"KVJSON":y=JSON.stringify(D,null,2);break;default:c=D}e[m]={id:m,type:r,label:E,value:y,options:O,attributes:u,_templateEntry:!0,...c},i=i.replace(v[0],`{{${m}}}`)}return i}parseCompositeTemplateString(i,e){let d=JSON.parse(i||"{}")||{};const w=Array.isArray(d);d=w?d[0]:d;for(let g in d){let S=d[g];typeof S=="object"&&S!==null?(S=this.parseCompositeTemplateString(JSON.stringify(S),e),S=JSON.parse(S)):typeof S=="string"&&(S=this.parseTemplateString(S,e)),d[g]=S}return JSON.stringify(w?[d]:d)}normalizeTemplateSettings(i){}async editSettings(){return Ll(this)}async confirmSaveSettings(){if(this.settingsChanged()&&await Xn("Settings Changed","You have unsaved changes. Are you sure you want to discard your changes?",{btnNoLabel:"Discard Changes",btnYesLabel:"Save Changes"})){const i=document.querySelector("#right-sidebar form"),e=ii(i,this.settingsEntries);if(!await this.save(e)){ae("Error saving settings");return}if(this.properties.template){const d=this.data._templateVars,w=this.templateSettings,g=this.properties?.template?.templateInfo?.includedSettings||[];for(let S of g)this.data[S]=e[S];for(let S in w)d[S]=e[S]}else for(let d in this.settings)this.data[d]=e[d];return console.log("new settings",e),this.emit("settingsSaved",e),!0}return!1}settingsChanged(){if(!this.settingsOpen)return!1;const i=this.settingsEntries,e=document.querySelector("#right-sidebar form.Settings");if(!e)return!1;const d=ii(e,i);if(console.log("settingsChanged()",d,i),this.properties.template){const w=this.data._templateVars;for(let g in i)if(w[g]!==void 0&&w[g]!=d[g])return!0}else for(let w in i)if(this.data[w]!==void 0&&this.data[w]!=d[w])return!0}async closeSettings(i=!1){return Ol(this,i)}showOverlay(i){this.overlay.querySelector(".content").innerHTML=i,this.overlay.style.display="block"}hideOverlay(){this.overlay.querySelector(".content").innerHTML="",this.overlay.style.display="none"}hasComponentMessage(i){return this.domElement.querySelector(i)!==null}hasComponentButton(i){return this.domElement.querySelector(i)!==null}clearComponentMessage(i){const e=this.domElement.querySelector(i);e&&e.remove()}clearComponentMessages(){this.domElement.querySelector(".messages-container").innerHTML=""}addComponentMessage(i,e="info",d,w){const g=document.createElement("div");return g.className=`message ${e} ${w}`,g.innerHTML=typeof i=="string"?i:i.text,d&&(g.style.cursor="pointer",g.addEventListener("click",d)),this.domElement.querySelector(".messages-container").appendChild(g),g}addComponentButton(i,e="info",d,w){const g=document.createElement("div");g.className=`message ${e} flex flex-wrap justify-center items-center p-2`,g.id="component-button";const S=document.createElement("button"),o={primary:"flex flex-row w-full items-center content-center text-xs justify-start gap-1 h-sm px-2 py-1 rounded-xl text-white bg-blue-500 pointer active:text-gray-100 active:bg-blue-600 active:ring-0",secondary:"flex flex-row w-full items-center justify-center text-xs gap-1 h-sm px-2 py-2 rounded-md text-[#3C89F9] border-[#3C89F9] bg-transparent pointer border-2 ",toggle:"flex flex-row w-full items-center justify-start text-xs gap-1 h-sm px-1 rounded-md bg-transparent pointer"};if(S.className=o[d?.customStyle]||o.primary,S.innerHTML=i,d)for(let v in d)v=="class"?S.className+=` ${d[v]}`:S.setAttribute(v,d[v]);return w&&(S.onclick=w),g.appendChild(S),d?.position==="top"?this.domElement.querySelector(".messages-container").prepend(g):this.domElement.querySelector(".messages-container").appendChild(g),g}redraw(i=!0){this.workspace.jsPlumbInstance;const e=this.workspace,d=this,w=this.properties.outputs||[],g=this.properties.inputs||[],S=document.createElement("div");S.className=`component exclude-panzoom group ${this.drawSettings.cssClass||""}`,S.id=`${this._uid}`,S.style.left=this.properties.left||"20px",S.style.top=this.properties.top||"20px",this.properties.width&&(S.style.width=this.properties.width),this.properties.height&&(S.style.height=this.properties.height),S.classList.add(this.constructor.name);const o=document.createElement("div");o.className="internal-name";const v=this.properties.template?.templateInfo?.name||this.properties.template?.name||this.drawSettings.displayName||this.constructor.name;this.displayName=v,this.properties.template?.templateInfo?.description||this.properties.template?.shortDescription||this.drawSettings.shortDescription||this.drawSettings.componentDescription,o.innerHTML=this.properties.template?"T:"+v:v,S.appendChild(o);const u=document.createElement("div");u.className="title-bar";const r=this.drawSettings.iconCSSClass||"";if(r.startsWith("<svg")){const K=this.drawSettings.color||"#000",rt=r.replace(/<path/g,"<path ");u.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
          <span class="icon w-6 h-6">${rt}</span>
          <span class="title">${this.title}</span>
        </div>
        <span class="description">${this.description}</span>
      `;const f=u.querySelectorAll("path");[...f].find(_=>_.getAttribute("fill")&&_.getAttribute("fill")!=="none")||f.forEach(_=>_.setAttribute("fill",K))}else u.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
        <span class="icon ${r} h-full"></span>
        <span class="title font-semibold">${this.title}</span>
      </div>
      <span class="description">${this.description}</span>
      `;u.setAttribute("smt-name",this.constructor.name);const m=u.querySelector(".title"),E=u.querySelector(".description");m.style.cursor="default",E.style.cursor="default",S.appendChild(u),setTimeout(()=>{this.addDebugButton()},500);const O=(K,rt)=>{const f=K.target;if(f instanceof HTMLElement){if(f.hasAttribute("contenteditable")){K.stopPropagation();return}!K.ctrlKey&&!K.metaKey&&(this.workspace.refreshComponentSelection(),tt(K)),rt.classList.toggle("selected"),rt.classList.remove("unselected"),document.querySelectorAll("#workspace-container .component:not(.selected)").forEach(_=>_.classList.add("unselected")),Ds()}};m.addEventListener("click",K=>O(K,S)),E.addEventListener("click",K=>O(K,S)),setTimeout(()=>{ms(m,{callback:K=>{K||(K=v||""),m.querySelector(".text").textContent=K,this.title=K,this.aiTitle="",this.workspace.saveAgent()},editOnClick:!1,showButtons:!0}),ms(E,{callback:K=>{K||(K=""),E.querySelector(".text").textContent=K,this.description=K,this.workspace.saveAgent()},editOnClick:!1,showButtons:!0})},500),setTimeout(()=>{const K=m.querySelector(".text");K&&K.classList.add("truncate")},550);const D=document.createElement("div");D.className=`debug-bar cursor-pointer px-[10px] mx-auto text-white variant_2 rounded-lg ${this.isFunctionalComponent()?"mt-[10px]":""}`,S.appendChild(D),D.addEventListener("click",K=>{K.stopPropagation(),K.stopImmediatePropagation(),this.workspace.refreshComponentSelection(S)});const y=document.createElement("div");y.className="debug-info hidden",D.appendChild(y);const c=document.createElement("button");c.innerHTML='<span class="mif-search icon"></span> Log',c.className="btn-debug-log button primary mini outline hidden",c.onclick=K=>{K.stopPropagation(),K.stopImmediatePropagation(),this.workspace.refreshComponentSelection(S);const rt=this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"]`);if(rt?.classList?.toggle("hidden"),rt.classList.contains("hidden"))rt._connection.canvas.classList.add("hidden");else{if(!rt._connection&&!rt.classList.contains("hidden")){const f=e.jsPlumbInstance.connect({source:rt.querySelector("h2"),target:D,detachable:!1,cssClass:"exclude-panzoom z-100",anchors:["Continuous","Left"]});f.setPaintStyle({stroke:"#7d7c96",strokeWidth:1,dashstyle:"4 3"}),f.removeAllOverlays(),f.endpoints[0]._domElement=rt,f.endpoints[1]._domElement=D,rt._connection=f}rt._connection.canvas.classList.remove("hidden")}},D.appendChild(c);const F=document.createElement("button");F.innerHTML=' <i class="fa-solid fa-wand-magic-sparkles"></i> Fix with AI',F.className="btn-fix-with-ai button primary mini outline hidden",F.onclick=async K=>{if(K.stopPropagation(),this.workspace.refreshComponentSelection(S),!document.getElementById("builder-button")){ae("Agent Weaver is not enabled");return}document.getElementById("agentMessageInput"),document.getElementById("agentSendButton"),this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"] .dbg-log`)?.textContent;const rt=F.getAttribute("data-error")||"",f=this.domElement.querySelectorAll(".input-container .endpoint");let _="";for(let N of f){const z=N.querySelector("span.name").innerText,U=N.querySelector("div.dbg-output textarea.dbg");let nt=U?U?.value:"",ot;try{ot=Rl(nt),ot=Ti(ot),Array.isArray(ot)&&ot.length>3&&(ot=ot.slice(0,3),ot.push("...(truncated to 3 items)")),_+=`${z}: ${JSON.stringify(ot)}
`,_=_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}catch{nt.length>300&&(nt=nt.substring(0,300)+"...(long content truncated)"),_+=`${z}: ${nt}
`}}_&&(_=`===
Received Inputs:
${_}

`);const h=`Component With ID=${this._uid} has a runtime error:
      ${rt.substring(0,500)}

      ${_}
      ####

      
Please fix the issue, or explain it if you can't fix it`;console.log("Weaver Error fix prompt: ",h),Nl({weaverPrompt:h,componentId:this._uid})},D.appendChild(F);const k=document.createElement("div");if(k.className="ep-control inputs px-2",k.innerHTML=`<span>${this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton}</span>`,S.appendChild(k),this.drawSettings.addInputButton){const K=document.createElement("button");K.innerHTML="+",k.innerHTML="",K.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",k.appendChild(K);const rt=document.createElement("span");rt.innerHTML=this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton,k.appendChild(rt),K.onclick=f=>{f.stopPropagation(),f.stopImmediatePropagation(),this.addInputDialog()}}const B=document.createElement("div");B.className="input-container",S.appendChild(B);const M=document.createElement("div");if(M.className="ep-control outputs px-2",M.innerHTML=`<span>${this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton}</span>`,S.appendChild(M),this.drawSettings.addOutputButton){const K=document.createElement("button");K.innerHTML="+",M.innerHTML="",K.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",M.appendChild(K);const rt=document.createElement("span");rt.innerHTML=this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton,M.appendChild(rt),K.onclick=f=>{f.stopPropagation(),f.stopImmediatePropagation(),this.addOutputDialog()}}const A=document.createElement("div");A.className="output-container",S.appendChild(A);const I=document.createElement("div");I.className="button-container messages-container",I.addEventListener("click",K=>{K.stopPropagation()}),S.appendChild(I);const l=document.createElement("div");l.className="right-side-button-container absolute right-0 flex transition-opacity opacity-0 group-hover:opacity-100";const T=document.createElement("button");T.className="w-6 h-6 rounded del-btn relative group/delete",T.innerHTML='<i class="fas fa-trash text-[#757575] text-xs hover:text-[#aaa]"></i>',T.onclick=K=>{K.stopPropagation(),d.delete(!1)};const x=document.createElement("div");x.className="absolute left-[-20px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/delete:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",x.innerText="Delete",T.appendChild(x),l.appendChild(T);const R=d.properties?.template?.templateInfo?.docPath||"/not-set",G=d.properties?.template?d.workspace.serverData.docUrl+R:d.docUrl,C=document.createElement("button");C.className="w-6 h-6 rounded action-help relative group/help",C.innerHTML='<span class="font-bold text-lg text-[#757575] hover:text-[#aaa]">?</span>',C.onclick=K=>{K.stopPropagation(),window.open(G,"_blank")},d.properties?.template&&!d.properties?.template?.templateInfo?.docPath&&C.classList.add("hidden");const W=document.createElement("div");W.className="absolute left-[-15px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/help:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",W.innerText="Help",C.appendChild(W),l.appendChild(C);const V=document.createElement("button");V.className="w-6 h-6 rounded relative group/settings",V.innerHTML='<i class="fas fa-cog text-[#757575] text-xs hover:text-[#aaa]"></i>';const Y=document.createElement("div");Y.className="absolute left-[-25px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/settings:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",this.drawSettings?.showSettings!==!1&&l.appendChild(V),Y.innerText="Settings",V.appendChild(Y),l.appendChild(V),S.appendChild(l);const L=document.createElement("div");L.className="loading-icon",L.innerHTML=`
      <svg
        aria-hidden="true"
        class="inline text-gray-200 animate-spin dark:text-gray-600 fill-primary-100 w-8 h-8"
        viewBox="0 0 100 101"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
          fill="currentColor"
        />
        <path
          d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
          fill="currentFill"
        />
      </svg>
    `,L.classList.add("hidden"),S.appendChild(L);const q=document.createElement("div");q.className="cpt-overlay",q.innerHTML=`<div class="content"></div><span class="dbg-loader"><svg height="48px" width="64px">
    <polyline id="front" points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24"></polyline>
  </svg></span>`,S.appendChild(q),q.style.display="none";const tt=async K=>{this.domElement.classList.contains("dragging")||this.domElement.classList.contains("resizing")||m.hasAttribute("contenteditable")&&K.target==m||E.hasAttribute("contenteditable")&&K.target==E||K.target?.classList?.contains("dbg")||!S.querySelector(".debug-info").classList.contains("hidden")||[...S.querySelectorAll(".dbg-element")].filter(rt=>rt.checkVisibility?.()).length>0||(Le.curComponentSettings&&Le.curComponentSettings!==this&&await Le.curComponentSettings.confirmSaveSettings(),this.settingsOpen?this.closeSettings():this.editSettings())};return S.addEventListener("click",K=>{if(K.target!==V){!K.ctrlKey&&!K.metaKey&&(this.workspace.refreshComponentSelection(),tt(K)),this.domElement.classList.toggle("selected"),this.domElement.classList.remove("unselected");const rt=document.querySelectorAll("#workspace-container .component:not(.selected)");for(let f of rt)f.classList.add("unselected");Ds()}}),V.addEventListener("click",K=>{K.stopPropagation(),tt(K),this.workspace.refreshComponentSelection(this.domElement)}),this.inputContainer=B,this.outputContainer=A,this.buttonContainer=I,this.overlay=q,this.loadingIcon=L,w.forEach((K,rt)=>{this.addOutput(A,K)}),g.forEach((K,rt)=>{this.addInput(B,K)}),Mn(S).draggable({allowFrom:".component",ignoreFrom:".dbg-element,.debug-info",listeners:{start(K){if(e?.locked)return!1;d.domElement.classList.add("dragging"),d.domElement.style.cursor="grabbing"},move(K){if(e?.locked)return!1;if(!K.target)return;let rt=[K.target];K.target.classList.contains("selected")?rt=[...document.querySelectorAll(".component.selected")]:document.querySelectorAll(".component.selected").forEach(f=>f.classList.remove("selected"));for(let f of rt){const _=(parseFloat(f.style.left)||0)+K.dx/e.scale,h=(parseFloat(f.style.top)||0)+K.dy/e.scale;f.style.left=_+"px",f.style.top=h+"px",f._control.repaint()}},end(K){if(e?.locked)return!1;d.repaint(!0),d.domElement.style.cursor="",setTimeout(()=>{d.workspace.saveAgent(),d.domElement.classList.remove("dragging")},200)}},modifiers:[],inertia:!0}).styleCursor(!1),$(u.querySelector(".svg-icon")).css("background-color","#000"),$(u.querySelector(".tpl-fa-icon")).css("color",this.drawSettings.color),this.domElement=S,this.workspace.domElement.appendChild(S),S.addEventListener("mousedown",function(K){K.stopPropagation()}),S.addEventListener("click",function(K){K.stopPropagation()}),Mn(S).resizable({edges:{left:!1,right:!0,bottom:!1,top:!1},listeners:{start(K){if(e?.locked||[...d.domElement.querySelectorAll(".pinned")].length>0)return!1;d.domElement.classList.add("resizing")},move(K){if(e?.locked||[...d.domElement.querySelectorAll(".pinned")].length>0)return!1;const rt=K.target;rt.style.width=K.rect.width/e.scale+"px",d.repaint()},end(K){if(e?.locked||[...d.domElement.querySelectorAll(".pinned")].length>0)return!1;d.repaint(),setTimeout(()=>{d.workspace.saveAgent(),d.domElement.classList.remove("resizing")},200)}},modifiers:[Mn.modifiers.restrictSize({min:{width:100,height:50}})],inertia:!1}),S._control=this,this.checkSettings(),i&&(setTimeout(()=>{this.workspace.saveAgent()},300),!this.properties.template&&this.drawSettings.showSettings&&this.editSettings()),this.emit("componentCreated",this),S}async delete(i=!0,e=!0){const d=this.workspace.jsPlumbInstance,w=this.domElement;if(i||await Xn("Are you sure you want to delete this component?","This action cannot be undone. Deleting will remove the component permanently.",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){if(this.settingsOpen&&this.closeSettings(!0),this.showOverlay("Deleting..."),this.emit("beforeDelete",this),!await this.clean()){this.hideOverlay();return}const g=[...w.querySelectorAll(".output-endpoint"),...w.querySelectorAll(".input-endpoint"),...w.querySelectorAll(".agent-card-connection")].map(v=>d.getEndpoints(v)).flat(),S=[];for(let v of g)S.push(v);S.forEach(v=>d.deleteEndpoint(v)),this.destroy();const o=document.querySelector(`.debug-box[rel="${this.uid}"]`);if(o){const v=o._connection;v&&d.deleteConnection(v),o.remove()}document.querySelectorAll(".component").forEach(v=>v.classList.remove("selected","unselected")),delete Di[this.uid],e&&this.workspace.saveAgent(),this.hideOverlay()}}async addInputDialog(){const i={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:"",required:!0,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores.",attributes:{placeholder:"E.g. Username"}},...Is({compName:this.constructor.name,values:{type:"Any"}}),additionalOptionsLabel:{type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:ti(`${Oe.conEndColor}`),optional:Ms()};for(let g in this.inputSettings){const S=this.inputSettings[g];S&&(i[g]={...S.editConfig,value:S.editConfig?.defaultVal||""})}const e=this.constructor.name===An.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Input</span>':'<span class="text-xl">Add Input</span>';i?.description&&(i.description.section="Advanced_Options");const d=Qn(i,["name","type","description","additionalOptionsLabel","optional","color"]),w=await this.inputEditor({title:e,fields:d,onDOMReady:g=>{const S=g.querySelector("#name"),o=g.querySelector(".agent-skill-dialog-title"),v=document.querySelector("#add-skill-input-info-icon");o&&v&&(v.classList.remove("hidden"),o.appendChild(v)),be(50).then(()=>Wn(S))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(w?.name){const g=await this.addInput(this.inputContainer,w.name,w);if(w.optional&&(g.setAttribute("smt-optional",w.optional),w.optional?g.classList.add("optional"):g.classList.remove("optional")),g&&w.color){g.setAttribute("smt-color",w.color),g.querySelector(".ep").style.backgroundColor=w.color||`${Oe.conEndColor}`,g.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${w.color}) 1`;const S=g.endpoint;if(S&&S.connections)for(let o of S.connections)this.workspace.updateConnectionColors(o)}g?.setAttribute("smt-type",w?.type||""),g?.setAttribute("smt-friendly-input-type",w?.friendlyInputType||""),g?.setAttribute("smt-core-input-type",w?.coreInputType||"");for(let S in this.inputSettings){const o=this.inputSettings[S];if(g&&o){const v=g.getAttribute(`smt-${S}`);w[S]!==v&&w[S]!=null&&g.setAttribute(`smt-${S}`,w[S])}}this.repaint(),this.workspace.saveAgent()}}async addOutputDialog(){const i={name:{type:"text",label:"Output Name",class:"stg-input stg-name",value:"",validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:ti(`${Oe.conStartColor}`)};for(let g in this.outputSettings){const S=this.outputSettings[g];S&&(i[g]={...S.editConfig,value:S.editConfig?.defaultVal||""})}i?.description&&(i.description.section="Advanced_Options");const e=this.constructor.name===An.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Output</span>':'<span class="text-xl">Add Output</span>',d=Qn(i,["description","expression","additionalOptionsLabel","color"]),w=await this.inputEditor({title:e,fields:d,onDOMReady:g=>{const S=g.querySelector("#name"),o=g.querySelector(".agent-skill-dialog-title"),v=document.querySelector("#add-skill-input-info-icon");o&&v&&(v.classList.remove("hidden"),o.appendChild(v)),be(50).then(()=>Wn(S))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(w?.name){const g=await this.addOutput(this.outputContainer,w.name,w);if(g&&w.color){g.setAttribute("smt-color",w.color),g.querySelector(".ep").style.backgroundColor=w.color||`${Oe.conStartColor}`,g.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${w.color}) 1`;const S=g.endpoint;if(S&&S.connections)for(let o of S.connections)this.workspace.updateConnectionColors(o)}for(let S in this.outputSettings){const o=this.outputSettings[S];if(g&&o){const v=g.getAttribute(`smt-${S}`);w[S]!==v&&w[S]!=null&&g.setAttribute(`smt-${S}`,w[S])}}this.repaint()}}async openDebugDialog(i,e="step"){Ve.track("app_debug_inject_click",{}),i.stopPropagation(),i.stopImmediatePropagation();const d=this.domElement.querySelector(".btn-debug"),w=[...this.domElement.querySelectorAll(".input-endpoint")].map(S=>({name:S.getAttribute("smt-name"),type:S.getAttribute("smt-isfile")=="true"||Jo.includes(S.getAttribute("smt-type"))?"file":"text"})),g=[...this.domElement.querySelectorAll(".output-endpoint")].map(S=>({name:S.getAttribute("smt-name")}));return new Promise((S,o)=>{this.workspace.debugger.createDebugInjectDialog(this,w,g,async v=>{if(this.workspace.debugger.getDebugSessionID())return null;Ri({step:{enable:!1},run:e==="run"?{enable:!0,icon:"mif-pause",tooltipText:"Pause"}:{enable:!1},stop:{enable:e!=="run"},attach:{enable:!1}});const u=this.workspace.agent;try{this.workspace.domElement.classList.add("debugging"),d.classList.add("active"),await this.workspace.debugger.injectComponentDebugInfo(u.id,this._uid,v);const r=await this.workspace.debugger.readDebugStep(u.id);return S({status:"success"}),r}catch(r){return r&&r?.status==413&&ae("Payload Too Large"),ae("Something went wrong, please try again later!"),o({status:"error"}),{errorOccurred:!0}}finally{nr()}},e)})}exportTemplate(){return null}export(){const i=this,e=this.domElement;return{id:e.id,name:e.querySelector(".title-bar").getAttribute("smt-name"),outputs:[...e.querySelectorAll(".output-endpoint")].map((d,w)=>({name:d.getAttribute("smt-name"),color:d.getAttribute("smt-color"),...workspace.extractComponentOutputProps(e,d),index:w,uuid:d.endpoint?.getUuid(),default:i.properties.defaultOutputs.includes(d.getAttribute("smt-name"))})),inputs:[...e.querySelectorAll(".input-endpoint")].map((d,w)=>({name:d.getAttribute("smt-name"),type:d.getAttribute("smt-type"),friendlyInputType:d.getAttribute("smt-friendly-input-type"),coreInputType:d.getAttribute("smt-core-input-type"),color:d.getAttribute("smt-color"),optional:d.getAttribute("smt-optional")==="true",...workspace.extractComponentInputProps(e,d),index:w,uuid:d.endpoint?.getUuid(),default:i.properties.defaultInputs.includes(d.getAttribute("smt-name"))})),data:typeof i.data=="object"?JSON.parse(JSON.stringify(i.data)):i.data,top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height,displayName:i.drawSettings.displayName,title:i.title,aiTitle:i.aiTitle,description:i.description,template:typeof i.properties.template=="object"?JSON.parse(JSON.stringify(i.properties.template)):i.properties.template}}async updateTitle(){const i=this.settingsEntries,e=document.querySelector("#right-sidebar form"),d=ii(e,i),w=Zo("Generating Title..."),g=this.domElement.querySelector(".title-bar .title"),S=g.querySelector(".text"),o=g.querySelector(".btn-edit-inline");S.style.display="none",o.style.display="none",g.appendChild(w);try{const v=await this.generateTitle(d?.prompt);v&&(this.aiTitle=v,S.textContent=v)}finally{w.remove(),S.style.display="inline",o.style.display="inline-flex"}}async generateTitle(i){if(!(!i||typeof i!="string"))try{const e=await(await fetch("/api/page/builder/data/generate-component-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:i})})).json();if(!e?.success)throw new Error("Error generating title!");return e?.data}catch{return""}}}function Qn(a,i){const e={...a};let d={};for(let w of i)e[w]&&(d[w]=e[w],delete e[w]);return d={...d,...e},d}function $l({value:a="",label:i=""}){const e=[{value:"Text",text:"Text",classes:{check:"svg-icon Text border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Image",text:"Image",classes:{check:"svg-icon Image border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Audio",text:"Audio",classes:{check:"svg-icon Audio border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Video",text:"Video",classes:{check:"svg-icon Video border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Others",text:"Others",classes:{check:"svg-icon Others border-0 rounded-none w-6 h-6",caption:"text-base"}}];for(let[d,w]of e.entries())w.classes.radio=w.value===a?"active":"",e[d]=w;return be(100).then(()=>{if(a==="Others"){const d=document.querySelector('[data-field-name="coreInputType"]'),w=document.getElementById("type");d?.classList?.remove("hidden");const g=document.getElementById("coreInputType");w&&(w.value=g?.value||"Any")}}),{type:"radio",label:i,class:"stg-input stg-type",formControlCls:"flex justify-between bg-white",fieldCls:"border border-solid border-[#D9D9D9] rounded-lg p-3 h-auto",value:a,options:e,events:{change:d=>{const w=d.target,g=w.value,S=document.querySelector('[data-field-name="coreInputType"]'),o=document.getElementById("type");if(g==="Others"){S?.classList?.remove("hidden");const u=document.getElementById("coreInputType");o&&(o.value=u?.value||"Any")}else S?.classList?.add("hidden"),o&&(o.value=g);w.closest(".form-group").querySelectorAll(".radio")?.forEach(u=>u.classList.remove("active"));const v=w.closest(".radio");v&&v.classList.add("active")}}}}function js({value:a="",label:i="",classes:e=""}){return{type:"select",class:e,label:i,value:a,options:[{value:"Any",text:"Any"},{value:"String",text:"String"},{value:"Number",text:"Number (can include floating point)"},{value:"Integer",text:"Integer (without a fraction part)"},{value:"Boolean",text:"Boolean"},{value:"Array",text:"Array"},{value:"Object",text:"Object"},{value:"Binary",text:"Binary"},{value:"Date",text:"Date (ISO 8601 Standard)"}],events:{change:d=>{const w=d.target.value,g=document.getElementById("type");g&&(g.value=w)}}}}function ti(a=""){return{type:"color",class:"w-44 stg-input stg-color stg-circle-color-picker",value:a,section:"Advanced_Options",fieldsGroup:"additionalOptions"}}function Ms(a=!1,i=!1){return{type:"radio",label:"",value:a,section:"Advanced_Options",class:"w-2/4 stg-input stg-optional",fieldsGroup:"additionalOptions",readonly:i,options:[{value:!1,text:"Required"},{value:!0,text:"Optional"}]}}function Is({compName:a,values:i}){return a===An.apiEndpoint?{friendlyInputType:$l({value:i.friendlyInputType,label:"Input type"}),coreInputType:js({value:i.coreInputType,classes:"w-full h-12 hidden"}),type:{type:"hidden",class:"stg-input stg-type",value:i.type,attributes:{"data-cls-option":"option-input-type"}}}:{coreInputType:js({value:i.coreInputType,label:"Input type",classes:"w-full"}),type:{type:"hidden",class:"stg-input stg-type",value:i.type,attributes:{"data-cls-option":"option-input-type"}}}}function Bl({keyName:a,component:i,onSuccess:e,onError:d}){const w={keyName:{label:"Name",type:"text",class:"w-2/5",value:a,readonly:!0},apiKey:{label:"Key",type:"textarea",fieldCls:"max-h-64 min-h-[34px] h-[34px] px-3 py-1",class:"w-3/5",validate:"required maxlength=10000",validateMessage:"API Key is required",value:"",autoSize:!1,attributes:{placeholder:"Please enter your Key"}}},g="_add_missing_key_submit_btn",S="_mock_data_btn",o=async(r,m)=>{const{keyName:E,apiKey:O}=r,D=na("white","mr-2"),y=m.querySelector(`.${g}`);y.textContent="Adding Key...",y.prepend(D),y.disabled=!0;try{const c=["All"],F=await fetch(`${ia.env.UI_SERVER}/api/page/builder/keys`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:E,key:O,scope:c})}).then(k=>k.json());ai(m),e({[F?.data?.keyId]:{name:E,scope:c}})}catch{d()}finally{D.remove(),y.disabled=!1,y.textContent="Add Key"}},v={label:"Skip for now and set mock data",cssClass:`underline hover:no-underline text-gray-500 ${S}`,callback:async(r,m)=>{const E=y=>(y+Math.random()).toString(36).replace(".",""),O=`sos-mock-key-${E(Date.now())}-${E(123456789)}`,D=m.querySelector("#apiKey");D.value=O,await o({...r,apiKey:O},m),Ve.track("app_mock_screen_impression",{source:"skip_and_set_mock_data"}),await er(i),Tn.turnOn(i),await Fi(i)}},u={label:"Continue",cssClass:`disabled:opacity-50 bg-v2-blue hover:bg-v2-blue/80 text-white cursor-pointer ml-auto mt-2 ${g}`,requiresValidation:!0,callback:o};Vs({title:"Configure API Key",fields:w,content:`<span class="text-xs text-gray-500 block mb-4">The component <span class="font-bold">${i?.title||""}</span> requires an API key to function. Please retrieve your API key from the provider and securely store it in the SmythOS vault.</span>`,actions:[v,u],onCloseClick:(r,m)=>{ai(m)},onDOMReady:async r=>{const m=r.querySelector(`.${g}`);m.classList.remove("w-[340px]"),m.classList.add("w-40");const E=r.querySelector(`.${S}`);E?.classList.remove("w-[340px]"),E?.classList.remove("text-white"),E?.classList.remove("hover:opacity-75"),E?.classList.add("auto");const O=r.querySelector(".__actions");O?.classList.remove("justify-center"),O?.classList.add("justify-between")}},"auto","auto","none","672px","672px")}function Oi(a){return"_comp_message_"+a.replace(/\+/g,"_").replace(/\s+/g,"_").toLowerCase()}function ql(a,i){Bl({keyName:a,component:this,onSuccess:e=>{jn("Key saved successfully"),this?.clearComponentMessage(`.${Oi(a)}`),ea(e);const d=this.workspace?.agent?.data?.components.map(w=>{const g=w.data,S=[];for(const o in g){let v=g[o];if(!v||(v=typeof v=="object"?JSON.stringify(v):v,typeof v!="string"))continue;const u=/{{KEY\(([^}]*)\)}}/g;let r;for(;(r=u.exec(v))!==null;)if(r[1]){const m=r[1];(m===a||m.replace(/\+/g," ")===a)&&S.push({id:w.id,keyName:m})}}return S}).flat(1/0).filter(w=>w.id);d.length>0&&d.forEach(async({id:w,keyName:g})=>{await Di[w]?.checkSettings()})},onError:()=>{ae("Error saving key, please try again or contact support.")}})}let cr;async function je(a,i={},e,d){window.dispatchEvent(new CustomEvent("sidebarStateChanged",{detail:{rightSidebarOpen:!1,isSidebarOpen:window?.localStorage?.getItem("sidebarOpen")==="true",currentSidebarTab:window?.localStorage?.getItem("currentSidebarTab")}})),Le.curComponentSettings&&await Le.curComponentSettings.closeSettings(),cr.domElement.classList.contains("debug-enabled");const w=document.querySelector("#embodiment-sidebar").querySelector(".title");let g;if(a)g=await ra(e,a,i,d);else{g=await oa();const S=aa(e,d);w.innerHTML=S}g.querySelector("button.close-btn")?.classList?.remove("hidden")}async function zl(){const{dev:a,prod:i,scheme:e}=We.getState().agentDomains;if(!a&&!i){je('<div class="p-4">Agent domain is not set. Cannot provide chatGPT configuration</div>',{},"ChatGPT deployment instructions");return}const d=`<div class="emb-instructions p-4">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">${le.chatgpt.description}</p>
        </div>
        <p>In order to create a custom GPT using your agent</p>
        &nbsp;<br />
        <ul class="steps">
            <li><a href="https://chat.openai.com/gpts/editor" target="_blank">Click Here</a> to Create a custom GPT from chatGPT interface.</li>
            <li>Click on "Configure" tab</li>
            <li>Enter your Custom GPT information: We recommend to copy the content of SmythOS Agent behavior inside "Instructions" area in order to have a consistent behavior</li>
            <li>Scroll down and Click on "Create new action" button.<br />
            ${a?`<li>- Click Import URL and enter the following URL if you want to use your test agent: <b>${e}://${a}/api-docs/openapi-llm.json</b></li>`:""}
            ${i?`<li> - Click Import URL and enter the following URL if you want to use your production agent: <b>${e}://${i}/api-docs/openapi-llm.json</b></li>`:""}
            </li>
            <li>Click on "Create" button on the top right</li>
            <li>Your custom GPT is ready, you can keep customizing it or just start using it</li>
        </ul>
        &nbsp;<br />
        <hr />
        &nbsp;<br />
        <p>
        <b>Note :</b> If you use the test url, your Custom GPT will use the current edited agent. When debug mode is enabled, the agent will not respond until you attach the debugger and run the workflow, this allows you to capture incoming requests to your agent in test mode and test them.
        </p>
        </div>
    `;je(d,{},le.chatgpt.title,le.chatgpt.tooltipTitle)}async function Vl(){const{dev:a,prod:i,scheme:e}=We.getState().agentDomains;if(!a&&!i){je('<div class="p-4">Agent domain is not set. Cannot provide Postman features</div>',{},le.api.title,le.api.tooltipTitle);return}const d=a?`${e}://${a}/postman`:"",w=i?`${e}://${i}/postman`:"",g=d?`<div class="my-2"><a href="${d}" target="_blank" class="flex items-center justify-center text-sm font-normal border border-solid text-base px-4 py-2 text-center rounded transition-all duration-200 outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none ${vs}">Export Test Endpoints</a></div>`:"",S=w?`<div class="my-2"><a href="${w}" target="_blank" class="flex items-center justify-center text-sm font-normal border border-solid text-base px-4 py-2 text-center rounded transition-all duration-200 outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none ${vs}">Export Prod Endpoints</a></div>`:"",o=`<div class="emb-instructions p-4 flex-row">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">Test your agent using Postman or import Postman collections to your agent workspace. Includes tools for exporting and debugging API calls.</p>
        </div>
        &nbsp;<br />
        <h2>Exporting Agent to Postman Collection</h2>
        <div class="flex space-x-3 justify-between">
        ${g}

        ${S}
        </div>
        &nbsp;<br />
        <p>
        When you use the test agent, you can enable the debug mode to capture incoming requests to your agent, in this case, the request will remain stuck until you attach the debugger and run the workflow from SmythOS builder.<a href="${Us}/agent-studio/build-agents/debugging" target="_blank"> Learn more</a>
        </p>
        &nbsp;<br />
        <h2>Importing Postman Collection to Agent</h2>
        <p>You can import a postman collection to your agent by dragging the collection .json file to the agent workspace.</p>
        &nbsp;<br />
        <hr />
        </div>
    `;je(o,{},le.postman.title,le.postman.tooltipTitle)}async function Ul(){Ve.track("alexa_embodiment_click",{position:"top right of builder inside dropdown"});const{dev:a,prod:i,scheme:e}=We.getState().agentDomains,d=u=>`<div id="alexa-embodiment-wrapper">${u}</div>`;if(!a&&!i){const u=d('<div class="p-4">Agent domain is not set. Cannot provide Alexa features</div>');je(u,{},le.alexa.title,le.alexa.tooltipTitle);return}const w=a?`${e}://${a}/alexa`:"",g=i?`${e}://${i}/alexa`:"Agent is not deployed yet",S=`(() => {
    document.getElementById('alexa-access-token').value = '';
    document.getElementById('alexa-vendor-id').value = '';
    document.querySelector('#alexa-publish-modal .publish-btn').innerHTML = 'Publish';
    document.querySelector('#alexa-publish-modal .publish-btn').disabled = false;
    document.getElementById('alexa-publish-modal').classList.add('hidden');
  })()`,o=`<button onclick="(async () => {
    const btn = event.target;
    try {
      // Show loading state
      const spinner = document.createElement('div');
      spinner.className = 'inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2';
      btn.innerHTML = '';
      btn.appendChild(spinner);
      btn.appendChild(document.createTextNode('Publishing...'));
      btn.disabled = true;

      const accessToken = document.getElementById('alexa-access-token').value;
      const vendorId = document.getElementById('alexa-vendor-id').value;

      const response = await fetch('${w}', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          accessToken,
          vendorId
        })
      });

      if (!response.ok) {
        throw new Error('Failed to publish');
      }

      // Show success state
      document.getElementById('alexa-publish-modal').classList.add('hidden');
      successToast('Alexa Skill published successfully');

    } catch (error) {
      console.error(error);
      btn.innerHTML = 'Failed to Publish';
      errorToast('Failed to publish Alexa Skill');
      
      // Reset button after delay
      setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = 'Publish';
      }, 2000);
    }
  })()"
    class="publish-btn px-4 py-2 text-sm text-white bg-smyth-emerald-400 rounded-md hover:opacity-75 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2">
    Publish
  </button>`,v=d(`<div class="emb-instructions p-4 flex-row">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">Publish your agent as an Alexa Skill. You can publish your skill to the Alexa Skill Store or use it in your own Alexa devices.</p>
        </div>
        <div class="space-x-3 justify-between">
         <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Alexa Dev Endpoint</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="alexa-dev-url" 
                value="${w}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${w}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Alexa Prod Endpoint</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="alexa-prod-url" 
                value="${g}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${g}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
        </div>
        &nbsp;<br />
        <hr />

        <!-- Modal -->
        <div id="alexa-publish-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
          <div class="bg-white rounded-lg p-6 w-[500px] max-w-[90%]">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-semibold">Publish Alexa Skill</h3>
              <button onclick="${S}" class="text-gray-500 hover:text-gray-700">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Access Token</label>
                <input type="text" id="alexa-access-token" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-emerald-500"
                  placeholder="Enter Access Token">
              </div>


              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Vendor ID</label>
                <input type="text" id="alexa-vendor-id" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-emerald-500"
                  placeholder="Enter Vendor ID">
              </div>
            </div>

            <div class="mt-6 flex justify-end space-x-3">
              <button onclick="${S}" class="px-4 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50">
                Cancel
              </button>
              ${o}
            </div>
          </div>
        </div>
    </div>`);je(v,{},le.alexa.title,le.alexa.tooltipTitle),We.subscribe(u=>[u.agentDomains.prod,u.agentDomains.scheme],([u,r])=>{const m=u?`${r}://${u}/alexa`:"Agent is not deployed yet",E=document.querySelector("#alexa-embodiment-wrapper #alexa-prod-url");if(E){E.value=m;const O=E.nextElementSibling;O&&O.setAttribute("onclick",`(function(){ navigator.clipboard.writeText('${m}'); successToast('URL copied to clipboard', 'Info'); })()`)}})}async function Hl(){const{dev:a,scheme:i}=We.getState().agentDomains,e=document.querySelector(".modalBox");e&&(e.style.width="600px");let d=document.querySelector("#chatbot-iframe"),w,g={};const S=`${i||"https"}://${a}/chatBot?allowAttachments=true`,o=`chatbot-spinner-${Date.now()}`,v='<span class="mif-refresh text-[#757575] hover:text-[#374151] cursor-pointer flex items-center justify-center w-4 h-4"></span>',u=`<svg class="w-4 h-4 animate-spin cursor-default flex items-center justify-center" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
    <path fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
  </svg>`;(!d||d.src!=S)&&(w=`
      <div class="p-4 h-full">
        <div class="flex items-center gap-2">
          <p class="text-gray-700">${le.chat.description}</p>
        </div>
        <div id="${o}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
        <iframe src="${S}" id="chatbot-iframe" frameborder="0" style="width:100%;height:calc(100% - 2rem);"></iframe>
      </div>
    `,g={Refresh:{click:async m=>{const E=document.querySelector(".refresh-chat-btn"),O=document.querySelector("#chatbot-iframe");if(O&&E&&!E.classList.contains("loading")){E.classList.add("loading"),E.style.pointerEvents="none",E.style.opacity="0.7",E.innerHTML=u;const D=()=>{E.innerHTML=v,E.classList.remove("loading"),E.style.pointerEvents="auto",E.style.opacity="1",O.removeEventListener("load",D)};O.addEventListener("load",D),O.src+=""}},label:`<span class="refresh-chat-btn loading flex items-center justify-center w-4 h-4" style="pointer-events: none; opacity: 0.7;">${u}</span>`,tooltip:"Refresh chat session",tooltipPlacement:"left"}}),await je(w,g,le.chat.title,le.chat.tooltipTitle),d=document.querySelector("#chatbot-iframe");const r=document.getElementById(o);d&&d.addEventListener("load",async()=>{r&&r.style.setProperty("display","none","important"),d.style.display="block";const m=document.querySelector(".refresh-chat-btn");m&&(m.innerHTML=v,m.classList.remove("loading"),m.style.pointerEvents="auto",m.style.opacity="1"),await be(200),cr.debugger.stopDebugSession(),Ks.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["chatbot"])})}async function Gl(){const{dev:a,scheme:i}=We.getState().agentDomains;console.log("test domain found,",a,"Store:",We.getState());const e=document.querySelector(".modalBox");e&&(e.style.width="800px");let d=`${i||"https"}://${a}/swagger`;const w=`swagger-spinner-${Date.now()}`,g=`
    <div class="p-4 h-full">
      <div class="flex items-center gap-2 mb-4">
        <p class="text-gray-700">${le.api.description}</p>
      </div>
      <div id="${w}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <iframe src="${d}" id="swagger-iframe" frameborder="0" style="width:100%;height:calc(100% - 3rem);display:none;"></iframe>
    </div>
  `;await je(g,{},le.api.title,le.api.tooltipTitle);const S=document.querySelector("#swagger-iframe"),o=document.getElementById(w);S&&S.addEventListener("load",async()=>{o&&o.style.setProperty("display","none","important"),S.style.display="block",await be(200),Ks.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["swagger"])})}async function Yl(){Ve.track("mcp_embodiment_click",{position:"top right of builder inside dropdown"});const{dev:a,prod:i,scheme:e}=We.getState().agentDomains,d=o=>`<div id="mcp-embodiment-wrapper">${o}</div>`;if(!a){const o=d('<div class="p-4">Agent domain is not set. Cannot provide MCP features</div>');je(o,{},le.mcp.title,le.mcp.tooltipTitle);return}const w=`${e}://${a}/emb/mcp/sse`;let g="Agent is not deployed yet";i&&(g=`${e}://${i}/emb/mcp/sse`);const S=d(`
    <div class="emb-instructions p-4 flex-row">
      <div class="flex items-center gap-2 mb-4">
        <p class="text-gray-700">Turn your agents into an MCP server, ready to integrate and ship with one click.</p>
      </div>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">MCP Dev URL</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="mcp-dev-url" 
                value="${w}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${w}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">MCP Prod URL</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="mcp-prod-url" 
                value="${g}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${g}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `);je(S,{},le.mcp.title,le.mcp.tooltipTitle),We.subscribe(o=>[o.agentDomains.prod,o.agentDomains.scheme],([o,v])=>{const u=`${v}://${o}/emb/mcp/sse`,r=document.querySelector("#mcp-embodiment-wrapper #mcp-prod-url");if(r){r.value=u;const m=r.nextElementSibling;m&&m.setAttribute("onclick",`(function(){ navigator.clipboard.writeText('${u}'); successToast('URL copied to clipboard', 'Info'); })()`)}})}async function Wl(){const a=document.querySelector(".modalBox");a&&(a.style.width="800px");const i="skill-preview-sidebar-root",e=`
    <div class="p-4 h-full">
      <div id="${i}"></div>
    </div>`;await je(e,{},le.agent_skill.title,le.agent_skill.tooltipTitle),Za({rootID:i})}sa({openEmbodimentDialog:je,openChatGPTEmbodiment:zl,openPostmanEmbodiment:Vl,openChatbotEmbodiment:Hl,openAPIEmbodiment:Gl,openFormPreviewEmbodiment:Wl,openAlexaEmbodiment:Ul,openMCPEmbodiment:Yl});export{Gl as openAPIEmbodiment,Ul as openAlexaEmbodiment,zl as openChatGPTEmbodiment,Hl as openChatbotEmbodiment,je as openEmbodimentDialog,Yl as openMCPEmbodiment,Vl as openPostmanEmbodiment};
