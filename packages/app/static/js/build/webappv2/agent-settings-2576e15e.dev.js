var Tg=Object.defineProperty;var u=(n,e)=>Tg(n,"name",{value:e,configurable:!0});import{t as jg,W as Zl,i as Og,d as Po,e as Dg,f as li,h as Ql,j as Mg,k as Ng,s as $g,l as Fg,m as Rg,n as qg,o as ec,p as js,g as Io,c as mt,r as ue,q as g,T as bn,F as ci,H as Lo,I as tc,u as nc,v as To,w as Bg,R as at,x as Ug,y as sc,z as zg,M as Gg,A as Hg,B as Vg,C as Wg,D as Kg,E as Yg,G as ac,J as Xg,K as ic,L as oc,N as Jg,P as Os,O as jn,Q as rc,S as Zg,U as jo,V as Qg,X as ef,Y as Nt,Z as nn,_ as Kn,$ as tf,a0 as On,a1 as Et,a2 as gt,a3 as lc,a4 as Yn,a5 as Ds,a6 as ui,a7 as di,a8 as pi,a9 as hi,aa as An,ab as nf,ac as cc,ad as sf,ae as af,af as Ms,ag as ra,ah as of,ai as rf,aj as lf,ak as cf,al as uf,am as df,an as pf,ao as Kt,ap as uc,aq as hf,ar as mf,as as Ct,at as Oo,au as mi,av as dc,aw as gf,ax as gi,ay as ff,az as la,aA as vf,aB as Do,aC as $t,aD as Mo,aE as bf,aF as pc,aG as hs,aH as Ft,aI as yf,aJ as ca,aK as hc,aL as Je,aM as En,aN as Xn,aO as Dn,aP as No,aQ as ua,aR as yn,aS as $o,aT as xf,aU as Fo,aV as wf,aW as mc,aX as gc,aY as fc,aZ as Sf,a_ as vc,a$ as Cf,b0 as Af,b1 as bc,b2 as Ef,b3 as kf,b4 as _f,b5 as Pf,b6 as If,b7 as Lf,b8 as Tf,b9 as jf,ba as Of,bb as Df,bc as Mf,bd as yc,be as Nf,bf as $f,bg as Ff,bh as Rf,bi as qf,bj as Bf,bk as Uf,bl as zf,bm as Jn,bn as Gf,bo as kn,bp as da,bq as xc,br as Hf,bs as wc,bt as Vf,bu as Wf,bv as Kf,bw as Yf,bx as Xf,by as Jf,bz as Zf,bA as Qf,bB as ev,bC as pa,bD as $e,bE as tv,bF as nv,bG as ct,bH as ha,bI as ma,bJ as Mn,bK as ms,bL as Ns,bM as gs,bN as fs,bO as ga,bP as sv,bQ as Dt,bR as av,bS as sn,bT as Ro,bU as iv,bV as Sc,bW as ov,bX as Cc,bY as Ac,bZ as vs,b_ as Zn,b$ as rv,c0 as bs,c1 as $s,c2 as fi,c3 as qo,c4 as Bo,c5 as Uo,c6 as lv,c7 as zo,c8 as cv,c9 as uv,ca as Go,cb as vi,cc as bi,cd as dv,ce as Ec,cf as pv,cg as yi,ch as hv,ci as kc,cj as mv,ck as gv,cl as fv,cm as fa,cn as vv,co as ys,cp as Ho,cq as xs,cr as Fs,cs as bv,ct as yv,cu as xv,cv as xi,cw as _c,cx as wv,cy as wi,cz as Sv,cA as Cv,cB as Si,cC as Pc,cD as Av,cE as Ev,cF as Ic,cG as kv,cH as _v,cI as Pv,cJ as Iv,cK as Lv,cL as Tv,cM as jv,cN as Ov}from"./app.bundle.dev.js";function Lc(n){var e=jg(n),t=e%1;return e===e?t?e-t:e:0}u(Lc,"toInteger");var Ci=Zl&&new Zl,Tc=Ci?function(n,e){return Ci.set(n,e),n}:Og;function va(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Po(n.prototype),s=n.apply(t,e);return Dg(s)?s:t}}u(va,"createCtor");var Dv=1;function Mv(n,e,t){var s=e&Dv,a=va(n);function o(){var r=this&&this!==li&&this instanceof o?a:n;return r.apply(s?t:this,arguments)}return u(o,"wrapper"),o}u(Mv,"createBind");var Nv=Math.max;function jc(n,e,t,s){for(var a=-1,o=n.length,r=t.length,i=-1,d=e.length,c=Nv(o-r,0),l=Array(d+c),m=!s;++i<d;)l[i]=e[i];for(;++a<r;)(m||a<o)&&(l[t[a]]=n[a]);for(;c--;)l[i++]=n[a++];return l}u(jc,"composeArgs");var $v=Math.max;function Oc(n,e,t,s){for(var a=-1,o=n.length,r=-1,i=t.length,d=-1,c=e.length,l=$v(o-i,0),m=Array(l+c),v=!s;++a<l;)m[a]=n[a];for(var x=a;++d<c;)m[x+d]=e[d];for(;++r<i;)(v||a<o)&&(m[x+t[r]]=n[a++]);return m}u(Oc,"composeArgsRight");function Fv(n,e){for(var t=n.length,s=0;t--;)n[t]===e&&++s;return s}u(Fv,"countHolders");function Vo(){}u(Vo,"baseLodash");var Rv=4294967295;function Rs(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Rv,this.__views__=[]}u(Rs,"LazyWrapper"),Rs.prototype=Po(Vo.prototype),Rs.prototype.constructor=Rs;function qv(){}u(qv,"noop");var Dc=Ci?function(n){return Ci.get(n)}:qv,Mc={},Bv=Object.prototype,Uv=Bv.hasOwnProperty;function zv(n){for(var e=n.name+"",t=Mc[e],s=Uv.call(Mc,e)?t.length:0;s--;){var a=t[s],o=a.func;if(o==null||o==n)return a.name}return e}u(zv,"getFuncName");function qs(n,e){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}u(qs,"LodashWrapper"),qs.prototype=Po(Vo.prototype),qs.prototype.constructor=qs;function Gv(n){if(n instanceof Rs)return n.clone();var e=new qs(n.__wrapped__,n.__chain__);return e.__actions__=Ql(n.__actions__),e.__index__=n.__index__,e.__values__=n.__values__,e}u(Gv,"wrapperClone");var Hv=Object.prototype,Vv=Hv.hasOwnProperty;function Ai(n){if(Mg(n)&&!Ng(n)&&!(n instanceof Rs)){if(n instanceof qs)return n;if(Vv.call(n,"__wrapped__"))return Gv(n)}return new qs(n)}u(Ai,"lodash"),Ai.prototype=Vo.prototype,Ai.prototype.constructor=Ai;function Wv(n){var e=zv(n),t=Ai[e];if(typeof t!="function"||!(e in Rs.prototype))return!1;if(n===t)return!0;var s=Dc(t);return!!s&&n===s[0]}u(Wv,"isLaziable");var Nc=$g(Tc),Kv=/\{\n\/\* \[wrapped with (.+)\] \*/,Yv=/,? & /;function Xv(n){var e=n.match(Kv);return e?e[1].split(Yv):[]}u(Xv,"getWrapDetails");var Jv=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function Zv(n,e){var t=e.length;if(!t)return n;var s=t-1;return e[s]=(t>1?"& ":"")+e[s],e=e.join(t>2?", ":" "),n.replace(Jv,`{
/* [wrapped with `+e+`] */
`)}u(Zv,"insertWrapDetails");function Qv(n,e,t,s){for(var a=n.length,o=t+(s?1:-1);s?o--:++o<a;)if(e(n[o],o,n))return o;return-1}u(Qv,"baseFindIndex");function eb(n){return n!==n}u(eb,"baseIsNaN");function tb(n,e,t){for(var s=t-1,a=n.length;++s<a;)if(n[s]===e)return s;return-1}u(tb,"strictIndexOf");function nb(n,e,t){return e===e?tb(n,e,t):Qv(n,eb,t)}u(nb,"baseIndexOf");function sb(n,e){var t=n==null?0:n.length;return!!t&&nb(n,e,0)>-1}u(sb,"arrayIncludes");var ab=1,ib=2,ob=8,rb=16,lb=32,cb=64,ub=128,db=256,pb=512,hb=[["ary",ub],["bind",ab],["bindKey",ib],["curry",ob],["curryRight",rb],["flip",pb],["partial",lb],["partialRight",cb],["rearg",db]];function mb(n,e){return Fg(hb,function(t){var s="_."+t[0];e&t[1]&&!sb(n,s)&&n.push(s)}),n.sort()}u(mb,"updateWrapDetails");function $c(n,e,t){var s=e+"";return Rg(n,Zv(s,mb(Xv(s),t)))}u($c,"setWrapToString");var gb=1,fb=2,vb=4,bb=8,Fc=32,Rc=64;function qc(n,e,t,s,a,o,r,i,d,c){var l=e&bb,m=l?r:void 0,v=l?void 0:r,x=l?o:void 0,C=l?void 0:o;e|=l?Fc:Rc,e&=~(l?Rc:Fc),e&vb||(e&=~(gb|fb));var w=[n,e,a,x,m,C,v,i,d,c],f=t.apply(void 0,w);return Wv(n)&&Nc(f,w),f.placeholder=s,$c(f,n,e)}u(qc,"createRecurry");function Bc(n){var e=n;return e.placeholder}u(Bc,"getHolder");var yb=Math.min;function xb(n,e){for(var t=n.length,s=yb(e.length,t),a=Ql(n);s--;){var o=e[s];n[s]=qg(o,t)?a[o]:void 0}return n}u(xb,"reorder");var Uc="__lodash_placeholder__";function Ei(n,e){for(var t=-1,s=n.length,a=0,o=[];++t<s;){var r=n[t];(r===e||r===Uc)&&(n[t]=Uc,o[a++]=t)}return o}u(Ei,"replaceHolders");var wb=1,Sb=2,Cb=8,Ab=16,Eb=128,kb=512;function Wo(n,e,t,s,a,o,r,i,d,c){var l=e&Eb,m=e&wb,v=e&Sb,x=e&(Cb|Ab),C=e&kb,w=v?void 0:va(n);function f(){for(var T=arguments.length,k=Array(T),F=T;F--;)k[F]=arguments[F];if(x)var O=Bc(f),_=Fv(k,O);if(s&&(k=jc(k,s,a,x)),o&&(k=Oc(k,o,r,x)),T-=_,x&&T<c){var M=Ei(k,O);return qc(n,e,Wo,f.placeholder,t,k,M,i,d,c-T)}var b=m?t:this,P=v?b[n]:n;return T=k.length,i?k=xb(k,i):C&&T>1&&k.reverse(),l&&d<T&&(k.length=d),this&&this!==li&&this instanceof f&&(P=w||va(P)),P.apply(b,k)}return u(f,"wrapper"),f}u(Wo,"createHybrid");function _b(n,e,t){var s=va(n);function a(){for(var o=arguments.length,r=Array(o),i=o,d=Bc(a);i--;)r[i]=arguments[i];var c=o<3&&r[0]!==d&&r[o-1]!==d?[]:Ei(r,d);if(o-=c.length,o<t)return qc(n,e,Wo,a.placeholder,void 0,r,c,void 0,void 0,t-o);var l=this&&this!==li&&this instanceof a?s:n;return ec(l,this,r)}return u(a,"wrapper"),a}u(_b,"createCurry");var Pb=1;function Ib(n,e,t,s){var a=e&Pb,o=va(n);function r(){for(var i=-1,d=arguments.length,c=-1,l=s.length,m=Array(l+d),v=this&&this!==li&&this instanceof r?o:n;++c<l;)m[c]=s[c];for(;d--;)m[c++]=arguments[++i];return ec(v,a?t:this,m)}return u(r,"wrapper"),r}u(Ib,"createPartial");var zc="__lodash_placeholder__",Ko=1,Lb=2,Tb=4,Gc=8,ba=128,Hc=256,jb=Math.min;function Ob(n,e){var t=n[1],s=e[1],a=t|s,o=a<(Ko|Lb|ba),r=s==ba&&t==Gc||s==ba&&t==Hc&&n[7].length<=e[8]||s==(ba|Hc)&&e[7].length<=e[8]&&t==Gc;if(!(o||r))return n;s&Ko&&(n[2]=e[2],a|=t&Ko?0:Tb);var i=e[3];if(i){var d=n[3];n[3]=d?jc(d,i,e[4]):i,n[4]=d?Ei(n[3],zc):e[4]}return i=e[5],i&&(d=n[5],n[5]=d?Oc(d,i,e[6]):i,n[6]=d?Ei(n[5],zc):e[6]),i=e[7],i&&(n[7]=i),s&ba&&(n[8]=n[8]==null?e[8]:jb(n[8],e[8])),n[9]==null&&(n[9]=e[9]),n[0]=e[0],n[1]=a,n}u(Ob,"mergeData");var Db="Expected a function",Vc=1,Mb=2,Yo=8,Xo=16,Jo=32,Wc=64,Kc=Math.max;function Nb(n,e,t,s,a,o,r,i){var d=e&Mb;if(!d&&typeof n!="function")throw new TypeError(Db);var c=s?s.length:0;if(c||(e&=~(Jo|Wc),s=a=void 0),r=r===void 0?r:Kc(Lc(r),0),i=i===void 0?i:Lc(i),c-=a?a.length:0,e&Wc){var l=s,m=a;s=a=void 0}var v=d?void 0:Dc(n),x=[n,e,t,s,a,l,m,o,r,i];if(v&&Ob(x,v),n=x[0],e=x[1],t=x[2],s=x[3],a=x[4],i=x[9]=x[9]===void 0?d?0:n.length:Kc(x[9]-c,0),!i&&e&(Yo|Xo)&&(e&=~(Yo|Xo)),!e||e==Vc)var C=Mv(n,e,t);else e==Yo||e==Xo?C=_b(n,e,i):(e==Jo||e==(Vc|Jo))&&!a.length?C=Ib(n,e,t,s):C=Wo.apply(void 0,x);var w=v?Tc:Nc;return $c(w(C,x),n,e)}u(Nb,"createWrap");var $b=8;function ki(n,e,t){e=t?void 0:e;var s=Nb(n,$b,void 0,void 0,void 0,void 0,void 0,e);return s.placeholder=ki.placeholder,s}u(ki,"curry"),ki.placeholder={};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=js("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=js("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=js("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=js("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=js("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=js("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Ub=Object.defineProperty,zb=u((n,e)=>Ub(n,"name",{value:e,configurable:!0}),"a$w");const Xc=class{static{u(this,"s")}static send(e,t){let s=typeof e=="string"?e:JSON.stringify(e);const a=t.includes("all");(a||t.includes("chatbot"))&&this.sendChatbotMsg(s),(a||t.includes("swagger"))&&this.sendSwaggerMsg(s)}static sendChatbotMsg(e){const t=document.querySelector("#chatbot-iframe");t&&t.contentWindow.postMessage(e,"*")}static sendSwaggerMsg(e){const t=document.querySelector("#swagger-iframe");t&&t.contentWindow.postMessage(e,"*")}};zb(Xc,"EmbodimentRPCManager");let ya=Xc;var _i={exports:{}};_i.exports,function(n,e){(function(t,s){n.exports=s()})(mt,function(){function t(h,p){var y=Object.keys(h);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(h);p&&(E=E.filter(function(D){return Object.getOwnPropertyDescriptor(h,D).enumerable})),y.push.apply(y,E)}return y}u(t,"t");function s(h){for(var p=1;p<arguments.length;p++){var y=arguments[p]!=null?arguments[p]:{};p%2?t(Object(y),!0).forEach(function(E){d(h,E,y[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(y)):t(Object(y)).forEach(function(E){Object.defineProperty(h,E,Object.getOwnPropertyDescriptor(y,E))})}return h}u(s,"e");function a(h){return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},a(h)}u(a,"n");function o(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")}u(o,"r");function r(h,p){for(var y=0;y<p.length;y++){var E=p[y];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(h,w(E.key),E)}}u(r,"i");function i(h,p,y){return p&&r(h.prototype,p),y&&r(h,y),Object.defineProperty(h,"prototype",{writable:!1}),h}u(i,"o");function d(h,p,y){return(p=w(p))in h?Object.defineProperty(h,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):h[p]=y,h}u(d,"a");function c(h,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(p&&p.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),Object.defineProperty(h,"prototype",{writable:!1}),p&&m(h,p)}u(c,"s");function l(h){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},l(h)}u(l,"c");function m(h,p){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,E){return y.__proto__=E,y},m(h,p)}u(m,"l");function v(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}u(v,"u");function x(h){var p=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var y,E=l(h);if(p){var D=l(this).constructor;y=Reflect.construct(E,arguments,D)}else y=E.apply(this,arguments);return function(H,Z){if(Z&&(typeof Z=="object"||typeof Z=="function"))return Z;if(Z!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v(H)}(this,y)}}u(x,"p");function C(){return C=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(h,p,y){var E=function(H,Z){for(;!Object.prototype.hasOwnProperty.call(H,Z)&&(H=l(H))!==null;);return H}(h,p);if(E){var D=Object.getOwnPropertyDescriptor(E,p);return D.get?D.get.call(arguments.length<3?h:y):D.value}},C.apply(this,arguments)}u(C,"f");function w(h){var p=function(y,E){if(typeof y!="object"||y===null)return y;var D=y[Symbol.toPrimitive];if(D!==void 0){var H=D.call(y,E||"default");if(typeof H!="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(y)}(h,"string");return typeof p=="symbol"?p:p+""}u(w,"d");var f=u(function(h){return!(!h||!h.Window)&&h instanceof h.Window},"h"),T=void 0,k=void 0;function F(h){T=h;var p=h.document.createTextNode("");p.ownerDocument!==h.document&&typeof h.wrap=="function"&&h.wrap(p)===p&&(h=h.wrap(h)),k=h}u(F,"m");function O(h){return f(h)?h:(h.ownerDocument||h).defaultView||k.window}u(O,"y"),typeof window<"u"&&window&&F(window);var _=u(function(h){return!!h&&a(h)==="object"},"b"),M=u(function(h){return typeof h=="function"},"x"),b={window:function(h){return h===k||f(h)},docFrag:function(h){return _(h)&&h.nodeType===11},object:_,func:M,number:function(h){return typeof h=="number"},bool:function(h){return typeof h=="boolean"},string:function(h){return typeof h=="string"},element:function(h){if(!h||a(h)!=="object")return!1;var p=O(h)||k;return/object|function/.test(typeof Element>"u"?"undefined":a(Element))?h instanceof Element||h instanceof p.Element:h.nodeType===1&&typeof h.nodeName=="string"},plainObject:function(h){return _(h)&&!!h.constructor&&/function Object\b/.test(h.constructor.toString())},array:function(h){return _(h)&&h.length!==void 0&&M(h.splice)}};function P(h){var p=h.interaction;if(p.prepared.name==="drag"){var y=p.prepared.axis;y==="x"?(p.coords.cur.page.y=p.coords.start.page.y,p.coords.cur.client.y=p.coords.start.client.y,p.coords.velocity.client.y=0,p.coords.velocity.page.y=0):y==="y"&&(p.coords.cur.page.x=p.coords.start.page.x,p.coords.cur.client.x=p.coords.start.client.x,p.coords.velocity.client.x=0,p.coords.velocity.page.x=0)}}u(P,"E");function L(h){var p=h.iEvent,y=h.interaction;if(y.prepared.name==="drag"){var E=y.prepared.axis;if(E==="x"||E==="y"){var D=E==="x"?"y":"x";p.page[D]=y.coords.start.page[D],p.client[D]=y.coords.start.client[D],p.delta[D]=0}}}u(L,"T");var N={id:"actions/drag",install:function(h){var p=h.actions,y=h.Interactable,E=h.defaults;y.prototype.draggable=N.draggable,p.map.drag=N,p.methodDict.drag="draggable",E.actions.drag=N.defaults},listeners:{"interactions:before-action-move":P,"interactions:action-resume":P,"interactions:action-move":L,"auto-start:check":function(h){var p=h.interaction,y=h.interactable,E=h.buttons,D=y.options.drag;if(D&&D.enabled&&(!p.pointerIsDown||!/mouse|pointer/.test(p.pointerType)||E&y.options.drag.mouseButtons))return h.action={name:"drag",axis:D.lockAxis==="start"?D.startAxis:D.lockAxis},!1}},draggable:function(h){return b.object(h)?(this.options.drag.enabled=h.enabled!==!1,this.setPerAction("drag",h),this.setOnEvents("drag",h),/^(xy|x|y|start)$/.test(h.lockAxis)&&(this.options.drag.lockAxis=h.lockAxis),/^(xy|x|y)$/.test(h.startAxis)&&(this.options.drag.startAxis=h.startAxis),this):b.bool(h)?(this.options.drag.enabled=h,this):this.options.drag},beforeMove:P,move:L,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(h){return h.search("drag")===0}},z=N,I={init:function(h){var p=h;I.document=p.document,I.DocumentFragment=p.DocumentFragment||W,I.SVGElement=p.SVGElement||W,I.SVGSVGElement=p.SVGSVGElement||W,I.SVGElementInstance=p.SVGElementInstance||W,I.Element=p.Element||W,I.HTMLElement=p.HTMLElement||I.Element,I.Event=p.Event,I.Touch=p.Touch||W,I.PointerEvent=p.PointerEvent||p.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function W(){}u(W,"O");var B=I,K={init:function(h){var p=B.Element,y=h.navigator||{};K.supportsTouch="ontouchstart"in h||b.func(h.DocumentTouch)&&B.document instanceof h.DocumentTouch,K.supportsPointerEvent=y.pointerEnabled!==!1&&!!B.PointerEvent,K.isIOS=/iP(hone|od|ad)/.test(y.platform),K.isIOS7=/iP(hone|od|ad)/.test(y.platform)&&/OS 7[^\d]/.test(y.appVersion),K.isIe9=/MSIE 9/.test(y.userAgent),K.isOperaMobile=y.appName==="Opera"&&K.supportsTouch&&/Presto/.test(y.userAgent),K.prefixedMatchesSelector="matches"in p.prototype?"matches":"webkitMatchesSelector"in p.prototype?"webkitMatchesSelector":"mozMatchesSelector"in p.prototype?"mozMatchesSelector":"oMatchesSelector"in p.prototype?"oMatchesSelector":"msMatchesSelector",K.pEventTypes=K.supportsPointerEvent?B.PointerEvent===h.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,K.wheelEvent=B.document&&"onmousewheel"in B.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},q=K;function X(h,p){if(h.contains)return h.contains(p);for(;p;){if(p===h)return!0;p=p.parentNode}return!1}u(X,"M");function Q(h,p){for(;b.element(h);){if(J(h,p))return h;h=V(h)}return null}u(Q,"z");function V(h){var p=h.parentNode;if(b.docFrag(p)){for(;(p=p.host)&&b.docFrag(p););return p}return p}u(V,"A");function J(h,p){return k!==T&&(p=p.replace(/\/deep\//g," ")),h[q.prefixedMatchesSelector](p)}u(J,"R");var A=u(function(h){return h.parentNode||h.host},"C");function j(h,p){for(var y,E=[],D=h;(y=A(D))&&D!==p&&y!==D.ownerDocument;)E.unshift(D),D=y;return E}u(j,"j");function S(h,p,y){for(;b.element(h);){if(J(h,p))return!0;if((h=V(h))===y)return J(h,p)}return!1}u(S,"F");function U(h){return h.correspondingUseElement||h}u(U,"X");function G(h){var p=h instanceof B.SVGElement?h.getBoundingClientRect():h.getClientRects()[0];return p&&{left:p.left,right:p.right,top:p.top,bottom:p.bottom,width:p.width||p.right-p.left,height:p.height||p.bottom-p.top}}u(G,"Y");function Y(h){var p,y=G(h);if(!q.isIOS7&&y){var E={x:(p=(p=O(h))||k).scrollX||p.document.documentElement.scrollLeft,y:p.scrollY||p.document.documentElement.scrollTop};y.left+=E.x,y.right+=E.x,y.top+=E.y,y.bottom+=E.y}return y}u(Y,"L");function se(h){for(var p=[];h;)p.push(h),h=V(h);return p}u(se,"q");function le(h){return!!b.string(h)&&(B.document.querySelector(h),!0)}u(le,"B");function ne(h,p){for(var y in p)h[y]=p[y];return h}u(ne,"V");function he(h,p,y){return h==="parent"?V(y):h==="self"?p.getRect(y):Q(y,h)}u(he,"W");function pe(h,p,y,E){var D=h;return b.string(D)?D=he(D,p,y):b.func(D)&&(D=D.apply(void 0,E)),b.element(D)&&(D=Y(D)),D}u(pe,"G");function fe(h){return h&&{x:"x"in h?h.x:h.left,y:"y"in h?h.y:h.top}}u(fe,"N");function me(h){return!h||"x"in h&&"y"in h||((h=ne({},h)).x=h.left||0,h.y=h.top||0,h.width=h.width||(h.right||0)-h.x,h.height=h.height||(h.bottom||0)-h.y),h}u(me,"U");function we(h,p,y){h.left&&(p.left+=y.x),h.right&&(p.right+=y.x),h.top&&(p.top+=y.y),h.bottom&&(p.bottom+=y.y),p.width=p.right-p.left,p.height=p.bottom-p.top}u(we,"H");function _e(h,p,y){var E=y&&h.options[y];return fe(pe(E&&E.origin||h.options.origin,h,p,[h&&p]))||{x:0,y:0}}u(_e,"K");function je(h,p){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(oe){return!0},E=arguments.length>3?arguments[3]:void 0;if(E=E||{},b.string(h)&&h.search(" ")!==-1&&(h=Pe(h)),b.array(h))return h.forEach(function(oe){return je(oe,p,y,E)}),E;if(b.object(h)&&(p=h,h=""),b.func(p)&&y(h))E[h]=E[h]||[],E[h].push(p);else if(b.array(p))for(var D=0,H=p;D<H.length;D++){var Z=H[D];je(h,Z,y,E)}else if(b.object(p))for(var te in p)je(Pe(te).map(function(oe){return"".concat(h).concat(oe)}),p[te],y,E);return E}u(je,"$");function Pe(h){return h.trim().split(/ +/)}u(Pe,"J");var qe=u(function(h,p){return Math.sqrt(h*h+p*p)},"Q"),Me=["webkit","moz"];function ye(h,p){h.__set||(h.__set={});var y=u(function(D){if(Me.some(function(H){return D.indexOf(H)===0}))return 1;typeof h[D]!="function"&&D!=="__set"&&Object.defineProperty(h,D,{get:function(){return D in h.__set?h.__set[D]:h.__set[D]=p[D]},set:function(H){h.__set[D]=H},configurable:!0})},"n");for(var E in p)y(E);return h}u(ye,"tt");function be(h,p){h.page=h.page||{},h.page.x=p.page.x,h.page.y=p.page.y,h.client=h.client||{},h.client.x=p.client.x,h.client.y=p.client.y,h.timeStamp=p.timeStamp}u(be,"et");function Ae(h){h.page.x=0,h.page.y=0,h.client.x=0,h.client.y=0}u(Ae,"nt");function xe(h){return h instanceof B.Event||h instanceof B.Touch}u(xe,"rt");function Ne(h,p,y){return h=h||"page",(y=y||{}).x=p[h+"X"],y.y=p[h+"Y"],y}u(Ne,"it");function Xe(h,p){return p=p||{x:0,y:0},q.isOperaMobile&&xe(h)?(Ne("screen",h,p),p.x+=window.scrollX,p.y+=window.scrollY):Ne("page",h,p),p}u(Xe,"ot");function rt(h){return b.number(h.pointerId)?h.pointerId:h.identifier}u(rt,"at");function kt(h,p,y){var E=p.length>1?Xt(p):p[0];Xe(E,h.page),function(D,H){H=H||{},q.isOperaMobile&&xe(D)?Ne("screen",D,H):Ne("client",D,H)}(E,h.client),h.timeStamp=y}u(kt,"st");function Ut(h){var p=[];return b.array(h)?(p[0]=h[0],p[1]=h[1]):h.type==="touchend"?h.touches.length===1?(p[0]=h.touches[0],p[1]=h.changedTouches[0]):h.touches.length===0&&(p[0]=h.changedTouches[0],p[1]=h.changedTouches[1]):(p[0]=h.touches[0],p[1]=h.touches[1]),p}u(Ut,"ct");function Xt(h){for(var p={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},y=0;y<h.length;y++){var E=h[y];for(var D in p)p[D]+=E[D]}for(var H in p)p[H]/=h.length;return p}u(Xt,"lt");function Wt(h){if(!h.length)return null;var p=Ut(h),y=Math.min(p[0].pageX,p[1].pageX),E=Math.min(p[0].pageY,p[1].pageY),D=Math.max(p[0].pageX,p[1].pageX),H=Math.max(p[0].pageY,p[1].pageY);return{x:y,y:E,left:y,top:E,right:D,bottom:H,width:D-y,height:H-E}}u(Wt,"ut");function Un(h,p){var y=p+"X",E=p+"Y",D=Ut(h),H=D[0][y]-D[1][y],Z=D[0][E]-D[1][E];return qe(H,Z)}u(Un,"pt");function zn(h,p){var y=p+"X",E=p+"Y",D=Ut(h),H=D[1][y]-D[0][y],Z=D[1][E]-D[0][E];return 180*Math.atan2(Z,H)/Math.PI}u(zn,"ft");function ls(h){return b.string(h.pointerType)?h.pointerType:b.number(h.pointerType)?[void 0,void 0,"touch","pen","mouse"][h.pointerType]:/touch/.test(h.type||"")||h instanceof B.Touch?"touch":"mouse"}u(ls,"dt");function Jt(h){var p=b.func(h.composedPath)?h.composedPath():h.path;return[U(p?p[0]:h.target),U(h.currentTarget)]}u(Jt,"ht");var hn=function(){function h(p){o(this,h),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=p}return u(h,"t"),i(h,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),h}();Object.defineProperty(hn.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var Zt=u(function(h,p){for(var y=0;y<p.length;y++){var E=p[y];h.push(E)}return h},"gt"),In=u(function(h){return Zt([],h)},"mt"),mn=u(function(h,p){for(var y=0;y<h.length;y++)if(p(h[y],y,h))return y;return-1},"yt"),gn=u(function(h,p){return h[mn(h,p)]},"bt"),pt=function(h){c(y,h);var p=x(y);function y(E,D,H){var Z;o(this,y),(Z=p.call(this,D._interaction)).dropzone=void 0,Z.dragEvent=void 0,Z.relatedTarget=void 0,Z.draggable=void 0,Z.propagationStopped=!1,Z.immediatePropagationStopped=!1;var te=H==="dragleave"?E.prev:E.cur,oe=te.element,de=te.dropzone;return Z.type=H,Z.target=oe,Z.currentTarget=oe,Z.dropzone=de,Z.dragEvent=D,Z.relatedTarget=D.target,Z.draggable=D.interactable,Z.timeStamp=D.timeStamp,Z}return u(y,"n"),i(y,[{key:"reject",value:function(){var E=this,D=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&D.cur.dropzone===this.dropzone&&D.cur.element===this.target)if(D.prev.dropzone=this.dropzone,D.prev.element=this.target,D.rejected=!0,D.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var H=D.activeDrops,Z=mn(H,function(oe){var de=oe.dropzone,re=oe.element;return de===E.dropzone&&re===E.target});D.activeDrops.splice(Z,1);var te=new y(D,this.dragEvent,"dropdeactivate");te.dropzone=this.dropzone,te.target=this.target,this.dropzone.fire(te)}else this.dropzone.fire(new y(D,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),y}(hn);function Qt(h,p){for(var y=0,E=h.slice();y<E.length;y++){var D=E[y],H=D.dropzone,Z=D.element;p.dropzone=H,p.target=Z,H.fire(p),p.propagationStopped=p.immediatePropagationStopped=!1}}u(Qt,"wt");function St(h,p){for(var y=function(H,Z){for(var te=[],oe=0,de=H.interactables.list;oe<de.length;oe++){var re=de[oe];if(re.options.drop.enabled){var ge=re.options.drop.accept;if(!(b.element(ge)&&ge!==Z||b.string(ge)&&!J(Z,ge)||b.func(ge)&&!ge({dropzone:re,draggableElement:Z})))for(var Se=0,Te=re.getAllElements();Se<Te.length;Se++){var Ie=Te[Se];Ie!==Z&&te.push({dropzone:re,element:Ie,rect:re.getRect(Ie)})}}}return te}(h,p),E=0;E<y.length;E++){var D=y[E];D.rect=D.dropzone.getRect(D.element)}return y}u(St,"Et");function en(h,p,y){for(var E=h.dropState,D=h.interactable,H=h.element,Z=[],te=0,oe=E.activeDrops;te<oe.length;te++){var de=oe[te],re=de.dropzone,ge=de.element,Se=de.rect,Te=re.dropCheck(p,y,D,H,ge,Se);Z.push(Te?ge:null)}var Ie=function(Oe){for(var ze,Be,We,nt=[],lt=0;lt<Oe.length;lt++){var Ze=Oe[lt],st=Oe[ze];if(Ze&&lt!==ze)if(st){var Ht=A(Ze),yt=A(st);if(Ht!==Ze.ownerDocument)if(yt!==Ze.ownerDocument)if(Ht!==yt){nt=nt.length?nt:j(st);var tn=void 0;if(st instanceof B.HTMLElement&&Ze instanceof B.SVGElement&&!(Ze instanceof B.SVGSVGElement)){if(Ze===yt)continue;tn=Ze.ownerSVGElement}else tn=Ze;for(var vn=j(tn,st.ownerDocument),Tn=0;vn[Tn]&&vn[Tn]===nt[Tn];)Tn++;var ri=[vn[Tn-1],vn[Tn],nt[Tn]];if(ri[0])for(var oa=ri[0].lastChild;oa;){if(oa===ri[1]){ze=lt,nt=vn;break}if(oa===ri[2])break;oa=oa.previousSibling}}else We=st,(parseInt(O(Be=Ze).getComputedStyle(Be).zIndex,10)||0)>=(parseInt(O(We).getComputedStyle(We).zIndex,10)||0)&&(ze=lt);else ze=lt}else ze=lt}return ze}(Z);return E.activeDrops[Ie]||null}u(en,"Tt");function cn(h,p,y){var E=h.dropState,D={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return y.type==="dragstart"&&(D.activate=new pt(E,y,"dropactivate"),D.activate.target=null,D.activate.dropzone=null),y.type==="dragend"&&(D.deactivate=new pt(E,y,"dropdeactivate"),D.deactivate.target=null,D.deactivate.dropzone=null),E.rejected||(E.cur.element!==E.prev.element&&(E.prev.dropzone&&(D.leave=new pt(E,y,"dragleave"),y.dragLeave=D.leave.target=E.prev.element,y.prevDropzone=D.leave.dropzone=E.prev.dropzone),E.cur.dropzone&&(D.enter=new pt(E,y,"dragenter"),y.dragEnter=E.cur.element,y.dropzone=E.cur.dropzone)),y.type==="dragend"&&E.cur.dropzone&&(D.drop=new pt(E,y,"drop"),y.dropzone=E.cur.dropzone,y.relatedTarget=E.cur.element),y.type==="dragmove"&&E.cur.dropzone&&(D.move=new pt(E,y,"dropmove"),y.dropzone=E.cur.dropzone)),D}u(cn,"St");function Ee(h,p){var y=h.dropState,E=y.activeDrops,D=y.cur,H=y.prev;p.leave&&H.dropzone.fire(p.leave),p.enter&&D.dropzone.fire(p.enter),p.move&&D.dropzone.fire(p.move),p.drop&&D.dropzone.fire(p.drop),p.deactivate&&Qt(E,p.deactivate),y.prev.dropzone=D.dropzone,y.prev.element=D.element}u(Ee,"_t");function Ke(h,p){var y=h.interaction,E=h.iEvent,D=h.event;if(E.type==="dragmove"||E.type==="dragend"){var H=y.dropState;p.dynamicDrop&&(H.activeDrops=St(p,y.element));var Z=E,te=en(y,Z,D);H.rejected=H.rejected&&!!te&&te.dropzone===H.cur.dropzone&&te.element===H.cur.element,H.cur.dropzone=te&&te.dropzone,H.cur.element=te&&te.element,H.events=cn(y,0,Z)}}u(Ke,"Pt");var Qe={id:"actions/drop",install:function(h){var p=h.actions,y=h.interactStatic,E=h.Interactable,D=h.defaults;h.usePlugin(z),E.prototype.dropzone=function(H){return function(Z,te){if(b.object(te)){if(Z.options.drop.enabled=te.enabled!==!1,te.listeners){var oe=je(te.listeners),de=Object.keys(oe).reduce(function(ge,Se){return ge[/^(enter|leave)/.test(Se)?"drag".concat(Se):/^(activate|deactivate|move)/.test(Se)?"drop".concat(Se):Se]=oe[Se],ge},{}),re=Z.options.drop.listeners;re&&Z.off(re),Z.on(de),Z.options.drop.listeners=de}return b.func(te.ondrop)&&Z.on("drop",te.ondrop),b.func(te.ondropactivate)&&Z.on("dropactivate",te.ondropactivate),b.func(te.ondropdeactivate)&&Z.on("dropdeactivate",te.ondropdeactivate),b.func(te.ondragenter)&&Z.on("dragenter",te.ondragenter),b.func(te.ondragleave)&&Z.on("dragleave",te.ondragleave),b.func(te.ondropmove)&&Z.on("dropmove",te.ondropmove),/^(pointer|center)$/.test(te.overlap)?Z.options.drop.overlap=te.overlap:b.number(te.overlap)&&(Z.options.drop.overlap=Math.max(Math.min(1,te.overlap),0)),"accept"in te&&(Z.options.drop.accept=te.accept),"checker"in te&&(Z.options.drop.checker=te.checker),Z}return b.bool(te)?(Z.options.drop.enabled=te,Z):Z.options.drop}(this,H)},E.prototype.dropCheck=function(H,Z,te,oe,de,re){return function(ge,Se,Te,Ie,Oe,ze,Be){var We=!1;if(!(Be=Be||ge.getRect(ze)))return!!ge.options.drop.checker&&ge.options.drop.checker(Se,Te,We,ge,ze,Ie,Oe);var nt=ge.options.drop.overlap;if(nt==="pointer"){var lt=_e(Ie,Oe,"drag"),Ze=Xe(Se);Ze.x+=lt.x,Ze.y+=lt.y;var st=Ze.x>Be.left&&Ze.x<Be.right,Ht=Ze.y>Be.top&&Ze.y<Be.bottom;We=st&&Ht}var yt=Ie.getRect(Oe);if(yt&&nt==="center"){var tn=yt.left+yt.width/2,vn=yt.top+yt.height/2;We=tn>=Be.left&&tn<=Be.right&&vn>=Be.top&&vn<=Be.bottom}return yt&&b.number(nt)&&(We=Math.max(0,Math.min(Be.right,yt.right)-Math.max(Be.left,yt.left))*Math.max(0,Math.min(Be.bottom,yt.bottom)-Math.max(Be.top,yt.top))/(yt.width*yt.height)>=nt),ge.options.drop.checker&&(We=ge.options.drop.checker(Se,Te,We,ge,ze,Ie,Oe)),We}(this,H,Z,te,oe,de,re)},y.dynamicDrop=function(H){return b.bool(H)?(h.dynamicDrop=H,y):h.dynamicDrop},ne(p.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),p.methodDict.drop="dropzone",h.dynamicDrop=!1,D.actions.drop=Qe.defaults},listeners:{"interactions:before-action-start":function(h){var p=h.interaction;p.prepared.name==="drag"&&(p.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(h,p){var y=h.interaction,E=(h.event,h.iEvent);if(y.prepared.name==="drag"){var D=y.dropState;D.activeDrops=[],D.events={},D.activeDrops=St(p,y.element),D.events=cn(y,0,E),D.events.activate&&(Qt(D.activeDrops,D.events.activate),p.fire("actions/drop:start",{interaction:y,dragEvent:E}))}},"interactions:action-move":Ke,"interactions:after-action-move":function(h,p){var y=h.interaction,E=h.iEvent;if(y.prepared.name==="drag"){var D=y.dropState;Ee(y,D.events),p.fire("actions/drop:move",{interaction:y,dragEvent:E}),D.events={}}},"interactions:action-end":function(h,p){if(h.interaction.prepared.name==="drag"){var y=h.interaction,E=h.iEvent;Ke(h,p),Ee(y,y.dropState.events),p.fire("actions/drop:end",{interaction:y,dragEvent:E})}},"interactions:stop":function(h){var p=h.interaction;if(p.prepared.name==="drag"){var y=p.dropState;y&&(y.activeDrops=null,y.events=null,y.cur.dropzone=null,y.cur.element=null,y.prev.dropzone=null,y.prev.element=null,y.rejected=!1)}}},getActiveDrops:St,getDrop:en,getDropEvents:cn,fireDropEvents:Ee,filterEventType:function(h){return h.search("drag")===0||h.search("drop")===0},defaults:{enabled:!1,accept:null,overlap:"pointer"}},Ye=Qe;function tt(h){var p=h.interaction,y=h.iEvent,E=h.phase;if(p.prepared.name==="gesture"){var D=p.pointers.map(function(de){return de.pointer}),H=E==="start",Z=E==="end",te=p.interactable.options.deltaSource;if(y.touches=[D[0],D[1]],H)y.distance=Un(D,te),y.box=Wt(D),y.scale=1,y.ds=0,y.angle=zn(D,te),y.da=0,p.gesture.startDistance=y.distance,p.gesture.startAngle=y.angle;else if(Z||p.pointers.length<2){var oe=p.prevEvent;y.distance=oe.distance,y.box=oe.box,y.scale=oe.scale,y.ds=0,y.angle=oe.angle,y.da=0}else y.distance=Un(D,te),y.box=Wt(D),y.scale=y.distance/p.gesture.startDistance,y.angle=zn(D,te),y.ds=y.scale-p.gesture.scale,y.da=y.angle-p.gesture.angle;p.gesture.distance=y.distance,p.gesture.angle=y.angle,b.number(y.scale)&&y.scale!==1/0&&!isNaN(y.scale)&&(p.gesture.scale=y.scale)}}u(tt,"Dt");var ut={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(h){var p=h.actions,y=h.Interactable,E=h.defaults;y.prototype.gesturable=function(D){return b.object(D)?(this.options.gesture.enabled=D.enabled!==!1,this.setPerAction("gesture",D),this.setOnEvents("gesture",D),this):b.bool(D)?(this.options.gesture.enabled=D,this):this.options.gesture},p.map.gesture=ut,p.methodDict.gesture="gesturable",E.actions.gesture=ut.defaults},listeners:{"interactions:action-start":tt,"interactions:action-move":tt,"interactions:action-end":tt,"interactions:new":function(h){h.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(h){if(!(h.interaction.pointers.length<2)){var p=h.interactable.options.gesture;if(p&&p.enabled)return h.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(h){return h.search("gesture")===0}},R=ut;function ae(h,p,y,E,D,H,Z){if(!p)return!1;if(p===!0){var te=b.number(H.width)?H.width:H.right-H.left,oe=b.number(H.height)?H.height:H.bottom-H.top;if(Z=Math.min(Z,Math.abs((h==="left"||h==="right"?te:oe)/2)),te<0&&(h==="left"?h="right":h==="right"&&(h="left")),oe<0&&(h==="top"?h="bottom":h==="bottom"&&(h="top")),h==="left"){var de=te>=0?H.left:H.right;return y.x<de+Z}if(h==="top"){var re=oe>=0?H.top:H.bottom;return y.y<re+Z}if(h==="right")return y.x>(te>=0?H.right:H.left)-Z;if(h==="bottom")return y.y>(oe>=0?H.bottom:H.top)-Z}return!!b.element(E)&&(b.element(p)?p===E:S(E,p,D))}u(ae,"zt");function ee(h){var p=h.iEvent,y=h.interaction;if(y.prepared.name==="resize"&&y.resizeAxes){var E=p;y.interactable.options.resize.square?(y.resizeAxes==="y"?E.delta.x=E.delta.y:E.delta.y=E.delta.x,E.axes="xy"):(E.axes=y.resizeAxes,y.resizeAxes==="x"?E.delta.y=0:y.resizeAxes==="y"&&(E.delta.x=0))}}u(ee,"At");var ie,ce,ve={id:"actions/resize",before:["actions/drag"],install:function(h){var p=h.actions,y=h.browser,E=h.Interactable,D=h.defaults;ve.cursors=function(H){return H.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(y),ve.defaultMargin=y.supportsTouch||y.supportsPointerEvent?20:10,E.prototype.resizable=function(H){return function(Z,te,oe){return b.object(te)?(Z.options.resize.enabled=te.enabled!==!1,Z.setPerAction("resize",te),Z.setOnEvents("resize",te),b.string(te.axis)&&/^x$|^y$|^xy$/.test(te.axis)?Z.options.resize.axis=te.axis:te.axis===null&&(Z.options.resize.axis=oe.defaults.actions.resize.axis),b.bool(te.preserveAspectRatio)?Z.options.resize.preserveAspectRatio=te.preserveAspectRatio:b.bool(te.square)&&(Z.options.resize.square=te.square),Z):b.bool(te)?(Z.options.resize.enabled=te,Z):Z.options.resize}(this,H,h)},p.map.resize=ve,p.methodDict.resize="resizable",D.actions.resize=ve.defaults},listeners:{"interactions:new":function(h){h.interaction.resizeAxes="xy"},"interactions:action-start":function(h){(function(p){var y=p.iEvent,E=p.interaction;if(E.prepared.name==="resize"&&E.prepared.edges){var D=y,H=E.rect;E._rects={start:ne({},H),corrected:ne({},H),previous:ne({},H),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},D.edges=E.prepared.edges,D.rect=E._rects.corrected,D.deltaRect=E._rects.delta}})(h),ee(h)},"interactions:action-move":function(h){(function(p){var y=p.iEvent,E=p.interaction;if(E.prepared.name==="resize"&&E.prepared.edges){var D=y,H=E.interactable.options.resize.invert,Z=H==="reposition"||H==="negate",te=E.rect,oe=E._rects,de=oe.start,re=oe.corrected,ge=oe.delta,Se=oe.previous;if(ne(Se,re),Z){if(ne(re,te),H==="reposition"){if(re.top>re.bottom){var Te=re.top;re.top=re.bottom,re.bottom=Te}if(re.left>re.right){var Ie=re.left;re.left=re.right,re.right=Ie}}}else re.top=Math.min(te.top,de.bottom),re.bottom=Math.max(te.bottom,de.top),re.left=Math.min(te.left,de.right),re.right=Math.max(te.right,de.left);for(var Oe in re.width=re.right-re.left,re.height=re.bottom-re.top,re)ge[Oe]=re[Oe]-Se[Oe];D.edges=E.prepared.edges,D.rect=re,D.deltaRect=ge}})(h),ee(h)},"interactions:action-end":function(h){var p=h.iEvent,y=h.interaction;if(y.prepared.name==="resize"&&y.prepared.edges){var E=p;E.edges=y.prepared.edges,E.rect=y._rects.corrected,E.deltaRect=y._rects.delta}},"auto-start:check":function(h){var p=h.interaction,y=h.interactable,E=h.element,D=h.rect,H=h.buttons;if(D){var Z=ne({},p.coords.cur.page),te=y.options.resize;if(te&&te.enabled&&(!p.pointerIsDown||!/mouse|pointer/.test(p.pointerType)||H&te.mouseButtons)){if(b.object(te.edges)){var oe={left:!1,right:!1,top:!1,bottom:!1};for(var de in oe)oe[de]=ae(de,te.edges[de],Z,p._latestPointer.eventTarget,E,D,te.margin||ve.defaultMargin);oe.left=oe.left&&!oe.right,oe.top=oe.top&&!oe.bottom,(oe.left||oe.right||oe.top||oe.bottom)&&(h.action={name:"resize",edges:oe})}else{var re=te.axis!=="y"&&Z.x>D.right-ve.defaultMargin,ge=te.axis!=="x"&&Z.y>D.bottom-ve.defaultMargin;(re||ge)&&(h.action={name:"resize",axes:(re?"x":"")+(ge?"y":"")})}return!h.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(h){var p=h.edges,y=h.axis,E=h.name,D=ve.cursors,H=null;if(y)H=D[E+y];else if(p){for(var Z="",te=0,oe=["top","bottom","left","right"];te<oe.length;te++){var de=oe[te];p[de]&&(Z+=de)}H=D[Z]}return H},filterEventType:function(h){return h.search("resize")===0},defaultMargin:null},ke=ve,Fe={id:"actions",install:function(h){h.usePlugin(R),h.usePlugin(ke),h.usePlugin(z),h.usePlugin(Ye)}},Le=0,De={request:function(h){return ie(h)},cancel:function(h){return ce(h)},init:function(h){if(ie=h.requestAnimationFrame,ce=h.cancelAnimationFrame,!ie)for(var p=["ms","moz","webkit","o"],y=0;y<p.length;y++){var E=p[y];ie=h["".concat(E,"RequestAnimationFrame")],ce=h["".concat(E,"CancelAnimationFrame")]||h["".concat(E,"CancelRequestAnimationFrame")]}ie=ie&&ie.bind(h),ce=ce&&ce.bind(h),ie||(ie=u(function(D){var H=Date.now(),Z=Math.max(0,16-(H-Le)),te=h.setTimeout(function(){D(H+Z)},Z);return Le=H+Z,te},"Rt"),ce=u(function(D){return clearTimeout(D)},"Ct"))}},Ce={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(h){Ce.isScrolling=!0,De.cancel(Ce.i),h.autoScroll=Ce,Ce.interaction=h,Ce.prevTime=Ce.now(),Ce.i=De.request(Ce.scroll)},stop:function(){Ce.isScrolling=!1,Ce.interaction&&(Ce.interaction.autoScroll=null),De.cancel(Ce.i)},scroll:function(){var h=Ce.interaction,p=h.interactable,y=h.element,E=h.prepared.name,D=p.options[E].autoScroll,H=et(D.container,p,y),Z=Ce.now(),te=(Z-Ce.prevTime)/1e3,oe=D.speed*te;if(oe>=1){var de={x:Ce.x*oe,y:Ce.y*oe};if(de.x||de.y){var re=Ve(H);b.window(H)?H.scrollBy(de.x,de.y):H&&(H.scrollLeft+=de.x,H.scrollTop+=de.y);var ge=Ve(H),Se={x:ge.x-re.x,y:ge.y-re.y};(Se.x||Se.y)&&p.fire({type:"autoscroll",target:y,interactable:p,delta:Se,interaction:h,container:H})}Ce.prevTime=Z}Ce.isScrolling&&(De.cancel(Ce.i),Ce.i=De.request(Ce.scroll))},check:function(h,p){var y;return(y=h.options[p].autoScroll)==null?void 0:y.enabled},onInteractionMove:function(h){var p=h.interaction,y=h.pointer;if(p.interacting()&&Ce.check(p.interactable,p.prepared.name))if(p.simulation)Ce.x=Ce.y=0;else{var E,D,H,Z,te=p.interactable,oe=p.element,de=p.prepared.name,re=te.options[de].autoScroll,ge=et(re.container,te,oe);if(b.window(ge))Z=y.clientX<Ce.margin,E=y.clientY<Ce.margin,D=y.clientX>ge.innerWidth-Ce.margin,H=y.clientY>ge.innerHeight-Ce.margin;else{var Se=G(ge);Z=y.clientX<Se.left+Ce.margin,E=y.clientY<Se.top+Ce.margin,D=y.clientX>Se.right-Ce.margin,H=y.clientY>Se.bottom-Ce.margin}Ce.x=D?1:Z?-1:0,Ce.y=H?1:E?-1:0,Ce.isScrolling||(Ce.margin=re.margin,Ce.speed=re.speed,Ce.start(p))}}};function et(h,p,y){return(b.string(h)?he(h,p,y):h)||O(y)}u(et,"Bt");function Ve(h){return b.window(h)&&(h=window.document.body),{x:h.scrollLeft,y:h.scrollTop}}u(Ve,"Vt");var it={id:"auto-scroll",install:function(h){var p=h.defaults,y=h.actions;h.autoScroll=Ce,Ce.now=function(){return h.now()},y.phaselessTypes.autoscroll=!0,p.perAction.autoScroll=Ce.defaults},listeners:{"interactions:new":function(h){h.interaction.autoScroll=null},"interactions:destroy":function(h){h.interaction.autoScroll=null,Ce.stop(),Ce.interaction&&(Ce.interaction=null)},"interactions:stop":Ce.stop,"interactions:action-move":function(h){return Ce.onInteractionMove(h)}}},ht=it;function vt(h,p){var y=!1;return function(){return y||(k.console.warn(p),y=!0),h.apply(this,arguments)}}u(vt,"Nt");function Gn(h,p){return h.name=p.name,h.axis=p.axis,h.edges=p.edges,h}u(Gn,"Ut");function Ps(h){return b.bool(h)?(this.options.styleCursor=h,this):h===null?(delete this.options.styleCursor,this):this.options.styleCursor}u(Ps,"Ht");function fn(h){return b.func(h)?(this.options.actionChecker=h,this):h===null?(delete this.options.actionChecker,this):this.options.actionChecker}u(fn,"Kt");var Za={id:"auto-start/interactableMethods",install:function(h){var p=h.Interactable;p.prototype.getAction=function(y,E,D,H){var Z=function(te,oe,de,re,ge){var Se=te.getRect(re),Te=oe.buttons||{0:1,1:4,3:8,4:16}[oe.button],Ie={action:null,interactable:te,interaction:de,element:re,rect:Se,buttons:Te};return ge.fire("auto-start:check",Ie),Ie.action}(this,E,D,H,h);return this.options.actionChecker?this.options.actionChecker(y,E,Z,this,H,D):Z},p.prototype.ignoreFrom=vt(function(y){return this._backCompatOption("ignoreFrom",y)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),p.prototype.allowFrom=vt(function(y){return this._backCompatOption("allowFrom",y)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),p.prototype.actionChecker=fn,p.prototype.styleCursor=Ps}};function ea(h,p,y,E,D){return p.testIgnoreAllow(p.options[h.name],y,E)&&p.options[h.name].enabled&&Is(p,y,h,D)?h:null}u(ea,"Jt");function jt(h,p,y,E,D,H,Z){for(var te=0,oe=E.length;te<oe;te++){var de=E[te],re=D[te],ge=de.getAction(p,y,h,re);if(ge){var Se=ea(ge,de,re,H,Z);if(Se)return{action:Se,interactable:de,element:re}}}return{action:null,interactable:null,element:null}}u(jt,"Qt");function cs(h,p,y,E,D){var H=[],Z=[],te=E;function oe(re){H.push(re),Z.push(te)}for(u(oe,"c");b.element(te);){H=[],Z=[],D.interactables.forEachMatch(te,oe);var de=jt(h,p,y,H,Z,E,D);if(de.action&&!de.interactable.options[de.action.name].manualStart)return de;te=V(te)}return{action:null,interactable:null,element:null}}u(cs,"Zt");function ta(h,p,y){var E=p.action,D=p.interactable,H=p.element;E=E||{name:null},h.interactable=D,h.element=H,Gn(h.prepared,E),h.rect=D&&E.name?D.getRect(H):null,us(h,y),y.fire("autoStart:prepared",{interaction:h})}u(ta,"te");function Is(h,p,y,E){var D=h.options,H=D[y.name].max,Z=D[y.name].maxPerElement,te=E.autoStart.maxInteractions,oe=0,de=0,re=0;if(!(H&&Z&&te))return!1;for(var ge=0,Se=E.interactions.list;ge<Se.length;ge++){var Te=Se[ge],Ie=Te.prepared.name;if(Te.interacting()&&(++oe>=te||Te.interactable===h&&((de+=Ie===y.name?1:0)>=H||Te.element===p&&(re++,Ie===y.name&&re>=Z))))return!1}return te>0}u(Is,"ee");function zt(h,p){return b.number(h)?(p.autoStart.maxInteractions=h,this):p.autoStart.maxInteractions}u(zt,"ne");function _t(h,p,y){var E=y.autoStart.cursorElement;E&&E!==h&&(E.style.cursor=""),h.ownerDocument.documentElement.style.cursor=p,h.style.cursor=p,y.autoStart.cursorElement=p?h:null}u(_t,"re");function us(h,p){var y=h.interactable,E=h.element,D=h.prepared;if(h.pointerType==="mouse"&&y&&y.options.styleCursor){var H="";if(D.name){var Z=y.options[D.name].cursorChecker;H=b.func(Z)?Z(D,y,E,h._interacting):p.actions.map[D.name].getCursor(D)}_t(h.element,H||"",p)}else p.autoStart.cursorElement&&_t(p.autoStart.cursorElement,"",p)}u(us,"ie");var Cn={id:"auto-start/base",before:["actions"],install:function(h){var p=h.interactStatic,y=h.defaults;h.usePlugin(Za),y.base.actionChecker=null,y.base.styleCursor=!0,ne(y.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),p.maxInteractions=function(E){return zt(E,h)},h.autoStart={maxInteractions:1/0,withinInteractionLimit:Is,cursorElement:null}},listeners:{"interactions:down":function(h,p){var y=h.interaction,E=h.pointer,D=h.event,H=h.eventTarget;y.interacting()||ta(y,cs(y,E,D,H,p),p)},"interactions:move":function(h,p){(function(y,E){var D=y.interaction,H=y.pointer,Z=y.event,te=y.eventTarget;D.pointerType!=="mouse"||D.pointerIsDown||D.interacting()||ta(D,cs(D,H,Z,te,E),E)})(h,p),function(y,E){var D=y.interaction;if(D.pointerIsDown&&!D.interacting()&&D.pointerWasMoved&&D.prepared.name){E.fire("autoStart:before-start",y);var H=D.interactable,Z=D.prepared.name;Z&&H&&(H.options[Z].manualStart||!Is(H,D.element,D.prepared,E)?D.stop():(D.start(D.prepared,H,D.element),us(D,E)))}}(h,p)},"interactions:stop":function(h,p){var y=h.interaction,E=y.interactable;E&&E.options.styleCursor&&_t(y.element,"",p)}},maxInteractions:zt,withinInteractionLimit:Is,validateAction:ea},Ln=Cn,un={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(h,p){var y=h.interaction,E=h.eventTarget,D=h.dx,H=h.dy;if(y.prepared.name==="drag"){var Z=Math.abs(D),te=Math.abs(H),oe=y.interactable.options.drag,de=oe.startAxis,re=Z>te?"x":Z<te?"y":"xy";if(y.prepared.axis=oe.lockAxis==="start"?re[0]:oe.lockAxis,re!=="xy"&&de!=="xy"&&de!==re){y.prepared.name=null;for(var ge=E,Se=function(Ie){if(Ie!==y.interactable){var Oe=y.interactable.options.drag;if(!Oe.manualStart&&Ie.testIgnoreAllow(Oe,ge,E)){var ze=Ie.getAction(y.downPointer,y.downEvent,y,ge);if(ze&&ze.name==="drag"&&function(Be,We){if(!We)return!1;var nt=We.options.drag.startAxis;return Be==="xy"||nt==="xy"||nt===Be}(re,Ie)&&Ln.validateAction(ze,Ie,ge,E,p))return Ie}}};b.element(ge);){var Te=p.interactables.forEachMatch(ge,Se);if(Te){y.prepared.name="drag",y.interactable=Te,y.element=ge;break}ge=V(ge)}}}}}};function dn(h){var p=h.prepared&&h.prepared.name;if(!p)return null;var y=h.interactable.options;return y[p].hold||y[p].delay}u(dn,"ce");var Ls={id:"auto-start/hold",install:function(h){var p=h.defaults;h.usePlugin(Ln),p.perAction.hold=0,p.perAction.delay=0},listeners:{"interactions:new":function(h){h.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(h){var p=h.interaction,y=dn(p);y>0&&(p.autoStartHoldTimer=setTimeout(function(){p.start(p.prepared,p.interactable,p.element)},y))},"interactions:move":function(h){var p=h.interaction,y=h.duplicate;p.autoStartHoldTimer&&p.pointerWasMoved&&!y&&(clearTimeout(p.autoStartHoldTimer),p.autoStartHoldTimer=null)},"autoStart:before-start":function(h){var p=h.interaction;dn(p)>0&&(p.prepared.name=null)}},getHoldDuration:dn},ds=Ls,Qa={id:"auto-start",install:function(h){h.usePlugin(Ln),h.usePlugin(ds),h.usePlugin(un)}},Nm=u(function(h){return/^(always|never|auto)$/.test(h)?(this.options.preventDefault=h,this):b.bool(h)?(this.options.preventDefault=h?"always":"never",this):this.options.preventDefault},"fe");function $m(h){var p=h.interaction,y=h.event;p.interactable&&p.interactable.checkAndPreventDefault(y)}u($m,"de");var Ll={id:"core/interactablePreventDefault",install:function(h){var p=h.Interactable;p.prototype.preventDefault=Nm,p.prototype.checkAndPreventDefault=function(y){return function(E,D,H){var Z=E.options.preventDefault;if(Z!=="never")if(Z!=="always"){if(D.events.supportsPassive&&/^touch(start|move)$/.test(H.type)){var te=O(H.target).document,oe=D.getDocOptions(te);if(!oe||!oe.events||oe.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(H.type)||b.element(H.target)&&J(H.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||H.preventDefault()}else H.preventDefault()}(this,h,y)},h.interactions.docEvents.push({type:"dragstart",listener:function(y){for(var E=0,D=h.interactions.list;E<D.length;E++){var H=D[E];if(H.element&&(H.element===y.target||X(H.element,y.target)))return void H.interactable.checkAndPreventDefault(y)}}})},listeners:["down","move","up","cancel"].reduce(function(h,p){return h["interactions:".concat(p)]=$m,h},{})};function ei(h,p){if(p.phaselessTypes[h])return!0;for(var y in p.map)if(h.indexOf(y)===0&&h.substr(y.length)in p.phases)return!0;return!1}u(ei,"ve");function Ts(h){var p={};for(var y in h){var E=h[y];b.plainObject(E)?p[y]=Ts(E):b.array(E)?p[y]=In(E):p[y]=E}return p}u(Ts,"ge");var yo=function(){function h(p){o(this,h),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=p,this.result=ti(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return u(h,"t"),i(h,[{key:"start",value:function(p,y){var E,D,H=p.phase,Z=this.interaction,te=function(de){var re=de.interactable.options[de.prepared.name],ge=re.modifiers;return ge&&ge.length?ge:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(Se){var Te=re[Se];return Te&&Te.enabled&&{options:Te,methods:Te._methods}}).filter(function(Se){return!!Se})}(Z);this.prepareStates(te),this.startEdges=ne({},Z.edges),this.edges=ne({},this.startEdges),this.startOffset=(E=Z.rect,D=y,E?{left:D.x-E.left,top:D.y-E.top,right:E.right-D.x,bottom:E.bottom-D.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var oe=this.fillArg({phase:H,pageCoords:y,preEnd:!1});return this.result=ti(),this.startAll(oe),this.result=this.setAll(oe)}},{key:"fillArg",value:function(p){var y=this.interaction;return p.interaction=y,p.interactable=y.interactable,p.element=y.element,p.rect||(p.rect=y.rect),p.edges||(p.edges=this.startEdges),p.startOffset=this.startOffset,p}},{key:"startAll",value:function(p){for(var y=0,E=this.states;y<E.length;y++){var D=E[y];D.methods.start&&(p.state=D,D.methods.start(p))}}},{key:"setAll",value:function(p){var y=p.phase,E=p.preEnd,D=p.skipModifiers,H=p.rect,Z=p.edges;p.coords=ne({},p.pageCoords),p.rect=ne({},H),p.edges=ne({},Z);for(var te=D?this.states.slice(D):this.states,oe=ti(p.coords,p.rect),de=0;de<te.length;de++){var re,ge=te[de],Se=ge.options,Te=ne({},p.coords),Ie=null;(re=ge.methods)!=null&&re.set&&this.shouldDo(Se,E,y)&&(p.state=ge,Ie=ge.methods.set(p),we(p.edges,p.rect,{x:p.coords.x-Te.x,y:p.coords.y-Te.y})),oe.eventProps.push(Ie)}ne(this.edges,p.edges),oe.delta.x=p.coords.x-p.pageCoords.x,oe.delta.y=p.coords.y-p.pageCoords.y,oe.rectDelta.left=p.rect.left-H.left,oe.rectDelta.right=p.rect.right-H.right,oe.rectDelta.top=p.rect.top-H.top,oe.rectDelta.bottom=p.rect.bottom-H.bottom;var Oe=this.result.coords,ze=this.result.rect;if(Oe&&ze){var Be=oe.rect.left!==ze.left||oe.rect.right!==ze.right||oe.rect.top!==ze.top||oe.rect.bottom!==ze.bottom;oe.changed=Be||Oe.x!==oe.coords.x||Oe.y!==oe.coords.y}return oe}},{key:"applyToInteraction",value:function(p){var y=this.interaction,E=p.phase,D=y.coords.cur,H=y.coords.start,Z=this.result,te=this.startDelta,oe=Z.delta;E==="start"&&ne(this.startDelta,Z.delta);for(var de=0,re=[[H,te],[D,oe]];de<re.length;de++){var ge=re[de],Se=ge[0],Te=ge[1];Se.page.x+=Te.x,Se.page.y+=Te.y,Se.client.x+=Te.x,Se.client.y+=Te.y}var Ie=this.result.rectDelta,Oe=p.rect||y.rect;Oe.left+=Ie.left,Oe.right+=Ie.right,Oe.top+=Ie.top,Oe.bottom+=Ie.bottom,Oe.width=Oe.right-Oe.left,Oe.height=Oe.bottom-Oe.top}},{key:"setAndApply",value:function(p){var y=this.interaction,E=p.phase,D=p.preEnd,H=p.skipModifiers,Z=this.setAll(this.fillArg({preEnd:D,phase:E,pageCoords:p.modifiedCoords||y.coords.cur.page}));if(this.result=Z,!Z.changed&&(!H||H<this.states.length)&&y.interacting())return!1;if(p.modifiedCoords){var te=y.coords.cur.page,oe={x:p.modifiedCoords.x-te.x,y:p.modifiedCoords.y-te.y};Z.coords.x+=oe.x,Z.coords.y+=oe.y,Z.delta.x+=oe.x,Z.delta.y+=oe.y}this.applyToInteraction(p)}},{key:"beforeEnd",value:function(p){var y=p.interaction,E=p.event,D=this.states;if(D&&D.length){for(var H=!1,Z=0;Z<D.length;Z++){var te=D[Z];p.state=te;var oe=te.options,de=te.methods,re=de.beforeEnd&&de.beforeEnd(p);if(re)return this.endResult=re,!1;H=H||!H&&this.shouldDo(oe,!0,p.phase,!0)}H&&y.move({event:E,preEnd:!0})}}},{key:"stop",value:function(p){var y=p.interaction;if(this.states&&this.states.length){var E=ne({states:this.states,interactable:y.interactable,element:y.element,rect:null},p);this.fillArg(E);for(var D=0,H=this.states;D<H.length;D++){var Z=H[D];E.state=Z,Z.methods.stop&&Z.methods.stop(E)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(p){this.states=[];for(var y=0;y<p.length;y++){var E=p[y],D=E.options,H=E.methods,Z=E.name;this.states.push({options:D,methods:H,index:y,name:Z})}return this.states}},{key:"restoreInteractionCoords",value:function(p){var y=p.interaction,E=y.coords,D=y.rect,H=y.modification;if(H.result){for(var Z=H.startDelta,te=H.result,oe=te.delta,de=te.rectDelta,re=0,ge=[[E.start,Z],[E.cur,oe]];re<ge.length;re++){var Se=ge[re],Te=Se[0],Ie=Se[1];Te.page.x-=Ie.x,Te.page.y-=Ie.y,Te.client.x-=Ie.x,Te.client.y-=Ie.y}D.left-=de.left,D.right-=de.right,D.top-=de.top,D.bottom-=de.bottom}}},{key:"shouldDo",value:function(p,y,E,D){return!(!p||p.enabled===!1||D&&!p.endOnly||p.endOnly&&!y||E==="start"&&!p.setStart)}},{key:"copyFrom",value:function(p){this.startOffset=p.startOffset,this.startDelta=p.startDelta,this.startEdges=p.startEdges,this.edges=p.edges,this.states=p.states.map(function(y){return Ts(y)}),this.result=ti(ne({},p.result.coords),ne({},p.result.rect))}},{key:"destroy",value:function(){for(var p in this)this[p]=null}}]),h}();function ti(h,p){return{rect:p,coords:h,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}u(ti,"ye");function Hn(h,p){var y=h.defaults,E={start:h.start,set:h.set,beforeEnd:h.beforeEnd,stop:h.stop},D=u(function(H){var Z=H||{};for(var te in Z.enabled=Z.enabled!==!1,y)te in Z||(Z[te]=y[te]);var oe={options:Z,methods:E,name:p,enable:function(){return Z.enabled=!0,oe},disable:function(){return Z.enabled=!1,oe}};return oe},"i");return p&&typeof p=="string"&&(D._defaults=y,D._methods=E),D}u(Hn,"be");function na(h){var p=h.iEvent,y=h.interaction.modification.result;y&&(p.modifiers=y.eventProps)}u(na,"xe");var Fm={id:"modifiers/base",before:["actions"],install:function(h){h.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(h){var p=h.interaction;p.modification=new yo(p)},"interactions:before-action-start":function(h){var p=h.interaction,y=h.interaction.modification;y.start(h,p.coords.start.page),p.edges=y.edges,y.applyToInteraction(h)},"interactions:before-action-move":function(h){var p=h.interaction,y=p.modification,E=y.setAndApply(h);return p.edges=y.edges,E},"interactions:before-action-end":function(h){var p=h.interaction,y=p.modification,E=y.beforeEnd(h);return p.edges=y.startEdges,E},"interactions:action-start":na,"interactions:action-move":na,"interactions:action-end":na,"interactions:after-action-start":function(h){return h.interaction.modification.restoreInteractionCoords(h)},"interactions:after-action-move":function(h){return h.interaction.modification.restoreInteractionCoords(h)},"interactions:stop":function(h){return h.interaction.modification.stop(h)}}},Tl=Fm,jl={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},xo=function(h){c(y,h);var p=x(y);function y(E,D,H,Z,te,oe,de){var re;o(this,y),(re=p.call(this,E)).relatedTarget=null,re.screenX=void 0,re.screenY=void 0,re.button=void 0,re.buttons=void 0,re.ctrlKey=void 0,re.shiftKey=void 0,re.altKey=void 0,re.metaKey=void 0,re.page=void 0,re.client=void 0,re.delta=void 0,re.rect=void 0,re.x0=void 0,re.y0=void 0,re.t0=void 0,re.dt=void 0,re.duration=void 0,re.clientX0=void 0,re.clientY0=void 0,re.velocity=void 0,re.speed=void 0,re.swipe=void 0,re.axes=void 0,re.preEnd=void 0,te=te||E.element;var ge=E.interactable,Se=(ge&&ge.options||jl).deltaSource,Te=_e(ge,te,H),Ie=Z==="start",Oe=Z==="end",ze=Ie?v(re):E.prevEvent,Be=Ie?E.coords.start:Oe?{page:ze.page,client:ze.client,timeStamp:E.coords.cur.timeStamp}:E.coords.cur;return re.page=ne({},Be.page),re.client=ne({},Be.client),re.rect=ne({},E.rect),re.timeStamp=Be.timeStamp,Oe||(re.page.x-=Te.x,re.page.y-=Te.y,re.client.x-=Te.x,re.client.y-=Te.y),re.ctrlKey=D.ctrlKey,re.altKey=D.altKey,re.shiftKey=D.shiftKey,re.metaKey=D.metaKey,re.button=D.button,re.buttons=D.buttons,re.target=te,re.currentTarget=te,re.preEnd=oe,re.type=de||H+(Z||""),re.interactable=ge,re.t0=Ie?E.pointers[E.pointers.length-1].downTime:ze.t0,re.x0=E.coords.start.page.x-Te.x,re.y0=E.coords.start.page.y-Te.y,re.clientX0=E.coords.start.client.x-Te.x,re.clientY0=E.coords.start.client.y-Te.y,re.delta=Ie||Oe?{x:0,y:0}:{x:re[Se].x-ze[Se].x,y:re[Se].y-ze[Se].y},re.dt=E.coords.delta.timeStamp,re.duration=re.timeStamp-re.t0,re.velocity=ne({},E.coords.velocity[Se]),re.speed=qe(re.velocity.x,re.velocity.y),re.swipe=Oe||Z==="inertiastart"?re.getSwipe():null,re}return u(y,"n"),i(y,[{key:"getSwipe",value:function(){var E=this._interaction;if(E.prevEvent.speed<600||this.timeStamp-E.prevEvent.timeStamp>150)return null;var D=180*Math.atan2(E.prevEvent.velocityY,E.prevEvent.velocityX)/Math.PI;D<0&&(D+=360);var H=112.5<=D&&D<247.5,Z=202.5<=D&&D<337.5;return{up:Z,down:!Z&&22.5<=D&&D<157.5,left:H,right:!H&&(292.5<=D||D<67.5),angle:D,speed:E.prevEvent.speed,velocity:{x:E.prevEvent.velocityX,y:E.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),y}(hn);Object.defineProperties(xo.prototype,{pageX:{get:function(){return this.page.x},set:function(h){this.page.x=h}},pageY:{get:function(){return this.page.y},set:function(h){this.page.y=h}},clientX:{get:function(){return this.client.x},set:function(h){this.client.x=h}},clientY:{get:function(){return this.client.y},set:function(h){this.client.y=h}},dx:{get:function(){return this.delta.x},set:function(h){this.delta.x=h}},dy:{get:function(){return this.delta.y},set:function(h){this.delta.y=h}},velocityX:{get:function(){return this.velocity.x},set:function(h){this.velocity.x=h}},velocityY:{get:function(){return this.velocity.y},set:function(h){this.velocity.y=h}}});var Rm=i(u(function h(p,y,E,D,H){o(this,h),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=p,this.pointer=y,this.event=E,this.downTime=D,this.downTarget=H},"t")),qm=function(h){return h.interactable="",h.element="",h.prepared="",h.pointerIsDown="",h.pointerWasMoved="",h._proxy="",h}({}),Ol=function(h){return h.start="",h.move="",h.end="",h.stop="",h.interacting="",h}({}),Bm=0,Um=function(){function h(p){var y=this,E=p.pointerType,D=p.scopeFire;o(this,h),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=vt(function(re){this.move(re)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=Bm++,this._scopeFire=D,this.pointerType=E;var H=this;this._proxy={};var Z=u(function(re){Object.defineProperty(y._proxy,re,{get:function(){return H[re]}})},"s");for(var te in qm)Z(te);var oe=u(function(re){Object.defineProperty(y._proxy,re,{value:function(){return H[re].apply(H,arguments)}})},"l");for(var de in Ol)oe(de);this._scopeFire("interactions:new",{interaction:this})}return u(h,"t"),i(h,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(p,y,E){var D=this.updatePointer(p,y,E,!0),H=this.pointers[D];this._scopeFire("interactions:down",{pointer:p,event:y,eventTarget:E,pointerIndex:D,pointerInfo:H,type:"down",interaction:this})}},{key:"start",value:function(p,y,E){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(p.name==="gesture"?2:1)||!y.options[p.name].enabled)&&(Gn(this.prepared,p),this.interactable=y,this.element=E,this.rect=y.getRect(E),this.edges=this.prepared.edges?ne({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(p,y,E){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(p,y,E,!1);var D,H,Z=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(D=this.coords.cur.client.x-this.coords.start.client.x,H=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=qe(D,H)>this.pointerMoveTolerance);var te,oe,de,re=this.getPointerIndex(p),ge={pointer:p,pointerIndex:re,pointerInfo:this.pointers[re],event:y,type:"move",eventTarget:E,dx:D,dy:H,duplicate:Z,interaction:this};Z||(te=this.coords.velocity,oe=this.coords.delta,de=Math.max(oe.timeStamp/1e3,.001),te.page.x=oe.page.x/de,te.page.y=oe.page.y/de,te.client.x=oe.client.x/de,te.client.y=oe.client.y/de,te.timeStamp=de),this._scopeFire("interactions:move",ge),Z||this.simulation||(this.interacting()&&(ge.type=null,this.move(ge)),this.pointerWasMoved&&be(this.coords.prev,this.coords.cur))}},{key:"move",value:function(p){p&&p.event||Ae(this.coords.delta),(p=ne({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},p||{})).phase="move",this._doPhase(p)}},{key:"pointerUp",value:function(p,y,E,D){var H=this.getPointerIndex(p);H===-1&&(H=this.updatePointer(p,y,E,!1));var Z=/cancel$/i.test(y.type)?"cancel":"up";this._scopeFire("interactions:".concat(Z),{pointer:p,pointerIndex:H,pointerInfo:this.pointers[H],event:y,eventTarget:E,type:Z,curEventTarget:D,interaction:this}),this.simulation||this.end(y),this.removePointer(p,y)}},{key:"documentBlur",value:function(p){this.end(p),this._scopeFire("interactions:blur",{event:p,type:"blur",interaction:this})}},{key:"end",value:function(p){var y;this._ending=!0,p=p||this._latestPointer.event,this.interacting()&&(y=this._doPhase({event:p,interaction:this,phase:"end"})),this._ending=!1,y===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(p){var y=rt(p);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:mn(this.pointers,function(E){return E.id===y})}},{key:"getPointerInfo",value:function(p){return this.pointers[this.getPointerIndex(p)]}},{key:"updatePointer",value:function(p,y,E,D){var H,Z,te,oe=rt(p),de=this.getPointerIndex(p),re=this.pointers[de];return D=D!==!1&&(D||/(down|start)$/i.test(y.type)),re?re.pointer=p:(re=new Rm(oe,p,y,null,null),de=this.pointers.length,this.pointers.push(re)),kt(this.coords.cur,this.pointers.map(function(ge){return ge.pointer}),this._now()),H=this.coords.delta,Z=this.coords.prev,te=this.coords.cur,H.page.x=te.page.x-Z.page.x,H.page.y=te.page.y-Z.page.y,H.client.x=te.client.x-Z.client.x,H.client.y=te.client.y-Z.client.y,H.timeStamp=te.timeStamp-Z.timeStamp,D&&(this.pointerIsDown=!0,re.downTime=this.coords.cur.timeStamp,re.downTarget=E,ye(this.downPointer,p),this.interacting()||(be(this.coords.start,this.coords.cur),be(this.coords.prev,this.coords.cur),this.downEvent=y,this.pointerWasMoved=!1)),this._updateLatestPointer(p,y,E),this._scopeFire("interactions:update-pointer",{pointer:p,event:y,eventTarget:E,down:D,pointerInfo:re,pointerIndex:de,interaction:this}),de}},{key:"removePointer",value:function(p,y){var E=this.getPointerIndex(p);if(E!==-1){var D=this.pointers[E];this._scopeFire("interactions:remove-pointer",{pointer:p,event:y,eventTarget:null,pointerIndex:E,pointerInfo:D,interaction:this}),this.pointers.splice(E,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(p,y,E){this._latestPointer.pointer=p,this._latestPointer.event=y,this._latestPointer.eventTarget=E}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(p,y,E,D){return new xo(this,p,this.prepared.name,y,this.element,E,D)}},{key:"_fireEvent",value:function(p){var y;(y=this.interactable)==null||y.fire(p),(!this.prevEvent||p.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=p)}},{key:"_doPhase",value:function(p){var y=p.event,E=p.phase,D=p.preEnd,H=p.type,Z=this.rect;if(Z&&E==="move"&&(we(this.edges,Z,this.coords.delta[this.interactable.options.deltaSource]),Z.width=Z.right-Z.left,Z.height=Z.bottom-Z.top),this._scopeFire("interactions:before-action-".concat(E),p)===!1)return!1;var te=p.iEvent=this._createPreparedEvent(y,E,D,H);return this._scopeFire("interactions:action-".concat(E),p),E==="start"&&(this.prevEvent=te),this._fireEvent(te),this._scopeFire("interactions:after-action-".concat(E),p),!0}},{key:"_now",value:function(){return Date.now()}}]),h}();function Dl(h){Ml(h.interaction)}u(Dl,"Ie");function Ml(h){if(!function(y){return!(!y.offset.pending.x&&!y.offset.pending.y)}(h))return!1;var p=h.offset.pending;return wo(h.coords.cur,p),wo(h.coords.delta,p),we(h.edges,h.rect,p),p.x=0,p.y=0,!0}u(Ml,"Me");function zm(h){var p=h.x,y=h.y;this.offset.pending.x+=p,this.offset.pending.y+=y,this.offset.total.x+=p,this.offset.total.y+=y}u(zm,"ze");function wo(h,p){var y=h.page,E=h.client,D=p.x,H=p.y;y.x+=D,y.y+=H,E.x+=D,E.y+=H}u(wo,"Ae"),Ol.offsetBy="";var Gm={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(h){h.Interaction.prototype.offsetBy=zm},listeners:{"interactions:new":function(h){h.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(h){return function(p){p.pointerIsDown&&(wo(p.coords.cur,p.offset.total),p.offset.pending.x=0,p.offset.pending.y=0)}(h.interaction)},"interactions:before-action-start":Dl,"interactions:before-action-move":Dl,"interactions:before-action-end":function(h){var p=h.interaction;if(Ml(p))return p.move({offset:!0}),p.end(),!1},"interactions:stop":function(h){var p=h.interaction;p.offset.total.x=0,p.offset.total.y=0,p.offset.pending.x=0,p.offset.pending.y=0}}},Nl=Gm,Hm=function(){function h(p){o(this,h),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=p}return u(h,"t"),i(h,[{key:"start",value:function(p){var y=this.interaction,E=ni(y);if(!E||!E.enabled)return!1;var D=y.coords.velocity.client,H=qe(D.x,D.y),Z=this.modification||(this.modification=new yo(y));if(Z.copyFrom(y.modification),this.t0=y._now(),this.allowResume=E.allowResume,this.v0=H,this.currentOffset={x:0,y:0},this.startCoords=y.coords.cur.page,this.modifierArg=Z.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-y.coords.cur.timeStamp<50&&H>E.minSpeed&&H>E.endSpeed)this.startInertia();else{if(Z.result=Z.setAll(this.modifierArg),!Z.result.changed)return!1;this.startSmoothEnd()}return y.modification.result.rect=null,y.offsetBy(this.targetOffset),y._doPhase({interaction:y,event:p,phase:"inertiastart"}),y.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),y.modification.result.rect=null,this.active=!0,y.simulation=this,!0}},{key:"startInertia",value:function(){var p=this,y=this.interaction.coords.velocity.client,E=ni(this.interaction),D=E.resistance,H=-Math.log(E.endSpeed/this.v0)/D;this.targetOffset={x:(y.x-H)/D,y:(y.y-H)/D},this.te=H,this.lambda_v0=D/this.v0,this.one_ve_v0=1-E.endSpeed/this.v0;var Z=this.modification,te=this.modifierArg;te.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},Z.result=Z.setAll(te),Z.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+Z.result.delta.x,y:this.targetOffset.y+Z.result.delta.y}),this.onNextFrame(function(){return p.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var p=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return p.smoothEndTick()})}},{key:"onNextFrame",value:function(p){var y=this;this.timeout=De.request(function(){y.active&&p()})}},{key:"inertiaTick",value:function(){var p,y,E,D,H,Z,te,oe=this,de=this.interaction,re=ni(de).resistance,ge=(de._now()-this.t0)/1e3;if(ge<this.te){var Se,Te=1-(Math.exp(-re*ge)-this.lambda_v0)/this.one_ve_v0;this.isModified?(p=0,y=0,E=this.targetOffset.x,D=this.targetOffset.y,H=this.modifiedOffset.x,Z=this.modifiedOffset.y,Se={x:$l(te=Te,p,E,H),y:$l(te,y,D,Z)}):Se={x:this.targetOffset.x*Te,y:this.targetOffset.y*Te};var Ie={x:Se.x-this.currentOffset.x,y:Se.y-this.currentOffset.y};this.currentOffset.x+=Ie.x,this.currentOffset.y+=Ie.y,de.offsetBy(Ie),de.move(),this.onNextFrame(function(){return oe.inertiaTick()})}else de.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var p=this,y=this.interaction,E=y._now()-this.t0,D=ni(y).smoothEndDuration;if(E<D){var H={x:Fl(E,0,this.targetOffset.x,D),y:Fl(E,0,this.targetOffset.y,D)},Z={x:H.x-this.currentOffset.x,y:H.y-this.currentOffset.y};this.currentOffset.x+=Z.x,this.currentOffset.y+=Z.y,y.offsetBy(Z),y.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return p.smoothEndTick()})}else y.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(p){var y=p.pointer,E=p.event,D=p.eventTarget,H=this.interaction;H.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),H.updatePointer(y,E,D,!0),H._doPhase({interaction:H,event:E,phase:"resume"}),be(H.coords.prev,H.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,De.cancel(this.timeout)}}]),h}();function ni(h){var p=h.interactable,y=h.prepared;return p&&p.options&&y.name&&p.options[y.name].inertia}u(ni,"Fe");var Vm={id:"inertia",before:["modifiers","actions"],install:function(h){var p=h.defaults;h.usePlugin(Nl),h.usePlugin(Tl),h.actions.phases.inertiastart=!0,h.actions.phases.resume=!0,p.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(h){var p=h.interaction;p.inertia=new Hm(p)},"interactions:before-action-end":function(h){var p=h.interaction,y=h.event;return(!p._interacting||p.simulation||!p.inertia.start(y))&&null},"interactions:down":function(h){var p=h.interaction,y=h.eventTarget,E=p.inertia;if(E.active)for(var D=y;b.element(D);){if(D===p.element){E.resume(h);break}D=V(D)}},"interactions:stop":function(h){var p=h.interaction.inertia;p.active&&p.stop()},"interactions:before-action-resume":function(h){var p=h.interaction.modification;p.stop(h),p.start(h,h.interaction.coords.cur.page),p.applyToInteraction(h)},"interactions:before-action-inertiastart":function(h){return h.interaction.modification.setAndApply(h)},"interactions:action-resume":na,"interactions:action-inertiastart":na,"interactions:after-action-inertiastart":function(h){return h.interaction.modification.restoreInteractionCoords(h)},"interactions:after-action-resume":function(h){return h.interaction.modification.restoreInteractionCoords(h)}}};function $l(h,p,y,E){var D=1-h;return D*D*p+2*D*h*y+h*h*E}u($l,"Ye");function Fl(h,p,y,E){return-y*(h/=E)*(h-2)+p}u(Fl,"Le");var Wm=Vm;function Rl(h,p){for(var y=0;y<p.length;y++){var E=p[y];if(h.immediatePropagationStopped)break;E(h)}}u(Rl,"Be");var ql=function(){function h(p){o(this,h),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=ne({},p||{})}return u(h,"t"),i(h,[{key:"fire",value:function(p){var y,E=this.global;(y=this.types[p.type])&&Rl(p,y),!p.propagationStopped&&E&&(y=E[p.type])&&Rl(p,y)}},{key:"on",value:function(p,y){var E=je(p,y);for(p in E)this.types[p]=Zt(this.types[p]||[],E[p])}},{key:"off",value:function(p,y){var E=je(p,y);for(p in E){var D=this.types[p];if(D&&D.length)for(var H=0,Z=E[p];H<Z.length;H++){var te=Z[H],oe=D.indexOf(te);oe!==-1&&D.splice(oe,1)}}}},{key:"getRect",value:function(p){return null}}]),h}(),Km=function(){function h(p){o(this,h),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=p,ye(this,p)}return u(h,"t"),i(h,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),h}();function sa(h){return b.object(h)?{capture:!!h.capture,passive:!!h.passive}:{capture:!!h,passive:!1}}u(sa,"Ge");function si(h,p){return h===p||(typeof h=="boolean"?!!p.capture===h&&!p.passive:!!h.capture==!!p.capture&&!!h.passive==!!p.passive)}u(si,"Ne");var Ym={id:"events",install:function(h){var p,y=[],E={},D=[],H={add:Z,remove:te,addDelegate:function(re,ge,Se,Te,Ie){var Oe=sa(Ie);if(!E[Se]){E[Se]=[];for(var ze=0;ze<D.length;ze++){var Be=D[ze];Z(Be,Se,oe),Z(Be,Se,de,!0)}}var We=E[Se],nt=gn(We,function(lt){return lt.selector===re&&lt.context===ge});nt||(nt={selector:re,context:ge,listeners:[]},We.push(nt)),nt.listeners.push({func:Te,options:Oe})},removeDelegate:function(re,ge,Se,Te,Ie){var Oe,ze=sa(Ie),Be=E[Se],We=!1;if(Be)for(Oe=Be.length-1;Oe>=0;Oe--){var nt=Be[Oe];if(nt.selector===re&&nt.context===ge){for(var lt=nt.listeners,Ze=lt.length-1;Ze>=0;Ze--){var st=lt[Ze];if(st.func===Te&&si(st.options,ze)){lt.splice(Ze,1),lt.length||(Be.splice(Oe,1),te(ge,Se,oe),te(ge,Se,de,!0)),We=!0;break}}if(We)break}}},delegateListener:oe,delegateUseCapture:de,delegatedEvents:E,documents:D,targets:y,supportsOptions:!1,supportsPassive:!1};function Z(re,ge,Se,Te){if(re.addEventListener){var Ie=sa(Te),Oe=gn(y,function(ze){return ze.eventTarget===re});Oe||(Oe={eventTarget:re,events:{}},y.push(Oe)),Oe.events[ge]||(Oe.events[ge]=[]),gn(Oe.events[ge],function(ze){return ze.func===Se&&si(ze.options,Ie)})||(re.addEventListener(ge,Se,H.supportsOptions?Ie:Ie.capture),Oe.events[ge].push({func:Se,options:Ie}))}}u(Z,"a");function te(re,ge,Se,Te){if(re.addEventListener&&re.removeEventListener){var Ie=mn(y,function(Ht){return Ht.eventTarget===re}),Oe=y[Ie];if(Oe&&Oe.events)if(ge!=="all"){var ze=!1,Be=Oe.events[ge];if(Be){if(Se==="all"){for(var We=Be.length-1;We>=0;We--){var nt=Be[We];te(re,ge,nt.func,nt.options)}return}for(var lt=sa(Te),Ze=0;Ze<Be.length;Ze++){var st=Be[Ze];if(st.func===Se&&si(st.options,lt)){re.removeEventListener(ge,Se,H.supportsOptions?lt:lt.capture),Be.splice(Ze,1),Be.length===0&&(delete Oe.events[ge],ze=!0);break}}}ze&&!Object.keys(Oe.events).length&&y.splice(Ie,1)}else for(ge in Oe.events)Oe.events.hasOwnProperty(ge)&&te(re,ge,"all")}}u(te,"s");function oe(re,ge){for(var Se=sa(ge),Te=new Km(re),Ie=E[re.type],Oe=Jt(re)[0],ze=Oe;b.element(ze);){for(var Be=0;Be<Ie.length;Be++){var We=Ie[Be],nt=We.selector,lt=We.context;if(J(ze,nt)&&X(lt,Oe)&&X(lt,ze)){var Ze=We.listeners;Te.currentTarget=ze;for(var st=0;st<Ze.length;st++){var Ht=Ze[st];si(Ht.options,Se)&&Ht.func(Te)}}}ze=V(ze)}}u(oe,"c");function de(re){return oe(re,!0)}return u(de,"l"),(p=h.document)==null||p.createElement("div").addEventListener("test",null,{get capture(){return H.supportsOptions=!0},get passive(){return H.supportsPassive=!0}}),h.events=H,H}},So={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(h){for(var p=0,y=So.methodOrder;p<y.length;p++){var E=y[p],D=So[E](h);if(D)return D}return null},simulationResume:function(h){var p=h.pointerType,y=h.eventType,E=h.eventTarget,D=h.scope;if(!/down|start/i.test(y))return null;for(var H=0,Z=D.interactions.list;H<Z.length;H++){var te=Z[H],oe=E;if(te.simulation&&te.simulation.allowResume&&te.pointerType===p)for(;oe;){if(oe===te.element)return te;oe=V(oe)}}return null},mouseOrPen:function(h){var p,y=h.pointerId,E=h.pointerType,D=h.eventType,H=h.scope;if(E!=="mouse"&&E!=="pen")return null;for(var Z=0,te=H.interactions.list;Z<te.length;Z++){var oe=te[Z];if(oe.pointerType===E){if(oe.simulation&&!Bl(oe,y))continue;if(oe.interacting())return oe;p||(p=oe)}}if(p)return p;for(var de=0,re=H.interactions.list;de<re.length;de++){var ge=re[de];if(!(ge.pointerType!==E||/down/i.test(D)&&ge.simulation))return ge}return null},hasPointer:function(h){for(var p=h.pointerId,y=0,E=h.scope.interactions.list;y<E.length;y++){var D=E[y];if(Bl(D,p))return D}return null},idle:function(h){for(var p=h.pointerType,y=0,E=h.scope.interactions.list;y<E.length;y++){var D=E[y];if(D.pointers.length===1){var H=D.interactable;if(H&&(!H.options.gesture||!H.options.gesture.enabled))continue}else if(D.pointers.length>=2)continue;if(!D.interacting()&&p===D.pointerType)return D}return null}};function Bl(h,p){return h.pointers.some(function(y){return y.id===p})}u(Bl,"Ke");var Xm=So,Co=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function Ul(h,p){return function(y){var E=p.interactions.list,D=ls(y),H=Jt(y),Z=H[0],te=H[1],oe=[];if(/^touch/.test(y.type)){p.prevTouchTime=p.now();for(var de=0,re=y.changedTouches;de<re.length;de++){var ge=re[de],Se={pointer:ge,pointerId:rt(ge),pointerType:D,eventType:y.type,eventTarget:Z,curEventTarget:te,scope:p},Te=zl(Se);oe.push([Se.pointer,Se.eventTarget,Se.curEventTarget,Te])}}else{var Ie=!1;if(!q.supportsPointerEvent&&/mouse/.test(y.type)){for(var Oe=0;Oe<E.length&&!Ie;Oe++)Ie=E[Oe].pointerType!=="mouse"&&E[Oe].pointerIsDown;Ie=Ie||p.now()-p.prevTouchTime<500||y.timeStamp===0}if(!Ie){var ze={pointer:y,pointerId:rt(y),pointerType:D,eventType:y.type,curEventTarget:te,eventTarget:Z,scope:p},Be=zl(ze);oe.push([ze.pointer,ze.eventTarget,ze.curEventTarget,Be])}}for(var We=0;We<oe.length;We++){var nt=oe[We],lt=nt[0],Ze=nt[1],st=nt[2];nt[3][h](lt,y,Ze,st)}}}u(Ul,"Qe");function zl(h){var p=h.pointerType,y=h.scope,E={interaction:Xm.search(h),searchDetails:h};return y.fire("interactions:find",E),E.interaction||y.interactions.new({pointerType:p})}u(zl,"Ze");function Ao(h,p){var y=h.doc,E=h.scope,D=h.options,H=E.interactions.docEvents,Z=E.events,te=Z[p];for(var oe in E.browser.isIOS&&!D.events&&(D.events={passive:!1}),Z.delegatedEvents)te(y,oe,Z.delegateListener),te(y,oe,Z.delegateUseCapture,!0);for(var de=D&&D.events,re=0;re<H.length;re++){var ge=H[re];te(y,ge.type,ge.listener,de)}}u(Ao,"tn");var Jm={id:"core/interactions",install:function(h){for(var p={},y=0;y<Co.length;y++){var E=Co[y];p[E]=Ul(E,h)}var D,H=q.pEventTypes;function Z(){for(var te=0,oe=h.interactions.list;te<oe.length;te++){var de=oe[te];if(de.pointerIsDown&&de.pointerType==="touch"&&!de._interacting)for(var re=function(){var Te=Se[ge];h.documents.some(function(Ie){return X(Ie.doc,Te.downTarget)})||de.removePointer(Te.pointer,Te.event)},ge=0,Se=de.pointers;ge<Se.length;ge++)re()}}u(Z,"l"),(D=B.PointerEvent?[{type:H.down,listener:Z},{type:H.down,listener:p.pointerDown},{type:H.move,listener:p.pointerMove},{type:H.up,listener:p.pointerUp},{type:H.cancel,listener:p.pointerUp}]:[{type:"mousedown",listener:p.pointerDown},{type:"mousemove",listener:p.pointerMove},{type:"mouseup",listener:p.pointerUp},{type:"touchstart",listener:Z},{type:"touchstart",listener:p.pointerDown},{type:"touchmove",listener:p.pointerMove},{type:"touchend",listener:p.pointerUp},{type:"touchcancel",listener:p.pointerUp}]).push({type:"blur",listener:function(te){for(var oe=0,de=h.interactions.list;oe<de.length;oe++)de[oe].documentBlur(te)}}),h.prevTouchTime=0,h.Interaction=function(te){c(de,te);var oe=x(de);function de(){return o(this,de),oe.apply(this,arguments)}return u(de,"i"),i(de,[{key:"pointerMoveTolerance",get:function(){return h.interactions.pointerMoveTolerance},set:function(re){h.interactions.pointerMoveTolerance=re}},{key:"_now",value:function(){return h.now()}}]),de}(Um),h.interactions={list:[],new:function(te){te.scopeFire=function(de,re){return h.fire(de,re)};var oe=new h.Interaction(te);return h.interactions.list.push(oe),oe},listeners:p,docEvents:D,pointerMoveTolerance:1},h.usePlugin(Ll)},listeners:{"scope:add-document":function(h){return Ao(h,"add")},"scope:remove-document":function(h){return Ao(h,"remove")},"interactable:unset":function(h,p){for(var y=h.interactable,E=p.interactions.list.length-1;E>=0;E--){var D=p.interactions.list[E];D.interactable===y&&(D.stop(),p.fire("interactions:destroy",{interaction:D}),D.destroy(),p.interactions.list.length>2&&p.interactions.list.splice(E,1))}}},onDocSignal:Ao,doOnInteractions:Ul,methodNames:Co},Zm=Jm,Vn=function(h){return h[h.On=0]="On",h[h.Off=1]="Off",h}(Vn||{}),Qm=function(){function h(p,y,E,D){o(this,h),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new ql,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=y.actions,this.target=p,this._context=y.context||E,this._win=O(le(p)?this._context:p),this._doc=this._win.document,this._scopeEvents=D,this.set(y)}return u(h,"t"),i(h,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(p,y){return b.func(y.onstart)&&this.on("".concat(p,"start"),y.onstart),b.func(y.onmove)&&this.on("".concat(p,"move"),y.onmove),b.func(y.onend)&&this.on("".concat(p,"end"),y.onend),b.func(y.oninertiastart)&&this.on("".concat(p,"inertiastart"),y.oninertiastart),this}},{key:"updatePerActionListeners",value:function(p,y,E){var D,H=this,Z=(D=this._actions.map[p])==null?void 0:D.filterEventType,te=u(function(oe){return(Z==null||Z(oe))&&ei(oe,H._actions)},"a");(b.array(y)||b.object(y))&&this._onOff(Vn.Off,p,y,void 0,te),(b.array(E)||b.object(E))&&this._onOff(Vn.On,p,E,void 0,te)}},{key:"setPerAction",value:function(p,y){var E=this._defaults;for(var D in y){var H=D,Z=this.options[p],te=y[H];H==="listeners"&&this.updatePerActionListeners(p,Z.listeners,te),b.array(te)?Z[H]=In(te):b.plainObject(te)?(Z[H]=ne(Z[H]||{},Ts(te)),b.object(E.perAction[H])&&"enabled"in E.perAction[H]&&(Z[H].enabled=te.enabled!==!1)):b.bool(te)&&b.object(E.perAction[H])?Z[H].enabled=te:Z[H]=te}}},{key:"getRect",value:function(p){return p=p||(b.element(this.target)?this.target:null),b.string(this.target)&&(p=p||this._context.querySelector(this.target)),Y(p)}},{key:"rectChecker",value:function(p){var y=this;return b.func(p)?(this.getRect=function(E){var D=ne({},p.apply(y,E));return"width"in D||(D.width=D.right-D.left,D.height=D.bottom-D.top),D},this):p===null?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(p,y){if(le(y)||b.object(y)){for(var E in this.options[p]=y,this._actions.map)this.options[E][p]=y;return this}return this.options[p]}},{key:"origin",value:function(p){return this._backCompatOption("origin",p)}},{key:"deltaSource",value:function(p){return p==="page"||p==="client"?(this.options.deltaSource=p,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var p=this.target;return b.string(p)?Array.from(this._context.querySelectorAll(p)):b.func(p)&&p.getAllElements?p.getAllElements():b.element(p)?[p]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(p){return this._context===p.ownerDocument||X(this._context,p)}},{key:"testIgnoreAllow",value:function(p,y,E){return!this.testIgnore(p.ignoreFrom,y,E)&&this.testAllow(p.allowFrom,y,E)}},{key:"testAllow",value:function(p,y,E){return!p||!!b.element(E)&&(b.string(p)?S(E,p,y):!!b.element(p)&&X(p,E))}},{key:"testIgnore",value:function(p,y,E){return!(!p||!b.element(E))&&(b.string(p)?S(E,p,y):!!b.element(p)&&X(p,E))}},{key:"fire",value:function(p){return this.events.fire(p),this}},{key:"_onOff",value:function(p,y,E,D,H){b.object(y)&&!b.array(y)&&(D=E,E=null);var Z=je(y,E,H);for(var te in Z){te==="wheel"&&(te=q.wheelEvent);for(var oe=0,de=Z[te];oe<de.length;oe++){var re=de[oe];ei(te,this._actions)?this.events[p===Vn.On?"on":"off"](te,re):b.string(this.target)?this._scopeEvents[p===Vn.On?"addDelegate":"removeDelegate"](this.target,this._context,te,re,D):this._scopeEvents[p===Vn.On?"add":"remove"](this.target,te,re,D)}}return this}},{key:"on",value:function(p,y,E){return this._onOff(Vn.On,p,y,E)}},{key:"off",value:function(p,y,E){return this._onOff(Vn.Off,p,y,E)}},{key:"set",value:function(p){var y=this._defaults;for(var E in b.object(p)||(p={}),this.options=Ts(y.base),this._actions.methodDict){var D=E,H=this._actions.methodDict[D];this.options[D]={},this.setPerAction(D,ne(ne({},y.perAction),y.actions[D])),this[H](p[D])}for(var Z in p)Z!=="getRect"?b.func(this[Z])&&this[Z](p[Z]):this.rectChecker(p.getRect);return this}},{key:"unset",value:function(){if(b.string(this.target))for(var p in this._scopeEvents.delegatedEvents)for(var y=this._scopeEvents.delegatedEvents[p],E=y.length-1;E>=0;E--){var D=y[E],H=D.selector,Z=D.context,te=D.listeners;H===this.target&&Z===this._context&&y.splice(E,1);for(var oe=te.length-1;oe>=0;oe--)this._scopeEvents.removeDelegate(this.target,this._context,p,te[oe][0],te[oe][1])}else this._scopeEvents.remove(this.target,"all")}}]),h}(),eg=function(){function h(p){var y=this;o(this,h),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=p,p.addListeners({"interactable:unset":function(E){var D=E.interactable,H=D.target,Z=b.string(H)?y.selectorMap[H]:H[y.scope.id],te=mn(Z,function(oe){return oe===D});Z.splice(te,1)}})}return u(h,"t"),i(h,[{key:"new",value:function(p,y){y=ne(y||{},{actions:this.scope.actions});var E=new this.scope.Interactable(p,y,this.scope.document,this.scope.events);return this.scope.addDocument(E._doc),this.list.push(E),b.string(p)?(this.selectorMap[p]||(this.selectorMap[p]=[]),this.selectorMap[p].push(E)):(E.target[this.scope.id]||Object.defineProperty(p,this.scope.id,{value:[],configurable:!0}),p[this.scope.id].push(E)),this.scope.fire("interactable:new",{target:p,options:y,interactable:E,win:this.scope._win}),E}},{key:"getExisting",value:function(p,y){var E=y&&y.context||this.scope.document,D=b.string(p),H=D?this.selectorMap[p]:p[this.scope.id];if(H)return gn(H,function(Z){return Z._context===E&&(D||Z.inContext(p))})}},{key:"forEachMatch",value:function(p,y){for(var E=0,D=this.list;E<D.length;E++){var H=D[E],Z=void 0;if((b.string(H.target)?b.element(p)&&J(p,H.target):p===H.target)&&H.inContext(p)&&(Z=y(H)),Z!==void 0)return Z}}}]),h}(),tg=function(){function h(){var p=this;o(this,h),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=q,this.defaults=Ts(jl),this.Eventable=ql,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(E){var D=u(function H(Z,te){var oe=E.interactables.getExisting(Z,te);return oe||((oe=E.interactables.new(Z,te)).events.global=H.globalEvents),oe},"e");return D.getPointerAverage=Xt,D.getTouchBBox=Wt,D.getTouchDistance=Un,D.getTouchAngle=zn,D.getElementRect=Y,D.getElementClientRect=G,D.matchesSelector=J,D.closest=Q,D.globalEvents={},D.version="1.10.27",D.scope=E,D.use=function(H,Z){return this.scope.usePlugin(H,Z),this},D.isSet=function(H,Z){return!!this.scope.interactables.get(H,Z&&Z.context)},D.on=vt(function(H,Z,te){if(b.string(H)&&H.search(" ")!==-1&&(H=H.trim().split(/ +/)),b.array(H)){for(var oe=0,de=H;oe<de.length;oe++){var re=de[oe];this.on(re,Z,te)}return this}if(b.object(H)){for(var ge in H)this.on(ge,H[ge],Z);return this}return ei(H,this.scope.actions)?this.globalEvents[H]?this.globalEvents[H].push(Z):this.globalEvents[H]=[Z]:this.scope.events.add(this.scope.document,H,Z,{options:te}),this},"The interact.on() method is being deprecated"),D.off=vt(function(H,Z,te){if(b.string(H)&&H.search(" ")!==-1&&(H=H.trim().split(/ +/)),b.array(H)){for(var oe=0,de=H;oe<de.length;oe++){var re=de[oe];this.off(re,Z,te)}return this}if(b.object(H)){for(var ge in H)this.off(ge,H[ge],Z);return this}var Se;return ei(H,this.scope.actions)?H in this.globalEvents&&(Se=this.globalEvents[H].indexOf(Z))!==-1&&this.globalEvents[H].splice(Se,1):this.scope.events.remove(this.scope.document,H,Z,te),this},"The interact.off() method is being deprecated"),D.debug=function(){return this.scope},D.supportsTouch=function(){return q.supportsTouch},D.supportsPointerEvent=function(){return q.supportsPointerEvent},D.stop=function(){for(var H=0,Z=this.scope.interactions.list;H<Z.length;H++)Z[H].stop();return this},D.pointerMoveTolerance=function(H){return b.number(H)?(this.scope.interactions.pointerMoveTolerance=H,this):this.scope.interactions.pointerMoveTolerance},D.addDocument=function(H,Z){this.scope.addDocument(H,Z)},D.removeDocument=function(H){this.scope.removeDocument(H)},D}(this),this.InteractEvent=xo,this.Interactable=void 0,this.interactables=new eg(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(E){return p.removeDocument(E.target)};var y=this;this.Interactable=function(E){c(H,E);var D=x(H);function H(){return o(this,H),D.apply(this,arguments)}return u(H,"i"),i(H,[{key:"_defaults",get:function(){return y.defaults}},{key:"set",value:function(Z){return C(l(H.prototype),"set",this).call(this,Z),y.fire("interactable:set",{options:Z,interactable:this}),this}},{key:"unset",value:function(){C(l(H.prototype),"unset",this).call(this);var Z=y.interactables.list.indexOf(this);Z<0||(y.interactables.list.splice(Z,1),y.fire("interactable:unset",{interactable:this}))}}]),H}(Qm)}return u(h,"t"),i(h,[{key:"addListeners",value:function(p,y){this.listenerMaps.push({id:y,map:p})}},{key:"fire",value:function(p,y){for(var E=0,D=this.listenerMaps;E<D.length;E++){var H=D[E].map[p];if(H&&H(y,this,p)===!1)return!1}}},{key:"init",value:function(p){return this.isInitialized?this:function(y,E){return y.isInitialized=!0,b.window(E)&&F(E),B.init(E),q.init(E),De.init(E),y.window=E,y.document=E.document,y.usePlugin(Zm),y.usePlugin(Ym),y}(this,p)}},{key:"pluginIsInstalled",value:function(p){var y=p.id;return y?!!this._plugins.map[y]:this._plugins.list.indexOf(p)!==-1}},{key:"usePlugin",value:function(p,y){if(!this.isInitialized)return this;if(this.pluginIsInstalled(p))return this;if(p.id&&(this._plugins.map[p.id]=p),this._plugins.list.push(p),p.install&&p.install(this,y),p.listeners&&p.before){for(var E=0,D=this.listenerMaps.length,H=p.before.reduce(function(te,oe){return te[oe]=!0,te[Gl(oe)]=!0,te},{});E<D;E++){var Z=this.listenerMaps[E].id;if(Z&&(H[Z]||H[Gl(Z)]))break}this.listenerMaps.splice(E,0,{id:p.id,map:p.listeners})}else p.listeners&&this.listenerMaps.push({id:p.id,map:p.listeners});return this}},{key:"addDocument",value:function(p,y){if(this.getDocIndex(p)!==-1)return!1;var E=O(p);y=y?ne({},y):{},this.documents.push({doc:p,options:y}),this.events.documents.push(p),p!==this.document&&this.events.add(E,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:p,window:E,scope:this,options:y})}},{key:"removeDocument",value:function(p){var y=this.getDocIndex(p),E=O(p),D=this.documents[y].options;this.events.remove(E,"unload",this.onWindowUnload),this.documents.splice(y,1),this.events.documents.splice(y,1),this.fire("scope:remove-document",{doc:p,window:E,scope:this,options:D})}},{key:"getDocIndex",value:function(p){for(var y=0;y<this.documents.length;y++)if(this.documents[y].doc===p)return y;return-1}},{key:"getDocOptions",value:function(p){var y=this.getDocIndex(p);return y===-1?null:this.documents[y].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),h}();function Gl(h){return h&&h.replace(/\/.*$/,"")}u(Gl,"cn");var Hl=new tg,Gt=Hl.interactStatic,ng=typeof globalThis<"u"?globalThis:window;Hl.init(ng);var sg=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(h){var p=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(E){var D=E[0],H=E[1];return D in h||H in h}),y=u(function(E,D){for(var H=h.range,Z=h.limits,te=Z===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:Z,oe=h.offset,de=oe===void 0?{x:0,y:0}:oe,re={range:H,grid:h,x:null,y:null},ge=0;ge<p.length;ge++){var Se=p[ge],Te=Se[0],Ie=Se[1],Oe=Math.round((E-de.x)/h[Te]),ze=Math.round((D-de.y)/h[Ie]);re[Te]=Math.max(te.left,Math.min(te.right,Oe*h[Te]+de.x)),re[Ie]=Math.max(te.top,Math.min(te.bottom,ze*h[Ie]+de.y))}return re},"n");return y.grid=h,y.coordFields=p,y}}),ag={id:"snappers",install:function(h){var p=h.interactStatic;p.snappers=ne(p.snappers||{},sg),p.createSnapGrid=p.snappers.grid}},ig=ag,og={start:function(h){var p=h.state,y=h.rect,E=h.edges,D=h.pageCoords,H=p.options,Z=H.ratio,te=H.enabled,oe=p.options,de=oe.equalDelta,re=oe.modifiers;Z==="preserve"&&(Z=y.width/y.height),p.startCoords=ne({},D),p.startRect=ne({},y),p.ratio=Z,p.equalDelta=de;var ge=p.linkedEdges={top:E.top||E.left&&!E.bottom,left:E.left||E.top&&!E.right,bottom:E.bottom||E.right&&!E.top,right:E.right||E.bottom&&!E.left};if(p.xIsPrimaryAxis=!(!E.left&&!E.right),p.equalDelta){var Se=(ge.left?1:-1)*(ge.top?1:-1);p.edgeSign={x:Se,y:Se}}else p.edgeSign={x:ge.left?-1:1,y:ge.top?-1:1};if(te!==!1&&ne(E,ge),re!=null&&re.length){var Te=new yo(h.interaction);Te.copyFrom(h.interaction.modification),Te.prepareStates(re),p.subModification=Te,Te.startAll(s({},h))}},set:function(h){var p=h.state,y=h.rect,E=h.coords,D=p.linkedEdges,H=ne({},E),Z=p.equalDelta?rg:lg;if(ne(h.edges,D),Z(p,p.xIsPrimaryAxis,E,y),!p.subModification)return null;var te=ne({},y);we(D,te,{x:E.x-H.x,y:E.y-H.y});var oe=p.subModification.setAll(s(s({},h),{},{rect:te,edges:D,pageCoords:E,prevCoords:E,prevRect:te})),de=oe.delta;return oe.changed&&(Z(p,Math.abs(de.x)>Math.abs(de.y),oe.coords,oe.rect),ne(E,oe.coords)),oe.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function rg(h,p,y){var E=h.startCoords,D=h.edgeSign;p?y.y=E.y+(y.x-E.x)*D.y:y.x=E.x+(y.y-E.y)*D.x}u(rg,"gn");function lg(h,p,y,E){var D=h.startRect,H=h.startCoords,Z=h.ratio,te=h.edgeSign;if(p){var oe=E.width/Z;y.y=H.y+(oe-D.height)*te.y}else{var de=E.height*Z;y.x=H.x+(de-D.width)*te.x}}u(lg,"mn");var cg=Hn(og,"aspectRatio"),Vl=u(function(){},"bn");Vl._defaults={};var ai=Vl;function ps(h,p,y){return b.func(h)?pe(h,p.interactable,p.element,[y.x,y.y,p]):pe(h,p.interactable,p.element)}u(ps,"wn");var ii={start:function(h){var p=h.rect,y=h.startOffset,E=h.state,D=h.interaction,H=h.pageCoords,Z=E.options,te=Z.elementRect,oe=ne({left:0,top:0,right:0,bottom:0},Z.offset||{});if(p&&te){var de=ps(Z.restriction,D,H);if(de){var re=de.right-de.left-p.width,ge=de.bottom-de.top-p.height;re<0&&(oe.left+=re,oe.right+=re),ge<0&&(oe.top+=ge,oe.bottom+=ge)}oe.left+=y.left-p.width*te.left,oe.top+=y.top-p.height*te.top,oe.right+=y.right-p.width*(1-te.right),oe.bottom+=y.bottom-p.height*(1-te.bottom)}E.offset=oe},set:function(h){var p=h.coords,y=h.interaction,E=h.state,D=E.options,H=E.offset,Z=ps(D.restriction,y,p);if(Z){var te=function(oe){return!oe||"left"in oe&&"top"in oe||((oe=ne({},oe)).left=oe.x||0,oe.top=oe.y||0,oe.right=oe.right||oe.left+oe.width,oe.bottom=oe.bottom||oe.top+oe.height),oe}(Z);p.x=Math.max(Math.min(te.right-H.right,p.x),te.left+H.left),p.y=Math.max(Math.min(te.bottom-H.bottom,p.y),te.top+H.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},ug=Hn(ii,"restrict"),Wl={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Kl={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function Yl(h,p){for(var y=0,E=["top","left","bottom","right"];y<E.length;y++){var D=E[y];D in h||(h[D]=p[D])}return h}u(Yl,"Pn");var aa={noInner:Wl,noOuter:Kl,start:function(h){var p,y=h.interaction,E=h.startOffset,D=h.state,H=D.options;H&&(p=fe(ps(H.offset,y,y.coords.start.page))),p=p||{x:0,y:0},D.offset={top:p.y+E.top,left:p.x+E.left,bottom:p.y-E.bottom,right:p.x-E.right}},set:function(h){var p=h.coords,y=h.edges,E=h.interaction,D=h.state,H=D.offset,Z=D.options;if(y){var te=ne({},p),oe=ps(Z.inner,E,te)||{},de=ps(Z.outer,E,te)||{};Yl(oe,Wl),Yl(de,Kl),y.top?p.y=Math.min(Math.max(de.top+H.top,te.y),oe.top+H.top):y.bottom&&(p.y=Math.max(Math.min(de.bottom+H.bottom,te.y),oe.bottom+H.bottom)),y.left?p.x=Math.min(Math.max(de.left+H.left,te.x),oe.left+H.left):y.right&&(p.x=Math.max(Math.min(de.right+H.right,te.x),oe.right+H.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},dg=Hn(aa,"restrictEdges"),pg=ne({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(h){}},ii.defaults),hg=Hn({start:ii.start,set:ii.set,defaults:pg},"restrictRect"),mg={width:-1/0,height:-1/0},gg={width:1/0,height:1/0},fg=Hn({start:function(h){return aa.start(h)},set:function(h){var p=h.interaction,y=h.state,E=h.rect,D=h.edges,H=y.options;if(D){var Z=me(ps(H.min,p,h.coords))||mg,te=me(ps(H.max,p,h.coords))||gg;y.options={endOnly:H.endOnly,inner:ne({},aa.noInner),outer:ne({},aa.noOuter)},D.top?(y.options.inner.top=E.bottom-Z.height,y.options.outer.top=E.bottom-te.height):D.bottom&&(y.options.inner.bottom=E.top+Z.height,y.options.outer.bottom=E.top+te.height),D.left?(y.options.inner.left=E.right-Z.width,y.options.outer.left=E.right-te.width):D.right&&(y.options.inner.right=E.left+Z.width,y.options.outer.right=E.left+te.width),aa.set(h),y.options=H}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Eo={start:function(h){var p,y=h.interaction,E=h.interactable,D=h.element,H=h.rect,Z=h.state,te=h.startOffset,oe=Z.options,de=oe.offsetWithOrigin?function(Se){var Te=Se.interaction.element,Ie=fe(pe(Se.state.options.origin,null,null,[Te])),Oe=Ie||_e(Se.interactable,Te,Se.interaction.prepared.name);return Oe}(h):{x:0,y:0};if(oe.offset==="startCoords")p={x:y.coords.start.page.x,y:y.coords.start.page.y};else{var re=pe(oe.offset,E,D,[y]);(p=fe(re)||{x:0,y:0}).x+=de.x,p.y+=de.y}var ge=oe.relativePoints;Z.offsets=H&&ge&&ge.length?ge.map(function(Se,Te){return{index:Te,relativePoint:Se,x:te.left-H.width*Se.x+p.x,y:te.top-H.height*Se.y+p.y}}):[{index:0,relativePoint:null,x:p.x,y:p.y}]},set:function(h){var p=h.interaction,y=h.coords,E=h.state,D=E.options,H=E.offsets,Z=_e(p.interactable,p.element,p.prepared.name),te=ne({},y),oe=[];D.offsetWithOrigin||(te.x-=Z.x,te.y-=Z.y);for(var de=0,re=H;de<re.length;de++)for(var ge=re[de],Se=te.x-ge.x,Te=te.y-ge.y,Ie=0,Oe=D.targets.length;Ie<Oe;Ie++){var ze=D.targets[Ie],Be=void 0;(Be=b.func(ze)?ze(Se,Te,p._proxy,ge,Ie):ze)&&oe.push({x:(b.number(Be.x)?Be.x:Se)+ge.x,y:(b.number(Be.y)?Be.y:Te)+ge.y,range:b.number(Be.range)?Be.range:D.range,source:ze,index:Ie,offset:ge})}for(var We={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},nt=0;nt<oe.length;nt++){var lt=oe[nt],Ze=lt.range,st=lt.x-te.x,Ht=lt.y-te.y,yt=qe(st,Ht),tn=yt<=Ze;Ze===1/0&&We.inRange&&We.range!==1/0&&(tn=!1),We.target&&!(tn?We.inRange&&Ze!==1/0?yt/Ze<We.distance/We.range:Ze===1/0&&We.range!==1/0||yt<We.distance:!We.inRange&&yt<We.distance)||(We.target=lt,We.distance=yt,We.range=Ze,We.inRange=tn,We.delta.x=st,We.delta.y=Ht)}return We.inRange&&(y.x=We.target.x,y.y=We.target.y),E.closest=We,We},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},vg=Hn(Eo,"snap"),oi={start:function(h){var p=h.state,y=h.edges,E=p.options;if(!y)return null;h.state={options:{targets:null,relativePoints:[{x:y.left?0:1,y:y.top?0:1}],offset:E.offset||"self",origin:{x:0,y:0},range:E.range}},p.targetFields=p.targetFields||[["width","height"],["x","y"]],Eo.start(h),p.offsets=h.state.offsets,h.state=p},set:function(h){var p=h.interaction,y=h.state,E=h.coords,D=y.options,H=y.offsets,Z={x:E.x-H[0].x,y:E.y-H[0].y};y.options=ne({},D),y.options.targets=[];for(var te=0,oe=D.targets||[];te<oe.length;te++){var de=oe[te],re=void 0;if(re=b.func(de)?de(Z.x,Z.y,p):de){for(var ge=0,Se=y.targetFields;ge<Se.length;ge++){var Te=Se[ge],Ie=Te[0],Oe=Te[1];if(Ie in re||Oe in re){re.x=re[Ie],re.y=re[Oe];break}}y.options.targets.push(re)}}var ze=Eo.set(h);return y.options=D,ze},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},bg=Hn(oi,"snapSize"),ko={aspectRatio:cg,restrictEdges:dg,restrict:ug,restrictRect:hg,restrictSize:fg,snapEdges:Hn({start:function(h){var p=h.edges;return p?(h.state.targetFields=h.state.targetFields||[[p.left?"left":"right",p.top?"top":"bottom"]],oi.start(h)):null},set:oi.set,defaults:ne(Ts(oi.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:vg,snapSize:bg,spring:ai,avoid:ai,transform:ai,rubberband:ai},yg={id:"modifiers",install:function(h){var p=h.interactStatic;for(var y in h.usePlugin(Tl),h.usePlugin(ig),p.modifiers=ko,ko){var E=ko[y],D=E._defaults,H=E._methods;D._methods=H,h.defaults.perAction[y]=D}}},xg=yg,Xl=function(h){c(y,h);var p=x(y);function y(E,D,H,Z,te,oe){var de;if(o(this,y),ye(v(de=p.call(this,te)),H),H!==D&&ye(v(de),D),de.timeStamp=oe,de.originalEvent=H,de.type=E,de.pointerId=rt(D),de.pointerType=ls(D),de.target=Z,de.currentTarget=null,E==="tap"){var re=te.getPointerIndex(D);de.dt=de.timeStamp-te.pointers[re].downTime;var ge=de.timeStamp-te.tapTime;de.double=!!te.prevTap&&te.prevTap.type!=="doubletap"&&te.prevTap.target===de.target&&ge<500}else E==="doubletap"&&(de.dt=D.timeStamp-te.tapTime,de.double=!0);return de}return u(y,"n"),i(y,[{key:"_subtractOrigin",value:function(E){var D=E.x,H=E.y;return this.pageX-=D,this.pageY-=H,this.clientX-=D,this.clientY-=H,this}},{key:"_addOrigin",value:function(E){var D=E.x,H=E.y;return this.pageX+=D,this.pageY+=H,this.clientX+=D,this.clientY+=H,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),y}(hn),ia={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(h){h.pointerEvents=ia,h.defaults.actions.pointerEvents=ia.defaults,ne(h.actions.phaselessTypes,ia.types)},listeners:{"interactions:new":function(h){var p=h.interaction;p.prevTap=null,p.tapTime=0},"interactions:update-pointer":function(h){var p=h.down,y=h.pointerInfo;!p&&y.hold||(y.hold={duration:1/0,timeout:null})},"interactions:move":function(h,p){var y=h.interaction,E=h.pointer,D=h.event,H=h.eventTarget;h.duplicate||y.pointerIsDown&&!y.pointerWasMoved||(y.pointerIsDown&&_o(h),Wn({interaction:y,pointer:E,event:D,eventTarget:H,type:"move"},p))},"interactions:down":function(h,p){(function(y,E){for(var D=y.interaction,H=y.pointer,Z=y.event,te=y.eventTarget,oe=y.pointerIndex,de=D.pointers[oe].hold,re=se(te),ge={interaction:D,pointer:H,event:Z,eventTarget:te,type:"hold",targets:[],path:re,node:null},Se=0;Se<re.length;Se++){var Te=re[Se];ge.node=Te,E.fire("pointerEvents:collect-targets",ge)}if(ge.targets.length){for(var Ie=1/0,Oe=0,ze=ge.targets;Oe<ze.length;Oe++){var Be=ze[Oe].eventable.options.holdDuration;Be<Ie&&(Ie=Be)}de.duration=Ie,de.timeout=setTimeout(function(){Wn({interaction:D,eventTarget:te,pointer:H,event:Z,type:"hold"},E)},Ie)}})(h,p),Wn(h,p)},"interactions:up":function(h,p){_o(h),Wn(h,p),function(y,E){var D=y.interaction,H=y.pointer,Z=y.event,te=y.eventTarget;D.pointerWasMoved||Wn({interaction:D,eventTarget:te,pointer:H,event:Z,type:"tap"},E)}(h,p)},"interactions:cancel":function(h,p){_o(h),Wn(h,p)}},PointerEvent:Xl,fire:Wn,collectEventTargets:Jl,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function Wn(h,p){var y=h.interaction,E=h.pointer,D=h.event,H=h.eventTarget,Z=h.type,te=h.targets,oe=te===void 0?Jl(h,p):te,de=new Xl(Z,E,D,H,y,p.now());p.fire("pointerEvents:new",{pointerEvent:de});for(var re={interaction:y,pointer:E,event:D,eventTarget:H,targets:oe,type:Z,pointerEvent:de},ge=0;ge<oe.length;ge++){var Se=oe[ge];for(var Te in Se.props||{})de[Te]=Se.props[Te];var Ie=_e(Se.eventable,Se.node);if(de._subtractOrigin(Ie),de.eventable=Se.eventable,de.currentTarget=Se.node,Se.eventable.fire(de),de._addOrigin(Ie),de.immediatePropagationStopped||de.propagationStopped&&ge+1<oe.length&&oe[ge+1].node!==de.currentTarget)break}if(p.fire("pointerEvents:fired",re),Z==="tap"){var Oe=de.double?Wn({interaction:y,pointer:E,event:D,eventTarget:H,type:"doubletap"},p):de;y.prevTap=Oe,y.tapTime=Oe.timeStamp}return de}u(Wn,"Vn");function Jl(h,p){var y=h.interaction,E=h.pointer,D=h.event,H=h.eventTarget,Z=h.type,te=y.getPointerIndex(E),oe=y.pointers[te];if(Z==="tap"&&(y.pointerWasMoved||!oe||oe.downTarget!==H))return[];for(var de=se(H),re={interaction:y,pointer:E,event:D,eventTarget:H,type:Z,path:de,targets:[],node:null},ge=0;ge<de.length;ge++){var Se=de[ge];re.node=Se,p.fire("pointerEvents:collect-targets",re)}return Z==="hold"&&(re.targets=re.targets.filter(function(Te){var Ie,Oe;return Te.eventable.options.holdDuration===((Ie=y.pointers[te])==null||(Oe=Ie.hold)==null?void 0:Oe.duration)})),re.targets}u(Jl,"Wn");function _o(h){var p=h.interaction,y=h.pointerIndex,E=p.pointers[y].hold;E&&E.timeout&&(clearTimeout(E.timeout),E.timeout=null)}u(_o,"Gn");var wg=Object.freeze({__proto__:null,default:ia});function Sg(h){var p=h.interaction;p.holdIntervalHandle&&(clearInterval(p.holdIntervalHandle),p.holdIntervalHandle=null)}u(Sg,"Un");var Cg={id:"pointer-events/holdRepeat",install:function(h){h.usePlugin(ia);var p=h.pointerEvents;p.defaults.holdRepeatInterval=0,p.types.holdrepeat=h.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(h,p){return h["pointerEvents:".concat(p)]=Sg,h},{"pointerEvents:new":function(h){var p=h.pointerEvent;p.type==="hold"&&(p.count=(p.count||0)+1)},"pointerEvents:fired":function(h,p){var y=h.interaction,E=h.pointerEvent,D=h.eventTarget,H=h.targets;if(E.type==="hold"&&H.length){var Z=H[0].eventable.options.holdRepeatInterval;Z<=0||(y.holdIntervalHandle=setTimeout(function(){p.pointerEvents.fire({interaction:y,eventTarget:D,type:"hold",pointer:E,event:E},p)},Z))}}})},Ag=Cg,Eg={id:"pointer-events/interactableTargets",install:function(h){var p=h.Interactable;p.prototype.pointerEvents=function(E){return ne(this.events.options,E),this};var y=p.prototype._backCompatOption;p.prototype._backCompatOption=function(E,D){var H=y.call(this,E,D);return H===this&&(this.events.options[E]=D),H}},listeners:{"pointerEvents:collect-targets":function(h,p){var y=h.targets,E=h.node,D=h.type,H=h.eventTarget;p.interactables.forEachMatch(E,function(Z){var te=Z.events,oe=te.options;te.types[D]&&te.types[D].length&&Z.testIgnoreAllow(oe,E,H)&&y.push({node:E,eventable:te,props:{interactable:Z}})})},"interactable:new":function(h){var p=h.interactable;p.events.getRect=function(y){return p.getRect(y)}},"interactable:set":function(h,p){var y=h.interactable,E=h.options;ne(y.events.options,p.pointerEvents.defaults),ne(y.events.options,E.pointerEvents||{})}}},kg=Eg,_g={id:"pointer-events",install:function(h){h.usePlugin(wg),h.usePlugin(Ag),h.usePlugin(kg)}},Pg=_g,Ig={id:"reflow",install:function(h){var p=h.Interactable;h.actions.phases.reflow=!0,p.prototype.reflow=function(y){return function(E,D,H){for(var Z=E.getAllElements(),te=H.window.Promise,oe=te?[]:null,de=function(){var ge=Z[re],Se=E.getRect(ge);if(!Se)return 1;var Te,Ie=gn(H.interactions.list,function(Be){return Be.interacting()&&Be.interactable===E&&Be.element===ge&&Be.prepared.name===D.name});if(Ie)Ie.move(),oe&&(Te=Ie._reflowPromise||new te(function(Be){Ie._reflowResolve=Be}));else{var Oe=me(Se),ze=function(Be){return{coords:Be,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:Oe.x,y:Oe.y},client:{x:Oe.x,y:Oe.y},timeStamp:H.now()});Te=function(Be,We,nt,lt,Ze){var st=Be.interactions.new({pointerType:"reflow"}),Ht={interaction:st,event:Ze,pointer:Ze,eventTarget:nt,phase:"reflow"};st.interactable=We,st.element=nt,st.prevEvent=Ze,st.updatePointer(Ze,Ze,nt,!0),Ae(st.coords.delta),Gn(st.prepared,lt),st._doPhase(Ht);var yt=Be.window,tn=yt.Promise,vn=tn?new tn(function(Tn){st._reflowResolve=Tn}):void 0;return st._reflowPromise=vn,st.start(lt,We,nt),st._interacting?(st.move(Ht),st.end(Ze)):(st.stop(),st._reflowResolve()),st.removePointer(Ze,Ze),vn}(H,E,ge,D,ze)}oe&&oe.push(Te)},re=0;re<Z.length&&!de();re++);return oe&&te.all(oe).then(function(){return E})}(this,y,h)}},listeners:{"interactions:stop":function(h,p){var y=h.interaction;y.pointerType==="reflow"&&(y._reflowResolve&&y._reflowResolve(),function(E,D){E.splice(E.indexOf(D),1)}(p.interactions.list,y))}}},Lg=Ig;if(Gt.use(Ll),Gt.use(Nl),Gt.use(Pg),Gt.use(Wm),Gt.use(xg),Gt.use(Qa),Gt.use(Fe),Gt.use(ht),Gt.use(Lg),Gt.default=Gt,a(n)==="object"&&n)try{n.exports=Gt}catch{}return Gt.default=Gt,Gt})}(_i,_i.exports);var Gb=_i.exports,Qn=Io(Gb),Pt=u(function(){return Pt=Object.assign||u(function(e){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},"__assign"),Pt.apply(this,arguments)},"__assign");typeof SuppressedError=="function"&&SuppressedError,typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=u(function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),s},"CustomEvent")));var Hb=typeof document<"u"&&!!document.documentMode,Qo;function Vb(){return Qo||(Qo=document.createElement("div").style)}u(Vb,"createStyle");var Jc=["webkit","moz","ms"],Pi={};function er(n){if(Pi[n])return Pi[n];var e=Vb();if(n in e)return Pi[n]=n;for(var t=n[0].toUpperCase()+n.slice(1),s=Jc.length;s--;){var a="".concat(Jc[s]).concat(t);if(a in e)return Pi[n]=a}}u(er,"getPrefixedName");function Ii(n,e){return parseFloat(e[er(n)])||0}u(Ii,"getCSSNum");function Li(n,e,t){t===void 0&&(t=window.getComputedStyle(n));var s=e==="border"?"Width":"";return{left:Ii("".concat(e,"Left").concat(s),t),right:Ii("".concat(e,"Right").concat(s),t),top:Ii("".concat(e,"Top").concat(s),t),bottom:Ii("".concat(e,"Bottom").concat(s),t)}}u(Li,"getBoxStyle");function Bs(n,e,t){n.style[er(e)]=t}u(Bs,"setStyle");function Wb(n,e){var t=er("transform");Bs(n,"transition","".concat(t," ").concat(e.duration,"ms ").concat(e.easing))}u(Wb,"setTransition");function Kb(n,e,t){var s=e.x,a=e.y,o=e.scale,r=e.isSVG;if(Bs(n,"transform","scale(".concat(o,") translate(").concat(s,"px, ").concat(a,"px)")),r&&Hb){var i=window.getComputedStyle(n).getPropertyValue("transform");n.setAttribute("transform",i)}}u(Kb,"setTransform");function tr(n){var e=n.parentNode,t=window.getComputedStyle(n),s=window.getComputedStyle(e),a=n.getBoundingClientRect(),o=e.getBoundingClientRect();return{elem:{style:t,width:a.width,height:a.height,top:a.top,bottom:a.bottom,left:a.left,right:a.right,margin:Li(n,"margin",t),border:Li(n,"border",t)},parent:{style:s,width:o.width,height:o.height,top:o.top,bottom:o.bottom,left:o.left,right:o.right,padding:Li(e,"padding",s),border:Li(e,"border",s)}}}u(tr,"getDimensions");var xa={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};typeof window<"u"&&(typeof window.PointerEvent=="function"?xa={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:typeof window.TouchEvent=="function"&&(xa={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));function nr(n,e,t,s){xa[n].split(" ").forEach(function(a){e.addEventListener(a,t,s)})}u(nr,"onPointer");function sr(n,e,t){xa[n].split(" ").forEach(function(s){e.removeEventListener(s,t)})}u(sr,"destroyPointer");function Zc(n,e){for(var t=n.length;t--;)if(n[t].pointerId===e.pointerId)return t;return-1}u(Zc,"findEventIndex");function ar(n,e){var t;if(e.touches){t=0;for(var s=0,a=e.touches;s<a.length;s++){var o=a[s];o.pointerId=t++,ar(n,o)}return}t=Zc(n,e),t>-1&&n.splice(t,1),n.push(e)}u(ar,"addPointer");function Yb(n,e){if(e.touches){for(;n.length;)n.pop();return}var t=Zc(n,e);t>-1&&n.splice(t,1)}u(Yb,"removePointer");function Qc(n){n=n.slice(0);for(var e=n.pop(),t;t=n.pop();)e={clientX:(t.clientX-e.clientX)/2+e.clientX,clientY:(t.clientY-e.clientY)/2+e.clientY};return e}u(Qc,"getMiddle");function ir(n){if(n.length<2)return 0;var e=n[0],t=n[1];return Math.sqrt(Math.pow(Math.abs(t.clientX-e.clientX),2)+Math.pow(Math.abs(t.clientY-e.clientY),2))}u(ir,"getDistance");function Xb(n){for(var e=n;e&&e.parentNode;){if(e.parentNode===document)return!0;e=e.parentNode instanceof ShadowRoot?e.parentNode.host:e.parentNode}return!1}u(Xb,"isAttached");function Jb(n){return(n.getAttribute("class")||"").trim()}u(Jb,"getClass");function Zb(n,e){return n.nodeType===1&&" ".concat(Jb(n)," ").indexOf(" ".concat(e," "))>-1}u(Zb,"hasClass");function Qb(n,e){for(var t=n;t!=null;t=t.parentNode)if(Zb(t,e.excludeClass)||e.exclude.indexOf(t)>-1)return!0;return!1}u(Qb,"isExcluded");var ey=/^http:[\w\.\/]+svg$/;function ty(n){return ey.test(n.namespaceURI)&&n.nodeName.toLowerCase()!=="svg"}u(ty,"isSVGElement");function ny(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}u(ny,"shallowClone");var eu={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:function(n){n.preventDefault(),n.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,pinchAndPan:!1,relative:!1,setTransform:Kb,startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};function tu(n,e){if(!n)throw new Error("Panzoom requires an element as an argument");if(n.nodeType!==1)throw new Error("Panzoom requires an element with a nodeType of 1");if(!Xb(n))throw new Error("Panzoom should be called on elements that have been attached to the DOM");e=Pt(Pt({},eu),e);var t=ty(n),s=n.parentNode;s.style.overflow=e.overflow,s.style.userSelect="none",s.style.touchAction=e.touchAction,(e.canvas?s:n).style.cursor=e.cursor,n.style.userSelect="none",n.style.touchAction=e.touchAction,Bs(n,"transformOrigin",typeof e.origin=="string"?e.origin:t?"0 0":"50% 50%");function a(){s.style.overflow="",s.style.userSelect="",s.style.touchAction="",s.style.cursor="",n.style.cursor="",n.style.userSelect="",n.style.touchAction="",Bs(n,"transformOrigin","")}u(a,"resetStyle");function o(V){V===void 0&&(V={});for(var J in V)V.hasOwnProperty(J)&&(e[J]=V[J]);(V.hasOwnProperty("cursor")||V.hasOwnProperty("canvas"))&&(s.style.cursor=n.style.cursor="",(e.canvas?s:n).style.cursor=e.cursor),V.hasOwnProperty("overflow")&&(s.style.overflow=V.overflow),V.hasOwnProperty("touchAction")&&(s.style.touchAction=V.touchAction,n.style.touchAction=V.touchAction)}u(o,"setOptions");var r=0,i=0,d=1,c=!1;w(e.startScale,{animate:!1,force:!0}),setTimeout(function(){C(e.startX,e.startY,{animate:!1,force:!0})});function l(V,J,A){if(!A.silent){var j=new CustomEvent(V,{detail:J});n.dispatchEvent(j)}}u(l,"trigger");function m(V,J,A){var j={x:r,y:i,scale:d,isSVG:t,originalEvent:A};return requestAnimationFrame(function(){typeof J.animate=="boolean"&&(J.animate?Wb(n,J):Bs(n,"transition","none")),J.setTransform(n,j,J),l(V,j,J),l("panzoomchange",j,J)}),j}u(m,"setTransformWithEvent");function v(V,J,A,j){var S=Pt(Pt({},e),j),U={x:r,y:i,opts:S};if(!S.force&&(S.disablePan||S.panOnlyWhenZoomed&&d===S.startScale))return U;if(V=parseFloat(V),J=parseFloat(J),S.disableXAxis||(U.x=(S.relative?r:0)+V),S.disableYAxis||(U.y=(S.relative?i:0)+J),S.contain){var G=tr(n),Y=G.elem.width/d,se=G.elem.height/d,le=Y*A,ne=se*A,he=(le-Y)/2,pe=(ne-se)/2;if(S.contain==="inside"){var fe=(-G.elem.margin.left-G.parent.padding.left+he)/A,me=(G.parent.width-le-G.parent.padding.left-G.elem.margin.left-G.parent.border.left-G.parent.border.right+he)/A;U.x=Math.max(Math.min(U.x,me),fe);var we=(-G.elem.margin.top-G.parent.padding.top+pe)/A,_e=(G.parent.height-ne-G.parent.padding.top-G.elem.margin.top-G.parent.border.top-G.parent.border.bottom+pe)/A;U.y=Math.max(Math.min(U.y,_e),we)}else if(S.contain==="outside"){var fe=(-(le-G.parent.width)-G.parent.padding.left-G.parent.border.left-G.parent.border.right+he)/A,me=(he-G.parent.padding.left)/A;U.x=Math.max(Math.min(U.x,me),fe);var we=(-(ne-G.parent.height)-G.parent.padding.top-G.parent.border.top-G.parent.border.bottom+pe)/A,_e=(pe-G.parent.padding.top)/A;U.y=Math.max(Math.min(U.y,_e),we)}}return S.roundPixels&&(U.x=Math.round(U.x),U.y=Math.round(U.y)),U}u(v,"constrainXY");function x(V,J){var A=Pt(Pt({},e),J),j={scale:d,opts:A};if(!A.force&&A.disableZoom)return j;var S=e.minScale,U=e.maxScale;if(A.contain){var G=tr(n),Y=G.elem.width/d,se=G.elem.height/d;if(Y>1&&se>1){var le=G.parent.width-G.parent.border.left-G.parent.border.right,ne=G.parent.height-G.parent.border.top-G.parent.border.bottom,he=le/Y,pe=ne/se;e.contain==="inside"?U=Math.min(U,he,pe):e.contain==="outside"&&(S=Math.max(S,he,pe))}}return j.scale=Math.min(Math.max(V,S),U),j}u(x,"constrainScale");function C(V,J,A,j){var S=v(V,J,d,A);return r!==S.x||i!==S.y?(r=S.x,i=S.y,m("panzoompan",S.opts,j)):{x:r,y:i,scale:d,isSVG:t,originalEvent:j}}u(C,"pan");function w(V,J,A){var j=x(V,J),S=j.opts;if(!(!S.force&&S.disableZoom)){V=j.scale;var U=r,G=i;if(S.focal){var Y=S.focal;U=(Y.x/V-Y.x/d+r*V)/V,G=(Y.y/V-Y.y/d+i*V)/V}var se=v(U,G,V,{relative:!1,force:!0});return r=se.x,i=se.y,d=V,m("panzoomzoom",S,A)}}u(w,"zoom");function f(V,J){var A=Pt(Pt(Pt({},e),{animate:!0}),J);return w(d*Math.exp((V?1:-1)*A.step),A)}u(f,"zoomInOut");function T(V){return f(!0,V)}u(T,"zoomIn");function k(V){return f(!1,V)}u(k,"zoomOut");function F(V,J,A,j){var S=tr(n),U={width:S.parent.width-S.parent.padding.left-S.parent.padding.right-S.parent.border.left-S.parent.border.right,height:S.parent.height-S.parent.padding.top-S.parent.padding.bottom-S.parent.border.top-S.parent.border.bottom},G=J.clientX-S.parent.left-S.parent.padding.left-S.parent.border.left-S.elem.margin.left,Y=J.clientY-S.parent.top-S.parent.padding.top-S.parent.border.top-S.elem.margin.top;t||(G-=S.elem.width/d/2,Y-=S.elem.height/d/2);var se={x:G/U.width*(U.width*V),y:Y/U.height*(U.height*V)};return w(V,Pt(Pt({},A),{animate:!1,focal:se}),j)}u(F,"zoomToPoint");function O(V,J){V.preventDefault();var A=Pt(Pt(Pt({},e),J),{animate:!1}),j=V.deltaY===0&&V.deltaX?V.deltaX:V.deltaY,S=j<0?1:-1,U=x(d*Math.exp(S*A.step/3),A).scale;return F(U,V,A,V)}u(O,"zoomWithWheel");function _(V){var J=Pt(Pt(Pt({},e),{animate:!0,force:!0}),V);d=x(J.startScale,J).scale;var A=v(J.startX,J.startY,d,J);return r=A.x,i=A.y,m("panzoomreset",J)}u(_,"reset");var M,b,P,L,N,z,I=[];function W(V){if(!Qb(V.target,e)){ar(I,V),c=!0,e.handleStartEvent(V),M=r,b=i,l("panzoomstart",{x:r,y:i,scale:d,isSVG:t,originalEvent:V},e);var J=Qc(I);P=J.clientX,L=J.clientY,N=d,z=ir(I)}}u(W,"handleDown");function B(V){if(!(!c||M===void 0||b===void 0||P===void 0||L===void 0)){ar(I,V);var J=Qc(I),A=I.length>1,j=d;if(A){z===0&&(z=ir(I));var S=ir(I)-z;j=x(S*e.step/80+N).scale,F(j,J,{animate:!1},V)}(!A||e.pinchAndPan)&&C(M+(J.clientX-P)/j,b+(J.clientY-L)/j,{animate:!1},V)}}u(B,"handleMove");function K(V){I.length===1&&l("panzoomend",{x:r,y:i,scale:d,isSVG:t,originalEvent:V},e),Yb(I,V),c&&(c=!1,M=b=P=L=void 0)}u(K,"handleUp");var q=!1;function X(){q||(q=!0,nr("down",e.canvas?s:n,W),nr("move",document,B,{passive:!0}),nr("up",document,K,{passive:!0}))}u(X,"bind");function Q(){q=!1,sr("down",e.canvas?s:n,W),sr("move",document,B),sr("up",document,K)}return u(Q,"destroy"),e.noBind||X(),{bind:X,destroy:Q,eventNames:xa,getPan:function(){return{x:r,y:i}},getScale:function(){return d},getOptions:function(){return ny(e)},handleDown:W,handleMove:B,handleUp:K,pan:C,reset:_,resetStyle:a,setOptions:o,setStyle:function(V,J){return Bs(n,V,J)},zoom:w,zoomIn:T,zoomOut:k,zoomToPoint:F,zoomWithWheel:O}}u(tu,"Panzoom"),tu.defaultOptions=eu;var nu={};(function(n){(function(){typeof Math.sgn>"u"&&(Math.sgn=function(q){return q==0?0:q>0?1:-1});var e={subtract:function(q,X){return{x:q.x-X.x,y:q.y-X.y}},dotProduct:function(q,X){return q.x*X.x+q.y*X.y},square:function(q){return Math.sqrt(q.x*q.x+q.y*q.y)},scale:function(q,X){return{x:q.x*X,y:q.y*X}}},t=64,s=Math.pow(2,-t-1),a=u(function(q,X){for(var Q=[],V=r(q,X),J=X.length-1,A=2*J-1,j=i(V,A,Q,0),S=e.subtract(q,X[0]),U=e.square(S),G=0,Y=0;Y<j;Y++){S=e.subtract(q,m(X,J,Q[Y],null,null));var se=e.square(S);se<U&&(U=se,G=Q[Y])}return S=e.subtract(q,X[J]),se=e.square(S),se<U&&(U=se,G=1),{location:G,distance:U}},"_distanceFromCurve"),o=u(function(q,X){var Q=a(q,X);return{point:m(X,X.length-1,Q.location,null,null),location:Q.location}},"_nearestPointOnCurve"),r=u(function(q,X){for(var Q=X.length-1,V=2*Q-1,J=[],A=[],j=[],S=[],U=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],G=0;G<=Q;G++)J[G]=e.subtract(X[G],q);for(var G=0;G<=Q-1;G++)A[G]=e.subtract(X[G+1],X[G]),A[G]=e.scale(A[G],3);for(var Y=0;Y<=Q-1;Y++)for(var se=0;se<=Q;se++)j[Y]||(j[Y]=[]),j[Y][se]=e.dotProduct(A[Y],J[se]);for(G=0;G<=V;G++)S[G]||(S[G]=[]),S[G].y=0,S[G].x=parseFloat(G)/V;for(var le=Q,ne=Q-1,he=0;he<=le+ne;he++){var pe=Math.max(0,he-ne),fe=Math.min(he,le);for(G=pe;G<=fe;G++){var me=he-G;S[G+me].y+=j[me][G]*U[me][G]}}return S},"_convertToBezier"),i=u(function(q,X,Q,V){var J=[],A=[],j,S,U=[],G=[];switch(d(q,X)){case 0:return 0;case 1:{if(V>=t)return Q[0]=(q[0].x+q[X].x)/2,1;if(c(q,X))return Q[0]=l(q,X),1;break}}m(q,X,.5,J,A),j=i(J,X,U,V+1),S=i(A,X,G,V+1);for(var Y=0;Y<j;Y++)Q[Y]=U[Y];for(var Y=0;Y<S;Y++)Q[Y+j]=G[Y];return j+S},"_findRoots"),d=u(function(q,X){var Q=0,V,J;V=J=Math.sgn(q[0].y);for(var A=1;A<=X;A++)V=Math.sgn(q[A].y),V!=J&&Q++,J=V;return Q},"_getCrossingCount"),c=u(function(q,X){var Q,V,J,A,j,S,U,G,Y,se,le,ne,he,pe,fe,me;S=q[0].y-q[X].y,U=q[X].x-q[0].x,G=q[0].x*q[X].y-q[X].x*q[0].y;var we,_e;we=_e=0;for(var je=1;je<X;je++){var Pe=S*q[je].x+U*q[je].y+G;Pe>we?we=Pe:Pe<_e&&(_e=Pe)}return le=0,ne=1,he=0,pe=S,fe=U,me=G-we,Y=le*fe-pe*ne,se=1/Y,V=(ne*me-fe*he)*se,pe=S,fe=U,me=G-_e,Y=le*fe-pe*ne,se=1/Y,J=(ne*me-fe*he)*se,A=Math.min(V,J),j=Math.max(V,J),Q=j-A,Q<s?1:0},"_isFlatEnough"),l=u(function(q,X){var Q=1,V=0,J=q[X].x-q[0].x,A=q[X].y-q[0].y,j=q[0].x-0,S=q[0].y-0,U=J*V-A*Q,G=1/U,Y=(J*S-A*j)*G;return 0+Q*Y},"_computeXIntercept"),m=u(function(q,X,Q,V,J){for(var A=[[]],j=0;j<=X;j++)A[0][j]=q[j];for(var S=1;S<=X;S++)for(var j=0;j<=X-S;j++)A[S]||(A[S]=[]),A[S][j]||(A[S][j]={}),A[S][j].x=(1-Q)*A[S-1][j].x+Q*A[S-1][j+1].x,A[S][j].y=(1-Q)*A[S-1][j].y+Q*A[S-1][j+1].y;if(V!=null)for(j=0;j<=X;j++)V[j]=A[j][0];if(J!=null)for(j=0;j<=X;j++)J[j]=A[X-j][j];return A[X][0]},"_bezier"),v={},x=u(function(q){var X=v[q];if(!X){X=[];var Q=u(function(){return function(se){return Math.pow(se,q)}},"f_term"),V=u(function(){return function(se){return Math.pow(1-se,q)}},"l_term"),J=u(function(se){return function(le){return se}},"c_term"),A=u(function(){return function(se){return se}},"t_term"),j=u(function(){return function(se){return 1-se}},"one_minus_t_term"),S=u(function(se){return function(le){for(var ne=1,he=0;he<se.length;he++)ne=ne*se[he](le);return ne}},"_termFunc");X.push(new Q);for(var U=1;U<q;U++){for(var G=[new J(q)],Y=0;Y<q-U;Y++)G.push(new A);for(var Y=0;Y<U;Y++)G.push(new j);X.push(new S(G))}X.push(new V),v[q]=X}return X},"_getCurveFunctions"),C=u(function(q,X){for(var Q=x(q.length-1),V=0,J=0,A=0;A<q.length;A++)V=V+q[A].x*Q[A](X),J=J+q[A].y*Q[A](X);return{x:V,y:J}},"_pointOnPath"),w=u(function(q,X){return Math.sqrt(Math.pow(q.x-X.x,2)+Math.pow(q.y-X.y,2))},"_dist"),f=u(function(q){return q[0].x===q[1].x&&q[0].y===q[1].y},"_isPoint"),T=u(function(q,X,Q){if(f(q))return{point:q[0],location:X};for(var V=C(q,X),J=0,A=X,j=Q>0?1:-1,S=null;J<Math.abs(Q);)A+=.005*j,S=C(q,A),J+=w(S,V),V=S;return{point:S,location:A}},"_pointAlongPath"),k=u(function(q){var X=new Date().getTime();if(f(q))return 0;for(var Q=C(q,0),V=0,J=0,A=1,j=null;J<1;)J+=.005*A,j=C(q,J),V+=w(j,Q),Q=j;return console.log("length",new Date().getTime()-X),V},"_length"),F=u(function(q,X,Q){return T(q,X,Q).point},"_pointAlongPathFrom"),O=u(function(q,X,Q){return T(q,X,Q).location},"_locationAlongPathFrom"),_=u(function(q,X){var Q=C(q,X),V=C(q.slice(0,q.length-1),X),J=V.y-Q.y,A=V.x-Q.x;return J===0?1/0:Math.atan(J/A)},"_gradientAtPoint"),M=u(function(q,X,Q){var V=T(q,X,Q);return V.location>1&&(V.location=1),V.location<0&&(V.location=0),_(q,V.location)},"_gradientAtPointAlongPathFrom"),b=u(function(q,X,Q,V){V=V??0;var J=T(q,X,V),A=_(q,J.location),j=Math.atan(-1/A),S=Q/2*Math.sin(j),U=Q/2*Math.cos(j);return[{x:J.point.x+U,y:J.point.y+S},{x:J.point.x-U,y:J.point.y-S}]},"_perpendicularToPathAt"),P=u(function(q,X,Q,V,J){var A=V-X,j=q-Q,S=q*(X-V)+X*(Q-q),U=I(J),G=[A*U[0][0]+j*U[1][0],A*U[0][1]+j*U[1][1],A*U[0][2]+j*U[1][2],A*U[0][3]+j*U[1][3]+S],Y=B.apply(null,G),se=[];if(Y!=null)for(var le=0;le<3;le++){var ne=Y[le],he=Math.pow(ne,2),pe=Math.pow(ne,3),fe=[U[0][0]*pe+U[0][1]*he+U[0][2]*ne+U[0][3],U[1][0]*pe+U[1][1]*he+U[1][2]*ne+U[1][3]],me;Q-q!==0?me=(fe[0]-q)/(Q-q):me=(fe[1]-X)/(V-X),ne>=0&&ne<=1&&me>=0&&me<=1&&se.push(fe)}return se},"_lineIntersection"),L=u(function(q,X,Q,V,J){var A=[];return A.push.apply(A,P(q,X,q+Q,X,J)),A.push.apply(A,P(q+Q,X,q+Q,X+V,J)),A.push.apply(A,P(q+Q,X+V,q,X+V,J)),A.push.apply(A,P(q,X+V,q,X,J)),A},"_boxIntersection"),N=u(function(q,X){var Q=[];return Q.push.apply(Q,P(q.x,q.y,q.x+q.w,q.y,X)),Q.push.apply(Q,P(q.x+q.w,q.y,q.x+q.w,q.y+q.h,X)),Q.push.apply(Q,P(q.x+q.w,q.y+q.h,q.x,q.y+q.h,X)),Q.push.apply(Q,P(q.x,q.y+q.h,q.x,q.y,X)),Q},"_boundingBoxIntersection");function z(q,X){return[-q[0][X]+3*q[1][X]+-3*q[2][X]+q[3][X],3*q[0][X]-6*q[1][X]+3*q[2][X],-3*q[0][X]+3*q[1][X],q[0][X]]}u(z,"_computeCoefficientsForAxis");function I(q){return[z(q,"x"),z(q,"y")]}u(I,"_computeCoefficients");function W(q){return q<0?-1:q>0?1:0}u(W,"sgn");function B(q,X,Q,V){var J=X/q,A=Q/q,j=V/q,S=(3*A-Math.pow(J,2))/9,U=(9*J*A-27*j-2*Math.pow(J,3))/54,G=Math.pow(S,3)+Math.pow(U,2),Y,se,le=[];if(G>=0)Y=W(U+Math.sqrt(G))*Math.pow(Math.abs(U+Math.sqrt(G)),1/3),se=W(U-Math.sqrt(G))*Math.pow(Math.abs(U-Math.sqrt(G)),1/3),le[0]=-J/3+(Y+se),le[1]=-J/3-(Y+se)/2,le[2]=-J/3-(Y+se)/2,Math.abs(Math.sqrt(3)*(Y-se)/2)!==0&&(le[1]=-1,le[2]=-1);else{var ne=Math.acos(U/Math.sqrt(-Math.pow(S,3)));le[0]=2*Math.sqrt(-S)*Math.cos(ne/3)-J/3,le[1]=2*Math.sqrt(-S)*Math.cos((ne+2*Math.PI)/3)-J/3,le[2]=2*Math.sqrt(-S)*Math.cos((ne+4*Math.PI)/3)-J/3}for(var he=0;he<3;he++)(le[he]<0||le[he]>1)&&(le[he]=-1);return le}u(B,"_cubicRoots");var K=this.jsBezier={distanceFromCurve:a,gradientAtPoint:_,gradientAtPointAlongCurveFrom:M,nearestPointOnCurve:o,pointOnCurve:C,pointAlongCurveFrom:F,perpendicularToCurveAt:b,locationAlongCurveFrom:O,getLength:k,lineIntersection:P,boxIntersection:L,boundingBoxIntersection:N,version:"0.9.0"};n.jsBezier=K}).call(typeof window<"u"?window:mt),function(){var e=this,t=e.Biltong={version:"0.4.0"};n.Biltong=t;var s=u(function(c){return Object.prototype.toString.call(c)==="[object Array]"},"_isa"),a=u(function(c,l,m){return c=s(c)?c:[c.x,c.y],l=s(l)?l:[l.x,l.y],m(c,l)},"_pointHelper"),o=t.gradient=function(c,l){return a(c,l,function(m,v){return v[0]==m[0]?v[1]>m[1]?1/0:-1/0:v[1]==m[1]?v[0]>m[0]?0:-0:(v[1]-m[1])/(v[0]-m[0])})};t.normal=function(c,l){return-1/o(c,l)},t.lineLength=function(c,l){return a(c,l,function(m,v){return Math.sqrt(Math.pow(v[1]-m[1],2)+Math.pow(v[0]-m[0],2))})};var r=t.quadrant=function(c,l){return a(c,l,function(m,v){return v[0]>m[0]||v[0]==m[0]?v[1]>m[1]?2:1:v[1]>m[1]?3:4})};t.theta=function(c,l){return a(c,l,function(m,v){var x=o(m,v),C=Math.atan(x),w=r(m,v);return(w==4||w==3)&&(C+=Math.PI),C<0&&(C+=2*Math.PI),C})},t.intersects=function(c,l){var m=c.x,v=c.x+c.w,x=c.y,C=c.y+c.h,w=l.x,f=l.x+l.w,T=l.y,k=l.y+l.h;return m<=w&&w<=v&&x<=T&&T<=C||m<=f&&f<=v&&x<=T&&T<=C||m<=w&&w<=v&&x<=k&&k<=C||m<=f&&w<=v&&x<=k&&k<=C||w<=m&&m<=f&&T<=x&&x<=k||w<=v&&v<=f&&T<=x&&x<=k||w<=m&&m<=f&&T<=C&&C<=k||w<=v&&m<=f&&T<=C&&C<=k},t.encloses=function(c,l,m){var v=c.x,x=c.x+c.w,C=c.y,w=c.y+c.h,f=l.x,T=l.x+l.w,k=l.y,F=l.y+l.h,O=u(function(_,M,b,P){return m?_<=M&&b>=P:_<M&&b>P},"c");return O(v,f,x,T)&&O(C,k,w,F)};var i=[null,[1,-1],[1,1],[-1,1],[-1,-1]],d=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(c,l,m){var v=o(c,l),x=r(c,l),C=m>0?i[x]:d[x],w=Math.atan(v),f=Math.abs(m*Math.sin(w))*C[1],T=Math.abs(m*Math.cos(w))*C[0];return{x:c.x+T,y:c.y+f}},t.perpendicularLineTo=function(c,l,m){var v=o(c,l),x=Math.atan(-1/v),C=m/2*Math.sin(x),w=m/2*Math.cos(x);return[{x:l.x+w,y:l.y+C},{x:l.x-w,y:l.y-C}]}}.call(typeof window<"u"?window:mt),function(){function e(A,j,S,U,G,Y,se,le){return new Touch({target:j,identifier:J(),pageX:S,pageY:U,screenX:G,screenY:Y,clientX:se||G,clientY:le||Y})}u(e,"_touch");function t(){var A=[];return Array.prototype.push.apply(A,arguments),A.item=function(j){return this[j]},A}u(t,"_touchList");function s(A,j,S,U,G,Y,se,le){return t(e.apply(null,arguments))}u(s,"_touchAndList");var a=this,o=u(function(A,j,S){S=S||A.parentNode;for(var U=S.querySelectorAll(j),G=0;G<U.length;G++)if(U[G]===A)return!0;return!1},"matchesSelector"),r=u(function(A){return typeof A=="string"||A.constructor===String?document.getElementById(A):A},"_gel"),i=u(function(A){return A.srcElement||A.target},"_t"),d=u(function(A,j,S,U){if(U){if(typeof A.path<"u"&&A.path.indexOf)return{path:A.path,end:A.path.indexOf(S)};var G={path:[],end:-1},Y=u(function(se){G.path.push(se),se===S?G.end=G.path.length-1:se.parentNode!=null&&Y(se.parentNode)},"_one");return Y(j),G}else return{path:[j],end:1}},"_pi"),c=u(function(A,j){for(var S=0,U=A.length;S<U&&A[S]!=j;S++);S<A.length&&A.splice(S,1)},"_d"),l=1,m=u(function(A,j,S){var U=l++;return A.__ta=A.__ta||{},A.__ta[j]=A.__ta[j]||{},A.__ta[j][U]=S,S.__tauid=U,U},"_store"),v=u(function(A,j,S){if(A.__ta&&A.__ta[j]&&delete A.__ta[j][S.__tauid],S.__taExtra){for(var U=0;U<S.__taExtra.length;U++)Q(A,S.__taExtra[U][0],S.__taExtra[U][1]);S.__taExtra.length=0}S.__taUnstore&&S.__taUnstore()},"_unstore"),x=u(function(A,j,S,U){if(A==null)return S;var G=A.split(","),Y=u(function(se){Y.__tauid=S.__tauid;var le=i(se),ne=le,he=d(se,le,j,A!=null);if(he.end!=-1)for(var pe=0;pe<he.end;pe++){ne=he.path[pe];for(var fe=0;fe<G.length;fe++)o(ne,G[fe],j)&&S.apply(ne,arguments)}},"_fn");return C(S,U,Y),Y},"_curryChildFilter"),C=u(function(A,j,S){A.__taExtra=A.__taExtra||[],A.__taExtra.push([j,S])},"registerExtraFunction"),w=u(function(A,j,S,U){if(_&&b[j]){var G=x(U,A,S,b[j]);X(A,b[j],G,S)}j==="focus"&&A.getAttribute("tabindex")==null&&A.setAttribute("tabindex","1"),X(A,j,x(U,A,S,j),S)},"DefaultHandler"),f=u(function(A,j,S,U){if(A.__taSmartClicks==null){var G=u(function(le){A.__tad=z(le)},"down"),Y=u(function(le){A.__tau=z(le)},"up"),se=u(function(le){if(A.__tad&&A.__tau&&A.__tad[0]===A.__tau[0]&&A.__tad[1]===A.__tau[1])for(var ne=0;ne<A.__taSmartClicks.length;ne++)A.__taSmartClicks[ne].apply(i(le),[le])},"click");w(A,"mousedown",G,U),w(A,"mouseup",Y,U),w(A,"click",se,U),A.__taSmartClicks=[]}A.__taSmartClicks.push(S),S.__taUnstore=function(){c(A.__taSmartClicks,S)}},"SmartClickHandler"),T={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},k=u(function(A,j){return function(S,U,G,Y){if(U=="contextmenu"&&M)w(S,U,G,Y);else{if(S.__taTapHandler==null){var se=S.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},le=u(function(fe){for(var me=i(fe),we=d(fe,me,S,Y!=null),_e=!1,je=0;je<we.end;je++){if(_e)return;me=we.path[je];for(var Pe=0;Pe<se.downSelectors.length;Pe++)if(se.downSelectors[Pe]==null||o(me,se.downSelectors[Pe],S)){se.down=!0,setTimeout(he,A),setTimeout(pe,j),_e=!0;break}}},"down"),ne=u(function(fe){if(se.down){var me=i(fe),we,_e;se.taps++;var je=q(fe);for(var Pe in T)if(T.hasOwnProperty(Pe)){var qe=T[Pe];if(qe.touches===je&&(qe.taps===1||qe.taps===se.taps))for(var Me=0;Me<se[Pe].length;Me++){_e=d(fe,me,S,se[Pe][Me][1]!=null);for(var ye=0;ye<_e.end;ye++)if(we=_e.path[ye],se[Pe][Me][1]==null||o(we,se[Pe][Me][1],S)){se[Pe][Me][0].apply(we,[fe]);break}}}}},"up"),he=u(function(){se.down=!1},"clearSingle"),pe=u(function(){se.taps=0},"clearDouble");w(S,"mousedown",le),w(S,"mouseup",ne)}S.__taTapHandler.downSelectors.push(Y),S.__taTapHandler[U].push([G,Y]),G.__taUnstore=function(){c(S.__taTapHandler[U],G)}}}},"TapHandler"),F=u(function(A,j,S,U){for(var G in S.__tamee[A])S.__tamee[A].hasOwnProperty(G)&&S.__tamee[A][G].apply(U,[j])},"meeHelper"),O=u(function(){var A=[];return function(j,S,U,G){if(!j.__tamee){j.__tamee={over:!1,mouseenter:[],mouseexit:[]};var Y=u(function(le){var ne=i(le);(G==null&&ne==j&&!j.__tamee.over||o(ne,G,j)&&(ne.__tamee==null||!ne.__tamee.over))&&(F("mouseenter",le,j,ne),ne.__tamee=ne.__tamee||{},ne.__tamee.over=!0,A.push(ne))},"over"),se=u(function(le){for(var ne=i(le),he=0;he<A.length;he++)ne==A[he]&&!o(le.relatedTarget||le.toElement,"*",ne)&&(ne.__tamee.over=!1,A.splice(he,1),F("mouseexit",le,j,ne))},"out");X(j,"mouseover",x(G,j,Y,"mouseover"),Y),X(j,"mouseout",x(G,j,se,"mouseout"),se)}U.__taUnstore=function(){delete j.__tamee[S][U.__tauid]},m(j,S,U),j.__tamee[S][U.__tauid]=U}},"MouseEnterExitHandler"),_="ontouchstart"in document.documentElement||navigator.maxTouchPoints,M="onmousedown"in document.documentElement,b={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},P=function(){var A=-1;if(navigator.appName=="Microsoft Internet Explorer"){var j=navigator.userAgent,S=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");S.exec(j)!=null&&(A=parseFloat(RegExp.$1))}return A}(),L=P>-1&&P<9,N=u(function(A,j){if(A==null)return[0,0];var S=K(A),U=B(S,0);return[U[j+"X"],U[j+"Y"]]},"_genLoc"),z=u(function(A){return A==null?[0,0]:L?[A.clientX+document.documentElement.scrollLeft,A.clientY+document.documentElement.scrollTop]:N(A,"page")},"_pageLocation"),I=u(function(A){return N(A,"screen")},"_screenLocation"),W=u(function(A){return N(A,"client")},"_clientLocation"),B=u(function(A,j){return A.item?A.item(j):A[j]},"_getTouch"),K=u(function(A){return A.touches&&A.touches.length>0?A.touches:A.changedTouches&&A.changedTouches.length>0?A.changedTouches:A.targetTouches&&A.targetTouches.length>0?A.targetTouches:[A]},"_touches"),q=u(function(A){return K(A).length},"_touchCount"),X=u(function(A,j,S,U){if(m(A,j,S),U.__tauid=S.__tauid,A.addEventListener)A.addEventListener(j,S,!1);else if(A.attachEvent){var G=j+S.__tauid;A["e"+G]=S,A[G]=function(){A["e"+G]&&A["e"+G](window.event)},A.attachEvent("on"+j,A[G])}},"_bind"),Q=u(function(A,j,S){S!=null&&V(A,function(){var U=r(this);if(v(U,j,S),S.__tauid!=null){if(U.removeEventListener)U.removeEventListener(j,S,!1),_&&b[j]&&U.removeEventListener(b[j],S,!1);else if(this.detachEvent){var G=j+S.__tauid;U[G]&&U.detachEvent("on"+j,U[G]),U[G]=null,U["e"+G]=null}}S.__taTouchProxy&&Q(A,S.__taTouchProxy[1],S.__taTouchProxy[0])})},"_unbind"),V=u(function(A,j){if(A!=null){A=typeof Window<"u"&&typeof A.top!="unknown"&&A==A.top?[A]:typeof A!="string"&&A.tagName==null&&A.length!=null?A:typeof A=="string"?document.querySelectorAll(A):[A];for(var S=0;S<A.length;S++)j.apply(A[S])}},"_each"),J=u(function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(A){var j=Math.random()*16|0,S=A=="x"?j:j&3|8;return S.toString(16)})},"_uuid");a.Mottle=function(A){A=A||{};var j=A.clickThreshold||250,S=A.dblClickThreshold||450,U=new O,G=new k(j,S),Y=A.smartClicks,se=u(function(le,ne,he,pe){he!=null&&V(le,function(){var fe=r(this);Y&&ne==="click"?f(fe,ne,he,pe):ne==="tap"||ne==="dbltap"||ne==="contextmenu"?G(fe,ne,he,pe):ne==="mouseenter"||ne=="mouseexit"?U(fe,ne,he,pe):w(fe,ne,he,pe)})},"_doBind");this.remove=function(le){return V(le,function(){var ne=r(this);if(ne.__ta){for(var he in ne.__ta)if(ne.__ta.hasOwnProperty(he))for(var pe in ne.__ta[he])ne.__ta[he].hasOwnProperty(pe)&&Q(ne,he,ne.__ta[he][pe])}ne.parentNode&&ne.parentNode.removeChild(ne)}),this},this.on=function(le,ne,he,pe){var fe=arguments[0],me=arguments.length==4?arguments[2]:null,we=arguments[1],_e=arguments[arguments.length-1];return se(fe,we,_e,me),this},this.off=function(le,ne,he){return Q(le,ne,he),this},this.trigger=function(le,ne,he,pe){var fe=M&&(typeof MouseEvent>"u"||he==null||he.constructor===MouseEvent),me=_&&!M&&b[ne]?b[ne]:ne,we=!(_&&!M&&b[ne]),_e=z(he),je=I(he),Pe=W(he);return V(le,function(){var qe=r(this),Me;he=he||{screenX:je[0],screenY:je[1],clientX:Pe[0],clientY:Pe[1]};var ye=u(function(Ne){pe&&(Ne.payload=pe)},"_decorate"),be={TouchEvent:function(Ne){var Xe=s(window,qe,0,_e[0],_e[1],je[0],je[1],Pe[0],Pe[1]),rt=Ne.initTouchEvent||Ne.initEvent;rt(me,!0,!0,window,null,je[0],je[1],Pe[0],Pe[1],!1,!1,!1,!1,Xe,Xe,Xe,1,0)},MouseEvents:function(Ne){Ne.initMouseEvent(me,!0,!0,window,0,je[0],je[1],Pe[0],Pe[1],!1,!1,!1,!1,1,qe)}};if(document.createEvent){var Ae=!we&&!fe&&_&&b[ne],xe=Ae?"TouchEvent":"MouseEvents";Me=document.createEvent(xe),be[xe](Me),ye(Me),qe.dispatchEvent(Me)}else document.createEventObject&&(Me=document.createEventObject(),Me.eventType=Me.eventName=me,Me.screenX=je[0],Me.screenY=je[1],Me.clientX=Pe[0],Me.clientY=Pe[1],ye(Me),qe.fireEvent("on"+me,Me))}),this}},a.Mottle.consume=function(A,j){A.stopPropagation?A.stopPropagation():A.returnValue=!1,!j&&A.preventDefault&&A.preventDefault()},a.Mottle.pageLocation=z,a.Mottle.setForceTouchEvents=function(A){_=A},a.Mottle.setForceMouseEvents=function(A){M=A},a.Mottle.version="0.8.0",n.Mottle=a.Mottle}.call(typeof window>"u"?mt:window),function(){var e=this,t=u(function(A,j,S){return A.indexOf(j)===-1?(S?A.unshift(j):A.push(j),!0):!1},"_suggest"),s=u(function(A,j){var S=A.indexOf(j);S!==-1&&A.splice(S,1)},"_vanquish"),a=u(function(A,j){for(var S=[],U=0;U<A.length;U++)j.indexOf(A[U])===-1&&S.push(A[U]);return S},"_difference"),o=u(function(A){return A==null?!1:typeof A=="string"||A.constructor===String},"_isString"),r=u(function(A){var j=A.getBoundingClientRect(),S=document.body,U=document.documentElement,G=window.pageYOffset||U.scrollTop||S.scrollTop,Y=window.pageXOffset||U.scrollLeft||S.scrollLeft,se=U.clientTop||S.clientTop||0,le=U.clientLeft||S.clientLeft||0,ne=j.top+G-se,he=j.left+Y-le;return{top:Math.round(ne),left:Math.round(he)}},"getOffsetRect"),i=u(function(A,j,S){S=S||A.parentNode;for(var U=S.querySelectorAll(j),G=0;G<U.length;G++)if(U[G]===A)return!0;return!1},"matchesSelector"),d=u(function(A,j,S){if(i(j,S,A))return j;for(var U=j.parentNode;U!=null&&U!==A;){if(i(U,S,A))return U;U=U.parentNode}},"findDelegateElement"),c=u(function(A,j,S){for(var U=null,G=j.getAttribute("katavorio-draggable"),Y=G!=null?"[katavorio-draggable='"+G+"'] ":"",se=0;se<A.length;se++)if(U=d(j,S,Y+A[se].selector),U!=null){if(A[se].filter){var le=i(S,A[se].filter,U),ne=A[se].filterExclude===!0;if(ne&&!le||le)return null}return[A[se],U]}return null},"findMatchingSelector"),l=function(){var A=-1;if(navigator.appName==="Microsoft Internet Explorer"){var j=navigator.userAgent,S=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");S.exec(j)!=null&&(A=parseFloat(RegExp.$1))}return A}(),m=10,v=10,x=l>-1&&l<9,C=l===9,w=u(function(A){if(x)return[A.clientX+document.documentElement.scrollLeft,A.clientY+document.documentElement.scrollTop];var j=T(A),S=f(j,0);return C?[S.pageX||S.clientX,S.pageY||S.clientY]:[S.pageX,S.pageY]},"_pl"),f=u(function(A,j){return A.item?A.item(j):A[j]},"_getTouch"),T=u(function(A){return A.touches&&A.touches.length>0?A.touches:A.changedTouches&&A.changedTouches.length>0?A.changedTouches:A.targetTouches&&A.targetTouches.length>0?A.targetTouches:[A]},"_touches"),k={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},F="katavorio-drag-scope",O=["stop","start","drag","drop","over","out","beforeStart"],_=u(function(){},"_devNull"),M=u(function(){return!0},"_true"),b=u(function(A,j,S){for(var U=0;U<A.length;U++)A[U]!=S&&j(A[U])},"_foreach"),P=u(function(A,j,S,U){b(A,function(G){G.setActive(j),j&&G.updatePosition(),S&&G.setHover(U,j)})},"_setDroppablesActive"),L=u(function(A,j){if(A!=null){A=!o(A)&&A.tagName==null&&A.length!=null?A:[A];for(var S=0;S<A.length;S++)j.apply(A[S],[A[S]])}},"_each"),N=u(function(A){A.stopPropagation?(A.stopPropagation(),A.preventDefault()):A.returnValue=!1},"_consume"),z="input,textarea,select,button,option",I=u(function(A,j,S){var U=A.srcElement||A.target;return!i(U,S.getInputFilterSelector(),j)},"_inputFilter"),W=u(function(A,j,S,U){this.params=j||{},this.el=A,this.params.addClass(this.el,this._class),this.uuid=Q();var G=!0;return this.setEnabled=function(Y){G=Y},this.isEnabled=function(){return G},this.toggleEnabled=function(){G=!G},this.setScope=function(Y){this.scopes=Y?Y.split(/\s+/):[U]},this.addScope=function(Y){var se={};L(this.scopes,function(ne){se[ne]=!0}),L(Y?Y.split(/\s+/):[],function(ne){se[ne]=!0}),this.scopes=[];for(var le in se)this.scopes.push(le)},this.removeScope=function(Y){var se={};L(this.scopes,function(ne){se[ne]=!0}),L(Y?Y.split(/\s+/):[],function(ne){delete se[ne]}),this.scopes=[];for(var le in se)this.scopes.push(le)},this.toggleScope=function(Y){var se={};L(this.scopes,function(ne){se[ne]=!0}),L(Y?Y.split(/\s+/):[],function(ne){se[ne]?delete se[ne]:se[ne]=!0}),this.scopes=[];for(var le in se)this.scopes.push(le)},this.setScope(j.scope),this.k=j.katavorio,j.katavorio},"Super"),B=u(function(){return!0},"TRUE"),K=u(function(){return!1},"FALSE"),q=u(function(A,j,S,U){this._class=S.draggable;var G=W.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var Y=[0,0],se=null,le=null,ne=[0,0],he=!1,pe=[0,0],fe=this.params.consumeStartEvent!==!1,me=this.el,we=this.params.clone;this.params.scroll;var _e=j.multipleDrop!==!1,je=!1,Pe,qe,Me=null,ye=[],be=null,Ae=j.ghostProxyParent,xe,Ne,Xe,rt;if(j.ghostProxy===!0?Pe=B:j.ghostProxy&&typeof j.ghostProxy=="function"?Pe=j.ghostProxy:Pe=u(function(Ee,Ke){return be&&be.useGhostProxy?be.useGhostProxy(Ee,Ke):!1},"useGhostProxy"),j.makeGhostProxy?qe=j.makeGhostProxy:qe=u(function(Ee){return be&&be.makeGhostProxy?be.makeGhostProxy(Ee):Ee.cloneNode(!0)},"ghostProxy"),j.selector){var kt=A.getAttribute("katavorio-draggable");kt==null&&(kt=""+new Date().getTime(),A.setAttribute("katavorio-draggable",kt)),ye.push(j)}var Ut=j.snapThreshold,Xt=u(function(Ee,Ke,Qe,Ye,tt){var ut=Math.floor(Ee[0]/Ke),R=Ke*ut,ae=R+Ke,ee=Math.abs(Ee[0]-R)<=Ye?R:Math.abs(ae-Ee[0])<=Ye?ae:Ee[0],ie=Math.floor(Ee[1]/Qe),ce=Qe*ie,ve=ce+Qe,ke=Math.abs(Ee[1]-ce)<=tt?ce:Math.abs(ve-Ee[1])<=tt?ve:Ee[1];return[ee,ke]},"_snap");this.posses=[],this.posseRoles={},this.toGrid=function(Ee){if(this.params.grid==null)return Ee;var Ke=this.params.grid?this.params.grid[0]/2:Ut||m/2,Qe=this.params.grid?this.params.grid[1]/2:Ut||v/2;return Xt(Ee,this.params.grid[0],this.params.grid[1],Ke,Qe)},this.snap=function(Ee,Ke){if(me!=null){Ee=Ee||(this.params.grid?this.params.grid[0]:m),Ke=Ke||(this.params.grid?this.params.grid[1]:v);var Qe=this.params.getPosition(me),Ye=this.params.grid?this.params.grid[0]/2:Ut,tt=this.params.grid?this.params.grid[1]/2:Ut,ut=Xt(Qe,Ee,Ke,Ye,tt);return this.params.setPosition(me,ut),ut}},this.setUseGhostProxy=function(Ee){Pe=Ee?B:K};var Wt,Un=u(function(Ee){return j.allowNegative===!1?[Math.max(0,Ee[0]),Math.max(0,Ee[1])]:Ee},"negativeFilter"),zn=function(Ee){Wt=typeof Ee=="function"?Ee:Ee?function(Ke,Qe,Ye,tt){return Un([Math.max(0,Math.min(Ye.w-tt[0],Ke[0])),Math.max(0,Math.min(Ye.h-tt[1],Ke[1]))])}.bind(this):function(Ke){return Un(Ke)}}.bind(this);zn(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(Ee){zn(Ee)};var ls=u(function(Ee,Ke,Qe,Ye){return be!=null&&be.constrain&&typeof be.constrain=="function"?be.constrain(Ee,Ke,Qe,Ye):Wt(Ee,Ke,Qe,Ye)},"_doConstrain"),Jt;this.setRevert=function(Ee){Jt=Ee},this.params.revert&&(Jt=this.params.revert);var hn=u(function(Ee){return typeof Ee=="function"?(Ee._katavorioId=Q(),Ee._katavorioId):Ee},"_assignId"),Zt={},In=u(function(Ee){for(var Ke in Zt){var Qe=Zt[Ke],Ye=Qe[0](Ee);if(Qe[1]&&(Ye=!Ye),!Ye)return!1}return!0},"_testFilter"),mn=this.setFilter=function(Ee,Ke){if(Ee){var Qe=hn(Ee);Zt[Qe]=[function(Ye){var tt=Ye.srcElement||Ye.target,ut;return o(Ee)?ut=i(tt,Ee,A):typeof Ee=="function"&&(ut=Ee(Ye,A)),ut},Ke!==!1]}};this.addFilter=mn,this.removeFilter=function(Ee){var Ke=typeof Ee=="function"?Ee._katavorioId:Ee;delete Zt[Ke]},this.clearAllFilters=function(){Zt={}},this.canDrag=this.params.canDrag||M;var gn,pt=[],Qt=[];this.addSelector=function(Ee){Ee.selector&&ye.push(Ee)},this.downListener=function(Ee){if(!Ee.defaultPrevented){var Ke=this.rightButtonCanDrag||Ee.which!==3&&Ee.button!==2;if(Ke&&this.isEnabled()&&this.canDrag()){var Qe=In(Ee)&&I(Ee,this.el,this.k);if(Qe){if(be=null,Me=null,ye.length>0){var Ye=c(ye,this.el,Ee.target||Ee.srcElement);if(Ye!=null&&(be=Ye[0],Me=Ye[1]),Me==null)return}else Me=this.el;if(we)if(me=Me.cloneNode(!0),this.params.addClass(me,k.clonedDrag),me.setAttribute("id",null),me.style.position="absolute",this.params.parent!=null){var tt=this.params.getPosition(this.el);me.style.left=tt[0]+"px",me.style.top=tt[1]+"px",this.params.parent.appendChild(me)}else{var ut=r(Me);me.style.left=ut.left+"px",me.style.top=ut.top+"px",document.body.appendChild(me)}else me=Me;fe&&N(Ee),Y=w(Ee),me&&me.parentNode&&(pe=[me.parentNode.scrollLeft,me.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),G.markSelection(this),G.markPosses(this),this.params.addClass(document.body,S.noSelect),en("beforeStart",{el:this.el,pos:se,e:Ee,drag:this})}else this.params.consumeFilteredEvents&&N(Ee)}}}.bind(this),this.moveListener=function(Ee){if(Y){if(!he){var Ke=en("start",{el:this.el,pos:se,e:Ee,drag:this});if(Ke!==!1){if(!Y)return;this.mark(!0),he=!0}else this.abort()}if(Y){Qt.length=0;var Qe=w(Ee),Ye=Qe[0]-Y[0],tt=Qe[1]-Y[1],ut=this.params.ignoreZoom?1:G.getZoom();me&&me.parentNode&&(Ye+=me.parentNode.scrollLeft-pe[0],tt+=me.parentNode.scrollTop-pe[1]),Ye/=ut,tt/=ut,this.moveBy(Ye,tt,Ee),G.updateSelection(Ye,tt,this),G.updatePosses(Ye,tt,this)}}}.bind(this),this.upListener=function(Ee){Y&&(Y=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,S.noSelect),this.unmark(Ee),G.unmarkSelection(this,Ee),G.unmarkPosses(this,Ee),this.stop(Ee),G.notifyPosseDragStop(this,Ee),he=!1,Qt.length=0,we?(me&&me.parentNode&&me.parentNode.removeChild(me),me=null):Jt&&Jt(me,this.params.getPosition(me))===!0&&(this.params.setPosition(me,se),en("revert",me)))}.bind(this),this.getFilters=function(){return Zt},this.abort=function(){Y!=null&&this.upListener()},this.getDragElement=function(Ee){return Ee?Me||this.el:me||this.el};var St={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};j.events.start&&St.start.push(j.events.start),j.events.beforeStart&&St.beforeStart.push(j.events.beforeStart),j.events.stop&&St.stop.push(j.events.stop),j.events.drag&&St.drag.push(j.events.drag),j.events.revert&&St.revert.push(j.events.revert),this.on=function(Ee,Ke){St[Ee]&&St[Ee].push(Ke)},this.off=function(Ee,Ke){if(St[Ee]){for(var Qe=[],Ye=0;Ye<St[Ee].length;Ye++)St[Ee][Ye]!==Ke&&Qe.push(St[Ee][Ye]);St[Ee]=Qe}};var en=u(function(Ee,Ke){var Qe=null;if(be&&be[Ee])Qe=be[Ee](Ke);else if(St[Ee])for(var Ye=0;Ye<St[Ee].length;Ye++)try{var tt=St[Ee][Ye](Ke);tt!=null&&(Qe=tt)}catch{}return Qe},"_dispatch");this.notifyStart=function(Ee){en("start",{el:this.el,pos:this.params.getPosition(me),e:Ee,drag:this})},this.stop=function(Ee,Ke){if(Ke||he){var Qe=[],Ye=G.getSelection(),tt=this.params.getPosition(me);if(Ye.length>0)for(var ut=0;ut<Ye.length;ut++){var R=this.params.getPosition(Ye[ut].el);Qe.push([Ye[ut].el,{left:R[0],top:R[1]},Ye[ut]])}else Qe.push([me,{left:tt[0],top:tt[1]},this]);en("stop",{el:me,pos:cn||tt,finalPos:tt,e:Ee,drag:this,selection:Qe})}},this.mark=function(Ee){se=this.params.getPosition(me),le=this.params.getPosition(me,!0),ne=[le[0]-se[0],le[1]-se[1]],this.size=this.params.getSize(me),pt=G.getMatchingDroppables(this),P(pt,!0,!1,this),this.params.addClass(me,this.params.dragClass||S.drag);var Ke;this.params.getConstrainingRectangle?Ke=this.params.getConstrainingRectangle(me):Ke=this.params.getSize(me.parentNode),gn={w:Ke[0],h:Ke[1]},Xe=0,rt=0,Ee&&G.notifySelectionDragStart(this)};var cn;this.unmark=function(Ee,Ke){if(P(pt,!1,!0,this),je&&Pe(Me,me)?(cn=[me.offsetLeft-Xe,me.offsetTop-rt],me.parentNode.removeChild(me),me=Me):cn=null,this.params.removeClass(me,this.params.dragClass||S.drag),pt.length=0,je=!1,!Ke){Qt.length>0&&cn&&j.setPosition(Me,cn),Qt.sort(V);for(var Qe=0;Qe<Qt.length;Qe++){var Ye=Qt[Qe].drop(this,Ee);if(Ye===!0)break}}},this.moveBy=function(Ee,Ke,Qe){Qt.length=0;var Ye=this.toGrid([se[0]+Ee,se[1]+Ke]),tt=ls(Ye,me,gn,this.size);if(Pe(this.el,me))if(Ye[0]!==tt[0]||Ye[1]!==tt[1]){if(!je){var ut=qe(Me);j.addClass(ut,k.ghostProxy),Ae?(Ae.appendChild(ut),xe=j.getPosition(Me.parentNode,!0),Ne=j.getPosition(j.ghostProxyParent,!0),Xe=xe[0]-Ne[0],rt=xe[1]-Ne[1]):Me.parentNode.appendChild(ut),me=ut,je=!0}tt=Ye}else je&&(me.parentNode.removeChild(me),me=Me,je=!1,xe=null,Ne=null,Xe=0,rt=0);var R={x:tt[0],y:tt[1],w:this.size[0],h:this.size[1]},ae={x:R.x+ne[0],y:R.y+ne[1],w:R.w,h:R.h},ee=null;this.params.setPosition(me,[tt[0]+Xe,tt[1]+rt]);for(var ie=0;ie<pt.length;ie++){var ce={x:pt[ie].pagePosition[0],y:pt[ie].pagePosition[1],w:pt[ie].size[0],h:pt[ie].size[1]};this.params.intersects(ae,ce)&&(_e||ee==null||ee===pt[ie].el)&&pt[ie].canDrop(this)?(ee||(ee=pt[ie].el),Qt.push(pt[ie]),pt[ie].setHover(this,!0,Qe)):pt[ie].isHover()&&pt[ie].setHover(this,!1,Qe)}en("drag",{el:this.el,pos:tt,e:Qe,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?mn(this.params.handle,!1):mn(this.params.filter,this.params.filterExclude)},"Drag"),X=u(function(A,j,S,U){this._class=S.droppable,this.params=j||{},this.rank=j.rank||0,this._activeClass=this.params.activeClass||S.active,this._hoverClass=this.params.hoverClass||S.hover,W.apply(this,arguments);var G=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(Y){this.params[Y?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(Y){return!0},this.isHover=function(){return G},this.setHover=function(Y,se,le){(se||this.el._katavorioDragHover==null||this.el._katavorioDragHover===Y.el._katavorio)&&(this.params[se?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=se?Y.el._katavorio:null,G!==se&&this.params.events[se?"over":"out"]({el:this.el,e:le,drag:Y,drop:this}),G=se)},this.drop=function(Y,se){return this.params.events.drop({drag:Y,e:se,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,G=null}},"Drop"),Q=u(function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(A){var j=Math.random()*16|0,S=A==="x"?j:j&3|8;return S.toString(16)})},"_uuid"),V=u(function(A,j){return A.rank<j.rank?1:A.rank>j.rank?-1:0},"_rankSort"),J=u(function(A){return A==null||(A=typeof A=="string"||A.constructor===String?document.getElementById(A):A,A==null)?null:(A._katavorio=A._katavorio||Q(),A)},"_gel");e.Katavorio=function(A){var j=[],S={};this._dragsByScope={},this._dropsByScope={};var U=1,G=u(function(ye,be){L(ye,function(Ae){for(var xe=0;xe<Ae.scopes.length;xe++)be[Ae.scopes[xe]]=be[Ae.scopes[xe]]||[],be[Ae.scopes[xe]].push(Ae)})},"_reg"),Y=u(function(ye,be){var Ae=0;return L(ye,function(xe){for(var Ne=0;Ne<xe.scopes.length;Ne++)if(be[xe.scopes[Ne]]){var Xe=A.indexOf(be[xe.scopes[Ne]],xe);Xe!==-1&&(be[xe.scopes[Ne]].splice(Xe,1),Ae++)}}),Ae>0},"_unreg");this.getMatchingDroppables=function(ye){for(var be=[],Ae={},xe=0;xe<ye.scopes.length;xe++){var Ne=this._dropsByScope[ye.scopes[xe]];if(Ne)for(var Xe=0;Xe<Ne.length;Xe++)Ne[Xe].canDrop(ye)&&!Ae[Ne[Xe].uuid]&&(Ne[Xe].allowLoopback||Ne[Xe].el!==ye.el)&&(Ae[Ne[Xe].uuid]=!0,be.push(Ne[Xe]))}return be.sort(V),be};var se=function(ye){ye=ye||{};var be={events:{}},Ae;for(Ae in A)be[Ae]=A[Ae];for(Ae in ye)be[Ae]=ye[Ae];for(Ae=0;Ae<O.length;Ae++)be.events[O[Ae]]=ye[O[Ae]]||_;return be.katavorio=this,be}.bind(this),le=function(ye,be){for(var Ae=0;Ae<O.length;Ae++)be[O[Ae]]&&ye.on(O[Ae],be[O[Ae]])}.bind(this),ne={},he=A.css||{},pe=A.scope||F;for(var fe in k)ne[fe]=k[fe];for(var fe in he)ne[fe]=he[fe];var me=A.inputFilterSelector||z;this.getInputFilterSelector=function(){return me},this.setInputFilterSelector=function(ye){return me=ye,this},this.draggable=function(ye,be){var Ae=[];return L(ye,function(xe){if(xe=J(xe),xe!=null)if(xe._katavorioDrag==null){var Ne=se(be);xe._katavorioDrag=new q(xe,Ne,ne,pe),G(xe._katavorioDrag,this._dragsByScope),Ae.push(xe._katavorioDrag),A.addClass(xe,Ne.selector?ne.delegatedDraggable:ne.draggable)}else le(xe._katavorioDrag,be)}.bind(this)),Ae},this.droppable=function(ye,be){var Ae=[];return L(ye,function(xe){if(xe=J(xe),xe!=null){var Ne=new X(xe,se(be),ne,pe);xe._katavorioDrop=xe._katavorioDrop||[],xe._katavorioDrop.push(Ne),G(Ne,this._dropsByScope),Ae.push(Ne),A.addClass(xe,ne.droppable)}}.bind(this)),Ae},this.select=function(ye){return L(ye,function(){var be=J(this);be&&be._katavorioDrag&&(S[be._katavorio]||(j.push(be._katavorioDrag),S[be._katavorio]=[be,j.length-1],A.addClass(be,ne.selected)))}),this},this.deselect=function(ye){return L(ye,function(){var be=J(this);if(be&&be._katavorio){var Ae=S[be._katavorio];if(Ae){for(var xe=[],Ne=0;Ne<j.length;Ne++)j[Ne].el!==be&&xe.push(j[Ne]);j=xe,delete S[be._katavorio],A.removeClass(be,ne.selected)}}}),this},this.deselectAll=function(){for(var ye in S){var be=S[ye];A.removeClass(be[0],ne.selected)}j.length=0,S={}},this.markSelection=function(ye){b(j,function(be){be.mark()},ye)},this.markPosses=function(ye){ye.posses&&L(ye.posses,function(be){ye.posseRoles[be]&&qe[be]&&b(qe[be].members,function(Ae){Ae.mark()},ye)})},this.unmarkSelection=function(ye,be){b(j,function(Ae){Ae.unmark(be)},ye)},this.unmarkPosses=function(ye,be){ye.posses&&L(ye.posses,function(Ae){ye.posseRoles[Ae]&&qe[Ae]&&b(qe[Ae].members,function(xe){xe.unmark(be,!0)},ye)})},this.getSelection=function(){return j.slice(0)},this.updateSelection=function(ye,be,Ae){b(j,function(xe){xe.moveBy(ye,be)},Ae)};var we=u(function(ye,be){be.posses&&L(be.posses,function(Ae){be.posseRoles[Ae]&&qe[Ae]&&b(qe[Ae].members,function(xe){ye(xe)},be)})},"_posseAction");this.updatePosses=function(ye,be,Ae){we(function(xe){xe.moveBy(ye,be)},Ae)},this.notifyPosseDragStop=function(ye,be){we(function(Ae){Ae.stop(be,!0)},ye)},this.notifySelectionDragStop=function(ye,be){b(j,function(Ae){Ae.stop(be,!0)},ye)},this.notifySelectionDragStart=function(ye,be){b(j,function(Ae){Ae.notifyStart(be)},ye)},this.setZoom=function(ye){U=ye},this.getZoom=function(){return U};var _e=u(function(ye,be,Ae,xe){L(ye,function(Ne){Y(Ne,Ae),Ne[xe](be),G(Ne,Ae)})},"_scopeManip");L(["set","add","remove","toggle"],function(ye){this[ye+"Scope"]=function(be,Ae){_e(be._katavorioDrag,Ae,this._dragsByScope,ye+"Scope"),_e(be._katavorioDrop,Ae,this._dropsByScope,ye+"Scope")}.bind(this),this[ye+"DragScope"]=function(be,Ae){_e(be.constructor===q?be:be._katavorioDrag,Ae,this._dragsByScope,ye+"Scope")}.bind(this),this[ye+"DropScope"]=function(be,Ae){_e(be.constructor===X?be:be._katavorioDrop,Ae,this._dropsByScope,ye+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(ye,be){for(var Ae in this._dragsByScope)b(this._dragsByScope[Ae],function(xe){xe.snap(ye,be)})},this.getDragsForScope=function(ye){return this._dragsByScope[ye]},this.getDropsForScope=function(ye){return this._dropsByScope[ye]};var je=u(function(ye,be,Ae){if(ye=J(ye),ye[be]){var xe=j.indexOf(ye[be]);xe>=0&&j.splice(xe,1),Y(ye[be],Ae)&&L(ye[be],function(Ne){Ne.destroy()}),delete ye[be]}},"_destroy"),Pe=u(function(ye,be,Ae,xe){ye=J(ye),ye[be]&&ye[be].off(Ae,xe)},"_removeListener");this.elementRemoved=function(ye){ye._katavorioDrag&&this.destroyDraggable(ye),ye._katavorioDrop&&this.destroyDroppable(ye)},this.destroyDraggable=function(ye,be,Ae){arguments.length===1?je(ye,"_katavorioDrag",this._dragsByScope):Pe(ye,"_katavorioDrag",be,Ae)},this.destroyDroppable=function(ye,be,Ae){arguments.length===1?je(ye,"_katavorioDrop",this._dropsByScope):Pe(ye,"_katavorioDrop",be,Ae)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},j=[],S={},qe={}};var qe={},Me=u(function(ye,be,Ae){var xe=o(be)?be:be.id,Ne=o(be)?!0:be.active!==!1,Xe=qe[xe]||function(){var rt={name:xe,members:[]};return qe[xe]=rt,rt}();return L(ye,function(rt){if(rt._katavorioDrag){if(Ae&&rt._katavorioDrag.posseRoles[Xe.name]!=null)return;t(Xe.members,rt._katavorioDrag),t(rt._katavorioDrag.posses,Xe.name),rt._katavorioDrag.posseRoles[Xe.name]=Ne}}),Xe},"_processOneSpec");this.addToPosse=function(ye,be){for(var Ae=[],xe=1;xe<arguments.length;xe++)Ae.push(Me(ye,arguments[xe]));return Ae.length===1?Ae[0]:Ae},this.setPosse=function(ye,be){for(var Ae=[],xe=1;xe<arguments.length;xe++)Ae.push(Me(ye,arguments[xe],!0).name);return L(ye,function(Ne){if(Ne._katavorioDrag){var Xe=a(Ne._katavorioDrag.posses,Ae),rt=[];Array.prototype.push.apply(rt,Ne._katavorioDrag.posses);for(var kt=0;kt<Xe.length;kt++)this.removeFromPosse(Ne,Xe[kt])}}.bind(this)),Ae.length===1?Ae[0]:Ae},this.removeFromPosse=function(ye,be){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var Ae=1;Ae<arguments.length;Ae++)be=arguments[Ae],L(ye,function(xe){if(xe._katavorioDrag&&xe._katavorioDrag.posses){var Ne=xe._katavorioDrag;L(be,function(Xe){s(qe[Xe].members,Ne),s(Ne.posses,Xe),delete Ne.posseRoles[Xe]})}})},this.removeFromAllPosses=function(ye){L(ye,function(be){if(be._katavorioDrag&&be._katavorioDrag.posses){var Ae=be._katavorioDrag;L(Ae.posses,function(xe){s(qe[xe].members,Ae)}),Ae.posses.length=0,Ae.posseRoles={}}})},this.setPosseState=function(ye,be,Ae){var xe=qe[be];xe&&L(ye,function(Ne){Ne._katavorioDrag&&Ne._katavorioDrag.posses&&(Ne._katavorioDrag.posseRoles[xe.name]=Ae)})}},e.Katavorio.version="1.0.0",n.Katavorio=e.Katavorio}.call(typeof window<"u"?window:mt),function(){var e=this;e.jsPlumbUtil=e.jsPlumbUtil||{};var t=e.jsPlumbUtil;n.jsPlumbUtil=t;function s(A){return Object.prototype.toString.call(A)==="[object Array]"}u(s,"isArray"),t.isArray=s;function a(A){return Object.prototype.toString.call(A)==="[object Number]"}u(a,"isNumber"),t.isNumber=a;function o(A){return typeof A=="string"}u(o,"isString"),t.isString=o;function r(A){return typeof A=="boolean"}u(r,"isBoolean"),t.isBoolean=r;function i(A){return A==null}u(i,"isNull"),t.isNull=i;function d(A){return A==null?!1:Object.prototype.toString.call(A)==="[object Object]"}u(d,"isObject"),t.isObject=d;function c(A){return Object.prototype.toString.call(A)==="[object Date]"}u(c,"isDate"),t.isDate=c;function l(A){return Object.prototype.toString.call(A)==="[object Function]"}u(l,"isFunction"),t.isFunction=l;function m(A){return l(A)&&A.name!=null&&A.name.length>0}u(m,"isNamedFunction"),t.isNamedFunction=m;function v(A){for(var j in A)if(A.hasOwnProperty(j))return!1;return!0}u(v,"isEmpty"),t.isEmpty=v;function x(A){if(o(A))return""+A;if(r(A))return!!A;if(c(A))return new Date(A.getTime());if(l(A))return A;if(s(A)){for(var j=[],S=0;S<A.length;S++)j.push(x(A[S]));return j}else if(d(A)){var U={};for(var G in A)U[G]=x(A[G]);return U}else return A}u(x,"clone"),t.clone=x;function C(A,j,S,U){var G={},Y,se,le={};for(S=S||[],U=U||[],se=0;se<S.length;se++)G[S[se]]=!0;for(se=0;se<U.length;se++)le[U[se]]=!0;var ne=x(A);for(se in j)if(ne[se]==null||le[se])ne[se]=j[se];else if(o(j[se])||r(j[se]))G[se]?(Y=[],Y.push.apply(Y,s(ne[se])?ne[se]:[ne[se]]),Y.push.apply(Y,r(j[se])?j[se]:[j[se]]),ne[se]=Y):ne[se]=j[se];else if(s(j[se]))Y=[],s(ne[se])&&Y.push.apply(Y,ne[se]),Y.push.apply(Y,j[se]),ne[se]=Y;else if(d(j[se])){d(ne[se])||(ne[se]={});for(var he in j[se])ne[se][he]=j[se][he]}return ne}u(C,"merge"),t.merge=C;function w(A,j,S){if(A!=null){var U=A,G=U;return j.replace(/([^\.])+/g,function(Y,se,le,ne){var he=Y.match(/([^\[0-9]+){1}(\[)([0-9+])/),pe=le+Y.length>=ne.length,fe=u(function(){return G[he[1]]||function(){return G[he[1]]=[],G[he[1]]}()},"_getArray");if(pe)he?fe()[he[3]]=S:G[Y]=S;else if(he){var me=fe();G=me[he[3]]||function(){return me[he[3]]={},me[he[3]]}()}else G=G[Y]||function(){return G[Y]={},G[Y]}();return""}),A}}u(w,"replace"),t.replace=w;function f(A,j,S){for(var U=0;U<S.length;U++){var G=S[U][0][S[U][1]].apply(S[U][0],S[U][2]);if(G===j)return G}return A}u(f,"functionChain"),t.functionChain=f;function T(A,j,S,U){var G=u(function(se){var le=se.match(/(\${.*?})/g);if(le!=null)for(var ne=0;ne<le.length;ne++){var he=j[le[ne].substring(2,le[ne].length-1)]||"";he!=null&&(se=se.replace(le[ne],he))}return se},"getValue"),Y=u(function(se){if(se!=null){if(o(se))return G(se);if(l(se)&&!U&&(S==null||(se.name||"").indexOf(S)===0))return se(j);if(s(se)){for(var le=[],ne=0;ne<se.length;ne++)le.push(Y(se[ne]));return le}else if(d(se)){var he={};for(var pe in se)he[pe]=Y(se[pe]);return he}else return se}},"_one");return Y(A)}u(T,"populate"),t.populate=T;function k(A,j){if(A){for(var S=0;S<A.length;S++)if(j(A[S]))return S}return-1}u(k,"findWithFunction"),t.findWithFunction=k;function F(A,j){var S=k(A,j);return S>-1&&A.splice(S,1),S!==-1}u(F,"removeWithFunction"),t.removeWithFunction=F;function O(A,j){var S=A.indexOf(j);return S>-1&&A.splice(S,1),S!==-1}u(O,"remove"),t.remove=O;function _(A,j,S){k(A,S)===-1&&A.push(j)}u(_,"addWithFunction"),t.addWithFunction=_;function M(A,j,S,U){var G=A[j];return G==null&&(G=[],A[j]=G),G[U?"unshift":"push"](S),G}u(M,"addToList"),t.addToList=M;function b(A,j,S){return A.indexOf(j)===-1?(S?A.unshift(j):A.push(j),!0):!1}u(b,"suggest"),t.suggest=b;function P(A,j,S){var U;j=s(j)?j:[j];var G=u(function(ne){for(var he=ne.__proto__;he!=null;)if(he.prototype!=null){for(var pe in he.prototype)he.prototype.hasOwnProperty(pe)&&!A.prototype.hasOwnProperty(pe)&&(A.prototype[pe]=he.prototype[pe]);he=he.prototype.__proto__}else he=null},"_copyProtoChain");for(U=0;U<j.length;U++){for(var Y in j[U].prototype)j[U].prototype.hasOwnProperty(Y)&&!A.prototype.hasOwnProperty(Y)&&(A.prototype[Y]=j[U].prototype[Y]);G(j[U])}var se=u(function(ne,he){return function(){for(U=0;U<j.length;U++)j[U].prototype[ne]&&j[U].prototype[ne].apply(this,arguments);return he.apply(this,arguments)}},"_makeFn"),le=u(function(ne){for(var he in ne)A.prototype[he]=se(he,ne[he])},"_oneSet");if(arguments.length>2)for(U=2;U<arguments.length;U++)le(arguments[U]);return A}u(P,"extend"),t.extend=P;for(var L=[],N=0;N<256;N++)L[N]=(N<16?"0":"")+N.toString(16);function z(){var A=Math.random()*4294967295|0,j=Math.random()*4294967295|0,S=Math.random()*4294967295|0,U=Math.random()*4294967295|0;return L[A&255]+L[A>>8&255]+L[A>>16&255]+L[A>>24&255]+"-"+L[j&255]+L[j>>8&255]+"-"+L[j>>16&15|64]+L[j>>24&255]+"-"+L[S&63|128]+L[S>>8&255]+"-"+L[S>>16&255]+L[S>>24&255]+L[U&255]+L[U>>8&255]+L[U>>16&255]+L[U>>24&255]}u(z,"uuid"),t.uuid=z;function I(A){if(A==null)return null;for(var j=A.replace(/^\s\s*/,""),S=/\s/,U=j.length;S.test(j.charAt(--U)););return j.slice(0,U+1)}u(I,"fastTrim"),t.fastTrim=I;function W(A,j){A=A.length==null||typeof A=="string"?[A]:A;for(var S=0;S<A.length;S++)j(A[S])}u(W,"each"),t.each=W;function B(A,j){for(var S=[],U=0;U<A.length;U++)S.push(j(A[U]));return S}u(B,"map"),t.map=B;function K(A,j,S){S=S||"parent";var U=u(function(ne){return ne?j[ne]:null},"_def"),G=u(function(ne){return ne?U(ne[S]):null},"_parent"),Y=u(function(ne,he){if(ne==null)return he;var pe=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];he.mergeStrategy==="override"&&Array.prototype.push.apply(pe,["events","overlays"]);var fe=C(ne,he,[],pe);return Y(G(ne),fe)},"_one"),se=u(function(ne){if(ne==null)return{};if(typeof ne=="string")return U(ne);if(ne.length){for(var he=!1,pe=0,fe=void 0;!he&&pe<ne.length;)fe=se(ne[pe]),fe?he=!0:pe++;return fe}},"_getDef"),le=se(A);return le?Y(G(le),le):{}}u(K,"mergeWithParents"),t.mergeWithParents=K,t.logEnabled=!0;function q(){if(t.logEnabled&&typeof console<"u")try{var A=arguments[arguments.length-1];console.log(A)}catch{}}u(q,"log"),t.log=q;function X(A,j,S){return function(){var U=null;try{j!=null&&(U=j.apply(this,arguments))}catch(G){q("jsPlumb function failed : "+G)}if(A!=null&&(S==null||U!==S))try{U=A.apply(this,arguments)}catch(G){q("wrapped function failed : "+G)}return U}}u(X,"wrap"),t.wrap=X;var Q=function(){function A(){var j=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(S,U,G){var Y=u(function(le){M(j._listeners,le,U,G),U.__jsPlumb=U.__jsPlumb||{},U.__jsPlumb[z()]=le},"_one");if(typeof S=="string")Y(S);else if(S.length!=null)for(var se=0;se<S.length;se++)Y(S[se]);return j},this.fire=function(S,U,G){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[S]){var Y=this._listeners[S].length,se=0,le=!1,ne=null;if(!this.shouldFireEvent||this.shouldFireEvent(S,U,G))for(;!le&&se<Y&&ne!==!1;){if(this.eventsToDieOn[S])this._listeners[S][se].apply(this,[U,G]);else try{ne=this._listeners[S][se].apply(this,[U,G])}catch(he){q("jsPlumb: fire failed for event "+S+" : "+he)}se++,(this._listeners==null||this._listeners[S]==null)&&(le=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var S=j.queue.pop();S&&j.fire.apply(j,S)},this.unbind=function(S,U){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof S=="string")delete this._listeners[S];else if(S.__jsPlumb){var G=void 0;for(var Y in S.__jsPlumb)G=S.__jsPlumb[Y],O(this._listeners[G]||[],S)}}else arguments.length===2&&O(this._listeners[S]||[],U);return this},this.getListener=function(S){return j._listeners[S]},this.setSuspendEvents=function(S){j.eventsSuspended=S},this.isSuspendEvents=function(){return j.eventsSuspended},this.silently=function(S){j.setSuspendEvents(!0);try{S()}catch(U){q("Cannot execute silent function "+U)}j.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var S in j._listeners)j._listeners[S]=null}}return u(A,"EventGenerator"),A}();t.EventGenerator=Q;function V(A,j,S){var U=[A[0]-j[0],A[1]-j[1]],G=Math.cos(S/360*Math.PI*2),Y=Math.sin(S/360*Math.PI*2);return[U[0]*G-U[1]*Y+j[0],U[1]*G+U[0]*Y+j[1],G,Y]}u(V,"rotatePoint"),t.rotatePoint=V;function J(A,j){var S=V(A,[0,0],j);return[Math.round(S[0]),Math.round(S[1])]}u(J,"rotateAnchorOrientation"),t.rotateAnchorOrientation=J}.call(typeof window<"u"?window:mt),function(){var e=this;e.jsPlumbUtil.matchesSelector=function(t,s,a){a=a||t.parentNode;for(var o=a.querySelectorAll(s),r=0;r<o.length;r++)if(o[r]===t)return!0;return!1},e.jsPlumbUtil.consume=function(t,s){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!s&&t.preventDefault&&t.preventDefault()},e.jsPlumbUtil.sizeElement=function(t,s,a,o,r){t&&(t.style.height=r+"px",t.height=r,t.style.width=o+"px",t.width=o,t.style.left=s+"px",t.style.top=a+"px")}}.call(typeof window<"u"?window:mt),function(){var e={deriveAnchor:function(o,r,i,d){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[o][r]}},t=this,s=u(function(o,r){this.count=0,this.instance=o,this.lists={},this.options=r||{},this.instance.addList=function(i,d){return this.listManager.addList(i,d)},this.instance.removeList=function(i){this.listManager.removeList(i)},this.instance.bind("manageElement",function(i){for(var d=this.instance.getSelector(i.el,"[jtk-scrollable-list]"),c=0;c<d.length;c++)this.addList(d[c])}.bind(this)),this.instance.bind("unmanageElement",function(i){this.removeList(i.el)}),this.instance.bind("connection",function(i,d){d==null&&(this._maybeUpdateParentList(i.source),this._maybeUpdateParentList(i.target))}.bind(this))},"ListManager");t.jsPlumbListManager=s,s.prototype={addList:function(o,r){var i=this.instance.extend({},e);this.instance.extend(i,this.options),r=this.instance.extend(i,r||{});var d=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[d]=new a(this.instance,o,r,d)},removeList:function(o){var r=this.lists[o._jsPlumbList];r&&(r.destroy(),delete this.lists[o._jsPlumbList])},_maybeUpdateParentList:function(o){for(var r=o.parentNode,i=this.instance.getContainer();r!=null&&r!==i;){if(r._jsPlumbList!=null&&this.lists[r._jsPlumbList]!=null){r._jsPlumbScrollHandler();return}r=r.parentNode}}};var a=u(function(o,r,i,d){r._jsPlumbList=d;function c(x,C,w,f){return i.anchor?i.anchor:i.deriveAnchor(x,C,w,f)}u(c,"deriveAnchor");function l(x,C,w,f){return i.deriveEndpoint?i.deriveEndpoint(x,C,w,f):i.endpoint?i.endpoint:w.type}u(l,"deriveEndpoint");function m(x){for(var C=x.parentNode,w=o.getContainer();C!=null&&C!==w;){if(o.hasClass(C,"jtk-managed")){o.recalculateOffsets(C);return}C=C.parentNode}}u(m,"_maybeUpdateDraggable");var v=u(function(x){for(var C=o.getSelector(r,".jtk-managed"),w=o.getId(r),f=0;f<C.length;f++){if(C[f].offsetTop<r.scrollTop)C[f]._jsPlumbProxies||(C[f]._jsPlumbProxies=C[f]._jsPlumbProxies||[],o.select({source:C[f]}).each(function(k){o.proxyConnection(k,0,r,w,function(){return l("top",0,k.endpoints[0],k)},function(){return c("top",0,k.endpoints[0],k)}),C[f]._jsPlumbProxies.push([k,0])}),o.select({target:C[f]}).each(function(k){o.proxyConnection(k,1,r,w,function(){return l("top",1,k.endpoints[1],k)},function(){return c("top",1,k.endpoints[1],k)}),C[f]._jsPlumbProxies.push([k,1])}));else if(C[f].offsetTop+C[f].offsetHeight>r.scrollTop+r.offsetHeight)C[f]._jsPlumbProxies||(C[f]._jsPlumbProxies=C[f]._jsPlumbProxies||[],o.select({source:C[f]}).each(function(k){o.proxyConnection(k,0,r,w,function(){return l("bottom",0,k.endpoints[0],k)},function(){return c("bottom",0,k.endpoints[0],k)}),C[f]._jsPlumbProxies.push([k,0])}),o.select({target:C[f]}).each(function(k){o.proxyConnection(k,1,r,w,function(){return l("bottom",1,k.endpoints[1],k)},function(){return c("bottom",1,k.endpoints[1],k)}),C[f]._jsPlumbProxies.push([k,1])}));else if(C[f]._jsPlumbProxies){for(var T=0;T<C[f]._jsPlumbProxies.length;T++)o.unproxyConnection(C[f]._jsPlumbProxies[T][0],C[f]._jsPlumbProxies[T][1],w);delete C[f]._jsPlumbProxies}o.revalidate(C[f])}m(r)},"scrollHandler");o.setAttribute(r,"jtk-scrollable-list","true"),r._jsPlumbScrollHandler=v,o.on(r,"scroll",v),v(),this.destroy=function(){o.off(r,"scroll",v),delete r._jsPlumbScrollHandler;for(var x=o.getSelector(r,".jtk-managed"),C=o.getId(r),w=0;w<x.length;w++)if(x[w]._jsPlumbProxies){for(var f=0;f<x[w]._jsPlumbProxies.length;f++)o.unproxyConnection(x[w]._jsPlumbProxies[f][0],x[w]._jsPlumbProxies[f][1],C);delete x[w]._jsPlumbProxies}}},"List")}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumbUtil,s=u(function(w){if(w._jsPlumb.paintStyle&&w._jsPlumb.hoverPaintStyle){var f={};C.extend(f,w._jsPlumb.paintStyle),C.extend(f,w._jsPlumb.hoverPaintStyle),delete w._jsPlumb.hoverPaintStyle,f.gradient&&w._jsPlumb.paintStyle.fill&&delete f.gradient,w._jsPlumb.hoverPaintStyle=f}},"_updateHoverStyle"),a=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],o=u(function(w,f,T,k){var F=w.getAttachedElements();if(F)for(var O=0,_=F.length;O<_;O++)(!k||k!==F[O])&&F[O].setHover(f,!0,T)},"_updateAttachedElements"),r=u(function(w){return w==null?null:w.split(" ")},"_splitType"),i=u(function(w,f,T){for(var k in f)w[k]=T},"_mapType"),d=u(function(w,f,T){if(w.getDefaultType){var k=w.getTypeDescriptor(),F={},O=w.getDefaultType(),_=t.merge({},O);i(F,O,"__default");for(var M=0,b=w._jsPlumb.types.length;M<b;M++){var P=w._jsPlumb.types[M];if(P!=="__default"){var L=w._jsPlumb.instance.getType(P,k);if(L!=null){var N=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],z=[];L.mergeStrategy==="override"?Array.prototype.push.apply(N,["events","overlays","cssClass"]):z.push("cssClass"),_=t.merge(_,L,z,N),i(F,L,P)}}}f&&(_=t.populate(_,f,"_")),w.applyType(_,T,F),T||w.repaint()}},"_applyTypes"),c=e.jsPlumbUIComponent=function(w){t.EventGenerator.apply(this,arguments);var f=this,T=arguments,k=f.idPrefix,F=k+new Date().getTime();this._jsPlumb={instance:w._jsPlumb,parameters:w.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:w.beforeDetach,beforeDrop:w.beforeDrop,overlayPlacements:[],hoverClass:w.hoverClass||w._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(z,I,W){this._jsPlumb.typeCache[W]=this._jsPlumb.typeCache[W]||{},this._jsPlumb.typeCache[W][z]=I},this.getCachedTypeItem=function(z,I){return this._jsPlumb.typeCache[I]?this._jsPlumb.typeCache[I][z]:null},this.getId=function(){return F};var O=w.overlays||[],_={};if(this.defaultOverlayKeys){for(var M=0;M<this.defaultOverlayKeys.length;M++)Array.prototype.push.apply(O,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[M]]||[]);for(M=0;M<O.length;M++){var b=C.convertToFullOverlaySpec(O[M]);_[b[1].id]=b}}var P={overlays:_,parameters:w.parameters||{},scope:w.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return P},this.appendToDefaultType=function(z){for(var I in z)P[I]=z[I]},w.events)for(var L in w.events)f.bind(L,w.events[L]);this.clone=function(){var z=Object.create(this.constructor.prototype);return this.constructor.apply(z,T),z}.bind(this),this.isDetachAllowed=function(z){var I=!0;if(this._jsPlumb.beforeDetach)try{I=this._jsPlumb.beforeDetach(z)}catch(W){t.log("jsPlumb: beforeDetach callback failed",W)}return I},this.isDropAllowed=function(z,I,W,B,K,q,X){var Q=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:z,targetId:I,scope:W,connection:B,dropEndpoint:K,source:q,target:X});if(this._jsPlumb.beforeDrop)try{Q=this._jsPlumb.beforeDrop({sourceId:z,targetId:I,scope:W,connection:B,dropEndpoint:K,source:q,target:X})}catch(V){t.log("jsPlumb: beforeDrop callback failed",V)}return Q};var N=[];this.setListenerComponent=function(z){for(var I=0;I<N.length;I++)N[I][3]=z}},l=u(function(w,f){var T=w._jsPlumb.types[f],k=w._jsPlumb.instance.getType(T,w.getTypeDescriptor());k!=null&&k.cssClass&&w.canvas&&w._jsPlumb.instance.removeClass(w.canvas,k.cssClass)},"_removeTypeCssHelper");t.extend(e.jsPlumbUIComponent,t.EventGenerator,{getParameter:function(w){return this._jsPlumb.parameters[w]},setParameter:function(w,f){this._jsPlumb.parameters[w]=f},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(w){this._jsPlumb.parameters=w},getClass:function(){return C.getClass(this.canvas)},hasClass:function(w){return C.hasClass(this.canvas,w)},addClass:function(w){C.addClass(this.canvas,w)},removeClass:function(w){C.removeClass(this.canvas,w)},updateClasses:function(w,f){C.updateClasses(this.canvas,w,f)},setType:function(w,f,T){this.clearTypes(),this._jsPlumb.types=r(w)||[],d(this,f,T)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(w,f){d(this,w,f)},hasType:function(w){return this._jsPlumb.types.indexOf(w)!==-1},addType:function(w,f,T){var k=r(w),F=!1;if(k!=null){for(var O=0,_=k.length;O<_;O++)this.hasType(k[O])||(this._jsPlumb.types.push(k[O]),F=!0);F&&d(this,f,T)}},removeType:function(w,f,T){var k=r(w),F=!1,O=function(b){var P=this._jsPlumb.types.indexOf(b);return P!==-1?(l(this,P),this._jsPlumb.types.splice(P,1),!0):!1}.bind(this);if(k!=null){for(var _=0,M=k.length;_<M;_++)F=O(k[_])||F;F&&d(this,f,T)}},clearTypes:function(w,f){for(var T=this._jsPlumb.types.length,k=0;k<T;k++)l(this,0),this._jsPlumb.types.splice(0,1);d(this,w,f)},toggleType:function(w,f,T){var k=r(w);if(k!=null){for(var F=0,O=k.length;F<O;F++){var _=this._jsPlumb.types.indexOf(k[F]);_!==-1?(l(this,_),this._jsPlumb.types.splice(_,1)):this._jsPlumb.types.push(k[F])}d(this,f,T)}},applyType:function(w,f){if(this.setPaintStyle(w.paintStyle,f),this.setHoverPaintStyle(w.hoverPaintStyle,f),w.parameters)for(var T in w.parameters)this.setParameter(T,w.parameters[T]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(w,f){this._jsPlumb.paintStyle=w,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,s(this),f||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(w,f){this._jsPlumb.hoverPaintStyle=w,s(this),f||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(w){(w||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(w,f,T){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=w;var k=w?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[k](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[k](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=w?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(T=T||jsPlumbUtil.uuid(),this.repaint({timestamp:T,recalc:!1}))),this.getAttachedElements&&!f&&o(this,w,jsPlumbUtil.uuid(),this)}}});var m=0,v=u(function(){var w=m+1;return m++,w},"getInstanceIndex"),x=e.jsPlumbInstance=function(w){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},w&&C.extend(this.Defaults,w),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},t.EventGenerator.apply(this);var f=this,T=v(),k=f.bind,F={},O=1,_=u(function(R){if(R==null)return null;if(R.nodeType===3||R.nodeType===8)return{el:R,text:!0};var ae=f.getElement(R);return{el:ae,id:t.isString(R)&&ae==null?R:Pe(ae)}},"_info");this.getInstanceIndex=function(){return T},this.setZoom=function(R,ae){return O=R,f.fire("zoom",O),ae&&f.repaintEverything(),!0},this.getZoom=function(){return O};for(var M in this.Defaults)F[M]=this.Defaults[M];var b,P=[];this.unbindContainer=function(){if(b!=null&&P.length>0)for(var R=0;R<P.length;R++)f.off(b,P[R][0],P[R][1])},this.setContainer=function(R){this.unbindContainer(),R=this.getElement(R),this.select().each(function(De){De.moveParent(R)}),this.selectEndpoints().each(function(De){De.moveParent(R)});var ae=b;b=R,P.length=0;for(var ee={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},ie=u(function(De,Ce,et){var Ve=Ce.srcElement||Ce.target,it=(Ve&&Ve.parentNode?Ve.parentNode._jsPlumb:null)||(Ve?Ve._jsPlumb:null)||(Ve&&Ve.parentNode&&Ve.parentNode.parentNode?Ve.parentNode.parentNode._jsPlumb:null);if(it){it.fire(De,it,Ce);var ht=et&&ee[et+De]||De;f.fire(ht,it.component||it,Ce)}},"_oneDelegateHandler"),ce=u(function(De,Ce,et){P.push([De,et]),f.on(b,De,Ce,et)},"_addOneDelegate"),ve=u(function(De){ce(De,".jtk-connector",function(Ce){ie(De,Ce)}),ce(De,".jtk-endpoint",function(Ce){ie(De,Ce,"endpoint")}),ce(De,".jtk-overlay",function(Ce){ie(De,Ce)})},"_oneDelegate"),ke=0;ke<a.length;ke++)ve(a[ke]);for(var Fe in B){var Le=B[Fe].el;Le.parentNode===ae&&(ae.removeChild(Le),b.appendChild(Le))}},this.getContainer=function(){return b},this.bind=function(R,ae){R==="ready"&&N?ae():k.apply(f,[R,ae])},f.importDefaults=function(R){for(var ae in R)f.Defaults[ae]=R[ae];return R.Container&&f.setContainer(R.Container),f},f.restoreDefaults=function(){return f.Defaults=C.extend({},F),f};var L=null,N=!1,z=[],I={},W={},B={},K={},q={},X=!1,Q=[],V=!1,J=null,A=this.Defaults.Scope,j=1,S=u(function(){return""+j++},"_idstamp"),U=function(R,ae){b?b.appendChild(R):ae?this.getElement(ae).appendChild(R):this.appendToRoot(R)}.bind(this),G=u(function(R,ae,ee,ie){var ce={c:[],e:[]};if(!V&&(R=f.getElement(R),R!=null)){var ve=Pe(R),ke=R.querySelectorAll(".jtk-managed");ee==null&&(ee=jsPlumbUtil.uuid()),pt({elId:ve,offset:ae,recalc:!1,timestamp:ee});for(var Fe=0;Fe<ke.length;Fe++)pt({elId:ke[Fe].getAttribute("id"),recalc:!0,timestamp:ee});var Le=f.router.redraw(ve,ae,ee,null,ie);if(Array.prototype.push.apply(ce.c,Le.c),Array.prototype.push.apply(ce.e,Le.e),ke)for(var De=0;De<ke.length;De++)Le=f.router.redraw(ke[De].getAttribute("id"),null,ee,null,ie,!0),Array.prototype.push.apply(ce.c,Le.c),Array.prototype.push.apply(ce.e,Le.e)}return ce},"_draw"),Y=u(function(R){return W[R]},"_getEndpoint"),se=u(function(R,ae){for(var ee=R.scope.split(/\s/),ie=ae.scope.split(/\s/),ce=0;ce<ee.length;ce++)for(var ve=0;ve<ie.length;ve++)if(ie[ve]===ee[ce])return!0;return!1},"_scopeMatch"),le=u(function(R,ae){var ee=C.extend({},R);for(var ie in ae)ae[ie]&&(ee[ie]=ae[ie]);return ee},"_mergeOverrides"),ne=function(R,ae){var ee=C.extend({},R);if(ae&&C.extend(ee,ae),ee.source&&(ee.source.endpoint?ee.sourceEndpoint=ee.source:ee.source=f.getElement(ee.source)),ee.target&&(ee.target.endpoint?ee.targetEndpoint=ee.target:ee.target=f.getElement(ee.target)),R.uuids&&(ee.sourceEndpoint=Y(R.uuids[0]),ee.targetEndpoint=Y(R.uuids[1])),ee.sourceEndpoint&&ee.sourceEndpoint.isFull()){t.log(f,"could not add connection; source endpoint is full");return}if(ee.targetEndpoint&&ee.targetEndpoint.isFull()){t.log(f,"could not add connection; target endpoint is full");return}if(!ee.type&&ee.sourceEndpoint&&(ee.type=ee.sourceEndpoint.connectionType),ee.sourceEndpoint&&ee.sourceEndpoint.connectorOverlays){ee.overlays=ee.overlays||[];for(var ie=0,ce=ee.sourceEndpoint.connectorOverlays.length;ie<ce;ie++)ee.overlays.push(ee.sourceEndpoint.connectorOverlays[ie])}ee.sourceEndpoint&&ee.sourceEndpoint.scope&&(ee.scope=ee.sourceEndpoint.scope),!ee["pointer-events"]&&ee.sourceEndpoint&&ee.sourceEndpoint.connectorPointerEvents&&(ee["pointer-events"]=ee.sourceEndpoint.connectorPointerEvents);var ve=u(function(Fe,Le,De){var Ce=le(Le,{anchor:ee.anchors?ee.anchors[De]:ee.anchor,endpoint:ee.endpoints?ee.endpoints[De]:ee.endpoint,paintStyle:ee.endpointStyles?ee.endpointStyles[De]:ee.endpointStyle,hoverPaintStyle:ee.endpointHoverStyles?ee.endpointHoverStyles[De]:ee.endpointHoverStyle});return f.addEndpoint(Fe,Ce)},"_addEndpoint"),ke=u(function(Fe,Le,De,Ce){if(ee[Fe]&&!ee[Fe].endpoint&&!ee[Fe+"Endpoint"]&&!ee.newConnection){var et=Pe(ee[Fe]),Ve=De[et];if(Ve=Ve?Ve[Ce]:null,Ve){if(!Ve.enabled)return!1;var it=C.extend({},Ve.def);delete it.label;var ht=Ve.endpoint!=null&&Ve.endpoint._jsPlumb?Ve.endpoint:ve(ee[Fe],it,Le);if(ht.isFull())return!1;ee[Fe+"Endpoint"]=ht,!ee.scope&&it.scope&&(ee.scope=it.scope),Ve.uniqueEndpoint?Ve.endpoint?ht.finalEndpoint=Ve.endpoint:(Ve.endpoint=ht,ht.setDeleteOnEmpty(!1)):ht.setDeleteOnEmpty(!0),Le===0&&Ve.def.connectorOverlays&&(ee.overlays=ee.overlays||[],Array.prototype.push.apply(ee.overlays,Ve.def.connectorOverlays))}}},"_oneElementDef");if(ke("source",0,this.sourceEndpointDefinitions,ee.type||"default")!==!1&&ke("target",1,this.targetEndpointDefinitions,ee.type||"default")!==!1)return ee.sourceEndpoint&&ee.targetEndpoint&&(se(ee.sourceEndpoint,ee.targetEndpoint)||(ee=null)),ee}.bind(f),he=u(function(R){var ae=f.Defaults.ConnectionType||f.getDefaultConnectionType();R._jsPlumb=f,R.newConnection=he,R.newEndpoint=fe,R.endpointsByUUID=W,R.endpointsByElement=I,R.finaliseConnection=pe,R.id="con_"+S();var ee=new ae(R);return ee.isDetachable()&&(ee.endpoints[0].initDraggable("_jsPlumbSource"),ee.endpoints[1].initDraggable("_jsPlumbTarget")),ee},"_newConnection"),pe=f.finaliseConnection=function(R,ae,ee,ie){if(ae=ae||{},R.suspendedEndpoint||z.push(R),R.pending=null,R.endpoints[0].isTemporarySource=!1,ie!==!1&&f.router.newConnection(R),G(R.source),!ae.doNotFireConnectionEvent&&ae.fireEvent!==!1){var ce={connection:R,source:R.source,target:R.target,sourceId:R.sourceId,targetId:R.targetId,sourceEndpoint:R.endpoints[0],targetEndpoint:R.endpoints[1]};f.fire("connection",ce,ee)}},fe=u(function(R,ae){var ee=f.Defaults.EndpointType||C.Endpoint,ie=C.extend({},R);ie._jsPlumb=f,ie.newConnection=he,ie.newEndpoint=fe,ie.endpointsByUUID=W,ie.endpointsByElement=I,ie.fireDetachEvent=ye,ie.elementId=ae||Pe(ie.source);var ce=new ee(ie);return ce.id="ep_"+S(),gn(ie.elementId,ie.source),C.headless||f.getDragManager().endpointAdded(ie.source,ae),ce},"_newEndpoint"),me=u(function(R,ae,ee){var ie=I[R];if(ie&&ie.length)for(var ce=0,ve=ie.length;ce<ve;ce++){for(var ke=0,Fe=ie[ce].connections.length;ke<Fe;ke++){var Le=ae(ie[ce].connections[ke]);if(Le)return}ee&&ee(ie[ce])}},"_operation"),we=u(function(R,ae,ee){ae=ae==="block";var ie=null;ee&&(ie=u(function(ve){ve.setVisible(ae,!0,!0)},"endpointFunc"));var ce=_(R);me(ce.id,function(ve){if(ae&&ee){var ke=ve.sourceId===ce.id?1:0;ve.endpoints[ke].isVisible()&&ve.setVisible(!0)}else ve.setVisible(ae)},ie)},"_setVisible"),_e=u(function(R,ae){var ee=null;ae&&(ee=u(function(ie){var ce=ie.isVisible();ie.setVisible(!ce)},"endpointFunc")),me(R,function(ie){var ce=ie.isVisible();ie.setVisible(!ce)},ee)},"_toggleVisible"),je=u(function(R){var ae=K[R];return ae?{o:ae,s:Q[R]}:pt({elId:R})},"_getCachedData"),Pe=u(function(R,ae,ee){if(t.isString(R))return R;if(R==null)return null;var ie=f.getAttribute(R,"id");return(!ie||ie==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?ie=ae:(arguments.length===1||arguments.length===3&&!arguments[2])&&(ie="jsPlumb_"+T+"_"+S()),ee||f.setAttribute(R,"id",ie)),ie},"_getId");this.setConnectionBeingDragged=function(R){X=R},this.isConnectionBeingDragged=function(){return X},this.getManagedElements=function(){return B},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(R,ae,ee){ee=ee||{};var ie=C.extend({},ee);C.extend(ie,ae),ie.endpoint=ie.endpoint||f.Defaults.Endpoint,ie.paintStyle=ie.paintStyle||f.Defaults.EndpointStyle;for(var ce=[],ve=t.isArray(R)||R.length!=null&&!t.isString(R)?R:[R],ke=0,Fe=ve.length;ke<Fe;ke++){ie.source=f.getElement(ve[ke]),In(ie.source);var Le=Pe(ie.source),De=fe(ie,Le),Ce=gn(Le,ie.source,null,!V).info.o;t.addToList(I,Le,De),V||De.paint({anchorLoc:De.anchor.compute({xy:[Ce.left,Ce.top],wh:Q[Le],element:De,timestamp:J,rotation:this.getRotation(Le)}),timestamp:J}),ce.push(De)}return ce.length===1?ce[0]:ce},this.addEndpoints=function(R,ae,ee){for(var ie=[],ce=0,ve=ae.length;ce<ve;ce++){var ke=f.addEndpoint(R,ae[ce],ee);t.isArray(ke)?Array.prototype.push.apply(ie,ke):ie.push(ke)}return ie},this.animate=function(R,ae,ee){if(!this.animationSupported)return!1;ee=ee||{};var ie=f.getElement(R),ce=Pe(ie),ve=C.animEvents.step,ke=C.animEvents.complete;ee[ve]=t.wrap(ee[ve],function(){f.revalidate(ce)}),ee[ke]=t.wrap(ee[ke],function(){f.revalidate(ce)}),f.doAnimate(ie,ae,ee)},this.checkCondition=function(R,ae){var ee=f.getListener(R),ie=!0;if(ee&&ee.length>0){var ce=Array.prototype.slice.call(arguments,1);try{for(var ve=0,ke=ee.length;ve<ke;ve++)ie=ie&&ee[ve].apply(ee[ve],ce)}catch(Fe){t.log(f,"cannot check condition ["+R+"]"+Fe)}}return ie},this.connect=function(R,ae){var ee=ne(R,ae),ie;if(ee){if(ee.source==null&&ee.sourceEndpoint==null){t.log("Cannot establish connection - source does not exist");return}if(ee.target==null&&ee.targetEndpoint==null){t.log("Cannot establish connection - target does not exist");return}In(ee.source),ie=he(ee),pe(ie,ee)}return ie};var qe=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Me=function(R,ae,ee,ie){var ce,ve=qe[ee],ke=R[ve.elId];R[ve.el];var Fe,Le,De=R.endpoints[ee],Ce={index:ee,originalSourceId:ee===0?ke:R.sourceId,newSourceId:R.sourceId,originalTargetId:ee===1?ke:R.targetId,newTargetId:R.targetId,connection:R};if(ae.constructor===C.Endpoint)ce=ae,ce.addConnection(R),ae=ce.element;else if(Fe=Pe(ae),Le=this[ve.epDefs][Fe],Fe===R[ve.elId])ce=null;else if(Le)for(var et in Le){if(!Le[et].enabled)return;ce=Le[et].endpoint!=null&&Le[et].endpoint._jsPlumb?Le[et].endpoint:this.addEndpoint(ae,Le[et].def),Le[et].uniqueEndpoint&&(Le[et].endpoint=ce),ce.addConnection(R)}else ce=R.makeEndpoint(ee===0,ae,Fe);return ce!=null&&(De.detachFromConnection(R),R.endpoints[ee]=ce,R[ve.el]=ce.element,R[ve.elId]=ce.elementId,Ce[ee===0?"newSourceId":"newTargetId"]=ce.elementId,be(Ce),ie||R.repaint()),Ce.element=ae,Ce}.bind(this);this.setSource=function(R,ae,ee){var ie=Me(R,ae,0,ee);this.router.sourceOrTargetChanged(ie.originalSourceId,ie.newSourceId,R,ie.el,0)},this.setTarget=function(R,ae,ee){var ie=Me(R,ae,1,ee);this.router.sourceOrTargetChanged(ie.originalTargetId,ie.newTargetId,R,ie.el,1)},this.deleteEndpoint=function(R,ae,ee){var ie=typeof R=="string"?W[R]:R;return ie&&f.deleteObject({endpoint:ie,dontUpdateHover:ae,deleteAttachedObjects:ee}),f},this.deleteEveryEndpoint=function(){var R=f.setSuspendDrawing(!0);for(var ae in I){var ee=I[ae];if(ee&&ee.length)for(var ie=0,ce=ee.length;ie<ce;ie++)f.deleteEndpoint(ee[ie],!0)}I={},B={},W={},K={},q={},f.router.reset();var ve=f.getDragManager();return ve&&ve.reset(),R||f.setSuspendDrawing(!1),f};var ye=u(function(R,ae,ee){var ie=f.Defaults.ConnectionType||f.getDefaultConnectionType(),ce=R.constructor===ie,ve=ce?{connection:R,source:R.source,target:R.target,sourceId:R.sourceId,targetId:R.targetId,sourceEndpoint:R.endpoints[0],targetEndpoint:R.endpoints[1]}:R;ae&&f.fire("connectionDetached",ve,ee),f.fire("internal.connectionDetached",ve,ee),f.router.connectionDetached(ve)},"fireDetachEvent"),be=f.fireMoveEvent=function(R,ae){f.fire("connectionMoved",R,ae)};this.unregisterEndpoint=function(R){R._jsPlumb.uuid&&(W[R._jsPlumb.uuid]=null),f.router.deleteEndpoint(R);for(var ae in I){var ee=I[ae];if(ee){for(var ie=[],ce=0,ve=ee.length;ce<ve;ce++)ee[ce]!==R&&ie.push(ee[ce]);I[ae]=ie}I[ae].length<1&&delete I[ae]}};var Ae="isDetachAllowed",xe="beforeDetach",Ne="checkCondition";this.deleteConnection=function(R,ae){return R!=null&&(ae=ae||{},ae.force||t.functionChain(!0,!1,[[R.endpoints[0],Ae,[R]],[R.endpoints[1],Ae,[R]],[R,Ae,[R]],[f,Ne,[xe,R]]]))?(R.setHover(!1),ye(R,!R.pending&&ae.fireEvent!==!1,ae.originalEvent),R.endpoints[0].detachFromConnection(R),R.endpoints[1].detachFromConnection(R),t.removeWithFunction(z,function(ee){return R.id===ee.id}),R.cleanup(),R.destroy(),!0):!1},this.deleteEveryConnection=function(R){R=R||{};var ae=z.length,ee=0;return f.batch(function(){for(var ie=0;ie<ae;ie++)ee+=f.deleteConnection(z[0],R)?1:0}),ee},this.deleteConnectionsForElement=function(R,ae){ae=ae||{},R=f.getElement(R);var ee=Pe(R),ie=I[ee];if(ie&&ie.length)for(var ce=0,ve=ie.length;ce<ve;ce++)ie[ce].deleteEveryConnection(ae);return f},this.deleteObject=function(R){var ae={endpoints:{},connections:{},endpointCount:0,connectionCount:0},ee=R.deleteAttachedObjects!==!1,ie=u(function(Ce){Ce!=null&&ae.connections[Ce.id]==null&&(!R.dontUpdateHover&&Ce._jsPlumb!=null&&Ce.setHover(!1),ae.connections[Ce.id]=Ce,ae.connectionCount++)},"unravelConnection"),ce=u(function(Ce){if(Ce!=null&&ae.endpoints[Ce.id]==null&&(!R.dontUpdateHover&&Ce._jsPlumb!=null&&Ce.setHover(!1),ae.endpoints[Ce.id]=Ce,ae.endpointCount++,ee))for(var et=0;et<Ce.connections.length;et++){var Ve=Ce.connections[et];ie(Ve)}},"unravelEndpoint");R.connection?ie(R.connection):ce(R.endpoint);for(var ve in ae.connections){var ke=ae.connections[ve];if(ke._jsPlumb){t.removeWithFunction(z,function(Ce){return ke.id===Ce.id}),ye(ke,R.fireEvent===!1?!1:!ke.pending,R.originalEvent);var Fe=R.deleteAttachedObjects==null?null:!R.deleteAttachedObjects;ke.endpoints[0].detachFromConnection(ke,null,Fe),ke.endpoints[1].detachFromConnection(ke,null,Fe),ke.cleanup(!0),ke.destroy(!0)}}for(var Le in ae.endpoints){var De=ae.endpoints[Le];De._jsPlumb&&(f.unregisterEndpoint(De),De.cleanup(!0),De.destroy(!0))}return ae};var Xe=u(function(R,ae,ee,ie){for(var ce=0,ve=R.length;ce<ve;ce++)R[ce][ae].apply(R[ce],ee);return ie(R)},"_setOperation"),rt=u(function(R,ae,ee){for(var ie=[],ce=0,ve=R.length;ce<ve;ce++)ie.push([R[ce][ae].apply(R[ce],ee),R[ce]]);return ie},"_getOperation"),kt=u(function(R,ae,ee){return function(){return Xe(R,ae,arguments,ee)}},"setter"),Ut=u(function(R,ae){return function(){return rt(R,ae,arguments)}},"getter"),Xt=u(function(R,ae){var ee=[];if(R)if(typeof R=="string"){if(R==="*")return R;ee.push(R)}else if(ae)ee=R;else if(R.length)for(var ie=0,ce=R.length;ie<ce;ie++)ee.push(_(R[ie]).id);else ee.push(_(R).id);return ee},"prepareList"),Wt=u(function(R,ae,ee){return R==="*"?!0:R.length>0?R.indexOf(ae)!==-1:!ee},"filterList");this.getConnections=function(R,ae){R?R.constructor===String&&(R={scope:R}):R={};for(var ee=R.scope||f.getDefaultScope(),ie=Xt(ee,!0),ce=Xt(R.source),ve=Xt(R.target),ke=!ae&&ie.length>1?{}:[],Fe=u(function(it,ht){if(!ae&&ie.length>1){var vt=ke[it];vt==null&&(vt=ke[it]=[]),vt.push(ht)}else ke.push(ht)},"_addOne"),Le=0,De=z.length;Le<De;Le++){var Ce=z[Le],et=Ce.proxies&&Ce.proxies[0]?Ce.proxies[0].originalEp.elementId:Ce.sourceId,Ve=Ce.proxies&&Ce.proxies[1]?Ce.proxies[1].originalEp.elementId:Ce.targetId;Wt(ie,Ce.scope)&&Wt(ce,et)&&Wt(ve,Ve)&&Fe(Ce.scope,Ce)}return ke};var Un=u(function(R,ae){return function(ee){for(var ie=0,ce=R.length;ie<ce;ie++)ee(R[ie]);return ae(R)}},"_curryEach"),zn=u(function(R){return function(ae){return R[ae]}},"_curryGet"),ls=u(function(R,ae){var ee={length:R.length,each:Un(R,ae),get:zn(R)},ie=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],ce=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],ve,ke;for(ve=0,ke=ie.length;ve<ke;ve++)ee[ie[ve]]=kt(R,ie[ve],ae);for(ve=0,ke=ce.length;ve<ke;ve++)ee[ce[ve]]=Ut(R,ce[ve]);return ee},"_makeCommonSelectHandler"),Jt=u(function(R){var ae=ls(R,Jt);return C.extend(ae,{setDetachable:kt(R,"setDetachable",Jt),setReattach:kt(R,"setReattach",Jt),setConnector:kt(R,"setConnector",Jt),delete:function(){for(var ee=0,ie=R.length;ee<ie;ee++)f.deleteConnection(R[ee])},isDetachable:Ut(R,"isDetachable"),isReattach:Ut(R,"isReattach")})},"_makeConnectionSelectHandler"),hn=u(function(R){var ae=ls(R,hn);return C.extend(ae,{setEnabled:kt(R,"setEnabled",hn),setAnchor:kt(R,"setAnchor",hn),isEnabled:Ut(R,"isEnabled"),deleteEveryConnection:function(){for(var ee=0,ie=R.length;ee<ie;ee++)R[ee].deleteEveryConnection()},delete:function(){for(var ee=0,ie=R.length;ee<ie;ee++)f.deleteEndpoint(R[ee])}})},"_makeEndpointSelectHandler");this.select=function(R){return R=R||{},R.scope=R.scope||"*",Jt(R.connections||f.getConnections(R,!0))},this.selectEndpoints=function(R){R=R||{},R.scope=R.scope||"*";var ae=!R.element&&!R.source&&!R.target,ee=ae?"*":Xt(R.element),ie=ae?"*":Xt(R.source),ce=ae?"*":Xt(R.target),ve=Xt(R.scope,!0),ke=[];for(var Fe in I){var Le=Wt(ee,Fe,!0),De=Wt(ie,Fe,!0),Ce=ie!=="*",et=Wt(ce,Fe,!0),Ve=ce!=="*";if(Le||De||et)e:for(var it=0,ht=I[Fe].length;it<ht;it++){var vt=I[Fe][it];if(Wt(ve,vt.scope,!0)){var Gn=Ce&&ie.length>0&&!vt.isSource,Ps=Ve&&ce.length>0&&!vt.isTarget;if(Gn||Ps)continue e;ke.push(vt)}}}return hn(ke)},this.getAllConnections=function(){return z},this.getDefaultScope=function(){return A},this.getEndpoint=Y,this.getEndpoints=function(R){return I[_(R).id]||[]},this.getDefaultEndpointType=function(){return C.Endpoint},this.getDefaultConnectionType=function(){return C.Connection},this.getId=Pe,this.draw=G,this.info=_,this.appendElement=U;var Zt=!1;this.isHoverSuspended=function(){return Zt},this.setHoverSuspended=function(R){Zt=R},this.hide=function(R,ae){return we(R,"none",ae),f},this.idstamp=S;var In=u(function(R){if(!b&&R){var ae=f.getElement(R);ae.offsetParent&&f.setContainer(ae.offsetParent)}},"_ensureContainer"),mn=u(function(){f.Defaults.Container&&f.setContainer(f.Defaults.Container)},"_getContainerFromDefaults"),gn=f.manage=function(R,ae,ee,ie){return B[R]?ie&&(B[R].info=pt({elId:R,timestamp:J,recalc:!0})):(B[R]={el:ae,endpoints:[],connections:[],rotation:0},B[R].info=pt({elId:R,timestamp:J}),f.addClass(ae,"jtk-managed"),ee||f.fire("manageElement",{id:R,info:B[R].info,el:ae})),B[R]};this.unmanage=function(R){if(B[R]){var ae=B[R].el;f.removeClass(ae,"jtk-managed"),delete B[R],f.fire("unmanageElement",{id:R,el:ae})}},this.rotate=function(R,ae,ee){return B[R]&&(B[R].rotation=ae,B[R].el.style.transform="rotate("+ae+"deg)",B[R].el.style.transformOrigin="center center",ee!==!0)?this.revalidate(R):{c:[],e:[]}},this.getRotation=function(R){return B[R]&&B[R].rotation||0};var pt=u(function(R){var ae=R.timestamp,ee=R.recalc,ie=R.offset,ce=R.elId,ve;return V&&!ae&&(ae=J),!ee&&ae&&ae===q[ce]?{o:R.offset||K[ce],s:Q[ce]}:(ee||!ie&&K[ce]==null?(ve=B[ce]?B[ce].el:null,ve!=null&&(Q[ce]=f.getSize(ve),K[ce]=f.getOffset(ve),q[ce]=ae)):(K[ce]=ie||K[ce],Q[ce]==null&&(ve=B[ce].el,ve!=null&&(Q[ce]=f.getSize(ve))),q[ce]=ae),K[ce]&&!K[ce].right&&(K[ce].right=K[ce].left+Q[ce][0],K[ce].bottom=K[ce].top+Q[ce][1],K[ce].width=Q[ce][0],K[ce].height=Q[ce][1],K[ce].centerx=K[ce].left+K[ce].width/2,K[ce].centery=K[ce].top+K[ce].height/2),{o:K[ce],s:Q[ce]})},"_updateOffset");this.updateOffset=pt,this.init=function(){N||(mn(),f.router=new e.jsPlumb.DefaultRouter(f),f.anchorManager=f.router.anchorManager,N=!0,f.fire("ready",f))}.bind(this),this.log=L,this.jsPlumbUIComponent=c,this.makeAnchor=function(){var R,ae=u(function(ke,Fe){if(e.jsPlumb.Anchors[ke])return new e.jsPlumb.Anchors[ke](Fe);if(!f.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+ke+"'"}},"_a");if(arguments.length===0)return null;var ee=arguments[0],ie=arguments[1],ce=null;if(ee.compute&&ee.getOrientation)return ee;if(typeof ee=="string")ce=ae(arguments[0],{elementId:ie,jsPlumbInstance:f});else if(t.isArray(ee))if(t.isArray(ee[0])||t.isString(ee[0]))ee.length===2&&t.isObject(ee[1])?t.isString(ee[0])?(R=e.jsPlumb.extend({elementId:ie,jsPlumbInstance:f},ee[1]),ce=ae(ee[0],R)):(R=e.jsPlumb.extend({elementId:ie,jsPlumbInstance:f,anchors:ee[0]},ee[1]),ce=new e.jsPlumb.DynamicAnchor(R)):ce=new C.DynamicAnchor({anchors:ee,selector:null,elementId:ie,jsPlumbInstance:f});else{var ve={x:ee[0],y:ee[1],orientation:ee.length>=4?[ee[2],ee[3]]:[0,0],offsets:ee.length>=6?[ee[4],ee[5]]:[0,0],elementId:ie,jsPlumbInstance:f,cssClass:ee.length===7?ee[6]:null};ce=new e.jsPlumb.Anchor(ve),ce.clone=function(){return new e.jsPlumb.Anchor(ve)}}return ce.id||(ce.id="anchor_"+S()),ce},this.makeAnchors=function(R,ae,ee){for(var ie=[],ce=0,ve=R.length;ce<ve;ce++)typeof R[ce]=="string"?ie.push(e.jsPlumb.Anchors[R[ce]]({elementId:ae,jsPlumbInstance:ee})):t.isArray(R[ce])&&ie.push(f.makeAnchor(R[ce],ae,ee));return ie},this.makeDynamicAnchor=function(R,ae){return new e.jsPlumb.DynamicAnchor({anchors:R,selector:ae,elementId:null,jsPlumbInstance:f})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var Qt=u(function(R,ae,ee,ie,ce){for(var ve=R.target||R.srcElement,ke=!1,Fe=ie.getSelector(ae,ee),Le=0;Le<Fe.length;Le++)if(Fe[Le]===ve){ke=!0;break}return ce?!ke:ke},"selectorFilter"),St=u(function(R,ae,ee,ie,ce){var ve=new c(ae),ke=ae._jsPlumb.EndpointDropHandler({jsPlumb:f,enabled:function(){return R.def.enabled},isFull:function(){var Le=f.select({target:R.id}).length;return R.def.maxConnections>0&&Le>=R.def.maxConnections},element:R.el,elementId:R.id,isSource:ie,isTarget:ce,addClass:function(Le){f.addClass(R.el,Le)},removeClass:function(Le){f.removeClass(R.el,Le)},onDrop:function(Le){var De=Le.endpoints[0];De.anchor.locked=!1},isDropAllowed:function(){return ve.isDropAllowed.apply(ve,arguments)},isRedrop:function(Le){return Le.suspendedElement!=null&&Le.suspendedEndpoint!=null&&Le.suspendedEndpoint.element===R.el},getEndpoint:function(Le){var De=R.def.endpoint;if(De==null||De._jsPlumb==null){var Ce=f.deriveEndpointAndAnchorSpec(Le.getType().join(" "),!0),et=Ce.endpoints?e.jsPlumb.extend(ae,{endpoint:R.def.def.endpoint||Ce.endpoints[1]}):ae;Ce.anchors&&(et=e.jsPlumb.extend(et,{anchor:R.def.def.anchor||Ce.anchors[1]})),De=f.addEndpoint(R.el,et),De._mtNew=!0}if(ae.uniqueEndpoint&&(R.def.endpoint=De),De.setDeleteOnEmpty(!0),Le.isDetachable()&&De.initDraggable(),De.anchor.positionFinder!=null){var Ve=f.getUIPosition(arguments,f.getZoom()),it=f.getOffset(R.el),ht=f.getSize(R.el),vt=Ve==null?[0,0]:De.anchor.positionFinder(Ve,it,ht,De.anchor.constructorParams);De.anchor.x=vt[0],De.anchor.y=vt[1]}return De},maybeCleanup:function(Le){Le._mtNew&&Le.connections.length===0?f.deleteObject({endpoint:Le}):delete Le._mtNew}}),Fe=e.jsPlumb.dragEvents.drop;return ee.scope=ee.scope||ae.scope||f.Defaults.Scope,ee[Fe]=t.wrap(ee[Fe],ke,!0),ee.rank=ae.rank||0,ce&&(ee[e.jsPlumb.dragEvents.over]=function(){return!0}),ae.allowLoopback===!1&&(ee.canDrop=function(Le){var De=Le.getDragElement()._jsPlumbRelatedElement;return De!==R.el}),f.initDroppable(R.el,ee,"internal"),ke},"_makeElementDropHandler");this.makeTarget=function(R,ae,ee){var ie=e.jsPlumb.extend({_jsPlumb:this},ee);e.jsPlumb.extend(ie,ae);for(var ce=ie.maxConnections||-1,ve=function(De){var Ce=_(De),et=Ce.id,Ve=e.jsPlumb.extend({},ie.dropOptions||{}),it=ie.connectionType||"default";this.targetEndpointDefinitions[et]=this.targetEndpointDefinitions[et]||{},In(et),Ce.el._isJsPlumbGroup&&Ve.rank==null&&(Ve.rank=-1);var ht={def:e.jsPlumb.extend({},ie),uniqueEndpoint:ie.uniqueEndpoint,maxConnections:ce,enabled:!0};ie.createEndpoint&&(ht.uniqueEndpoint=!0,ht.endpoint=f.addEndpoint(De,ht.def),ht.endpoint.setDeleteOnEmpty(!1)),Ce.def=ht,this.targetEndpointDefinitions[et][it]=ht,St(Ce,ie,Ve,ie.isSource===!0,!0),Ce.el._katavorioDrop[Ce.el._katavorioDrop.length-1].targetDef=ht}.bind(this),ke=R.length&&R.constructor!==String?R:[R],Fe=0,Le=ke.length;Fe<Le;Fe++)ve(ke[Fe]);return this},this.unmakeTarget=function(R,ae){var ee=_(R);return f.destroyDroppable(ee.el,"internal"),ae||delete this.targetEndpointDefinitions[ee.id],this},this.makeSource=function(R,ae,ee){var ie=e.jsPlumb.extend({_jsPlumb:this},ee);e.jsPlumb.extend(ie,ae);var ce=ie.connectionType||"default",ve=f.deriveEndpointAndAnchorSpec(ce);ie.endpoint=ie.endpoint||ve.endpoints[0],ie.anchor=ie.anchor||ve.anchors[0];for(var ke=ie.maxConnections||-1,Fe=ie.onMaxConnections,Le=function(Ve){var it=Ve.id,ht=this.getElement(Ve.el);this.sourceEndpointDefinitions[it]=this.sourceEndpointDefinitions[it]||{},In(it);var vt={def:e.jsPlumb.extend({},ie),uniqueEndpoint:ie.uniqueEndpoint,maxConnections:ke,enabled:!0};ie.createEndpoint&&(vt.uniqueEndpoint=!0,vt.endpoint=f.addEndpoint(R,vt.def),vt.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[it][ce]=vt,Ve.def=vt;var Gn=e.jsPlumb.dragEvents.stop,Ps=e.jsPlumb.dragEvents.drag,fn=e.jsPlumb.extend({},ie.dragOptions||{}),Za=fn.drag,ea=fn.stop,jt=null,cs=!1;fn.scope=fn.scope||ie.scope,fn[Ps]=t.wrap(fn[Ps],function(){Za&&Za.apply(this,arguments),cs=!1}),fn[Gn]=t.wrap(fn[Gn],function(){if(ea&&ea.apply(this,arguments),this.currentlyDragging=!1,jt._jsPlumb!=null){var zt=ie.anchor||this.Defaults.Anchor,_t=jt.anchor,us=jt.connections[0],Cn=this.makeAnchor(zt,it,this),Ln=jt.element;if(Cn.positionFinder!=null){var un=f.getOffset(Ln),dn=this.getSize(Ln),Ls={left:un.left+_t.x*dn[0],top:un.top+_t.y*dn[1]},ds=Cn.positionFinder(Ls,un,dn,Cn.constructorParams);Cn.x=ds[0],Cn.y=ds[1]}jt.setAnchor(Cn,!0),jt.repaint(),this.repaint(jt.elementId),us!=null&&this.repaint(us.targetId)}}.bind(this));var ta=function(zt){if(!(zt.which===3||zt.button===2)){it=this.getId(this.getElement(Ve.el));var _t=this.sourceEndpointDefinitions[it][ce];if(_t.enabled){if(ie.filter){var us=t.isString(ie.filter)?Qt(zt,Ve.el,ie.filter,this,ie.filterExclude):ie.filter(zt,Ve.el);if(us===!1)return}var Cn=this.select({source:it}).length;if(_t.maxConnections>=0&&Cn>=_t.maxConnections)return Fe&&Fe({element:Ve.el,maxConnections:ke},zt),!1;var Ln=e.jsPlumb.getPositionOnElement(zt,ht,O),un={};e.jsPlumb.extend(un,_t.def),un.isTemporarySource=!0,un.anchor=[Ln[0],Ln[1],0,0],un.dragOptions=fn,_t.def.scope&&(un.scope=_t.def.scope),jt=this.addEndpoint(it,un),cs=!0,jt.setDeleteOnEmpty(!0),_t.uniqueEndpoint&&(_t.endpoint?jt.finalEndpoint=_t.endpoint:(_t.endpoint=jt,jt.setDeleteOnEmpty(!1)));var dn=u(function(){f.off(jt.canvas,"mouseup",dn),f.off(Ve.el,"mouseup",dn),cs&&(cs=!1,f.deleteEndpoint(jt))},"_delTempEndpoint");f.on(jt.canvas,"mouseup",dn),f.on(Ve.el,"mouseup",dn);var Ls={};if(_t.def.extract)for(var ds in _t.def.extract){var Qa=(zt.srcElement||zt.target).getAttribute(ds);Qa&&(Ls[_t.def.extract[ds]]=Qa)}f.trigger(jt.canvas,"mousedown",zt,Ls),t.consume(zt)}}}.bind(this);this.on(Ve.el,"mousedown",ta),vt.trigger=ta,ie.filter&&(t.isString(ie.filter)||t.isFunction(ie.filter))&&f.setDragFilter(Ve.el,ie.filter);var Is=e.jsPlumb.extend({},ie.dropOptions||{});St(Ve,ie,Is,!0,ie.isTarget===!0)}.bind(this),De=R.length&&R.constructor!==String?R:[R],Ce=0,et=De.length;Ce<et;Ce++)Le(_(De[Ce]));return this},this.unmakeSource=function(R,ae,ee){var ie=_(R);f.destroyDroppable(ie.el,"internal");var ce=this.sourceEndpointDefinitions[ie.id];if(ce){for(var ve in ce)if(ae==null||ae===ve){var ke=ce[ve].trigger;ke&&f.off(ie.el,"mousedown",ke),ee||delete this.sourceEndpointDefinitions[ie.id][ve]}}return this},this.unmakeEverySource=function(){for(var R in this.sourceEndpointDefinitions)f.unmakeSource(R,null,!0);return this.sourceEndpointDefinitions={},this};var en=function(R,ae,ee){ae=t.isArray(ae)?ae:[ae];var ie=Pe(R);ee=ee||"default";for(var ce=0;ce<ae.length;ce++){var ve=this[ae[ce]][ie];if(ve&&ve[ee])return ve[ee].def.scope||this.Defaults.Scope}}.bind(this),cn=function(R,ae,ee,ie){ee=t.isArray(ee)?ee:[ee];var ce=Pe(R);ie=ie||"default";for(var ve=0;ve<ee.length;ve++){var ke=this[ee[ve]][ce];ke&&ke[ie]&&(ke[ie].def.scope=ae)}}.bind(this);this.getScope=function(R,ae){return en(R,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(R){return en(R,"sourceEndpointDefinitions")},this.getTargetScope=function(R){return en(R,"targetEndpointDefinitions")},this.setScope=function(R,ae,ee){this.setSourceScope(R,ae,ee),this.setTargetScope(R,ae,ee)},this.setSourceScope=function(R,ae,ee){cn(R,ae,"sourceEndpointDefinitions",ee),this.setDragScope(R,ae)},this.setTargetScope=function(R,ae,ee){cn(R,ae,"targetEndpointDefinitions",ee),this.setDropScope(R,ae)},this.unmakeEveryTarget=function(){for(var R in this.targetEndpointDefinitions)f.unmakeTarget(R,!0);return this.targetEndpointDefinitions={},this};var Ee=function(R,ae,ee,ie,ce){var ve=R==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,ke,Fe,Le;if(ce=ce||"default",ae.length&&!t.isString(ae)){ke=[];for(var De=0,Ce=ae.length;De<Ce;De++)Fe=_(ae[De]),ve[Fe.id]&&ve[Fe.id][ce]&&(ke[De]=ve[Fe.id][ce].enabled,Le=ie?!ke[De]:ee,ve[Fe.id][ce].enabled=Le,f[Le?"removeClass":"addClass"](Fe.el,"jtk-"+R+"-disabled"))}else{Fe=_(ae);var et=Fe.id;ve[et]&&ve[et][ce]&&(ke=ve[et][ce].enabled,Le=ie?!ke:ee,ve[et][ce].enabled=Le,f[Le?"removeClass":"addClass"](Fe.el,"jtk-"+R+"-disabled"))}return ke}.bind(this),Ke=function(R,ae){if(R!=null){if(t.isString(R)||!R.length)return ae.apply(this,[R]);if(R.length)return ae.apply(this,[R[0]])}}.bind(this);this.toggleSourceEnabled=function(R,ae){return Ee("source",R,null,!0,ae),this.isSourceEnabled(R,ae)},this.setSourceEnabled=function(R,ae,ee){return Ee("source",R,ae,null,ee)},this.isSource=function(R,ae){return ae=ae||"default",Ke(R,function(ee){var ie=this.sourceEndpointDefinitions[_(ee).id];return ie!=null&&ie[ae]!=null}.bind(this))},this.isSourceEnabled=function(R,ae){return ae=ae||"default",Ke(R,function(ee){var ie=this.sourceEndpointDefinitions[_(ee).id];return ie&&ie[ae]&&ie[ae].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(R,ae){return Ee("target",R,null,!0,ae),this.isTargetEnabled(R,ae)},this.isTarget=function(R,ae){return ae=ae||"default",Ke(R,function(ee){var ie=this.targetEndpointDefinitions[_(ee).id];return ie!=null&&ie[ae]!=null}.bind(this))},this.isTargetEnabled=function(R,ae){return ae=ae||"default",Ke(R,function(ee){var ie=this.targetEndpointDefinitions[_(ee).id];return ie&&ie[ae]&&ie[ae].enabled===!0}.bind(this))},this.setTargetEnabled=function(R,ae,ee){return Ee("target",R,ae,null,ee)},this.ready=function(R){f.bind("ready",R)};var Qe=u(function(R,ae){if(typeof R=="object"&&R.length)for(var ee=0,ie=R.length;ee<ie;ee++)ae(R[ee]);else ae(R);return f},"_elEach");this.repaint=function(R,ae,ee){return Qe(R,function(ie){G(ie,ae,ee)})},this.revalidate=function(R,ae,ee){var ie=ee?R:f.getId(R);f.updateOffset({elId:ie,recalc:!0,timestamp:ae});var ce=f.getDragManager();return ce&&ce.updateOffsets(ie),G(R,null,ae)},this.repaintEverything=function(){var R=jsPlumbUtil.uuid(),ae;for(ae in I)f.updateOffset({elId:ae,recalc:!0,timestamp:R});for(ae in I)G(ae,null,R);return this},this.removeAllEndpoints=function(R,ae,ee){ee=ee||[];var ie=u(function(ce){var ve=_(ce),ke=I[ve.id],Fe,Le;if(ke)for(ee.push(ve),Fe=0,Le=ke.length;Fe<Le;Fe++)f.deleteEndpoint(ke[Fe],!1);if(delete I[ve.id],ae&&ve.el&&ve.el.nodeType!==3&&ve.el.nodeType!==8)for(Fe=0,Le=ve.el.childNodes.length;Fe<Le;Fe++)ie(ve.el.childNodes[Fe])},"_one");return ie(R),this};var Ye=u(function(R,ae){f.removeAllEndpoints(R.id,!0,ae);for(var ee=f.getDragManager(),ie=u(function(ve){ee&&ee.elementRemoved(ve.id),f.router.elementRemoved(ve.id),f.isSource(ve.el)&&f.unmakeSource(ve.el),f.isTarget(ve.el)&&f.unmakeTarget(ve.el),f.destroyDraggable(ve.el),f.destroyDroppable(ve.el),delete f.floatingConnections[ve.id],delete B[ve.id],delete K[ve.id],ve.el&&(f.removeElement(ve.el),ve.el._jsPlumb=null)},"_one"),ce=1;ce<ae.length;ce++)ie(ae[ce]);ie(R)},"_doRemove");this.remove=function(R,ae){var ee=_(R),ie=[];return ee.text&&ee.el.parentNode?ee.el.parentNode.removeChild(ee.el):ee.id&&f.batch(function(){Ye(ee,ie)},ae===!0),f},this.empty=function(R,ae){var ee=[],ie=u(function(ce,ve){var ke=_(ce);if(ke.text)ke.el.parentNode.removeChild(ke.el);else if(ke.el){for(;ke.el.childNodes.length>0;)ie(ke.el.childNodes[0]);ve||Ye(ke,ee)}},"_one");return f.batch(function(){ie(R,!0)},ae===!1),f},this.reset=function(R){f.silently(function(){Zt=!1,f.removeAllGroups(),f.removeGroupManager(),f.deleteEveryEndpoint(),R||f.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},z.length=0,this.doReset&&this.doReset()}.bind(this))},this.destroy=function(){this.reset(),b=null,P=null};var tt=u(function(R){R.canvas&&R.canvas.parentNode&&R.canvas.parentNode.removeChild(R.canvas),R.cleanup(),R.destroy()},"_clearObject");this.clear=function(){f.select().each(tt),f.selectEndpoints().each(tt),I={},W={}},this.setDefaultScope=function(R){return A=R,f},this.deriveEndpointAndAnchorSpec=function(R,ae){for(var ee=((ae?"":"default ")+R).split(/[\s]/),ie=null,ce=null,ve=null,ke=null,Fe=0;Fe<ee.length;Fe++){var Le=f.getType(ee[Fe],"connection");Le&&(Le.endpoints&&(ie=Le.endpoints),Le.endpoint&&(ce=Le.endpoint),Le.anchors&&(ke=Le.anchors),Le.anchor&&(ve=Le.anchor))}return{endpoints:ie||[ce,ce],anchors:ke||[ve,ve]}},this.setId=function(R,ae,ee){var ie;t.isString(R)?ie=R:(R=this.getElement(R),ie=this.getId(R));var ce=this.getConnections({source:ie,scope:"*"},!0),ve=this.getConnections({target:ie,scope:"*"},!0);ae=""+ae,ee?R=this.getElement(ae):(R=this.getElement(ie),this.setAttribute(R,"id",ae)),I[ae]=I[ie]||[];for(var ke=0,Fe=I[ae].length;ke<Fe;ke++)I[ae][ke].setElementId(ae),I[ae][ke].setReferenceElement(R);delete I[ie],this.sourceEndpointDefinitions[ae]=this.sourceEndpointDefinitions[ie],delete this.sourceEndpointDefinitions[ie],this.targetEndpointDefinitions[ae]=this.targetEndpointDefinitions[ie],delete this.targetEndpointDefinitions[ie],this.router.changeId(ie,ae);var Le=this.getDragManager();Le&&Le.changeId(ie,ae),B[ae]=B[ie],delete B[ie];var De=u(function(Ce,et,Ve){for(var it=0,ht=Ce.length;it<ht;it++)Ce[it].endpoints[et].setElementId(ae),Ce[it].endpoints[et].setReferenceElement(R),Ce[it][Ve+"Id"]=ae,Ce[it][Ve]=R},"_conns");De(ce,0,"source"),De(ve,1,"target"),this.repaint(ae)},this.setDebugLog=function(R){L=R},this.setSuspendDrawing=function(R,ae){var ee=V;return V=R,R?J=new Date().getTime():J=null,ae&&this.repaintEverything(),ee},this.isSuspendDrawing=function(){return V},this.getSuspendedAt=function(){return J},this.batch=function(R,ae){var ee=this.isSuspendDrawing();ee||this.setSuspendDrawing(!0);try{R()}catch(ie){t.log("Function run while suspended failed",ie)}ee||this.setSuspendDrawing(!1,!ae)},this.doWhileSuspended=this.batch,this.getCachedData=je,this.show=function(R,ae){return we(R,"block",ae),f},this.toggleVisible=_e,this.addListener=this.bind;var ut=[];this.registerFloatingConnection=function(R,ae,ee){ut[R.id]=ae,t.addToList(I,R.id,ee)},this.getFloatingConnectionFor=function(R){return ut[R]},this.listManager=new e.jsPlumbListManager(this,this.Defaults.ListStyle)};t.extend(e.jsPlumbInstance,t.EventGenerator,{setAttribute:function(w,f,T){this.setAttribute(w,f,T)},getAttribute:function(w,f){return this.getAttribute(e.jsPlumb.getElement(w),f)},convertToFullOverlaySpec:function(w){return t.isString(w)&&(w=[w,{}]),w[1].id=w[1].id||t.uuid(),w},registerConnectionType:function(w,f){if(this._connectionTypes[w]=e.jsPlumb.extend({},f),f.overlays){for(var T={},k=0;k<f.overlays.length;k++){var F=this.convertToFullOverlaySpec(f.overlays[k]);T[F[1].id]=F}this._connectionTypes[w].overlays=T}},registerConnectionTypes:function(w){for(var f in w)this.registerConnectionType(f,w[f])},registerEndpointType:function(w,f){if(this._endpointTypes[w]=e.jsPlumb.extend({},f),f.overlays){for(var T={},k=0;k<f.overlays.length;k++){var F=this.convertToFullOverlaySpec(f.overlays[k]);T[F[1].id]=F}this._endpointTypes[w].overlays=T}},registerEndpointTypes:function(w){for(var f in w)this.registerEndpointType(f,w[f])},getType:function(w,f){return f==="connection"?this._connectionTypes[w]:this._endpointTypes[w]},setIdChanged:function(w,f){this.setId(w,f,!0)},setParent:function(w,f){var T=this.getElement(w),k=this.getId(T),F=this.getElement(f),O=this.getId(F),_=this.getDragManager();T.parentNode.removeChild(T),F.appendChild(T),_&&_.setParent(T,k,F,O)},extend:function(w,f,T){var k;if(T)for(k=0;k<T.length;k++)w[T[k]]=f[T[k]];else for(k in f)w[k]=f[k];return w},floatingConnections:{},getFloatingAnchorIndex:function(w){return w.endpoints[0].isFloating()?0:w.endpoints[1].isFloating()?1:-1},proxyConnection:function(w,f,T,k,F,O){var _,M=w.endpoints[f].elementId,b=w.endpoints[f];w.proxies=w.proxies||[],w.proxies[f]?_=w.proxies[f].ep:_=this.addEndpoint(T,{endpoint:F(w,f),anchor:O(w,f),parameters:{isProxyEndpoint:!0}}),_.setDeleteOnEmpty(!0),w.proxies[f]={ep:_,originalEp:b},f===0?this.router.sourceOrTargetChanged(M,k,w,T,0):this.router.sourceOrTargetChanged(M,k,w,T,1),b.detachFromConnection(w,null,!0),_.connections=[w],w.endpoints[f]=_,b.setVisible(!1),w.setVisible(!0),this.revalidate(T)},unproxyConnection:function(w,f,T){if(!(w._jsPlumb==null||w.proxies==null||w.proxies[f]==null)){var k=w.proxies[f].originalEp.element,F=w.proxies[f].originalEp.elementId;w.endpoints[f]=w.proxies[f].originalEp,f===0?this.router.sourceOrTargetChanged(T,F,w,k,0):this.router.sourceOrTargetChanged(T,F,w,k,1),w.proxies[f].ep.detachFromConnection(w,null),w.proxies[f].originalEp.addConnection(w),w.isVisible()&&w.proxies[f].originalEp.setVisible(!0),delete w.proxies[f]}}});var C=new x;e.jsPlumb=C,C.getInstance=function(w,f){var T=new x(w);if(f)for(var k in f)T[k]=f[k];return T.init(),T},C.each=function(w,f){if(w!=null)if(typeof w=="string")f(C.getElement(w));else if(w.length!=null)for(var T=0;T<w.length;T++)f(C.getElement(w[T]));else f(w)},n.jsPlumb=C}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a="__label",o=u(function(i,d){var c={cssClass:d.cssClass,labelStyle:i.labelStyle,id:a,component:i,_jsPlumb:i._jsPlumb.instance},l=t.extend(c,d);return new t.Overlays[i._jsPlumb.instance.getRenderMode()].Label(l)},"_makeLabelOverlay"),r=u(function(i,d){var c=null;if(s.isArray(d)){var l=d[0],m=t.extend({component:i,_jsPlumb:i._jsPlumb.instance},d[1]);d.length===3&&t.extend(m,d[2]),c=new t.Overlays[i._jsPlumb.instance.getRenderMode()][l](m)}else d.constructor===String?c=new t.Overlays[i._jsPlumb.instance.getRenderMode()][d]({component:i,_jsPlumb:i._jsPlumb.instance}):c=d;return c.id=c.id||s.uuid(),i.cacheTypeItem("overlay",c,c.id),i._jsPlumb.overlays[c.id]=c,c},"_processOverlay");t.OverlayCapableJsPlumbUIComponent=function(i){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},i.label&&(this.getDefaultType().overlays[a]=["Label",{label:i.label,location:i.labelLocation||this.defaultLabelLocation||.5,labelStyle:i.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:a}]),this.setListenerComponent=function(d){if(this._jsPlumb)for(var c in this._jsPlumb.overlays)this._jsPlumb.overlays[c].setListenerComponent(d)}},t.OverlayCapableJsPlumbUIComponent.applyType=function(i,d){if(d.overlays){var c={},l;for(l in d.overlays){var m=i._jsPlumb.overlays[d.overlays[l][1].id];if(m)m.updateFrom(d.overlays[l][1]),c[d.overlays[l][1].id]=!0,m.reattach(i._jsPlumb.instance,i);else{var v=i.getCachedTypeItem("overlay",d.overlays[l][1].id);v!=null?(v.reattach(i._jsPlumb.instance,i),v.setVisible(!0),v.updateFrom(d.overlays[l][1]),i._jsPlumb.overlays[v.id]=v):v=i.addOverlay(d.overlays[l],!0),c[v.id]=!0}}for(l in i._jsPlumb.overlays)c[i._jsPlumb.overlays[l].id]==null&&i.removeOverlay(i._jsPlumb.overlays[l].id,!0)}},s.extend(t.OverlayCapableJsPlumbUIComponent,e.jsPlumbUIComponent,{setHover:function(i,d){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var c in this._jsPlumb.overlays)this._jsPlumb.overlays[c][i?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(i,d){var c=r(this,i);if(this.getData&&c.type==="Label"&&s.isArray(i)){var l=this.getData(),m=i[1];if(l){var v=m.labelLocationAttribute||"labelLocation",x=l?l[v]:null;x&&(c.loc=x)}}return d||this.repaint(),c},getOverlay:function(i){return this._jsPlumb.overlays[i]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(i){var d=this.getOverlay(i);d&&d.hide()},hideOverlays:function(){for(var i in this._jsPlumb.overlays)this._jsPlumb.overlays[i].hide()},showOverlay:function(i){var d=this.getOverlay(i);d&&d.show()},showOverlays:function(){for(var i in this._jsPlumb.overlays)this._jsPlumb.overlays[i].show()},removeAllOverlays:function(i){for(var d in this._jsPlumb.overlays)this._jsPlumb.overlays[d].cleanup&&this._jsPlumb.overlays[d].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},i||this.repaint()},removeOverlay:function(i,d){var c=this._jsPlumb.overlays[i];c&&(c.setVisible(!1),!d&&c.cleanup&&c.cleanup(),delete this._jsPlumb.overlays[i],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[i],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[i])},removeOverlays:function(){for(var i=0,d=arguments.length;i<d;i++)this.removeOverlay(arguments[i])},moveParent:function(i){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),i.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),i.appendChild(this.canvas);for(var d in this._jsPlumb.overlays)if(this._jsPlumb.overlays[d].isAppendedAtTopLevel){var c=this._jsPlumb.overlays[d].getElement();c.parentNode.removeChild(c),i.appendChild(c)}}},getLabel:function(){var i=this.getOverlay(a);return i!=null?i.getLabel():null},getLabelOverlay:function(){return this.getOverlay(a)},setLabel:function(i){var d=this.getOverlay(a);if(d)i.constructor===String||i.constructor===Function?d.setLabel(i):(i.label&&d.setLabel(i.label),i.location&&d.setLocation(i.location));else{var c=i.constructor===String||i.constructor===Function?{label:i}:i;d=o(this,c),this._jsPlumb.overlays[a]=d}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(i){for(var d in this._jsPlumb.overlays)this._jsPlumb.overlays[d].cleanup(i),this._jsPlumb.overlays[d].destroy(i);i&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(i){this[i?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(i,d){this._jsPlumb.overlayPositions[i.id]=d},getAbsoluteOverlayPosition:function(i){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[i.id]:null},_clazzManip:function(i,d,c){if(!c)for(var l in this._jsPlumb.overlays)this._jsPlumb.overlays[l][i+"Class"](d)},addClass:function(i,d){this._clazzManip("add",i,d)},removeClass:function(i,d){this._clazzManip("remove",i,d)}})}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a=u(function(c,l,m){var v=!1;return{drag:function(){if(v)return v=!1,!0;if(l.element){var x=m.getUIPosition(arguments,m.getZoom());x!=null&&m.setPosition(l.element,x),m.repaint(l.element,x),c.paint({anchorPoint:c.anchor.getCurrentLocation({element:c})})}},stopDrag:function(){v=!0}}},"_makeConnectionDragHandler"),o=u(function(c,l,m,v){var x=l.createElement("div",{position:"absolute"});l.appendElement(x);var C=l.getId(x);l.setPosition(x,m),x.style.width=v[0]+"px",x.style.height=v[1]+"px",l.manage(C,x,!0),c.id=C,c.element=x},"_makeDraggablePlaceholder"),r=u(function(c,l,m,v,x,C,w,f){var T=new t.FloatingAnchor({reference:l,referenceCanvas:v,jsPlumbInstance:C});return w({paintStyle:c,endpoint:m,anchor:T,source:x,scope:f})},"_makeFloatingEndpoint"),i=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],d=u(function(c,l){var m=0;if(l!=null){for(var v=0;v<c.connections.length;v++)if(c.connections[v].sourceId===l||c.connections[v].targetId===l){m=v;break}}return c.connections[m]},"findConnectionToUseForDynamicAnchor");t.Endpoint=function(c){var l=c._jsPlumb,m=c.newConnection,v=c.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],t.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:c.connectionType,maxConnections:c.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:c.maxConnections,paintStyle:c.endpointStyle||c.paintStyle||c.style||this._jsPlumb.instance.Defaults.EndpointStyle||t.Defaults.EndpointStyle,hoverPaintStyle:c.endpointHoverStyle||c.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||t.Defaults.EndpointHoverStyle,connectorStyle:c.connectorStyle,connectorHoverStyle:c.connectorHoverStyle,connectorClass:c.connectorClass,connectorHoverClass:c.connectorHoverClass,connectorOverlays:c.connectorOverlays,connector:c.connector,connectorTooltip:c.connectorTooltip}),this._jsPlumb.enabled=c.enabled!==!1,this._jsPlumb.visible=!0,this.element=t.getElement(c.source),this._jsPlumb.uuid=c.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(c.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=c.elementId,this.dragProxy=c.dragProxy,this._jsPlumb.connectionCost=c.connectionCost,this._jsPlumb.connectionsDirected=c.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var x=c.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(_){x=_};var C=function(){var _=l.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var M=l.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(_),this.addClass(M),t.updateClasses(this.element,M,_)}.bind(this);this.prepareAnchor=function(_){var M=this._jsPlumb.instance.makeAnchor(_,this.elementId,l);return M.bind("anchorChanged",function(b){this.fire("anchorChanged",{endpoint:this,anchor:b}),C()}.bind(this)),M},this.setPreparedAnchor=function(_,M){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=_,C(),M||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(_,M){var b=this.prepareAnchor(_);return this.setPreparedAnchor(b,M),this};var w=function(_){if(this.connections.length>0)for(var M=0;M<this.connections.length;M++)this.connections[M].setHover(_,!1);else this.setHover(_)}.bind(this);this.bind("mouseover",function(){w(!0)}),this.bind("mouseout",function(){w(!1)}),c._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(_,M){var b=u(function(N,z){var I=l.getRenderMode();if(t.Endpoints[I][N])return new t.Endpoints[I][N](z);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+N+"'"}},"_e"),P={_jsPlumb:this._jsPlumb.instance,cssClass:c.cssClass,container:c.container,tooltip:c.tooltip,connectorTooltip:c.connectorTooltip,endpoint:this},L;return s.isString(_)?L=b(_,P):s.isArray(_)?(P=s.merge(_[1],P),L=b(_[0],P)):L=_.clone(),L.clone=function(){if(s.isString(_))return b(_,P);if(s.isArray(_))return P=s.merge(_[1],P),b(_[0],P)}.bind(this),L.typeId=M,L},this.setEndpoint=function(_,M){var b=this.prepareEndpoint(_);this.setPreparedEndpoint(b,!0)},this.setPreparedEndpoint=function(_,M){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=_,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},t.extend(this,c,i),this.isSource=c.isSource||!1,this.isTemporarySource=c.isTemporarySource||!1,this.isTarget=c.isTarget||!1,this.connections=c.connections||[],this.connectorPointerEvents=c["connector-pointer-events"],this.scope=c.scope||l.getDefaultScope(),this.timestamp=null,this.reattachConnections=c.reattach||l.Defaults.ReattachConnections,this.connectionsDetachable=l.Defaults.ConnectionsDetachable,(c.connectionsDetachable===!1||c.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=c.dragAllowedWhenFull!==!1,c.onMaxConnections&&this.bind("maxConnections",c.onMaxConnections),this.addConnection=function(_){this.connections.push(_),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)},this.detachFromConnection=function(_,M,b){M=M??this.connections.indexOf(_),M>=0&&(this.connections.splice(M,1),this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)),!b&&x&&this.connections.length===0&&l.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:b!==!0})},this.deleteEveryConnection=function(_){for(var M=this.connections.length,b=0;b<M;b++)l.deleteConnection(this.connections[0],_)},this.detachFrom=function(_,M,b){for(var P=[],L=0;L<this.connections.length;L++)(this.connections[L].endpoints[1]===_||this.connections[L].endpoints[0]===_)&&P.push(this.connections[L]);for(var N=0,z=P.length;N<z;N++)l.deleteConnection(P[0]);return this},this.getElement=function(){return this.element},this.setElement=function(_){var M=this._jsPlumb.instance.getId(_),b=this.elementId;return s.removeWithFunction(c.endpointsByElement[this.elementId],function(P){return P.id===this.id}.bind(this)),this.element=t.getElement(_),this.elementId=l.getId(this.element),l.router.rehomeEndpoint(this,b,this.element),l.dragManager.endpointAdded(this.element),s.addToList(c.endpointsByElement,M,this),this},this.makeInPlaceCopy=function(){var _=this.anchor.getCurrentLocation({element:this}),M=this.anchor.getOrientation(this),b=this.anchor.getCssClass(),P={bind:function(){},compute:function(){return[_[0],_[1]]},getCurrentLocation:function(){return[_[0],_[1]]},getOrientation:function(){return M},getCssClass:function(){return b}};return v({dropOptions:c.dropOptions,anchor:P,source:this.element,paintStyle:this.getPaintStyle(),endpoint:c.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(_){_=_||{};var M=_.timestamp,b=_.recalc!==!1;if(!M||this.timestamp!==M){var P=l.updateOffset({elId:this.elementId,timestamp:M}),L=_.offset?_.offset.o:P.o;if(L!=null){var N=_.anchorPoint,z=_.connectorPaintStyle;if(N==null){var I=_.dimensions||P.s,W={xy:[L.left,L.top],wh:I,element:this,timestamp:M};if(b&&this.anchor.isDynamic&&this.connections.length>0){var B=d(this,_.elementWithPrecedence),K=B.endpoints[0]===this?1:0,q=K===0?B.sourceId:B.targetId,X=l.getCachedData(q),Q=X.o,V=X.s;W.index=K===0?1:0,W.connection=B,W.txy=[Q.left,Q.top],W.twh=V,W.tElement=B.endpoints[K],W.tRotation=l.getRotation(q)}else this.connections.length>0&&(W.connection=this.connections[0]);W.rotation=l.getRotation(this.elementId),N=this.anchor.compute(W)}this.endpoint.compute(N,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,z||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=M;for(var J in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(J)){var A=this._jsPlumb.overlays[J];A.isVisible()&&(this._jsPlumb.overlayPlacements[J]=A.draw(this.endpoint,this._jsPlumb.paintStyleInUse),A.paint(this._jsPlumb.overlayPlacements[J]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var f=!1;this.initDraggable=function(){if(!f&&t.isDragSupported(this.element)){var _={id:null,element:null},M=null,b=!1,P=null,L=a(this,_,l),N=c.dragOptions||{},z={},I=t.dragEvents.start,W=t.dragEvents.stop,B=t.dragEvents.drag,K=t.dragEvents.beforeStart,q,X=u(function(J){q=J.e.payload||{}},"beforeStart"),Q=function(J){M=this.connectorSelector();var A=!0;this.isEnabled()||(A=!1),M==null&&!this.isSource&&!this.isTemporarySource&&(A=!1),this.isSource&&this.isFull()&&!(M!=null&&this.dragAllowedWhenFull)&&(A=!1),M!=null&&!M.isDetachable(this)&&(this.isFull()?A=!1:M=null);var j=l.checkCondition(M==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:M});if(j===!1?A=!1:typeof j=="object"?t.extend(j,q||{}):j=q||{},A===!1)return l.stopDrag&&l.stopDrag(this.canvas),L.stopDrag(),!1;for(var S=0;S<this.connections.length;S++)this.connections[S].setHover(!1);this.addClass("endpointDrag"),l.setConnectionBeingDragged(!0),M&&!this.isFull()&&this.isSource&&(M=null),l.updateOffset({elId:this.elementId});var U=this._jsPlumb.instance.getOffset(this.canvas),G=this.canvas,Y=this._jsPlumb.instance.getSize(this.canvas);o(_,l,U,Y),l.setAttributes(this.canvas,{dragId:_.id,elId:this.elementId});var se=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var le=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);le.endpoints[1]&&(se=le.endpoints[1])}var ne=this._jsPlumb.instance.makeAnchor("Center");ne.isFloating=!0,this._jsPlumb.floatingEndpoint=r(this.getPaintStyle(),ne,se,this.canvas,_.element,l,v,this.scope);var he=this._jsPlumb.floatingEndpoint.anchor;if(M==null)this.setHover(!1,!1),M=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:_.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:c.connectorStyle,hoverPaintStyle:c.connectorHoverStyle,connector:c.connector,overlays:c.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:c.scope,data:j}),M.pending=!0,M.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.anchor=he,l.fire("connectionDrag",M),l.router.newConnection(M);else{b=!0,M.setHover(!1);var pe=M.endpoints[0].id===this.id?0:1;this.detachFromConnection(M,null,!0);var fe=l.getDragScope(G);l.setAttribute(this.canvas,"originalScope",fe),l.fire("connectionDrag",M),pe===0?(P=[M.source,M.sourceId,G,fe],l.router.sourceOrTargetChanged(M.endpoints[pe].elementId,_.id,M,_.element,0)):(P=[M.target,M.targetId,G,fe],l.router.sourceOrTargetChanged(M.endpoints[pe].elementId,_.id,M,_.element,1)),M.suspendedEndpoint=M.endpoints[pe],M.suspendedElement=M.endpoints[pe].getElement(),M.suspendedElementId=M.endpoints[pe].elementId,M.suspendedElementType=pe===0?"source":"target",M.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=M.suspendedEndpoint,M.endpoints[pe]=this._jsPlumb.floatingEndpoint,M.addClass(l.draggingClass),this._jsPlumb.floatingEndpoint.addClass(l.draggingClass)}l.registerFloatingConnection(_,M,this._jsPlumb.floatingEndpoint),l.currentlyDragging=!0}.bind(this),V=function(){if(l.setConnectionBeingDragged(!1),M&&M.endpoints!=null){var J=l.getDropEvent(arguments),A=l.getFloatingAnchorIndex(M);if(M.endpoints[A===0?1:0].anchor.locked=!1,M.removeClass(l.draggingClass),this._jsPlumb&&(M.deleteConnectionNow||M.endpoints[A]===this._jsPlumb.floatingEndpoint)&&b&&M.suspendedEndpoint){A===0?(M.floatingElement=M.source,M.floatingId=M.sourceId,M.floatingEndpoint=M.endpoints[0],M.floatingIndex=0,M.source=P[0],M.sourceId=P[1]):(M.floatingElement=M.target,M.floatingId=M.targetId,M.floatingEndpoint=M.endpoints[1],M.floatingIndex=1,M.target=P[0],M.targetId=P[1]);var j=this._jsPlumb.floatingEndpoint;l.setDragScope(P[2],P[3]),M.endpoints[A]=M.suspendedEndpoint,M.isReattach()||M._forceReattach||M._forceDetach||!l.deleteConnection(M,{originalEvent:J})?(M.setHover(!1),M._forceDetach=null,M._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(M),M.suspendedEndpoint.addConnection(M),A===1?l.router.sourceOrTargetChanged(M.floatingId,M.targetId,M,M.target,A):l.router.sourceOrTargetChanged(M.floatingId,M.sourceId,M,M.source,A),l.repaint(P[1])):l.deleteObject({endpoint:j})}this.deleteAfterDragStop?l.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),l.fire("connectionDragStop",M,J),M.pending&&l.fire("connectionAborted",M,J),l.currentlyDragging=!1,M.suspendedElement=null,M.suspendedEndpoint=null,M=null}_&&_.element&&l.remove(_.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);N=t.extend(z,N),N.scope=this.scope||N.scope,N[K]=s.wrap(N[K],X,!1),N[I]=s.wrap(N[I],Q,!1),N[B]=s.wrap(N[B],L.drag),N[W]=s.wrap(N[W],V),N.multipleDrop=!1,N.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),l.initDraggable(this.canvas,N,"internal"),this.canvas._jsPlumbRelatedElement=this.element,f=!0}};var T=c.endpoint||this._jsPlumb.instance.Defaults.Endpoint||t.Defaults.Endpoint;this.setEndpoint(T,!0);var k=c.anchor?c.anchor:c.anchors?c.anchors:l.Defaults.Anchor||"Top";this.setAnchor(k,!0);var F=["default",c.type||""].join(" ");this.addType(F,c.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var O=function(_,M,b,P){if(t.isDropSupported(this.element)){var L=c.dropOptions||l.Defaults.DropOptions||t.Defaults.DropOptions;L=t.extend({},L),L.scope=L.scope||this.scope;var N=t.dragEvents.drop,z=t.dragEvents.over,I=t.dragEvents.out,W=this,B=l.EndpointDropHandler({getEndpoint:function(){return W},jsPlumb:l,enabled:function(){return b!=null?b.isEnabled():!0},isFull:function(){return b.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(K){W.addClass(K)},removeClass:function(K){W.removeClass(K)},isDropAllowed:function(){return W.isDropAllowed.apply(W,arguments)},reference:P,isRedrop:function(K,q){return K.suspendedEndpoint&&q.reference&&K.suspendedEndpoint.id===q.reference.id}});L[N]=s.wrap(L[N],B,!0),L[z]=s.wrap(L[z],function(){var K=t.getDragObject(arguments),q=l.getAttribute(t.getElement(K),"dragId"),X=l.getFloatingConnectionFor(q);if(X!=null){var Q=l.getFloatingAnchorIndex(X),V=this.isTarget&&Q!==0||X.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===X.suspendedEndpoint.id;if(V){var J=l.checkCondition("checkDropAllowed",{sourceEndpoint:X.endpoints[Q],targetEndpoint:this,connection:X});this[(J?"add":"remove")+"Class"](l.endpointDropAllowedClass),this[(J?"remove":"add")+"Class"](l.endpointDropForbiddenClass),X.endpoints[Q].anchor.over(this.anchor,this)}}}.bind(this)),L[I]=s.wrap(L[I],function(){var K=t.getDragObject(arguments),q=K==null?null:l.getAttribute(t.getElement(K),"dragId"),X=q?l.getFloatingConnectionFor(q):null;if(X!=null){var Q=l.getFloatingAnchorIndex(X),V=this.isTarget&&Q!==0||X.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===X.suspendedEndpoint.id;V&&(this.removeClass(l.endpointDropAllowedClass),this.removeClass(l.endpointDropForbiddenClass),X.endpoints[Q].anchor.out())}}.bind(this)),l.initDroppable(_,L,"internal",M)}}.bind(this);return this.anchor.isFloating||O(this.canvas,!(c._transient||this.anchor.isFloating),this,c.reference),this},s.extend(t.Endpoint,t.OverlayCapableJsPlumbUIComponent,{setVisible:function(c,l,m){if(this._jsPlumb.visible=c,this.canvas&&(this.canvas.style.display=c?"block":"none"),this[c?"showOverlays":"hideOverlays"](),!l){for(var v=0;v<this.connections.length;v++)if(this.connections[v].setVisible(c),!m){var x=this===this.connections[v].endpoints[0]?1:0;this.connections[v].endpoints[x].connections.length===1&&this.connections[v].endpoints[x].setVisible(c,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(c,l){this.setPaintStyle(c.endpointStyle||c.paintStyle,l),this.setHoverPaintStyle(c.endpointHoverStyle||c.hoverPaintStyle,l),c.maxConnections!=null&&(this._jsPlumb.maxConnections=c.maxConnections),c.scope&&(this.scope=c.scope),t.extend(this,c,i),c.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,c.cssClass),t.OverlayCapableJsPlumbUIComponent.applyType(this,c)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(c){this._jsPlumb.enabled=c},cleanup:function(){var c=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");t.removeClass(this.element,c),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(c){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(c)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(c){var l=!1;if(c){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===c||this.connections[m].endpoints[0]===c){l=!0;break}}return l},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(c){this._jsPlumb.connectionCost=c},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(c){this._jsPlumb.connectionsDirected=c},setElementId:function(c){this.elementId=c,this.anchor.elementId=c},setReferenceElement:function(c){this.element=t.getElement(c)},setDragAllowedWhenFull:function(c){this.dragAllowedWhenFull=c},equals:function(c){return this.anchor.equals(c.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(c){return this.anchor.compute(c)}}),e.jsPlumbInstance.prototype.EndpointDropHandler=function(c){return function(l){var m=c.jsPlumb;c.removeClass(m.endpointDropAllowedClass),c.removeClass(m.endpointDropForbiddenClass);var v=m.getDropEvent(arguments),x=m.getDragObject(arguments),C=m.getAttribute(x,"dragId");m.getAttribute(x,"elId");var w=m.getAttribute(x,"originalScope"),f=m.getFloatingConnectionFor(C);if(f!=null){var T=f.suspendedEndpoint!=null;if(!(T&&f.suspendedEndpoint._jsPlumb==null)){var k=c.getEndpoint(f);if(k!=null){if(c.isRedrop(f,c)){f._forceReattach=!0,f.setHover(!1),c.maybeCleanup&&c.maybeCleanup(k);return}var F=m.getFloatingAnchorIndex(f);if(F===0&&!c.isSource||F===1&&!c.isTarget){c.maybeCleanup&&c.maybeCleanup(k);return}c.onDrop&&c.onDrop(f),w&&m.setDragScope(x,w);var O=c.isFull(l);if(O&&k.fire("maxConnections",{endpoint:this,connection:f,maxConnections:k._jsPlumb.maxConnections},v),!O&&c.enabled()){var _=!0;F===0?(f.floatingElement=f.source,f.floatingId=f.sourceId,f.floatingEndpoint=f.endpoints[0],f.floatingIndex=0,f.source=c.element,f.sourceId=m.getId(c.element)):(f.floatingElement=f.target,f.floatingId=f.targetId,f.floatingEndpoint=f.endpoints[1],f.floatingIndex=1,f.target=c.element,f.targetId=m.getId(c.element)),T&&f.suspendedEndpoint.id!==k.id&&(!f.isDetachAllowed(f)||!f.endpoints[F].isDetachAllowed(f)||!f.suspendedEndpoint.isDetachAllowed(f)||!m.checkCondition("beforeDetach",f))&&(_=!1);var M=function(P){f.endpoints[F].detachFromConnection(f),f.suspendedEndpoint&&f.suspendedEndpoint.detachFromConnection(f),f.endpoints[F]=k,k.addConnection(f);var L=k.getParameters();for(var N in L)f.setParameter(N,L[N]);if(!T)L.draggable&&m.initDraggable(this.element,c.dragOptions,"internal",m);else{var z=f.suspendedEndpoint.elementId;m.fireMoveEvent({index:F,originalSourceId:F===0?z:f.sourceId,newSourceId:F===0?k.elementId:f.sourceId,originalTargetId:F===1?z:f.targetId,newTargetId:F===1?k.elementId:f.targetId,originalSourceEndpoint:F===0?f.suspendedEndpoint:f.endpoints[0],newSourceEndpoint:F===0?k:f.endpoints[0],originalTargetEndpoint:F===1?f.suspendedEndpoint:f.endpoints[1],newTargetEndpoint:F===1?k:f.endpoints[1],connection:f},v)}if(F===1?m.router.sourceOrTargetChanged(f.floatingId,f.targetId,f,f.target,1):m.router.sourceOrTargetChanged(f.floatingId,f.sourceId,f,f.source,0),f.endpoints[0].finalEndpoint){var I=f.endpoints[0];I.detachFromConnection(f),f.endpoints[0]=f.endpoints[0].finalEndpoint,f.endpoints[0].addConnection(f)}s.isObject(P)&&f.mergeData(P),m.finaliseConnection(f,null,v,!1),f.setHover(!1),m.revalidate(f.endpoints[0].element)}.bind(this),b=u(function(){f.suspendedEndpoint&&(f.endpoints[F]=f.suspendedEndpoint,f.setHover(!1),f._forceDetach=!0,F===0?(f.source=f.suspendedEndpoint.element,f.sourceId=f.suspendedEndpoint.elementId):(f.target=f.suspendedEndpoint.element,f.targetId=f.suspendedEndpoint.elementId),f.suspendedEndpoint.addConnection(f),F===1?m.router.sourceOrTargetChanged(f.floatingId,f.targetId,f,f.target,1):m.router.sourceOrTargetChanged(f.floatingId,f.sourceId,f,f.source,0),m.repaint(f.sourceId),f._forceDetach=!1)},"dontContinueFunction");if(_=_&&c.isDropAllowed(f.sourceId,f.targetId,f.scope,f,k),_)return M(_),!0;b()}c.maybeCleanup&&c.maybeCleanup(k),m.currentlyDragging=!1}}}}}}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a=u(function(i,d,c,l,m){if(t.Connectors[d]=t.Connectors[d]||{},t.Connectors[d][c]==null){if(t.Connectors[c]==null){if(i.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+c+"'")}t.Connectors[d][c]=function(){t.Connectors[c].apply(this,arguments),t.ConnectorRenderers[d].apply(this,arguments)},s.extend(t.Connectors[d][c],[t.Connectors[c],t.ConnectorRenderers[d]])}return new t.Connectors[d][c](l,m)},"makeConnector"),o=u(function(i,d,c){return i?c.makeAnchor(i,d,c):null},"_makeAnchor"),r=u(function(i,d,c,l){d!=null&&(d._jsPlumbConnections=d._jsPlumbConnections||{},l?delete d._jsPlumbConnections[i.id]:d._jsPlumbConnections[i.id]=!0,s.isEmpty(d._jsPlumbConnections)?c.removeClass(d,c.connectedClass):c.addClass(d,c.connectedClass))},"_updateConnectedClass");t.Connection=function(i){var d=i.newEndpoint;this.id=i.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=i.previousConnection,this.source=t.getElement(i.source),this.target=t.getElement(i.target),t.OverlayCapableJsPlumbUIComponent.apply(this,arguments),i.sourceEndpoint?(this.source=i.sourceEndpoint.getElement(),this.sourceId=i.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),i.targetEndpoint?(this.target=i.targetEndpoint.getElement(),this.targetId=i.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=i.scope,this.endpoints=[],this.endpointStyles=[];var c=this._jsPlumb.instance;c.manage(this.sourceId,this.source),c.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:i.cssClass,container:i.container,"pointer-events":i["pointer-events"],editorParams:i.editorParams,overlays:i.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(N,z,I,W,B){return I=I||this._jsPlumb.instance.getId(z),this.prepareEndpoint(c,d,this,W,N?0:1,i,z,I,B)},i.type&&(i.endpoints=i.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(i.type).endpoints);var l=this.makeEndpoint(!0,this.source,this.sourceId,i.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,i.targetEndpoint);l&&s.addToList(i.endpointsByElement,this.sourceId,l),m&&s.addToList(i.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),i.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(i.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(i.deleteEndpointsOnEmpty));var v=c.Defaults.ConnectionsDetachable;i.detachable===!1&&(v=!1),this.endpoints[0].connectionsDetachable===!1&&(v=!1),this.endpoints[1].connectionsDetachable===!1&&(v=!1);var x=i.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||c.Defaults.ReattachConnections;this.appendToDefaultType({detachable:v,reattach:x,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||i.paintStyle||c.Defaults.PaintStyle||t.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||c.Defaults.HoverPaintStyle||t.Defaults.HoverPaintStyle});var C=c.getSuspendedAt();if(!c.isSuspendDrawing()){var w=c.getCachedData(this.sourceId),f=w.o,T=w.s,k=c.getCachedData(this.targetId),F=k.o,O=k.s,_=C||jsPlumbUtil.uuid(),M=this.endpoints[0].anchor.compute({xy:[f.left,f.top],wh:T,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[F.left,F.top],twh:O,tElement:this.endpoints[1],timestamp:_,rotation:c.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:M,timestamp:_}),M=this.endpoints[1].anchor.compute({xy:[F.left,F.top],wh:O,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[f.left,f.top],twh:T,tElement:this.endpoints[0],timestamp:_,rotation:c.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:M,timestamp:_})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(N){return this._jsPlumb.detachable===!1?!1:N!=null?N.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(N){this._jsPlumb.detachable=N===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(N){this._jsPlumb.reattach=N===!0},this._jsPlumb.cost=i.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=i.directed,i.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var b=t.extend({},this.endpoints[1].getParameters());t.extend(b,this.endpoints[0].getParameters()),t.extend(b,this.getParameters()),this.setParameters(b),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||i.connector||c.Defaults.Connector||t.Defaults.Connector,!0);var P=i.data==null||!s.isObject(i.data)?{}:i.data;this.getData=function(){return P},this.setData=function(N){P=N||{}},this.mergeData=function(N){P=t.extend(P,N)};var L=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,i.type].join(" ");/[^\s]/.test(L)&&this.addType(L,i.data,!0),this.updateConnectedClass()},s.extend(t.Connection,t.OverlayCapableJsPlumbUIComponent,{applyType:function(i,d,c){var l=null;i.connector!=null&&(l=this.getCachedTypeItem("connector",c.connector),l==null&&(l=this.prepareConnector(i.connector,c.connector),this.cacheTypeItem("connector",l,c.connector)),this.setPreparedConnector(l)),i.detachable!=null&&this.setDetachable(i.detachable),i.reattach!=null&&this.setReattach(i.reattach),i.scope&&(this.scope=i.scope),i.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,i.cssClass);var m=null;i.anchor?(m=this.getCachedTypeItem("anchors",c.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(i.anchor),this._jsPlumb.instance.makeAnchor(i.anchor)],this.cacheTypeItem("anchors",m,c.anchor))):i.anchors&&(m=this.getCachedTypeItem("anchors",c.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(i.anchors[0]),this._jsPlumb.instance.makeAnchor(i.anchors[1])],this.cacheTypeItem("anchors",m,c.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),t.OverlayCapableJsPlumbUIComponent.applyType(this,i)},addClass:function(i,d){d&&(this.endpoints[0].addClass(i),this.endpoints[1].addClass(i),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(i)),this.connector&&this.connector.addClass(i)},removeClass:function(i,d){d&&(this.endpoints[0].removeClass(i),this.endpoints[1].removeClass(i),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(i)),this.connector&&this.connector.removeClass(i)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(i){this._jsPlumb.visible=i,this.connector&&this.connector.setVisible(i),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(i){this._jsPlumb&&(r(this,this.source,this._jsPlumb.instance,i),r(this,this.target,this._jsPlumb.instance,i))},setHover:function(i){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(i),e.jsPlumb[i?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),e.jsPlumb[i?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(i){this._jsPlumb.cost=i},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(i,d){var c={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},l=this._jsPlumb.instance.getRenderMode(),m;return s.isString(i)?m=a(this._jsPlumb.instance,l,i,c,this):s.isArray(i)&&(i.length===1?m=a(this._jsPlumb.instance,l,i[0],c,this):m=a(this._jsPlumb.instance,l,i[0],s.merge(i[1],c),this)),d!=null&&(m.typeId=d),m},setPreparedConnector:function(i,d,c,l){if(this.connector!==i){var m,v="";if(this.connector!=null&&(m=this.connector,v=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=i,l&&this.cacheTypeItem("connector",i,l),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(v),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var x=this.getOverlays(),C=0;C<x.length;C++)x[C].transfer&&x[C].transfer(this.connector);c||this.setListenerComponent(this.connector),d||this.repaint()}},setConnector:function(i,d,c,l){var m=this.prepareConnector(i,l);this.setPreparedConnector(m,d,c,l)},paint:function(i){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){i=i||{};var d=i.timestamp,c=!1,l=c?this.sourceId:this.targetId,m=c?this.targetId:this.sourceId,v=c?0:1,x=c?1:0;if(d==null||d!==this._jsPlumb.lastPaintedAt){var C=this._jsPlumb.instance.updateOffset({elId:m}).o,w=this._jsPlumb.instance.updateOffset({elId:l}).o,f=this.endpoints[x],T=this.endpoints[v],k=f.anchor.getCurrentLocation({xy:[C.left,C.top],wh:[C.width,C.height],element:f,timestamp:d,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),F=T.anchor.getCurrentLocation({xy:[w.left,w.top],wh:[w.width,w.height],element:T,timestamp:d,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:k,targetPos:F,sourceOrientation:f.anchor.getOrientation(f),targetOrientation:T.anchor.getOrientation(T),sourceEndpoint:this.endpoints[x],targetEndpoint:this.endpoints[v],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:C,targetInfo:w});var O={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var _ in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(_)){var M=this._jsPlumb.overlays[_];M.isVisible()&&(this._jsPlumb.overlayPlacements[_]=M.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(M)),O.minX=Math.min(O.minX,this._jsPlumb.overlayPlacements[_].minX),O.maxX=Math.max(O.maxX,this._jsPlumb.overlayPlacements[_].maxX),O.minY=Math.min(O.minY,this._jsPlumb.overlayPlacements[_].minY),O.maxY=Math.max(O.maxY,this._jsPlumb.overlayPlacements[_].maxY))}var b=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,P=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),L={xmin:Math.min(this.connector.bounds.minX-(b+P),O.minX),ymin:Math.min(this.connector.bounds.minY-(b+P),O.minY),xmax:Math.max(this.connector.bounds.maxX+(b+P),O.maxX),ymax:Math.max(this.connector.bounds.maxY+(b+P),O.maxY)};this.connector.paintExtents=L,this.connector.paint(this._jsPlumb.paintStyleInUse,null,L);for(var N in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(N)){var z=this._jsPlumb.overlays[N];z.isVisible()&&z.paint(this._jsPlumb.overlayPlacements[N],L)}}this._jsPlumb.lastPaintedAt=d}},repaint:function(i){var d=jsPlumb.extend(i||{},{});d.elId=this.sourceId,this.paint(d)},prepareEndpoint:function(i,d,c,l,m,v,x,C,w){var f;if(l)c.endpoints[m]=l,l.addConnection(c);else{v.endpoints||(v.endpoints=[null,null]);var T=w||v.endpoints[m]||v.endpoint||i.Defaults.Endpoints[m]||t.Defaults.Endpoints[m]||i.Defaults.Endpoint||t.Defaults.Endpoint;v.endpointStyles||(v.endpointStyles=[null,null]),v.endpointHoverStyles||(v.endpointHoverStyles=[null,null]);var k=v.endpointStyles[m]||v.endpointStyle||i.Defaults.EndpointStyles[m]||t.Defaults.EndpointStyles[m]||i.Defaults.EndpointStyle||t.Defaults.EndpointStyle;k.fill==null&&v.paintStyle!=null&&(k.fill=v.paintStyle.stroke),k.outlineStroke==null&&v.paintStyle!=null&&(k.outlineStroke=v.paintStyle.outlineStroke),k.outlineWidth==null&&v.paintStyle!=null&&(k.outlineWidth=v.paintStyle.outlineWidth);var F=v.endpointHoverStyles[m]||v.endpointHoverStyle||i.Defaults.EndpointHoverStyles[m]||t.Defaults.EndpointHoverStyles[m]||i.Defaults.EndpointHoverStyle||t.Defaults.EndpointHoverStyle;v.hoverPaintStyle!=null&&(F==null&&(F={}),F.fill==null&&(F.fill=v.hoverPaintStyle.stroke));var O=v.anchors?v.anchors[m]:v.anchor?v.anchor:o(i.Defaults.Anchors[m],C,i)||o(t.Defaults.Anchors[m],C,i)||o(i.Defaults.Anchor,C,i)||o(t.Defaults.Anchor,C,i),_=v.uuids?v.uuids[m]:null;f=d({paintStyle:k,hoverPaintStyle:F,endpoint:T,connections:[c],uuid:_,anchor:O,source:x,scope:v.scope,reattach:v.reattach||i.Defaults.ReattachConnections,detachable:v.detachable||i.Defaults.ConnectionsDetachable}),l==null&&f.setDeleteOnEmpty(!0),c.endpoints[m]=f,v.drawEndpoints===!1&&f.setVisible(!1,!0,!0)}return f},replaceEndpoint:function(i,d){var c=this.endpoints[i],l=c.elementId,m=this._jsPlumb.instance.getEndpoints(l),v=m.indexOf(c),x=this.makeEndpoint(i===0,c.element,l,null,d);this.endpoints[i]=x,m.splice(v,1,x),this._jsPlumb.instance.deleteObject({endpoint:c,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:c,current:x}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumbUtil,s=e.jsPlumb;s.AnchorManager=function(i){var d={},c={},l={},m={},v=this,x={},C=i.jsPlumbInstance,w={},f=u(function(L,N,z,I,W,B,K,q){for(var X=[],Q=N[W?0:1]/(I.length+1),V=0;V<I.length;V++){var J=(V+1)*Q,A=B*N[W?1:0];K&&(J=N[W?0:1]-J);var j=W?J:A,S=z.left+j,U=j/N[0],G=W?A:J,Y=z.top+G,se=G/N[1];if(q!==0){var le=jsPlumbUtil.rotatePoint([S,Y],[z.centerx,z.centery],q);S=le[0],Y=le[1]}X.push([S,Y,U,se,I[V][1],I[V][2]])}return X},"placeAnchorsOnLine"),T=u(function(L,N){return N[0][0]-L[0][0]},"rightAndBottomSort"),k=u(function(L,N){var z=L[0][0]<0?-Math.PI-L[0][0]:Math.PI-L[0][0],I=N[0][0]<0?-Math.PI-N[0][0]:Math.PI-N[0][0];return z-I},"leftAndTopSort"),F={top:k,right:T,bottom:T,left:k},O=u(function(L,N){return L.sort(N)},"_sortHelper"),_=u(function(L,N){var z=C.getCachedData(L),I=z.s,W=z.o,B=u(function(K,q,X,Q,V,J,A){if(Q.length>0)for(var j=O(Q,F[K]),S=K==="right"||K==="top",U=C.getRotation(L),G=f(K,q,X,j,V,J,S,U),Y=u(function(pe,fe){c[pe.id]=[fe[0],fe[1],fe[2],fe[3]],l[pe.id]=A},"_setAnchorLocation"),se=0;se<G.length;se++){var le=G[se][4],ne=le.endpoints[0].elementId===L,he=le.endpoints[1].elementId===L;ne&&Y(le.endpoints[0],G[se]),he&&Y(le.endpoints[1],G[se])}},"placeSomeAnchors");B("bottom",I,W,N.bottom,!0,1,[0,1]),B("top",I,W,N.top,!0,0,[0,-1]),B("left",I,W,N.left,!1,0,[-1,0]),B("right",I,W,N.right,!1,1,[1,0])},"placeAnchors");this.reset=function(){d={},m={},x={}},this.addFloatingConnection=function(L,N){w[L]=N},this.newConnection=function(L){var N=L.sourceId,z=L.targetId,I=L.endpoints,W=!0,B=u(function(K,q,X,Q,V){N===z&&X.isContinuous&&(L._jsPlumb.instance.removeElement(I[1].canvas),W=!1),t.addToList(m,Q,[V,q,X.constructor===s.DynamicAnchor])},"registerConnection");B(0,I[0],I[0].anchor,z,L),W&&B(1,I[1],I[1].anchor,N,L)};var M=u(function(L){(function(N,z){if(N){var I=u(function(W){return W[4]===z},"f");t.removeWithFunction(N.top,I),t.removeWithFunction(N.left,I),t.removeWithFunction(N.bottom,I),t.removeWithFunction(N.right,I)}})(x[L.elementId],L.id)},"removeEndpointFromAnchorLists");this.connectionDetached=function(L,N){var z=L.connection||L,I=L.sourceId,W=L.targetId,B=z.endpoints,K=u(function(q,X,Q,V,J){t.removeWithFunction(m[V],function(A){return A[0].id===J.id})},"removeConnection");K(1,B[1],B[1].anchor,I,z),K(0,B[0],B[0].anchor,W,z),z.floatingId&&(K(z.floatingIndex,z.floatingEndpoint,z.floatingEndpoint.anchor,z.floatingId,z),M(z.floatingEndpoint)),M(z.endpoints[0]),M(z.endpoints[1]),N||(v.redraw(z.sourceId),z.targetId!==z.sourceId&&v.redraw(z.targetId))},this.addEndpoint=function(L,N){t.addToList(d,N,L)},this.changeId=function(L,N){m[N]=m[L],d[N]=d[L],delete m[L],delete d[L]},this.getConnectionsFor=function(L){return m[L]||[]},this.getEndpointsFor=function(L){return d[L]||[]},this.deleteEndpoint=function(L){t.removeWithFunction(d[L.elementId],function(N){return N.id===L.id}),M(L)},this.elementRemoved=function(L){delete w[L],delete d[L],d[L]=[]};var b=u(function(L,N,z,I,W,B,K,q,X,Q,V,J){var A=-1,j=I.endpoints[K],S=j.id,U=[1,0][K],G=[[N,z],I,W,B,S],Y=L[X],se=j._continuousAnchorEdge?L[j._continuousAnchorEdge]:null,le,ne;if(se){var he=t.findWithFunction(se,function(fe){return fe[4]===S});if(he!==-1)for(se.splice(he,1),le=0;le<se.length;le++)ne=se[le][1],t.addWithFunction(V,ne,function(fe){return fe.id===ne.id}),t.addWithFunction(J,se[le][1].endpoints[K],function(fe){return fe.id===ne.endpoints[K].id}),t.addWithFunction(J,se[le][1].endpoints[U],function(fe){return fe.id===ne.endpoints[U].id})}for(le=0;le<Y.length;le++)ne=Y[le][1],i.idx===1&&Y[le][3]===B&&A===-1&&(A=le),t.addWithFunction(V,ne,function(fe){return fe.id===ne.id}),t.addWithFunction(J,Y[le][1].endpoints[K],function(fe){return fe.id===ne.endpoints[K].id}),t.addWithFunction(J,Y[le][1].endpoints[U],function(fe){return fe.id===ne.endpoints[U].id});{var pe=q?A!==-1?A:0:Y.length;Y.splice(pe,0,G)}j._continuousAnchorEdge=X},"_updateAnchorList");this.sourceOrTargetChanged=function(L,N,z,I,W){if(W===0){if(L!==N){z.sourceId=N,z.source=I,t.removeWithFunction(m[L],function(Q){return Q[0].id===z.id});var B=t.findWithFunction(m[z.targetId],function(Q){return Q[0].id===z.id});B>-1&&(m[z.targetId][B][0]=z,m[z.targetId][B][1]=z.endpoints[0],m[z.targetId][B][2]=z.endpoints[0].anchor.constructor===s.DynamicAnchor),t.addToList(m,N,[z,z.endpoints[1],z.endpoints[1].anchor.constructor===s.DynamicAnchor]),z.endpoints[1].anchor.isContinuous&&(z.source===z.target?z._jsPlumb.instance.removeElement(z.endpoints[1].canvas):z.endpoints[1].canvas.parentNode==null&&z._jsPlumb.instance.appendElement(z.endpoints[1].canvas)),z.updateConnectedClass()}}else if(W===1){var K=z.endpoints[0].elementId;z.target=I,z.targetId=N;var q=t.findWithFunction(m[K],function(Q){return Q[0].id===z.id}),X=t.findWithFunction(m[L],function(Q){return Q[0].id===z.id});q!==-1&&(m[K][q][0]=z,m[K][q][1]=z.endpoints[1],m[K][q][2]=z.endpoints[1].anchor.constructor===s.DynamicAnchor),X>-1&&(m[L].splice(X,1),t.addToList(m,N,[z,z.endpoints[0],z.endpoints[0].anchor.constructor===s.DynamicAnchor])),z.updateConnectedClass()}},this.rehomeEndpoint=function(L,N,z){var I=d[N]||[],W=C.getId(z);if(W!==N){var B=I.indexOf(L);if(B>-1){var K=I.splice(B,1)[0];v.add(K,W)}}for(var q=0;q<L.connections.length;q++)L.connections[q].sourceId===N?v.sourceOrTargetChanged(N,L.elementId,L.connections[q],L.element,0):L.connections[q].targetId===N&&v.sourceOrTargetChanged(N,L.elementId,L.connections[q],L.element,1)},this.redraw=function(L,N,z,I,W,B){var K=[],q=[],X=[];if(!C.isSuspendDrawing()){var Q=d[L]||[],V=m[L]||[];z=z||jsPlumbUtil.uuid(),I=I||{left:0,top:0},N&&(N={left:N.left+I.left,top:N.top+I.top});for(var J=C.updateOffset({elId:L,offset:N,recalc:!1,timestamp:z}),A={},j=0;j<V.length;j++){var S=V[j][0],U=S.sourceId,G=S.targetId,Y=S.endpoints[0].anchor.isContinuous,se=S.endpoints[1].anchor.isContinuous;if(Y||se){var le=U+"_"+G,ne=A[le],he=S.sourceId===L?1:0,pe=C.getRotation(G),fe=C.getRotation(U);Y&&!x[U]&&(x[U]={top:[],right:[],bottom:[],left:[]}),se&&!x[G]&&(x[G]={top:[],right:[],bottom:[],left:[]}),L!==G&&C.updateOffset({elId:G,timestamp:z}),L!==U&&C.updateOffset({elId:U,timestamp:z});var me=C.getCachedData(G),we=C.getCachedData(U);G===U&&(Y||se)?(b(x[U],-Math.PI/2,0,S,!1,G,0,!1,"top",U,K,q),b(x[G],-Math.PI/2,0,S,!1,U,1,!1,"top",G,K,q)):(ne||(ne=this.calculateOrientation(U,G,we.o,me.o,S.endpoints[0].anchor,S.endpoints[1].anchor,S,fe,pe),A[le]=ne),Y&&b(x[U],ne.theta,0,S,!1,G,0,!1,ne.a[0],U,K,q),se&&b(x[G],ne.theta2,-1,S,!0,U,1,!0,ne.a[1],G,K,q)),Y&&t.addWithFunction(X,U,function(Me){return Me===U}),se&&t.addWithFunction(X,G,function(Me){return Me===G}),t.addWithFunction(K,S,function(Me){return Me.id===S.id}),(Y&&he===0||se&&he===1)&&t.addWithFunction(q,S.endpoints[he],function(Me){return Me.id===S.endpoints[he].id})}}for(j=0;j<Q.length;j++)Q[j].connections.length===0&&Q[j].anchor.isContinuous&&(x[L]||(x[L]={top:[],right:[],bottom:[],left:[]}),b(x[L],-Math.PI/2,0,{endpoints:[Q[j],Q[j]],paint:function(){}},!1,L,0,!1,Q[j].anchor.getDefaultFace(),L,K,q),t.addWithFunction(X,L,function(Me){return Me===L}));for(j=0;j<X.length;j++)_(X[j],x[X[j]]);for(j=0;j<Q.length;j++)Q[j].paint({timestamp:z,offset:J,dimensions:J.s,recalc:B!==!0});for(j=0;j<q.length;j++){var _e=C.getCachedData(q[j].elementId);q[j].paint({timestamp:null,offset:_e,dimensions:_e.s})}for(j=0;j<V.length;j++){var je=V[j][1];if(je.anchor.constructor===s.DynamicAnchor){je.paint({elementWithPrecedence:L,timestamp:z}),t.addWithFunction(K,V[j][0],function(Me){return Me.id===V[j][0].id});for(var Pe=0;Pe<je.connections.length;Pe++)je.connections[Pe]!==V[j][0]&&t.addWithFunction(K,je.connections[Pe],function(Me){return Me.id===je.connections[Pe].id})}else t.addWithFunction(K,V[j][0],function(Me){return Me.id===V[j][0].id})}var qe=w[L];for(qe&&qe.paint({timestamp:z,recalc:!1,elId:L}),j=0;j<K.length;j++)K[j].paint({elId:L,timestamp:null,recalc:!1,clearEdits:W})}return{c:K,e:q}};var P=u(function(L){t.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var N=L.faces||["top","right","bottom","left"],z=L.clockwise!==!1,I={},W={top:"bottom",right:"left",left:"right",bottom:"top"},B={top:"right",right:"bottom",left:"top",bottom:"left"},K={top:"left",right:"top",left:"bottom",bottom:"right"},q=z?B:K,X=z?K:B,Q=L.cssClass||"",V=null,J=null,A=["left","right"],j=["top","bottom"],S=null,U=0;U<N.length;U++)I[N[U]]=!0;this.getDefaultFace=function(){return N.length===0?"top":N[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(G){return I[G]?G:I[W[G]]?W[G]:I[q[G]]?q[G]:I[X[G]]?X[G]:G},this.isEdgeSupported=function(G){return S==null?J==null?I[G]===!0:J===G:S.indexOf(G)!==-1},this.setCurrentFace=function(G,Y){V=G,Y&&J!=null&&(J=V)},this.getCurrentFace=function(){return V},this.getSupportedFaces=function(){var G=[];for(var Y in I)I[Y]&&G.push(Y);return G},this.lock=function(){J=V},this.unlock=function(){J=null},this.isLocked=function(){return J!=null},this.lockCurrentAxis=function(){V!=null&&(S=V==="left"||V==="right"?A:j)},this.unlockCurrentAxis=function(){S=null},this.compute=function(G){return c[G.element.id]||[0,0]},this.getCurrentLocation=function(G){return c[G.element.id]||[0,0]},this.getOrientation=function(G){return l[G.id]||[0,0]},this.getCssClass=function(){return Q}},"ContinuousAnchor");C.continuousAnchorFactory={get:function(L){return new P(L)},clear:function(L){delete c[L]}}},s.AnchorManager.prototype.calculateOrientation=function(i,d,c,l,m,v,x,C,w){var f={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},T=["left","top","right","bottom"];if(i===d)return{orientation:f.IDENTITY,a:["top","top"]};var k=Math.atan2(l.centery-c.centery,l.centerx-c.centerx),F=Math.atan2(c.centery-l.centery,c.centerx-l.centerx),O=[],_={};(function(z,I){for(var W=0;W<z.length;W++)if(_[z[W]]={left:[I[W][0].left,I[W][0].centery],right:[I[W][0].right,I[W][0].centery],top:[I[W][0].centerx,I[W][0].top],bottom:[I[W][0].centerx,I[W][0].bottom]},I[W][1]!==0)for(var B in _[z[W]])_[z[W]][B]=jsPlumbUtil.rotatePoint(_[z[W]][B],[I[W][0].centerx,I[W][0].centery],I[W][1])})(["source","target"],[[c,C],[l,w]]);for(var M=0;M<T.length;M++)for(var b=0;b<T.length;b++)O.push({source:T[M],target:T[b],dist:Biltong.lineLength(_.source[T[M]],_.target[T[b]])});O.sort(function(z,I){return z.dist<I.dist?-1:z.dist>I.dist?1:0});for(var P=O[0].source,L=O[0].target,N=0;N<O.length&&(m.isContinuous&&m.locked?P=m.getCurrentFace():!m.isContinuous||m.isEdgeSupported(O[N].source)?P=O[N].source:P=null,v.isContinuous&&v.locked?L=v.getCurrentFace():!v.isContinuous||v.isEdgeSupported(O[N].target)?L=O[N].target:L=null,!(P!=null&&L!=null));N++);return m.isContinuous&&m.setCurrentFace(P),v.isContinuous&&v.setCurrentFace(L),{a:[P,L],theta:k,theta2:F}},s.Anchor=function(i){this.x=i.x||0,this.y=i.y||0,this.elementId=i.elementId,this.cssClass=i.cssClass||"",this.orientation=i.orientation||[0,0],this.lastReturnValue=null,this.offsets=i.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=i.relocatable!==!1,this.snapOnRelocate=i.snapOnRelocate!==!1,this.locked=!1,t.EventGenerator.apply(this),this.compute=function(d){var c=d.xy,l=d.wh,m=d.timestamp;if(m&&m===this.timestamp)return this.lastReturnValue;var v=[c[0]+this.x*l[0]+this.offsets[0],c[1]+this.y*l[1]+this.offsets[1],this.x,this.y],x=d.rotation;if(x!=null&&x!==0){var C=jsPlumbUtil.rotatePoint(v,[c[0]+l[0]/2,c[1]+l[1]/2],x);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*C[2]-this._unrotatedOrientation[1]*C[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*C[2]+this._unrotatedOrientation[0]*C[3]),this.lastReturnValue=[C[0],C[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=v;return this.timestamp=m,this.lastReturnValue},this.getCurrentLocation=function(d){return d=d||{},this.lastReturnValue==null||d.timestamp!=null&&this.timestamp!==d.timestamp?this.compute(d):this.lastReturnValue},this.setPosition=function(d,c,l,m,v){(!this.locked||v)&&(this.x=d,this.y=c,this.orientation=[l,m],this.lastReturnValue=null)}},t.extend(s.Anchor,t.EventGenerator,{equals:function(i){if(!i)return!1;var d=i.getOrientation(),c=this.getOrientation();return this.x===i.x&&this.y===i.y&&this.offsets[0]===i.offsets[0]&&this.offsets[1]===i.offsets[1]&&c[0]===d[0]&&c[1]===d[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),s.FloatingAnchor=function(i){s.Anchor.apply(this,arguments);var d=i.reference,c=i.referenceCanvas,l=s.getSize(c),m=0,v=0,x=null,C=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(w){var f=w.xy,T=[f[0]+l[0]/2,f[1]+l[1]/2];return C=T,T},this.getOrientation=function(w){if(x)return x;var f=d.getOrientation(w);return[Math.abs(f[0])*m*-1,Math.abs(f[1])*v*-1]},this.over=function(w,f){x=w.getOrientation(f)},this.out=function(){x=null},this.getCurrentLocation=function(w){return C??this.compute(w)}},t.extend(s.FloatingAnchor,s.Anchor);var a=u(function(i,d,c){return i.constructor===s.Anchor?i:d.makeAnchor(i,c,d)},"_convertAnchor");s.DynamicAnchor=function(i){s.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=i.elementId,this.jsPlumbInstance=i.jsPlumbInstance;for(var d=0;d<i.anchors.length;d++)this.anchors[d]=a(i.anchors[d],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var c=this.anchors.length>0?this.anchors[0]:null,l=c,m=u(function(x,C,w,f,T,k,F){var O=f[0]+x.x*T[0],_=f[1]+x.y*T[1],M=f[0]+T[0]/2,b=f[1]+T[1]/2;if(k!=null&&k!==0){var P=jsPlumbUtil.rotatePoint([O,_],[M,b],k);O=P[0],_=P[1]}return Math.sqrt(Math.pow(C-O,2)+Math.pow(w-_,2))+Math.sqrt(Math.pow(M-O,2)+Math.pow(b-_,2))},"_distance"),v=i.selector||function(x,C,w,f,T,k,F){for(var O=w[0]+f[0]/2,_=w[1]+f[1]/2,M=-1,b=1/0,P=0;P<F.length;P++){var L=m(F[P],O,_,x,C,T);L<b&&(M=P+0,b=L)}return F[M]};this.compute=function(x){var C=x.xy,w=x.wh,f=x.txy,T=x.twh,k=x.rotation,F=x.tRotation;return this.timestamp=x.timestamp,this.locked||f==null||T==null?(this.lastReturnValue=c.compute(x),this.lastReturnValue):(x.timestamp=null,c=v(C,w,f,T,k,F,this.anchors),this.x=c.x,this.y=c.y,c!==l&&this.fire("anchorChanged",c),l=c,this.lastReturnValue=c.compute(x),this.lastReturnValue)},this.getCurrentLocation=function(x){return c!=null?c.getCurrentLocation(x):null},this.getOrientation=function(x){return c!=null?c.getOrientation(x):[0,0]},this.over=function(x,C){c?.over(x,C)},this.out=function(){c?.out()},this.setAnchor=function(x){c=x},this.getCssClass=function(){return c&&c.getCssClass()||""},this.setAnchorCoordinates=function(x){var C=jsPlumbUtil.findWithFunction(this.anchors,function(w){return w.x===x[0]&&w.y===x[1]});return C!==-1?(this.setAnchor(this.anchors[C]),!0):!1}},t.extend(s.DynamicAnchor,s.Anchor);var o=u(function(i,d,c,l,m,v){s.Anchors[m]=function(x){var C=x.jsPlumbInstance.makeAnchor([i,d,c,l,0,0],x.elementId,x.jsPlumbInstance);return C.type=m,v&&v(C,x),C}},"_curryAnchor");o(.5,0,0,-1,"TopCenter"),o(.5,1,0,1,"BottomCenter"),o(0,.5,-1,0,"LeftMiddle"),o(1,.5,1,0,"RightMiddle"),o(.5,0,0,-1,"Top"),o(.5,1,0,1,"Bottom"),o(0,.5,-1,0,"Left"),o(1,.5,1,0,"Right"),o(.5,.5,0,0,"Center"),o(1,0,0,-1,"TopRight"),o(1,1,0,1,"BottomRight"),o(0,0,0,-1,"TopLeft"),o(0,1,0,1,"BottomLeft"),s.Defaults.DynamicAnchors=function(i){return i.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],i.elementId,i.jsPlumbInstance)},s.Anchors.AutoDefault=function(i){var d=i.jsPlumbInstance.makeDynamicAnchor(s.Defaults.DynamicAnchors(i));return d.type="AutoDefault",d};var r=u(function(i,d){s.Anchors[i]=function(c){var l=c.jsPlumbInstance.makeAnchor(["Continuous",{faces:d}],c.elementId,c.jsPlumbInstance);return l.type=i,l}},"_curryContinuousAnchor");s.Anchors.Continuous=function(i){return i.jsPlumbInstance.continuousAnchorFactory.get(i)},r("ContinuousLeft",["left"]),r("ContinuousTop",["top"]),r("ContinuousBottom",["bottom"]),r("ContinuousRight",["right"]),o(0,0,0,0,"Assign",function(i,d){var c=d.position||"Fixed";i.positionFinder=c.constructor===String?d.jsPlumbInstance.AnchorPositionFinders[c]:c,i.constructorParams=d}),e.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(i,d,c){return[(i.left-d.left)/c[0],(i.top-d.top)/c[1]]},Grid:function(i,d,c,l){var m=i.left-d.left,v=i.top-d.top,x=c[0]/l.grid[0],C=c[1]/l.grid[1],w=Math.floor(m/x),f=Math.floor(v/C);return[(w*x+x/2)/c[0],(f*C+C/2)/c[1]]}},s.Anchors.Perimeter=function(i){i=i||{};var d=i.anchorCount||60,c=i.shape;if(!c)throw new Error("no shape supplied to Perimeter Anchor type");var l=u(function(){for(var k=.5,F=Math.PI*2/d,O=0,_=[],M=0;M<d;M++){var b=k+k*Math.sin(O),P=k+k*Math.cos(O);_.push([b,P,0,0]),O+=F}return _},"_circle"),m=u(function(k){for(var F=d/k.length,O=[],_=u(function(b,P,L,N,z,I,W){F=d*z;for(var B=(L-b)/F,K=(N-P)/F,q=0;q<F;q++)O.push([b+B*q,P+K*q,I??0,W??0])},"_computeFace"),M=0;M<k.length;M++)_.apply(null,k[M]);return O},"_path"),v=u(function(k){for(var F=[],O=0;O<k.length;O++)F.push([k[O][0],k[O][1],k[O][2],k[O][3],1/k.length,k[O][4],k[O][5]]);return m(F)},"_shape"),x=u(function(){return v([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},"_rectangle"),C={Circle:l,Ellipse:l,Diamond:function(){return v([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:x,Square:x,Triangle:function(){return v([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(k){for(var F=k.points,O=[],_=0,M=0;M<F.length-1;M++){var b=Math.sqrt(Math.pow(F[M][2]-F[M][0])+Math.pow(F[M][3]-F[M][1]));_+=b,O.push([F[M][0],F[M][1],F[M+1][0],F[M+1][1],b])}for(var P=0;P<O.length;P++)O[P][4]=O[P][4]/_;return m(O)}},w=u(function(k,F){for(var O=[],_=F/180*Math.PI,M=0;M<k.length;M++){var b=k[M][0]-.5,P=k[M][1]-.5;O.push([.5+(b*Math.cos(_)-P*Math.sin(_)),.5+(b*Math.sin(_)+P*Math.cos(_)),k[M][2],k[M][3]])}return O},"_rotate");if(!C[c])throw new Error("Shape ["+c+"] is unknown by Perimeter Anchor type");var f=C[c](i);i.rotation&&(f=w(f,i.rotation));var T=i.jsPlumbInstance.makeDynamicAnchor(f);return T.type="Perimeter",T}}.call(typeof window<"u"?window:mt),function(){var e=this;e.jsPlumbUtil;var t=e.jsPlumb;t.DefaultRouter=function(s){this.jsPlumbInstance=s,this.anchorManager=new t.AnchorManager({jsPlumbInstance:s}),this.sourceOrTargetChanged=function(a,o,r,i,d){this.anchorManager.sourceOrTargetChanged(a,o,r,i,d)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(a,o){this.anchorManager.changeId(a,o)},this.elementRemoved=function(a){this.anchorManager.elementRemoved(a)},this.newConnection=function(a){this.anchorManager.newConnection(a)},this.connectionDetached=function(a,o){this.anchorManager.connectionDetached(a,o)},this.redraw=function(a,o,r,i,d,c){return this.anchorManager.redraw(a,o,r,i,d,c)},this.deleteEndpoint=function(a){this.anchorManager.deleteEndpoint(a)},this.rehomeEndpoint=function(a,o,r){this.anchorManager.rehomeEndpoint(a,o,r)},this.addEndpoint=function(a,o){this.anchorManager.addEndpoint(a,o)}}}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a=e.Biltong;t.Segments={AbstractSegment:function(l){this.params=l,this.findClosestPointOnPath=function(m,v){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(l.x1,l.x2),minY:Math.min(l.y1,l.y2),maxX:Math.max(l.x1,l.x2),maxY:Math.max(l.y1,l.y2)}},this.lineIntersection=function(m,v,x,C){return[]},this.boxIntersection=function(m,v,x,C){var w=[];return w.push.apply(w,this.lineIntersection(m,v,m+x,v)),w.push.apply(w,this.lineIntersection(m+x,v,m+x,v+C)),w.push.apply(w,this.lineIntersection(m+x,v+C,m,v+C)),w.push.apply(w,this.lineIntersection(m,v+C,m,v)),w},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(l){t.Segments.AbstractSegment.apply(this,arguments);var m,v,x,C,w,f,T,k=u(function(){m=Math.sqrt(Math.pow(w-C,2)+Math.pow(T-f,2)),v=a.gradient({x:C,y:f},{x:w,y:T}),x=-1/v},"_recalc");this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return v},this.getCoordinates=function(){return{x1:C,y1:f,x2:w,y2:T}},this.setCoordinates=function(b){C=b.x1,f=b.y1,w=b.x2,T=b.y2,k()},this.setCoordinates({x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2}),this.getBounds=function(){return{minX:Math.min(C,w),minY:Math.min(f,T),maxX:Math.max(C,w),maxY:Math.max(f,T)}},this.pointOnPath=function(b,P){if(b===0&&!P)return{x:C,y:f};if(b===1&&!P)return{x:w,y:T};var L=P?b>0?b:m+b:b*m;return a.pointOnLine({x:C,y:f},{x:w,y:T},L)},this.gradientAtPoint=function(b){return v},this.pointAlongPathFrom=function(b,P,L){var N=this.pointOnPath(b,L),z=P<=0?{x:C,y:f}:{x:w,y:T};return P<=0&&Math.abs(P)>1&&(P*=-1),a.pointOnLine(N,z,P)};var F=u(function(b,P,L){return L>=Math.min(b,P)&&L<=Math.max(b,P)},"within"),O=u(function(b,P,L){return Math.abs(L-b)<Math.abs(L-P)?b:P},"closest");this.findClosestPointOnPath=function(b,P){var L={d:1/0,x:null,y:null,l:null,x1:C,x2:w,y1:f,y2:T};if(v===0)L.y=f,L.x=F(C,w,b)?b:O(C,w,b);else if(v===1/0||v===-1/0)L.x=C,L.y=F(f,T,P)?P:O(f,T,P);else{var N=f-v*C,z=P-x*b,I=(z-N)/(v-x),W=v*I+N;L.x=F(C,w,I)?I:O(C,w,I),L.y=F(f,T,W)?W:O(f,T,W)}var B=a.lineLength([L.x,L.y],[C,f]);return L.d=a.lineLength([b,P],[L.x,L.y]),L.l=B/m,L};var _=u(function(b,P,L){return L>P?P<=b&&b<=L:P>=b&&b>=L},"_pointLiesBetween"),M=_;this.lineIntersection=function(b,P,L,N){var z=Math.abs(a.gradient({x:b,y:P},{x:L,y:N})),I=Math.abs(v),W=I===1/0?C:f-I*C,B=[],K=z===1/0?b:P-z*b;if(z!==I)if(z===1/0&&I===0)M(b,C,w)&&M(f,P,N)&&(B=[b,f]);else if(z===0&&I===1/0)M(P,f,T)&&M(C,b,L)&&(B=[C,P]);else{var q,X;z===1/0?(q=b,M(q,C,w)&&(X=I*b+W,M(X,P,N)&&(B=[q,X]))):z===0?(X=P,M(X,f,T)&&(q=(P-W)/I,M(q,b,L)&&(B=[q,X]))):(q=(K-W)/(I-z),X=I*q+W,M(q,C,w)&&M(X,f,T)&&(B=[q,X]))}return B},this.boxIntersection=function(b,P,L,N){var z=[];return z.push.apply(z,this.lineIntersection(b,P,b+L,P)),z.push.apply(z,this.lineIntersection(b+L,P,b+L,P+N)),z.push.apply(z,this.lineIntersection(b+L,P+N,b,P+N)),z.push.apply(z,this.lineIntersection(b,P+N,b,P)),z},this.boundingBoxIntersection=function(b){return this.boxIntersection(b.x,b.y,b.w,b.h)}},Arc:function(l){t.Segments.AbstractSegment.apply(this,arguments);var m=u(function(O,_){return a.theta([l.cx,l.cy],[O,_])},"_calcAngle"),v=u(function(O,_){if(O.anticlockwise){var M=O.startAngle<O.endAngle?O.startAngle+x:O.startAngle,b=Math.abs(M-O.endAngle);return M-b*_}else{var P=O.endAngle<O.startAngle?O.endAngle+x:O.endAngle,L=Math.abs(P-O.startAngle);return O.startAngle+L*_}},"_calcAngleForLocation"),x=2*Math.PI;this.radius=l.r,this.anticlockwise=l.ac,this.type="Arc",l.startAngle&&l.endAngle?(this.startAngle=l.startAngle,this.endAngle=l.endAngle,this.x1=l.cx+this.radius*Math.cos(l.startAngle),this.y1=l.cy+this.radius*Math.sin(l.startAngle),this.x2=l.cx+this.radius*Math.cos(l.endAngle),this.y2=l.cy+this.radius*Math.sin(l.endAngle)):(this.startAngle=m(l.x1,l.y1),this.endAngle=m(l.x2,l.y2),this.x1=l.x1,this.y1=l.y1,this.x2=l.x2,this.y2=l.y2),this.endAngle<0&&(this.endAngle+=x),this.startAngle<0&&(this.startAngle+=x);var C=this.endAngle<this.startAngle?this.endAngle+x:this.endAngle;this.sweep=Math.abs(C-this.startAngle),this.anticlockwise&&(this.sweep=x-this.sweep);var w=2*Math.PI*this.radius,f=this.sweep/x,T=w*f;this.getLength=function(){return T},this.getBounds=function(){return{minX:l.cx-l.r,maxX:l.cx+l.r,minY:l.cy-l.r,maxY:l.cy+l.r}};var k=1e-10,F=u(function(O){var _=Math.floor(O),M=Math.ceil(O);return O-_<k?_:M-O<k?M:O},"gentleRound");this.pointOnPath=function(O,_){if(O===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(O===1)return{x:this.x2,y:this.y2,theta:this.endAngle};_&&(O=O/T);var M=v(this,O),b=l.cx+l.r*Math.cos(M),P=l.cy+l.r*Math.sin(M);return{x:F(b),y:F(P),theta:M}},this.gradientAtPoint=function(O,_){var M=this.pointOnPath(O,_),b=a.normal([l.cx,l.cy],[M.x,M.y]);return!this.anticlockwise&&(b===1/0||b===-1/0)&&(b*=-1),b},this.pointAlongPathFrom=function(O,_,M){var b=this.pointOnPath(O,M),P=_/w*2*Math.PI,L=this.anticlockwise?-1:1,N=b.theta+L*P,z=l.cx+this.radius*Math.cos(N),I=l.cy+this.radius*Math.sin(N);return{x:z,y:I}}},Bezier:function(l){this.curve=[{x:l.x1,y:l.y1},{x:l.cp1x,y:l.cp1y},{x:l.cp2x,y:l.cp2y},{x:l.x2,y:l.y2}];var m=u(function(T){return T[0].x===T[1].x&&T[0].y===T[1].y},"_isPoint"),v=u(function(T,k){return Math.sqrt(Math.pow(T.x-k.x,2)+Math.pow(T.y-k.y,2))},"_dist"),x=function(T){var k={x:0,y:0};if(T===0)return this.curve[0];var F=this.curve.length-1;if(T===1)return this.curve[F];var O=this.curve,_=1-T;if(F===0)return this.curve[0];if(F===1)return{x:_*O[0].x+T*O[1].x,y:_*O[0].y+T*O[1].y};if(F<4){var M=_*_,b=T*T,P=0,L,N,z;return F===2?(O=[O[0],O[1],O[2],k],L=M,N=2*(_*T),z=b):F===3&&(L=M*_,N=3*(M*T),z=3*(_*b),P=T*b),{x:L*O[0].x+N*O[1].x+z*O[2].x+P*O[3].x,y:L*O[0].y+N*O[1].y+z*O[2].y+P*O[3].y}}else return k}.bind(this),C=u(function(T){var k=[];T--;for(var F=0;F<=T;F++)k.push(x(F/T));return k},"_getLUT"),w=function(){m(this.curve)&&(this.length=0);var T=16,k=C(T);this.length=0;for(var F=0;F<T-1;F++){var O=k[F],_=k[F+1];this.length+=v(O,_)}}.bind(this);t.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(l.x1,l.x2,l.cp1x,l.cp2x),minY:Math.min(l.y1,l.y2,l.cp1y,l.cp2y),maxX:Math.max(l.x1,l.x2,l.cp1x,l.cp2x),maxY:Math.max(l.y1,l.y2,l.cp1y,l.cp2y)},this.type="Bezier",w();var f=u(function(T,k,F){return F&&(k=e.jsBezier.locationAlongCurveFrom(T,k>0?0:1,k)),k},"_translateLocation");this.pointOnPath=function(T,k){return T=f(this.curve,T,k),e.jsBezier.pointOnCurve(this.curve,T)},this.gradientAtPoint=function(T,k){return T=f(this.curve,T,k),e.jsBezier.gradientAtPoint(this.curve,T)},this.pointAlongPathFrom=function(T,k,F){return T=f(this.curve,T,F),e.jsBezier.pointAlongCurveFrom(this.curve,T,k)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(T,k){var F=e.jsBezier.nearestPointOnCurve({x:T,y:k},this.curve);return{d:Math.sqrt(Math.pow(F.point.x-T,2)+Math.pow(F.point.y-k,2)),x:F.point.x,y:F.point.y,l:1-F.location,s:this}},this.lineIntersection=function(T,k,F,O){return e.jsBezier.lineIntersection(T,k,F,O,this.curve)}}},t.SegmentRenderer={getPath:function(l,m){return{Straight:function(v){var x=l.getCoordinates();return(v?"M "+x.x1+" "+x.y1+" ":"")+"L "+x.x2+" "+x.y2},Bezier:function(v){var x=l.params;return(v?"M "+x.x2+" "+x.y2+" ":"")+"C "+x.cp2x+" "+x.cp2y+" "+x.cp1x+" "+x.cp1y+" "+x.x1+" "+x.y1},Arc:function(v){var x=l.params,C=l.sweep>Math.PI?1:0,w=l.anticlockwise?0:1;return(v?"M"+l.x1+" "+l.y1+" ":"")+"A "+l.radius+" "+x.r+" 0 "+C+","+w+" "+l.x2+" "+l.y2}}[l.type](m)}};var o=u(function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()},"AbstractComponent");t.Connectors.AbstractConnector=function(l){o.apply(this,arguments);var m=[],v=0,x=[],C=[],w=l.stub||0,f=s.isArray(w)?w[0]:w,T=s.isArray(w)?w[1]:w,k=l.gap||0,F=s.isArray(k)?k[0]:k,O=s.isArray(k)?k[1]:k,_=null,M=null;this.getPathData=function(){for(var I="",W=0;W<m.length;W++)I+=t.SegmentRenderer.getPath(m[W],W===0),I+=" ";return I},this.findSegmentForPoint=function(I,W){for(var B={d:1/0,s:null,x:null,y:null,l:null},K=0;K<m.length;K++){var q=m[K].findClosestPointOnPath(I,W);q.d<B.d&&(B.d=q.d,B.l=q.l,B.x=q.x,B.y=q.y,B.s=m[K],B.x1=q.x1,B.x2=q.x2,B.y1=q.y1,B.y2=q.y2,B.index=K,B.connectorLocation=x[K][0]+q.l*(x[K][1]-x[K][0]))}return B},this.lineIntersection=function(I,W,B,K){for(var q=[],X=0;X<m.length;X++)q.push.apply(q,m[X].lineIntersection(I,W,B,K));return q},this.boxIntersection=function(I,W,B,K){for(var q=[],X=0;X<m.length;X++)q.push.apply(q,m[X].boxIntersection(I,W,B,K));return q},this.boundingBoxIntersection=function(I){for(var W=[],B=0;B<m.length;B++)W.push.apply(W,m[B].boundingBoxIntersection(I));return W};var b=u(function(){for(var I=0,W=0;W<m.length;W++){var B=m[W].getLength();C[W]=B/v,x[W]=[I,I+=B/v]}},"_updateSegmentProportions"),P=u(function(I,W){var B,K,q;if(W&&(I=I>0?I/v:(v+I)/v),I===1)B=m.length-1,q=1;else if(I===0)q=0,B=0;else if(I>=.5){for(B=0,q=0,K=x.length-1;K>-1;K--)if(x[K][1]>=I&&x[K][0]<=I){B=K,q=(I-x[K][0])/C[K];break}}else for(B=x.length-1,q=1,K=0;K<x.length;K++)if(x[K][1]>=I){B=K,q=(I-x[K][0])/C[K];break}return{segment:m[B],proportion:q,index:B}},"_findSegmentForLocation"),L=u(function(I,W,B){if(!(B.x1===B.x2&&B.y1===B.y2)){var K=new t.Segments[W](B);m.push(K),v+=K.getLength(),I.updateBounds(K)}},"_addSegment"),N=u(function(){v=m.length=x.length=C.length=0},"_clearSegments");this.setSegments=function(I){_=[],v=0;for(var W=0;W<I.length;W++)_.push(I[W]),v+=I[W].getLength()},this.getLength=function(){return v};var z=u(function(I){this.strokeWidth=I.strokeWidth;var W=a.quadrant(I.sourcePos,I.targetPos),B=I.targetPos[0]<I.sourcePos[0],K=I.targetPos[1]<I.sourcePos[1],q=I.strokeWidth||1,X=I.sourceEndpoint.anchor.getOrientation(I.sourceEndpoint),Q=I.targetEndpoint.anchor.getOrientation(I.targetEndpoint),V=B?I.targetPos[0]:I.sourcePos[0],J=K?I.targetPos[1]:I.sourcePos[1],A=Math.abs(I.targetPos[0]-I.sourcePos[0]),j=Math.abs(I.targetPos[1]-I.sourcePos[1]);if(X[0]===0&&X[1]===0||Q[0]===0&&Q[1]===0){var S=A>j?0:1,U=[1,0][S];X=[],Q=[],X[S]=I.sourcePos[S]>I.targetPos[S]?-1:1,Q[S]=I.sourcePos[S]>I.targetPos[S]?1:-1,X[U]=0,Q[U]=0}var G=B?A+F*X[0]:F*X[0],Y=K?j+F*X[1]:F*X[1],se=B?O*Q[0]:A+O*Q[0],le=K?O*Q[1]:j+O*Q[1],ne=X[0]*Q[0]+X[1]*Q[1],he={sx:G,sy:Y,tx:se,ty:le,lw:q,xSpan:Math.abs(se-G),ySpan:Math.abs(le-Y),mx:(G+se)/2,my:(Y+le)/2,so:X,to:Q,x:V,y:J,w:A,h:j,segment:W,startStubX:G+X[0]*f,startStubY:Y+X[1]*f,endStubX:se+Q[0]*T,endStubY:le+Q[1]*T,isXGreaterThanStubTimes2:Math.abs(G-se)>f+T,isYGreaterThanStubTimes2:Math.abs(Y-le)>f+T,opposite:ne===-1,perpendicular:ne===0,orthogonal:ne===1,sourceAxis:X[0]===0?"y":"x",points:[V,J,A,j,G,Y,se,le],stubs:[f,T]};return he.anchorOrientation=he.opposite?"opposite":he.orthogonal?"orthogonal":"perpendicular",he},"_prepareCompute");return this.getSegments=function(){return m},this.updateBounds=function(I){var W=I.getBounds();this.bounds.minX=Math.min(this.bounds.minX,W.minX),this.bounds.maxX=Math.max(this.bounds.maxX,W.maxX),this.bounds.minY=Math.min(this.bounds.minY,W.minY),this.bounds.maxY=Math.max(this.bounds.maxY,W.maxY)},this.pointOnPath=function(I,W){var B=P(I,W);return B.segment&&B.segment.pointOnPath(B.proportion,!1)||[0,0]},this.gradientAtPoint=function(I,W){var B=P(I,W);return B.segment&&B.segment.gradientAtPoint(B.proportion,!1)||0},this.pointAlongPathFrom=function(I,W,B){var K=P(I,B);return K.segment&&K.segment.pointAlongPathFrom(K.proportion,W,!1)||[0,0]},this.compute=function(I){M=z.call(this,I),N(),this._compute(M,I),this.x=M.points[0],this.y=M.points[1],this.w=M.points[2],this.h=M.points[3],this.segment=M.segment,b()},{addSegment:L,prepareCompute:z,sourceStub:f,targetStub:T,maxStub:Math.max(f,T),sourceGap:F,targetGap:O,maxGap:Math.max(F,O)}},s.extend(t.Connectors.AbstractConnector,o),t.Endpoints.AbstractEndpoint=function(l){o.apply(this,arguments);var m=this.compute=function(v,x,C,w){var f=this._compute.apply(this,arguments);return this.x=f[0],this.y=f[1],this.w=f[2],this.h=f[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,f};return{compute:m,cssClass:l.cssClass}},s.extend(t.Endpoints.AbstractEndpoint,o),t.Endpoints.Dot=function(l){this.type="Dot",t.Endpoints.AbstractEndpoint.apply(this,arguments),l=l||{},this.radius=l.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,v,x,C){this.radius=x.radius||this.radius;var w=m[0]-this.radius,f=m[1]-this.radius,T=this.radius*2,k=this.radius*2;if(x.stroke){var F=x.strokeWidth||1;w-=F,f-=F,T+=F*2,k+=F*2}return[w,f,T,k,this.radius]}},s.extend(t.Endpoints.Dot,t.Endpoints.AbstractEndpoint),t.Endpoints.Rectangle=function(l){this.type="Rectangle",t.Endpoints.AbstractEndpoint.apply(this,arguments),l=l||{},this.width=l.width||20,this.height=l.height||20,this._compute=function(m,v,x,C){var w=x.width||this.width,f=x.height||this.height,T=m[0]-w/2,k=m[1]-f/2;return[T,k,w,f]}},s.extend(t.Endpoints.Rectangle,t.Endpoints.AbstractEndpoint);var r=u(function(l){t.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]},"DOMElementEndpoint");s.extend(r,t.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(l){this._jsPlumb.displayElements.push(l)}}),t.Endpoints.Image=function(l){this.type="Image",r.apply(this,arguments),t.Endpoints.AbstractEndpoint.apply(this,arguments);var m=l.onload,v=l.src||l.url,x=l.cssClass?" "+l.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=l.width,this._jsPlumb.heightToUse=l.height,this._jsPlumb.endpoint=l.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(C,w){var f=C.constructor===String?C:C.src;m=w,this._jsPlumb.img.src=f,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(v,m),this._compute=function(C,w,f,T){return this.anchorPoint=C,this._jsPlumb.ready?[C[0]-this._jsPlumb.widthToUse/2,C[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=t.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+x),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(C,w,f){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var T=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,k=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;s.sizeElement(this.canvas,T,k,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(C,w){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(C,w):e.setTimeout(function(){this.paint(C,w)}.bind(this),200))}},s.extend(t.Endpoints.Image,[r,t.Endpoints.AbstractEndpoint],{cleanup:function(l){l&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),t.Endpoints.Blank=function(l){t.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",r.apply(this,arguments),this._compute=function(v,x,C,w){return[v[0],v[1],10,0]};var m=l.cssClass?" "+l.cssClass:"";this.canvas=t.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(v,x){s.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},s.extend(t.Endpoints.Blank,[t.Endpoints.AbstractEndpoint,r],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),t.Endpoints.Triangle=function(l){this.type="Triangle",t.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;l=l||{},l.width=l.width||55,l.height=l.height||55,this.width=l.width,this.height=l.height,this._compute=function(v,x,C,w){var f=C.width||m.width,T=C.height||m.height,k=v[0]-f/2,F=v[1]-T/2;return[k,F,f,T]}};var i=t.Overlays.AbstractOverlay=function(l){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=l.component,this.loc=l.location==null?.5:l.location,this.endpointLoc=l.endpointLocation==null?[.5,.5]:l.endpointLocation,this.visible=l.visible!==!1};i.prototype={cleanup:function(l){l&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(l,m){},setVisible:function(l){this.visible=l,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(l){this.loc+=l,this.component.repaint()},setLocation:function(l){this.loc=l,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},t.Overlays.Arrow=function(l){this.type="Arrow",i.apply(this,arguments),this.isAppendedAtTopLevel=!1,l=l||{};var m=this;this.length=l.length||20,this.width=l.width||20,this.id=l.id,this.direction=(l.direction||1)<0?-1:1;var v=l.paintStyle||{"stroke-width":1},x=l.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(C,w){if(this.path=C,l.events)for(var f in l.events)t.on(C,f,l.events[f])},this.draw=function(C,w){var f,T,k,F,O;if(C.pointAlongPathFrom){if(s.isString(this.loc)||this.loc>1||this.loc<0){var _=parseInt(this.loc,10),M=this.loc<0?1:0;f=C.pointAlongPathFrom(M,_,!1),T=C.pointAlongPathFrom(M,_-this.direction*this.length/2,!1),k=a.pointOnLine(f,T,this.length)}else if(this.loc===1){if(f=C.pointOnPath(this.loc),T=C.pointAlongPathFrom(this.loc,-this.length),k=a.pointOnLine(f,T,this.length),this.direction===-1){var b=k;k=f,f=b}}else if(this.loc===0){if(k=C.pointOnPath(this.loc),T=C.pointAlongPathFrom(this.loc,this.length),f=a.pointOnLine(k,T,this.length),this.direction===-1){var P=k;k=f,f=P}}else f=C.pointAlongPathFrom(this.loc,this.direction*this.length/2),T=C.pointOnPath(this.loc),k=a.pointOnLine(f,T,this.length);F=a.perpendicularLineTo(f,k,this.width),O=a.pointOnLine(f,k,x*this.length);var L={hxy:f,tail:F,cxy:O},N=v.stroke||w.stroke,z=v.fill||w.stroke,I=v.strokeWidth||w.strokeWidth;return{component:C,d:L,"stroke-width":I,stroke:N,fill:z,minX:Math.min(f.x,F[0].x,F[1].x),maxX:Math.max(f.x,F[0].x,F[1].x),minY:Math.min(f.y,F[0].y,F[1].y),maxY:Math.max(f.y,F[0].y,F[1].y)}}else return{component:C,minX:0,maxX:0,minY:0,maxY:0}}},s.extend(t.Overlays.Arrow,i,{updateFrom:function(l){this.length=l.length||this.length,this.width=l.width||this.width,this.direction=l.direction!=null?l.direction:this.direction,this.foldback=l.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),t.Overlays.PlainArrow=function(l){l=l||{};var m=t.extend(l,{foldback:1});t.Overlays.Arrow.call(this,m),this.type="PlainArrow"},s.extend(t.Overlays.PlainArrow,t.Overlays.Arrow),t.Overlays.Diamond=function(l){l=l||{};var m=l.length||40,v=t.extend(l,{length:m/2,foldback:2});t.Overlays.Arrow.call(this,v),this.type="Diamond"},s.extend(t.Overlays.Diamond,t.Overlays.Arrow);var d=u(function(l,m){return(l._jsPlumb.cachedDimensions==null||m)&&(l._jsPlumb.cachedDimensions=l.getDimensions()),l._jsPlumb.cachedDimensions},"_getDimensions"),c=u(function(l){t.jsPlumbUIComponent.apply(this,arguments),i.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=l.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=l.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=l.create,this._jsPlumb.initiallyInvisible=l.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var v=this._jsPlumb.div=t.getElement(this._jsPlumb.create(this._jsPlumb.component));v.style.position="absolute",jsPlumb.addClass(v,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:l.cssClass?l.cssClass:"")),this._jsPlumb.instance.appendElement(v),this._jsPlumb.instance.getId(v),this.canvas=v;var x="translate(-50%, -50%)";v.style.webkitTransform=x,v.style.mozTransform=x,v.style.msTransform=x,v.style.oTransform=x,v.style.transform=x,v._jsPlumb=this,l.visible===!1&&(v.style.display="none")}return this._jsPlumb.div},this.draw=function(v,x,C){var w=d(this);if(w!=null&&w.length===2){var f={x:0,y:0};if(C)f={x:C[0],y:C[1]};else if(v.pointOnPath){var T=this.loc,k=!1;(s.isString(this.loc)||this.loc<0||this.loc>1)&&(T=parseInt(this.loc,10),k=!0),f=v.pointOnPath(T,k)}else{var F=this.loc.constructor===Array?this.loc:this.endpointLoc;f={x:F[0]*v.w,y:F[1]*v.h}}var O=f.x-w[0]/2,_=f.y-w[1]/2;return{component:v,d:{minx:O,miny:_,td:w,cxy:f},minX:O,maxX:O+w[0],minY:_,maxY:_+w[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}},"AbstractDOMOverlay");s.extend(c,[t.jsPlumbUIComponent,i],{getDimensions:function(){return[1,1]},setVisible:function(l){this._jsPlumb.div&&(this._jsPlumb.div.style.display=l?"block":"none",l&&this._jsPlumb.initiallyInvisible&&(d(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(l){l?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(l,m){this._jsPlumb.div!=null&&l.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var l=d(this);return Math.max(l[0],l[1])},paint:function(l,m){this._jsPlumb.initialised||(this.getElement(),l.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=l.component.x+l.d.minx+"px",this._jsPlumb.div.style.top=l.component.y+l.d.miny+"px"}}),t.Overlays.Custom=function(l){this.type="Custom",c.apply(this,arguments)},s.extend(t.Overlays.Custom,c),t.Overlays.GuideLines=function(){var l=this;l.length=50,l.strokeWidth=5,this.type="GuideLines",i.apply(this,arguments),t.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,v){var x=m.pointAlongPathFrom(l.loc,l.length/2),C=m.pointOnPath(l.loc),w=a.pointOnLine(x,C,l.length),f=a.perpendicularLineTo(x,w,40),T=a.perpendicularLineTo(w,x,20);return{connector:m,head:x,tail:w,headLine:T,tailLine:f,minX:Math.min(x.x,w.x,T[0].x,T[1].x),minY:Math.min(x.y,w.y,T[0].y,T[1].y),maxX:Math.max(x.x,w.x,T[0].x,T[1].x),maxY:Math.max(x.y,w.y,T[0].y,T[1].y)}}},t.Overlays.Label=function(l){this.labelStyle=l.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=t.extend({create:function(){return t.createElement("div")}},l);if(t.Overlays.Custom.call(this,m),this.type="Label",this.label=l.label||"",this.labelText=null,this.labelStyle){var v=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",v.style.font=this.labelStyle.font,v.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(v.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var x=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";v.style.border=this.labelStyle.borderWidth+"px solid "+x}this.labelStyle.padding&&(v.style.padding=this.labelStyle.padding)}},s.extend(t.Overlays.Label,t.Overlays.Custom,{cleanup:function(l){l&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(l){this.label=l,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),c.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var l=this.label(this);this.getElement().innerHTML=l.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(l){l.label!=null&&this.setLabel(l.label)}})}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumbUtil,s=e.jsPlumbInstance,a="jtk-group-collapsed",o="jtk-group-expanded",r="[jtk-group-content]",i="elementDraggable",d="stop",c="revert",l="_groupManager",m="_jsPlumbGroup",v="_jsPlumbGroupDrag",x="group:addMember",C="group:removeMember",w="group:add",f="group:remove",T="group:expand",k="group:collapse",F="groupDragStop",O="connectionMoved",_="internal.connectionDetached",M="removeAll",b="orphanAll",P="show",L="hide",N=u(function(I){var W={},B={},K={},q=this;function X(S,U){for(var G=I.getContainer(),Y=!1;!Y;){if(S==null||S===G)return!1;if(S===U)return!0;S=S.parentNode}}u(X,"isDescendant"),I.bind("connection",function(S){var U=I.getGroupFor(S.source),G=I.getGroupFor(S.target);U!=null&&G!=null&&U===G?(B[S.connection.id]=U,K[S.connection.id]=U):(U!=null&&(t.suggest(U.connections.source,S.connection),B[S.connection.id]=U),G!=null&&(t.suggest(G.connections.target,S.connection),K[S.connection.id]=G))});function Q(S){delete S.proxies;var U=B[S.id],G;U!=null&&(G=u(function(Y){return Y.id===S.id},"f"),t.removeWithFunction(U.connections.source,G),t.removeWithFunction(U.connections.target,G),delete B[S.id]),U=K[S.id],U!=null&&(G=u(function(Y){return Y.id===S.id},"f"),t.removeWithFunction(U.connections.source,G),t.removeWithFunction(U.connections.target,G),delete K[S.id])}u(Q,"_cleanupDetachedConnection"),I.bind(_,function(S){Q(S.connection)}),I.bind(O,function(S){var U=S.index===0?B:K,G=U[S.connection.id];if(G){var Y=G.connections[S.index===0?"source":"target"],se=Y.indexOf(S.connection);se!==-1&&Y.splice(se,1)}}),this.addGroup=function(S){I.addClass(S.getEl(),o),W[S.id]=S,S.manager=this,j(S),I.fire(w,{group:S})},this.addToGroup=function(S,U,G){if(S=this.getGroup(S),S){var Y=S.getEl();if(U._isJsPlumbGroup)return;var se=U._jsPlumbGroup;if(se!==S){I.removeFromDragSelection(U);var le=I.getOffset(U,!0),ne=S.collapsed?I.getOffset(Y,!0):I.getOffset(S.getDragArea(),!0);se!=null&&(se.remove(U,!1,G,!1,S),q.updateConnectionsForGroup(se)),S.add(U,G);var he=u(function(we,_e){var je=_e===0?1:0;we.each(function(Pe){Pe.setVisible(!1),Pe.endpoints[je].element._jsPlumbGroup===S?(Pe.endpoints[je].setVisible(!1),A(Pe,je,S)):(Pe.endpoints[_e].setVisible(!1),J(Pe,_e,S))})},"handleDroppedConnections");S.collapsed&&(he(I.select({source:U}),0),he(I.select({target:U}),1));var pe=I.getId(U);I.dragManager.setParent(U,pe,Y,I.getId(Y),le);var fe={left:le.left-ne.left,top:le.top-ne.top};if(I.setPosition(U,fe),I.dragManager.revalidateParent(U,pe,le),q.updateConnectionsForGroup(S),I.revalidate(pe),!G){var me={group:S,el:U,pos:fe};se&&(me.sourceGroup=se),I.fire(x,me)}}}},this.removeFromGroup=function(S,U,G){if(S=this.getGroup(S),S){if(S.collapsed){var Y=u(function(se,le){for(var ne=0;ne<se.length;ne++){var he=se[ne];if(he.proxies){for(var pe=0;pe<he.proxies.length;pe++)if(he.proxies[pe]!=null){var fe=he.proxies[pe].originalEp.element;(fe===U||X(fe,U))&&A(he,le,S)}}}},"_expandSet");Y(S.connections.source.slice(),0),Y(S.connections.target.slice(),1)}S.remove(U,null,G)}},this.getGroup=function(S){var U=S;if(t.isString(S)&&(U=W[S],U==null))throw new TypeError("No such group ["+S+"]");return U},this.getGroups=function(){var S=[];for(var U in W)S.push(W[U]);return S},this.removeGroup=function(S,U,G,Y){S=this.getGroup(S),this.expandGroup(S,!0);var se=S[U?M:b](G,Y);return I.remove(S.getEl()),delete W[S.id],delete I._groups[S.id],I.fire(f,{group:S}),se},this.removeAllGroups=function(S,U,G){for(var Y in W)this.removeGroup(W[Y],S,U,G)};function V(S,U){for(var G=S.getEl().querySelectorAll(".jtk-managed"),Y=0;Y<G.length;Y++)I[U?P:L](G[Y],!0)}u(V,"_setVisible");var J=u(function(S,U,G){var Y=S.endpoints[U===0?1:0].element;if(!(Y[m]&&!Y[m].shouldProxy()&&Y[m].collapsed)){var se=G.getEl(),le=I.getId(se);I.proxyConnection(S,U,se,le,function(ne,he){return G.getEndpoint(ne,he)},function(ne,he){return G.getAnchor(ne,he)})}},"_collapseConnection");this.collapseGroup=function(S){if(S=this.getGroup(S),!(S==null||S.collapsed)){var U=S.getEl();if(V(S,!1),S.shouldProxy()){var G=u(function(Y,se){for(var le=0;le<Y.length;le++){var ne=Y[le];J(ne,se,S)}},"_collapseSet");G(S.connections.source,0),G(S.connections.target,1)}S.collapsed=!0,I.removeClass(U,o),I.addClass(U,a),I.revalidate(U),I.fire(k,{group:S})}};var A=u(function(S,U,G){I.unproxyConnection(S,U,I.getId(G.getEl()))},"_expandConnection");this.expandGroup=function(S,U){if(S=this.getGroup(S),!(S==null||!S.collapsed)){var G=S.getEl();if(V(S,!0),S.shouldProxy()){var Y=u(function(se,le){for(var ne=0;ne<se.length;ne++){var he=se[ne];A(he,le,S)}},"_expandSet");Y(S.connections.source,0),Y(S.connections.target,1)}S.collapsed=!1,I.addClass(G,o),I.removeClass(G,a),I.revalidate(G),this.repaintGroup(S),U||I.fire(T,{group:S})}},this.repaintGroup=function(S){S=this.getGroup(S);for(var U=S.getMembers(),G=0;G<U.length;G++)I.revalidate(U[G])};function j(S){for(var U=S.getMembers().slice(),G=[],Y=0;Y<U.length;Y++)Array.prototype.push.apply(G,U[Y].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(U,G);var se=I.getConnections({source:U,scope:"*"},!0),le=I.getConnections({target:U,scope:"*"},!0),ne={};S.connections.source.length=0,S.connections.target.length=0;var he=u(function(pe){for(var fe=0;fe<pe.length;fe++)if(!ne[pe[fe].id]){ne[pe[fe].id]=!0;var me=I.getGroupFor(pe[fe].source),we=I.getGroupFor(pe[fe].target);me===S?(we!==S&&S.connections.source.push(pe[fe]),B[pe[fe].id]=S):we===S&&(S.connections.target.push(pe[fe]),K[pe[fe].id]=S)}},"oneSet");he(se),he(le)}u(j,"_updateConnectionsForGroup"),this.updateConnectionsForGroup=j,this.refreshAllGroups=function(){for(var S in W)j(W[S]),I.dragManager.updateOffsets(I.getId(W[S].getEl()))}},"GroupManager"),z=u(function(I,W){var B=this,K=W.el;this.getEl=function(){return K},this.id=W.id||t.uuid(),K._isJsPlumbGroup=!0;var q=this.getDragArea=function(){var we=I.getSelector(K,r);return we&&we.length>0?we[0]:K},X=W.ghost===!0,Q=X||W.constrain===!0,V=W.revert!==!1,J=W.orphan===!0,A=W.prune===!0,j=W.dropOverride===!0,S=W.proxied!==!1,U=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(we,_e){return W.anchor||"Continuous"},this.getEndpoint=function(we,_e){return W.endpoint||["Dot",{radius:10}]},this.collapsed=!1,W.draggable!==!1){var G={drag:function(){for(var we=0;we<U.length;we++)I.draw(U[we])},stop:function(we){I.fire(F,jsPlumb.extend(we,{group:B}))},scope:v};W.dragOptions&&e.jsPlumb.extend(G,W.dragOptions),I.draggable(W.el,G)}W.droppable!==!1&&I.droppable(W.el,{drop:function(we){var _e=we.drag.el;if(!_e._isJsPlumbGroup){var je=_e._jsPlumbGroup;if(je!==B){if(je!=null&&je.overrideDrop(_e,B))return;I.getGroupManager().addToGroup(B,_e,!1)}}}});var Y=u(function(we,_e){for(var je=we.nodeType==null?we:[we],Pe=0;Pe<je.length;Pe++)_e(je[Pe])},"_each");this.overrideDrop=function(we,_e){return j&&(V||A||J)},this.add=function(we,_e){var je=q();Y(we,function(Pe){if(Pe._jsPlumbGroup!=null){if(Pe._jsPlumbGroup===B)return;Pe._jsPlumbGroup.remove(Pe,!0,_e,!1)}Pe._jsPlumbGroup=B,U.push(Pe),I.isAlreadyDraggable(Pe)&&me(Pe),Pe.parentNode!==je&&je.appendChild(Pe)}),I.getGroupManager().updateConnectionsForGroup(B)},this.remove=function(we,_e,je,Pe,qe){Y(we,function(Me){if(Me._jsPlumbGroup===B){if(delete Me._jsPlumbGroup,t.removeWithFunction(U,function(be){return be===Me}),_e)try{B.getDragArea().removeChild(Me)}catch(be){jsPlumbUtil.log("Could not remove element from Group "+be)}if(fe(Me),!je){var ye={group:B,el:Me};qe&&(ye.targetGroup=qe),I.fire(C,ye)}}}),Pe||I.getGroupManager().updateConnectionsForGroup(B)},this.removeAll=function(we,_e){for(var je=0,Pe=U.length;je<Pe;je++){var qe=U[0];B.remove(qe,we,_e,!0),I.remove(qe,!0)}U.length=0,I.getGroupManager().updateConnectionsForGroup(B)},this.orphanAll=function(){for(var we={},_e=0;_e<U.length;_e++){var je=ne(U[_e]);we[je[0]]=je[1]}return U.length=0,we},this.getMembers=function(){return U},K[m]=this,I.bind(i,function(we){we.el._jsPlumbGroup===this&&me(we.el)}.bind(this));function se(we){return we.offsetParent}u(se,"_findParent");function le(we,_e){var je=se(we),Pe=I.getSize(je),qe=I.getSize(we),Me=_e[0],ye=Me+qe[0],be=_e[1],Ae=be+qe[1];return ye>0&&Me<Pe[0]&&Ae>0&&be<Pe[1]}u(le,"_isInsideParent");function ne(we){var _e=I.getId(we),je=I.getOffset(we);return we.parentNode.removeChild(we),I.getContainer().appendChild(we),I.setPosition(we,je),fe(we),I.dragManager.clearParent(we,_e),[_e,je]}u(ne,"_orphan");function he(we){var _e=[];function je(qe,Me,ye){var be=null;if(!le(qe,[Me,ye])){var Ae=qe._jsPlumbGroup;A?I.remove(qe):be=ne(qe),Ae.remove(qe)}return be}u(je,"_one");for(var Pe=0;Pe<we.selection.length;Pe++)_e.push(je(we.selection[Pe][0],we.selection[Pe][1].left,we.selection[Pe][1].top));return _e.length===1?_e[0]:_e}u(he,"_pruneOrOrphan");function pe(we){var _e=I.getId(we);I.revalidate(we),I.dragManager.revalidateParent(we,_e)}u(pe,"_revalidate");function fe(we){we._katavorioDrag&&((A||J)&&we._katavorioDrag.off(d,he),!A&&!J&&V&&(we._katavorioDrag.off(c,pe),we._katavorioDrag.setRevert(null)))}u(fe,"_unbindDragHandlers");function me(we){we._katavorioDrag&&((A||J)&&we._katavorioDrag.on(d,he),Q&&we._katavorioDrag.setConstrain(!0),X&&we._katavorioDrag.setUseGhostProxy(!0),!A&&!J&&V&&(we._katavorioDrag.on(c,pe),we._katavorioDrag.setRevert(function(_e,je){return!le(_e,je)})))}u(me,"_bindDragHandlers"),this.shouldProxy=function(){return S},I.getGroupManager().addGroup(this)},"Group");s.prototype.addGroup=function(I){var W=this;if(W._groups=W._groups||{},W._groups[I.id]!=null)throw new TypeError("cannot create Group ["+I.id+"]; a Group with that ID exists");if(I.el[m]!=null)throw new TypeError("cannot create Group ["+I.id+"]; the given element is already a Group");var B=new z(W,I);return W._groups[B.id]=B,I.collapsed&&this.collapseGroup(B),B},s.prototype.addToGroup=function(I,W,B){var K=function(X){var Q=this.getId(X);this.manage(Q,X),this.getGroupManager().addToGroup(I,X,B)}.bind(this);if(Array.isArray(W))for(var q=0;q<W.length;q++)K(W[q]);else K(W)},s.prototype.removeFromGroup=function(I,W,B){this.getGroupManager().removeFromGroup(I,W,B),this.getContainer().appendChild(W)},s.prototype.removeGroup=function(I,W,B,K){return this.getGroupManager().removeGroup(I,W,B,K)},s.prototype.removeAllGroups=function(I,W,B){this.getGroupManager().removeAllGroups(I,W,B)},s.prototype.getGroup=function(I){return this.getGroupManager().getGroup(I)},s.prototype.getGroups=function(){return this.getGroupManager().getGroups()},s.prototype.expandGroup=function(I){this.getGroupManager().expandGroup(I)},s.prototype.collapseGroup=function(I){this.getGroupManager().collapseGroup(I)},s.prototype.repaintGroup=function(I){this.getGroupManager().repaintGroup(I)},s.prototype.toggleGroup=function(I){I=this.getGroupManager().getGroup(I),I!=null&&this.getGroupManager()[I.collapsed?"expandGroup":"collapseGroup"](I)},s.prototype.getGroupManager=function(){var I=this[l];return I==null&&(I=this[l]=new N(this)),I},s.prototype.removeGroupManager=function(){delete this[l]},s.prototype.getGroupFor=function(I){if(I=this.getElement(I),I){for(var W=this.getContainer(),B=!1,K=null;!B;)I==null||I===W?B=!0:I[m]?(K=I[m],B=!0):I=I.parentNode;return K}}}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a="Straight",o="Arc",r=u(function(i){this.type="Flowchart",i=i||{},i.stub=i.stub==null?30:i.stub;var d,c=t.Connectors.AbstractConnector.apply(this,arguments),l=i.midpoint==null||isNaN(i.midpoint)?.5:i.midpoint,m=i.alwaysRespectStubs===!0,v=null,x=null,C=i.cornerRadius!=null?i.cornerRadius:0;i.loopbackRadius;var w=u(function(_){return _<0?-1:_===0?0:1},"sgn"),f=u(function(_){return[w(_[2]-_[0]),w(_[3]-_[1])]},"segmentDirections"),T=u(function(_,M,b,P){if(!(v===M&&x===b)){var L=v??P.sx,N=x??P.sy,z=L===M?"v":"h";v=M,x=b,_.push([L,N,M,b,z])}},"addSegment"),k=u(function(_){return Math.sqrt(Math.pow(_[0]-_[2],2)+Math.pow(_[1]-_[3],2))},"segLength"),F=u(function(_){var M=[];return M.push.apply(M,_),M},"_cloneArray"),O=u(function(_,M,b){for(var P=null,L,N,z,I=0;I<M.length-1;I++){if(P=P||F(M[I]),L=F(M[I+1]),N=f(P),z=f(L),C>0&&P[4]!==L[4]){var W=Math.min(k(P),k(L)),B=Math.min(C,W/2);P[2]-=N[0]*B,P[3]-=N[1]*B,L[0]+=z[0]*B,L[1]+=z[1]*B;var K=N[1]===z[0]&&z[0]===1||N[1]===z[0]&&z[0]===0&&N[0]!==z[1]||N[1]===z[0]&&z[0]===-1,q=L[1]>P[3]?1:-1,X=L[0]>P[2]?1:-1,Q=q===X,V=Q&&K||!Q&&!K?L[0]:P[2],J=Q&&K||!Q&&!K?P[3]:L[1];c.addSegment(_,a,{x1:P[0],y1:P[1],x2:P[2],y2:P[3]}),c.addSegment(_,o,{r:B,x1:P[2],y1:P[3],x2:L[0],y2:L[1],cx:V,cy:J,ac:K})}else{var A=P[2]===P[0]?0:P[2]>P[0]?b.lw/2:-(b.lw/2),j=P[3]===P[1]?0:P[3]>P[1]?b.lw/2:-(b.lw/2);c.addSegment(_,a,{x1:P[0]-A,y1:P[1]-j,x2:P[2]+A,y2:P[3]+j})}P=L}L!=null&&c.addSegment(_,a,{x1:L[0],y1:L[1],x2:L[2],y2:L[3]})},"writeSegments");this.midpoint=l,this._compute=function(_,M){d=[],v=null,x=null;var b=u(function(){return[_.startStubX,_.startStubY,_.endStubX,_.endStubY]},"commonStubCalculator"),P={perpendicular:b,orthogonal:b,opposite:function(j){var S=_,U=j==="x"?0:1,G={x:function(){return S.so[U]===1&&(S.startStubX>S.endStubX&&S.tx>S.startStubX||S.sx>S.endStubX&&S.tx>S.sx)||S.so[U]===-1&&(S.startStubX<S.endStubX&&S.tx<S.startStubX||S.sx<S.endStubX&&S.tx<S.sx)},y:function(){return S.so[U]===1&&(S.startStubY>S.endStubY&&S.ty>S.startStubY||S.sy>S.endStubY&&S.ty>S.sy)||S.so[U]===-1&&(S.startStubY<S.endStubY&&S.ty<S.startStubY||S.sy<S.endStubY&&S.ty<S.sy)}};return!m&&G[j]()?{x:[(_.sx+_.tx)/2,_.startStubY,(_.sx+_.tx)/2,_.endStubY],y:[_.startStubX,(_.sy+_.ty)/2,_.endStubX,(_.sy+_.ty)/2]}[j]:[_.startStubX,_.startStubY,_.endStubX,_.endStubY]}},L=P[_.anchorOrientation](_.sourceAxis),N=_.sourceAxis==="x"?0:1,z=_.sourceAxis==="x"?1:0,I=L[N],W=L[z],B=L[N+2],K=L[z+2];T(d,L[0],L[1],_);var q=_.startStubX+(_.endStubX-_.startStubX)*l,X=_.startStubY+(_.endStubY-_.startStubY)*l,Q={x:[0,1],y:[1,0]},V={perpendicular:function(j){var S=_,U={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},G={x:[[S.startStubX,S.endStubX],null,[S.endStubX,S.startStubX]],y:[[S.startStubY,S.endStubY],null,[S.endStubY,S.startStubY]]},Y={x:[[q,S.startStubY],[q,S.endStubY]],y:[[S.startStubX,X],[S.endStubX,X]]},se={x:[[S.endStubX,S.startStubY]],y:[[S.startStubX,S.endStubY]]},le={x:[[S.startStubX,S.endStubY],[S.endStubX,S.endStubY]],y:[[S.endStubX,S.startStubY],[S.endStubX,S.endStubY]]},ne={x:[[S.startStubX,X],[S.endStubX,X],[S.endStubX,S.endStubY]],y:[[q,S.startStubY],[q,S.endStubY],[S.endStubX,S.endStubY]]},he={x:[S.startStubY,S.endStubY],y:[S.startStubX,S.endStubX]},pe=Q[j][0],fe=Q[j][1],me=S.so[pe]+1,we=S.to[fe]+1,_e=S.to[fe]===-1&&he[j][1]<he[j][0]||S.to[fe]===1&&he[j][1]>he[j][0],je=G[j][me][0],Pe=G[j][me][1],qe=U[j][me][we];if(S.segment===qe[3]||S.segment===qe[2]&&_e)return Y[j];if(S.segment===qe[2]&&Pe<je)return se[j];if(S.segment===qe[2]&&Pe>=je||S.segment===qe[1]&&!_e)return ne[j];if(S.segment===qe[0]||S.segment===qe[1]&&_e)return le[j]},orthogonal:function(j,S,U,G,Y){var se=_,le={x:se.so[0]===-1?Math.min(S,G):Math.max(S,G),y:se.so[1]===-1?Math.min(S,G):Math.max(S,G)}[j];return{x:[[le,U],[le,Y],[G,Y]],y:[[U,le],[Y,le],[Y,G]]}[j]},opposite:function(j,S,U,G){var Y=_,se={x:"y",y:"x"}[j],le={x:"height",y:"width"}[j],ne=Y["is"+j.toUpperCase()+"GreaterThanStubTimes2"];if(M.sourceEndpoint.elementId===M.targetEndpoint.elementId){var he=U+(1-M.sourceEndpoint.anchor[se])*M.sourceInfo[le]+c.maxStub;return{x:[[S,he],[G,he]],y:[[he,S],[he,G]]}[j]}else{if(!ne||Y.so[N]===1&&S>G||Y.so[N]===-1&&S<G)return{x:[[S,X],[G,X]],y:[[q,S],[q,G]]}[j];if(Y.so[N]===1&&S<G||Y.so[N]===-1&&S>G)return{x:[[q,Y.sy],[q,Y.ty]],y:[[Y.sx,X],[Y.tx,X]]}[j]}}},J=V[_.anchorOrientation](_.sourceAxis,I,W,B,K);if(J)for(var A=0;A<J.length;A++)T(d,J[A][0],J[A][1],_);T(d,L[2],L[3],_),T(d,_.tx,_.ty,_),O(this,d,_)}},"Flowchart");t.Connectors.Flowchart=r,s.extend(t.Connectors.Flowchart,t.Connectors.AbstractConnector)}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil;t.Connectors.AbstractBezierConnector=function(o){o=o||{};var r=o.showLoopback!==!1;o.curviness;var i=o.margin||5;o.proximityLimit;var d=o.orientation&&o.orientation==="clockwise",c=o.loopbackRadius||25,l;return this._compute=function(m,v){var x=v.sourcePos,C=v.targetPos,w=Math.abs(x[0]-C[0]),f=Math.abs(x[1]-C[1]);if(!r||v.sourceEndpoint.elementId!==v.targetEndpoint.elementId)this._computeBezier(m,v,x,C,w,f);else{var T=v.sourcePos[0],k=v.sourcePos[1]-i,F=T,O=k-c,_=F-c,M=O-c;w=2*c,f=2*c,m.points[0]=_,m.points[1]=M,m.points[2]=w,m.points[3]=f,l.addSegment(this,"Arc",{loopback:!0,x1:T-_+4,y1:k-M,startAngle:0,endAngle:2*Math.PI,r:c,ac:!d,x2:T-_-4,y2:k-M,cx:F-_,cy:O-M})}},l=t.Connectors.AbstractConnector.apply(this,arguments),l},s.extend(t.Connectors.AbstractBezierConnector,t.Connectors.AbstractConnector);var a=u(function(o){o=o||{},this.type="Bezier";var r=t.Connectors.AbstractBezierConnector.apply(this,arguments),i=o.curviness||150,d=10;this.getCurviness=function(){return i},this._findControlPoint=function(c,l,m,v,x,C,w){var f=C[0]!==w[0]||C[1]===w[1],T=[];return f?(w[0]===0?T.push(m[0]<l[0]?c[0]+d:c[0]-d):T.push(c[0]+i*w[0]),w[1]===0?T.push(m[1]<l[1]?c[1]+d:c[1]-d):T.push(c[1]+i*C[1])):(C[0]===0?T.push(l[0]<m[0]?c[0]+d:c[0]-d):T.push(c[0]-i*C[0]),C[1]===0?T.push(l[1]<m[1]?c[1]+d:c[1]-d):T.push(c[1]+i*w[1])),T},this._computeBezier=function(c,l,m,v,x,C){var w,f,T=m[0]<v[0]?x:0,k=m[1]<v[1]?C:0,F=m[0]<v[0]?0:x,O=m[1]<v[1]?0:C;w=this._findControlPoint([T,k],m,v,l.sourceEndpoint,l.targetEndpoint,c.so,c.to),f=this._findControlPoint([F,O],v,m,l.targetEndpoint,l.sourceEndpoint,c.to,c.so),r.addSegment(this,"Bezier",{x1:T,y1:k,x2:F,y2:O,cp1x:w[0],cp1y:w[1],cp2x:f[0],cp2y:f[1]})}},"Bezier");t.Connectors.Bezier=a,s.extend(a,t.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a=u(function(i,d,c,l){return i<=c&&l<=d?1:i<=c&&d<=l?2:c<=i&&l>=d?3:4},"_segment"),o=u(function(i,d,c,l,m,v,x,C,w){if(C<=w)return[i,d];if(c===1)return l[3]<=0&&m[3]>=1?[i+(l[2]<.5?-1*v:v),d]:l[2]>=1&&m[2]<=0?[i,d+(l[3]<.5?-1*x:x)]:[i+-1*v,d+-1*x];if(c===2)return l[3]>=1&&m[3]<=0?[i+(l[2]<.5?-1*v:v),d]:l[2]>=1&&m[2]<=0?[i,d+(l[3]<.5?-1*x:x)]:[i+v,d+-1*x];if(c===3)return l[3]>=1&&m[3]<=0?[i+(l[2]<.5?-1*v:v),d]:l[2]<=0&&m[2]>=1?[i,d+(l[3]<.5?-1*x:x)]:[i+-1*v,d+-1*x];if(c===4)return l[3]<=0&&m[3]>=1?[i+(l[2]<.5?-1*v:v),d]:l[2]<=0&&m[2]>=1?[i,d+(l[3]<.5?-1*x:x)]:[i+v,d+-1*x]},"_findControlPoint"),r=u(function(i){i=i||{},this.type="StateMachine";var d=t.Connectors.AbstractBezierConnector.apply(this,arguments),c=i.curviness||10,l=i.margin||5,m=i.proximityLimit||80;i.orientation&&i.orientation;var v;this._computeBezier=function(x,C,w,f,T,k){var F=C.sourcePos[0]<C.targetPos[0]?0:T,O=C.sourcePos[1]<C.targetPos[1]?0:k,_=C.sourcePos[0]<C.targetPos[0]?T:0,M=C.sourcePos[1]<C.targetPos[1]?k:0;C.sourcePos[2]===0&&(F-=l),C.sourcePos[2]===1&&(F+=l),C.sourcePos[3]===0&&(O-=l),C.sourcePos[3]===1&&(O+=l),C.targetPos[2]===0&&(_-=l),C.targetPos[2]===1&&(_+=l),C.targetPos[3]===0&&(M-=l),C.targetPos[3]===1&&(M+=l);var b=(F+_)/2,P=(O+M)/2,L=a(F,O,_,M),N=Math.sqrt(Math.pow(_-F,2)+Math.pow(M-O,2)),z,I,W,B;v=o(b,P,L,C.sourcePos,C.targetPos,c,c,N,m),z=v[0],I=v[0],W=v[1],B=v[1],d.addSegment(this,"Bezier",{x1:_,y1:M,x2:F,y2:O,cp1x:z,cp1y:W,cp2x:I,cp2y:B})}},"StateMachine");t.Connectors.StateMachine=r,s.extend(r,t.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a="Straight",o=u(function(r){this.type=a;var i=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(d,c){i.addSegment(this,a,{x1:d.sx,y1:d.sy,x2:d.startStubX,y2:d.startStubY}),i.addSegment(this,a,{x1:d.startStubX,y1:d.startStubY,x2:d.endStubX,y2:d.endStubY}),i.addSegment(this,a,{x1:d.endStubX,y1:d.endStubY,x2:d.tx,y2:d.ty})}},"Straight");t.Connectors.Straight=o,s.extend(o,t.Connectors.AbstractConnector)}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",r="dashstyle",i="linearGradient",d="radialGradient",c="defs",l="fill",m="stop",v="stroke",x="stroke-width",C="style",w="none",f="jsplumb_gradient_",T="strokeWidth",k={svg:"http://www.w3.org/2000/svg"},F=u(function(B,K){for(var q in K)B.setAttribute(q,""+K[q])},"_attr"),O=u(function(B,K){return K=K||{},K.version="1.1",K.xmlns=k.svg,t.createElementNS(k.svg,B,null,null,K)},"_node"),_=u(function(B){return"position:absolute;left:"+B[0]+"px;top:"+B[1]+"px"},"_pos"),M=u(function(B){for(var K=B.querySelectorAll(" defs,linearGradient,radialGradient"),q=0;q<K.length;q++)K[q].parentNode.removeChild(K[q])},"_clearGradient"),b=u(function(B,K,q,X,Q){var V=f+Q._jsPlumb.instance.idstamp();M(B);var J;q.gradient.offset?J=O(d,{id:V}):J=O(i,{id:V,gradientUnits:"userSpaceOnUse"});var A=O(c);B.appendChild(A),A.appendChild(J);for(var j=0;j<q.gradient.stops.length;j++){var S=Q.segment===1||Q.segment===2?j:q.gradient.stops.length-1-j,U=q.gradient.stops[S][1],G=O(m,{offset:Math.floor(q.gradient.stops[j][0]*100)+"%","stop-color":U});J.appendChild(G)}var Y=q.stroke?v:l;K.setAttribute(Y,"url(#"+V+")")},"_updateGradient"),P=u(function(B,K,q,X,Q){if(K.setAttribute(l,q.fill?q.fill:w),K.setAttribute(v,q.stroke?q.stroke:w),q.gradient?b(B,K,q,X,Q):(M(B),K.setAttribute(C,"")),q.strokeWidth&&K.setAttribute(x,q.strokeWidth),q[r]&&q[T]&&!q[o]){var V=q[r].indexOf(",")===-1?" ":",",J=q[r].split(V),A="";J.forEach(function(S){A+=Math.floor(S*q.strokeWidth)+V}),K.setAttribute(o,A)}else q[o]&&K.setAttribute(o,q[o]);for(var j in a)q[j]&&K.setAttribute(a[j],q[j])},"_applyStyles"),L=u(function(B,K,q){B.childNodes.length>q?B.insertBefore(K,B.childNodes[q]):B.appendChild(K)},"_appendAtIndex");s.svg={node:O,attr:F,pos:_};var N=u(function(B){var K=B.pointerEventsSpec||"all",q={};t.jsPlumbUIComponent.apply(this,B.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var X=B.cssClass+" "+(B.originalArgs[0].cssClass||""),Q={style:"",width:0,height:0,"pointer-events":K,position:"absolute"};this.svg=O("svg",Q),B.useDivWrapper?(this.canvas=t.createElement("div",{position:"absolute"}),s.sizeElement(this.canvas,0,0,1,1),this.canvas.className=X):(F(this.svg,{class:X}),this.canvas=this.svg),B._jsPlumb.appendElement(this.canvas,B.originalArgs[0].parent),B.useDivWrapper&&this.canvas.appendChild(this.svg);var V=[this.canvas];return this.getDisplayElements=function(){return V},this.appendDisplayElement=function(J){V.push(J)},this.paint=function(J,A,j){if(J!=null){var S=[this.x,this.y],U=[this.w,this.h],G;j!=null&&(j.xmin<0&&(S[0]+=j.xmin),j.ymin<0&&(S[1]+=j.ymin),U[0]=j.xmax+(j.xmin<0?-j.xmin:0),U[1]=j.ymax+(j.ymin<0?-j.ymin:0)),B.useDivWrapper?(s.sizeElement(this.canvas,S[0],S[1],U[0]>0?U[0]:1,U[1]>0?U[1]:1),S[0]=0,S[1]=0,G=_([0,0])):G=_([S[0],S[1]]),q.paint.apply(this,arguments),F(this.svg,{style:G,width:U[0]||1,height:U[1]||1})}},{renderer:q}},"SvgComponent");s.extend(N,t.jsPlumbUIComponent,{cleanup:function(B){B||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(B){var K=B.getContainer();this.canvas&&this.canvas.parentNode==null&&K.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&K.appendChild(this.bgCanvas)},setVisible:function(B){this.canvas&&(this.canvas.style.display=B?"block":"none")}}),t.ConnectorRenderers.svg=function(B){var K=this,q=N.apply(this,[{cssClass:B._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:B._jsPlumb}]);q.renderer.paint=function(X,Q,V){var J=K.getSegments(),A="",j=[0,0];if(V.xmin<0&&(j[0]=-V.xmin),V.ymin<0&&(j[1]=-V.ymin),J.length>0){A=K.getPathData();var S={d:A,transform:"translate("+j[0]+","+j[1]+")","pointer-events":B["pointer-events"]||"visibleStroke"},U=null,G=[K.x,K.y,K.w,K.h];if(X.outlineStroke){var Y=X.outlineWidth||1,se=X.strokeWidth+2*Y;U=t.extend({},X),delete U.gradient,U.stroke=X.outlineStroke,U.strokeWidth=se,K.bgPath==null?(K.bgPath=O("path",S),t.addClass(K.bgPath,t.connectorOutlineClass),L(K.svg,K.bgPath,0)):F(K.bgPath,S),P(K.svg,K.bgPath,U,G,K)}K.path==null?(K.path=O("path",S),L(K.svg,K.path,X.outlineStroke?1:0)):F(K.path,S),P(K.svg,K.path,X,G,K)}}},s.extend(t.ConnectorRenderers.svg,N);var z=t.SvgEndpoint=function(B){var K=N.apply(this,[{cssClass:B._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:B._jsPlumb}]);K.renderer.paint=function(q){var X=t.extend({},q);X.outlineStroke&&(X.stroke=X.outlineStroke),this.node==null?(this.node=this.makeNode(X),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),P(this.svg,this.node,X,[this.x,this.y,this.w,this.h],this),_(this.node,[this.x,this.y])}.bind(this)};s.extend(z,N),t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments),z.apply(this,arguments),this.makeNode=function(B){return O("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(B){F(B,{cx:this.w/2,cy:this.h/2,r:this.radius})}},s.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,z]),t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),z.apply(this,arguments),this.makeNode=function(B){return O("rect",{width:this.w,height:this.h})},this.updateNode=function(B){F(B,{width:this.w,height:this.h})}},s.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,z]),t.Endpoints.svg.Image=t.Endpoints.Image,t.Endpoints.svg.Blank=t.Endpoints.Blank,t.Overlays.svg.Label=t.Overlays.Label,t.Overlays.svg.Custom=t.Overlays.Custom;var I=u(function(B,K){B.apply(this,K),t.jsPlumbUIComponent.apply(this,K),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(X,Q){if(X.component.svg&&Q){this.path==null&&(this.path=O("path",{"pointer-events":"all"}),X.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,X.component),this.canvas=X.component.svg);var V=K&&K.length===1&&K[0].cssClass||"",J=[0,0];Q.xmin<0&&(J[0]=-Q.xmin),Q.ymin<0&&(J[1]=-Q.ymin),F(this.path,{d:q(X.d),class:V,stroke:X.stroke?X.stroke:null,fill:X.fill?X.fill:null,transform:"translate("+J[0]+","+J[1]+")"})}};var q=u(function(X){return isNaN(X.cxy.x)||isNaN(X.cxy.y)?"":"M"+X.hxy.x+","+X.hxy.y+" L"+X.tail[0].x+","+X.tail[0].y+" L"+X.cxy.x+","+X.cxy.y+" L"+X.tail[1].x+","+X.tail[1].y+" L"+X.hxy.x+","+X.hxy.y},"makePath");this.transfer=function(X){X.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),X.canvas.appendChild(this.path))}},"AbstractSvgArrowOverlay"),W={cleanup:function(B){this.path!=null&&(B?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(B,K){this.path&&K.canvas&&K.canvas.appendChild(this.path)},setVisible:function(B){this.path!=null&&(this.path.style.display=B?"block":"none")}};s.extend(I,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay]),t.Overlays.svg.Arrow=function(){I.apply(this,[t.Overlays.Arrow,arguments])},s.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,I],W),t.Overlays.svg.PlainArrow=function(){I.apply(this,[t.Overlays.PlainArrow,arguments])},s.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,I],W),t.Overlays.svg.Diamond=function(){I.apply(this,[t.Overlays.Diamond,arguments])},s.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,I],W),t.Overlays.svg.GuideLines=function(){var B=null,K=this,q,X;t.Overlays.GuideLines.apply(this,arguments),this.paint=function(V,J){B==null&&(B=O("path"),V.connector.svg.appendChild(B),K.attachListeners(B,V.connector),K.attachListeners(B,K),q=O("path"),V.connector.svg.appendChild(q),K.attachListeners(q,V.connector),K.attachListeners(q,K),X=O("path"),V.connector.svg.appendChild(X),K.attachListeners(X,V.connector),K.attachListeners(X,K));var A=[0,0];J.xmin<0&&(A[0]=-J.xmin),J.ymin<0&&(A[1]=-J.ymin),F(B,{d:Q(V.head,V.tail),stroke:"red",fill:null,transform:"translate("+A[0]+","+A[1]+")"}),F(q,{d:Q(V.tailLine[0],V.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+A[0]+","+A[1]+")"}),F(X,{d:Q(V.headLine[0],V.headLine[1]),stroke:"green",fill:null,transform:"translate("+A[0]+","+A[1]+")"})};var Q=u(function(V,J){return"M "+V.x+","+V.y+" L"+J.x+","+J.y},"makePath")},s.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}.call(typeof window<"u"?window:mt),function(){var e=this,t=e.jsPlumb,s=e.jsPlumbUtil,a=e.Katavorio,o=e.Biltong,r=u(function(b){var P=b._mottle;return P||(P=b._mottle=new e.Mottle),P},"_getEventManager"),i=u(function(b,P){P=P||"main";var L="_katavorio_"+P,N=b[L],z=b.getEventManager();return N||(N=new a({bind:z.on,unbind:z.off,getSize:t.getSize,getConstrainingRectangle:function(I){return[I.parentNode.scrollWidth,I.parentNode.scrollHeight]},getPosition:function(I,W){var B=b.getOffset(I,W,I._katavorioDrag?I.offsetParent:null);return[B.left,B.top]},setPosition:function(I,W){I.style.left=W[0]+"px",I.style.top=W[1]+"px"},addClass:t.addClass,removeClass:t.removeClass,intersects:o.intersects,indexOf:function(I,W){return I.indexOf(W)},scope:b.getDefaultScope(),css:{noSelect:b.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),N.setZoom(b.getZoom()),b[L]=N,b.bind("zoom",N.setZoom)),N},"_getDragManager"),d=u(function(b){var P=b.el._jsPlumbDragOptions,L=!0;return P.canDrag&&(L=P.canDrag()),L&&(this.setHoverSuspended(!0),this.select({source:b.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:b.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),L},"_dragStart"),c=u(function(b){var P=this.getUIPosition(arguments,this.getZoom());if(P!=null){var L=b.el._jsPlumbDragOptions;this.draw(b.el,P,null,!0),L._dragging&&this.addClass(b.el,"jtk-dragged"),L._dragging=!0}},"_dragMove"),l=u(function(b){for(var P=b.selection,L,N=function(I){var W;I[1]!=null&&(L=this.getUIPosition([{el:I[2].el,pos:[I[1].left,I[1].top]}]),W=this.draw(I[2].el,L)),I[0]._jsPlumbDragOptions!=null&&delete I[0]._jsPlumbDragOptions._dragging,this.removeClass(I[0],"jtk-dragged"),this.select({source:I[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:I[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),b.e._drawResult=b.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(b.e._drawResult.c,W.c),Array.prototype.push.apply(b.e._drawResult.e,W.e),Array.prototype.push.apply(b.e._drawResult.a,W.a),this.getDragManager().dragEnded(I[2].el)}.bind(this),z=0;z<P.length;z++)N(P[z]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},"_dragStop"),m=u(function(b,P){var L=u(function(N){if(P[N]!=null)if(s.isString(P[N])){var z=P[N].match(/-=/)?-1:1,I=P[N].substring(2);return b[N]+z*I}else return P[N];else return b[N]},"_one");return[L("left"),L("top")]},"_animProps"),v=u(function(b,P){if(P==null)return[0,0];var L=T(P),N=f(L,0);return[N[b+"X"],N[b+"Y"]]},"_genLoc"),x=v.bind(this,"page"),C=v.bind(this,"screen"),w=v.bind(this,"client"),f=u(function(b,P){return b.item?b.item(P):b[P]},"_getTouch"),T=u(function(b){return b.touches&&b.touches.length>0?b.touches:b.changedTouches&&b.changedTouches.length>0?b.changedTouches:b.targetTouches&&b.targetTouches.length>0?b.targetTouches:[b]},"_touches"),k=u(function(b){var P={},L=[],N={},z={},I={};this.register=function(W){var B=b.getId(W),K;P[B]||(P[B]=W,L.push(W),N[B]={});var q=u(function(X){if(X){for(var Q=0;Q<X.childNodes.length;Q++)if(X.childNodes[Q].nodeType!==3&&X.childNodes[Q].nodeType!==8){var V=jsPlumb.getElement(X.childNodes[Q]),J=b.getId(X.childNodes[Q],null,!0);if(J&&z[J]&&z[J]>0){K||(K=b.getOffset(W));var A=b.getOffset(V);N[B][J]={id:J,offset:{left:A.left-K.left,top:A.top-K.top}},I[J]=B}q(X.childNodes[Q])}}},"_oneLevel");q(W)},this.updateOffsets=function(W,B){if(W!=null){B=B||{};var K=jsPlumb.getElement(W),q=b.getId(K),X=N[q],Q;if(X){for(var V in X)if(X.hasOwnProperty(V)){var J=jsPlumb.getElement(V),A=B[V]||b.getOffset(J);if(J.offsetParent==null&&N[q][V]!=null)continue;Q||(Q=b.getOffset(K)),N[q][V]={id:V,offset:{left:A.left-Q.left,top:A.top-Q.top}},I[V]=q}}}},this.endpointAdded=function(W,B){B=B||b.getId(W);var K=document.body,q=W.parentNode;for(z[B]=z[B]?z[B]+1:1;q!=null&&q!==K;){var X=b.getId(q,null,!0);if(X&&P[X]){var Q=b.getOffset(q);if(N[X][B]==null){var V=b.getOffset(W);N[X][B]={id:B,offset:{left:V.left-Q.left,top:V.top-Q.top}},I[B]=X}break}q=q.parentNode}},this.endpointDeleted=function(W){if(z[W.elementId]&&(z[W.elementId]--,z[W.elementId]<=0))for(var B in N)N.hasOwnProperty(B)&&N[B]&&(delete N[B][W.elementId],delete I[W.elementId])},this.changeId=function(W,B){N[B]=N[W],N[W]={},I[B]=I[W],I[W]=null},this.getElementsForDraggable=function(W){return N[W]},this.elementRemoved=function(W){var B=I[W];B&&(N[B]&&delete N[B][W],delete I[W])},this.reset=function(){P={},L=[],N={},z={}},this.dragEnded=function(W){if(W.offsetParent!=null){var B=b.getId(W),K=I[B];K&&this.updateOffsets(K)}},this.setParent=function(W,B,K,q,X){var Q=I[B];N[q]||(N[q]={});var V=b.getOffset(K),J=X||b.getOffset(W);Q&&N[Q]&&delete N[Q][B],N[q][B]={id:B,offset:{left:J.left-V.left,top:J.top-V.top}},I[B]=q},this.clearParent=function(W,B){var K=I[B];K&&(delete N[K][B],delete I[B])},this.revalidateParent=function(W,B,K){var q=I[B];if(q){var X={};X[B]=K,this.updateOffsets(q,X),b.revalidate(q)}},this.getDragAncestor=function(W){var B=jsPlumb.getElement(W),K=b.getId(B),q=I[K];return q?jsPlumb.getElement(q):null}},"DragManager"),F=u(function(b,P,L){P=s.fastTrim(P),typeof b.className.baseVal<"u"?b.className.baseVal=P:b.className=P;try{var N=b.classList;if(N!=null){for(;N.length>0;)N.remove(N.item(0));for(var z=0;z<L.length;z++)L[z]&&N.add(L[z])}}catch(I){s.log("JSPLUMB: cannot set class list",I)}},"_setClassName"),O=u(function(b){return typeof b.className.baseVal>"u"?b.className:b.className.baseVal},"_getClassName"),_=u(function(b,P,L){P=P==null?[]:s.isArray(P)?P:P.split(/\s+/),L=L==null?[]:s.isArray(L)?L:L.split(/\s+/);var N=O(b),z=N.split(/\s+/),I=u(function(W,B){for(var K=0;K<B.length;K++)if(W)z.indexOf(B[K])===-1&&z.push(B[K]);else{var q=z.indexOf(B[K]);q!==-1&&z.splice(q,1)}},"_oneSet");I(!0,P),I(!1,L),F(b,z.join(" "),z)},"_classManip");e.jsPlumb.extend(e.jsPlumbInstance.prototype,{headless:!1,pageLocation:x,screenLocation:C,clientLocation:w,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new k(this)),this.dragManager},recalculateOffsets:function(b){this.getDragManager().updateOffsets(b)},createElement:function(b,P,L,N){return this.createElementNS(null,b,P,L,N)},createElementNS:function(b,P,L,N,z){var I=b==null?document.createElement(P):document.createElementNS(b,P),W;L=L||{};for(W in L)I.style[W]=L[W];N&&(I.className=N),z=z||{};for(W in z)I.setAttribute(W,""+z[W]);return I},getAttribute:function(b,P){return b.getAttribute!=null?b.getAttribute(P):null},setAttribute:function(b,P,L){b.setAttribute!=null&&b.setAttribute(P,L)},setAttributes:function(b,P){for(var L in P)P.hasOwnProperty(L)&&b.setAttribute(L,P[L])},appendToRoot:function(b){document.body.appendChild(b)},getRenderModes:function(){return["svg"]},getClass:O,addClass:function(b,P){jsPlumb.each(b,function(L){_(L,P)})},hasClass:function(b,P){return b=jsPlumb.getElement(b),b.classList?b.classList.contains(P):O(b).indexOf(P)!==-1},removeClass:function(b,P){jsPlumb.each(b,function(L){_(L,null,P)})},toggleClass:function(b,P){jsPlumb.hasClass(b,P)?jsPlumb.removeClass(b,P):jsPlumb.addClass(b,P)},updateClasses:function(b,P,L){jsPlumb.each(b,function(N){_(N,P,L)})},setClass:function(b,P){P!=null&&jsPlumb.each(b,function(L){F(L,P,P.split(/\s+/))})},setPosition:function(b,P){b.style.left=P.left+"px",b.style.top=P.top+"px"},getPosition:function(b){var P=u(function(L){var N=b.style[L];return N?N.substring(0,N.length-2):0},"_one");return{left:P("left"),top:P("top")}},getStyle:function(b,P){return typeof window.getComputedStyle<"u"?getComputedStyle(b,null).getPropertyValue(P):b.currentStyle[P]},getSelector:function(b,P){var L=null;return arguments.length===1?L=b.nodeType!=null?b:document.querySelectorAll(b):L=b.querySelectorAll(P),L},getOffset:function(b,P,L){b=jsPlumb.getElement(b),L=L||this.getContainer();for(var N={left:b.offsetLeft,top:b.offsetTop},z=P||L!=null&&b!==L&&b.offsetParent!==L?b.offsetParent:null,I=function(K){K!=null&&K!==document.body&&(K.scrollTop>0||K.scrollLeft>0)&&(N.left-=K.scrollLeft,N.top-=K.scrollTop)}.bind(this);z!=null;)N.left+=z.offsetLeft,N.top+=z.offsetTop,I(z),z=P?z.offsetParent:z.offsetParent===L?null:z.offsetParent;if(L!=null&&!P&&(L.scrollTop>0||L.scrollLeft>0)){var W=b.offsetParent!=null?this.getStyle(b.offsetParent,"position"):"static",B=this.getStyle(b,"position");B!=="absolute"&&B!=="fixed"&&W!=="absolute"&&W!=="fixed"&&(N.left-=L.scrollLeft,N.top-=L.scrollTop)}return N},getPositionOnElement:function(b,P,L){var N=typeof P.getBoundingClientRect<"u"?P.getBoundingClientRect():{left:0,top:0,width:0,height:0},z=document.body,I=document.documentElement,W=window.pageYOffset||I.scrollTop||z.scrollTop,B=window.pageXOffset||I.scrollLeft||z.scrollLeft,K=I.clientTop||z.clientTop||0,q=I.clientLeft||z.clientLeft||0,X=0,Q=0,V=N.top+W-K+X*L,J=N.left+B-q+Q*L,A=jsPlumb.pageLocation(b),j=N.width||P.offsetWidth*L,S=N.height||P.offsetHeight*L,U=(A[0]-J)/j,G=(A[1]-V)/S;return[U,G]},getAbsolutePosition:function(b){var P=u(function(L){var N=b.style[L];if(N)return parseFloat(N.substring(0,N.length-2))},"_one");return[P("left"),P("top")]},setAbsolutePosition:function(b,P,L,N){L?this.animate(b,{left:"+="+(P[0]-L[0]),top:"+="+(P[1]-L[1])},N):(b.style.left=P[0]+"px",b.style.top=P[1]+"px")},getSize:function(b){return[b.offsetWidth,b.offsetHeight]},getWidth:function(b){return b.offsetWidth},getHeight:function(b){return b.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(b,P){var L;return b=s.isArray(b)||b.length!=null&&!s.isString(b)?b:[b],Array.prototype.slice.call(b).forEach(function(N){L=this.info(N),L.el&&this._initDraggableIfNecessary(L.el,!0,P,L.id,!0)}.bind(this)),this},snapToGrid:function(b,P,L){var N=[],z=function(B){var K=this.info(B);if(K.el!=null&&K.el._katavorioDrag){var q=K.el._katavorioDrag.snap(P,L);this.revalidate(K.el),N.push([K.el,q])}}.bind(this);if(arguments.length===1||arguments.length===3)z(b,P,L);else{var I=this.getManagedElements();for(var W in I)z(W,arguments[0],arguments[1])}return N},initDraggable:function(b,P,L){i(this,L).draggable(b,P),b._jsPlumbDragOptions=P},destroyDraggable:function(b,P){i(this,P).destroyDraggable(b),b._jsPlumbDragOptions=null,b._jsPlumbRelatedElement=null},unbindDraggable:function(b,P,L,N){i(this,N).destroyDraggable(b,P,L)},setDraggable:function(b,P){return jsPlumb.each(b,function(L){this.isDragSupported(L)&&(this._draggableStates[this.getAttribute(L,"id")]=P,this.setElementDraggable(L,P))}.bind(this))},_draggableStates:{},toggleDraggable:function(b){var P;return jsPlumb.each(b,function(L){var N=this.getAttribute(L,"id");return P=this._draggableStates[N]==null?!1:this._draggableStates[N],P=!P,this._draggableStates[N]=P,this.setDraggable(L,P),P}.bind(this)),P},_initDraggableIfNecessary:function(b,P,L,N,z){if(!jsPlumb.headless){var I=P??!1;if(I&&jsPlumb.isDragSupported(b,this)){var W=L||this.Defaults.DragOptions;if(W=jsPlumb.extend({},W),jsPlumb.isAlreadyDraggable(b,this))L.force&&this.initDraggable(b,W);else{var B=jsPlumb.dragEvents.drag,K=jsPlumb.dragEvents.stop,q=jsPlumb.dragEvents.start;this.manage(N,b),W[q]=s.wrap(W[q],d.bind(this)),W[B]=s.wrap(W[B],c.bind(this)),W[K]=s.wrap(W[K],l.bind(this));var X=this.getId(b);this._draggableStates[X]=!0;var Q=this._draggableStates[X];W.disabled=Q==null?!1:!Q,this.initDraggable(b,W),this.getDragManager().register(b),z&&this.fire("elementDraggable",{el:b,options:W})}}}},animationSupported:!0,getElement:function(b){return b==null?null:(b=typeof b=="string"?b:b.tagName==null&&b.length!=null&&b.enctype==null?b[0]:b,typeof b=="string"?document.getElementById(b):b)},removeElement:function(b){i(this).elementRemoved(b),this.getEventManager().remove(b)},doAnimate:function(b,P,L){L=L||{};var N=this.getOffset(b),z=m(N,P),I=z[0]-N.left,W=z[1]-N.top,B=L.duration||250,K=15,q=B/K,X=K/B*I,Q=K/B*W,V=0,J=setInterval(function(){t.setPosition(b,{left:N.left+X*(V+1),top:N.top+Q*(V+1)}),L.step!=null&&L.step(V,Math.ceil(q)),V++,V>=q&&(window.clearInterval(J),L.complete!=null&&L.complete())},K)},destroyDroppable:function(b,P){i(this,P).destroyDroppable(b)},unbindDroppable:function(b,P,L,N){i(this,N).destroyDroppable(b,P,L)},droppable:function(b,P){b=s.isArray(b)||b.length!=null&&!s.isString(b)?b:[b];var L;return P=P||{},P.allowLoopback=!1,Array.prototype.slice.call(b).forEach(function(N){L=this.info(N),L.el&&this.initDroppable(L.el,P)}.bind(this)),this},initDroppable:function(b,P,L){i(this,L).droppable(b,P)},isAlreadyDraggable:function(b){return b._katavorioDrag!=null},isDragSupported:function(b,P){return!0},isDropSupported:function(b,P){return!0},isElementDraggable:function(b){return b=t.getElement(b),b._katavorioDrag&&b._katavorioDrag.isEnabled()},getDragObject:function(b){return b[0].drag.getDragElement()},getDragScope:function(b){return b._katavorioDrag&&b._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(b){return b[0].e},getUIPosition:function(b,P){var L=b[0].el;if(L.offsetParent==null)return null;var N=b[0].finalPos||b[0].pos,z={left:N[0],top:N[1]};if(L._katavorioDrag&&L.offsetParent!==this.getContainer()){var I=this.getOffset(L.offsetParent);z.left+=I.left,z.top+=I.top}return z},setDragFilter:function(b,P,L){b._katavorioDrag&&b._katavorioDrag.setFilter(P,L)},setElementDraggable:function(b,P){b=t.getElement(b),b._katavorioDrag&&b._katavorioDrag.setEnabled(P)},setDragScope:function(b,P){b._katavorioDrag&&b._katavorioDrag.k.setDragScope(b,P)},setDropScope:function(b,P){b._katavorioDrop&&b._katavorioDrop.length>0&&b._katavorioDrop[0].k.setDropScope(b,P)},addToPosse:function(b,P){var L=Array.prototype.slice.call(arguments,1),N=i(this);t.each(b,function(z){z=[t.getElement(z)],z.push.apply(z,L),N.addToPosse.apply(N,z)})},setPosse:function(b,P){var L=Array.prototype.slice.call(arguments,1),N=i(this);t.each(b,function(z){z=[t.getElement(z)],z.push.apply(z,L),N.setPosse.apply(N,z)})},removeFromPosse:function(b,P){var L=Array.prototype.slice.call(arguments,1),N=i(this);t.each(b,function(z){z=[t.getElement(z)],z.push.apply(z,L),N.removeFromPosse.apply(N,z)})},removeFromAllPosses:function(b){var P=i(this);t.each(b,function(L){P.removeFromAllPosses(t.getElement(L))})},setPosseState:function(b,P,L){var N=i(this);t.each(b,function(z){N.setPosseState(t.getElement(z),P,L)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(b){b._katavorioDrag&&b._katavorioDrag.abort()},addToDragSelection:function(b){var P=this.getElement(b);P!=null&&(P._isJsPlumbGroup||P._jsPlumbGroup==null)&&i(this).select(b)},removeFromDragSelection:function(b){i(this).deselect(b)},getDragSelection:function(){return i(this).getSelection()},clearDragSelection:function(){i(this).deselectAll()},trigger:function(b,P,L,N){this.getEventManager().trigger(b,P,L,N)},doReset:function(){for(var b in this)b.indexOf("_katavorio_")===0&&this[b].reset()},getEventManager:function(){return r(this)},on:function(b,P,L){return this.getEventManager().on.apply(this,arguments),this},off:function(b,P,L){return this.getEventManager().off.apply(this,arguments),this}});var M=u(function(b){var P=u(function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?b():setTimeout(P,9)},"_do");P()},"ready");M(t.init)}.call(typeof window<"u"?window:mt)})(nu);var su=Object.defineProperty,sy=u((n,e,t)=>e in n?su(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,"h$4"),ay=u((n,e)=>su(n,"name",{value:e,configurable:!0}),"n$u"),Ti=u((n,e,t)=>(sy(n,typeof e!="symbol"?e+"":e,t),t),"o$v");const au=class{static{u(this,"s")}constructor(e,t){Ti(this,"element"),Ti(this,"options"),Ti(this,"isVisible",!1),Ti(this,"hideTimeoutId",null),this.element=e,this.options=t,this.init()}init(){this.element.style.position="relative",this.element.setAttribute("data-tooltip",this.options.text),this.element.setAttribute("data-tooltip-position",this.options.position),this.element.classList.add("tooltip-trigger"),this.options.tooltipClass&&this.element.classList.add(this.options.tooltipClass),this.options.showWhen==="hover"?(this.element.addEventListener("mouseenter",()=>this.show()),this.element.addEventListener("mouseleave",()=>this.hide())):this.options.showWhen==="click"&&(this.element.addEventListener("click",()=>this.toggle()),document.addEventListener("click",e=>{this.element.contains(e.target)||this.hide()}))}show(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!0,this.element.classList.add("tooltip-active")}hide(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!1,this.element.classList.remove("tooltip-active")}toggle(){this.isVisible?this.hide():this.show()}destroy(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.element.removeAttribute("data-tooltip"),this.element.removeAttribute("data-tooltip-position"),this.element.classList.remove("tooltip-trigger","tooltip-active"),this.options.tooltipClass&&this.element.classList.remove(this.options.tooltipClass)}};ay(au,"TooltipV2");let iu=au;async function iy(n,e){const t=n.getReader();let s;for(;!(s=await t.read()).done;)e(s.value)}u(iy,"getBytes");function oy(n){let e,t,s,a=!1;return u(function(r){e===void 0?(e=r,t=0,s=-1):e=ly(e,r);const i=e.length;let d=0;for(;t<i;){a&&(e[t]===10&&(d=++t),a=!1);let c=-1;for(;t<i&&c===-1;++t)switch(e[t]){case 58:s===-1&&(s=t-d);break;case 13:a=!0;case 10:c=t;break}if(c===-1)break;n(e.subarray(d,c),s),d=t,s=-1}d===i?e=void 0:d!==0&&(e=e.subarray(d),t-=d)},"onChunk")}u(oy,"getLines");function ry(n,e,t){let s=ou();const a=new TextDecoder;return u(function(r,i){if(r.length===0)t?.(s),s=ou();else if(i>0){const d=a.decode(r.subarray(0,i)),c=i+(r[i+1]===32?2:1),l=a.decode(r.subarray(c));switch(d){case"data":s.data=s.data?s.data+`
`+l:l;break;case"event":s.event=l;break;case"id":n(s.id=l);break;case"retry":const m=parseInt(l,10);isNaN(m)||e(s.retry=m);break}}},"onLine")}u(ry,"getMessages");function ly(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}u(ly,"concat$1");function ou(){return{data:"",event:"",id:"",retry:void 0}}u(ou,"newMessage");var cy=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t};const or="text/event-stream",uy=1e3,ru="last-event-id";function lu(n,e){var{signal:t,headers:s,onopen:a,onmessage:o,onclose:r,onerror:i,openWhenHidden:d,fetch:c}=e,l=cy(e,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((m,v)=>{const x=Object.assign({},s);x.accept||(x.accept=or);let C;function w(){C.abort(),document.hidden||_()}u(w,"onVisibilityChange"),d||document.addEventListener("visibilitychange",w);let f=uy,T=0;function k(){document.removeEventListener("visibilitychange",w),window.clearTimeout(T),C.abort()}u(k,"dispose"),t?.addEventListener("abort",()=>{k(),m()});const F=c??window.fetch,O=a??dy;async function _(){var M;C=new AbortController;try{const b=await F(n,Object.assign(Object.assign({},l),{headers:x,signal:C.signal}));await O(b),await iy(b.body,oy(ry(P=>{P?x[ru]=P:delete x[ru]},P=>{f=P},o))),r?.(),k(),m()}catch(b){if(!C.signal.aborted)try{const P=(M=i?.(b))!==null&&M!==void 0?M:f;window.clearTimeout(T),T=window.setTimeout(_,P)}catch(P){k(),v(P)}}}u(_,"create"),_()})}u(lu,"fetchEventSource");function dy(n){const e=n.headers.get("content-type");if(!e?.startsWith(or))throw new Error(`Expected content-type to be ${or}, Actual: ${e}`)}u(dy,"defaultOnOpen");var py=Object.defineProperty,Nn=u((n,e)=>py(n,"name",{value:e,configurable:!0}),"d$p"),Vt=(n=>(n.LOGS="logs",n.SOURCE="source",n.NETWORK="network",n))(Vt||{});const hy=Nn(n=>{if(n==="logs"||n==="source")return"400px";if(n==="network")return"450px"},"getTabHeight"),cu=ue.createContext(null);async function my(n,e,t,s,a){const o=new AbortController;return lu(n,{signal:o.signal,headers:e,async onopen(r){if(!r.ok)throw new Error(`Failed to open monitor connection: ${r.status}`);console.log("Monitor connection opened")},onmessage(r){if(r.event==="init"){const i=r.data;console.log("Monitor initialized:",i),window.currentMonitorId=i,t(i)}else s(r)},onclose(){console.log("Monitor connection closed"),a()},onerror(r){console.error("Monitor connection error:",r)},openWhenHidden:!0}),o}u(my,"re$2"),Nn(my,"setupMonitor");const gy=Nn(({children:n,workspace:e})=>{const[t,s]=ue.useState("logs"),[a,o]=ue.useState(!1),[r,i]=ue.useState({monitorId:null,controller:null}),[d,c]=ue.useState([]),[l,m]=ue.useState(0),[v,x]=ue.useState({}),[C,w]=ue.useState(!0),[f,T]=ue.useState({showWaterfall:!0,filters:{componentNames:[],selectedComponentNames:[]}}),k=ue.useRef(!0),F=ue.useMemo(()=>Object.values(v).sort((N,z)=>N.startTime-z.startTime),[v]);ue.useEffect(()=>{const N=Array.from(new Set(F.map(z=>z.componentName))).sort();T(z=>{if(JSON.stringify(N)!==JSON.stringify(z.filters.componentNames)){const I=[...z.filters.selectedComponentNames];return N.forEach(W=>{z.filters.componentNames.includes(W)||I.push(W)}),{...z,filters:{componentNames:N,selectedComponentNames:I}}}return z})},[F]);const O=ue.useCallback(N=>{N.eventId&&x(z=>{if(N.action==="callStart"){const I={eventId:N.eventId,componentId:N.id,componentName:N.name,componentTitle:N.title,method:"POST",url:`/api/component/${N.name}`,status:0,startTime:N.startTime,requestBody:N.input,state:"pending"};return{...z,[N.eventId]:I}}else if(N.action==="callStop"){const I=z[N.eventId];return I?{...z,[N.eventId]:{...I,endTime:N.endTime,duration:N.duration,status:N.status?N.status:N.output?._error?400:200,responseHeaders:N.output?.headers||{},responseBody:N.output,state:"complete"}}:{...z,[N.eventId]:{eventId:N.eventId,componentId:N.id,componentName:N.name,componentTitle:N.title,method:"POST",url:`/api/component/${N.name}`,status:N.status?N.status:N.output?._error?400:200,startTime:N.startTime-(N.duration||0),endTime:N.endTime,duration:N.duration,requestBody:{},responseBody:N.output,responseHeaders:N.output?.headers||{},state:"complete"}}}else if(N.action==="usage"){const I=z[N.eventId];return I?{...z,[N.eventId]:{...I,cost:N.cost}}:z}return z})},[]);ue.useEffect(()=>{console.log("EFFECT: running"),e&&Nn(()=>{const N=Nn(W=>{if(!k.current)return;O(W.data);let B="";if(W.data.action==="callStart")B=`[Running Component] ${W.data.name}:${W.data.title}`;else if(W.data.action==="callStop"&&W.data.duration)B=`[Completed Component] ${W.data.name}:${W.data.title} (${W.data.duration/1e3}s)`;else if(W.data.action==="log")B=`[Component Log] ${W.data.name}:${W.data.title}`;else if(W.data.action==="usage"){const K=W.data.cost.reduce((q,X)=>q+X.units,0).toFixed(8);B=`[Cost] ${W.data.name||"Component"} - $${K}`}B&&(c(K=>[...K,{type:"component",timestamp:W.timestamp,message:B,data:W.data}]),t!=="logs"?m(K=>K+1):t==="logs"&&l>0&&m(0))},"handleComponentEvent"),z=Nn(W=>{c(B=>[...B,{type:"agent",timestamp:W.timestamp,message:W.data.duration?`[Completed Agent] ${W.data.id}:${W.data.name} (${W.data.duration/1e3}s)`:`[Running Agent] ${W.data.id}:${W.data.name}`,data:W.data}]),t!=="logs"&&m(B=>B+1)},"handleAgentEvent"),I=Nn(W=>{console.error("Monitor error:",W)},"handleMonitorError");return e.monitor.addEventListener("component",N),e.monitor.addEventListener("agent",z),e.monitor.addEventListener("error",I),e.monitor.addEventListener("initialized",({monitorId:W})=>{i({monitorId:W,controller:null})}),e.monitor.addEventListener("closed",()=>{i({monitorId:null,controller:null})}),()=>{e.monitor&&(e.monitor.removeEventListener("component",N),e.monitor.removeEventListener("agent",z),e.monitor.removeEventListener("error",I),e.monitor.removeEventListener("initialized",I),e.monitor.removeEventListener("closed",I))}},"setupMonitorListeners")()},[e,t,l,O,k]),ue.useEffect(()=>(e.addEventListener("AgentLoaded",()=>{console.log("Agent loaded")}),()=>{e.removeEventListener("AgentLoaded",()=>{})}),[e]),ue.useEffect(()=>{k.current=C},[C]),ue.useEffect(()=>{const N=document.getElementById("studio"),z=hy(t);if(N)if(t!==null){const I=N.classList;I.forEach(W=>{W.startsWith("debug-log-menu-opened-")&&I.remove(W)}),N.classList.add(`debug-log-menu-opened-${z}`)}else{const I=N.classList;I.forEach(W=>{W.startsWith("debug-log-menu-opened-")&&I.remove(W)})}},[t]);const _=Nn(()=>{},"toggleExpanded"),M=ue.useCallback(()=>{m(0)},[]),b=ue.useCallback(()=>{x({})},[]),P=ue.useCallback(()=>{w(N=>{const z=!N;return console.log("Network recording toggled from",N,"to",z),k.current=z,z})},[]),L=ue.useCallback(N=>{T(z=>({...z,...N}))},[]);return g.jsx(cu.Provider,{value:{workspace:e,activeTab:t,setActiveTab:s,isExpanded:a,toggleExpanded:_,monitorState:r,logs:d,setLogs:c,unreadLogsCount:l,markLogsAsRead:M,networkRequests:v,networkRequestsArray:F,clearNetworkRequests:b,isNetworkRecording:C,toggleNetworkRecording:P,networkUIState:f,updateNetworkUIState:L},children:n})},"DebugLogMenuProvider"),ws=Nn(()=>{const n=ue.useContext(cu);if(!n)throw new Error("useDebugLogMenuCtx must be used within a DebugLogMenuProvider");return n},"useDebugLogMenuCtx");var fy=Object.defineProperty,Ss=u((n,e)=>fy(n,"name",{value:e,configurable:!0}),"i$A");const rr=Ss(({info:n})=>{const[e,t]=ue.useState(n.length>1e3),[s,a]=ue.useState(!1),o=s?n:n.length>1e3?n.substring(0,1e3):n;return g.jsxs("div",{className:"pl-4 text-xs text-gray-500",style:{overflowWrap:"anywhere",wordBreak:"break-word"},children:[o,e&&!s&&g.jsx("span",{className:"ml-1 text-blue-500 cursor-pointer hover:underline",onClick:Ss(()=>{navigator.clipboard.writeText(n)},"handleCopyFullContent"),title:"Copy full content to clipboard",children:"..."})]})},"DetailedLogInfo"),vy=Ss(()=>{const{logs:n,setLogs:e}=ws(),[t,s]=ue.useState(!1),a=ue.useRef(null),[o,r]=ue.useState(!0),[i,d]=ue.useState(!1),c=Ss(()=>{if(!a.current)return;const m=a.current,v=m.scrollHeight,x=m.clientHeight,C=v-x;m.scrollTo({top:C,behavior:i?"smooth":"auto"})},"scrollToBottom");ue.useEffect(()=>{o&&requestAnimationFrame(()=>{c()})},[n,o]);const l=ue.useCallback(()=>{if(!a.current)return;const{scrollTop:m,scrollHeight:v,clientHeight:x}=a.current,C=v-m-x<100;d(!0),r(C)},[]);return ue.useEffect(()=>{d(!1),r(!0),c()},[]),ue.useEffect(()=>{if(t){const m=setTimeout(()=>s(!1),1e3);return()=>clearTimeout(m)}},[t]),g.jsxs("div",{className:"flex flex-col h-full relative",children:[g.jsx("div",{className:"absolute top-2 right-2 z-[2]",children:g.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-md p-0.5",children:[g.jsx(bn,{content:t?"Copied!":"Copy",className:"text-xs",children:g.jsx("button",{onClick:Ss(()=>{const m=n.map(v=>`${new Date(v.timestamp).toLocaleTimeString()} ${v.message}${v.data.input?`
  Input: ${JSON.stringify(v.data.input)}`:""}${v.data.output?`
  Output: ${JSON.stringify(v.data.output)}`:""}`).join(`
`);navigator.clipboard.writeText(m),s(!0)},"handleCopyLogs"),className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(ci,{size:14})})}),g.jsx(bn,{content:"Download",className:"text-xs",children:g.jsx("button",{onClick:Ss(()=>{const m=n.map(w=>`${new Date(w.timestamp).toISOString()} ${w.message}${w.data.input?`
  Input: ${JSON.stringify(w.data.input,null,2)}`:""}${w.data.output?`
  Output: ${JSON.stringify(w.data.output,null,2)}`:""}`).join(`
`),v=new Blob([m],{type:"text/plain"}),x=URL.createObjectURL(v),C=document.createElement("a");C.href=x,C.download=`agent-logs-${new Date().toISOString()}.txt`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(x)},"handleDownloadLogs"),className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(Lo,{size:15})})}),g.jsx(bn,{content:"Clear",className:"text-xs",children:g.jsx("button",{onClick:Ss(()=>{e([])},"handleClearLogs"),className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(tc,{size:15})})})]})}),g.jsxs("div",{ref:a,onScroll:l,className:"w-full p-4 font-mono text-sm text-gray-700 overflow-auto scroll-smooth",style:{height:"calc(100% - 40px)"},children:[n.map((m,v)=>g.jsxs("div",{className:`mb-1 ${m.type==="agent"?"text-blue-600":"text-gray-600"}`,style:{overflowWrap:"anywhere",wordBreak:"break-word",maxWidth:"100%"},children:[g.jsx("span",{className:"text-gray-400 inline-block",children:new Date(m.timestamp).toLocaleTimeString()})," ",g.jsx("span",{style:{overflowWrap:"anywhere"},children:m.message}),m.data.input&&g.jsx(rr,{info:`Input: ${JSON.stringify(m.data.input)}`}),m.data.output&&g.jsx(rr,{info:`Output: ${JSON.stringify(m.data.output)}`}),m.data?.logs&&m.data.logs?.length>0&&m.data.logs.map(x=>g.jsx(rr,{info:`${x.message}`},`${x.timestamp}-${v}`)),m.data.action==="usage"&&m.data.cost&&g.jsxs("div",{className:"pl-4 text-xs",children:[g.jsx("span",{className:"text-yellow-600",children:"Cost breakdown:"}),m.data.cost.map((x,C)=>g.jsxs("div",{className:"pl-2 text-gray-500",children:["\u2022 ",x.sourceId,": $",x.units.toFixed(8)]},C))]})]},`${m.timestamp}-${v}`)),n.length===0&&g.jsx("div",{className:"text-gray-500",children:"Debug your agent to see logs"})]})]})},"LogsContent");var by=Object.defineProperty,ji=u((n,e)=>by(n,"name",{value:e,configurable:!0}),"o$u");const yy=ji(({x:n,y:e,onClose:t,showWaterfall:s,toggleWaterfall:a,targetRequest:o})=>{const r=ue.useRef(null),{workspace:i}=ws();return ue.useEffect(()=>{const d=ji(c=>{r.current&&!r.current.contains(c.target)&&t()},"handleClickOutside");return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[t]),g.jsxs("div",{ref:r,className:"absolute bg-white shadow-md rounded-md py-1 z-50 w-48 border border-gray-200 animate-fadeIn text-sm",style:{top:e,left:n},"data-context-menu":"true",children:[g.jsxs("div",{className:"px-3 py-1.5 hover:bg-gray-100 cursor-pointer flex items-center justify-between",onClick:ji(()=>{console.log("Menu item clicked, toggling waterfall"),a(),setTimeout(()=>{t()},50)},"handleWaterfallToggle"),children:[g.jsx("span",{children:"Waterfall View"}),s&&g.jsx(nc,{className:"text-blue-500 text-xs"})]}),o&&g.jsx("div",{className:"px-3 py-1.5 hover:bg-gray-100 cursor-pointer flex items-center justify-between border-t border-gray-100",onClick:ji(()=>{if(o){let d=o.componentId;const c=document.querySelector(`.component#${d}`);c&&(i.scrollToComponent(c),i.refreshComponentSelection(c),console.log("Navigated to component:",d)),t()}},"handleNavigateToComponent"),children:g.jsx("span",{className:"flex items-center gap-2",children:g.jsx("span",{children:"Navigate To Component"})})})]})},"ContextMenu");var xy=Object.defineProperty,wy=u((n,e)=>xy(n,"name",{value:e,configurable:!0}),"t$8");const Sy=wy(({activeTab:n,onTabChange:e})=>g.jsx("div",{className:"flex border-b border-solid border-gray-200",children:[{id:"headers",label:"Headers"},{id:"request",label:"Request"},{id:"response",label:"Response"},{id:"timing",label:"Timing"},{id:"cost",label:"Cost"}].map(t=>g.jsx("button",{className:`px-4 py-2 text-xs font-medium transition-colors ${n===t.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,onClick:()=>e(t.id),children:t.label},t.id))}),"DetailTabNav");var Cy=Object.defineProperty,uu=u((n,e)=>Cy(n,"name",{value:e,configurable:!0}),"m$a");const Ay=uu(n=>{const e=n.split(":");if(e.length!==2)return{name:n,description:"Resource"};const t=e[0];let s=e[1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),a="";switch(t){case"llm":a="Large Language Model";break;case"api":a="API Call";break;default:a="Resource"}return{name:s,description:a}},"formatModelName"),Ey=uu(({request:n})=>{if(!n.cost||n.cost.length===0)return g.jsx("div",{className:"flex flex-col p-4",children:g.jsx("div",{className:"text-sm text-gray-500 text-center py-8",children:"No cost information available for this request."})});const e=n.cost.reduce((t,s)=>t+s.units,0);return g.jsxs("div",{className:"flex flex-col p-4",children:[g.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 mb-4 rounded-lg border border-blue-100 shadow-sm",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[g.jsx(To,{className:"text-yellow-500",size:16}),g.jsx("h3",{className:"text-sm font-medium text-blue-700",children:"Usage Summary"})]}),g.jsxs("div",{className:"text-sm text-blue-800",children:["Total Cost: $",g.jsx("span",{className:"font-medium",children:e.toFixed(8)})]})]}),g.jsxs("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[g.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:g.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Cost Breakdown"})}),g.jsxs("table",{className:"w-full",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"bg-gray-50 border-b",children:[g.jsx("th",{className:"text-left p-3 text-xs font-medium text-gray-500",children:"Source"}),g.jsx("th",{className:"text-right p-3 text-xs font-medium text-gray-500",children:"Cost"}),g.jsx("th",{className:"text-right p-3 text-xs font-medium text-gray-500",children:"Percentage"})]})}),g.jsx("tbody",{children:n.cost.map((t,s)=>{const{name:a,description:o}=Ay(t.sourceId),r=t.units/e*100;return g.jsxs("tr",{className:"border-b last:border-b-0 hover:bg-gray-50",children:[g.jsxs("td",{className:"text-left p-3",children:[g.jsx("div",{className:"text-sm text-gray-700 font-medium",children:a}),g.jsx("div",{className:"text-xs text-gray-500",children:o}),g.jsx("div",{className:"text-xs text-gray-400 font-mono mt-1",children:t.sourceId})]}),g.jsx("td",{className:"text-right p-3 text-sm text-gray-700 font-mono",children:t.units.toFixed(8)}),g.jsxs("td",{className:"text-right p-3",children:[g.jsxs("div",{className:"text-sm text-gray-700",children:[r.toFixed(1),"%"]}),g.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-1",children:g.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:`${r}%`}})})]})]},s)})})]})]}),g.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border text-xs text-gray-500 flex items-start gap-2",children:[g.jsx(Bg,{className:"text-blue-400 mt-0.5 flex-shrink-0"}),g.jsx("div",{children:g.jsx("p",{children:"Cost data represents computational resource usage for this request. Cost is typically reported in dollars, depending on the service used."})})]})]})},"CostTab");var ky=Object.defineProperty,_y=u((n,e)=>ky(n,"name",{value:e,configurable:!0}),"d$o");const Py=_y(({request:n})=>{const e=[{name:"Request Method",value:n.method},{name:"Status Code",value:n.status.toString()},{name:"Component",value:n.componentName},{name:"Component Title",value:n.componentTitle}];return g.jsx("div",{className:"p-3 text-xs",children:g.jsxs("div",{className:"mb-4",children:[g.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"General"}),g.jsx("div",{className:"bg-white rounded border border-gray-200",children:e.map((t,s)=>g.jsxs("div",{className:`grid grid-cols-3 px-3 py-1.5 ${s!==e.length-1?"border-b border-gray-100":""}`,children:[g.jsxs("div",{className:"font-medium text-gray-600",children:[t.name,":"]}),g.jsx("div",{className:"col-span-2 text-gray-800",children:t.value})]},t.name))})]})})},"HeadersTab"),lr={scheme:"solarized-light-transparent",author:"Adapted from Solarized Light (Ethan Schoonover) with transparent background",base00:"transparent",base01:"#eee8d5",base02:"#93a1a1",base03:"#839496",base04:"#657b83",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"};var du={exports:{}},pu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},hu={exports:{}},Iy=u(function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},"isArrayish"),Ly=Iy,Ty=Array.prototype.concat,jy=Array.prototype.slice,mu=hu.exports=u(function(e){for(var t=[],s=0,a=e.length;s<a;s++){var o=e[s];Ly(o)?t=Ty.call(t,jy.call(o)):t.push(o)}return t},"swizzle");mu.wrap=function(n){return function(){return n(mu(arguments))}};var Oy=hu.exports,wa=pu,Sa=Oy,gu=Object.hasOwnProperty,fu=Object.create(null);for(var cr in wa)gu.call(wa,cr)&&(fu[wa[cr]]=cr);var an=du.exports={to:{},get:{}};an.get=function(n){var e=n.substring(0,3).toLowerCase(),t,s;switch(e){case"hsl":t=an.get.hsl(n),s="hsl";break;case"hwb":t=an.get.hwb(n),s="hwb";break;default:t=an.get.rgb(n),s="rgb";break}return t?{model:s,value:t}:null},an.get.rgb=function(n){if(!n)return null;var e=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,s=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^(\w+)$/,r=[0,0,0,1],i,d,c;if(i=n.match(t)){for(c=i[2],i=i[1],d=0;d<3;d++){var l=d*2;r[d]=parseInt(i.slice(l,l+2),16)}c&&(r[3]=parseInt(c,16)/255)}else if(i=n.match(e)){for(i=i[1],c=i[3],d=0;d<3;d++)r[d]=parseInt(i[d]+i[d],16);c&&(r[3]=parseInt(c+c,16)/255)}else if(i=n.match(s)){for(d=0;d<3;d++)r[d]=parseInt(i[d+1],0);i[4]&&(i[5]?r[3]=parseFloat(i[4])*.01:r[3]=parseFloat(i[4]))}else if(i=n.match(a)){for(d=0;d<3;d++)r[d]=Math.round(parseFloat(i[d+1])*2.55);i[4]&&(i[5]?r[3]=parseFloat(i[4])*.01:r[3]=parseFloat(i[4]))}else return(i=n.match(o))?i[1]==="transparent"?[0,0,0,0]:gu.call(wa,i[1])?(r=wa[i[1]],r[3]=1,r):null:null;for(d=0;d<3;d++)r[d]=es(r[d],0,255);return r[3]=es(r[3],0,1),r},an.get.hsl=function(n){if(!n)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var s=parseFloat(t[4]),a=(parseFloat(t[1])%360+360)%360,o=es(parseFloat(t[2]),0,100),r=es(parseFloat(t[3]),0,100),i=es(isNaN(s)?1:s,0,1);return[a,o,r,i]}return null},an.get.hwb=function(n){if(!n)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var s=parseFloat(t[4]),a=(parseFloat(t[1])%360+360)%360,o=es(parseFloat(t[2]),0,100),r=es(parseFloat(t[3]),0,100),i=es(isNaN(s)?1:s,0,1);return[a,o,r,i]}return null},an.to.hex=function(){var n=Sa(arguments);return"#"+Oi(n[0])+Oi(n[1])+Oi(n[2])+(n[3]<1?Oi(Math.round(n[3]*255)):"")},an.to.rgb=function(){var n=Sa(arguments);return n.length<4||n[3]===1?"rgb("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+")":"rgba("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+", "+n[3]+")"},an.to.rgb.percent=function(){var n=Sa(arguments),e=Math.round(n[0]/255*100),t=Math.round(n[1]/255*100),s=Math.round(n[2]/255*100);return n.length<4||n[3]===1?"rgb("+e+"%, "+t+"%, "+s+"%)":"rgba("+e+"%, "+t+"%, "+s+"%, "+n[3]+")"},an.to.hsl=function(){var n=Sa(arguments);return n.length<4||n[3]===1?"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)":"hsla("+n[0]+", "+n[1]+"%, "+n[2]+"%, "+n[3]+")"},an.to.hwb=function(){var n=Sa(arguments),e="";return n.length>=4&&n[3]!==1&&(e=", "+n[3]),"hwb("+n[0]+", "+n[1]+"%, "+n[2]+"%"+e+")"},an.to.keyword=function(n){return fu[n.slice(0,3)]};function es(n,e,t){return Math.min(Math.max(e,n),t)}u(es,"clamp");function Oi(n){var e=Math.round(n).toString(16).toUpperCase();return e.length<2?"0"+e:e}u(Oi,"hexDouble");var Dy=du.exports;const Ca=pu,vu={};for(const n of Object.keys(Ca))vu[Ca[n]]=n;const He={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var bu=He;for(const n of Object.keys(He)){if(!("channels"in He[n]))throw new Error("missing channels property: "+n);if(!("labels"in He[n]))throw new Error("missing channel labels property: "+n);if(He[n].labels.length!==He[n].channels)throw new Error("channel and label counts mismatch: "+n);const{channels:e,labels:t}=He[n];delete He[n].channels,delete He[n].labels,Object.defineProperty(He[n],"channels",{value:e}),Object.defineProperty(He[n],"labels",{value:t})}He.rgb.hsl=function(n){const e=n[0]/255,t=n[1]/255,s=n[2]/255,a=Math.min(e,t,s),o=Math.max(e,t,s),r=o-a;let i,d;o===a?i=0:e===o?i=(t-s)/r:t===o?i=2+(s-e)/r:s===o&&(i=4+(e-t)/r),i=Math.min(i*60,360),i<0&&(i+=360);const c=(a+o)/2;return o===a?d=0:c<=.5?d=r/(o+a):d=r/(2-o-a),[i,d*100,c*100]},He.rgb.hsv=function(n){let e,t,s,a,o;const r=n[0]/255,i=n[1]/255,d=n[2]/255,c=Math.max(r,i,d),l=c-Math.min(r,i,d),m=u(function(v){return(c-v)/6/l+1/2},"diffc");return l===0?(a=0,o=0):(o=l/c,e=m(r),t=m(i),s=m(d),r===c?a=s-t:i===c?a=1/3+e-s:d===c&&(a=2/3+t-e),a<0?a+=1:a>1&&(a-=1)),[a*360,o*100,c*100]},He.rgb.hwb=function(n){const e=n[0],t=n[1];let s=n[2];const a=He.rgb.hsl(n)[0],o=1/255*Math.min(e,Math.min(t,s));return s=1-1/255*Math.max(e,Math.max(t,s)),[a,o*100,s*100]},He.rgb.cmyk=function(n){const e=n[0]/255,t=n[1]/255,s=n[2]/255,a=Math.min(1-e,1-t,1-s),o=(1-e-a)/(1-a)||0,r=(1-t-a)/(1-a)||0,i=(1-s-a)/(1-a)||0;return[o*100,r*100,i*100,a*100]};function My(n,e){return(n[0]-e[0])**2+(n[1]-e[1])**2+(n[2]-e[2])**2}u(My,"comparativeDistance"),He.rgb.keyword=function(n){const e=vu[n];if(e)return e;let t=1/0,s;for(const a of Object.keys(Ca)){const o=Ca[a],r=My(n,o);r<t&&(t=r,s=a)}return s},He.keyword.rgb=function(n){return Ca[n]},He.rgb.xyz=function(n){let e=n[0]/255,t=n[1]/255,s=n[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,s=s>.04045?((s+.055)/1.055)**2.4:s/12.92;const a=e*.4124+t*.3576+s*.1805,o=e*.2126+t*.7152+s*.0722,r=e*.0193+t*.1192+s*.9505;return[a*100,o*100,r*100]},He.rgb.lab=function(n){const e=He.rgb.xyz(n);let t=e[0],s=e[1],a=e[2];t/=95.047,s/=100,a/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,s=s>.008856?s**(1/3):7.787*s+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const o=116*s-16,r=500*(t-s),i=200*(s-a);return[o,r,i]},He.hsl.rgb=function(n){const e=n[0]/360,t=n[1]/100,s=n[2]/100;let a,o,r;if(t===0)return r=s*255,[r,r,r];s<.5?a=s*(1+t):a=s+t-s*t;const i=2*s-a,d=[0,0,0];for(let c=0;c<3;c++)o=e+1/3*-(c-1),o<0&&o++,o>1&&o--,6*o<1?r=i+(a-i)*6*o:2*o<1?r=a:3*o<2?r=i+(a-i)*(2/3-o)*6:r=i,d[c]=r*255;return d},He.hsl.hsv=function(n){const e=n[0];let t=n[1]/100,s=n[2]/100,a=t;const o=Math.max(s,.01);s*=2,t*=s<=1?s:2-s,a*=o<=1?o:2-o;const r=(s+t)/2,i=s===0?2*a/(o+a):2*t/(s+t);return[e,i*100,r*100]},He.hsv.rgb=function(n){const e=n[0]/60,t=n[1]/100;let s=n[2]/100;const a=Math.floor(e)%6,o=e-Math.floor(e),r=255*s*(1-t),i=255*s*(1-t*o),d=255*s*(1-t*(1-o));switch(s*=255,a){case 0:return[s,d,r];case 1:return[i,s,r];case 2:return[r,s,d];case 3:return[r,i,s];case 4:return[d,r,s];case 5:return[s,r,i]}},He.hsv.hsl=function(n){const e=n[0],t=n[1]/100,s=n[2]/100,a=Math.max(s,.01);let o,r;r=(2-t)*s;const i=(2-t)*a;return o=t*a,o/=i<=1?i:2-i,o=o||0,r/=2,[e,o*100,r*100]},He.hwb.rgb=function(n){const e=n[0]/360;let t=n[1]/100,s=n[2]/100;const a=t+s;let o;a>1&&(t/=a,s/=a);const r=Math.floor(6*e),i=1-s;o=6*e-r,r&1&&(o=1-o);const d=t+o*(i-t);let c,l,m;switch(r){default:case 6:case 0:c=i,l=d,m=t;break;case 1:c=d,l=i,m=t;break;case 2:c=t,l=i,m=d;break;case 3:c=t,l=d,m=i;break;case 4:c=d,l=t,m=i;break;case 5:c=i,l=t,m=d;break}return[c*255,l*255,m*255]},He.cmyk.rgb=function(n){const e=n[0]/100,t=n[1]/100,s=n[2]/100,a=n[3]/100,o=1-Math.min(1,e*(1-a)+a),r=1-Math.min(1,t*(1-a)+a),i=1-Math.min(1,s*(1-a)+a);return[o*255,r*255,i*255]},He.xyz.rgb=function(n){const e=n[0]/100,t=n[1]/100,s=n[2]/100;let a,o,r;return a=e*3.2406+t*-1.5372+s*-.4986,o=e*-.9689+t*1.8758+s*.0415,r=e*.0557+t*-.204+s*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[a*255,o*255,r*255]},He.xyz.lab=function(n){let e=n[0],t=n[1],s=n[2];e/=95.047,t/=100,s/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,t=t>.008856?t**(1/3):7.787*t+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const a=116*t-16,o=500*(e-t),r=200*(t-s);return[a,o,r]},He.lab.xyz=function(n){const e=n[0],t=n[1],s=n[2];let a,o,r;o=(e+16)/116,a=t/500+o,r=o-s/200;const i=o**3,d=a**3,c=r**3;return o=i>.008856?i:(o-16/116)/7.787,a=d>.008856?d:(a-16/116)/7.787,r=c>.008856?c:(r-16/116)/7.787,a*=95.047,o*=100,r*=108.883,[a,o,r]},He.lab.lch=function(n){const e=n[0],t=n[1],s=n[2];let a;a=Math.atan2(s,t)*360/2/Math.PI,a<0&&(a+=360);const r=Math.sqrt(t*t+s*s);return[e,r,a]},He.lch.lab=function(n){const e=n[0],t=n[1],a=n[2]/360*2*Math.PI,o=t*Math.cos(a),r=t*Math.sin(a);return[e,o,r]},He.rgb.ansi16=function(n,e=null){const[t,s,a]=n;let o=e===null?He.rgb.hsv(n)[2]:e;if(o=Math.round(o/50),o===0)return 30;let r=30+(Math.round(a/255)<<2|Math.round(s/255)<<1|Math.round(t/255));return o===2&&(r+=60),r},He.hsv.ansi16=function(n){return He.rgb.ansi16(He.hsv.rgb(n),n[2])},He.rgb.ansi256=function(n){const e=n[0],t=n[1],s=n[2];return e===t&&t===s?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(s/255*5)},He.ansi16.rgb=function(n){let e=n%10;if(e===0||e===7)return n>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const t=(~~(n>50)+1)*.5,s=(e&1)*t*255,a=(e>>1&1)*t*255,o=(e>>2&1)*t*255;return[s,a,o]},He.ansi256.rgb=function(n){if(n>=232){const o=(n-232)*10+8;return[o,o,o]}n-=16;let e;const t=Math.floor(n/36)/5*255,s=Math.floor((e=n%36)/6)/5*255,a=e%6/5*255;return[t,s,a]},He.rgb.hex=function(n){const t=(((Math.round(n[0])&255)<<16)+((Math.round(n[1])&255)<<8)+(Math.round(n[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t},He.hex.rgb=function(n){const e=n.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let t=e[0];e[0].length===3&&(t=t.split("").map(i=>i+i).join(""));const s=parseInt(t,16),a=s>>16&255,o=s>>8&255,r=s&255;return[a,o,r]},He.rgb.hcg=function(n){const e=n[0]/255,t=n[1]/255,s=n[2]/255,a=Math.max(Math.max(e,t),s),o=Math.min(Math.min(e,t),s),r=a-o;let i,d;return r<1?i=o/(1-r):i=0,r<=0?d=0:a===e?d=(t-s)/r%6:a===t?d=2+(s-e)/r:d=4+(e-t)/r,d/=6,d%=1,[d*360,r*100,i*100]},He.hsl.hcg=function(n){const e=n[1]/100,t=n[2]/100,s=t<.5?2*e*t:2*e*(1-t);let a=0;return s<1&&(a=(t-.5*s)/(1-s)),[n[0],s*100,a*100]},He.hsv.hcg=function(n){const e=n[1]/100,t=n[2]/100,s=e*t;let a=0;return s<1&&(a=(t-s)/(1-s)),[n[0],s*100,a*100]},He.hcg.rgb=function(n){const e=n[0]/360,t=n[1]/100,s=n[2]/100;if(t===0)return[s*255,s*255,s*255];const a=[0,0,0],o=e%1*6,r=o%1,i=1-r;let d=0;switch(Math.floor(o)){case 0:a[0]=1,a[1]=r,a[2]=0;break;case 1:a[0]=i,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=r;break;case 3:a[0]=0,a[1]=i,a[2]=1;break;case 4:a[0]=r,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=i}return d=(1-t)*s,[(t*a[0]+d)*255,(t*a[1]+d)*255,(t*a[2]+d)*255]},He.hcg.hsv=function(n){const e=n[1]/100,t=n[2]/100,s=e+t*(1-e);let a=0;return s>0&&(a=e/s),[n[0],a*100,s*100]},He.hcg.hsl=function(n){const e=n[1]/100,s=n[2]/100*(1-e)+.5*e;let a=0;return s>0&&s<.5?a=e/(2*s):s>=.5&&s<1&&(a=e/(2*(1-s))),[n[0],a*100,s*100]},He.hcg.hwb=function(n){const e=n[1]/100,t=n[2]/100,s=e+t*(1-e);return[n[0],(s-e)*100,(1-s)*100]},He.hwb.hcg=function(n){const e=n[1]/100,s=1-n[2]/100,a=s-e;let o=0;return a<1&&(o=(s-a)/(1-a)),[n[0],a*100,o*100]},He.apple.rgb=function(n){return[n[0]/65535*255,n[1]/65535*255,n[2]/65535*255]},He.rgb.apple=function(n){return[n[0]/255*65535,n[1]/255*65535,n[2]/255*65535]},He.gray.rgb=function(n){return[n[0]/100*255,n[0]/100*255,n[0]/100*255]},He.gray.hsl=function(n){return[0,0,n[0]]},He.gray.hsv=He.gray.hsl,He.gray.hwb=function(n){return[0,100,n[0]]},He.gray.cmyk=function(n){return[0,0,0,n[0]]},He.gray.lab=function(n){return[n[0],0,0]},He.gray.hex=function(n){const e=Math.round(n[0]/100*255)&255,s=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(s.length)+s},He.rgb.gray=function(n){return[(n[0]+n[1]+n[2])/3/255*100]};const Di=bu;function Ny(){const n={},e=Object.keys(Di);for(let t=e.length,s=0;s<t;s++)n[e[s]]={distance:-1,parent:null};return n}u(Ny,"buildGraph");function $y(n){const e=Ny(),t=[n];for(e[n].distance=0;t.length;){const s=t.pop(),a=Object.keys(Di[s]);for(let o=a.length,r=0;r<o;r++){const i=a[r],d=e[i];d.distance===-1&&(d.distance=e[s].distance+1,d.parent=s,t.unshift(i))}}return e}u($y,"deriveBFS");function Fy(n,e){return function(t){return e(n(t))}}u(Fy,"link");function Ry(n,e){const t=[e[n].parent,n];let s=Di[e[n].parent][n],a=e[n].parent;for(;e[a].parent;)t.unshift(e[a].parent),s=Fy(Di[e[a].parent][a],s),a=e[a].parent;return s.conversion=t,s}u(Ry,"wrapConversion");var qy=u(function(n){const e=$y(n),t={},s=Object.keys(e);for(let a=s.length,o=0;o<a;o++){const r=s[o];e[r].parent!==null&&(t[r]=Ry(r,e))}return t},"route$1");const ur=bu,By=qy,Us={},Uy=Object.keys(ur);function zy(n){const e=u(function(...t){const s=t[0];return s==null?s:(s.length>1&&(t=s),n(t))},"wrappedFn");return"conversion"in n&&(e.conversion=n.conversion),e}u(zy,"wrapRaw");function Gy(n){const e=u(function(...t){const s=t[0];if(s==null)return s;s.length>1&&(t=s);const a=n(t);if(typeof a=="object")for(let o=a.length,r=0;r<o;r++)a[r]=Math.round(a[r]);return a},"wrappedFn");return"conversion"in n&&(e.conversion=n.conversion),e}u(Gy,"wrapRounded"),Uy.forEach(n=>{Us[n]={},Object.defineProperty(Us[n],"channels",{value:ur[n].channels}),Object.defineProperty(Us[n],"labels",{value:ur[n].labels});const e=By(n);Object.keys(e).forEach(s=>{const a=e[s];Us[n][s]=Gy(a),Us[n][s].raw=zy(a)})});var Hy=Us;const zs=Dy,on=Hy,yu=["keyword","gray","hex"],dr={};for(const n of Object.keys(on))dr[[...on[n].labels].sort().join("")]=n;const Mi={};function Ot(n,e){if(!(this instanceof Ot))return new Ot(n,e);if(e&&e in yu&&(e=null),e&&!(e in on))throw new Error("Unknown model: "+e);let t,s;if(n==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(n instanceof Ot)this.model=n.model,this.color=[...n.color],this.valpha=n.valpha;else if(typeof n=="string"){const a=zs.get(n);if(a===null)throw new Error("Unable to parse color from string: "+n);this.model=a.model,s=on[this.model].channels,this.color=a.value.slice(0,s),this.valpha=typeof a.value[s]=="number"?a.value[s]:1}else if(n.length>0){this.model=e||"rgb",s=on[this.model].channels;const a=Array.prototype.slice.call(n,0,s);this.color=pr(a,s),this.valpha=typeof n[s]=="number"?n[s]:1}else if(typeof n=="number")this.model="rgb",this.color=[n>>16&255,n>>8&255,n&255],this.valpha=1;else{this.valpha=1;const a=Object.keys(n);"alpha"in n&&(a.splice(a.indexOf("alpha"),1),this.valpha=typeof n.alpha=="number"?n.alpha:0);const o=a.sort().join("");if(!(o in dr))throw new Error("Unable to parse color from object: "+JSON.stringify(n));this.model=dr[o];const{labels:r}=on[this.model],i=[];for(t=0;t<r.length;t++)i.push(n[r[t]]);this.color=pr(i)}if(Mi[this.model])for(s=on[this.model].channels,t=0;t<s;t++){const a=Mi[this.model][t];a&&(this.color[t]=a(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}u(Ot,"Color"),Ot.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(n){let e=this.model in zs.to?this:this.rgb();e=e.round(typeof n=="number"?n:1);const t=e.valpha===1?e.color:[...e.color,this.valpha];return zs.to[e.model](t)},percentString(n){const e=this.rgb().round(typeof n=="number"?n:1),t=e.valpha===1?e.color:[...e.color,this.valpha];return zs.to.rgb.percent(t)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const n={},{channels:e}=on[this.model],{labels:t}=on[this.model];for(let s=0;s<e;s++)n[t[s]]=this.color[s];return this.valpha!==1&&(n.alpha=this.valpha),n},unitArray(){const n=this.rgb().color;return n[0]/=255,n[1]/=255,n[2]/=255,this.valpha!==1&&n.push(this.valpha),n},unitObject(){const n=this.rgb().object();return n.r/=255,n.g/=255,n.b/=255,this.valpha!==1&&(n.alpha=this.valpha),n},round(n){return n=Math.max(n||0,0),new Ot([...this.color.map(Wy(n)),this.valpha],this.model)},alpha(n){return n!==void 0?new Ot([...this.color,Math.max(0,Math.min(1,n))],this.model):this.valpha},red:At("rgb",0,It(255)),green:At("rgb",1,It(255)),blue:At("rgb",2,It(255)),hue:At(["hsl","hsv","hsl","hwb","hcg"],0,n=>(n%360+360)%360),saturationl:At("hsl",1,It(100)),lightness:At("hsl",2,It(100)),saturationv:At("hsv",1,It(100)),value:At("hsv",2,It(100)),chroma:At("hcg",1,It(100)),gray:At("hcg",2,It(100)),white:At("hwb",1,It(100)),wblack:At("hwb",2,It(100)),cyan:At("cmyk",0,It(100)),magenta:At("cmyk",1,It(100)),yellow:At("cmyk",2,It(100)),black:At("cmyk",3,It(100)),x:At("xyz",0,It(95.047)),y:At("xyz",1,It(100)),z:At("xyz",2,It(108.833)),l:At("lab",0,It(100)),a:At("lab",1),b:At("lab",2),keyword(n){return n!==void 0?new Ot(n):on[this.model].keyword(this.color)},hex(n){return n!==void 0?new Ot(n):zs.to.hex(this.rgb().round().color)},hexa(n){if(n!==void 0)return new Ot(n);const e=this.rgb().round().color;let t=Math.round(this.valpha*255).toString(16).toUpperCase();return t.length===1&&(t="0"+t),zs.to.hex(e)+t},rgbNumber(){const n=this.rgb().color;return(n[0]&255)<<16|(n[1]&255)<<8|n[2]&255},luminosity(){const n=this.rgb().color,e=[];for(const[t,s]of n.entries()){const a=s/255;e[t]=a<=.04045?a/12.92:((a+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(n){const e=this.luminosity(),t=n.luminosity();return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)},level(n){const e=this.contrast(n);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){const n=this.rgb().color;return(n[0]*2126+n[1]*7152+n[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const n=this.rgb();for(let e=0;e<3;e++)n.color[e]=255-n.color[e];return n},lighten(n){const e=this.hsl();return e.color[2]+=e.color[2]*n,e},darken(n){const e=this.hsl();return e.color[2]-=e.color[2]*n,e},saturate(n){const e=this.hsl();return e.color[1]+=e.color[1]*n,e},desaturate(n){const e=this.hsl();return e.color[1]-=e.color[1]*n,e},whiten(n){const e=this.hwb();return e.color[1]+=e.color[1]*n,e},blacken(n){const e=this.hwb();return e.color[2]+=e.color[2]*n,e},grayscale(){const n=this.rgb().color,e=n[0]*.3+n[1]*.59+n[2]*.11;return Ot.rgb(e,e,e)},fade(n){return this.alpha(this.valpha-this.valpha*n)},opaquer(n){return this.alpha(this.valpha+this.valpha*n)},rotate(n){const e=this.hsl();let t=e.color[0];return t=(t+n)%360,t=t<0?360+t:t,e.color[0]=t,e},mix(n,e){if(!n||!n.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof n);const t=n.rgb(),s=this.rgb(),a=e===void 0?.5:e,o=2*a-1,r=t.alpha()-s.alpha(),i=((o*r===-1?o:(o+r)/(1+o*r))+1)/2,d=1-i;return Ot.rgb(i*t.red()+d*s.red(),i*t.green()+d*s.green(),i*t.blue()+d*s.blue(),t.alpha()*a+s.alpha()*(1-a))}};for(const n of Object.keys(on)){if(yu.includes(n))continue;const{channels:e}=on[n];Ot.prototype[n]=function(...t){return this.model===n?new Ot(this):t.length>0?new Ot(t,n):new Ot([...Ky(on[this.model][n].raw(this.color)),this.valpha],n)},Ot[n]=function(...t){let s=t[0];return typeof s=="number"&&(s=pr(t,e)),new Ot(s,n)}}function Vy(n,e){return Number(n.toFixed(e))}u(Vy,"roundTo");function Wy(n){return function(e){return Vy(e,n)}}u(Wy,"roundToPlace");function At(n,e,t){n=Array.isArray(n)?n:[n];for(const s of n)(Mi[s]||(Mi[s]=[]))[e]=t;return n=n[0],function(s){let a;return s!==void 0?(t&&(s=t(s)),a=this[n](),a.color[e]=s,a):(a=this[n]().color[e],t&&(a=t(a)),a)}}u(At,"getset");function It(n){return function(e){return Math.max(0,Math.min(n,e))}}u(It,"maxfn");function Ky(n){return Array.isArray(n)?n:[n]}u(Ky,"assertArray");function pr(n,e){for(let t=0;t<e;t++)typeof n[t]!="number"&&(n[t]=0);return n}u(pr,"zeroArray");var Yy=Ot,xu=Io(Yy);function Xy(n){const e=n[0],t=n[1],s=n[2];let a,o,r;return a=e*1+t*0+s*1.13983,o=e*1+t*-.39465+s*-.5806,r=e*1+t*2.02311+s*0,a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[a*255,o*255,r*255]}u(Xy,"yuv2rgb");function Jy(n){const e=n[0]/255,t=n[1]/255,s=n[2]/255,a=e*.299+t*.587+s*.114,o=e*-.14713+t*-.28886+s*.436,r=e*.615+t*-.51499+s*-.10001;return[a,o,r]}u(Jy,"rgb2yuv");var Zy={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},Qy={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},e0={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},t0={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},n0={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},s0={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},a0={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},i0={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},o0={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},r0={scheme:"brewer",author:"timoth\xE9e poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},l0={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},c0={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},u0={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},d0={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},p0={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},h0={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},m0={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},g0={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},f0={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},v0={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},b0={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},y0={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},x0={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},w0={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},S0={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},C0={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},A0={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},E0={scheme:"nicinabox",author:"nicinabox (http://github.com/nicinabox)",base00:"#2A2F3A",base01:"#3C444F",base02:"#4F5A65",base03:"#BEBEBE",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#FFFFFF",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#FC6D24",base0A:"#ddb26f",base0B:"#A1C659",base0C:"#12cfc0",base0D:"#6FB3D2",base0E:"#D381C3",base0F:"#deaf8f"},k0={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},_0={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},P0={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},I0={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},L0={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},T0={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},j0={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},O0={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},D0={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},M0={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"};const wu={threezerotwofour:Zy,apathy:Qy,ashes:e0,atelierDune:t0,atelierForest:n0,atelierHeath:s0,atelierLakeside:a0,atelierSeaside:i0,bespin:o0,brewer:r0,bright:l0,chalk:c0,codeschool:u0,colors:d0,default:p0,eighties:h0,embers:m0,flat:g0,google:f0,grayscale:v0,greenscreen:b0,harmonic:y0,hopscotch:x0,isotope:w0,marrakesh:S0,mocha:C0,monokai:A0,nicinabox:E0,ocean:k0,paraiso:_0,pop:P0,railscasts:I0,shapeshifter:L0,solarized:T0,summerfruit:j0,tomorrow:O0,tube:D0,twilight:M0},Su=wu.default,Cu=Object.keys(Su),N0=u(n=>n<.25?1:n<.5?.9-n:1.1-n,"flip"),$0=u(n=>{const e=xu(n),[t,s,a]=Jy(e.array()),o=[N0(t),s,a],r=Xy(o);return xu.rgb(r).hex()},"invertColor"),Gs=u(n=>e=>({className:[e.className,n.className].filter(Boolean).join(" "),style:{...e.style||{},...n.style||{}}}),"merger"),F0=u((n,e)=>{if(n===void 0)return e;if(e===void 0)return n;const t=typeof n,s=typeof e;switch(t){case"string":switch(s){case"string":return[e,n].filter(Boolean).join(" ");case"object":return Gs({className:n,style:e});case"function":return(a,...o)=>Gs({className:n})(e(a,...o))}break;case"object":switch(s){case"string":return Gs({className:e,style:n});case"object":return{...e,...n};case"function":return(a,...o)=>Gs({style:n})(e(a,...o))}break;case"function":switch(s){case"string":return(a,...o)=>n(Gs(a)({className:e}),...o);case"object":return(a,...o)=>n(Gs(a)({style:e}),...o);case"function":return(a,...o)=>n(e(a,...o),...o)}}},"mergeStyling"),R0=u((n,e)=>{const t=Object.keys(e);for(const s in n)t.indexOf(s)===-1&&t.push(s);return t.reduce((s,a)=>(s[a]=F0(n[a],e[a]),s),{})},"mergeStylings"),q0=u((n,e,...t)=>{if(e===null)return n;Array.isArray(e)||(e=[e]);const a=e.map(o=>n[o]).filter(Boolean).reduce((o,r)=>(typeof r=="string"?o.className=[o.className,r].filter(Boolean).join(" "):typeof r=="object"?o.style={...o.style,...r}:typeof r=="function"&&(o={...o,...r(o,...t)}),o),{className:"",style:{}});return a.className||delete a.className,Object.keys(a.style).length===0&&delete a.style,a},"getStylingByKeys"),hr=u(n=>Object.keys(n).reduce((e,t)=>(e[t]=/^base/.test(t)?$0(n[t]):t==="scheme"?n[t]+":inverted":n[t],e),{}),"invertBase16Theme"),B0=ki((n,e={},t={},...s)=>{const{defaultBase16:a=Su,base16Themes:o=null}=e,r=U0(t,o);r&&(t={...r,...t});const i=Cu.reduce((m,v)=>(m[v]=t[v]||a[v],m),{}),d=Object.keys(t).reduce((m,v)=>(Cu.indexOf(v)===-1&&(m[v]=t[v]),m),{}),c=n(i),l=R0(d,c);return ki(q0,2)(l,...s)},3),Au=u(n=>!!n.extend,"isStylingConfig"),U0=u((n,e)=>{if(n&&Au(n)&&n.extend&&(n=n.extend),typeof n=="string"){const[t,s]=n.split(":");e?n=e[t]:n=wu[t],s==="inverted"&&(n=hr(n))}return n&&Object.prototype.hasOwnProperty.call(n,"base00")?n:void 0},"getBase16Theme"),z0=u(n=>typeof n=="string"?`${n}:inverted`:n&&Au(n)&&n.extend?typeof n.extend=="string"?{...n,extend:`${n.extend}:inverted`}:{...n,extend:hr(n.extend)}:n&&hr(n),"invertTheme");function G0(n){const e=Object.prototype.toString.call(n).slice(8,-1);return e==="Object"&&typeof n[Symbol.iterator]=="function"?"Iterable":e==="Custom"&&n.constructor!==Object&&n instanceof Object?"Object":e}u(G0,"objType");function Eu({styling:n,arrowStyle:e="single",expanded:t,nodeType:s,onClick:a}){return at.createElement("div",{...n("arrowContainer",e),onClick:a},at.createElement("div",{...n(["arrow","arrowSign"],s,t,e)},"\u25B6",e==="double"&&at.createElement("div",{...n(["arrowSign","arrowSignInner"])},"\u25B6")))}u(Eu,"JSONArrow");function H0(n,e){return n==="Object"?Object.keys(e).length:n==="Array"?e.length:1/0}u(H0,"getLength");function V0(n){return typeof n.set=="function"}u(V0,"isIterableMap");function W0(n,e,t,s=0,a=1/0){let o;if(n==="Object"){let r=Object.getOwnPropertyNames(e);t&&r.sort(t===!0?void 0:t),r=r.slice(s,a+1),o={entries:r.map(i=>({key:i,value:e[i]}))}}else if(n==="Array")o={entries:e.slice(s,a+1).map((r,i)=>({key:i+s,value:r}))};else{let r=0;const i=[];let d=!0;const c=V0(e);for(const l of e){if(r>a){d=!1;break}s<=r&&(c&&Array.isArray(l)?typeof l[0]=="string"||typeof l[0]=="number"?i.push({key:l[0],value:l[1]}):i.push({key:`[entry ${r}]`,value:{"[key]":l[0],"[value]":l[1]}}):i.push({key:r,value:l})),r++}o={hasMore:!d,entries:i}}return o}u(W0,"getEntries");function mr(n,e,t){const s=[];for(;e-n>t*t;)t=t*t;for(let a=n;a<=e;a+=t)s.push({from:a,to:Math.min(e,a+t-1)});return s}u(mr,"getRanges");function K0(n,e,t,s,a=0,o=1/0){const r=W0.bind(null,n,e,t);if(!s)return r().entries;const i=o<1/0,d=Math.min(o-a,H0(n,e));if(n!=="Iterable"){if(d<=s||s<7)return r(a,o).entries}else if(d<=s&&!i)return r(a,o).entries;let c;if(n==="Iterable"){const{hasMore:l,entries:m}=r(a,a+s-1);c=l?[...m,...mr(a+s,a+2*s-1,s)]:m}else c=i?mr(a,o,s):[...r(0,s-5).entries,...mr(s-4,d-5,s),...r(d-4,d-1).entries];return c}u(K0,"getCollectionEntries");function Y0(n){const{styling:e,from:t,to:s,renderChildNodes:a,nodeType:o}=n,[r,i]=ue.useState(!1),d=ue.useCallback(()=>{i(!r)},[r]);return r?at.createElement("div",{...e("itemRange",r)},a(n,t,s)):at.createElement("div",{...e("itemRange",r),onClick:d},at.createElement(Eu,{nodeType:o,styling:e,expanded:!1,onClick:d,arrowStyle:"double"}),`${t} ... ${s}`)}u(Y0,"ItemRange");function X0(n){return n.to!==void 0}u(X0,"isRange");function ku(n,e,t){const{nodeType:s,data:a,collectionLimit:o,circularCache:r,keyPath:i,postprocessValue:d,sortObjectKeys:c}=n,l=[];return K0(s,a,c,o,e,t).forEach(m=>{if(X0(m))l.push(at.createElement(Y0,{...n,key:`ItemRange--${m.from}-${m.to}`,from:m.from,to:m.to,renderChildNodes:ku}));else{const{key:v,value:x}=m,C=r.indexOf(x)!==-1;l.push(at.createElement(_u,{...n,postprocessValue:d,collectionLimit:o,key:`Node--${v}`,keyPath:[v,...i],value:d(x),circularCache:[...r,x],isCircular:C,hideRoot:!1}))}}),l}u(ku,"renderChildNodes");function gr(n){const{circularCache:e=[],collectionLimit:t,createItemString:s,data:a,expandable:o,getItemString:r,hideRoot:i,isCircular:d,keyPath:c,labelRenderer:l,level:m=0,nodeType:v,nodeTypeIndicator:x,shouldExpandNodeInitially:C,styling:w}=n,[f,T]=ue.useState(d?!1:C(c,a,m)),k=ue.useCallback(()=>{o&&T(!f)},[o,f]),F=f||i&&m===0?ku({...n,circularCache:e,level:m+1}):null,O=at.createElement("span",{...w("nestedNodeItemType",f)},x),_=r(v,a,O,s(a,t),c),M=[c,v,f,o];return i?at.createElement("li",{...w("rootNode",...M)},at.createElement("ul",{...w("rootNodeChildren",...M)},F)):at.createElement("li",{...w("nestedNode",...M)},o&&at.createElement(Eu,{styling:w,nodeType:v,expanded:f,onClick:k}),at.createElement("label",{...w(["label","nestedNodeLabel"],...M),onClick:k},l(...M)),at.createElement("span",{...w("nestedNodeItemString",...M),onClick:k},_),at.createElement("ul",{...w("nestedNodeChildren",...M)},F))}u(gr,"JSONNestedNode");function J0(n){const e=Object.getOwnPropertyNames(n).length;return`${e} ${e!==1?"keys":"key"}`}u(J0,"createItemString$2");function Z0({data:n,...e}){return at.createElement(gr,{...e,data:n,nodeType:"Object",nodeTypeIndicator:e.nodeType==="Error"?"Error()":"{}",createItemString:J0,expandable:Object.getOwnPropertyNames(n).length>0})}u(Z0,"JSONObjectNode");function Q0(n){return`${n.length} ${n.length!==1?"items":"item"}`}u(Q0,"createItemString$1");function ex({data:n,...e}){return at.createElement(gr,{...e,data:n,nodeType:"Array",nodeTypeIndicator:"[]",createItemString:Q0,expandable:n.length>0})}u(ex,"JSONArrayNode");function tx(n,e){let t=0,s=!1;if(Number.isSafeInteger(n.size))t=n.size;else for(const a of n){if(e&&t+1>e){s=!0;break}t+=1}return`${s?">":""}${t} ${t!==1?"entries":"entry"}`}u(tx,"createItemString");function nx(n){return at.createElement(gr,{...n,nodeType:"Iterable",nodeTypeIndicator:"()",createItemString:tx,expandable:!0})}u(nx,"JSONIterableNode");function $n({nodeType:n,styling:e,labelRenderer:t,keyPath:s,valueRenderer:a,value:o,valueGetter:r=u(i=>i,"valueGetter")}){return at.createElement("li",{...e("value",n,s)},at.createElement("label",{...e(["label","valueLabel"],n,s)},t(s,n,!1,!1)),at.createElement("span",{...e("valueText",n,s)},a(r(o),o,...s)))}u($n,"JSONValueNode");function _u({getItemString:n,keyPath:e,labelRenderer:t,styling:s,value:a,valueRenderer:o,isCustomNode:r,...i}){const d=r(a)?"Custom":G0(a),c={getItemString:n,key:e[0],keyPath:e,labelRenderer:t,nodeType:d,styling:s,value:a,valueRenderer:o},l={...i,...c,data:a,isCustomNode:r};switch(d){case"Object":case"Error":case"WeakMap":case"WeakSet":return at.createElement(Z0,{...l});case"Array":return at.createElement(ex,{...l});case"Iterable":case"Map":case"Set":return at.createElement(nx,{...l});case"String":return at.createElement($n,{...c,valueGetter:m=>`"${m}"`});case"Number":return at.createElement($n,{...c});case"Boolean":return at.createElement($n,{...c,valueGetter:m=>m?"true":"false"});case"Date":return at.createElement($n,{...c,valueGetter:m=>m.toISOString()});case"Null":return at.createElement($n,{...c,valueGetter:()=>"null"});case"Undefined":return at.createElement($n,{...c,valueGetter:()=>"undefined"});case"Function":case"Symbol":return at.createElement($n,{...c,valueGetter:m=>m.toString()});case"Custom":return at.createElement($n,{...c});default:return at.createElement($n,{...c,valueGetter:()=>`<${d}>`})}}u(_u,"JSONNode");var sx={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"};const ax=u(n=>({BACKGROUND_COLOR:n.base00,TEXT_COLOR:n.base07,STRING_COLOR:n.base0B,DATE_COLOR:n.base0B,NUMBER_COLOR:n.base09,BOOLEAN_COLOR:n.base09,NULL_COLOR:n.base08,UNDEFINED_COLOR:n.base08,FUNCTION_COLOR:n.base08,SYMBOL_COLOR:n.base08,LABEL_COLOR:n.base0D,ARROW_COLOR:n.base0D,ITEM_STRING_COLOR:n.base0B,ITEM_STRING_EXPANDED_COLOR:n.base03}),"colorMap"),ix=u(n=>({String:n.STRING_COLOR,Date:n.DATE_COLOR,Number:n.NUMBER_COLOR,Boolean:n.BOOLEAN_COLOR,Null:n.NULL_COLOR,Undefined:n.UNDEFINED_COLOR,Function:n.FUNCTION_COLOR,Symbol:n.SYMBOL_COLOR}),"valueColorMap"),ox=u(n=>{const e=ax(n);return{tree:{border:0,padding:0,marginTop:"0.5em",marginBottom:"0.5em",marginLeft:"0.125em",marginRight:0,listStyle:"none",MozUserSelect:"none",WebkitUserSelect:"none",backgroundColor:e.BACKGROUND_COLOR},value:({style:t},s,a)=>({style:{...t,paddingTop:"0.25em",paddingRight:0,marginLeft:"0.875em",WebkitUserSelect:"text",MozUserSelect:"text",wordWrap:"break-word",paddingLeft:a.length>1?"2.125em":"1.25em",textIndent:"-0.5em",wordBreak:"break-all"}}),label:{display:"inline-block",color:e.LABEL_COLOR},valueLabel:{margin:"0 0.5em 0 0"},valueText:({style:t},s)=>({style:{...t,color:ix(e)[s]}}),itemRange:(t,s)=>({style:{paddingTop:s?0:"0.25em",cursor:"pointer",color:e.LABEL_COLOR}}),arrow:({style:t},s,a)=>({style:{...t,marginLeft:0,transition:"150ms",WebkitTransition:"150ms",MozTransition:"150ms",WebkitTransform:a?"rotateZ(90deg)":"rotateZ(0deg)",MozTransform:a?"rotateZ(90deg)":"rotateZ(0deg)",transform:a?"rotateZ(90deg)":"rotateZ(0deg)",transformOrigin:"45% 50%",WebkitTransformOrigin:"45% 50%",MozTransformOrigin:"45% 50%",position:"relative",lineHeight:"1.1em",fontSize:"0.75em"}}),arrowContainer:({style:t},s)=>({style:{...t,display:"inline-block",paddingRight:"0.5em",paddingLeft:s==="double"?"1em":0,cursor:"pointer"}}),arrowSign:{color:e.ARROW_COLOR},arrowSignInner:{position:"absolute",top:0,left:"-0.4em"},nestedNode:({style:t},s,a,o,r)=>({style:{...t,position:"relative",paddingTop:"0.25em",marginLeft:s.length>1?"0.875em":0,paddingLeft:r?0:"1.125em"}}),rootNode:{padding:0,margin:0},nestedNodeLabel:({style:t},s,a,o,r)=>({style:{...t,margin:0,padding:0,WebkitUserSelect:r?"inherit":"text",MozUserSelect:r?"inherit":"text",cursor:r?"pointer":"default"}}),nestedNodeItemString:({style:t},s,a,o)=>({style:{...t,paddingLeft:"0.5em",cursor:"default",color:o?e.ITEM_STRING_EXPANDED_COLOR:e.ITEM_STRING_COLOR}}),nestedNodeItemType:{marginLeft:"0.3em",marginRight:"0.3em"},nestedNodeChildren:({style:t},s,a)=>({style:{...t,padding:0,margin:0,listStyle:"none",display:a?"block":"none"}}),rootNodeChildren:{padding:0,margin:0,listStyle:"none"}}},"getDefaultThemeStyling"),rx=B0(ox,{defaultBase16:sx}),Pu=u(n=>n,"identity"),lx=u((n,e,t)=>t===0,"expandRootNode"),cx=u((n,e,t,s)=>at.createElement("span",null,t," ",s),"defaultItemString"),ux=u(([n])=>at.createElement("span",null,n,":"),"defaultLabelRenderer"),dx=u(()=>!1,"noCustomNode");function fr({data:n,theme:e,invertTheme:t,keyPath:s=["root"],labelRenderer:a=ux,valueRenderer:o=Pu,shouldExpandNodeInitially:r=lx,hideRoot:i=!1,getItemString:d=cx,postprocessValue:c=Pu,isCustomNode:l=dx,collectionLimit:m=50,sortObjectKeys:v=!1}){const x=ue.useMemo(()=>rx(t?z0(e):e),[e,t]);return at.createElement("ul",{...x("tree")},at.createElement(_u,{keyPath:i?[]:s,value:c(n),isCustomNode:l,styling:x,labelRenderer:a,valueRenderer:o,shouldExpandNodeInitially:r,hideRoot:i,getItemString:d,postprocessValue:c,collectionLimit:m,sortObjectKeys:v}))}u(fr,"JSONTree");var px=Object.defineProperty,hx=u((n,e)=>px(n,"name",{value:e,configurable:!0}),"d$n");const mx=hx(({request:n})=>g.jsxs("div",{className:"p-3 text-xs",children:[g.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Request Body"}),g.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:n.requestBody?g.jsx(fr,{data:n.requestBody,theme:lr,hideRoot:!0,shouldExpandNodeInitially:()=>!0}):g.jsx("div",{className:"text-gray-500",children:"No request body"})}),g.jsx("h3",{className:"font-medium text-gray-700 mt-4 mb-2",children:"Request Headers"}),g.jsx("div",{className:"bg-white p-3 rounded border border-solid border-gray-200",children:Object.keys(n.requestHeaders||{}).length>0?g.jsxs("table",{className:"w-full text-xs",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"border-b border-solid border-gray-200",children:[g.jsx("th",{className:"text-left py-1 font-medium text-gray-600",children:"Name"}),g.jsx("th",{className:"text-left py-1 font-medium text-gray-600",children:"Value"})]})}),g.jsx("tbody",{children:Object.entries(n.requestHeaders||{}).map(([e,t])=>g.jsxs("tr",{className:"border-b border-gray-100",children:[g.jsx("td",{className:"py-1 pr-4 font-medium",children:e}),g.jsx("td",{className:"py-1 text-gray-600",children:t})]},e))})]}):g.jsx("div",{className:"text-gray-500",children:"No request headers"})})]}),"RequestTab");var gx=Object.defineProperty,fx=u((n,e)=>gx(n,"name",{value:e,configurable:!0}),"d$m");const vx=fx(({request:n})=>{const[e,t]=ue.useState("preview");return g.jsxs("div",{className:"p-3 text-xs",children:[g.jsxs("div",{className:"flex justify-between items-center mb-2",children:[g.jsx("h3",{className:"font-medium text-gray-700",children:"Response Body"}),g.jsxs("div",{className:"flex text-xs bg-gray-100 rounded overflow-hidden",children:[g.jsx("button",{className:`px-3 py-1 ${e==="preview"?"bg-white shadow-sm":"hover:bg-gray-200"}`,onClick:()=>t("preview"),children:"Preview"}),g.jsx("button",{className:`px-3 py-1 ${e==="raw"?"bg-white shadow-sm":"hover:bg-gray-200"}`,onClick:()=>t("raw"),children:"Raw"})]})]}),g.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:n.responseBody?e==="preview"?g.jsx(fr,{data:n.responseBody,theme:lr,hideRoot:!0,shouldExpandNodeInitially:()=>!0}):g.jsx("pre",{className:"whitespace-pre-wrap text-gray-800",children:JSON.stringify(n.responseBody)}):g.jsx("div",{className:"text-gray-500",children:"No response body"})}),g.jsx("h3",{className:"font-medium text-gray-700 mt-4 mb-2",children:"Response Headers"}),g.jsx("div",{className:"bg-white p-3 rounded border border-solid border-gray-200",children:Object.keys(n.responseHeaders||{}).length>0?g.jsxs("table",{className:"w-full text-xs",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"border-b border-solid border-gray-200",children:[g.jsx("th",{className:"text-left py-1 font-medium text-gray-600",children:"Name"}),g.jsx("th",{className:"text-left py-1 font-medium text-gray-600",children:"Value"})]})}),g.jsx("tbody",{children:Object.entries(n.responseHeaders||{}).map(([s,a])=>g.jsxs("tr",{className:"border-b border-gray-100",children:[g.jsx("td",{className:"py-1 pr-4 font-medium",children:s}),g.jsx("td",{className:"py-1 text-gray-600",children:a})]},s))})]}):g.jsx("div",{className:"text-gray-500",children:"No response headers"})})]})},"ResponseTab");var bx=Object.defineProperty,vr=u((n,e)=>bx(n,"name",{value:e,configurable:!0}),"t$7");const Ni=vr(n=>n?n<1?"<1ms":n<1e3?`${Math.round(n)}ms`:`${(n/1e3).toFixed(2)}s`:"-","formatDuration"),yx=vr(n=>n?n<1024?`${n}B`:n<1024*1024?`${(n/1024).toFixed(1)}KB`:`${(n/(1024*1024)).toFixed(1)}MB`:"-","formatSize"),Iu=vr(n=>n?new Blob([JSON.stringify(n)]).size:0,"calculateSize");var xx=Object.defineProperty,br=u((n,e)=>xx(n,"name",{value:e,configurable:!0}),"n$s");const wx=br(({request:n})=>{const e=n.duration||0,t=Math.max(e,100),s={queueing:e*.05,processing:e*.95},a=br(i=>`${i/t*100}%`,"getWidth"),o=br(i=>{let d=0;return Object.values(s).slice(0,i).forEach(c=>{d+=c}),a(d)},"getLeft"),r={queueing:"bg-gray-300",stalled:"bg-yellow-300",processing:"bg-blue-300",waiting:"bg-green-300",receiving:"bg-purple-300"};return g.jsx("div",{className:"p-3 text-xs",children:g.jsxs("div",{className:"mb-4",children:[g.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Timing"}),g.jsxs("div",{className:"bg-white rounded border border-gray-200 p-3",children:[g.jsxs("div",{className:"mb-4",children:[g.jsxs("div",{className:"flex justify-between mb-1",children:[g.jsx("span",{className:"font-medium",children:"Total Duration"}),g.jsx("span",{children:Ni(e)})]}),g.jsx("div",{className:"h-6 relative bg-gray-100 rounded overflow-hidden",children:Object.entries(s).map(([i,d],c)=>g.jsx("div",{className:`absolute h-full ${r[i]}`,style:{width:a(d),left:o(c)}},i))}),g.jsx("div",{className:"flex mt-2 text-xs gap-3",children:Object.entries(s).map(([i,d])=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{className:`w-3 h-3 mr-1 rounded-sm ${r[i]}`}),g.jsxs("span",{className:"mr-1",children:[i,":"]}),g.jsx("span",{className:"font-medium",children:Ni(d)})]},i))})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-medium mb-1",children:"Started"}),g.jsx("div",{children:new Date(n.startTime).toLocaleTimeString()})]}),n.endTime&&g.jsxs("div",{children:[g.jsx("div",{className:"font-medium mb-1",children:"Ended"}),g.jsx("div",{children:new Date(n.endTime).toLocaleTimeString()})]})]}),!n.endTime&&g.jsxs("div",{className:"text-yellow-500 text-xs",children:[g.jsx(Ug,{className:"inline-block mr-1"}),"This request did not yet end. It may still be ongoing."]})]})]})})},"TimingTab");var Sx=Object.defineProperty,Cx=u((n,e)=>Sx(n,"name",{value:e,configurable:!0}),"s$y");const Ax=Cx(({request:n,onClose:e})=>{const[t,s]=ue.useState("headers");return g.jsxs("div",{className:"flex flex-col border-l border-gray-200",style:{height:"calc(100% - 40px)"},children:[g.jsxs("div",{className:"flex justify-between items-center px-4 py-[3px] border-b border-solid border-gray-200 bg-gray-50",children:[g.jsxs("div",{className:"flex-1 truncate flex items-center gap-2",children:[g.jsx("h2",{className:"font-medium text-sm truncate",children:n.componentTitle}),g.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["- ",n.componentName]})]}),g.jsx("button",{onClick:e,className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(sc,{size:18})})]}),g.jsx(Sy,{activeTab:t,onTabChange:s}),g.jsxs("div",{className:"overflow-auto pb-10",style:{height:"340px"},children:[t==="headers"&&g.jsx(Py,{request:n}),t==="request"&&g.jsx(mx,{request:n}),t==="response"&&g.jsx(vx,{request:n}),t==="timing"&&g.jsx(wx,{request:n}),t==="cost"&&g.jsx(Ey,{request:n})]})]})},"RequestDetailPanel");var Ex=Object.defineProperty,kx=u((n,e)=>Ex(n,"name",{value:e,configurable:!0}),"r$v");const _x=kx(({status:n})=>{let e="bg-gray-200";return n===0?e="bg-blue-200":n>=200&&n<300?e="bg-green-200":n>=300&&n<400?e="bg-yellow-200":n>=400&&(e="bg-red-200"),g.jsx("div",{className:`w-2 h-2 rounded-full ${e}`})},"StatusIndicator");var Px=Object.defineProperty,Ix=u((n,e)=>Px(n,"name",{value:e,configurable:!0}),"r$u");const Lx=Ix(({requests:n,selectedRequest:e,onSelectRequest:t,isDetailOpen:s})=>n.length===0?g.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No network requests recorded"}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"grid grid-cols-12 text-xs font-medium text-gray-500 bg-gray-50 border-b border-solid border-gray-200 px-4 py-2 z-10",children:[g.jsx("div",{className:s?"col-span-12":"col-span-4",children:"Component"}),!s&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"col-span-2",children:"Status"}),g.jsx("div",{className:"col-span-2",children:"Type"}),g.jsx("div",{className:"col-span-2",children:"Size"}),g.jsx("div",{className:"col-span-2",children:"Time"})]})]}),g.jsx("div",{className:"overflow-auto",style:{height:"calc(100% - 100px)"},children:n.map(a=>{const o=e===a.eventId,r=Iu(a.requestBody),i=Iu(a.responseBody),d=r+i,c=a.cost&&a.cost.length>0;return g.jsxs("div",{className:`grid grid-cols-12 text-xs border-b border-gray-100 px-4 py-2 cursor-pointer hover:bg-gray-50 transition-colors ${o?"bg-blue-50":""}`,onClick:()=>t(a.eventId),"data-request-id":a.eventId,children:[g.jsxs("div",{className:s?"col-span-12 flex items-center":"col-span-4 flex items-center gap-2",children:[g.jsx(_x,{status:a.status}),g.jsxs("div",{className:"truncate ml-2 flex-1",children:[g.jsxs("div",{className:"font-medium flex items-center gap-1",children:[a.componentTitle,c&&g.jsx("span",{title:"Has cost information",className:"inline-flex text-yellow-500",children:g.jsx(To,{size:10})})]}),g.jsx("div",{className:"text-gray-500 text-xs truncate",children:a.componentName})]})]}),!s&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"col-span-2 flex items-center",children:a.state==="pending"?g.jsx("span",{className:"text-blue-500",children:"Pending"}):a.status>=200&&a.status<300?g.jsx("span",{className:"text-green-600",children:a.status}):g.jsx("span",{className:"text-red-500",children:a.status||"Error"})}),g.jsx("div",{className:"col-span-2 flex items-center text-gray-600",children:"Component"}),g.jsx("div",{className:"col-span-2 flex items-center text-gray-600",children:yx(d)}),g.jsxs("div",{className:"col-span-2 flex items-center gap-1 text-gray-600",children:[g.jsx(zg,{size:14,className:"text-gray-400"}),Ni(a.duration),c&&g.jsx("span",{title:"Has cost information",className:"ml-1 text-yellow-500",children:g.jsx(To,{size:12})})]})]})]},a.eventId)})})]}),"RequestList");var Tx=Object.defineProperty,Aa=u((n,e)=>Tx(n,"name",{value:e,configurable:!0}),"l$e");const jx=Aa(({isOpen:n,onClose:e,filters:t,updateFilters:s})=>{const[a,o]=ue.useState(t.selectedComponentNames);if(!n)return null;const r=Aa(c=>{o(c?[...t.componentNames]:[])},"handleToggleAll"),i=Aa(c=>{o(l=>l.includes(c)?l.filter(m=>m!==c):[...l,c])},"handleToggleItem"),d=Aa(()=>{s(a),e()},"handleApply");return g.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-white shadow-lg rounded-md border border-solid border-gray-200 z-50 w-80 animate-fadeIn",children:[g.jsxs("div",{className:"p-2 border-b border-solid border-gray-200 flex justify-between items-center",children:[g.jsx("span",{className:"font-medium text-sm",children:"Filter by Component"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{className:"text-xs text-blue-500 hover:underline",onClick:()=>r(!0),children:"Select All"}),g.jsx("button",{className:"text-xs text-blue-500 hover:underline",onClick:()=>r(!1),children:"Clear All"})]})]}),g.jsx("div",{className:"max-h-60 overflow-y-auto p-2",children:t.componentNames.length===0?g.jsx("div",{className:"text-sm text-gray-500 p-2",children:"No components found"}):t.componentNames.map(c=>g.jsxs("div",{className:"flex items-center py-1",children:[g.jsx("input",{type:"checkbox",id:`filter-${c}`,checked:a.includes(c),onChange:()=>i(c),className:"mr-2"}),g.jsx("label",{htmlFor:`filter-${c}`,className:"text-sm truncate cursor-pointer",children:c})]},c))}),g.jsx("div",{className:"p-2 border-t border-gray-200 flex justify-end",children:g.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600",onClick:d,children:"Apply"})})]})},"FilterDropdown"),Ox=Aa(({searchTerm:n,setSearchTerm:e,onCopy:t,onDownload:s,onClear:a,isRecording:o,toggleRecording:r,filters:i,updateFilters:d})=>{const[c,l]=ue.useState(!1),m=i.componentNames.length-i.selectedComponentNames.length;return g.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-solid border-gray-200",children:[g.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[g.jsxs("div",{className:"relative flex-1 max-w-md",children:[g.jsx(Gg,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),g.jsx("input",{type:"text",placeholder:"Filter requests...",className:"pl-8 pr-4 py-1 w-full text-sm border border-solid border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",value:n,onChange:v=>e(v.target.value)})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{className:`p-1 ${m>0?"text-blue-500":"text-gray-500"} hover:text-gray-700 hover:bg-gray-100 rounded flex items-center`,onClick:()=>l(!c),title:"Filter components",children:[g.jsx(Hg,{size:18}),m>0&&g.jsx("span",{className:"ml-1 text-xs bg-blue-500 text-white rounded-full w-4 h-4 flex items-center justify-center",children:m})]}),g.jsx(jx,{isOpen:c,onClose:()=>l(!1),filters:i,updateFilters:d})]}),g.jsx("button",{className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded",title:o?"Stop recording":"Start recording",onClick:r,children:g.jsx(Vg,{size:18,color:o?"red":"gray"})})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:t,title:"Copy",className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(ci,{size:14})}),g.jsx("button",{onClick:s,title:"Download",className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(Lo,{size:15})}),g.jsx("button",{onClick:a,title:"Clear",className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:g.jsx(tc,{size:15})})]})]})},"Toolbar");var Dx=Object.defineProperty,_n=u((n,e)=>Dx(n,"name",{value:e,configurable:!0}),"d$l");const Mx=_n(({requests:n,onSelectRequest:e,selectedRequest:t,onRangeChange:s})=>{const a=ue.useRef(null),o=ue.useRef(null),r=100,i=.1,d=.6,c=500,l=ue.useMemo(()=>{if(n.length===0){const j=Date.now();return{min:j-6e4,max:j}}const Q=n.map(j=>j.startTime),V=n.map(j=>j.endTime||j.startTime+(j.duration||0)),J=Math.min(...Q),A=Math.max(...V);return{min:J,max:A+(A-J)*.05}},[n]),[m,v]=ue.useState([l.min,l.max]),[x,C]=ue.useState(null),[w,f]=ue.useState(0),[T,k]=ue.useState([0,0]),[F,O]=ue.useState(!1);ue.useEffect(()=>{v([l.min,l.max])},[l]),ue.useEffect(()=>{s(m)},[m,s]),ue.useEffect(()=>{if(x){const Q=_n(J=>{if(!a.current||!x)return;const A=a.current.getBoundingClientRect().width,j=(J.clientX-w)/A*d,S=(l.max-l.min)*j;let U=[...m];if(x==="left")U[0]=Math.max(l.min,Math.min(T[0]+S,T[1]-c));else if(x==="right")U[1]=Math.min(l.max,Math.max(T[1]+S,T[0]+c));else if(x==="middle"||x==="waterfall"){const G=T[1]-T[0],Y=x==="waterfall"?-1:1;let se=T[0]+S*Y,le=T[1]+S*Y;se<l.min&&(se=l.min,le=se+G),le>l.max&&(le=l.max,se=le-G),U=[se,le]}v(U)},"handleMouseMove"),V=_n(()=>{C(null)},"handleMouseUp");return document.addEventListener("mousemove",Q),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",V)}}},[x,w,T,m,l]);const _=m[1]-m[0],M=_n((Q,V,J)=>{const A=m[1]-m[0],j=A*Q;if(V){if(A<=c)return;let S=m[0],U=m[1];if(J!==void 0&&o.current){const G=o.current.getBoundingClientRect(),Y=(J-G.left)/G.width;if(S=m[0]+j*Y,U=m[1]-j*(1-Y),U-S<c){const se=S+(U-S)/2;S=se-c/2,U=se+c/2}}else S=m[0]+j/2,U=m[1]-j/2;v([S,U]),O(!0)}else{let S=m[0],U=m[1];if(J!==void 0&&o.current){const G=o.current.getBoundingClientRect(),Y=(J-G.left)/G.width;S=m[0]-j*Y,U=m[1]+j*(1-Y)}else S=m[0]-j/2,U=m[1]+j/2;S<l.min&&(S=l.min),U>l.max&&(U=l.max),v([S,U]),O(!0)}setTimeout(()=>O(!1),300)},"zoomByFactor"),b=_n(Q=>{Q.preventDefault();const V=(l.max-l.min)/(m[1]-m[0]),J=Math.min(i,i/(V/5)),A=Q.deltaY<0;M(J,A,Q.clientX)},"handleWheel"),P=_n(()=>{v([l.min,l.max]),O(!0),setTimeout(()=>O(!1),300)},"handleResetZoom"),L=_n(Q=>{Q.button!==0||Q.target.closest(".request-bar")||(Q.preventDefault(),C("waterfall"),f(Q.clientX),k([...m]))},"handleWaterfallMouseDown"),N=_n(Q=>{const V=Q.startTime,J=Q.endTime||V+(Q.duration||100);if(J<m[0]||V>m[1])return{display:"none"};const A=Math.max(0,(V-m[0])/_*100),j=Math.min(100,(m[1]-J)/_*100),S=100-A-j;return{left:`${A}%`,width:`${S}%`}},"calculateBarStyles"),z=_n(Q=>{const V=new Date(Q),J=V.getHours().toString().padStart(2,"0"),A=V.getMinutes().toString().padStart(2,"0"),j=V.getSeconds().toString().padStart(2,"0");return`${J}:${A}:${j}`},"formatTimestamp"),I=ue.useMemo(()=>{const Q=[];for(let V=0;V<=5;V++){const J=m[0]+(m[1]-m[0])*V/5;Q.push({time:J,position:`${V/5*100}%`,label:z(J)})}return Q},[m]),W=ue.useMemo(()=>{const Q={},V=[];return[...n].sort((J,A)=>J.startTime-A.startTime).forEach(J=>{const A=J.startTime,j=J.endTime||A+(J.duration||100);if(j<m[0]||A>m[1])return;let S=0;for(;V[S]&&V[S]>A;)S++;Q[J.eventId]=S,V[S]=j}),{rows:Q,rowCount:Math.max(1,Object.keys(Q).length>0?Math.max(...Object.values(Q))+1:1)}},[n,m]),B=ue.useMemo(()=>{const Q=Math.max(5,W.rowCount);return Math.max(3,Math.min(18,Math.floor((r-10)/Q)))},[W.rowCount]),K=_n(Q=>{let V=0;for(let J=0;J<Q.length;J++)V=Q.charCodeAt(J)+((V<<5)-V);return`hsl(${Math.abs(V%360)}, 70%, 80%)`},"getComponentColor"),q=ue.useMemo(()=>{const Q={};return[...new Set(n.map(V=>V.componentName))].forEach(V=>{Q[V]=K(V)}),Q},[n]),X=ue.useMemo(()=>{const Q=l.max-l.min,V=m[1]-m[0];return Math.round(Q/V*100)},[l,m]);return g.jsxs("div",{className:"border-b border-solid border-gray-200",ref:a,children:[g.jsxs("div",{className:"text-xs text-gray-500 flex justify-between px-4 pt-1",children:[g.jsx("div",{children:z(m[0])}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("div",{className:"flex items-center",children:g.jsx(Wg,{className:`w-3 h-3 mr-1 ${X>100?"text-blue-600":"text-gray-500"} ${F?"text-blue-800":""}`})}),g.jsx("button",{className:`px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded text-xs ml-2 ${X>100?"visible":"invisible"}`,onClick:P,title:"Reset zoom",children:"Reset"})]}),g.jsx("div",{children:z(m[1])})]}),g.jsxs("div",{className:"px-4 pb-2 pt-1 relative mt-4",children:[g.jsx("div",{className:"absolute inset-0 flex",children:I.map((Q,V)=>g.jsx("div",{className:"h-full flex flex-col bg-gray-100 w-[0.5px]",style:{left:Q.position},children:g.jsx("div",{className:"text-xs text-gray-400 absolute -top-5 transform -translate-x-1/2",children:V===0||V===I.length-1?"":Q.label})},V))}),g.jsx("div",{className:`relative transition-all duration-150 ${F?"bg-blue-50 bg-opacity-20":""}`,ref:o,onMouseDown:L,onWheel:b,style:{cursor:x==="waterfall"?"grabbing":"grab"},children:g.jsx("div",{className:"relative",style:{height:`${r}px`},children:n.map(Q=>{const V=t===Q.eventId,J=N(Q);if(J.display==="none")return null;const A=5+(W.rows[Q.eventId]||0)*(B+2),j=q[Q.componentName];let S="";Q.state==="pending"?S="border-blue-500":Q.status>=200&&Q.status<300?S="border-green-500":Q.status>=300&&Q.status<400?S="border-yellow-500":Q.status>=400&&(S="border-red-500");const U=`${Q.componentName} (${Q.componentTitle})
Status: ${Q.status}
Duration: ${Ni(Q.duration)}
URL: ${Q.url}`;return g.jsx("div",{className:`absolute flex items-center rounded cursor-pointer transition-all request-bar ${V?"ring-2 ring-blue-500":"hover:ring-1 hover:ring-blue-300"} border ${S}`,style:{...J,height:`${B}px`,top:`${A}px`,zIndex:2,backgroundColor:j},onClick:()=>e(Q.eventId),title:U},Q.eventId)})})})]})]})},"WaterfallView");var Nx=Object.defineProperty,Cs=u((n,e)=>Nx(n,"name",{value:e,configurable:!0}),"a$v");const $x=Cs(()=>{const{networkRequestsArray:n,clearNetworkRequests:e,isNetworkRecording:t,toggleNetworkRecording:s,networkUIState:a,updateNetworkUIState:o,workspace:r}=ws(),[i,d]=ue.useState(""),[c,l]=ue.useState(null),[m,v]=ue.useState([0,0]),[x,C]=ue.useState(null),w=ue.useRef(null),f=ue.useMemo(()=>{const N=n.filter(z=>{const I=z.startTime,W=z.endTime||I+(z.duration||0);return I<=m[1]&&W>=m[0]}).filter(z=>a.filters.selectedComponentNames.includes(z.componentName));return i?N.filter(z=>z.componentName.toLowerCase().includes(i.toLowerCase())||z.componentTitle.toLowerCase().includes(i.toLowerCase())||z.url.toLowerCase().includes(i.toLowerCase())):N},[n,i,m,a.filters.selectedComponentNames]),T=ue.useMemo(()=>c&&n.find(N=>N.eventId===c)||null,[c,n]),k=Cs(()=>{const N=JSON.stringify(f,null,2);navigator.clipboard.writeText(N)},"handleCopyRequests"),F=Cs(()=>{const N=JSON.stringify(f,null,2),z=new Blob([N],{type:"application/json"}),I=URL.createObjectURL(z),W=document.createElement("a");W.href=I,W.download=`network-requests-${new Date().toISOString()}.json`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(I)},"handleDownloadRequests"),O=Cs(N=>{l(c===N?null:N)},"handleSelectRequest"),_=Cs(N=>{v(N)},"handleRangeChange"),M=ue.useCallback(()=>{console.log("Toggling waterfall from",a.showWaterfall,"to",!a.showWaterfall),o({showWaterfall:!a.showWaterfall})},[a.showWaterfall,o]),b=Cs(N=>{const z=N.target.closest("[data-request-id]");if(z){const I=z.getAttribute("data-request-id");if(I)return n.find(W=>W.eventId===I)}},"findTargetRequest"),P=ue.useCallback(N=>{N.preventDefault(),N.stopPropagation();const z=w.current?.getBoundingClientRect();if(!z)return;const I=N.clientX-z.left,W=N.clientY-z.top,B=z.width-160,K=z.height-80,q=Math.min(I,B),X=Math.min(W,K),Q=b(N);console.log("Right click detected at:",q,X,"Target request:",Q?.componentName),C({x:q,y:X,targetRequest:Q})},[n]),L=ue.useCallback(()=>{console.log("Closing context menu"),C(null)},[]);return ue.useEffect(()=>{const N=Cs(z=>{const I=document.querySelector('[data-context-menu="true"]');x&&I&&!I.contains(z.target)&&L()},"handleClick");if(x)return document.addEventListener("click",N),()=>{document.removeEventListener("click",N)}},[x,L]),g.jsxs("div",{className:"flex flex-col h-full relative",ref:w,onContextMenu:P,title:"Right-click for options",children:[g.jsx(Ox,{searchTerm:i,setSearchTerm:d,onCopy:k,onDownload:F,onClear:e,isRecording:t,toggleRecording:s,filters:a.filters,updateFilters:N=>{o({filters:{...a.filters,selectedComponentNames:N}})}}),!t&&g.jsx("div",{className:"bg-red-50 text-red-600 text-xs px-4 py-1 border-b border-red-200",children:"Network recording is paused. Click the record button to resume capturing network activity."}),g.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden cursor-context-menu ${a.showWaterfall?"max-h-[150px] opacity-100":"max-h-0 opacity-0"}`,"data-waterfall-visible":a.showWaterfall?"true":"false",children:n.length>0&&g.jsx(Mx,{requests:n,selectedRequest:c,onSelectRequest:O,onRangeChange:_})}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsx("div",{className:`${T?"w-1/4":"w-full"} transition-all duration-300 `,children:g.jsx(Lx,{requests:f,selectedRequest:c,onSelectRequest:O,isDetailOpen:!!T})}),T&&g.jsx("div",{className:"w-3/4 overflow-hidden animate-fadeIn",children:g.jsx(Ax,{request:T,onClose:()=>l(null)})})]}),x&&g.jsx(yy,{x:x.x,y:x.y,onClose:L,showWaterfall:a.showWaterfall,toggleWaterfall:M,targetRequest:x.targetRequest})]})},"NetworkContent");var Fx=Object.defineProperty,Lu=u((n,e)=>Fx(n,"name",{value:e,configurable:!0}),"r$t");const Rx=Lu(()=>{const{workspace:n}=ws(),[e,t]=ue.useState(!1);ue.useEffect(()=>{if(e){const o=setTimeout(()=>{t(!1)},1e3);return()=>clearTimeout(o)}},[e]);const s=n?.agent?.data||{},a=JSON.stringify(s,null,2);return g.jsxs("div",{className:"relative h-full overflow-hidden text-sm",children:[g.jsx("div",{className:"absolute top-2 right-2 z-[2]",children:g.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-md p-0.5",children:[g.jsx(bn,{content:e?"Copied!":"Copy",placement:"top",className:"text-xs",children:g.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a),t(!0)},className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors z-[2]",children:g.jsx(ci,{size:14})})}),g.jsx(bn,{content:"Download JSON",placement:"top",className:"text-xs",children:g.jsx("button",{onClick:Lu(()=>{const o=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=`agent-source-${new Date().toISOString()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},"handleDownload"),className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors z-[2]",children:g.jsx(Lo,{size:15})})})]})}),g.jsx("div",{className:"overflow-auto pl-4",style:{height:"calc(100% - 40px)"},children:g.jsx(fr,{hideRoot:!0,data:s,theme:lr})})]})},"SourceContent");var qx=Object.defineProperty,Bx=u((n,e)=>qx(n,"name",{value:e,configurable:!0}),"n$r");const Ux=Bx(()=>{const{activeTab:n}=ws();return g.jsxs("div",{className:"transition-all duration-300 ease-in-out overflow-hidden bg-white h-full",children:[n===Vt.LOGS&&g.jsx(vy,{}),n===Vt.SOURCE&&g.jsx(Rx,{}),n===Vt.NETWORK&&g.jsx($x,{})]})},"TabContent");var zx=Object.defineProperty,Tu=u((n,e)=>zx(n,"name",{value:e,configurable:!0}),"o$r");const Gx=Tu(()=>{const{workspace:n}=ws(),[e,t]=ue.useState(()=>{const a=n?.serverData?.status?.toLowerCase();return a==="online"?"online":a===void 0?"discovering":"offline"});ue.useEffect(()=>{let a;const o=Tu(()=>{const r=n?.serverData?.status?.toLowerCase(),i=r==="online"?"online":r===void 0?"discovering":"offline";t(i),a=setTimeout(o,i==="online"?2e4:3e3)},"checkStatus");return o(),()=>{a&&clearTimeout(a)}},[n]);const s={online:{color:"green",text:"Online"},discovering:{color:"yellow",text:"Discovering"},offline:{color:"red",text:"Offline"}};return g.jsxs("div",{className:"items-center gap-1 hidden md:flex",children:[g.jsx(Kg,{className:`text-${s[e].color}-500`,size:8}),g.jsxs("span",{className:"text-sm text-gray-600 select-none",children:["Server Status: ",s[e].text]})]})},"ServerStatus");var Hx=Object.defineProperty,Ea=u((n,e)=>Hx(n,"name",{value:e,configurable:!0}),"o$q");const Vx=Ea(({count:n,isActive:e})=>n===0||e?null:g.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 rounded-full animate-pulse duration-1000","data-testid":"unread-badge"}),"UnreadBadge"),Wx=Ea(()=>{const{activeTab:n,setActiveTab:e,isExpanded:t,toggleExpanded:s,unreadLogsCount:a,markLogsAsRead:o}=ws(),r=Ea(c=>`px-4 py-2 text-sm font-medium cursor-pointer transition-all duration-200 relative select-none ${n===c?"bg-white text-gray-900 rounded-t-lg border-t border-x border-gray-200 shadow-[0_-1px_2px_rgba(0,0,0,0.05)]":"text-gray-600 hover:text-gray-900"}`,"getTabClasses"),i=Ea(c=>{e(c),t||s(),c===Vt.LOGS&&o()},"handleTabClick"),d=Ea(()=>{const c=document.getElementById("bottom-bar");c&&c.classList.toggle("hidden")},"toggleBottomBar");return g.jsxs("nav",{className:"flex justify-between items-center bg-gray-100 rounded-t-lg","data-testid":"tab-navigation",children:[g.jsxs("div",{className:"flex gap-1 px-2 pt-1",children:[g.jsx("div",{className:"relative",children:g.jsxs("div",{className:r(Vt.LOGS),onClick:()=>i(Vt.LOGS),role:"tab","aria-selected":n===Vt.LOGS,tabIndex:0,"data-testid":"logs-tab",children:["Logs",g.jsx(Vx,{count:a,isActive:n===Vt.LOGS})]})}),g.jsx("div",{className:r(Vt.NETWORK),onClick:()=>i(Vt.NETWORK),role:"tab","aria-selected":n===Vt.NETWORK,tabIndex:0,"data-testid":"network-tab",children:"Network"}),g.jsx("div",{className:r(Vt.SOURCE),onClick:()=>i(Vt.SOURCE),role:"tab","aria-selected":n===Vt.SOURCE,tabIndex:0,"data-testid":"source-tab",children:"Source"})]}),g.jsxs("div",{className:"flex items-center gap-2 px-4",children:[g.jsx(Gx,{}),g.jsx("button",{type:"button",className:"p-0.5 rounded-full",onClick:d,"data-testid":"close-button","aria-label":"Close debug menu",children:g.jsx("svg",{className:"w-6 h-6 text-[#757575]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]})},"TabNavigation");var Kx=Object.defineProperty,Yx=u((n,e)=>Kx(n,"name",{value:e,configurable:!0}),"e$c");const Xx=Yx(({workspace:n})=>g.jsx(gy,{workspace:n,children:g.jsxs("div",{className:"relative h-full",children:[g.jsx(Wx,{}),g.jsx(Ux,{})]})}),"DebugLogMenu");var yr="rovingFocusGroup.onEntryFocus",Jx={bubbles:!1,cancelable:!0},ka="RovingFocusGroup",[xr,ju,Zx]=Yg(ka),[Qx,Ou]=ac(ka,[Zx]),[e1,t1]=Qx(ka),Du=ue.forwardRef((n,e)=>g.jsx(xr.Provider,{scope:n.__scopeRovingFocusGroup,children:g.jsx(xr.Slot,{scope:n.__scopeRovingFocusGroup,children:g.jsx(n1,{...n,ref:e})})}));Du.displayName=ka;var n1=ue.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:s,loop:a=!1,dir:o,currentTabStopId:r,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:d,onEntryFocus:c,preventScrollOnEntryFocus:l=!1,...m}=n,v=ue.useRef(null),x=Xg(e,v),C=ic(o),[w,f]=oc({prop:r,defaultProp:i??null,onChange:d,caller:ka}),[T,k]=ue.useState(!1),F=Jg(c),O=ju(t),_=ue.useRef(!1),[M,b]=ue.useState(0);return ue.useEffect(()=>{const P=v.current;if(P)return P.addEventListener(yr,F),()=>P.removeEventListener(yr,F)},[F]),g.jsx(e1,{scope:t,orientation:s,dir:C,loop:a,currentTabStopId:w,onItemFocus:ue.useCallback(P=>f(P),[f]),onItemShiftTab:ue.useCallback(()=>k(!0),[]),onFocusableItemAdd:ue.useCallback(()=>b(P=>P+1),[]),onFocusableItemRemove:ue.useCallback(()=>b(P=>P-1),[]),children:g.jsx(Os.div,{tabIndex:T||M===0?-1:0,"data-orientation":s,...m,ref:x,style:{outline:"none",...n.style},onMouseDown:jn(n.onMouseDown,()=>{_.current=!0}),onFocus:jn(n.onFocus,P=>{const L=!_.current;if(P.target===P.currentTarget&&L&&!T){const N=new CustomEvent(yr,Jx);if(P.currentTarget.dispatchEvent(N),!N.defaultPrevented){const z=O().filter(q=>q.focusable),I=z.find(q=>q.active),W=z.find(q=>q.id===w),K=[I,W,...z].filter(Boolean).map(q=>q.ref.current);$u(K,l)}}_.current=!1}),onBlur:jn(n.onBlur,()=>k(!1))})})}),Mu="RovingFocusGroupItem",Nu=ue.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:s=!0,active:a=!1,tabStopId:o,children:r,...i}=n,d=rc(),c=o||d,l=t1(Mu,t),m=l.currentTabStopId===c,v=ju(t),{onFocusableItemAdd:x,onFocusableItemRemove:C,currentTabStopId:w}=l;return ue.useEffect(()=>{if(s)return x(),()=>C()},[s,x,C]),g.jsx(xr.ItemSlot,{scope:t,id:c,focusable:s,active:a,children:g.jsx(Os.span,{tabIndex:m?0:-1,"data-orientation":l.orientation,...i,ref:e,onMouseDown:jn(n.onMouseDown,f=>{s?l.onItemFocus(c):f.preventDefault()}),onFocus:jn(n.onFocus,()=>l.onItemFocus(c)),onKeyDown:jn(n.onKeyDown,f=>{if(f.key==="Tab"&&f.shiftKey){l.onItemShiftTab();return}if(f.target!==f.currentTarget)return;const T=i1(f,l.orientation,l.dir);if(T!==void 0){if(f.metaKey||f.ctrlKey||f.altKey||f.shiftKey)return;f.preventDefault();let F=v().filter(O=>O.focusable).map(O=>O.ref.current);if(T==="last")F.reverse();else if(T==="prev"||T==="next"){T==="prev"&&F.reverse();const O=F.indexOf(f.currentTarget);F=l.loop?o1(F,O+1):F.slice(O+1)}setTimeout(()=>$u(F))}}),children:typeof r=="function"?r({isCurrentTabStop:m,hasTabStop:w!=null}):r})})});Nu.displayName=Mu;var s1={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function a1(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}u(a1,"getDirectionAwareKey");function i1(n,e,t){const s=a1(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return s1[s]}u(i1,"getFocusIntent");function $u(n,e=!1){const t=document.activeElement;for(const s of n)if(s===t||(s.focus({preventScroll:e}),document.activeElement!==t))return}u($u,"focusFirst");function o1(n,e){return n.map((t,s)=>n[(e+s)%n.length])}u(o1,"wrapArray");var r1=Du,l1=Nu,$i="Tabs",[c1,Nk]=ac($i,[Ou]),Fu=Ou(),[u1,wr]=c1($i),Ru=ue.forwardRef((n,e)=>{const{__scopeTabs:t,value:s,onValueChange:a,defaultValue:o,orientation:r="horizontal",dir:i,activationMode:d="automatic",...c}=n,l=ic(i),[m,v]=oc({prop:s,onChange:a,defaultProp:o??"",caller:$i});return g.jsx(u1,{scope:t,baseId:rc(),value:m,onValueChange:v,orientation:r,dir:l,activationMode:d,children:g.jsx(Os.div,{dir:l,"data-orientation":r,...c,ref:e})})});Ru.displayName=$i;var qu="TabsList",Bu=ue.forwardRef((n,e)=>{const{__scopeTabs:t,loop:s=!0,...a}=n,o=wr(qu,t),r=Fu(t);return g.jsx(r1,{asChild:!0,...r,orientation:o.orientation,dir:o.dir,loop:s,children:g.jsx(Os.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:e})})});Bu.displayName=qu;var Uu="TabsTrigger",zu=ue.forwardRef((n,e)=>{const{__scopeTabs:t,value:s,disabled:a=!1,...o}=n,r=wr(Uu,t),i=Fu(t),d=Vu(r.baseId,s),c=Wu(r.baseId,s),l=s===r.value;return g.jsx(l1,{asChild:!0,...i,focusable:!a,active:l,children:g.jsx(Os.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":c,"data-state":l?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...o,ref:e,onMouseDown:jn(n.onMouseDown,m=>{!a&&m.button===0&&m.ctrlKey===!1?r.onValueChange(s):m.preventDefault()}),onKeyDown:jn(n.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&r.onValueChange(s)}),onFocus:jn(n.onFocus,()=>{const m=r.activationMode!=="manual";!l&&!a&&m&&r.onValueChange(s)})})})});zu.displayName=Uu;var Gu="TabsContent",Hu=ue.forwardRef((n,e)=>{const{__scopeTabs:t,value:s,forceMount:a,children:o,...r}=n,i=wr(Gu,t),d=Vu(i.baseId,s),c=Wu(i.baseId,s),l=s===i.value,m=ue.useRef(l);return ue.useEffect(()=>{const v=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(v)},[]),g.jsx(Zg,{present:a||l,children:({present:v})=>g.jsx(Os.div,{"data-state":l?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":d,hidden:!v,id:c,tabIndex:0,...r,ref:e,style:{...n.style,animationDuration:m.current?"0s":void 0},children:v&&o})})});Hu.displayName=Gu;function Vu(n,e){return`${n}-trigger-${e}`}u(Vu,"makeTriggerId");function Wu(n,e){return`${n}-content-${e}`}u(Wu,"makeContentId");var d1=Ru,Ku=Bu,Yu=zu,Xu=Hu;const Sr=d1,Fi=ue.forwardRef(({className:n,...e},t)=>g.jsx(Ku,{ref:t,className:jo("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",n),...e}));Fi.displayName=Ku.displayName;const ts=ue.forwardRef(({className:n,...e},t)=>g.jsx(Yu,{ref:t,className:jo("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",n),...e}));ts.displayName=Yu.displayName;const Fn=ue.forwardRef(({className:n,...e},t)=>g.jsx(Xu,{ref:t,className:jo("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...e}));Fn.displayName=Xu.displayName;var p1=Object.defineProperty,Ri=u((n,e)=>p1(n,"name",{value:e,configurable:!0}),"l$c");const Ju=ue.createContext(void 0);window.__SHARED_APP_STATE__||(window.__SHARED_APP_STATE__={isDeployModalOpen:!1,isShareAgentModalOpen:!1});const Cr="APP_STATE_CHANGED",Ar=Ri(({children:n})=>{const[e,t]=ue.useState(window.__SHARED_APP_STATE__.isDeployModalOpen),[s,a]=ue.useState(window.__SHARED_APP_STATE__.isShareAgentModalOpen),o=Ri((i,d,c)=>{window.__SHARED_APP_STATE__[i]=d,c(d),window.dispatchEvent(new CustomEvent(Cr))},"updateState");ue.useEffect(()=>{const i=Ri(()=>{const{isDeployModalOpen:d,isShareAgentModalOpen:c}=window.__SHARED_APP_STATE__;d!==e&&t(d),c!==s&&a(c)},"syncState");return window.addEventListener(Cr,i),()=>window.removeEventListener(Cr,i)},[e,s]),ue.useEffect(()=>{window.handleDeployModalOpen=i=>{o("isDeployModalOpen",i,t)},window.handleShareAgentModalOpen=i=>{o("isShareAgentModalOpen",i,a)}},[]);const r={isDeployModalOpen:e,setIsDeployModalOpen:i=>o("isDeployModalOpen",i,t),toggleDeployModal:()=>o("isDeployModalOpen",!e,t),isShareAgentModalOpen:s,setIsShareAgentModalOpen:i=>o("isShareAgentModalOpen",i,a),toggleShareAgentModal:()=>o("isShareAgentModalOpen",!s,a)};return g.jsx(Ju.Provider,{value:r,children:n})},"AppStateProvider"),Er=Ri(()=>{const n=ue.useContext(Ju);if(n===void 0)throw new Error("useAppState must be used within a AppStateProvider");return n},"useAppState");var h1=Object.defineProperty,m1=u((n,e)=>h1(n,"name",{value:e,configurable:!0}),"o$p");const Hs=m1(({title:n,onBack:e,onClose:t,className:s=""})=>g.jsxs("div",{className:`relative mb-4 ${s}`,children:[g.jsx("div",{className:"mt-[-7px] pl-8 pr-8",children:g.jsx("span",{className:"block text-lg font-semibold leading-tight text-[#222] text-left",children:n})}),g.jsx("button",{className:"absolute -left-2 -top-2 p-[6px] text-[#222] hover:bg-gray-100 rounded",onClick:e,"aria-label":"Back",style:{lineHeight:0},children:g.jsx(Qg,{width:16,height:14})}),g.jsx("button",{className:"absolute -right-2 -top-2 p-[6px] text-[#222] hover:bg-gray-100 rounded",onClick:t,"aria-label":"Close",children:g.jsx(ef,{width:12,height:12})})]}),"ModalHeaderEmbodiment");var g1=Object.defineProperty,Zu=u((n,e)=>g1(n,"name",{value:e,configurable:!0}),"s$x");const f1=Zu(({onClose:n})=>{const{dev:e,prod:t,scheme:s}=Nt.getState().agentDomains,a=e&&s?`${s}://${e}/alexa`:"",o=t&&s?`${s}://${t}/alexa`:"",r=Zu(i=>{navigator.clipboard.writeText(i)},"handleCopy");return g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[480px]",children:[g.jsx(Hs,{title:"Alexa Integration",onBack:n,onClose:n}),g.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Publish your agent as an Alexa Skill. You can publish your skill to the Alexa Skill Store or use it in your own Alexa devices."}),a&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"Alexa Dev URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:a,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Alexa Dev URL"}),g.jsx("button",{type:"button","aria-label":"Copy Alexa Dev URL",onClick:()=>r(a),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]}),o&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"Alexa Prod URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:o,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Alexa Prod URL"}),g.jsx("button",{type:"button","aria-label":"Copy Alexa Prod URL",onClick:()=>r(o),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]})]})})},"AlexaEmbodimentModal");var v1=Object.defineProperty,kr=u((n,e)=>v1(n,"name",{value:e,configurable:!0}),"n$q");const b1=kr(({onClose:n})=>{const[e,t]=ue.useState(!0),s=ue.useRef(null),{dev:a,prod:o,scheme:r}=Nt.getState().agentDomains,i=a&&r?`${r}://${a}/swagger`:"",d=o&&r?`${r}://${o}/swagger`:"",c=kr(l=>{navigator.clipboard.writeText(l)},"handleCopy");return ue.useEffect(()=>{const l=s.current;if(!l||!i)return;const m=kr(async()=>{t(!1),await tf(200),ya.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["swagger"])},"handleLoad");return l.addEventListener("load",m),()=>{l.removeEventListener("load",m)}},[i]),g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[800px]",children:[g.jsx(Hs,{title:"API Endpoints",onBack:n,onClose:n}),g.jsx("div",{children:g.jsx("p",{className:"text-sm text-gray-700",children:"Enable Agent to communicate with each other using a set of definitions and protocols."})}),i&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"Dev API"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:i,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Dev API URL"}),g.jsx("button",{type:"button","aria-label":"Copy Dev API URL",onClick:()=>c(i),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]}),d&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"Prod API"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:d,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Prod API URL"}),g.jsx("button",{type:"button","aria-label":"Copy Prod API URL",onClick:()=>c(d),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]}),g.jsxs("div",{className:"relative",style:{minHeight:"500px"},children:[e&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white z-10",children:g.jsxs("div",{role:"status",children:[g.jsxs("svg",{className:"w-8 h-8 animate-spin",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#0366d6",strokeWidth:"4",fill:"none"}),g.jsx("path",{fill:"none",stroke:"white",strokeWidth:"4",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),g.jsx("span",{className:"sr-only",children:"Loading..."})]})}),i&&g.jsx("iframe",{ref:s,src:i,className:"w-full border-0",style:{height:"500px",display:e?"none":"block"},title:"API Endpoints - Swagger UI"}),!i&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("span",{className:"text-base text-gray-700",children:"Agent domain is not set. Cannot provide API features."})})]})]})})},"ApiEmbodimentModal");var y1=Object.defineProperty,_r=u((n,e)=>y1(n,"name",{value:e,configurable:!0}),"n$p");const x1=_r(({onClose:n,domain:e="your-domain.com",embodimentData:t,isLoading:s=!1})=>{const[a,o]=ue.useState(!1),r=ue.useRef(null);if(typeof n!="function")throw new Error("ChatbotEmbodimentModal: onClose prop must be a function");const i=_r(v=>/^https?:\/\//i.test(v)?v:`https://${v}`,"getFullDomain"),d=t?.properties?.isFullScreen,c=t?.properties?.allowFileAttachments,l=!!d,m=`${l?`
  <div id="smythos-chatbot-container"></div>
  <!-- Chatbot Container: You can place it anywhere you want and style it as needed -->
  `:""}
    <script src="${i(e)}/static/embodiment/chatBot/chatbot-v2.js"><\/script>
    <script>
        ChatBot.init({
            domain: '${e}',
            isChatOnly: ${l},
            ${l?'containerId: "smythos-chatbot-container",':""}
            allowAttachments: ${c||!1},
            // ... additional settings ...
            introMessage: '${t?.properties?.introMessage||"Hello, how can I assist you today?"}',
            // ... colors settings go here ...
        });
    <\/script>`;return g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[520px]",children:[g.jsx(Hs,{title:"Chatbot Integration Snippet",onBack:n,onClose:n}),g.jsx("div",{className:"flex flex-col gap-4",children:s?g.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-4",children:[g.jsx(On,{size:"lg"}),g.jsx("p",{className:"text-sm text-gray-600",children:"Loading chatbot configuration..."})]}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-700",children:g.jsx("p",{children:l?"Place this snippet inside a container DOM element, and the chatbot will occupy the full available space within it.":g.jsxs(g.Fragment,{children:["Copy and paste this snippet into your website before the closing"," ","</body> tag."]})})}),g.jsxs("div",{className:"flex flex-col gap-4",children:[g.jsx("textarea",{ref:r,readOnly:!0,className:"w-full h-64 p-3 text-sm text-gray-800 bg-white rounded-lg border border-gray-200 font-mono resize-none focus:outline-none focus:border-b-2 focus:border-b-blue-500 transition-colors",value:m}),g.jsx("div",{className:"flex justify-end",children:g.jsx(Et,{variant:"primary",handleClick:_r(async()=>{try{r.current&&(r.current.select(),await navigator.clipboard.writeText(m),o(!0),setTimeout(()=>o(!1),2e3))}catch(v){console.error("Failed to copy code snippet:",v)}},"handleCopyClick"),label:a?"Copied":"Copy Code",className:"text-sm","aria-label":a?"Copied":"Copy code"})})]})]})})]})})},"ChatbotEmbodimentModal");var w1=Object.defineProperty,Qu=u((n,e)=>w1(n,"name",{value:e,configurable:!0}),"n$o");const S1=Qu(({onClose:n})=>{const{dev:e,prod:t,scheme:s}=Nt.getState().agentDomains,a=e&&s?`${s}://${e}/api-docs/openapi-llm.json`:"",o=t&&s?`${s}://${t}/api-docs/openapi-llm.json`:"",r=Qu(i=>{navigator.clipboard.writeText(i)},"handleCopy");return g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[480px]",children:[g.jsx(Hs,{title:gt.chatgpt.title,onBack:n,onClose:n}),g.jsxs("ol",{className:"list-decimal pl-5 space-y-2 text-sm text-gray-700",children:[g.jsxs("li",{children:["Click"," ",g.jsx("a",{href:"https://chat.openai.com/gpts/editor",target:"_blank",rel:"noopener noreferrer",className:"text-v2-blue font-semibold underline",children:"Here"})," ","to Create a custom GPT from chatGPT interface."]}),g.jsx("li",{children:'Click on "Configure" tab'}),g.jsx("li",{children:'Enter your Custom GPT information: We recommend to copy the content of SmythOS Agent behavior inside "Instructions" area in order to have a consistent behavior'}),g.jsx("li",{children:'Scroll down and Click on "Create new action" button.'}),g.jsx("li",{children:"Click Import URL and enter the following URL:"})]}),a&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"GPT Dev URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:a,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Dev OpenAPI URL"}),g.jsx("button",{type:"button","aria-label":"Copy Dev OpenAPI URL",onClick:()=>r(a),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]}),o&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"GPT Prod URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:o,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"Prod OpenAPI URL"}),g.jsx("button",{type:"button","aria-label":"Copy Prod OpenAPI URL",onClick:()=>r(o),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]})]})})},"GptEmbodimentModal");var C1=Object.defineProperty,xn=u((n,e)=>C1(n,"name",{value:e,configurable:!0}),"r$q");function ed(n,e,t,s){const a=`${e}@${s}`;return{nodejs:{language:"javascript",code:`import OpenAI from 'openai';

const openai = new OpenAI({
  apiKey: ${t?`'${t}'`:"process.env.SMYTHOS_AGENTLLM_KEY"},
  baseURL: '${n}/_openai/v1',
});

const response = await openai.chat.completions.create({
  model: '${a}',
  messages: [{ role: 'user', content: 'Hello, what can you do?' }],
  stream: false,
});

console.log(response?.choices);`},python:{language:"python",code:`from openai import OpenAI
client = OpenAI(
  api_key=${t?`'${t}'`:'os.getenv("SMYTHOS_AGENTLLM_KEY")'},
  base_url='${n}/_openai/v1'
)

response = client.chat.completions.create(
  model='${a}',
  messages=[{"role": "user", "content": "Hello, what can you do?"}],
)

print(response.choices)`},curl:{language:"bash",code:`curl ${n}/_openai/v1/chat/completions   -H 'Content-Type: application/json'   -H 'Authorization: Bearer ${t||"$SMYTHOS_AGENTLLM_KEY"}'   -d '{
  "model": "${a}",
  "messages": [{
    "role": "user",
    "content": "Hello, what can you do?"
  }]
}'`},json:{language:"json",code:`{
  "model": "${a}",
  "messages": [{
    "role": "user",
    "content": "Hello, what can you do?"
  }]
}`}}}u(ed,"me"),xn(ed,"generateCodeSamples");const A1=xn(async n=>{const e=await(await fetch(`/api/page/builder/${n}/keys/agent-llm`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();return e&&e.data?Object.entries(e.data).map(([t,s])=>({id:t,name:s.name,key:s.key,createdAt:s.metadata?.created_time?new Date(s.metadata.created_time).toLocaleString("en-US",{month:"long",year:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}):"Unknown date"})):[]},"fetchAgentKeys"),td="#707070",E1="#222",nd="#707070",k1="#C50F1F",_1=xn(({agent:n,defaultTab:e="code",onClose:t})=>{const[s,a]=ue.useState(e),[o,r]=ue.useState("nodejs"),[i,d]=ue.useState("dev"),[c,l]=ue.useState(""),[m,v]=ue.useState("idle"),[x,C]=ue.useState("");ue.useState("");const[w,f]=ue.useState(!1),[T,k]=ue.useState(""),F=ue.useRef(null),O="https://llm.emb-stg.smyth.ai",_=n.id,M=lc(),{data:b=[],isLoading:P,refetch:L}=Yn(["agent-llm-keys",_],()=>A1(_),{enabled:s==="keys"||s==="code",staleTime:5*60*1e3,cacheTime:10*60*1e3}),N=Ds({mutationFn:async J=>{f(!0);const A=await fetch(`/api/page/builder/${_}/keys/agent-llm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:J.trim()})});if(!A.ok)throw new Error("Failed to create API key");return A.json()},onSuccess:()=>{M.invalidateQueries(["agent-llm-keys",_]),C(""),a("keys")},onError:J=>{console.error("Error creating API key:",J)},onSettled:()=>f(!1)}),z=Ds({mutationFn:async J=>{k(J);const A=await fetch(`/api/page/builder/${_}/keys/agent-llm/${J}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!A.ok)throw new Error("Failed to revoke API key");return A.json()},onSuccess:()=>{M.invalidateQueries(["agent-llm-keys",_])},onError:J=>{console.error("Error revoking API key:",J)},onSettled:()=>k("")}),I=xn(async()=>{x.trim()&&N.mutate(x.trim())},"handleCreateKey"),W=xn(async J=>{z.mutate(J)},"handleRevokeKey"),B=xn(async()=>{F.current&&(await navigator.clipboard.writeText(F.current.value),v("copied"),setTimeout(()=>v("idle"),3e3))},"handleCopyCode"),K=xn(()=>{a("create-key"),C("")},"handleOpenCreateKey"),q=xn(()=>{a("keys")},"handleOpenKeysTab");xn(()=>{a("code")},"handleOpenCodeTab");const X=ed(O,_,c,i)[o],Q="h-10 bg-white border border-b-2 border-b-[#E5E7EB] focus:border-b-2 focus:border-b-blue-600 focus:outline-none focus:shadow-none text-base px-0 rounded shadow-none text-sm px-2",V=xn(J=>{a(J)},"handleTabChange");return g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[480px]",children:[g.jsx(Hs,{title:xn(()=>s==="create-key"?g.jsx("span",{className:"block text-2xl font-semibold leading-tight text-[#222] text-left",children:"Create a new key"}):g.jsxs("span",{className:"block text-lg font-semibold leading-tight text-[#222] text-left",children:["Integrating Agent as an",g.jsx("br",{}),"OpenAI-Compatible LLM"]}),"getModalTitle")(),onBack:s==="create-key"?q:t,onClose:t}),s==="keys"&&g.jsx("div",{className:"mb-2",children:g.jsx("span",{className:"text-sm text-[#222]",children:"Use these keys to authenticate your API requests"})}),g.jsxs(Sr,{value:s,onValueChange:J=>V(J),className:"w-full",children:[s!=="create-key"&&g.jsxs(Fi,{className:"grid w-full grid-cols-2 mb-6",children:[g.jsx(ts,{value:"code",className:"text-sm rounded-sm",children:"Code"}),g.jsx(ts,{value:"keys",className:"text-sm rounded-sm",children:"Keys"})]}),g.jsxs(Fn,{value:"code",className:"space-y-4",children:[g.jsxs("div",{className:"flex flex-col gap-2",children:[g.jsx("span",{className:"text-base font-medium text-[#222]",children:"Add API key below to your environment or CI pipeline."}),g.jsx("div",{className:"w-full",children:g.jsxs(ui,{value:c===""?"__none__":c,onValueChange:J=>l(J==="__none__"?"":J),children:[g.jsx(di,{className:Q,"aria-label":"API Key",children:g.jsx(pi,{placeholder:"None"})}),g.jsxs(hi,{onClick:J=>J.stopPropagation(),children:[g.jsx(An,{value:"__none__",children:"None"}),b.map(J=>g.jsx(An,{value:J.key,children:J.name},J.id))]})]})}),b.length===0&&g.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[g.jsx(nf,{className:"text-smyth-red w-4 h-4"}),g.jsxs("span",{children:["No API keys detected."," ",g.jsx("span",{className:"underline cursor-pointer text-blue-600",onClick:()=>a("create-key"),children:"Create an API key here."})]})]})]}),g.jsx("div",{className:"text-xs text-[#888]",children:g.jsx("div",{className:"mt-[-12px]",children:"In your application code, initialize your agent with the OpenAI chat completions code snippet below:"})}),g.jsxs("div",{className:"flex gap-2 mb-2",children:[g.jsxs("div",{className:"flex flex-col flex-1",children:[g.jsx("label",{htmlFor:"code-language-select",className:"text-md font-medium text-gray-700 mb-1",children:"Code"}),g.jsxs(ui,{value:o,onValueChange:J=>r(J),children:[g.jsx(di,{id:"code-language-select",className:Q,"aria-label":"Code Language",children:g.jsx(pi,{})}),g.jsxs(hi,{onClick:J=>J.stopPropagation(),children:[g.jsx(An,{value:"nodejs",children:"Node.js"}),g.jsx(An,{value:"python",children:"Python"}),g.jsx(An,{value:"curl",children:"cURL"}),g.jsx(An,{value:"json",children:"JSON"})]})]})]}),g.jsxs("div",{className:"flex flex-col flex-1",children:[g.jsx("label",{htmlFor:"version-select",className:"text-md font-medium text-gray-700 mb-1",children:"Version"}),g.jsxs(ui,{value:i,onValueChange:d,children:[g.jsx(di,{id:"version-select",className:Q,"aria-label":"Version",children:g.jsx(pi,{})}),g.jsxs(hi,{onClick:J=>J.stopPropagation(),children:[g.jsx(An,{value:"dev",children:"Development"}),g.jsx(An,{value:"prod",children:"Production"})]})]})]})]}),g.jsx(cc,{ref:F,value:X.code,readOnly:!0,className:"w-full min-h-[250px] max-h-[400px] p-2 font-mono text-xs resize-none overflow-auto",fullWidth:!0,"aria-label":"Code Sample"}),g.jsx("div",{className:"text-xs text-[#888] mt-1",children:"Bonus: Customize the model version and language."}),g.jsx("div",{className:"flex justify-end",children:g.jsx(Et,{label:m==="copied"?"Copied":"Copy Code",variant:"primary",className:"px-4 py-1 text-xs",handleClick:B,"aria-label":"Copy Code",type:"button"})})]}),s==="keys"&&g.jsx(Fn,{value:"keys",className:"space-y-4",children:g.jsx("div",{className:"space-y-2",children:P?g.jsx("div",{className:"text-center text-gray-400",children:"Loading keys..."}):b.length===0?g.jsxs("div",{className:"flex flex-col items-start w-full",children:[g.jsx("div",{className:"w-full bg-gray-50 rounded-lg px-3 py-8 text-center text-gray-400 font-extralight",children:"No API keys found."}),g.jsx("div",{className:"flex justify-end w-full mt-4",children:g.jsx(Et,{label:"Create a new key",variant:"primary",className:"px-6 py-2 text-sm",handleClick:K,"aria-label":"Create a new key",type:"button"})})]}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-base font-normal text-gray-900",children:"Keys"}),b.map(J=>g.jsxs("div",{className:"flex flex-col bg-gray-50 rounded-xl px-4 py-3 border border-gray-200",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsx("span",{className:"text-sm font-bold text-gray-900 uppercase tracking-wide",children:J.name}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("button",{className:"p-1 rounded group hover:bg-gray-200",onClick:async()=>{await navigator.clipboard.writeText(J.key)},"aria-label":"Copy API Key",title:"Copy",type:"button",children:g.jsx(sf,{className:"w-6 h-6",color:td,style:{transition:"color 0.2s"},onMouseEnter:A=>A.currentTarget.style.color=E1,onMouseLeave:A=>A.currentTarget.style.color=td})}),g.jsx("button",{className:"p-1 rounded group hover:bg-gray-200",onClick:()=>W(J.id),disabled:T===J.id,"aria-label":"Delete Key",title:"Delete",type:"button",children:T===J.id?g.jsx(On,{size:"sm",classes:"w-6 h-6"}):g.jsx(af,{className:"w-6 h-6",color:nd,style:{transition:"color 0.2s"},onMouseEnter:A=>A.currentTarget.style.color=k1,onMouseLeave:A=>A.currentTarget.style.color=nd})})]})]}),g.jsx("div",{className:"font-mono text-xs text-gray-900 break-all w-full",children:J.key}),g.jsx("div",{className:"text-xs text-gray-500 mt-1",children:J.createdAt})]},J.id)),g.jsx("div",{className:"flex justify-end mt-4",children:g.jsx(Et,{label:"Create a new key",variant:"primary",className:"px-6 py-2 text-sm",handleClick:K,"aria-label":"Create a new key",type:"button"})})]})})}),s==="create-key"&&g.jsxs(Fn,{value:"create-key",className:"space-y-2",children:[g.jsx("div",{className:"mb-3 -mt-4",children:g.jsx("span",{className:"text-md font-normal",children:"Keys"})}),g.jsx("div",{className:"mb-4",children:g.jsx(nn,{label:"Key Name",placeholder:"API key",value:x,onChange:J=>C(J.target.value),"aria-label":"Key Name",disabled:w,fullWidth:!0})}),g.jsx("div",{className:"flex justify-end",children:g.jsx(Et,{label:w?"Adding...":"Add Key",variant:"primary",className:"px-6 py-2 text-base",handleClick:I,"aria-label":"Add Key",type:"button",disabled:w||!x.trim()})})]})]})]})},"LlmEmbodimentModal");var P1=Object.defineProperty,sd=u((n,e)=>P1(n,"name",{value:e,configurable:!0}),"s$w");const I1=sd(({onClose:n})=>{const{dev:e,prod:t,scheme:s}=Nt.getState().agentDomains,a=e&&s?`${s}://${e}/emb/mcp/sse`:"",o=t&&s?`${s}://${t}/emb/mcp/sse`:"",r=sd(i=>{navigator.clipboard.writeText(i)},"handleCopy");return g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 overflow-auto max-h-[90vh] max-w-[480px]",children:[g.jsx(Hs,{title:"MCP Integration",onBack:n,onClose:n}),g.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Seamlessly connect your agent to MCP-compatible workbenches, IDEs, and enterprise environments."}),a&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"MCP Dev URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:a,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"MCP Dev URL"}),g.jsx("button",{type:"button","aria-label":"Copy MCP Dev URL",onClick:()=>r(a),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]}),o&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 -mb-4",children:"MCP Prod URL"}),g.jsxs("div",{className:"relative flex items-center mt-1 group w-full",children:[g.jsx(nn,{type:"text",value:o,readOnly:!0,fullWidth:!0,className:"w-full border-[#D1D5DB] border-b-gray-900 text-xs text-gray-700 hover:pr-10","aria-label":"MCP Prod URL"}),g.jsx("button",{type:"button","aria-label":"Copy MCP Prod URL",onClick:()=>r(o),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-white p-1",tabIndex:-1,children:g.jsx(Kn,{color:"#222"})})]})]})]})})},"McpEmbodimentModal");var L1=Object.defineProperty,Pr=u((n,e)=>L1(n,"name",{value:e,configurable:!0}),"a$u");const ad=ue.createContext(null),id=Pr(({children:n})=>{const e=["all-deployments",workspace.agent.id],[t,s]=ue.useState(null),[a,o]=ue.useState(null),r=Ds({mutationKey:["deploy-agent",workspace.agent.id],mutationFn:async v=>{const x=await fetch("/api/page/builder/ai-agent/deployments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({releaseNotes:`${v.releaseNotes||" "}`,version:`${v.major}.${v.minor}`,agentId:workspace.agent.id})}),C=await x.clone().json();return Ms.setQueryData(e,w=>({deployments:[{createdAt:new Date().toISOString(),majorVersion:v.major,minorVersion:v.minor,version:`${v.major}.${v.minor}`,releaseNotes:`${v.releaseNotes||" "}`,aiAgentId:workspace.agent.id,aiAgent:{name:workspace.agent.name},id:C?.deployment?.id||Math.random().toString(36).substring(7)},...w.deployments]})),m(v.major,v.minor),x}}),i=Yn({queryKey:["latest-deployment",workspace.agent.id],queryFn:()=>fetch(`/api/page/builder/ai-agent/${workspace.agent.id}/deployments/latest`).then(v=>v.json()),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),d=Yn({queryKey:["domains",workspace.agent.id],queryFn:()=>fetch("/api/page/builder/domains").then(v=>v.json()),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),c=Yn({queryKey:e,queryFn:()=>fetch(`/api/page/builder/ai-agent/${workspace.agent.id}/deployments`).then(v=>v.json()),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),l=Yn({queryKey:["status-info",workspace.agent.id],queryFn:()=>fetch("/api/status").then(v=>v.json()),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1});ue.useEffect(()=>{i.data?.deployment&&(s(i.data.deployment?.majorVersion),o(i.data.deployment?.minorVersion))},[i.data]);function m(v,x){v!==void 0&&s(v),x!==void 0&&o(x)}return u(m,"l"),Pr(m,"updateLatestVersion"),g.jsx(ad.Provider,{value:{deployMutation:r,latestDeployment:i,allDeployments:c,domains:d,ALL_DEPLOYMENTS_QUERY_KEY:e,workspace,updateVersion:m,lastVersion:{major:t,minor:a},statusInfoQuery:l},children:n})},"DeploymentSidebarProvider"),qi=Pr(()=>{const n=ue.useContext(ad);if(!n)throw new Error("useDeploymentSidebar must be used within an DeploymentSidebarProvider");return n},"useDeploymentSidebarCtx");var T1=Object.defineProperty,_a=u((n,e)=>T1(n,"name",{value:e,configurable:!0}),"p$8");function od({userInfo:n,onClose:e,onReopenDeployModal:t,onOpenLlmModal:s,onOpenCustomGptModal:a,onOpenDialogModal:o,onOpenCodeSnippetModal:r,onOpenAlexaPanel:i,onOpenChatbotPanel:d,onOpenApiPanel:c,onOpenMcpPanel:l,isVisible:m}){const{workspace:v,allDeployments:x}=qi(),{getPageAccess:C}=ra();v.agent.id;const[w,f]=ue.useState("embed"),T=ue.useMemo(()=>`post-deployment-modal-${v?.agent?.id}-${Math.random().toString(36).substr(2,9)}`,[v?.agent?.id]),[k,F]=ue.useState({availableEmbodiments:[],embodimentsData:[],agentSettings:[],canUseEmbodiments:!1,isReadOnlyAccess:!1}),O=ue.useMemo(()=>k.availableEmbodiments.sort((B,K)=>{const q=k.agentSettings.find(J=>J.key===B),X=k.agentSettings.find(J=>J.key===K),Q=q?.value?.isEnabled||q?.value==="true",V=X?.value?.isEnabled||X?.value==="true";return Q&&!V?-1:!Q&&V?1:0}),[k.availableEmbodiments]),{isLoading:_,updateEmbodimentStatus:M,refetchEmbodiments:b,modalHandlers:P}=of(v?.agent?.id||"",(B,K,q,X,Q)=>{F({agentSettings:B,embodimentsData:K,availableEmbodiments:q,canUseEmbodiments:X,isReadOnlyAccess:Q})},T);!window.location.pathname.includes("/agent-settings/")&&P.isActiveInstance;const L=_a(B=>{B.isUpdating||M(B.key,!0)},"handleToggle"),N=ue.useMemo(()=>P.isActiveInstance?k.agentSettings.map(B=>g.jsxs(ue.Fragment,{children:[B.dialogComponent,B.codeSnippetComponent]},`${T}-${B.key}`)):null,[k.agentSettings,T,P.isActiveInstance,k.embodimentsData,v?.agent]);function z(B){return typeof B=="object"&&B!==null&&"properties"in B&&typeof B.properties=="object"}u(z,"re"),_a(z,"hasProperties");const I=_a(B=>B.length===0?B:`${B.charAt(0).toUpperCase()}${B.slice(1)}`,"capitalizeFirstLetter");function W(B){let K=k.agentSettings.find(J=>J.key===B);K||(K={key:B,value:"false",enabled:!1,isUpdating:!1,embIcon:uf(B,"fill-[#515151] text-[#515151] text-xl"),embTitle:df(B),embDescription:pf(B),codeSnippetVisible:!1,configurationVisible:!1});const q=K.key.toLowerCase(),X=[];q===Kt.CHAT_GPT?(K.openModal&&X.push(g.jsx("button",{className:"flex items-center px-2 py-1 h-8 text-xl text-blue-600 hover:bg-gray-100 rounded",onClick:()=>K.openModal(),type:"button","aria-label":"Configuration",children:g.jsx(uc,{className:"text-blue-600"})},"configuration-"+Kt.CHAT_GPT)),X.push(g.jsx(Et,{label:"Get Code",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:()=>a(),"aria-label":"Get Code",type:"button"},"get-code"))):q===Kt.CHAT_BOT?(K.openCodeSnippet&&X.push(g.jsx("button",{className:"flex items-center px-2 py-1 h-8 text-xl text-blue-600 hover:bg-gray-100 rounded",onClick:()=>K.openModal(),type:"button","aria-label":"Configuration",children:g.jsx(uc,{className:"text-blue-600"})},"configuration-"+Kt.CHAT_BOT)),K.openModal&&X.push(g.jsx(Et,{label:"Get Code",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:()=>d(),"aria-label":"Get Code",type:"button"},"get-code"))):q===Kt.LLM?(X.push(g.jsx(Et,{label:"API Keys",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:()=>s("keys"),"aria-label":"API Keys",type:"button"},"api-keys-"+Kt.LLM)),X.push(g.jsx(Et,{label:"Get Code",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:()=>s("code"),"aria-label":"Get Code",type:"button"},"get-code-"+Kt.LLM))):q.indexOf(Kt.API)!==-1?X.push(g.jsx(Et,{label:"Get Endpoints",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:c,"aria-label":"Get Endpoints",type:"button"},"get-endpoints")):q===Kt.MCP?X.push(g.jsx(Et,{label:"Get URL",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:l,"aria-label":"Get URL",type:"button"},"get-url-"+Kt.MCP)):q===Kt.ALEXA&&X.push(g.jsx(Et,{label:"Get Endpoints",variant:"tertiary",className:"px-3 py-1 h-8 text-xs",handleClick:i,"aria-label":"Get Endpoints",type:"button"},"get-endpoints-"+Kt.ALEXA));const Q=I(q===Kt.CHAT_GPT?"Custom GPT":K.embTitle||"Untitled Embodiment"),V=K?.value?.isEnabled||K.value=="true";return{setting:K,buttons:X,embodimentName:Q,isSettingEnabled:V}}return u(W,"B"),_a(W,"getSettingsValues"),g.jsxs("div",{className:`relative bg-white rounded-2xl shadow-lg w-full p-6 flex flex-col gap-4 max-h-[90vh] max-w-[480px] ${m?"":"hidden"}`,style:{boxShadow:"0 4px 32px 0 rgba(0,0,0,0.10)",borderRadius:"20px",padding:"32px 24px",margin:"0 auto"},children:[g.jsxs(Sr,{value:w,onValueChange:f,className:"w-full",children:[g.jsxs(Fi,{className:"grid w-full grid-cols-2 mb-6",children:[g.jsx(ts,{value:"embed",className:"text-sm rounded-sm",children:"Embed"}),g.jsx(ts,{value:"domains-keys",className:"text-sm rounded-sm",children:"Domains"})]}),g.jsx(Fn,{value:"embed",className:"space-y-2",children:g.jsx("div",{className:"space-y-2",children:_?g.jsx("div",{className:"text-center text-gray-400",children:"Loading embodiments..."}):k.availableEmbodiments.length>0?O.map(B=>{const{setting:K,buttons:q,embodimentName:X,isSettingEnabled:Q}=W(B);return g.jsxs("div",{className:`flex items-center justify-between bg-white rounded-lg px-2 py-2 ${Q?"":"opacity-80"}`,children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("span",{className:"text-xl flex items-center justify-center w-6 h-6",children:K.embIcon}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"font-medium text-[#515151] text-base capitalize",children:X}),K.embDescription&&g.jsx(rf,{html:K.embDescription,classes:"w-56",iconClassName:"w-4 h-4 text-[#515151]"})]})]}),K.isUpdating?g.jsx("div",{className:"flex items-center gap-2",children:g.jsx("div",{className:"circular-loader-blue w-4 h-4"})}):Q?g.jsx("div",{className:"flex items-center gap-2",children:q}):g.jsx("div",{className:"flex items-center gap-2",children:g.jsx(lf,{checked:!1,onCheckedChange:()=>L(K),disabled:K.isUpdating,className:"data-[state=checked]:bg-blue-600 data-[state=unchecked]:bg-gray-300"})})]},K.key)}):g.jsx("div",{className:"text-center text-gray-400",children:"No embodiments found."})})}),g.jsx(Fn,{value:"domains-keys",className:"space-y-6",children:g.jsx(cf,{isDeployed:x?.data?.deployments.length>0,isWriteAccess:C("/builder").write})})]}),N]})}u(od,"te$3"),_a(od,"PostDeploymentModal");var j1=Object.defineProperty,Rt=u((n,e)=>j1(n,"name",{value:e,configurable:!0}),"s$v");const rd={base:"absolute z-10 inline-block rounded-lg px-3 py-2 text-sm font-medium shadow-sm left-0",arrow:{base:"absolute z-10 h-2 w-2 rotate-45 -ml-4"}},O1={...rd,target:"w-full text-center",animation:"transition-opacity delay-3000"};function ld({userInfo:n,deploymentSidebarCtx:e}){const{toggleDeployModal:t}=Er(),{workspace:s,domains:a,deployMutation:o,lastVersion:r,statusInfoQuery:i,latestDeployment:d,allDeployments:c}=e,[l,m]=ue.useState(!1),[v,x]=ue.useState(!0),[C,w]=ue.useState({open:!1,defaultTab:"code"}),f=hf(),{data:T}=mf({options:{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnFocus:!1,refetchOnReconnect:!1}});Ct.getFeatureFlag(Oo.DEPLOY_MODAL);const[k,F]=ue.useState(!1),[O,_]=ue.useState(!1),[M,b]=ue.useState(!1),[P,L]=ue.useState("none"),[N,z]=ue.useState(null),[I,W]=ue.useState(null),[B,K]=ue.useState({modalOpened:!!mi.activeModal,snippetOpened:mi.showCodeSnippet});ue.useEffect(()=>{const xe=Rt(()=>{const Xe=!!mi.activeModal,rt=mi.showCodeSnippet;K(kt=>kt.modalOpened!==Xe||kt.snippetOpened!==rt?{modalOpened:Xe,snippetOpened:rt}:kt)},"checkModalStates");xe();const Ne=Rt(()=>xe(),"handleModalStateChange");return window.addEventListener("embodimentModalStateChange",Ne),()=>{window.removeEventListener("embodimentModalStateChange",Ne)}},[]);const{modalOpened:q,snippetOpened:X}=B,{data:Q,isLoading:V}=Yn({queryKey:["embodiments",s.agent.id],queryFn:async()=>{const xe=await fetch(`/api/page/agents/embodiments/${s.agent.id}`);if(!xe.ok)throw new Error("Failed to fetch embodiments");return xe.json()},enabled:!!s?.agent?.id,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),J=Q?.embodiments?.find(xe=>xe.type===Kt.CHAT_BOT),A=J?{properties:{introMessage:J.properties?.introMessage||"",isFullScreen:J.properties?.isFullScreen||!1,allowFileAttachments:J.properties?.allowFileAttachments||!1}}:void 0,j=s.agent.domain||`${s.agent.id}.${i.data?.status?.prod_agent_domain}`,S=P!=="none"||N&&N.open||I!==null||C.open||q||X;ue.useEffect(()=>{O&&(b(!0),F(!0))},[O]);const U=`${s.agent.id}.${i.data?.status?.prod_agent_domain}`,G=Rt(xe=>{window.open("https://github.com/Smyth-ai/smyth-runtime-local/tree/main","_blank")},"handleDeploy"),Y=Rt(()=>{window.open("https://smythos.com/enterprise-enquiry/","_blank")},"handleContactSales"),se=dc({major:gf().required("Major version is required").min(r.major??1,"Major version cannot be less than the current major version"),domain:gi().required("Domain is required"),releaseNotes:gi().optional().max(500,"Release notes cannot be more than 500 characters")});async function le(xe){const Ne=xe;if(xe=="default"&&s?.agent?.domain&&s?.agent?.domain!=="default"){(await fetch("/api/page/builder/removeDomain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:s.agent.id,curDomain:s.agent.domain})})).ok?(s.agent.domain=null,window.dispatchEvent(new CustomEvent("queryClientInvalidate",{detail:{queryKey:["domains"]}}))):Je("Domain Update failed");return}else if(xe=="default"){Nt.setState(rt=>({...rt,agentDomains:{...rt.agentDomains,prod:U}}));return}const Xe=s.agent.domain;if(Ne!=Xe)try{(await fetch("/api/page/builder/updateDomain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:s.agent.id,curDomain:Xe,domain:Ne})})).ok?(s.agent.domain=Ne,s.saveAgent(null,Ne,null,null,!0),window.dispatchEvent(new CustomEvent("queryClientInvalidate",{detail:{queryKey:["domains"]}})),Nt.setState(rt=>({agentDomains:{...rt.agentDomains,prod:Ne}}))):Je("Domain Update failed")}catch(rt){throw Je("Domain Update failed"),rt}}u(le,"we"),Rt(le,"updateDomain");const ne=[{name:U,value:"default"},...a.data?.filter(xe=>xe.aiAgent==null||xe.aiAgent.id==s.agent.id).map(xe=>({name:xe.name,value:xe.name}))||[]].filter((xe,Ne,Xe)=>Ne===Xe.findIndex(rt=>rt.value===xe.value)),he={major:r.major!==null&&r.major!==void 0?r.major:1,minor:r.minor!==null&&r.minor!==void 0?r.minor+1:0,domain:s.agent.domain||"default",releaseNotes:""},pe=ff({initialValues:he,validationSchema:se,onSubmit:async(xe,{setSubmitting:Ne})=>{m(!0),await le(xe.domain);const Xe=await(await o.mutateAsync(xe))?.json();s.emit("AgentDeployed",Xe),window.dispatchEvent(new CustomEvent("queryClientInvalidate",{detail:{queryKey:["latest_deployment",s.agent.id]}})),window.dispatchEvent(new CustomEvent("agentProdDomainUpdate",{detail:{agentId:s.agent.id}})),T?.onboardingTasks?.DEPLOY_FIRST_AGENT?la.track("app_deploy_agent",{createdAt:new Date().toISOString().split("T")[0]}):(f.mutate({key:vf.OnboardingTasks,data:{[Do.DEPLOY_FIRST_AGENT]:!0,[Do.COMPLETED_TASK]:Do.DEPLOY_FIRST_AGENT},operation:"insertOrUpdate"}),la.track("app_deploy_first_agent",{createdAt:new Date().toISOString().split("T")[0]}),la.track("app_deploy_agent",{createdAt:new Date().toISOString().split("T")[0]})),Ne(!1),m(!1),_(!0),$t("Agent Deployed Successfully."),F(!0)},enableReinitialize:!0}),fe=Rt(xe=>{w({open:!0,defaultTab:xe}),x(!1)},"handleOpenLlmModal"),me=Rt(()=>{w({open:!1,defaultTab:"code"}),x(!0),setTimeout(()=>{O&&window.dispatchEvent(new CustomEvent("queryClientInvalidate",{detail:{queryKey:["latest_deployment",s.agent.id]}}))},100)},"handleCloseLlmModal"),we=Rt((xe,Ne,Xe)=>{z({open:!0,title:xe,component:Ne,componentProps:Xe}),x(!1)},"handleOpenDialogModal"),_e=Rt(xe=>{W(xe),x(!1)},"handleOpenCodeSnippetModal"),je=Rt(()=>{z(null),x(!0)},"handleCloseDialogModal"),Pe=Rt(()=>{W(null),x(!0)},"handleCloseCodeSnippetModal"),qe=Rt(xe=>{L(xe),x(!1)},"handleOpenPanel"),Me=Rt(()=>{L("none"),x(!0)},"handleClosePanel");let ye=null;I&&(ye=g.jsx(Mo,{isOpen:!0,onClose:Pe,hideCloseIcon:!0,panelWidthClasses:"w-[100vw] max-w-[480px]",children:g.jsx(bf,{onClose:Pe,domain:typeof s.agent.domain=="string"?s.agent.domain:"",embodimentData:{properties:{introMessage:""}}})}));const be=Rt(()=>{b(!1)},"handleExpandModal"),Ae=Rt(()=>{b(!0)},"handleCollapseModal");return g.jsxs(g.Fragment,{children:[P==="alexa"&&g.jsx(f1,{onClose:Me}),P==="gpt"&&g.jsx(S1,{onClose:Me}),P==="chatbot"&&g.jsx(x1,{onClose:Me,domain:j,embodimentData:A,isLoading:V}),P==="api"&&g.jsx(b1,{onClose:Me}),P==="mcp"&&g.jsx(I1,{onClose:Me}),N&&N.open&&g.jsxs(Mo,{isOpen:N.open,onClose:je,hideCloseIcon:!0,panelWidthClasses:"w-[100vw] max-w-[480px]",children:[g.jsxs("div",{className:"flex items-center mb-4",children:[g.jsx("button",{className:"mr-2 -ml-2 p-2 rounded hover:bg-gray-100",onClick:je,"aria-label":"Back",children:g.jsx(pc,{})}),g.jsx("span",{className:"flex-1 text-lg font-semibold",children:N.title}),g.jsx("button",{className:"ml-auto -mr-2 p-2 rounded hover:bg-gray-100",onClick:je,"aria-label":"Close",children:g.jsx(pc,{})})]}),N.component?at.createElement(N.component,N.componentProps||{}):g.jsxs("div",{className:"text-center text-gray-500 py-8",children:["Coming soon: ",N.title]})]}),ye,C.open&&g.jsx("div",{className:"fixed inset-0 bg-black/25 flex items-center justify-center z-50",children:g.jsx(_1,{agent:{id:s.agent.id,name:s.agent.name,description:s.agent.data?.description??"",shortDescription:s.agent.data?.shortDescription??"",createdAt:s.agent.data?.createdAt??"",updatedAt:s.agent.data?.updatedAt??"",__disabled:s.agent.data?.__disabled??!1,_count:s.agent.data?._count??{AiAgentDeployment:0},contributors:s.agent.data?.contributors??[],isLocked:s.agent.data?.isLocked??!1,aiAgentSettings:s.agent.data?.aiAgentSettings??[],avatar:s.agent.data?.avatar??"",status:s.agent.data?.status??"",isPublic:s.agent.data?.isPublic??!1,userId:s.agent.data?.userId??"",teamId:s.agent.data?.teamId??""},defaultTab:C.defaultTab,onClose:me})}),g.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 p-4 flex items-center justify-center ${S?"hidden":""}`,children:g.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center overflow-y-auto",style:{maxHeight:"100vh"},children:[M&&O?g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full max-w-[480px] p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors",onClick:be,children:[g.jsx("div",{className:"flex items-center gap-3",children:g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-medium text-[#111827]",children:"Deploy Agent"}),g.jsx("p",{className:"text-xs text-gray-500",children:"Click to deploy a new version"})]})}),g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs(hs,{variant:"ghost",size:"icon",className:"h-[22px] w-[22px]",onClick:xe=>{xe.stopPropagation(),t()},children:[g.jsx(Zo,{className:"text-[#111827]"}),g.jsx("span",{className:"sr-only",children:"Close"})]})})]}):g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full max-w-[480px] p-6 flex flex-col flex-none gap-2 overflow-auto max-h-[90vh]",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[O&&g.jsxs(hs,{variant:"ghost",size:"icon",className:"h-[22px] w-[22px] -ml-2",onClick:Ae,children:[g.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:g.jsx("path",{d:"M15 18L9 12L15 6",stroke:"#111827",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),g.jsx("span",{className:"sr-only",children:"Back"})]}),g.jsxs("h2",{className:"text-lg font-medium text-[#111827] flex items-center gap-1",children:["Deploy Agent",g.jsx(bn,{theme:rd,content:g.jsxs("div",{style:{whiteSpace:"normal"},children:["Deploy your agent to make it live and ready to integrate into your workflow. Use SmythOS's default subdomain or configure a custom one."," ",g.jsx("a",{href:`${Ft}/agent-deployments/overview/`,target:"_blank",className:"text-v2-blue hover:underline",children:"Learn more"})]}),children:g.jsx("span",{className:"",children:g.jsx(yf,{className:"text-gray-500 text-lg"})})})]})]}),g.jsxs(hs,{variant:"ghost",size:"icon",className:"h-[22px] w-[22px]",onClick:t,children:[g.jsx(Zo,{className:"text-[#111827]"}),g.jsx("span",{className:"sr-only",children:"Close"})]})]}),g.jsxs(Sr,{defaultValue:"agent-cloud",className:"w-full relative",children:[g.jsxs(Fi,{className:"grid w-full grid-cols-3 mb-4",children:[g.jsx(bn,{content:g.jsx("div",{style:{whiteSpace:"normal"},children:"Convenient, easy, and instant. We handle all the hosting of your agent for you at $2 per 1,000 tasks, only pay for what you use. Unlock chat, bulk work, schedules, analytics, logs, APIs and more."}),placement:"top",theme:O1,trigger:"hover",children:g.jsx(ts,{value:"agent-cloud",className:"text-sm rounded-sm w-full",children:"Agent Cloud"})}),g.jsx(ts,{value:"enterprise",className:"text-sm rounded-sm",children:"Enterprise"}),g.jsx(ts,{value:"deploy-locally",className:"text-sm rounded-sm",children:"Deploy Locally"})]}),g.jsx(Fn,{value:"agent-cloud",children:g.jsxs("form",{onSubmit:pe.handleSubmit,children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(ca,{className:"text-sm font-medium text-[#111827]",children:"Version"}),g.jsxs("div",{className:"flex space-x-[18px]",children:[g.jsxs("div",{className:"flex-1 space-y-2",children:[g.jsxs(ca,{htmlFor:"major",className:"text-sm font-normal text-black",children:["Major ",g.jsx("span",{className:"text-red-500 text-sm",children:"*"})]}),g.jsx(nn,{type:"number",name:"major",id:"deploy-version-major-number",placeholder:"1",min:r.major??1,value:pe.values.major,onChange:xe=>{pe.handleChange(xe),parseInt(xe.target.value)===r.major&&r.major!==0&&pe.values.minor<r.major+1&&pe.setFieldValue("minor",r.major+1)},className:"h-[42px] bg-[#F9FAFB] border-[#D1D5DB] text-sm text-[#111827]"})]}),g.jsxs("div",{className:"flex-1 space-y-2",children:[g.jsxs(ca,{htmlFor:"minor",className:"text-sm font-normal text-black",children:["Minor ",g.jsx("span",{className:"text-red-500 text-sm",children:"*"})]}),g.jsx(nn,{type:"number",name:"minor",id:"deploy-version-minor-number",placeholder:"0",min:pe.values.major===r.major&&r.minor!==null&&r.minor!==void 0?r.minor+1:0,value:pe.values.minor,onChange:pe.handleChange,className:"h-[42px] bg-[#F9FAFB] border-[#D1D5DB] text-sm text-[#111827]"})]}),pe.touched.major&&pe.errors.major?g.jsx("div",{className:"text-red-500 text-sm mt-2",children:typeof pe.errors.major=="string"?pe.errors.major:null}):null]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(ca,{htmlFor:"subdomain",className:"text-sm font-medium text-[#111827]",children:["Subdomain"," ",g.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["(if you want to register a subdomain, click"," ",g.jsx("a",{href:"/domains",target:"_blank",className:"text-smyth-blue hover:underline",children:"here"}),")"]})]}),g.jsxs(ui,{name:"deploy-domain-select",value:pe.values.domain,onValueChange:xe=>{pe.setFieldValue("domain",xe)},children:[g.jsx(di,{id:"subdomain",className:"h-[42px] bg-[#F9FAFB] border-[#D1D5DB] text-sm text-[#111827]",children:g.jsx(pi,{children:pe.values.domain==="default"?U:pe.values.domain})}),g.jsxs(hi,{children:[g.jsx(An,{value:"default",children:U}),ne.filter(xe=>xe.value!=="default").map(xe=>g.jsx(An,{value:xe.value,children:xe.name},xe.value))]})]}),pe.touched.domain&&pe.errors.domain?g.jsx("div",{className:"text-red-500 text-sm mt-2",children:typeof pe.errors.domain=="string"?pe.errors.domain:null}):null]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(ca,{htmlFor:"deploy-modal-release-notes",className:"text-sm font-medium text-[#111827]",children:"Release Notes"}),g.jsx(cc,{name:"releaseNotes",className:"min-h-[100px] bg-[#F9FAFB] border-[#D1D5DB] text-sm text-[#6B7280] resize-vertical",placeholder:"Enter the list of new features, bug fixes, and other changes here.",value:pe.values.releaseNotes,onChange:pe.handleChange,fullWidth:!0})]})]}),g.jsx("div",{className:"mt-4",children:g.jsx(Et,{type:"submit",loading:l,fullWidth:!0,className:"h-[40px] bg-[#45C9A9] hover:bg-[#3BB89A] text-white text-sm font-medium rounded-lg",children:"Deploy"})})]})}),g.jsx(Fn,{value:"enterprise",children:g.jsxs("div",{className:"space-y-4",children:[g.jsx("p",{className:"text-xs text-gray-600",children:"Deploy on-prem or to enterprise cloud with enterprise security and unlimited task options available. Great for enterprise."}),g.jsx(Et,{className:"w-full h-[40px] bg-[#45C9A9] hover:bg-[#3BB89A] text-white text-sm font-medium rounded-lg",handleClick:Y,children:"Contact sales"})]})}),g.jsx(Fn,{value:"deploy-locally",children:g.jsxs("div",{className:"space-y-4",children:[g.jsx("p",{className:"text-xs text-gray-600",children:"Export your AI agent with Control+ Shift+E, then run it locally with our local runtime for Mac, Windows, Linux."}),g.jsx(Et,{className:"w-full h-[40px] bg-[#45C9A9] hover:bg-[#3BB89A] text-white text-sm font-medium rounded-lg",handleClick:()=>G("locally"),children:"Download SRE"})]})})]})]}),O&&(M?g.jsx(hc,{workspace:s,workspaceAgentId:s.agent.id,children:g.jsx("div",{className:"w-full max-w-[480px] mt-5",children:g.jsx(od,{userInfo:n,onClose:t,onReopenDeployModal:()=>x(!0),onOpenLlmModal:fe,onOpenCustomGptModal:()=>qe("gpt"),onOpenDialogModal:we,onOpenCodeSnippetModal:_e,onOpenAlexaPanel:()=>qe("alexa"),onOpenChatbotPanel:()=>qe("chatbot"),onOpenApiPanel:()=>qe("api"),onOpenMcpPanel:()=>qe("mcp"),isVisible:O&&M&&!S})})}):g.jsxs("div",{className:"relative bg-white rounded-2xl shadow-lg w-full max-w-[480px] mt-5 p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors",onClick:Ae,children:[g.jsx("div",{className:"flex items-center gap-3",children:g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-medium text-[#111827]",children:"Embed Options"}),g.jsx("p",{className:"text-xs text-gray-500",children:"Click to see options for embedding agent across different channels"})]})}),g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs(hs,{variant:"ghost",size:"icon",className:"h-[22px] w-[22px]",onClick:xe=>{xe.stopPropagation(),t()},children:[g.jsx(Zo,{className:"text-[#111827]"}),g.jsx("span",{className:"sr-only",children:"Close"})]})})]}))]})})]})}u(ld,"lt$1"),Rt(ld,"DeployAgentModal");var D1=Object.defineProperty,M1=u((n,e)=>D1(n,"name",{value:e,configurable:!0}),"o$o");const cd=class extends ue.Component{static{u(this,"e")}constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error(e,t.componentStack)}render(){return this.state.hasError?this.props.fallback:this.props.children}};M1(cd,"DeploymentErrorBoundary");let N1=cd;var $1=Object.defineProperty,Rn=u((n,e)=>$1(n,"name",{value:e,configurable:!0}),"a$t");async function ud(n,e,t,s){const a=hd(e);await En("Postman Collection Detected","Do you want to import the Postman collection?",{btnYesLabel:"Yes, Import",btnNoLabel:"No, Cancel"})&&(n.refreshComponentSelection(),n.clipboard.pasteSelection(JSON.stringify(a),t,s),n.redraw())}u(ud,"importPostman"),Rn(ud,"importPostman");async function Ir(n,e,t=!1){if([...n.domElement.querySelectorAll(".component")].length>0&&!t){await Xn("Please clear the workspace before importing a Smyth Agent file.","Workspace not empty");return}!t&&!await En("Smyth Agent File Detected","Do you want to import it ?",{btnYesLabel:"Yes, Import",btnNoLabel:"No, Cancel"})||(delete e?.teamId,await n.import(e),n.agent.name=e.name||e.templateInfo?.name||n.agent.name||"Untitled Agent",n.agent.description=e.description,n.agent.data.description=e.description,n.agent.data.templateInfo=e.templateInfo,n.agent.shortDescription=e.shortDescription,n.agent.data.shortDescription=e.shortDescription,n.agent.behavior=e.behavior,n.agent.data.behavior=e.behavior,n.agent.variables=e.variables||{},n.agent.data.variables=e.variables||{},n.agent.introMessage=e.introMessage,n.agent.data.introMessage=e.introMessage,await n.saveAgent(e.name,"",e),n.emit("agentUpdated",n.agent),window.refetchSettingsSidebarData&&window.refetchSettingsSidebarData())}u(Ir,"importSmythFile"),Rn(Ir,"importSmythFile");function dd(n){const e={x:0,y:0},t=n.container;["dragenter","dragover","dragleave","drop"].forEach(r=>{t.addEventListener(r,s,!1)});function s(r){r.preventDefault(),r.stopPropagation()}u(s,"u"),Rn(s,"preventDefaults"),t.addEventListener("dragover",r=>{const i=n.domElement.getBoundingClientRect(),d=Math.round((r.clientX-i.x)/n.scale),c=Math.round((r.clientY-i.y)/n.scale);e.x=d,e.y=c}),t.addEventListener("drop",a,!1);function a(r){let i=r.dataTransfer.files;n.locked||o(i)}u(a,"c"),Rn(a,"handleDrop");function o(r){const i=e.x,d=e.y;[...r].forEach(c=>{if(c.type==="application/json"||c.type==="text/plain"||c.name.endsWith(".smyth")){const l=new FileReader;l.onload=async function(m){try{const v=JSON.parse(m.target.result);switch(pd(v)){case"POSTMAN":ud(n,v,i,d);break;case"SMYTH_AGENT":Ir(n,v);break;case"TEXT":console.log(v);break;default:console.log("Unknown format")}}catch(v){console.log(v)}},l.readAsText(c)}})}u(o,"g"),Rn(o,"handleFiles")}u(dd,"registerFileDrag"),Rn(dd,"registerFileDrag");function pd(n){if(typeof n=="string")return"TEXT";if(n?.info?._postman_id)return"POSTMAN";if(n.version&&Array.isArray(n.components)&&Array.isArray(n.connections))return"SMYTH_AGENT"}u(pd,"I$2"),Rn(pd,"identifyFormat");function hd(n){if(!n.item)return null;let e=0;const t=Rn((s,a)=>{let o=[],r=0;for(let i of s){if(i.request){let d,c="none",l=i.request?.url?.raw||"";const m=/^{{.*?}}/.test(l);!l.startsWith("http:")&&!l.startsWith("https:")&&l!==""&&!m&&(l=`http://${l}`);const v=i.request?.method||"GET",x=i.request?.body?.mode;try{if(x==="raw")c=`application/${i.request?.body?.options?.raw?.language||"json"}`,d=JSON.parse(i.request.body.raw||"{}");else if(x==="urlencoded"||x==="formdata"){c=x==="formdata"?"multipart/form-data":"application/x-www-form-urlencoded",d={};for(let f of i.request?.body?.[x]||[])d[f.key]=f.value}}catch(f){console.error("Error parsing body:",f)}const C={};for(let f of i.request?.header||[])C[f.key]=f.value;const w={name:"APICall",outputs:[{name:"Response",color:"#3C89F9",index:0,default:!0},{name:"Headers",color:"#3C89F9",index:1,default:!0}],inputs:[],top:`${r}px`,left:`${e}px`,width:"",uid:Dn(),defaultOutputs:["Headers","Response"],defaultInputs:[],data:{method:v,contentType:c,url:l,headers:JSON.stringify(C),body:JSON.stringify(d)},title:i.name,description:a.name};o.push(w)}else i.item&&(o=[...o,...t(i.item,i).flat(1/0)]);r+=250}return e+=300,o},"parseItem");return{components:t(n.item,n),connections:[]}}u(hd,"T$1"),Rn(hd,"parsePostman");var F1=Object.defineProperty,Bi=u((n,e)=>F1(n,"name",{value:e,configurable:!0}),"c$c");const R1=Bi(()=>{const{allDeployments:n,workspace:e}=qi(),[t,s]=ue.useState(""),{userInfo:a}=ra(),o=Bi(async i=>{try{let d=(await(await fetch(`/api/page/builder/ai-agent/deployments/${i}`)).json()).deployment.aiAgentData;await Ir(e,d,!0)}catch(d){console.error("Failed to restore version:",d)}finally{s("")}},"restoreVersion"),r=Bi(async i=>{if(!a?.subs?.plan?.paid){la.track("upgrade_impression",{page_url:"/builder",source:"restoring previous version"}),No({title:"",fields:{},content:`
            <div class="text-center px-4 py-6">
              <h2 class="text-2xl font-bold text-gray-800 mb-2">
                Unlock Version Control
              </h2>

              <div class="mb-6">
                <p class="text-base text-gray-600 leading-relaxed mx-auto max-w-md">
                  Version history and restore features are not available on Free plans.
                    <a href="/plans"
                     target="_blank"
                     class="text-blue-600 underline hover:opacity-75"
                     onclick="window.analytics?.track('upgrade_click', {
                       page_url: '/builder',
                       source: 'restoring previous version'
                     })">
                    Upgrade
                  </a> to unlock access to version control and much more.
                </p>
              </div>
            </div>
          `,actions:[],onCloseClick:(c,l)=>{ua(l)}},"auto","auto","none","auto","600px");return}s(i);const d=document.getElementById("self-contained-restore-modal-btn");if(!d){console.error("Restore modal button not found"),s("");return}try{const c=new MutationObserver(l=>{l.forEach(async m=>{if(m.type==="attributes"){const v=d.getAttribute("result");v==="cancelled"?(s(""),c.disconnect()):v==="confirmed"&&(await o(i),c.disconnect(),s(""))}})});c.observe(d,{attributes:!0}),d.click()}catch(c){console.error("Failed to restore version:",c),s("")}},"restoreVersionConfirmation");return g.jsxs(g.Fragment,{children:[n.data&&n.data.deployments.length>0&&g.jsxs("div",{className:"flex flex-col",children:[g.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Changelog"}),g.jsx("ul",{className:"flex flex-col gap-6",children:n?.data?.deployments?.map((i,d)=>g.jsx("li",{children:g.jsx(md,{deployment:i,restoreVersion:r,isRestoring:t})},i.id))})]}),n.isSuccess&&n.data?.deployments.length===0&&g.jsx("p",{className:"text-sm text-gray-500",children:"No deployments found"}),n.isError&&g.jsx("p",{className:"text-sm text-gray-500",children:"Failed to load deployments"}),n.isLoading&&g.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]})},"DeploymentsHistory");function md({deployment:n,isActive:e=!1,restoreVersion:t,isRestoring:s}){return g.jsxs("div",{className:"flex flex-col relative [&:hover_span]:opacity-100",children:[g.jsxs("p",{className:"text-sm text-gray-500 leading-[38px]",children:[g.jsxs("span",{className:"font-semibold text-gray-900",children:["Version: ",n.version," "]}),e&&g.jsx("span",{className:"text-smyth-emerald-400 pl-4",children:"Active"}),!e&&(!s||s==n.id)&&g.jsxs("span",{onClick:()=>t(n.id),className:yn("restore-button text-gray-500 cursor-pointer absolute right-0 top-1 w-20 rounded text-center border border-solid leading-[28px] opacity-0 transition-opacity duration-200 hover:bg-smyth-blue hover:text-white hover:border-smyth-blue",{"opacity-100":s}),children:[!s&&"Restore",s&&n.id===s&&g.jsx(On,{classes:"w-4 h-4"})]})]}),g.jsxs("p",{className:"text-sm text-gray-500",children:["Release date: ",Intl.DateTimeFormat("en-US").format(new Date(n.createdAt))]}),n.releaseNotes.trim()&&g.jsxs("p",{className:"text-sm text-gray-500",children:["Release notes: ",n.releaseNotes]})]})}u(md,"_$5"),Bi(md,"DeploymentItem");function q1(n){return $o({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM11 15V17H13V15H11ZM11 7V13H13V7H11Z"}}]})(n)}u(q1,"RiErrorWarningFill");var B1=Object.defineProperty,U1=u((n,e)=>B1(n,"name",{value:e,configurable:!0}),"o$n");const Lr="You have reached your quota for production agent deployments",z1=U1(({onNavigate:n})=>{const{deployMutation:e}=qi();return g.jsx("div",{children:e.isLoading?g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512",className:"animate-spin",children:g.jsx("path",{fill:"currentColor",d:"M0 32C0 14.3 14.3 0 32 0H64 320h32c17.7 0 32 14.3 32 32s-14.3 32-32 32V75c0 42.4-16.9 83.1-46.9 113.1L237.3 256l67.9 67.9c30 30 46.9 70.7 46.9 113.1v11c17.7 0 32 14.3 32 32s-14.3 32-32 32H320 64 32c-17.7 0-32-14.3-32-32s14.3-32 32-32V437c0-42.4 16.9-83.1 46.9-113.1L146.7 256 78.9 188.1C48.9 158.1 32 117.4 32 75V64C14.3 64 0 49.7 0 32zM96 64V75c0 25.5 10.1 49.9 28.1 67.9L192 210.7l67.9-67.9c18-18 28.1-42.4 28.1-67.9V64H96zm0 384H288V437c0-25.5-10.1-49.9-28.1-67.9L192 301.3l-67.9 67.9c-18 18-28.1 42.4-28.1 67.9v11z"})}),g.jsx("p",{className:"font-semibold text-gray-500",children:"Pushing Updates"})]}):e.isSuccess?g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx(xf,{className:"text-emerald-500"}),g.jsx("p",{className:"text-emerald-500 font-semibold",children:"Deployment Successful"})]}):e.isError?g.jsxs("div",{className:"flex flex-col gap-1 mb-4",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(q1,{className:"text-red-500"}),g.jsx("p",{className:"text-red-500 font-semibold",children:e.error?.error?.message===Lr?"Agent Deployment Limit Reached":"Deployment Failed"})]}),e.error?.error?.message?g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-red-500",children:e.error?.error?.message===Lr?"Unlock unlimited deployments and elevate your possibilities with the Starter Plan.":e.error?.error?.message}),e.error?.error?.message===Lr&&g.jsx(Et,{className:"mt-3",variant:"primary",handleClick:()=>n("/plans"),children:"Upgrade for Unlimited Deployments"})]}):null]}):null})},"DeploymentStatus");var G1=Object.defineProperty,gd=u((n,e)=>G1(n,"name",{value:e,configurable:!0}),"n$n");const H1=gd(()=>{const[n,e]=ue.useState(!1),t=gd(s=>{window.location.href=s},"handleNavigation");return g.jsxs("div",{children:[g.jsx("div",{className:"h-16 flex-shrink-0 p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("path",{d:"M12.5604 21.75C10.8462 21.747 9.16316 21.2922 7.68084 20.4314C6.19852 19.5706 4.96933 18.3342 4.11721 16.8469C3.26509 15.3595 2.82015 13.6738 2.82723 11.9597C2.83432 10.2456 3.2932 8.56362 4.15758 7.08338C5.02197 5.60314 6.26131 4.37694 7.75069 3.52841C9.24008 2.67987 10.9268 2.23899 12.641 2.25021C14.3551 2.26143 16.0359 2.72435 17.5141 3.5923C18.9922 4.46026 20.2154 5.70256 21.0604 7.19399C21.1415 7.36498 21.155 7.56033 21.0982 7.74086C21.0413 7.9214 20.9183 8.07377 20.7538 8.1674C20.5893 8.26103 20.3955 8.28901 20.2113 8.24572C20.027 8.20243 19.8659 8.09107 19.7603 7.93399C18.7467 6.14468 17.1012 4.79859 15.1465 4.15966C13.1918 3.52074 11.0689 3.63508 9.19411 4.48026C7.31934 5.32544 5.82792 6.84049 5.01232 8.72832C4.19672 10.6161 4.11578 12.7406 4.78536 14.685C5.35829 16.3478 6.44799 17.7839 7.89526 18.7833C9.34252 19.7826 11.0715 20.293 12.8295 20.2397C14.5874 20.1864 16.2823 19.5723 17.6664 18.4871C19.0505 17.4019 20.0512 15.9025 20.5224 14.208C20.5799 14.0216 20.7079 13.865 20.879 13.7714C21.0502 13.6778 21.251 13.6545 21.439 13.7066C21.627 13.7586 21.7873 13.8819 21.886 14.0502C21.9846 14.2184 22.0138 14.4185 21.9673 14.608C21.3932 16.6603 20.1641 18.4687 18.4672 19.7579C16.7702 21.047 14.6984 21.7462 12.5673 21.749L12.5604 21.75Z",fill:"currentColor"}),g.jsx("path",{d:"M20.6492 8.31853H17.3682C17.1693 8.31853 16.9785 8.23951 16.8379 8.09885C16.6972 7.9582 16.6182 7.76744 16.6182 7.56853C16.6182 7.36961 16.6972 7.17885 16.8379 7.0382C16.9785 6.89755 17.1693 6.81853 17.3682 6.81853H19.8992V4.26953C19.8992 4.07062 19.9782 3.87985 20.1188 3.7392C20.2595 3.59854 20.4503 3.51953 20.6492 3.51953C20.8481 3.51953 21.0389 3.59854 21.1795 3.7392C21.3202 3.87985 21.3992 4.07062 21.3992 4.26953V7.56953C21.3989 7.76827 21.3198 7.95878 21.1791 8.09921C21.0385 8.23965 20.8479 8.31853 20.6492 8.31853Z",fill:"currentColor"}),g.jsx("path",{d:"M15.3986 15.3164C15.2637 15.3164 15.1313 15.2797 15.0156 15.2104L11.8406 13.3104C11.7291 13.244 11.6367 13.1497 11.5727 13.0368C11.5087 12.9239 11.4752 12.7962 11.4756 12.6664V8.56641C11.4756 8.36749 11.5546 8.17673 11.6953 8.03608C11.8359 7.89543 12.0267 7.81641 12.2256 7.81641C12.4245 7.81641 12.6153 7.89543 12.7559 8.03608C12.8966 8.17673 12.9756 8.36749 12.9756 8.56641V12.2394L15.7846 13.9174C15.9257 14.0016 16.0352 14.1298 16.0963 14.2823C16.1575 14.4348 16.1668 14.6032 16.123 14.7616C16.0791 14.9199 15.9845 15.0595 15.8536 15.1588C15.7228 15.2581 15.5629 15.3118 15.3986 15.3114V15.3164Z",fill:"currentColor"})]}),g.jsx("span",{className:"text-xl font-semibold",children:"Deploy"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("button",{id:"deploy-toggle-modal-btn",type:"button",onClick:()=>{document.getElementById("deploy-button-topbar").click()},className:`${Fo} focus:outline-none font-medium rounded text-sm px-5 py-1.5 text-center`,children:[n&&g.jsxs("svg",{"aria-hidden":"true",role:"status",id:"deploy-toggle-modal-btn-spinner",className:"inline w-4 h-4 me-1 text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),g.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),"Deploy"]}),g.jsx(bn,{content:"Close",placement:"left",arrow:!1,children:g.jsx("button",{type:"button",className:"close-btn p-0.5 rounded-full",onClick:()=>window.dispatchEvent(new CustomEvent("toggle-sidebar-request")),children:g.jsx("svg",{className:"w-6 h-6 text-[#757575]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})]})]})}),g.jsxs("div",{className:"flex-shrink-0 p-4",children:[g.jsx(z1,{onNavigate:t}),g.jsx(R1,{})]})]})},"DeploymentSidebarContent");var V1=Object.defineProperty,W1=u((n,e)=>V1(n,"name",{value:e,configurable:!0}),"e$a");const K1=W1(({workspace:n})=>g.jsx(N1,{fallback:g.jsx("p",{children:"Something went wrong"}),children:g.jsx(id,{workspace:n,children:g.jsx(H1,{})})}),"AgentDeploymentSidebar");var Y1=Object.defineProperty,Pa=u((n,e)=>Y1(n,"name",{value:e,configurable:!0}),"n$m");const fd=ue.createContext(void 0),X1=Pa(({children:n,mode:e})=>{const t=ue.useRef(null),[s,a]=ue.useState(null),[o,r]=ue.useState([]),[i,d]=ue.useState("form"),[c,l]=ue.useState(null),[m,v]=ue.useState(null),[x,C]=ue.useState([]);ue.useEffect(()=>{C([...e.props.defaultSkill?.details?.skillErrors?.errors||[]]);function F(O){C([...O])}return u(F,"s"),Pa(F,"handleChange"),e.props.defaultSkill?.details?.skillErrors?.on("changed",F),()=>{e.props.defaultSkill?.details?.skillErrors?.off("changed",F)}},[e]);const w=Pa(async F=>Promise.reject("Not implemented"),"getSkill"),f=Pa(()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),"uuid"),T=Ds({mutationFn:async F=>(t.current?.abort(),t.current=new AbortController,await fetch(`/api/page/builder/ai-agent/${e.props.agentId}/skill-call`,{method:"POST",body:JSON.stringify({payload:F,componentId:s?.skillId,version:"dev"}),signal:t.current?.signal,headers:{"Content-Type":"application/json","X-MONITOR-ID":window.currentMonitorId}}).then(O=>O.json()).then(O=>(console.log("setLastResponse",O),v(O),O))),mutationKey:["call_skill",s?.skillId]}),k={selectedSkill:s,setSelectedSkill:a,requests:o,setRequests:r,getSkill:w,mode:e,uuid:f,callSkillMutation:T,view:i,setView:d,lastFormValues:c,setLastFormValues:l,abortController:t,lastResponse:m,agentSkillErrors:x};return g.jsx(fd.Provider,{value:k,children:n})},"EndpointFormPreviewProvider"),Ui=Pa(()=>{const n=ue.useContext(fd);if(n===void 0)throw new Error("useEndpointFormPreview must be used within a EndpointFormPreviewProvider");return n},"useEndpointFormPreview");var J1=Object.defineProperty,vd=u((n,e)=>J1(n,"name",{value:e,configurable:!0}),"c$a");const Z1=vd(({setIsFormVisible:n})=>{const e=ue.useRef(null),{selectedSkill:t,callSkillMutation:s,setView:a,setLastFormValues:o,mode:r,agentSkillErrors:i}=Ui(),d=wf(t?.inputsTypes),c=vd(async(m,{resetForm:v})=>{n(!1),la.track("app_form_preview_run_button_click",{}),s.mutate(m,{onSuccess:()=>{mc.track("app_workflow_test_completed",{status:"success",source:"form preview"}),o(m),a("home")},onError:()=>{mc.track("app_workflow_test_completed",{status:"failed",source:"form preview"}),o(m),a("home")}})},"handleSubmit");ue.useEffect(()=>{!s.isLoading&&i.length>0&&n(!0)},[s.isLoading,i]),ue.useEffect(()=>{e.current&&e.current.focus()},[e]);const l=t?.inputsTypes.reduce((m,v)=>({...m,[v.name]:t?.autoFillDataJson?.[v.name]||""}),{});return g.jsxs("div",{children:[g.jsx(gc,{initialValues:l,validationSchema:d,onSubmit:c,enableReinitialize:!0,children:({resetForm:m,isSubmitting:v,dirty:x,setFieldValue:C,isValid:w,values:f,errors:T,handleChange:k,handleBlur:F,touched:O})=>g.jsxs(fc,{className:"flex flex-col justify-between mt-2 gap-4",children:[t?.inputsTypes.map(_=>g.jsx(Sf,{placeholder:"value",input:_,error:T[_.name]&&O[_.name]&&(console.log(O,T)||!0)&&typeof T[_.name]=="string"&&T[_.name],value:f[_.name]||"",onChange:k,onBlur:F,onFocus:M=>{const b=f[_.name],P=t?.autoFillDataJson?.[_.name];b===P&&M.target.select()},fileOps:{inputVersion:"v2",onChange:M=>{C(_.name,M)}},..._},_.name)),g.jsx("div",{className:"flex gap-3 mt-4 ",children:g.jsx(Et,{type:"submit",className:"justify-center flex-1",disabled:s.isLoading||i.length>0,btnRef:e,label:"Run",variant:"primary",fullWidth:!0,dataAttributes:{"data-test":"form-preview-run-button"}})})]})}),g.jsx("div",{className:"flex flex-col gap-2 mt-4",children:i.map(m=>g.jsx("div",{className:"text-gray-500",children:m.error_message},m.error_slug))})]})},"FormFill");var bd=Object.defineProperty,Q1=u((n,e,t)=>e in n?bd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,"g$6"),Vs=u((n,e)=>bd(n,"name",{value:e,configurable:!0}),"s$t"),ew=u((n,e,t)=>(Q1(n,typeof e!="symbol"?e+"":e,t),t),"p$7");function yd(n){return n?n.startsWith("image/")?"image":n.startsWith("audio/")?"audio":n.startsWith("video/")?"video":n.startsWith("text/")?"text":n.startsWith("application/")?"application":"other":"unknown"}u(yd,"getFileCategory"),Vs(yd,"getFileCategory"),Vs(n=>/^(https?:\/\/)([^\s.]+\.[^\s]{2,})(:[0-9]{1,5})?(\/[^\s]*)?(\?[^\s]*)?$/i.test(n),"isURL"),Vs(n=>typeof n=="object"&&n!==null&&n?.url&&"size"in n&&"mimetype"in n,"isSmythFileObject");function xd(n){try{const e=new URL(n).pathname,t=e.lastIndexOf(".");return t===-1||t===e.length-1?"":e.slice(t).toLowerCase()}catch(e){return console.error("Invalid URL:",e),""}}u(xd,"c$9"),Vs(xd,"getFileExtension");const tw=Vs(n=>{const e={".html":"text/html",".css":"text/css",".js":"application/javascript",".json":"application/json",".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".svg":"image/svg+xml",".webp":"image/webp",".bmp":"image/bmp",".tif":"image/tiff",".tiff":"image/tiff",".ico":"image/vnd.microsoft.icon",".avif":"image/avif",".heif":"image/heif",".heic":"image/heic",".mp4":"video/mp4",".mp3":"audio/mpeg",".wav":"audio/wav",".pdf":"application/pdf",".txt":"text/plain",".xml":"application/xml",".zip":"application/zip",".tar":"application/x-tar",".gz":"application/gzip"},t=xd(n);return t?{mimetype:e[t]}:{mimetype:""}},"getMimeTypeFromUrl"),nw=class{static{u(this,"o")}constructor(){ew(this,"events"),this.events={}}addEventListener(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}removeEventListener(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(s=>s!==t))}on(e,t){this.addEventListener(e,t)}off(e,t){this.removeEventListener(e,t)}emit(e,...t){this.events[e]&&this.events[e].forEach(s=>s.apply(this,t))}};Vs(nw,"EventEmitter");var sw=Object.defineProperty,Tr=u((n,e)=>sw(n,"name",{value:e,configurable:!0}),"l$a");const aw=Tr(({asset:n})=>{const[e,t]=ue.useState({isContentLoaded:!1,fileType:""}),[s,a]=ue.useState(!1),o=Tr(()=>{t({...e,isContentLoaded:!0})},"removeLoader");ue.useEffect(()=>{async function i(d){try{const c=tw(d.trim());if(!c.mimetype)return;let l=yd(c.mimetype)||"";t(m=>({...m,fileType:l}))}catch(c){console.error(c)}}u(i,"u"),Tr(i,"getFileType"),i(n)},[n]);let r;switch(e.fileType){case"image":r=g.jsx("div",{children:g.jsx("img",{src:n,className:"max-w-full m-auto rounded-lg",onError:o,onLoad:o})});break;case"audio":r=g.jsx("audio",{controls:!0,crossOrigin:"anonymous",src:n,className:"max-w-full m-auto",onError:o,onCanPlay:o});break;case"video":r=g.jsxs("video",{controls:!0,className:"max-w-full m-auto",onError:o,onCanPlay:o,children:[g.jsx("source",{src:n,type:"video/mp4"}),"Your browser does not support the video tag."]});break;case"pdf":r=g.jsx("embed",{src:n+"#toolbar=0",type:"application/pdf",className:"w-full h-[80vh]",onError:o,onLoad:o});break;default:r=g.jsx("div",{className:"text-center",children:g.jsx("a",{href:n,target:"_blank",download:!0,className:"btn btn-primary fallback-file-download-link font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Download File"})});break}return g.jsxs("div",{className:"mt-5 relative",children:[!e.isContentLoaded&&g.jsx("div",{className:"h-1 mt-1",children:g.jsx("div",{"data-role":"progress","data-type":"line","data-small":"true","data-cls-back":"bg-gray-300",className:"file-preloader h-1"})}),g.jsx("div",{className:yn("mt-4 transition-opacity duration-300",{"opacity-0":!e.isContentLoaded}),children:r}),g.jsxs("div",{className:"mt-5 relative",children:[g.jsx(vc,{name:"rawContent",type:"text",defaultValue:n,readOnly:!0,className:"text-gray-800"}),g.jsx("div",{className:yn("absolute right-2 flex gap-2 top-1/2 -translate-y-1/2"),children:g.jsx("span",{onClick:()=>{navigator.clipboard.writeText(n),a(!0)},onMouseLeave:()=>{a(!1)},className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900",children:s?g.jsx(Cf,{}):g.jsx(Af,{})})})]})]})},"PreviewableAsset");var iw=Object.defineProperty,zi=u((n,e)=>iw(n,"name",{value:e,configurable:!0}),"l$9");const ow=zi(()=>{const{callSkillMutation:n,lastFormValues:e,abortController:t,lastResponse:s,mode:a,agentSkillErrors:o}=Ui(),[r,i]=ue.useState(!1),d=ue.useRef(null),c=a.props.dbg_url;ue.useEffect(()=>{d.current&&(d.current.style.height="auto",d.current.style.height=Math.min(d.current.scrollHeight,400)+"px")},[d]);const l=zi(C=>{const w=/\b(?:https?|ftp):\/\/[^\s/$.?#].[^\s]*(?:\.(?:jpg|jpeg|png|gif|bmp|webp|svg|mp3|wav|flac|aac|mp4|mkv|mov|avi|webm|ogg|m4a|m4v|m3u8|ts|wmv))(?:\?[^\s"']*)?\b|\bsmythfs:\/\/[^\s/$.?#].[^\s"']*\b/g,f=C.match(w)?.map(T=>T.trim())?.map(T=>T.startsWith("smythfs://")?`${c}/file-proxy?url=${T}`:T)||[];return[...new Set(f)]},"extractPreviewableAssets");function m(C){return typeof C=="string"?C:JSON.stringify(C,null,2)}u(m,"c"),zi(m,"seralizeResponse");const v=ue.useMemo(()=>s?.response?l(m(s?.response)):[],[s]),x=zi(()=>{const C=new Blob([s?.response],{type:"text/plain"}),w=URL.createObjectURL(C),f=document.createElement("a");f.href=w,f.download="output.txt",f.click()},"handleDownload");return g.jsxs("div",{children:[n.isLoading&&g.jsx("button",{onClick:()=>{t.current?.abort()},className:"bg-transparent font-bold border border-gray-300 text-gray-500 px-4 py-3 rounded-md w-full mt-4",children:"Stop Testing"}),o.length>0&&g.jsx("div",{className:"flex flex-col gap-2 mt-4",children:o.map(C=>g.jsx("div",{className:"text-gray-500",children:C.error_message},C.error_slug))}),g.jsxs("div",{className:"mt-8",children:[s&&g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold",children:"Agent Output"}),g.jsx("div",{className:"text-sm",children:g.jsxs("div",{children:[v.map(C=>g.jsx(aw,{asset:C},C)),g.jsxs("div",{className:"mt-5 relative",children:[g.jsx(bc,{ref:d,readOnly:!0,className:" text-gray-800 resize-none",defaultValue:m(s?.response),rows:10}),g.jsxs("div",{className:yn("absolute right-2 flex gap-2 top-2 [&:hover_actionicons]:opacity-100"),children:[g.jsx("span",{onClick:x,className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900 opacity-50 hover:opacity-100",children:g.jsx(Ef,{})}),g.jsx("span",{onClick:()=>{navigator.clipboard.writeText(m(s?.response)),i(!0)},onMouseLeave:()=>{i(!1)},className:"cursor-pointer rounded-lg p-2 h-full flex items-center text-sm border border-solid border-gray-200 bg-gray-50 text-gray-900 opacity-50 hover:opacity-100",children:r?g.jsx(nc,{}):g.jsx(ci,{})})]})]})]})})]}),g.jsxs("div",{className:"py-4 text-gray-500",children:["Something went wrong? try"," ",g.jsx("span",{className:"font-semibold border-b border-gray-500 border-solid pb-0.5 cursor-pointer",onClick:()=>{const C=document.querySelector(".debug-switcher");C&&!C?.classList.contains("active")&&C.dispatchEvent(new Event("click",{bubbles:!0}))},children:"debugging"})," ","to fix errors."]}),n.isError&&g.jsxs("div",{children:[g.jsx("h3",{className:"font-semibold",children:"Error"}),g.jsx("div",{children:typeof n?.error?.error=="string"?n?.error?.error:"We encountered an error while processing your request. Please try again later."})]})]})]})},"ResponseView");function rw(n){return $o({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M134,32V64a6,6,0,0,1-12,0V32a6,6,0,0,1,12,0Zm39.25,56.75A6,6,0,0,0,177.5,87l22.62-22.63a6,6,0,0,0-8.48-8.48L169,78.5a6,6,0,0,0,4.24,10.25ZM224,122H192a6,6,0,0,0,0,12h32a6,6,0,0,0,0-12Zm-46.5,47A6,6,0,0,0,169,177.5l22.63,22.62a6,6,0,0,0,8.48-8.48ZM128,186a6,6,0,0,0-6,6v32a6,6,0,0,0,12,0V192A6,6,0,0,0,128,186ZM78.5,169,55.88,191.64a6,6,0,1,0,8.48,8.48L87,177.5A6,6,0,1,0,78.5,169ZM70,128a6,6,0,0,0-6-6H32a6,6,0,0,0,0,12H64A6,6,0,0,0,70,128ZM64.36,55.88a6,6,0,0,0-8.48,8.48L78.5,87A6,6,0,1,0,87,78.5Z"}}]})(n)}u(rw,"PiSpinnerLight");var lw=Object.defineProperty,cw=u((n,e)=>lw(n,"name",{value:e,configurable:!0}),"f$3");const uw=cw(({showBackButton:n=!0,onBackButtonClick:e})=>{const[t,s]=ue.useState(null),[a,o]=ue.useState(!0),[r,i]=ue.useState("auto"),d=ue.useRef(null),{selectedSkill:c,callSkillMutation:l,view:m,setView:v,abortController:x}=Ui();return ue.useEffect(()=>{i(a?"auto":0)},[a,c?.inputsTypes]),ue.useEffect(()=>{(l.isSuccess||l.isError)&&v("view_response")},[l.isSuccess,l.isError]),g.jsxs("div",{className:"home-view",children:[n&&g.jsxs("button",{onClick:e,className:"mb-4 cursor-pointer flex items-center gap-2",children:[g.jsx(kf,{className:"w-4 h-4 text-smythos-blue-500"})," Skills List"]}),g.jsxs("div",{className:yn("",m==="home"&&l.isLoading&&"hidden"),children:[g.jsxs("button",{onClick:()=>{m==="view_response"&&o(!a)},className:yn("flex items-center justify-between w-full",m!=="view_response"&&"cursor-default pointer-events-none"),children:[g.jsx("h3",{className:"font-semibold",children:"Inputs and Files"}),m==="view_response"&&g.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${a?"rotate-180":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:g.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),g.jsx("div",{ref:d,className:"transition-all duration-200 overflow-hidden",style:{height:typeof r=="number"?`${r}px`:r},children:c?.inputsTypes&&g.jsx(Z1,{setIsFormVisible:o})})]}),m==="home"&&g.jsxs("div",{children:[g.jsxs("button",{ref:s,className:yn("bg-slate-100 px-4 py-3 rounded-lg flex items-center justify-between w-full",(l.isSuccess||l.isError)&&"cursor-pointer"),onClick:()=>{(l.isSuccess||l.isError)&&v("view_response")},children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("span",{className:"icon svg-icon APIEndpoint w-6 mr-2"}),g.jsxs("div",{className:"flex flex-col",children:[g.jsx("h4",{className:"font-bold text-[#3E3E3E] text-sm",children:c.details.name}),g.jsx("p",{className:"text-gray-500 text-xs",children:c.details.description})]})]}),g.jsxs("div",{className:"flex flex-col",children:[l.isLoading&&g.jsxs("div",{className:" p-2 rounded-md flex items-center gap-2",children:[g.jsx("span",{children:"Processing..."}),g.jsx(rw,{className:"animate-spin",size:18})]}),l.isSuccess&&g.jsx("div",{className:"p-2 rounded-md flex items-center gap-2",children:g.jsx(_f,{className:"text-green-500",size:20})}),l.isError&&g.jsx("div",{className:"p-2 rounded-md flex items-center gap-2",children:g.jsx(Pf,{className:"text-red-500",size:20})})]})]},c.skillId),l.isLoading&&g.jsx("button",{onClick:()=>{x.current?.abort(),l.reset(),v("form"),o(!0)},className:"bg-transparent font-bold border border-gray-300 text-gray-500 px-4 py-3 rounded-md w-full mt-8",children:"Stop Testing"})]}),m==="view_response"&&g.jsx(ow,{})]})},"Processing");var dw=Object.defineProperty,wd=u((n,e)=>dw(n,"name",{value:e,configurable:!0}),"u$9");const pw=wd(({mode:n})=>{const e=Ui(),t=n.props.defaultSkill,[s,a]=ue.useState([]),[o,r]=ue.useState(null),[i,d]=ue.useState(!1),[c,l]=ue.useState(!0),m=ue.useCallback(w=>{d(!0);try{const f=document.getElementById(w);if(!f)throw new Error("Component element not found");const T=f.querySelector(".form-preview-button");if(!T)throw new Error("Form preview button not found");T.click()}catch(f){d(!1),console.error("Failed to trigger form preview:",f)}},[]),v=ue.useCallback(w=>{try{const f=s.find(k=>k.skillId===w)||null;r(f);const T=document.getElementById(w);if(!T)return;n.props.workspace?.scrollToComponent(T)}catch(f){console.error("Failed to scroll to skill:",f)}},[s,n.props.workspace]),x=ue.useCallback(()=>{const w=n.props.getAvailableSkills?.()||[];a(w)},[n.props.getAvailableSkills]),C=ue.useCallback(()=>{x()},[x]);return ue.useEffect(()=>{r(s?.[0]||null),s.length===1&&!e.selectedSkill&&c&&(m(s[0].skillId),l(!1))},[s,e.selectedSkill,c]),ue.useEffect(()=>(n.props.workspace?.addEventListener("AgentSaved",C),()=>{n.props.workspace?.removeEventListener("AgentSaved",C)}),[n]),ue.useEffect(()=>{e.setSelectedSkill(t?{skillId:t?.skillId,inputsTypes:t?.inputsTypes,formData:{},details:t?.details,autoFillDataJson:t?.autoFillDataJson}:null),x();const w=document.getElementById("embodiment-sidebar-title");w&&t?.details?.name&&(w.textContent=t.details.name)},[]),g.jsx("div",{className:"endpoint-form-preview-sidebar",children:i?g.jsx("div",{className:"flex justify-center items-center h-full",children:g.jsx(On,{})}):e.selectedSkill&&s.length>0?g.jsx(uw,{showBackButton:s.length>1,onBackButtonClick:()=>e.setSelectedSkill(null)}):s.length===0?g.jsx("div",{className:"text-gray-600 py-4",children:g.jsxs("p",{children:[g.jsx("b",{children:"No testable skills available."}),g.jsx("br",{}),"Please add skills to your agent and configure inputs to test."]})}):g.jsxs("div",{children:[g.jsx("p",{className:"pb-2",children:"Select one of your agent's skills from the list, then click Test."}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("select",{className:"h-9 w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal px-[10px] border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500 appearance-none cursor-pointer",value:o?.skillId,onChange:w=>v(w.target.value),children:s.map(w=>g.jsx("option",{value:w.skillId,className:"py-2",children:w.details.name},w.skillId))}),g.jsx(Et,{handleClick:()=>m(o?.skillId||""),disabled:!o,children:"Test"})]})]})})},"FormPreviewSidebar");function Sd({mode:n}){return g.jsx(X1,{mode:n,children:g.jsx(If,{initialEntries:["/home"],initialIndex:0,children:g.jsx(pw,{mode:n})})})}u(Sd,"A$8"),wd(Sd,"EndpointFormPreviewSidebar");var hw=Object.defineProperty,Ia=u((n,e)=>hw(n,"name",{value:e,configurable:!0}),"a$q");const mw=Ia(n=>{if(!n)return{props:{},style:{}};const e=n.style?n.style.split(";").reduce((s,a)=>{const[o,r]=a.split(":").map(i=>i.trim());if(o&&r){const i=o.replace(/-([a-z])/g,d=>d[1].toUpperCase());s[i]=r}return s},{}):{},t={...n};return delete t.style,{props:t,style:e}},"processAttributes"),Cd=Ia(({fieldId:n,fieldConfig:e,formikProps:t})=>{const s=ue.useRef(null),{handleChange:a,handleBlur:o,setFieldValue:r,values:i,errors:d,touched:c}=t,{props:l,style:m}=mw(e.attributes),{events:v}=e;ue.useEffect(()=>{v&&s.current&&Object.entries(v).forEach(([T,k])=>{console.log("Adding event listener",T,k),s.current.addEventListener(T,k)})},[v]);const x={id:n,name:n,onChange:a,onBlur:o,color:c[n]&&d[n]?"failure":void 0,style:m,...l},C=Ia(()=>g.jsx("div",{className:yn("mb-2 block"),children:g.jsx(Lf,{htmlFor:n,value:e.label||n,children:e.help&&g.jsx("span",{className:"ml-1 text-sm text-gray-500",title:e.help,children:"\u24D8"})})}),"renderLabel"),w=Ia(()=>g.jsx(Tf,{name:n,component:"div",className:"mt-1 text-sm text-red-500"}),"renderError"),f=Ia(T=>g.jsxs("div",{className:yn("mb-4",e.class,"form-box"),"data-field-name":n,children:[C(),T,w()]},n),"renderInputWrapper");switch(e.type){case"textarea":return f(g.jsx(bc,{...x,value:i[n]?.toString()??"",rows:4,className:yn("resize-y"),ref:s}));case"select":return f(g.jsx(Of,{...x,value:i[n]?.toString()??"",ref:s,children:e.options?.map(T=>g.jsx("option",{value:T.value,children:T.text},T.value))}));case"checkbox":return f(g.jsx(jf,{...x,checked:!!i[n],onChange:T=>r(n,T.target.checked),ref:s}));case"color":return f(g.jsx("input",{type:"color",...x,value:i[n]?.toString()??"#000000",className:yn("h-[38px] w-full rounded-lg"),ref:s}));default:return f(g.jsx(vc,{...x,value:i[n]?.toString()??"",type:e.type,ref:s}))}},"RenderField");var gw=Object.defineProperty,Ws=u((n,e)=>gw(n,"name",{value:e,configurable:!0}),"a$p");function Ad({config:n,onSubmit:e}){Ws(d=>{if(!d)return{props:{},style:{}};const c=d.style?d.style.split(";").reduce((m,v)=>{const[x,C]=v.split(":").map(w=>w.trim());if(x&&C){const w=x.replace(/-([a-z])/g,f=>f[1].toUpperCase());m[w]=C}return m},{}):{},l={...d};return delete l.style,{props:l,style:c}},"processAttributes");const t=Ws(d=>{const c={};return Object.entries(d).forEach(([l,m])=>{let v=Df();switch((m.validate==="required"||m.required)&&(v=v.required(m.validateMessage||`${m.label||l} is required`)),m.type){case"checkbox":v=Mf();break;case"color":v=gi().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,"Invalid color format");break;default:v=gi()}c[l]=v}),dc().shape(c)},"generateValidationSchema"),s=Ws(d=>Object.entries(d).reduce((c,[l,m])=>({...c,[l]:m.value??""}),{}),"generateInitialValues"),a=Ws(async(d,{setSubmitting:c})=>{try{e?.(d)}catch(l){console.error("Form submission error:",l),Je("An error occurred while submitting the form")}finally{c(!1)}},"handleSubmit");if(Ws((d,c,l)=>g.jsx(Cd,{fieldId:d,fieldConfig:c,formikProps:l}),"renderField"),!n.fields)return null;const o=t(n.fields),r=s(n.fields),i=Object.entries(n.fields).reduce((d,[c,l])=>{const m=l.section||"Default";return d[m]||(d[m]=[]),d[m].push({id:c,config:l}),d},{});return g.jsx(Mo,{onClose:()=>e?.(null),title:n.title,panelWrapperClasses:"lg:w-[35vw] md:w-[40vw]",applyMaxWidth:!1,children:g.jsxs("div",{className:"p-4",children:[n.content&&g.jsx("div",{className:"mb-4",children:n.content}),g.jsx(gc,{initialValues:r,validationSchema:o,onSubmit:a,children:d=>g.jsxs(fc,{className:"space-y-4",children:[Object.entries(i).map(([c,l])=>g.jsxs("div",{className:"space-y-4",children:[c!=="Default"&&g.jsx("h3",{className:"text-lg font-medium text-gray-900",children:c}),l.map(({id:m,config:v})=>g.jsx(Cd,{fieldId:m,fieldConfig:v,formikProps:d},m))]},c)),g.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[g.jsx(yc,{color:"gray",onClick:()=>e?.(null),type:"button",children:"Cancel"}),g.jsx(yc,{type:"submit",className:"bg-primary-100",disabled:d.isSubmitting||!d.isValid,children:n.btnSaveLabel||"Save"})]})]})})]})})}u(Ad,"ComponentInputEditor"),Ws(Ad,"ComponentInputEditor");var fw=Object.defineProperty,Ed=u((n,e)=>fw(n,"name",{value:e,configurable:!0}),"c$8");function kd(){const[n,e]=ue.useState(!1),[t,s]=ue.useState(!1),[a,o]=ue.useState("desktop");return ue.useEffect(()=>{const r=Ed(()=>{const i=navigator.userAgent.toLowerCase(),d=window.innerWidth,c=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(i)||d<768,l=(/ipad/i.test(i)||d>=768&&d<1024)&&!/mobile/i.test(i);e(c&&!l),s(l),o(c&&!l?"mobile":l?"tablet":"desktop")},"checkDevice");return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),{isMobile:n,isTablet:t,deviceType:a}}u(kd,"useDeviceDetection"),Ed(kd,"useDeviceDetection");var vw=Object.defineProperty,La=u((n,e)=>vw(n,"name",{value:e,configurable:!0}),"o$l");function _d({platformName:n="AI Agent Builder",showDismissOption:e=!0}){const{isMobile:t,isTablet:s,deviceType:a}=kd(),[o,r]=ue.useState(!1),[i,d]=ue.useState(!1),c=La(()=>{i&&localStorage.setItem("mobile-warning-dismissed","true"),r(!0)},"handleContinueAnyway");if(ue.useEffect(()=>{localStorage.getItem("mobile-warning-dismissed")==="true"&&r(!0)},[]),!t&&!s||o)return null;const l=La(()=>{switch(a){case"mobile":return g.jsx(qb,{className:"h-8 w-8 text-[#3C89F9]"});case"tablet":return g.jsx(Bb,{className:"h-8 w-8 text-[#3C89F9]"});default:return g.jsx(Yc,{className:"h-8 w-8 text-[#3C89F9]"})}},"getDeviceIcon"),m=La(()=>"Mobile Experience Limited","getTitle"),v=La(()=>"Our drag-and-drop AI agent builder works best on desktop. Mobile access is view-only.","getDescription");return g.jsx("div",{className:"fixed inset-0 z-[2000] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:g.jsxs(Nf,{className:"w-full max-w-md mx-auto shadow-2xl border-0 bg-white",children:[g.jsxs($f,{className:"text-center pb-4",children:[g.jsx("div",{className:"flex justify-center mb-4",children:l()}),g.jsx(Ff,{className:"text-[18px] font-semibold text-gray-900 font-inter",children:m()}),g.jsx(Rf,{className:"text-gray-600 leading-relaxed text-[14px] font-inter font-normal",children:v()})]}),g.jsxs(qf,{className:"space-y-4",children:[g.jsxs(Bf,{className:"border-blue-200 bg-blue-50 flex gap-2",children:[g.jsx(Uf,{color:"#1E40AF",className:"h-4 w-4"}),g.jsx(zf,{className:"text-[#1E40AF] text-[14px] font-inter font-normal",children:"For the best experience, we recommend using a desktop computer with a screen width of at least 1024px."})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs(hs,{className:"w-full bg-[#3C89F9] hover:bg-[#2B7CE9] text-white text-[14px] font-inter font-normal",onClick:()=>{navigator.clipboard.writeText(window.location.href).then(()=>{$t("Link copied! Share this with your desktop device.","Success")}).catch(()=>{Jn("Please manually select and copy the link.","Failed to copy")})},children:[g.jsx(Yc,{className:"mr-2 h-4 w-4"}),"Copy Link for Desktop",g.jsx(Fb,{className:"ml-2 h-4 w-4"})]}),g.jsxs(hs,{variant:"outline",className:"w-full bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 text-[14px] font-inter font-normal rounded-lg",onClick:()=>{const x=encodeURIComponent(`${n} - Open on Desktop`),C=encodeURIComponent(`Open this link on your desktop computer: ${window.location.href}`),w=`mailto:?subject=${x}&body=${C}`;window.open(w,"_self")||(window.location.href=w)},children:[g.jsx(Rb,{className:"mr-2 h-4 w-4"}),"Email Link to Myself"]}),e&&g.jsx(hs,{variant:"outline",className:"w-full bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 text-[14px] font-inter font-normal rounded-lg",onClick:c,children:"Continue Anyway"})]}),g.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[g.jsx(Gf,{id:"do-not-show-again",checked:i,onCheckedChange:x=>d(x),className:"data-[state=checked]:bg-[#3C89F9] data-[state=checked]:border-[#3C89F9] data-[state=checked]:text-[#FFFF]"}),g.jsx("label",{htmlFor:"do-not-show-again",className:"text-[14px] font-inter font-normal text-gray-600 cursor-pointer",children:"Do not show this message again"})]}),g.jsx("div",{className:"text-center",children:g.jsxs("p",{className:"text-xs text-gray-500 font-inter font-normal",children:["Need help? Visit our"," ",g.jsx("a",{href:Ft,className:"text-[#3C89F9] hover:underline",children:"documentation"})," ","or"," ",g.jsx("a",{href:"https://discord.gg/smythos",className:"text-[#3C89F9] hover:underline",children:"contact support"})]})})]})]})})}u(_d,"MobileHandler"),La(_d,"MobileHandler");var bw=Object.defineProperty,Gi=u((n,e)=>bw(n,"name",{value:e,configurable:!0}),"r$p");const yw=Gi(({iframeUrl:n,renderTrigger:e,iframeTitle:t="Tutorial"})=>{const s=ue.useRef(null),[a,o]=ue.useState(!1),[r,i]=ue.useState("100%");ue.useEffect(()=>{const l=Gi(m=>{if(m.origin==="https://app.arcade.software")try{const v=typeof m.data=="string"?JSON.parse(m.data):m.data;v.context==="iframe.resize"&&v.height>0&&i(`${v.height}px`),v.event==="arcade-popout-close"&&o(!1),v.event==="arcade-popout-open"&&o(!0)}catch{}},"handleMessage");return window.addEventListener("message",l),()=>window.removeEventListener("message",l)},[]);const d=Gi(()=>{o(!0);const l=s.current;l?.contentWindow&&l.contentWindow.postMessage({event:"request-popout-open"},"https://app.arcade.software")},"onClickArcadeTrigger"),c=Gi(()=>{o(!1)},"handleClose");return g.jsxs(g.Fragment,{children:[e(d),a&&g.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:99999,display:"flex",justifyContent:"center",alignItems:"center"},onClick:c,children:g.jsxs("div",{style:{position:"relative",width:"90%",maxWidth:"1200px",height:"90vh",backgroundColor:"white",borderRadius:"8px",overflow:"hidden"},onClick:l=>l.stopPropagation(),children:[g.jsx("iframe",{ref:s,src:n,title:t,frameBorder:"0",loading:"lazy",allowFullScreen:!0,allow:"clipboard-write",style:{width:"100%",height:"100%",border:"none",colorScheme:"light"}}),g.jsx("button",{onClick:c,style:{position:"absolute",top:"10px",right:"10px",background:"white",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"\u2715"})]})})]})},"ArcadeTutorial");var xw=Object.defineProperty,Lt=u((n,e)=>xw(n,"name",{value:e,configurable:!0}),"r$o");const ww="modal-root";let Pd;Lt(()=>{Pd||(Pd=kn(document.getElementById(ww)))},"ensureGlobalModalRoot");const Sw=Lt(n=>{const e=Lt((s="modal")=>`${s}-${Math.random().toString(36).substring(2,9)}`,"generateId"),t=document.createElement("div");return t.id=n||e(),document.body.appendChild(t),{root:kn(t),id:t.id}},"createOneTimeRoot");function Cw({rootID:n}){const e=kn(document.getElementById(n)),t=window.workspace;e.render(g.jsx(Xx,{workspace:t}))}u(Cw,"renderDebugLogContainer"),Lt(Cw,"renderDebugLogContainer");function Aw({rootID:n}){const e=window.workspace;kn(document.getElementById(n)).render(g.jsx(da,{client:Ms,children:g.jsx(Ar,{children:g.jsx(xc,{children:g.jsx(K1,{workspace:e})})})}))}u(Aw,"renderAgentDeploymentSidebar"),Lt(Aw,"renderAgentDeploymentSidebar");async function Id({config:n}){const{root:e,id:t}=Sw(),s=Lt(()=>{e.unmount();const a=document.getElementById(t);a&&a.remove()},"cleanup");return new Promise(a=>{e.render(g.jsx(Ad,{config:n,onSubmit:o=>{s(),console.log(o),a(o)}}))})}u(Id,"renderComponentInputEditor"),Lt(Id,"renderComponentInputEditor");function jr({rootID:n,skill:e}){const t=kn(document.getElementById(n)),s=window.workspace;t.render(g.jsx(da,{client:Ms,children:g.jsx(Sd,{mode:{name:"in-builder",props:{defaultSkill:e,workspace:s,agentId:s.agent.id,dbg_url:s.serverData.dbgUrl,getAvailableSkills:()=>s.agent?.data?.components?.filter(a=>a.name==="APIEndpoint"&&a.inputs?.length>0)?.map(a=>({skillId:a.id,details:{name:a.title||""}}))||[]}}})}))}u(jr,"renderEndpointFormPreviewSidebar"),Lt(jr,"renderEndpointFormPreviewSidebar");function Or({rootID:n}){const e=window.workspace;kn(document.getElementById(n)).render(g.jsx(da,{client:Ms,children:g.jsx(Ar,{children:g.jsx(xc,{children:g.jsx(hc,{workspace:e,workspaceAgentId:e.agent.id,children:g.jsx(Hf,{})})})})}))}u(Or,"renderAgentSettingsSidebar"),Lt(Or,"renderAgentSettingsSidebar");function Ew({rootID:n}){const e=kn(document.getElementById(n));function t(){const[s,a]=ue.useState(!1),o=ue.useRef(null),r=Lt(()=>{a(!1),o.current?.setAttribute("result","cancelled")},"cancelRestore");return g.jsxs(g.Fragment,{children:[g.jsx("button",{id:"self-contained-restore-modal-btn",className:"hidden",onClick:()=>a(!0),ref:o,children:"Restore"}),s&&g.jsx(wc,{label:"Restore Version",message:"Restore this version?",onClose:r,handleConfirm:Lt(()=>{a(!1),o.current?.setAttribute("result","confirmed")},"confirmRestore"),handleCancel:r,lowMsg:"Are you sure you want to restore this to a previous version? Any unsaved changes will be lost."})]})}u(t,"o"),Lt(t,"RestoreModal"),e.render(g.jsx(t,{}))}u(Ew,"renderConfirmDialogModals"),Lt(Ew,"renderConfirmDialogModals");function kw({rootID:n}){const e=window.workspace,t=document.getElementById(n);if(!t){console.error(`Root element with ID "${n}" not found`);return}function s(){const[r,i]=ue.useState(!1),d=ra(),c=Er(),l=document.getElementById("share-agent-button-topbar");return l&&(l.disabled=!d?.userInfo),ue.useEffect(()=>{const m=document.getElementById("share-agent-button-topbar");m&&(d?.userInfo?m.removeAttribute("disabled"):m.setAttribute("disabled","true"))},[d?.userInfo]),g.jsxs(g.Fragment,{children:[c.isShareAgentModalOpen&&!d?.userInfo&&g.jsx("div",{className:"fixed flex inset-0 bg-black bg-opacity-50 justify-center items-center w-full h-full",children:g.jsx(On,{})}),c?.isShareAgentModalOpen&&g.jsx("div",{className:"fixed inset-0",children:g.jsx(Vf,{isShareAgent:!0,onClose:()=>c.toggleShareAgentModal(),agentId:e.agent.id,agentName:e.agent.name})}),r&&g.jsx("div",{className:"fixed inset-0",children:g.jsx(wc,{onClose:()=>i(!1),label:"Confirm",message:"Unauthorized",lowMsg:`You do not have permission to share this agent. Contact ${d?.userInfo?.teamMembers?.filter(m=>m.userTeamRole?.isTeamInitiator)[0]?.email||"your team admin"} to request access.`,handleConfirm:()=>i(!1),handleCancel:()=>i(!1),hideCancel:!0})})]})}u(s,"s"),Lt(s,"ShareButtonContent");function a(){const r=Er(),i=ra(),d=qi(),[c,l]=ue.useState(0);return ue.useEffect(()=>{r.isDeployModalOpen?!i?.userInfo||!d?.allDeployments?.data?l(1):r.isDeployModalOpen&&i?.userInfo&&d?.allDeployments?.data&&l(2):l(0)},[r.isDeployModalOpen,i?.userInfo,d?.allDeployments?.data]),g.jsxs(g.Fragment,{children:[c===1&&g.jsx("div",{className:"fixed flex inset-0 bg-black bg-opacity-50 justify-center items-center w-full h-full",children:g.jsx(On,{})}),c===2&&g.jsx(ld,{userInfo:i.userInfo,deploymentSidebarCtx:d})]})}u(a,"i"),Lt(a,"ModalsContent");function o(){return g.jsx(da,{client:Ms,children:g.jsx(Ar,{children:g.jsxs(id,{workspace:e,children:[g.jsx(a,{}),g.jsx(s,{})]})})})}u(o,"l"),Lt(o,"ModalsContainer"),kn(t).render(g.jsx(o,{}))}u(kw,"renderAgentModals"),Lt(kw,"renderAgentModals");let Hi=null;function _w(n,e){if(!document.getElementById("modal-root")){const t=document.createElement("div");t.id="modal-root",document.body.appendChild(t)}return Hi||(Hi=kn(document.getElementById("modal-root")||document.createElement("div"))),Hi.render(g.jsx(yw,{iframeUrl:n,iframeTitle:e,renderTrigger:t=>g.jsx("div",{style:{display:"none"},onClick:t})})),setTimeout(()=>{const t=document.querySelector('#modal-root div[style*="display: none"]');t&&t.click()},100),Hi}u(_w,"renderArcadeTutorial"),Lt(_w,"renderArcadeTutorial");function Pw({rootID:n}){const e=document.getElementById(n);if(!e){console.error("Mobile handler container not found");return}kn(e).render(g.jsx(_d,{platformName:"AI Agent Builder",showDismissOption:!0}))}u(Pw,"renderMobileHandler"),Lt(Pw,"renderMobileHandler");function Iw(n){return $o({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"path",attr:{d:"M12 16v-4"}},{tag:"path",attr:{d:"M12 8h.01"}}]})(n)}u(Iw,"LuInfo");var Lw=Object.defineProperty,rn=u((n,e)=>Lw(n,"name",{value:e,configurable:!0}),"r$n");const Tw=rn(({agentId:n,workspace:e})=>{const{getPageAccess:t,loading:s}=ra(),a=t("/builder",!1),[o,r]=ue.useState(!1),i=lc(),d=ue.useRef([]),c=ue.useRef(null),[l,m]=ue.useState([{key:"",value:""}]),[v,x]=ue.useState(null),[C,w]=ue.useState(null),[f,T]=ue.useState(!1),[k,F]=ue.useState({name:"",key:""}),[O,_]=ue.useState({}),[M,b]=ue.useState(!1),[P,L]=ue.useState(!1),[N,z]=ue.useState([]),[I,W]=ue.useState(!1),{data:B,isSuccess:K,isLoading:q}=Yn({queryKey:["agent_data_settings"],queryFn:()=>Wf(n),cacheTime:0,staleTime:0,refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!1,retry:!1}),{data:X}=Yn({queryKey:["vaultKeys"],queryFn:async()=>(await fetch("/api/page/builder/keys?fields=name,scope&excludeScope=global,AgentLLM")).json(),staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,onError:()=>{Je("Failed to load vault keys")}}),Q=X?.data||{},V=Ds({mutationFn:async pe=>{const fe=await fetch("/api/page/builder/keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)});if(!fe.ok)throw new Error("Failed to save key");return fe.json()},onSuccess:async()=>{await i.invalidateQueries({queryKey:["vaultKeys"]});const pe=k.name,fe=C;if(T(!1),F({name:"",key:""}),fe!==null){const me=[...l];me[fe]={...me[fe],value:`{{KEY(${pe})}}`,error:!1},m(me)}x(null)},onError:()=>{Je("Failed to save key. Please try again.")},onSettled:()=>{L(!1)}}),J=Ds({mutationFn:async({variables:pe,lockId:fe})=>{const me=await fetch("/api/agent",{method:"POST",body:JSON.stringify({...B,data:{...B?.data,variables:pe},id:n,lockId:fe}),headers:{"Content-Type":"application/json"}});if(!me.ok)throw new Error("Failed to save variables");return me.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["agent",n]})},onError:()=>{Je("Failed to update agent variables. Please try again.")},onSettled:async(pe,fe,me)=>{await Kf(n,me.lockId).catch(we=>console.error(we))}}),A=rn((pe,fe,me)=>{const we=[...l];we[pe]={...we[pe],[fe]:me,error:!1},pe===l.length-1&&me!==""&&(we.push({key:"",value:""}),d.current=[...d.current,null]),m(we),W(JSON.stringify(we)!==JSON.stringify(N)),fe==="value"&&ne(d.current[pe],document.activeElement===d.current[pe])},"handleInputChange"),j=rn((pe,fe)=>{pe?.stopPropagation();const me=l.filter((we,_e)=>_e!==fe);me.length===0&&me.push({key:"",value:""}),m(me),W(JSON.stringify(me)!==JSON.stringify(N))},"handleDelete"),S=rn((pe,fe)=>{A(pe,"value",`{{KEY(${fe})}}`),x(null)},"handleVaultKeySelect"),U=rn(()=>{T(!0),F({name:"",key:""}),_({}),x(null);const pe=setTimeout(()=>{c.current&&c.current?.scrollIntoView({behavior:"smooth",block:"center"}),clearTimeout(pe)},0)},"handleAddKeyClick"),G=rn(()=>{const pe={};return k.name.trim()?Object.values(Q).some(fe=>fe.name===k.name.trim())&&(pe.name="Key name already exists"):pe.name="Name is required",k.key.trim()?k.key.length>1e4&&(pe.key="Key length cannot exceed 10,000 characters"):pe.key="Key is required",_(pe),Object.keys(pe).length===0},"validateNewKey"),Y=rn(async()=>{G()&&(L(!0),V.mutate({keyName:k.name,key:k.key,scope:["ALL_NON_GLOBAL_KEYS"]}))},"handleSaveKey"),se=rn(async()=>{let pe=!1;const fe=l.map((me,we)=>{if(me.key===""&&me.value==="")return me;const _e=me.key===""&&me.value!==""||me.key!==""&&me.value==="",je=me.key!==""&&l.some((qe,Me)=>Me!==we&&qe.key===me.key),Pe=_e||je;return pe=pe||Pe,console.log("error",Pe),{...me,error:Pe}});if(m(fe),!pe){b(!0);try{const me=l.filter(_e=>_e.key!==""&&_e.value!=="");let we={};me.forEach(_e=>{we[_e.key]=_e.value}),await le(we),z(l),W(!1)}catch(me){console.error(me)}finally{b(!1)}}},"handleSave");async function le(pe){if(!(q||!K||!B||!B.data))try{if(e)try{e.agent.data.variables=pe,await e.saveAgent(void 0,void 0,e.agent.data),W(!1)}catch(fe){console.error(fe)}finally{}else{const fe=await Yf(n);await J.mutateAsync({variables:pe,lockId:fe.lockId}),W(!1)}$t("Variables saved successfully")}catch(fe){fe.errKey===Xf.AGENT_LOCK_FAIL?Je("Failed to update agent variables as the agent is being edited by another user. Please try again later."):Je("Failed to update agent variables. Please try again.")}}u(le,"de"),rn(le,"handleVariablesSave");const ne=rn((pe,fe)=>{if(pe){if(!fe){pe.style.height="40px";return}pe.style.height="40px",pe.style.height=`${Math.max(40,pe.scrollHeight)}px`}},"adjustTextareaHeight"),he=rn(()=>{const pe=e.domElement.querySelector(".agent-settings-button");pe&&pe?.click()},"handleClose");return ue.useEffect(()=>{const pe=rn(fe=>{const me=fe.target;me.closest("#vault-key-button")||v!==null&&!me.closest(".vault-keys-dropdown")&&x(null)},"handleClickOutside");return v!==null&&document.addEventListener("mousedown",pe,!0),()=>{document.removeEventListener("mousedown",pe,!0)}},[v]),ue.useEffect(()=>{if(K&&B?.data){const pe=B?.data,fe=Object.entries(pe.variables||{}).map(([me,we])=>({key:me,value:String(we)})).concat([{key:"",value:""}]);m(fe),z(fe)}},[K,B?.data]),ue.useEffect(()=>{function pe(fe){r(fe.detail.writeAccess)}return u(pe,"e"),rn(pe,"handleWidgetAccess"),window.addEventListener("update-widget-access",pe),r(a?.write),document.querySelector("#workspace-container")?.classList.contains("locked")&&r(!1),()=>{window.removeEventListener("update-widget-access",pe)}},[a?.write]),s?g.jsx("div",{className:"bg-[#F3F4F6] mt-3 p-4 rounded-xl border border-solid border-gray-200 flex items-center justify-center",children:g.jsx(On,{})}):g.jsxs(Jf,{title:"",isWriteAccess:o,hasBorder:!1,showOverflow:!0,children:[g.jsxs("div",{className:"bg-[#FFFF] text-[#5A5A5A] p-4 rounded-xl border border-solid border-gray-200",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("h2",{className:"text-base font-semibold flex items-center",children:[g.jsx(Zf,{className:"mr-2"})," Global Variables"]}),g.jsxs("div",{id:"variables-widget-actions",className:`flex gap-3  ${o?"opacity-100":"opacity-0"}`,children:[g.jsx(bn,{content:g.jsx("div",{style:{minWidth:"300px"},children:"The Agent Variables you declare here can be accessed and used across all components. These variables act like global variables throughout your AI agent."}),placement:"top",children:g.jsx(Iw,{size:20})}),g.jsx(bn,{content:"Close",placement:"top",children:g.jsx(sc,{className:"cursor-pointer",size:22,onClick:pe=>{pe?.stopPropagation(),he()}})})]})]}),g.jsx("p",{className:"text-sm mb-4",children:"Define reusable values to use across your workflow."}),g.jsx("div",{className:"space-y-2",children:l.map((pe,fe)=>g.jsxs("div",{className:"flex gap-2 group relative",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsx("input",{type:"text",placeholder:"Key",value:pe.key,onChange:me=>A(fe,"key",me.target.value),className:`w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal ${pe.error?"!border-smyth-red focus:border-smyth-red":"border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500"}`}),fe<l.length-1&&g.jsx("button",{onClick:me=>j(me,fe),className:"absolute right-2 top-3.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-gray-500 hover:text-red-500",type:"button","aria-label":"Delete variable",children:g.jsx(bn,{content:g.jsx("div",{style:{width:"120px"},children:"Delete Variable"}),placement:"top",children:g.jsx(Qf,{className:"text-red-500"})})})]}),g.jsxs("div",{className:"relative w-1/2",children:[g.jsxs("div",{className:"relative",children:[g.jsx("textarea",{ref:me=>d.current[fe]=me,placeholder:"Value",value:pe.value,onChange:me=>A(fe,"value",me.target.value),onFocus:me=>ne(me.target,!0),onBlur:me=>ne(me.target,!1),className:`w-full bg-white border text-gray-900 rounded block outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none text-sm font-normal placeholder:text-sm placeholder:font-normal ${pe.error?"!border-smyth-red focus:border-smyth-red":"border-gray-300 border-b-gray-500 focus:border-b-2 focus:border-b-blue-500 focus-visible:border-b-2 focus-visible:border-b-blue-500"} pr-10`,style:{height:"40px",minHeight:"40px",lineHeight:"1.25rem"}}),g.jsx("button",{onClick:()=>{x(fe),w(fe)},className:"absolute right-2 top-0 bottom-0 my-auto h-7 w-7 hover:bg-gray-100 rounded flex items-center justify-center",type:"button",id:"vault-key-button",children:g.jsx(ev,{className:"text-[#424242]  scale-x-[-1]"})}),g.jsx("div",{className:"absolute bottom-[7px] left-2 w-[calc(100%-16px)] h-1 bg-white"})]}),v===fe&&g.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-md shadow-lg vault-keys-dropdown",children:g.jsx("ul",{className:"max-h-[200px] overflow-y-auto",onWheel:me=>{me.stopPropagation()},children:Object.entries(Q).length>0?g.jsxs(g.Fragment,{children:[Object.entries(Q).map(([me,we])=>g.jsx("li",{className:"px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer",onClick:()=>S(fe,we.name),children:we.name},me)),g.jsx("li",{className:"border-t",children:g.jsx("button",{className:"w-full text-left text-sm px-4 py-2 text-blue-500 hover:bg-gray-100",onClick:U,children:"Add Key"})})]}):g.jsx("li",{children:g.jsx("button",{className:"w-full text-left px-4 py-2 text-blue-500 hover:bg-gray-100",onClick:U,children:"Add Key"})})})})]})]},fe))}),I&&g.jsx("div",{className:"flex justify-end mt-4",children:g.jsx(Et,{label:"Save",variant:"primary",handleClick:se,disabled:M,addIcon:M,Icon:g.jsx(On,{classes:"w-4 h-4 mr-2"})})})]}),f&&g.jsx("div",{ref:c,className:"mt-4 flex items-center justify-center rounded-lg border border-solid border-gray-200",children:g.jsxs("div",{className:"bg-[#FFFF] text-[#5A5A5A] rounded-xl p-6 w-full max-w-md modal-content",children:[g.jsx("h2",{className:"text-base font-semibold mb-4",children:"Save Key to the Vault"}),g.jsx("div",{className:"mb-4",children:g.jsx(nn,{label:"Name",required:!0,value:k.name,onChange:pe=>F({...k,name:pe.target.value}),error:!!O.name,errorMessage:O.name,fullWidth:!0})}),g.jsx("div",{className:"mb-4",children:g.jsx(nn,{label:"Key",required:!0,value:k.key,onChange:pe=>F({...k,key:pe.target.value}),error:!!O.key,errorMessage:O.key,fullWidth:!0})}),g.jsxs("div",{className:"flex justify-end gap-3",children:[g.jsx(Et,{label:"Cancel",variant:"secondary",handleClick:pe=>{pe?.stopPropagation(),T(!1)}}),g.jsx(Et,{label:"Save",variant:"primary",handleClick:Y,disabled:P,addIcon:P,Icon:g.jsx(On,{classes:"w-4 h-4 mr-2"})})]})]})})]})},"VariablesWidget");var jw=Object.defineProperty,Vi=u((n,e)=>jw(n,"name",{value:e,configurable:!0}),"g$4");const Ld={},Dr=class Xa extends pa{static{u(this,"u")}constructor(e,t={data:{},top:"20px",left:"20px",width:"",height:"",uid:null},s={}){super(),this.workspace=e,this.properties=t,this.configuration=s,this.settings={},this.data={},this.drawSettings={cssClass:"agent-card",shortDescription:"",color:"#3B82F6"},this._destroyed=!1,this.variablesPlaceholder=null,this.variablesReactRoot=null,this.isVariablesComponentMounted=!1,this.skills=[],this._init_state_populated=!1,this._uid=this.properties.uid||"A"+Dn(),this.properties||(this.properties={top:"",left:""}),this.data=this.properties.data||{},this.prepare().then(this.init.bind(this)).then(()=>{this.redraw().then(()=>{this.handleSkillsConnections(this.configuration).then(()=>{this._init_state_populated=!0}),this.workspace.addEventListener("componentAdded",a=>{a.displayName==="APIEndpoint"&&this.handleCompConn(a.uid)})})}).catch(a=>{console.error("Error initializing agent card:",a)}),Ld[this.uid]=this}get uid(){return this._uid}async prepare(){return Promise.resolve()}async init(){return Promise.resolve()}async redraw(){const e=this.workspace,t=document.createElement("div");t.className=`agent-card exclude-panzoom ${this.drawSettings.cssClass||""}`,t.id=`agent-card-${this._uid}`,t.style.position="absolute",t.style.left=this.properties.left||"20px",t.style.top=this.properties.top||"20px",this.properties.width&&(t.style.width=this.properties.width),this.properties.height&&(t.style.height=this.properties.height);let s=null;const a=document.querySelector("#agent-avatar");a?s=a.src:(s=window.sessionStorage.getItem(`agent-avatar-${this.workspace.agent?.id}`),window.sessionStorage.removeItem(`agent-avatar-${this.workspace.agent?.id}`));const o=document.createElement("div");o.className="agent-card-content";const r=document.createElement("div");r.className="agent-image-container";const i=document.createElement("img");i.src=s||"",i.alt="Agent",i.className=`agent-image ${s?"":"hidden"}`,i.id="agent-card-avatar",r.appendChild(i);const d=document.createElement("div");d.id="agent-card-avatar-placeholder",d.className=`h-full w-full flex items-center justify-center bg-uipink rounded-[7px]  w-8 h-8 flex items-center justify-center text-white font-medium truncate ${s?"hidden":""}`,d.style.fontSize="77px",setTimeout(()=>{d.textContent=this.workspace.agent?.data?.name?.charAt(0)||document.querySelector(".agent-avatar-placeholder-topbar")?.textContent||""},200),r.appendChild(d);const c=document.createElement("div");c.className="agent-info";const l=document.createElement("div");l.className="agent-header";const m=document.createElement("div"),v=document.createElement("h2");v.className="agent-name",setTimeout(()=>{v.textContent=this.workspace.agent?.data?.name||""},200),m.appendChild(v);const x=document.createElement("div");x.className="p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors cursor-pointer menu-button",x.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="1"></circle>
        <circle cx="12" cy="5" r="1"></circle>
        <circle cx="12" cy="19" r="1"></circle>
      </svg>
    `,l.appendChild(m),l.appendChild(x),c.appendChild(l);const C=document.createElement("div");C.className="agent-actions py-2";const w=document.createElement("div");w.className="ep-control inputs justify-self-end flex items-center ";const f=document.createElement("span");f.className="text-[#5A5A5A] font-medium pr-2",f.textContent="Add skill",w.appendChild(f);const T=document.createElement("button");T.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",T.id="add-skill-button",T.style.fontSize="20px",T.textContent="+",w.appendChild(T);const k=document.createElement("div");k.className="flex justify-self-end mt-2 agent-card-connection",k.setAttribute("smt-name","Skills"),k.setAttribute("smt-color","#3C89F9");const F=document.createElement("span");F.className="name",F.style.borderImage="linear-gradient(90deg, transparent 20%, rgb(60, 137, 249)) 1 / 1 / 0 stretch",F.innerHTML='<span class="label text-gray-500"># Skills</span>',k.appendChild(F);const O=document.createElement("span");O.className="block absolute ep w-[15px] h-[15px] rounded-full -right-[23px] float-left border-0 top-1/2 -translate-y-1/2",O.style.backgroundColor="#3C89F9",k.appendChild(O);const _=document.createElement("div");_.className="preview-button-container flex items-center gap-2 bg-[#F5F5F5] rounded-lg p-1 pl-2 border border-[#EDE8E8]";const M=document.createElement("button");M.className="agent-settings-button flex items-center justify-center hover:bg-[#D3D3D3] rounded-lg p-1",M.innerHTML=`
     <svg xmlns="http://www.w3.org/2000/svg" width="28" height="27" viewBox="0 0 17 16" fill="none">
      <path d="M5.41467 3.44531C2.1001 3.44531 5.41467 8.00267 2.1001 8.00267C5.41467 8.00267 2.1001 12.5601 5.41467 12.5601" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M7.13867 6.26562L9.43354 9.37743" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M9.43354 6.26562L7.13867 9.37743" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M10.7856 3.44531C14.1002 3.44531 10.7856 8.00267 14.1002 8.00267C10.7856 8.00267 14.1002 12.5601 10.7856 12.5601" stroke="#424242" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    `,new iu(M,{text:"Global Variables",position:"top",showWhen:"hover"});const b=document.createElement("button");b.className="preview-button w-full bg-white rounded border border-[#C7C7C7]",b.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 13 12" fill="none">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M9.99811 9.27993C9.08886 10.3587 7.81286 10.8942 6.53776 10.8898C6.09116 10.8878 4.10195 10.8893 2.92807 10.8898C2.57878 10.8898 2.37251 10.4998 2.56662 10.2089C2.6751 10.0453 2.81424 9.84668 2.92418 9.69193C3.03364 9.53673 3.04337 9.33318 2.94851 9.16818C2.78164 8.87823 2.53354 8.43698 2.46883 8.27638C1.69825 6.60503 1.99549 4.56074 3.37077 3.1808C5.25248 1.29273 8.39416 1.42793 10.0949 3.58644C11.4016 5.24413 11.3583 7.66618 9.99811 9.27993Z" stroke="#3C89F9" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Preview as Chatbot</span>
    `,_.appendChild(M),_.appendChild(b),C.appendChild(w),C.appendChild(k),c.appendChild(C),c.appendChild(_),o.appendChild(r),o.appendChild(c),await $e(50);const P=this.workspace.jsPlumbInstance.addEndpoint(k,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:-1,cssClass:"exclude-panzoom"});k.endpoint=P,P._domElement=k;const L=document.createElement("div");L.id=`agent-card-variables-placeholder-${this._uid}`,L.className="hidden agent-card-variables",t.appendChild(L),t.appendChild(o),this.domElement=t,this.variablesPlaceholder=L,t._control=this,e.domElement.appendChild(t),this.makeDraggable(),this.addEventListeners(),this.emit("AgentCardCreated")}makeDraggable(){const e=this.workspace,t=this;Qn(this.domElement).draggable({allowFrom:".agent-card",ignoreFrom:".agent-name",listeners:{start(s){if(e?.locked)return!1;t.domElement.classList.add("dragging"),t.domElement.style.cursor="grabbing"},move(s){if(e?.locked)return!1;if(!s.target)return;let a=[s.target];for(let o of a){const r=(parseFloat(o.style.left)||0)+s.dx/e.scale,i=(parseFloat(o.style.top)||0)+s.dy/e.scale;o.style.left=r+"px",o.style.top=i+"px",o._control.repaint()}},end(s){if(e?.locked)return!1;t.repaint(!0),t.domElement.style.cursor="",setTimeout(()=>{t.workspace.saveAgent(),t.domElement.classList.remove("dragging")},200)}},inertia:!0}).styleCursor(!1)}mountVariablesComponent(){this.variablesPlaceholder&&(this.variablesPlaceholder.classList.remove("hidden"),this.variablesReactRoot=tv.createRoot(this.variablesPlaceholder),this.variablesReactRoot.render(at.createElement(da,{client:Ms},at.createElement(Tw,{agentId:this.workspace.agent?.id,workspace:this.workspace}))),this.isVariablesComponentMounted=!0)}unmountVariablesComponent(){this.variablesReactRoot&&(this.variablesReactRoot.unmount(),this.variablesReactRoot=null,this.variablesPlaceholder&&this.variablesPlaceholder.classList.add("hidden"),this.isVariablesComponentMounted=!1)}addEventListeners(){const e=this.domElement.querySelector("#add-skill-button");e&&e.addEventListener("click",async o=>{o.stopPropagation();const r=this.workspace.agent?.data?.components?.filter(m=>m.name==="APIEndpoint");if(r.length===0){const m=this.domElement.getBoundingClientRect(),v=await this.workspace.addComponent("APIEndpoint",{top:Number(this.properties.top.split("px")[0])+m.height+100+"px",left:Number(this.properties.left.split("px")[0])+m.width+450+"px"},!0);this.workspace.scrollToComponent(v),this.workspace.refreshComponentSelection(v);return}const i=r.reduce((m,v)=>Number(m.top.split("px")[0]||0)<Number(v.top.split("px")[0]||0)?v:m),d=document.querySelector(`#${i.id}`);let c;if(d){const m=d.getBoundingClientRect();c=Number(i.top.split("px")[0])+m.height+200+"px"}else c=Number(i.top.split("px")[0])+400+"px";const l=await this.workspace.addComponent("APIEndpoint",{top:c,left:i.left},!0);this.workspace.scrollToComponent(l),this.workspace.refreshComponentSelection(l)});const t=this.domElement.querySelector(".agent-settings-button");t&&t.addEventListener("click",o=>{o.stopPropagation(),this.isVariablesComponentMounted?this.variablesPlaceholder.classList.toggle("hidden"):this.mountVariablesComponent(),this.workspace.jsPlumbInstance.revalidate(this.domElement)}),this.domElement.addEventListener("click",o=>{o.stopPropagation();const r=o.target;r.closest(`#agent-card-variables-placeholder-${this._uid}`)||r.closest(".vault-keys-dropdown")||(nv(),Or({rootID:"agent-settings-in-right-sidebar-root"}))});const s=this.domElement.querySelector(".preview-button");s&&s.addEventListener("click",o=>{o.stopPropagation(),Ct.track("app_preview_as_chatbot_click");const r=document.querySelector("#btn-emb-chatbot-main");!document.querySelector("#right-container.open #embodiment-sidebar:not(.hidden)")&&r&&r?.click();const i=document.querySelector("[data-embodiment-type='chat']");i&&i?.click()});const a=this.domElement.querySelector(".agent-name");this.domElement.addEventListener("mousedown",o=>{o.stopPropagation()}),this.workspace.addEventListener("AgentSaved",()=>{a&&this.workspace.agent?.data?.name!=a.textContent&&(a.textContent=this.workspace.agent?.data?.name||""),document.querySelector("#agent-card-avatar"),document.querySelector("#agent-card-avatar-placeholder")}),this.workspace.agent.addEventListener("AvatarUpdated",o=>{const r=document.querySelector("#agent-card-avatar");r&&(r.src=o)})}makeAgentNameEditable(e){}destroy(){this._destroyed||(this.isVariablesComponentMounted&&this.unmountVariablesComponent(),this.domElement&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),delete Ld[this.uid],this._destroyed=!0)}async repaint(e=!1){if(e){let t=[...this.domElement.querySelectorAll(".endpoint")].map(s=>s?.endpoint?.connections).flat(1/0);t=[...new Set(t)],t.forEach(s=>{this.workspace.updateConnectionStyle(s)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async handleSkillsConnections(e){const t=e?.components?.filter(s=>s.name==="APIEndpoint");if(t)for(const s of t)await this.handleCompConn(s.id)}async handleCompConn(e){const t=document.querySelector(".agent-card .agent-card-connection");if(!t)return;const s=document.querySelector(`#${e} `);if(!s)return;const a=Vi(()=>{const d=s.querySelector(".agent-card-connection");d&&this.workspace.jsPlumbInstance.getConnections({source:t.id,target:d.id}).length===0&&this.workspace.jsPlumbInstance.connect({source:t.endpoint,target:d.endpoint,detachable:!0,cssClass:"exclude-panzoom",paintStyle:Xa.connPaintStyles})},"connect"),o=Vi(()=>{const d=s.querySelector(".agent-card-connection");d&&this.workspace.jsPlumbInstance.getConnections({source:t.id,target:d.id}).forEach(c=>{this.workspace.jsPlumbInstance.deleteConnection(c)})},"disconnect");if(!s._control)return;const r=Vi(d=>{d?.ai_exposed?a():o()},"handleSettingsChange").bind(this),i=o.bind(this);s._control.removeEventListener("settingsSaved",r),s._control.removeEventListener("settingsDraftUpdated",r),s._control.removeEventListener("beforeDelete",i),s._control.addEventListener("settingsSaved",r),s._control.addEventListener("settingsDraftUpdated",r),s._control.addEventListener("beforeDelete",i),s._control.data.ai_exposed?a():o(),s._control.addEventListener("connectionDetached",async(d,c,l)=>{this._init_state_populated&&l.source.classList.contains("agent-card-connection")&&(s._control.data.ai_exposed=!1,await $e(100),this.workspace.saveAgent())}),s._control.addEventListener("connectionAttached",async(d,c,l)=>{this._init_state_populated&&l.source.classList.contains("agent-card-connection")&&(s._control.data.ai_exposed=!0,await $e(100),this.workspace.saveAgent())})}static checkConnValidity(e){return!e.target.classList.contains("agent-card-connection")&&e.source.classList.contains("agent-card-connection")||!e.source.classList.contains("agent-card-connection")&&e.target.classList.contains("agent-card-connection")?(Xn("Unsupported Connection",'You can only connect skill components directly to the agent. Please add a skill component first and then connect it to the agent card. <a href="https://smythos.com/documentation/#/" target="_blank" class="text-v2-blue underline hover:text-v2-blue/80">Read documentation</a>.',"OK","error"),!1):!0}static setConnPaintStyles(e){e.__smt_color=Xa.connPaintStyles.stroke,e.__smt_dashstyle=Xa.connPaintStyles.dashstyle,e.__smt_thickness=Xa.connPaintStyles.strokeWidth}static isCardConn(e){return e.source.classList.contains("agent-card-connection")}};Vi(Dr,"AgentCard"),Dr.connPaintStyles={stroke:"#8F8F8F",strokeWidth:2,dashstyle:"4 4"};let Ta=Dr;var Ow=Object.defineProperty,Dw=u((n,e)=>Ow(n,"name",{value:e,configurable:!0}),"l$8");const Mw="same-as-parent",Td=class extends Ue{static{u(this,"n")}async prepare(){this.id=this.data?.id||this.properties.sender?.getAttribute("smt-id")||"",this.name=this.data?.name||this.properties.sender?.querySelector(".name")?.textContent||"",this.desc=this.data?.desc||this.properties.sender?.getAttribute("smt-desc")||"",this.descForModel=this.data?.descForModel||this.properties.sender?.getAttribute("smt-desc-for-model")||"",this.logoUrl=this.data?.logoUrl||this.properties.sender?.querySelector("img")?.src||"";const e=[{value:"same-as-parent",text:"Same as Parent"},{value:"dev-latest",text:"Dev"},{value:"prod-latest",text:"Prod Latest"}];this.versions=e;const t=ct.prepareModelSelectOptionsByFeatures(["tools"]);this.defaultModel=ct.getDefaultModel(t);const s=this.data?.model||this.data?.openAiModel||this.defaultModel;if(s&&![...t.map(a=>a?.value||a)].includes(s)){let a=Dt("Removed","text-smyth-red-500 border-smyth-red-500");s==="gpt-4-0613"&&(a+=Dt("alias of gpt-4","text-gray-500 border-gray-500")),t.push({text:s+"&nbsp;&nbsp",value:s,badge:a})}return this.modelOptions=t.filter(a=>a),!0}async init(){this.settings={model:{type:"select",label:"Model",options:this.modelOptions,value:this.defaultModel,dropdownHeight:350,actions:[{label:"Configure more models",icons:{left:{svg:ha,classes:"mr-2"},right:{svg:ma,classes:"absolute right-4"}},position:"after-dropdown",id:"configureMoreModelsBtn",classes:"custom_model_add_btn",events:{click:()=>{window.open("/vault","_blank")}}}]},version:{type:"select",label:"Version",options:this.versions,value:Mw},descForModel:{type:"textarea",label:"Description for Model",value:this.descForModel,attributes:{"data-template-vars":"true"}},agentId:{type:"hidden",value:this.id}};let e=["model","version","descForModel","agentId"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.drawSettings.addOutputButton="+ out",this.drawSettings.addInputButton="+ in",this.properties.defaultInputs=["Prompt"],this.properties.defaultOutputs=["Response"],this.drawSettings.displayName=this.name||this.constructor.name,this.drawSettings.shortDescription=this.desc||"",this.drawSettings.iconCSSClass="",this._ready=!0}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this));const e=this.properties.data?.logoUrl;Mn.call(this,e)}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this),e.querySelector("#model"))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}redraw(e=!0){const t=super.redraw(e),s=t.querySelector(".internal-name");return s.innerHTML=`<span class="internal-name-prefix agentplugin">Sub-agent </span>${this.drawSettings.displayName}`,this.domElement.querySelector(".title-bar img")?.remove(),this.data={...this.data,id:this.id,name:this.name,desc:this.desc,descForModel:this.descForModel,logoUrl:this.logoUrl},Mn.call(this,this.logoUrl),t}async updateVersions(){const e=fetch(`/api/page/builder/ai-agent/${this.id}/deployments`),t=fetch(`/api/page/builder/ai-agent/${this.workspace.agent.id}/deployments`),[s,a]=await Promise.all([e,t]),o=await s.json(),r=await a.json();let i=o.deployments.length>0;const d=r.deployments.length>0;let c=o.deployments.map(m=>m.version),l=[];c?.length&&(c=["prod-latest",...c],ga.set(sv,{[this.id]:c}),l=c.map(m=>m==="prod-latest"?{value:m,text:"Prod Latest"}:{value:m,text:`Prod v${m}`})),l.unshift({value:"dev-latest",text:"Dev"}),d&&!i||l.unshift({value:"same-as-parent",text:"Same as Parent"}),this.settings.version.options=l,this.settings.version.loading=!1,this.settingsOpen&&this.refreshSettingsSidebar()}};Dw(Td,"AgentPlugin");let Nw=Td;var $w=Object.defineProperty,Wi=u((n,e)=>$w(n,"name",{value:e,configurable:!0}),"A$6");const Fw=8192,jd=class extends Ue{static{u(this,"L")}constructor(){super(...arguments),this.templateSupport=!0,this.eventTriggersActually=!1,this.boundHandleAuthMessage=this.handleAuthMessage.bind(this),this.boundHandleFocusAfterAuth=this.handleFocusAfterAuth.bind(this)}async init(){this.settings={method:{type:"select",label:"Method",options:["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],value:"GET",validate:"required",help:`The Method field defines the type of HTTP request your API call will use\u2014such as GET to retrieve data, POST to create, or DELETE to remove. <br /><a style="color: #3b82f6;text-decoration: underline;" href="${Ft}/agent-studio/components/advanced/api-call" target="_blank">See full method guide \u2192</a>`,hintPosition:"bottom",tooltipClasses:"w-64",arrowClasses:"-ml-11"},url:{type:"input",label:"URL",validate:`required maxlength=${Fw} custom=isUrlValid`,validateMessage:"Provide a valid URL",attributes:{"data-template-vars":"true"},cls:"pr-4",help:`Configure the URL field using static or dynamic values for flexibility. Use query (?key={{value}}) and path parameters ({{url}}/segment) to adapt endpoints. <br /><a style="color: #3b82f6;text-decoration: underline;" href="${Ft}/agent-studio/components/advanced/api-call" target="_blank">See URL configuration guide \u2192</a>`,hintPosition:"bottom",tooltipClasses:"w-64",arrowClasses:"-ml-15",actions:[{label:"",icon:"fa-regular fa-pen-to-square",id:"editQueryParams",events:{click:av.bind(this,{showVault:!0,vaultScope:sn.apiCall})}}]},headers:{type:"textarea",label:"Headers",readonly:!0,help:`Headers pass essential metadata like Content-Type and authentication details. <br />Edit them in the API component settings to match your API\u2019s requirements. <br /><a style="color: #3b82f6;text-decoration: underline;" href="${Ft}/agent-studio/components/advanced/api-call" target="_blank">See headers guide \u2192</a>`,tooltipClasses:"w-64",arrowClasses:"-ml-13",validate:"custom=isValidJson",validateMessage:"Provide a Valid JSON with non-empty keys",actions:[{label:"",icon:"fa-regular fa-pen-to-square",id:"editHeaders",events:{click:Ro.bind(this,"headers",{showVault:!0,vaultScope:sn.apiCall})}}]},contentType:{type:"select",label:"Content-Type",help:`The Content-Type header specifies the format of the data in the request body\u2014e.g., application/json, multipart/form-data, or text/plain. Choose the type that matches your API's requirements. <br /><a style="color: #3b82f6;text-decoration: underline;" href="${Ft}/agent-studio/components/advanced/api-call" target="_blank">See Content-Type guide \u2192</a>`,tooltipClasses:"w-64",arrowClasses:"-ml-5",options:["none","application/json","multipart/form-data","binary","application/x-www-form-urlencoded","text/plain","application/xml"],value:"none",events:{change:a=>this.handleBodyEditButtons()}},body:{type:"textarea",label:"Body",attributes:{"data-template-vars":"true","data-vault":`${sn.apiCall},All`},help:`Body contains data sent to the server. SmythOS dynamically adapts content based on selected Content-Type and allows integration of variables from other components. <br /><a style="color: #3b82f6;text-decoration: underline;" href="${Ft}/agent-studio/components/advanced/api-call" target="_blank">See Body guide \u2192</a>`,tooltipClasses:"w-64",arrowClasses:"-ml-17",actions:[{label:"",icon:"fa-regular fa-pen-to-square",id:"bodyEditBtn",events:{click:Ro.bind(this,"body",{showVault:!0,vaultScope:sn.apiCall})}}]},oauthService:{type:"select",label:"Authentication Service",section:"OAuth",sectionHelp:"SmythOS supports OAuth 2.0 with OpenID Connect (OIDC) for secure user authentication and authorization.",sectionTooltipClasses:"w-64 ml-12",sectionArrowClasses:"-ml-11",options:["None","Google","Twitter","LinkedIn","Custom OAuth2.0","Custom OAuth1.0","OAuth2 Client Credentials"],value:"None",events:{change:a=>this.handleServiceChange(a.target.value)}},scope:{type:"textarea",label:"Scopes *",section:"OAuth",value:""},authorizationURL:{type:"input",label:"Authorization URL (OAuth2.0) *",section:"OAuth",value:""},tokenURL:{type:"input",label:"Token URL (OAuth2.0) *",section:"OAuth",value:""},clientID:{type:"input",label:"Client ID *",section:"OAuth",value:"",attributes:{"data-vault":`${sn.apiCall},All`}},clientSecret:{type:"input",label:"Client Secret *",section:"OAuth",value:"",attributes:{"data-vault":`${sn.apiCall},All`}},oauth2CallbackURL:{type:"div",html:"Callback URL (OAuth2.0)<br /><br /><span></span>",label:"Callback URL (OAuth2.0)",section:"OAuth"},requestTokenURL:{type:"input",label:"Request Token URL (OAuth1.0) *",section:"OAuth",value:""},accessTokenURL:{type:"input",label:"Access Token URL (OAuth1.0) *",section:"OAuth",value:""},userAuthorizationURL:{type:"input",label:"User Authorization URL (OAuth1.0) *",section:"OAuth",value:""},consumerKey:{type:"input",label:"Consumer Key (OAuth1.0) *",section:"OAuth",value:"",attributes:{"data-vault":"APICall, All"}},consumerSecret:{type:"input",label:"Consumer Secret (OAuth1.0) *",section:"OAuth",value:"",attributes:{"data-vault":"APICall, All"}},oauth1CallbackURL:{type:"div",html:"Callback URL (OAuth1.0)<br /><br /><span></span>",label:"Callback URL (OAuth1.0)",section:"OAuth"},authenticate:{type:"button",label:"Authenticate",section:"OAuth",attributes:{},events:{click:a=>a.target.innerText==="Sign Out"?this.signOutFunction(a.target):this.collectAndConsoleOAuthValues(a)}},proxy:{type:"textarea",label:"Proxy URLs",section:"Advanced",validateMessage:`Enter your proxy URLs in the following format:<br/>
                [scheme]://[username]:[password]@[host]:[port]<br/><br/>
                For multiple URLs, place each one in a new line.<br/><br/>
                Example:<br/>
                http://user:pass@proxyserver-one.com:8080<br/>
                socks5://proxyserver-two.com:1080`,hintPosition:"left",attributes:{"data-template-vars":"true","data-vault":`${sn.apiCall},All`}}};for(let a of iv)typeof this.data[a]>"u"&&(this.data[a]=this.settings[a]?.value);this.properties.template&&!this.data._templateVars&&(this.data._templateVars={}),this.inputSettings={...this.inputSettings,isFile:{type:"boolean",editConfig:{type:"checkbox",label:"Binary Input",value:!1,cls:"hidden"}}},this.properties.defaultInputs=[],this.properties.defaultOutputs=["Response","Headers"],this.drawSettings.componentDescription="Effortlessly Connect to Any API Endpoint";const e=this.properties.template?.templateInfo?.icon||"",t=this.properties.template?.templateInfo?.color||"#000000",s=e&&e.startsWith("<svg");this.drawSettings.iconCSSClass=e?`tpl-fa-icon ${e}`:`svg-icon ${this.constructor.name}`,s&&(this.drawSettings.iconCSSClass=e),this.drawSettings.color=e?t:"#00BCD4",this.drawSettings.showSettings=!0}exportTemplate(){let e=JSON.parse(JSON.stringify(this.data));const t=e.url?e.url.replace(/\+/g," "):"";let s=decodeURIComponent(t);const a={};s=this.parseTemplateString(s,a),e.url=s;let o=JSON.parse(e.headers||"{}");for(let d in o){let c=o[d];typeof c=="string"&&(c=this.parseTemplateString(c,a)),o[d]=c}e.headers=JSON.stringify(o),e.body=e.body||"",e.body=this.parseTemplateString(e.body,a),e.proxy=this.parseTemplateString(e.proxy,a);const r=this.properties.inputProps,i=this.properties.outputProps;return{name:this.title,componentName:this.constructor.name,description:this.description,settings:a,data:e,inputs:r,outputs:i}}handleServiceChange(e){const t=this.getSettingsSidebar();if(!t)return"";let s=["authorizationURL","tokenURL","clientID","clientSecret","oauth2CallbackURL","scope"],a=["requestTokenURL","accessTokenURL","userAuthorizationURL","consumerKey","consumerSecret","oauth1CallbackURL"];function o(x){x.forEach(C=>{const w=t.querySelector(`[data-field-name="${C}"] input`),f=t.querySelector(`[data-field-name="${C}"] textarea`);w&&(w.value=""),f&&(f.value="")})}u(o,"n"),Wi(o,"clearFieldsForNewSelection");function r(x,C){x.forEach(w=>{const f=t.querySelector(`[data-field-name="${w}"]`);f&&(f.style.display=C?"block":"none")})}u(r,"i"),Wi(r,"toggleFieldsVisibility");function i(x,C,w){x.forEach(f=>{const T=t.querySelector(`[data-field-name="${f}"] input`),k=t.querySelector(`[data-field-name="${f}"] textarea`);T&&(w||T.value==="")&&(T.value=C[f]??""),k&&(w||k.value==="")&&(k.value=C[f]??"")})}u(i,"l"),Wi(i,"prefillFields");const d=["Google","LinkedIn","Custom OAuth2.0","OAuth2 Client Credentials"].includes(e);let c=d?[...s]:a;e==="OAuth2 Client Credentials"&&(c=c.filter(x=>!["authorizationURL","oauth2CallbackURL","scope"].includes(x)),s=c,a=["authorizationURL","oauth2CallbackURL","scope",...a]);const l=this.data.oauthService!==e;l&&o([...a,...s]);const m=!d&&e!=="None";if(r(s,d),r(a,m),!this.eventTriggersActually&&this.data.oauthService===e)i(c,this.data,!1);else if(this.eventTriggersActually&&this.data.oauthService===e)i(c,this.data,l);else if(l){let x=this.updateConfiguration(e,t);x&&i(Object.keys(x),x,!0)}this.eventTriggersActually=!0;const v=t?.querySelector('[data-field-name="authenticate"] button');v&&v.innerText==="Sign Out"?setTimeout(async()=>{this.activateSpinner(v),await this.signOutFunction(v)},0):v.innerHTML="Authenticate"}mapSelectedService(e){return{"OAuth2 Client Credentials":"oauth2_client_credentials","Custom OAuth1.0":"oauth1","Custom OAuth2.0":"oauth2",Google:"google",LinkedIn:"linkedin",Twitter:"twitter"}[e]||e.toLowerCase()}async collectAndConsoleOAuthValues(e){const t=this.data.oauthService;if(t==="None")return Je("You did not select any Authentication Service"),console.log("No OAuth service selected.");const{isValid:s,missingFields:a}=await this.validateOAuthConfiguration();if(!s){const w=/([a-z])([A-Z])/g,f=a.map(T=>T.replace(w,"$1 $2").toLowerCase()).join(", ");Je(`Please configure the following fields: ${f}`);return}const{cbUrl:o,service:r,key:i,isOAuth1:d}=this.getOAuthCallbackDetails(t);let c=[...d?["requestTokenURL","accessTokenURL","userAuthorizationURL","consumerKey","consumerSecret","oauth1CallbackURL"]:[],...d?[]:["authorizationURL","tokenURL","clientID","clientSecret","oauth2CallbackURL"],"scope"];t==="OAuth2 Client Credentials"&&(c=c.filter(w=>!["authorizationURL","oauth2CallbackURL","scope"].includes(w)));let l=[],m=[],v=c?.reduce((w,f)=>{const T=this.data[f];return T||l?.push(f),["requestTokenURL","accessTokenURL","userAuthorizationURL","authorizationURL"].includes(f)&&T&&!this.isValidUrl(T)&&m.push(f),{...w,[f]:T}},{});if(l.length>0){const w=d&&l.length===1&&l[0]==="scope",f=l.length===1&&(l.includes("oauth2CallbackURL")||l.includes("oauth1CallbackURL"));if(!w&&!f){const T=["oauth2CallbackURL","oauth1CallbackURL",...d?["scope"]:[]],k=l.filter(F=>!T.includes(F)).join(", ");if(k)return Je(`Please fill in the following fields: ${k}`),console.log(`Error: The following fields are empty: ${k}`)}}if(m.length>0){const w=m.join(", ");return Je(`The following fields do not contain valid URLs: ${w}`),console.log(`Error: The following fields have invalid URLs: ${w}`)}t!=="OAuth2 Client Credentials"&&(v[i]=o);const x=`${this.workspace.server}/oauth/${t==="OAuth2 Client Credentials"?"client_credentials":"init"}`,C={oauth_keys_prefix:`OAUTH_${this.uid}`,service:r,...v};this.activateSpinner(e.target),document.addEventListener("visibilitychange",this.boundHandleFocusAfterAuth);try{const w=await(await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).json();w.authUrl?(window.open(w.authUrl,"_blank"),window.addEventListener("message",this.boundHandleAuthMessage,!1)):"success"in w?(w.success?$t(w.message):Je(w.message),w.success&&this.updateSidebarForOAuth(),await this.updateButtonAndRemoveFocusListener()):(console.error("Authentication URL was not returned from the server."),Je("Authentication URL was not returned from the server."),await this.updateButtonAndRemoveFocusListener())}catch(w){Je(`Authentication Failed: ${w?.message||w}`),console.error("Error:",w),await this.updateButtonAndRemoveFocusListener()}}handleAuthMessage(e){if(e?.origin!==window?.location?.origin)return Je("Message origin does not match the current origin."),console.error("Message origin does not match the current origin.");switch(e.data?.type){case"oauth2":case"oauth":console.log("Authentication was successful"),$t(`${e.data.type} authentication was successful`),this.updateSidebarForOAuth(),window.removeEventListener("message",this.boundHandleAuthMessage);break;case"error":e.data?.data?.message&&Je(`Authentication failed. Recheck your configuration. ${e?.data?.data?.message}`);break;default:console.warn("Unhandled message type:",e.data?.type);break}}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}async checkAuthentication(){const e=this.data.oauthService;if(e==="None")return!0;const{cbUrl:t,key:s,service:a,isOAuth1:o}=this.getOAuthCallbackDetails(e);let r=[...o?["requestTokenURL","accessTokenURL","userAuthorizationURL","consumerKey","consumerSecret","oauth1CallbackURL"]:[],...o?[]:["authorizationURL","tokenURL","clientID","clientSecret","oauth2CallbackURL"],"scope"];e==="OAuth2 Client Credentials"&&(r=r.filter(c=>!["authorizationURL","oauth2CallbackURL","scope"].includes(c)));let i=r.reduce((c,l)=>{const m=this.data[l];return{...c,[l]:m}},{});e==="OAuth2 Client Credentials"?i.service="oauth2_client_credentials":i[s]=t;const d={oauth_keys_prefix:`OAUTH_${this.uid}`,...i};try{const c=await fetch(`${this.workspace.server}/oauth/checkAuth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);try{return(await c.json()).success}catch(l){return console.error("Failed to parse JSON response:",l),!1}}catch(c){return console.error("Error during fetching or network issue:",c),!1}}updateConfiguration(e,t){if(e==="OAuth2 Client Credentials")return null;const{cbUrl:s,key:a}=this.getOAuthCallbackDetails(e);return t.querySelector(`[data-field-name="${a}"] span`).innerHTML=s,{Google:{authorizationURL:"https://accounts.google.com/o/oauth2/v2/auth",tokenURL:"https://oauth2.googleapis.com/token",scope:"https://www.googleapis.com/auth/gmail.readonly",oauth2CallbackURL:s},Twitter:{requestTokenURL:"https://api.twitter.com/oauth/request_token",accessTokenURL:"https://api.twitter.com/oauth/access_token",userAuthorizationURL:"https://api.twitter.com/oauth/authorize",oauth1CallbackURL:s},LinkedIn:{authorizationURL:"https://www.linkedin.com/oauth/v2/authorization",tokenURL:"https://www.linkedin.com/oauth/v2/accessToken",scope:"r_liteprofile r_emailaddress",oauth2CallbackURL:s}}[e]}isOAuth1(e){const t=["twitter"],s=e?.toLowerCase();return t.includes(s)||s.includes("oauth1.0")}getOAuthCallbackDetails(e){const t=this.workspace.serverData.frontUrl,s=this.isOAuth1(e),a=this.mapSelectedService(e);return{cbUrl:`${t}/oauth/${a}/callback`,key:s?"oauth1CallbackURL":"oauth2CallbackURL",isOAuth1:s,service:a}}async run(){this.addEventListener("settingsOpened",async(e,t)=>{t==this&&(this.eventTriggersActually=!1,this.handleBodyEditButtons(e),await this.addRightSidebarFunction(e))})}async handleBodyEditButtons(e){e||(e=this.getSettingsSidebar()),await $e(50);const t=e.querySelector("#body"),s=t?.closest(".form-group"),a=s?.lastElementChild;a&&a.classList.contains("template-var-buttons")&&a.remove();const o=s?.querySelector("#bodyEditBtn"),r=s?.querySelector(".vault-action-btn"),i=e.querySelector("#contentType"),d=i?.value||this.data.contentType,c=i?.closest(".select.smt-input-select");o&&(d==="multipart/form-data"||d==="application/x-www-form-urlencoded"?(o.style.display="inline-block",t.setAttribute("readonly","")):(o.style.display="none",t.removeAttribute("readonly"),t.focus())),r&&(d==="application/json"?r.style.display="inline-block":r.style.display="none"),setTimeout(()=>{if(d==="application/json"){Sc(t,!0);const l=e?.querySelector("#ace-editor-styles");l&&(l.style.minHeight="80px !important"),d!==this.data.contentType&&(t.value="",this.data.body="")}else Sc(t,!1),ov(t),t.classList.remove("hidden");c&&c.classList.contains("focused")&&d!==this.data.contentType&&(t.value="",t?._editor?.setValue(""),this.data.body=""),this.data.contentType=d},150)}async addRightSidebarFunction(e){this.setCallbackUrl(e)}async setCallbackUrl(e){if(e?.querySelector('div[data-name="OAuth"]')){const t=this?.data?.oauthService;if(t&&this.data.oauthService!=="None"){if(this.data.oauthService!=="OAuth2 Client Credentials"){const{cbUrl:s,key:a}=this.getOAuthCallbackDetails(t),o=e.querySelector(`[data-field-name="${a}"] span`);o&&(o.innerHTML=s)}if(await this.checkAuthentication()){const s=e?.querySelector('[data-field-name="authenticate"] button');s&&(s.innerHTML="Sign Out")}}}else setTimeout(this.setCallbackUrl,20)}validateOAuth2Fields(e){const t=["authorizationURL","tokenURL","clientID","clientSecret","scope"].filter(a=>!e[a]),s=["authorizationURL","tokenURL"].filter(a=>e[a]&&!this.isValidUrl(e[a])).map(a=>`${a} (invalid URL)`);return{isValid:t.length===0&&s.length===0,missingFields:[...t,...s]}}validateOAuth1Fields(e){const t=["requestTokenURL","accessTokenURL","userAuthorizationURL","consumerKey","consumerSecret"].filter(a=>!e[a]),s=["requestTokenURL","accessTokenURL","userAuthorizationURL"].filter(a=>e[a]&&!this.isValidUrl(e[a])).map(a=>`${a} (invalid URL)`);return{isValid:t.length===0&&s.length===0,missingFields:[...t,...s]}}validateOAuth2ClientCredentialsFields(e){const t=["tokenURL","clientID","clientSecret"].filter(a=>!e[a]),s=["tokenURL"].filter(a=>e[a]&&!this.isValidUrl(e[a])).map(a=>`${a} (invalid URL)`);return{isValid:t.length===0&&s.length===0,missingFields:[...t,...s]}}async validateOAuthConfiguration(){const e=this.data.oauthService;if(e==="None")return{isValid:!0,missingFields:[]};const t={...this.data},s=["clientID","clientSecret","consumerKey","consumerSecret"];let a=!1;const{data:o}=await Cc({scope:void 0}),r=Object.values(o);for(const i of s){const d=t[i];if((await this.checkVaultKeys(d,r))?.missingKeys?.size>0){a=!0;break}}return a?{isValid:!1,missingFields:[]}:["Google","LinkedIn"].includes(e)&&!t.scope?{isValid:!1,missingFields:["scope"]}:e==="OAuth2 Client Credentials"?this.validateOAuth2ClientCredentialsFields(t):this.isOAuth1(e)?this.validateOAuth1Fields(t):this.validateOAuth2Fields(t)}async checkSettings(){this.clearComponentMessages(),this.addComponentMessage("Checking Auth Info...","info text-center");const e=await this.checkAuthentication();await super.checkSettings();const{isValid:t}=await this.validateOAuthConfiguration(),s=this.domElement?.querySelector("button.oauthButton");!e&&t&&this.data.oauthService!=="None"&&!s&&this.addComponentButton('<div class="fa-solid fa-user-shield"></div><p class="">Authenticate</p>',"warning",{class:"oauthButton"},this.collectAndConsoleOAuthValues.bind(this))}async signOutFunction(e){this.activateSpinner(e);const t=this.getSettingsSidebar();if(!t)return"";const s=t?.querySelector('[data-field-name="authenticate"] button'),a={oauth_keys_prefix:`OAUTH_${this.uid}_TOKENS`,invalidateAuthentication:!0};try{const o=await fetch(`${this.workspace.server}/oauth/signOut`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=await o.json();if(s)if(e.disabled=!1,r.invalidate){if(s.innerHTML="Authenticate",t?.querySelector('div[data-field-name="body"]')){let i=t?.querySelector("#oauthMessageSpan");i&&i.remove()}r.message&&r.message!==""&&$t(`${r.message}`)}else s.innerHTML="Sign Out",Je(`${r.error}`)}catch(o){Je("Error during fetching or network issue"),console.error("Error during fetching or network issue:",o),s.innerHTML="Sign Out",e.disabled=!1}}updateSidebarForOAuth(){this.checkSettings();const e=this.getSettingsSidebar();if(!e)return"";const t=e?.querySelector('div[data-field-name="body"]'),s=e?.querySelector('[data-field-name="authenticate"] button');if(s&&(s.innerHTML="Sign Out"),t){const a="oauthMessageSpan";let o=e?.querySelector(`#${a}`);o&&o.remove();const r=document.createElement("small");r.id=a,r.className="p-2 mt-1 mb-0 text-green-500",r.textContent="OAuth Enabled, Authentication headers will be injected at runtime.",t.parentNode.insertBefore(r,t.nextSibling)}}async updateAuthenticationButton(){const e=this.getSettingsSidebar(),t=await this.checkAuthentication();if(e){const a=e?.querySelector('[data-field-name="authenticate"] button');a&&(a.disabled=!1,t?a.innerHTML="Sign Out":a.innerHTML="Authenticate")}const s=this.domElement?.querySelector("button.oauthButton");s&&(s.disabled=!1,t||(s.innerHTML='<div class="fa-solid fa-user-shield"></div><p class="">Authenticate</p>'))}async handleFocusAfterAuth(){document.visibilityState==="visible"&&this.updateButtonAndRemoveFocusListener()}async updateButtonAndRemoveFocusListener(){await this.updateAuthenticationButton(),document.removeEventListener("visibilitychange",this.boundHandleFocusAfterAuth)}activateSpinner(e){e.innerHTML='<span class="oauth-spinner smyth-spinner"></span>&nbsp;&nbsp;In Progress ...',e.disabled=!0}};Wi(jd,"APICall");let Rw=jd;var qw=Object.defineProperty,As=u((n,e)=>qw(n,"name",{value:e,configurable:!0}),"m$3");const Mr=As(n=>`<strong>Internal Name:</strong> <span style="word-break: break-all; font-size: 12px; font-weight: normal; text-transform: none;">${n}</span>`,"getEndpointFinalURL"),Ki=As(n=>n?n.trim().replace(/\s+/g,"_"):"","getValidEndpoint"),Od=class extends Ue{static{u(this,"y")}constructor(){super(...arguments),this.isOnAdvancedMode=!1,this.isNewComponent=!1,this.cachedAutoFillDataJson=null,this.formPreviewButton=null}async init(){this.isNewComponent=Object.keys(this.data).length===0,this.isOnAdvancedMode=this.isNewComponent?!1:typeof this.data.advancedModeEnabled=="boolean"?this.data.advancedModeEnabled:!0,this.settings={method:{type:"select",label:"Method",value:"POST",options:["POST","GET"],help:"Select available methods for this endpoint",hintPosition:"bottom",tooltipClasses:"w-48 ",arrowClasses:"-ml-11"},endpoint:{type:"input",label:"Skill Name",value:"",validate:"required maxlength=50 custom=isValidEndpoint",validateMessage:"Provide a valid endpoint that only contains 'a-z', 'A-Z', '0-9', '-', '_' , without leading or trailing spaces. Length should be less than 50 characters.",events:{input:t=>{const s=document.querySelector('label[for="endpointLabel"]'),a=document.querySelector('input[name="endpointLabel"]');let o=Ki(t.target.value||"");s.style.display=t.target.value.trim()&&o!=t.target.value.trim()?"flex":"none";let r=Mr(o);s&&(s.innerHTML=r||"",a.value=o,t.stopPropagation())},keyup:t=>{const s=t.target;window.Metro&&window.Metro.validator&&setTimeout(()=>{window.Metro.validator.validate(s)},100),t.stopPropagation()}}},endpointLabel:{type:"input",label:"Internal Name",value:"",events:{input:t=>{t.stopPropagation()}},onLoad:t=>{setTimeout(()=>{const s=document.querySelector('input[name="endpoint"]'),a=document.querySelector('input[name="endpointLabel"]'),o=document.querySelector('label[for="endpointLabel"]');o.style.marginTop="-20px",o.style.backgroundColor="transparent !important",o.style.justifyContent="flex-start",o.style.gap="8px",a.parentElement.style.display="none";let r=Ki(s.value||"");if(o.style.display=s.value&&r!=s.value.trim()?"flex":"none",s.value){let i=Mr(Ki(s.value));o.innerHTML=i}},100)}},description:{type:"textarea",label:"Instructions",value:"",help:"Instructions for AI Agent, Describes how to use this endpoint when exposed to an LLM",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",validate:"maxlength=5000",validateMessage:"Your text exceeds the 5,000 character limit."},ai_exposed:{type:"toggle",label:"Expose to AI",value:!0,help:"If enabled, the endpoint can be discovered and used as a skill by AI (E.g. ChatGPT, chatbot, AgentLLM ...)",tooltipClasses:"w-64 ",arrowClasses:"-ml-11",display:"inline",events:{change:this.exposeIAChangeHandler.bind(this)},section:"Advanced"},summary:{type:"textarea",label:"Description",value:"",help:"Short description of the endpoint, used for documentation",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",validate:"maxlength=1000",validateMessage:"Your text exceeds the 1,000 character limit.",section:"Advanced"},advancedModeEnabled:{type:"toggle",label:"Advanced Request Parts",value:this.isOnAdvancedMode||!1,display:"inline",help:"Enabling this option will permanently expose HTTP headers, request body, and query parameters. This cannot be undone.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:"Advanced",events:{click:async t=>{const s=t.target.checked;if(this.isOnAdvancedMode==!0&&s==!1){t.target.checked=!0,t.preventDefault();return}},change:async t=>{const s=t.target.checked;if(this.isOnAdvancedMode==!0&&s==!1){t.target.checked=!0,t.preventDefault();return}if(await En("Are you sure?","Enabling Advanced Request Parts will permanently expose headers, body, and query parameters. This setting cannot be disabled once enabled.",{btnNoLabel:"Cancel",btnYesLabel:"Enable"}))this.isOnAdvancedMode=!0,this.advancedModeActions(this.isOnAdvancedMode,t);else{t.target.checked=!1,t.preventDefault();return}}}}},this.inputSettings={...this.inputSettings,description:{type:"string",label:"Description",class:"",default:"",editConfig:{label:"Behavior",type:"textarea",section:"Advanced_Options",hint:"Describe how this input should be handled. For example, if the input is a user question, specify how to handle long or ambiguous queries (e.g., \u201Csummarize if over 10 words\u201D). Clearly state any rules, transformations, or validations the input must follow.",hintPosition:"after_label",attributes:{placeholder:"Describe input behavior, formatting (e.g., MM-DD-YY), and requirements"}}}};const e=["method","endpoint","endpointLabel","description","ai_exposed","summary","advancedModeEnabled"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.showSettings=!0,this.drawSettings.inputMaxConnections=0,this.drawSettings.shortDescription="An API Endpoint with input parameters for your AI agent.",this.properties.title||(this.properties.title="Agent Skill"),this.drawSettings.color="#b700f1",this.properties.defaultOutputs=["headers","body","query"],this._ready=!0}async exposeIAChangeHandler(e){const t=e.target.closest("form");if(!t)return;const s=t.querySelector('.form-box[data-field-name="description"]');s&&(e.target.checked?s.classList.remove("hidden"):s.classList.add("hidden"))}updateFormPreviewButton(){const e=this.domElement.querySelector(".messages-container");if(e){const s=e.querySelector(".form-preview-button");s&&(s.closest(".message")?.remove(),this.formPreviewButton=null)}let t=[];for(let s in this.settings){const a=this.settings[s];a.validate?.includes("required")&&t.push({id:s,name:a.label||s})}t.filter(s=>!this.data[s.id]).length===0&&this.properties?.inputProps?.length>0&&(Ct.track("app_form_preview_impression",{}),this.formPreviewButton=this.addComponentButton('<div class="fa-solid fa-play" id="form-preview-button-icon"></div><p class="ml-2 font-semibold">Form Preview</p>'," ",{class:"form-preview-button",customStyle:"secondary"},async s=>{this.workspace.refreshComponentSelection(this.domElement),await this.handleFormPreviewBtnClick()}))}async checkSettings(){await super.checkSettings(),this.updateFormPreviewButton()}async run(){this.addEventListener("settingsOpened",async e=>{await $e(50);const t=e.querySelector('.form-box[data-field-name="description"]');if(!t)return;this.data.ai_exposed?t.classList.remove("hidden"):t.classList.add("hidden");const s=e.querySelector('.form-box[data-field-name="method"]');s&&(this.isOnAdvancedMode?s.classList.remove("hidden"):s.classList.add("hidden"))}),this.addEventListener("settingsSaved",e=>{if(e.endpoint){this.data.endpoint=Ki(e.endpoint),this.data.endpointLabel=this.data.endpoint;const t=document.querySelector('div[name="endpointLabel"]');if(t){const s=Mr(this.data.endpoint);t.innerHTML=s}setTimeout(()=>{this.workspace.saveAgent()},100)}}),this.addEventListener("endpointChanged",(e,t,s,a)=>{if(this.isOnAdvancedMode||e!="name")return;const o=t.classList.contains("input-endpoint")?t:t._inputDivElement,r=t.classList.contains("output-endpoint")?t:t._outputDivElement,i=o.getAttribute("smt-name"),d=r.getAttribute("smt-name");if(i!=a&&(o.setAttribute("smt-name",a),o.querySelector(".name").innerText=a),d!=a&&(r.setAttribute("smt-name",a),r.querySelector(".name").innerText=a,r?.hasAttribute("smt-expression")&&r?.getAttribute("smt-expression")===`body.${s}`)){const c=`body.${a}`;r.setAttribute("smt-expression",c)}}),await $e(50),this.advancedModeActions(this.isOnAdvancedMode)}async addInput(e,t,s={}){if(this.isOnAdvancedMode){const i=await super.addInput(e,t,s);return this.updateFormPreviewButton(),i}if(this.properties.defaultOutputs.includes(t))return super.addInput(e,t);const a=await super.addInput(e,t,s),o=e.parentElement.querySelector(".output-container");this.properties.inputProps?.find(i=>i.name===t);const r=await super.addOutput(o,t,{expression:`body.${t}`},{onEditBtnClick:i=>{if(this.isOnAdvancedMode)return!0;if(r.querySelector(".btn-edit-endpoint")){const d=a.querySelector(".btn-edit-endpoint");d&&d.click()}return!1}});return s?.optional?r.classList.add("marked-optional"):r.classList.remove("marked-optional"),a.querySelector(".ep").setAttribute("smt-con-thickness","8"),a.querySelector(".ep").setAttribute("smt-con-hide-overlays","true"),a._outputDivElement=r,r._inputDivElement=a,this.repaint(),this.updateFormPreviewButton(),a}async addOutput(e,t,s={}){return this.isOnAdvancedMode?super.addOutput(e,t,s):this.properties.defaultOutputs.includes(t)?super.addOutput(e,t,s):null}async deleteEndpoint(e){if(this.isOnAdvancedMode){const s=await super.deleteEndpoint(e);return this.updateFormPreviewButton(),s}super.deleteEndpoint(e);const t=e._outputDivElement||e._inputDivElement;e._outputDivElement&&(e.outputDivElement=null),e._inputDivElement&&(e.inputDivElement=null),t&&super.deleteEndpoint(t),this.updateFormPreviewButton()}advancedModeActions(e,t=null){const s=document.querySelector(`#${this.uid} .input-container`),a=document.querySelector(`#${this.uid} .ep-control.outputs`),o=document.querySelectorAll(`#${this.uid} .output-container .output-endpoint.default`),r=[s,a,...o].filter(i=>i!=null);if(e?r.forEach(i=>i.classList.remove("hidden")):r.forEach(i=>i.classList.add("hidden")),t){const i=t.target.closest("form");if(!i)return;[i.querySelector('.form-box[data-field-name="method"]')].filter(d=>d!=null).forEach(d=>{d&&(t.target.checked?d.classList.remove("hidden"):d.classList.add("hidden"))})}}async handleFormPreviewBtnClick(){Ct.track("app_form_preview_click",{});let e=this.cachedAutoFillDataJson;const t=this.domElement.querySelector(".form-preview-button"),s=this.domElement.querySelector("#form-preview-button-icon");if(s&&t&&(t.disabled=!0,t.classList.add("disabled"),s.classList.remove("fa-play"),s.classList.add("fa-circle-notch"),s.classList.add("animate-spin")),!e){const i=await fetch("/api/page/builder/data/generate-form-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:this.workspace.agent.id,componentId:this.uid})}).catch(d=>(console.error("Error generating form data:",d),null));if(i&&i.ok){const d=await i.json();d.success||console.error("Error generating form data:",d.error),e=d.data,typeof e!="object"&&(e={})}}const a="skill-preview-sidebar-root",o=`
      <div class="p-4 h-full">
        <div id="${a}"></div>
      </div>`;await Bt(o,{},gt.agent_skill.title,gt.agent_skill.tooltipTitle);const r=this.getSkillErrors();setTimeout(()=>{jr({rootID:a,skill:{skillId:this.uid,details:{name:this.title,description:this.data.description,endpoint:this.data.endpoint,method:this.data.method,skillErrors:r},inputsTypes:this.properties.inputProps,autoFillDataJson:e}})},1e3),s&&(t.disabled=!1,t.classList.remove("disabled"),s.classList.remove("fa-circle-notch"),s.classList.remove("animate-spin"),s.classList.add("fa-play"))}getSkillErrors(){const e=class extends pa{static{u(this,"l")}constructor(){super(),this.errors=[],this.errors=[]}setErrors(i){this.errors=i,this.emit("changed",this.errors)}addError(i){const d=this.errors.find(c=>c.error_slug===i.error_slug);d?d.error_message=i.error_message:this.errors.push(i),this.emit("changed",this.errors)}removeError(i){let d=this.errors.filter(c=>c.error_slug!==i);this.errors=d,this.emit("changed",this.errors)}};As(e,"SkillError");let t=e;const s=new t,a=As(()=>{this.workspace.jsPlumbInstance.getAllConnections().map(r=>{const i=r.source,d=r.target,c=i.closest(".component"),l=d.closest(".component");return!c||!l?null:{sourceId:i.closest(".component").id,sourceIndex:[...i.parentElement.querySelectorAll(".output-endpoint")].findIndex(m=>m===i),targetId:d.closest(".component").id,targetIndex:[...d.parentElement.querySelectorAll(".input-endpoint")].findIndex(m=>m===d)}}).filter(r=>r).filter(r=>r.sourceId===this.uid).length===0?s.addError({error_slug:"missing_connection",error_message:"Tip: Add or connect components to bring your workflow to life. Components work together seamlessly to create a powerful, intuitive agent experience."}):s.removeError("missing_connection")},"checkConnections");this.workspace.jsPlumbInstance.bind("connection",Ac(a,100)),this.workspace.jsPlumbInstance.bind("connectionDetached",Ac(a,100)),a();const o=As(()=>{let r=this.workspace.jsPlumbInstance.getAllConnections().map(l=>{const m=l.source,v=l.target,x=m.closest(".component"),C=v.closest(".component");return!x||!C?null:{sourceId:m.closest(".component").id,sourceIndex:[...m.parentElement.querySelectorAll(".output-endpoint")].findIndex(w=>w===m),targetId:v.closest(".component").id,targetIndex:[...v.parentElement.querySelectorAll(".input-endpoint")].findIndex(w=>w===v)}}).filter(l=>l),i=!1,d=[this.uid],c=[];for(;d.length>0;){let l=d.shift();c.push(l);const m=document.querySelector(`.component#${l}`)?._control;if(!m)continue;let v=[];for(let C in m.settings){const w=m.settings[C];w.validate?.includes("required")&&v.push({id:C,name:w.label||C})}if(v.filter(C=>!m.data[C.id]).length>0){i=!0;const C=As(()=>{o(),m.off("settingsSaved",C)},"listener");m.on("settingsSaved",C);break}const x=r.filter(C=>C.sourceId===l&&!c.includes(C.targetId)).map(C=>C.targetId);d.push(...x)}i?s.addError({error_slug:"connected_components_settings_err",error_message:"Tip: resolve missing information from components (the red boxes) first, otherwise the agent will get stuck at that step and not return anything useful."}):s.removeError("connected_components_settings_err")},"checkSettingsErr");return o(),s}redraw(e){super.redraw(e);const t=this.domElement.querySelector(".title-bar-top"),s=this.workspace.jsPlumbInstance.addEndpoint(t,{endpoint:["Rectangle",{height:10,width:40}],anchor:"Left",isTarget:!0,maxConnections:-1,cssClass:"exclude-panzoom"});t.classList.add("agent-card-connection"),t.endpoint=s,s._domElement=t;const a=document.createElement("span");a.className="block absolute ep w-[15px] h-[15px] rounded-full -left-[17px] float-left border-0 top-1/2 -translate-y-1/2",a.style.backgroundColor="rgb(60, 137, 249)",t.appendChild(a)}};As(Od,"APIEndpoint");let Bw=Od;var Uw=Object.defineProperty,zw=u((n,e)=>Uw(n,"name",{value:e,configurable:!0}),"i$v");const Dd=class extends Ue{static{u(this,"s")}async init(){this.settings={format:{type:"select",label:"Output Format",value:"full",options:["full","minimal","raw"],help:"API Output component refines and standardizes output data, ensuring relevance and clarity for user requirements.",tooltipClasses:"w-64",arrowClasses:"-ml-11",hintPosition:"bottom",events:{}}};const e=["format"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=[],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.outputMaxConnections=0,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.color="#8600f1"}};zw(Dd,"APIOutput");let Gw=Dd;var Hw=Object.defineProperty,Vw=u((n,e)=>Hw(n,"name",{value:e,configurable:!0}),"o$k");const Md=class extends Ue{static{u(this,"r")}async init(){this.settings={};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=[],this.properties.defaultOutputs=["JobID"],this.drawSettings.displayName="Async",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Runs workflow asynchronously",this.drawSettings.shortDescription="Runs workflow asynchronously",this.drawSettings.color="#4fd581",this.drawSettings.addOutputButton=null,this.drawSettings.addInputButtonLabel="in/out",this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.showSettings=!1,this._ready=!0}inputNameExists(e){return!!(this.inputContainer.querySelector(`.input-endpoint[smt-name="${e}"]`)||this.outputContainer.querySelector(`.output-endpoint[smt-name="${e}"]`))}async addInput(e,t){if(this.properties.defaultOutputs.includes(t))return super.addInput(e,t);const s=await super.addInput(e,t),a=e.parentElement.querySelector(".output-container"),o=await super.addOutput(a,t);return s.querySelector(".ep").setAttribute("smt-con-thickness","8"),s.querySelector(".ep").setAttribute("smt-con-hide-overlays","true"),s._outputDivElement=o,o._inputDivElement=s,this.repaint(),s}async addOutput(e,t){return this.properties.defaultOutputs.includes(t)?super.addOutput(e,t):null}async deleteEndpoint(e){console.log("deleting"),super.deleteEndpoint(e);const t=e._outputDivElement||e._inputDivElement;e._outputDivElement&&(e.outputDivElement=null),e._inputDivElement&&(e.inputDivElement=null),t&&super.deleteEndpoint(t)}async run(){return this.addEventListener("endpointChanged",(e,t,s,a)=>{if(e!="name")return;console.log("endpointNameChanged",t,s,a);const o=t.classList.contains("input-endpoint")?t:t._inputDivElement,r=t.classList.contains("output-endpoint")?t:t._outputDivElement,i=o.getAttribute("smt-name"),d=r.getAttribute("smt-name");i!=a&&(o.setAttribute("smt-name",a),o.querySelector(".name").innerText=a),d!=a&&(r.setAttribute("smt-name",a),r.querySelector(".name").innerText=a)}),!0}};Vw(Md,"Async");let Ww=Md;var Kw=Object.defineProperty,Yw=u((n,e)=>Kw(n,"name",{value:e,configurable:!0}),"s$r");const Nd=class extends Ue{static{u(this,"i")}async init(){this.settings={html:{type:"div",html:"The first met condition will interrupt Await and continue the workflow."},jobs_count:{type:"range",label:"Minimum Jobs Count",min:1,max:100,value:1,step:1,validate:"min=1 max=100",validateMessage:"Allowed range 1 to 100"},max_time:{type:"range",label:"Maximum wait time in seconds",min:1,max:10800,value:1,step:1,validate:"min=1 max=10800",validateMessage:"Allowed range 1 to 10800"}};const e=["jobs_count","max_time"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=["Jobs"],this.properties.defaultOutputs=["Results"],this.drawSettings.displayName="Await",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Wait for asynchronous jobs",this.drawSettings.shortDescription="Wait for asynchronous jobs",this.drawSettings.color="#4fd581",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.showSettings=!0,this._ready=!0}};Yw(Nd,"Await");let Xw=Nd;var Jw=Object.defineProperty,Zw=u((n,e)=>Jw(n,"name",{value:e,configurable:!0}),"i$t");const $d=class extends Ue{static{u(this,"s")}async init(){this.settings={mime:{type:"select",label:"MIME type",hint:"Model name",value:"default",options:["default","image/jpeg","image/png"]}};const e=["mime"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Data"],this.drawSettings.showSettings=!1,this.drawSettings.cssClass="",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton=" + Input",this.drawSettings.componentDescription="Converts a raw data string to base64 encoded string or url"}};Zw($d,"Base64Encoder");let Qw=$d;var eS=Object.defineProperty,tS=u((n,e)=>eS(n,"name",{value:e,configurable:!0}),"i$s");const Fd=class extends Ue{static{u(this,"o")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["text"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data?.model;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={model:{type:"select",label:"Select a model",help:"Choose an AI model to process the prompt.",tooltipClasses:"w-56",arrowClasses:"-ml-11",value:this.defaultModel,options:this.modelOptions,actions:[{label:"Configure more models",icons:{left:{svg:ha,classes:"mr-2"},right:{svg:ma,classes:"absolute right-4"}},position:"after-dropdown",id:"configureMoreModelsBtn",classes:"custom_model_add_btn",events:{click:()=>{window.open("/vault","_blank")}}}]},prompt:{type:"textarea",label:"Prompt",validate:"required maxlength=30000",validateMessage:"The prompt should be a non empty text of less than 30,000 characters",value:`Classify the input content to one of the categories.
Set the selected category to true and the others to empty value`,attributes:{"data-template-vars":"true"}}};const e=["prompt","model"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=[],this.properties.defaultInputs=["Input"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="Categories",this.drawSettings.addInputButton="Inputs",this.drawSettings.componentDescription=`Classify the input content to one of the categories.
Can use a prompt to customize the output format, classification behavior, categories extraction and more`,this.drawSettings.shortDescription="Classifies content to one of the categories",this.drawSettings.color="#ff00f2"}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}};tS(Fd,"Classifier");let nS=Fd;var sS=Object.defineProperty,aS=u((n,e)=>sS(n,"name",{value:e,configurable:!0}),"d$h");const Rd=class extends Ue{static{u(this,"a")}constructor(){super(...arguments),this.templateSupport=!0}async init(){const e=`
//This is a simple example of how to use the code component.
let result = _A + _B;
let message = \`The sum of \${_A} and \${_B} is \${result}\`;
_output = {result, message};

//_output variable is bound to component Output endpoint
//  _output can be a json object or a primitive value
 

`;this.settings={code_vars:{type:"textarea",code:{mode:"javascript",theme:"chrome"},label:"Variables",value:"",validate:"",validateMessage:"",help:"A variable stores data that can be used and modified in your code, such as numbers, text, or objects.",tooltipClasses:"w-56",arrowClasses:"-ml-11",attributes:{readonly:"readonly"}},code_body:{type:"textarea",code:{mode:"javascript",theme:"chrome"},label:"Code",help:"Code to process inputs.",value:e,validate:"maxlength=500000",validateMessage:"The code length is limitted to 500,000 characters",attributes:{}}};const t=["code_vars","code_body"];for(let r of t)typeof this.data[r]>"u"&&(this.data[r]=this.settings[r].value);this.properties.template&&!this.data._templateVars&&(this.data._templateVars={}),this.properties.defaultInputs=[],this.properties.inputs.length==0&&(this.properties.inputs=["A","B"]),this.properties.defaultOutputs=["Output"],this.properties.outputs.length==0&&(this.properties.outputs=["Output","_error"]),this.data.code_vars=this.generateCodeVars(JSON.parse(JSON.stringify(this.properties.inputs))),this.drawSettings.displayName="Code";const s=this.properties.template?.templateInfo?.icon||"",a=this.properties.template?.templateInfo?.color||"#000000",o=s&&s.startsWith("<svg");this.drawSettings.iconCSSClass=s?`tpl-fa-icon ${s}`:`svg-icon ${this.constructor.name}`,this.drawSettings.color=s?a:"#00BCD4",o&&(this.drawSettings.iconCSSClass=s),this.drawSettings.componentDescription="Process inputs with code",this.drawSettings.shortDescription="Process inputs with code",this._ready=!0}async run(){this.addEventListener("endpointAdded",this.updateCodeVars.bind(this)),this.addEventListener("endpointRemoved",this.updateCodeVars.bind(this)),this.addEventListener("endpointChanged",this.updateCodeVars.bind(this)),this.addEventListener("settingsOpened",async(e,t)=>{if(t!==this)return;console.log("settingsOpened");const s=e.querySelector("#code_vars");if(s){s.classList.add("hidden");const o=s._editor;o&&(o.session.setOption("useWorker",!1),o.clearSelection())}const a=e.querySelector("#code_body");if(a){a.classList.add("hidden");const o=a._editor;o&&o.clearSelection()}})}updateCodeVars(){const e=[...this.domElement.querySelectorAll(".input-container .input-endpoint")].map(s=>s.getAttribute("smt-name"));this.data.code_vars=this.generateCodeVars(e);const t=this.getSettingsSidebar();if(t){const s=t.querySelector("#code_vars");s&&(s.value=this.data.code_vars),s&&s._editor&&s._editor.setValue(this.data.code_vars)}}generateCodeVars(e){let t="";return e.length>=1&&(t=`//Use these variables to access your input values.
`,e.push(""),t+=e.reduce((s,a)=>!a&&!s.startsWith("const ")?`const _${s}={{${s}}};`:a?s.startsWith("const ")?`${s}
const _${a}={{${a}}};`:`const _${s}={{${s}}};
const _${a}={{${a}}};`:s)),t+=`

//This variable determines the output of your component.
let _output=undefined;`,t+=`
`,t}exportTemplate(){let e=JSON.parse(JSON.stringify(this.data));const t={};e.code_body=e.code_body||"",e.code_body=this.parseTemplateString(e.code_body,t);const s=this.properties.inputProps,a=this.properties.outputProps;return{name:this.title,componentName:this.constructor.name,description:this.description,settings:t,data:e,inputs:s,outputs:a}}};aS(Rd,"Code");let iS=Rd;var oS=Object.defineProperty,rS=u((n,e)=>oS(n,"name",{value:e,configurable:!0}),"o$i");const qd=class extends Ue{static{u(this,"a")}async prepare(){return!0}async init(){this.settings=this.generateSettings();const e=["prompt"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Prompt"],this.drawSettings.displayName="Computer Use",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Control a virtual computer to perform tasks using natural language commands",this.drawSettings.shortDescription="AI-powered computer automation",this.drawSettings.color="#65a698",this._ready=!0}generateSettings(){return{prompt:{type:"textarea",label:"Prompt",validate:"required minlength=2",validateMessage:"Please provide a prompt with at least 2 characters",value:"{{Prompt}}",attributes:{"data-template-vars":"true",placeholder:'Describe what you want the computer to do. For example: "Go to google.com and search for SmythOS"'},help:"Natural language instructions for what you want the computer to do"}}}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){}redraw(e){super.redraw(e);const t=document.createElement("div");t.className="computer-state-container mt-4 p-1 border border-gray-300 rounded-lg shadow-sm bg-white";const s=document.createElement("img");return s.className="computer-state-img w-full h-auto rounded-md object-contain max-h-[400px]",s.src="/img/builder/computer-use-ui-placeholder.png",s.onerror=()=>{s.src="/img/builder/computer-use-ui-placeholder.png"},t.appendChild(s),this.domElement.appendChild(t),this.domElement}};rS(qd,"ComputerUse");let lS=qd;var cS=Object.defineProperty,uS=u((n,e)=>cS(n,"name",{value:e,configurable:!0}),"n$f");const Bd=class extends Ue{static{u(this,"s")}constructor(){super(...arguments),this.namespaces=[]}async prepare(){this.updateSettings()}async updateSettings(){const e=await(await fetch(`${this.workspace.server}/api/component/DataSourceCleaner/namespaces`)).json();this.namespaces=e.map(t=>({value:t.id,text:t.name})),this.settings.namespaceId.options=this.namespaces,this.settingsOpen&&this.refreshSettingsSidebar()}async init(){this.settings={namespaceId:{type:"select",label:"namespace",hint:"Select namespace",options:this.namespaces},id:{type:"input",label:"source identifier",hint:"Accepted characters: 'a-z', 'A-Z', '0-9', '-', '_', '.'",validate:"custom=isValidId",validateMessage:"It should contain only 'a-z', 'A-Z', '0-9', '-', '_', '.', ",attributes:{"data-template-vars":"true"}}};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=[],this.properties.defaultOutputs=["Success"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.displayName="Source Cleaner",this.drawSettings.shortDescription="Delete data sources from data pool",this.drawSettings.color="#fb3464",this.drawSettings.showSettings=!0}async checkSettings(){super.checkSettings(),(!this.namespaces||this.namespaces.length==0)&&await $e(3e3);const e={};if(this.namespaces.forEach(t=>{e[t.value]=t.text}),this.data.namespace){const t=this.data.namespace;e[t]||(console.log("Namespace Missing",t),this.addComponentMessage('Missing Namespace<br /><a href="/data" target="_blank" style="color:#33b;text-decoration:underline">Create one</a> then configure it for this component',"alert"))}}};uS(Bd,"DataSourceCleaner");let dS=Bd;var pS=Object.defineProperty,hS=u((n,e)=>pS(n,"name",{value:e,configurable:!0}),"i$r");const Ud=class extends Ue{static{u(this,"a")}constructor(){super(...arguments),this.namespaces=[]}async prepare(){this.updateSettings()}async updateSettings(){const e=await(await fetch(`${this.workspace.server}/api/component/DataSourceIndexer/namespaces`)).json();this.namespaces=e.map(t=>({value:t.id,text:t.name})),this.settings.namespace.options=this.namespaces,this.settingsOpen&&this.refreshSettingsSidebar()}async init(){this.settings={namespace:{type:"select",label:"namespace",hint:"Select namespace",options:this.namespaces},id:{type:"input",label:"source identifier",hint:"Accepted characters: 'a-z', 'A-Z', '0-9', '-', '_', '.'",attributes:{"data-template-vars":"true"},validate:"custom=isValidId",validateMessage:"It should contain only 'a-z', 'A-Z', '0-9', '-', '_', '.' "},name:{type:"input",label:"label",hint:"a human readable label for the data source",attributes:{"data-template-vars":"true"},validate:"maxlength=50",validateMessage:"Enter a non-empty label, not more than 50 characters."},metadata:{type:"textarea",label:"Metadata",value:"",validate:"maxlength=10000",hint:"Enter the source metadata, not more than 10000 characters.",attributes:{"data-template-vars":"true"}}};const e=["namespace"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=["Source"],this.properties.defaultOutputs=["Success"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.displayName="Source Indexer",this.drawSettings.shortDescription="Index data sources to data pool",this.drawSettings.color="#fb3464",this.drawSettings.showSettings=!0}async checkSettings(){super.checkSettings(),(!this.namespaces||this.namespaces.length==0)&&await $e(3e3);const e={};if(this.namespaces.forEach(t=>{e[t.value]=t.text}),this.data.namespace){const t=this.data.namespace;e[t]||(console.log("Namespace Missing",t),this.addComponentMessage('Missing Namespace<br /><a href="/data" target="_blank" style="color:#33b;text-decoration:underline">Create one</a> then configure it for this component',"alert"))}}};hS(Ud,"DataSourceIndexer");let mS=Ud;var gS=Object.defineProperty,fS=u((n,e)=>gS(n,"name",{value:e,configurable:!0}),"n$e");const zd=class extends Ue{static{u(this,"s")}constructor(){super(...arguments),this.namespaces=[]}async prepare(){this.updateSettings()}async updateSettings(){const e=await(await fetch(`${this.workspace.server}/api/component/DataSourceLookup/namespaces`)).json();this.namespaces=e.map(t=>({value:t.id,text:t.name})),this.settings.namespace.options=this.namespaces,this.settingsOpen&&this.refreshSettingsSidebar()}async init(){this.settings={namespace:{type:"select",label:"namespace",hint:"Select namespace",options:this.namespaces},topK:{type:"number",label:"Results count",hint:"Number of results to return",value:3,validate:"required min=0 custom=isValidInteger",validateMessage:"Please enter a positive number"},includeMetadata:{type:"checkbox",label:"Include metadata",value:!1}};const e=["namespace","topK"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=["Query"],this.properties.defaultOutputs=["Results"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.displayName="Data Lookup",this.drawSettings.shortDescription="Lookup data from data pool",this.drawSettings.color="#fb3464",this.drawSettings.showSettings=!0}async checkSettings(){super.checkSettings(),(!this.namespaces||this.namespaces.length==0)&&await $e(3e3);const e={};if(this.namespaces.forEach(t=>{e[t.value]=t.text}),this.data.namespace){const t=this.data.namespace;e[t]||(console.log("Namespace Missing",t),this.addComponentMessage('Missing Namespace<br /><a href="/data" target="_blank" style="color:#33b;text-decoration:underline">Create one</a> then configure it for this component',"alert"))}}};fS(zd,"DataSourceLookup");let vS=zd;var bS=Object.defineProperty,yS=u((n,e)=>bS(n,"name",{value:e,configurable:!0}),"a$l");const Gd=class extends Ue{static{u(this,"i")}async init(){this.settings={db:{type:"input",label:"DB Connection",hint:"Database Connection string",value:""},table:{type:"input",label:"Table",hint:"Table name",value:""}};const e=["db","table"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.outputs=[],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this._ready=!0}};yS(Gd,"DBInsert");let xS=Gd;var wS=Object.defineProperty,SS=u((n,e)=>wS(n,"name",{value:e,configurable:!0}),"i$p");const Hd=class extends Ue{static{u(this,"e")}async init(){this.settings={email:{type:"input",label:"Email",value:"",hint:"customer@email.com"}};const e=["email"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.outputs=["Success","Error"],this.properties.inputs.length==0&&(this.properties.inputs=["Input"]),this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this._ready=!0}};SS(Hd,"EmailSender");let CS=Hd;var AS=Object.defineProperty,ES=u((n,e)=>AS(n,"name",{value:e,configurable:!0}),"a$k");const Vd=class extends Ue{static{u(this,"d")}redraw(e=!0){this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.addInputButtonLabel="Input",super.redraw(e);const t=this.domElement;return t.classList.add("Function"),t}};ES(Vd,"FunctionComponent");let Ks=Vd;var kS=Object.defineProperty,_S=u((n,e)=>kS(n,"name",{value:e,configurable:!0}),"n$d");const Wd=class extends Ks{static{u(this,"i")}async init(){this.settings={action:{type:"select",label:"Action",hint:"Action to perform",value:"Encode",options:["Encode","Decode"]},function:{type:"select",label:"Function",hint:"Function name",value:"BASE64",options:["BASE64","MD5","SHA1","SHA256","SHA512","HMACHex","HMACBase64","HMACBase64URL","HMACBase64URLNoPadding"]}};const e=["action","function"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Input"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#329bff",this.properties.title=`${this.data.function} ${this.data.action}`,this.drawSettings.displayName="F:Crypto"}async run(){this.domElement.style.width||(this.domElement.style.width="130px"),this.addEventListener("settingsSaved",async()=>{this.title=`${this.data.function} ${this.data.action}`,this.domElement.querySelector(".title .text").textContent=this.title})}};_S(Wd,"FCrypto");let PS=Wd;var IS=Object.defineProperty,LS=u((n,e)=>IS(n,"name",{value:e,configurable:!0}),"s$l");const TS=["hex","base64","base64url","latin1"],Kd=class extends Ks{static{u(this,"i")}async init(){this.settings={action:{type:"select",label:"Action",hint:"Action to perform",value:"Encode",options:["Encode","Decode"]},encoding:{type:"select",label:"encoding",value:"hex",options:TS}};const e=["action","encoding"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Data"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#329bff",this.properties.title=`${this.data.encoding} ${this.data.action}`,this.drawSettings.displayName="F:Encode/Decode"}async run(){this.domElement.style.width||(this.domElement.style.width="130px"),this.addEventListener("settingsSaved",async()=>{this.title=`${this.data.encoding} ${this.data.action}`,this.domElement.querySelector(".title .text").textContent=this.title})}};LS(Kd,"FEncDec");let jS=Kd;var OS=Object.defineProperty,DS=u((n,e)=>OS(n,"name",{value:e,configurable:!0}),"i$m");const MS=["md5","sha1","sha224","sha256","sha384","sha512","sha3-224","sha3-256","sha3-384","sha3-512","shake128","shake256","blake2b512","blake2s256"],NS=["hex","base64","base64url","latin1"],Yd=class extends Ks{static{u(this,"s")}async init(){this.settings={algorithm:{type:"select",label:"Hash Algorithm",value:"md5",options:MS},encoding:{type:"select",label:"Output encoding",value:"hex",options:NS}};const e=["algorithm","encoding"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Hash"],this.properties.defaultInputs=["Data"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#0083ff",this.properties.title=`${this.data.algorithm.toUpperCase()} :: ${this.data.encoding}`,this.drawSettings.displayName="F:Hash"}async run(){this.domElement.style.width||(this.domElement.style.width="130px"),this.addEventListener("settingsSaved",async()=>{this.title=`${this.data.algorithm.toUpperCase()} :: ${this.data.encoding}`,this.domElement.querySelector(".title .text").textContent=this.title})}};DS(Yd,"FHash");let $S=Yd;var FS=Object.defineProperty,RS=u((n,e)=>FS(n,"name",{value:e,configurable:!0}),"i$l");const Xd=class extends Ue{static{u(this,"r")}async init(){const e=this.properties.sender?.getAttribute("smt-export-format")||"";this.settings={format:{type:"input",label:"Format",value:e,attributes:{readonly:"readonly"}}};const t=["format"];for(let s of t)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.inputs.length==0&&(this.properties.inputs=["Source"]),this.properties.outputs=["Output"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addInputButton=null,this.drawSettings.addOutputButton=null,this._ready=!0}redraw(e=!0){const t=super.redraw(e),s=this.properties.sender?.querySelector(".icon").className||"icon mif-file-empty",a=this.domElement.querySelector(".title-bar").querySelector(".icon");return a.className=s,t}};RS(Xd,"FileExport");let qS=Xd;var BS=Object.defineProperty,US=u((n,e)=>BS(n,"name",{value:e,configurable:!0}),"e$8");const Jd=class extends Ue{static{u(this,"t")}async init(){this.settings={name:{type:"input",label:"File Name",validate:"maxlength=50 custom=isValidS3FileName",validateMessage:"Only alphanumeric characters, '-', '_' and '.' are allowed.",value:"",attributes:{"data-template-vars":"true"}},ttl:{type:"select",label:"TTL",help:"Time to live",options:[{value:"86400",text:"1 day"},{value:"259200",text:"3 days"},{value:"604800",text:"1 week"},{value:"1209600",text:"2 weeks"},{value:"2592000",text:"1 month"}]}},this.properties.defaultOutputs=["Url"],this.properties.defaultInputs=["Data"],this.drawSettings.displayName="File Store",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Store a file or data permanently",this.drawSettings.shortDescription="Store a file or data permanently",this.drawSettings.color="#65a698",this._ready=!0}};US(Jd,"FileStore");let zS=Jd;var GS=Object.defineProperty,HS=u((n,e)=>GS(n,"name",{value:e,configurable:!0}),"i$j");const Zd=class extends Ue{static{u(this,"s")}async init(){this.settings={format:{type:"select",label:"Output Format",value:"full",options:[{text:"Full",value:"full"},{text:"Minimal",value:"minimal"},{text:"Array Of Results",value:"results-array"}]}};const e=["format"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=["Input"],this.properties.defaultOutputs=["Loop","Result"],this.drawSettings.displayName="For Each",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Performs a for each loop on an array",this.drawSettings.shortDescription="Performs a for each loop on an array",this.drawSettings.color="#4f81d5",this.drawSettings.addInputButton=null,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButtonLabel=" ",this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.showSettings=!0,this._ready=!0}};HS(Zd,"ForEach");let VS=Zd;var WS=Object.defineProperty,KS=u((n,e)=>WS(n,"name",{value:e,configurable:!0}),"o$c");const Qd=class extends Ks{static{u(this,"d")}async init(){this.settings={signMethod:{type:"select",label:"Signature Method",value:"HMAC",options:["HMAC","RSA"]},dataTransform:{type:"select",label:"Data Transform",help:"If the provided data is not a string, it will be transformed using the selected method before signing",value:"Stringify",options:["Stringify","Querystring"]},key:{type:"textarea",label:"Key / Secret",attributes:{"data-template-vars":"true","data-vault":"APICall,ALL_NON_GLOBAL_KEYS"},hint:"This will be used if the input key is not supplied as input",value:""},keyMessage:{type:"div",class:"hidden",html:"<b>The Key will be read from input</b>"},hashType:{type:"select",label:"Hash Type",value:"md5",options:["md5","sha1","sha256","sha512"]},RSA_padding:{type:"select",class:"hidden",label:"RSA Options",value:"RSA_PKCS1_PADDING",options:["RSA_PKCS1_PADDING","RSA_PKCS1_PSS_PADDING","RSA_NO_PADDING"]},RSA_saltLength:{type:"number",class:"hidden",label:"RSA Salt Length",value:["RSA_PSS_SALTLEN_DIGEST","RSA_PSS_SALTLEN_MAX_SIGN"]},encoding:{type:"select",label:"Output encoding",value:"hex",options:["hex","base64","base64url","latin1","utf8"]}};const e=["signMethod","dataTransform","key","hashType","RSA_padding","RSA_saltLength","encoding"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Signature"],this.properties.defaultInputs=["Data","Key"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#0083ff",this.properties.title=`${this.data.signMethod.toUpperCase()}-${this.data.hashType.toUpperCase()} :: ${this.data.encoding}`,this.drawSettings.displayName="F:Sign"}async run(){this.domElement.style.width||(this.domElement.style.width="130px"),this.addEventListener("settingsSaved",async()=>{this.title=`${this.data.signMethod.toUpperCase()}-${this.data.hashType.toUpperCase()} :: ${this.data.encoding}`,this.domElement.querySelector(".title .text").textContent=this.title}),this.addEventListener("settingsOpened",async e=>{await $e(100);const t=e.querySelector('.form-box[data-field-name="key"]'),s=e.querySelector('.form-box[data-field-name="keyMessage"]');this.workspace.jsPlumbInstance.getConnections({target:this.domElement.querySelector('.endpoint[smt-name="Key"]')}).length>0?(t.classList.add("hidden"),s.classList.remove("hidden")):(t.classList.remove("hidden"),s.classList.add("hidden"))}),this.addEventListener("connectionDetached",async(e,t,s)=>{if(e==="Key"){const a=this.getSettingsSidebar();if(!a)return;const o=a.querySelector('.form-box[data-field-name="key"]'),r=a.querySelector('.form-box[data-field-name="keyMessage"]');o.classList.remove("hidden"),r.classList.add("hidden")}}),this.addEventListener("connectionAttached",async(e,t,s)=>{if(e==="Key"){const a=this.getSettingsSidebar();if(!a)return;const o=a.querySelector('.form-box[data-field-name="key"]'),r=a.querySelector('.form-box[data-field-name="keyMessage"]');o.classList.add("hidden"),r.classList.remove("hidden")}})}};KS(Qd,"FSign");let YS=Qd;var XS=Object.defineProperty,JS=u((n,e)=>XS(n,"name",{value:e,configurable:!0}),"s$i");const ep=class extends Ks{static{u(this,"i")}async init(){this.settings={delay:{type:"range",label:"Delay",hint:"Delay in seconds",help:"Wait for the specified number of seconds before continuing.The provided input will be passed to the output without any changes.",min:1,max:3600,value:1,step:1,validate:"min=1 max=3600",validateMessage:"Allowed range 1 to 3600"}};const e=["delay"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Input"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#329bff",this.properties.title=`Sleep for ${this.data.delay}s`,this.drawSettings.displayName="F:Sleep"}async run(){this.domElement.style.width||(this.domElement.style.width="130px"),this.addEventListener("settingsSaved",async()=>{this.title=`Sleep for ${this.data.delay}s`,this.domElement.querySelector(".title .text").textContent=this.title})}};JS(ep,"FSleep");let ZS=ep;var QS=Object.defineProperty,eC=u((n,e)=>QS(n,"name",{value:e,configurable:!0}),"s$h");const tp=class extends Ks{static{u(this,"i")}async init(){this.settings={};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=["Timestamp"],this.properties.defaultInputs=["Trigger"],this.drawSettings.showSettings=!1,this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#329bff",this.properties.title="Timestamp",this.drawSettings.displayName="F:Timestamp"}async run(){this.domElement.style.width||(this.domElement.style.width="140px"),this.addEventListener("settingsSaved",async()=>{this.title="Timestamp",this.domElement.querySelector(".title .text").textContent=this.title})}};eC(tp,"FTimestamp");let tC=tp;var nC=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Timbuktu","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/ComodRivadavia","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Atikokan","America/Atka","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Ensenada","America/Fort_Wayne","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Valparaiso","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Knox_IN","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port_of_Spain","America/Port-au-Prince","America/Porto_Acre","America/Porto_Velho","America/Puerto_Rico","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Rosario","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Shiprock","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Virgin","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/South_Pole","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Ashkhabad","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Choibalsan","Asia/Chongqing","Asia/Chungking","Asia/Colombo","Asia/Dacca","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Gaza","Asia/Harbin","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Istanbul","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Katmandu","Asia/Khandyga","Asia/Kolkata","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macao","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Tel_Aviv","Asia/Thimbu","Asia/Thimphu","Asia/Tokyo","Asia/Ujung_Pandang","Asia/Ulaanbaatar","Asia/Ulan_Bator","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Faroe","Atlantic/Jan_Mayen","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/ACT","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Canberra","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/LHI","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/North","Australia/NSW","Australia/Perth","Australia/Queensland","Australia/South","Australia/Sydney","Australia/Tasmania","Australia/Victoria","Australia/West","Australia/Yancowinna","Brazil/Acre","Brazil/DeNoronha","Brazil/East","Brazil/West","Canada/Atlantic","Canada/Central","Canada/Eastern","Canada/East-Saskatchewan","Canada/Mountain","Canada/Newfoundland","Canada/Pacific","Canada/Saskatchewan","Canada/Yukon","Chile/Continental","Chile/EasterIsland","Cuba","Egypt","Eire","Etc/GMT","Etc/GMT+0","Etc/UCT","Etc/Universal","Etc/UTC","Etc/Zulu","Europe/Amsterdam","Europe/Andorra","Europe/Athens","Europe/Belfast","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Nicosia","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Tiraspol","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","GB","GB-Eire","GMT","GMT+0","GMT0","GMT-0","Greenwich","Hongkong","Iceland","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Iran","Israel","Jamaica","Japan","Kwajalein","Libya","Mexico/BajaNorte","Mexico/BajaSur","Mexico/General","Navajo","NZ","NZ-CHAT","Pacific/Apia","Pacific/Auckland","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Samoa","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis","Pacific/Yap","Poland","Portugal","PRC","ROC","ROK","Singapore","Turkey","UCT","Universal","US/Alaska","US/Aleutian","US/Arizona","US/Central","US/Eastern","US/East-Indiana","US/Hawaii","US/Indiana-Starke","US/Michigan","US/Mountain","US/Pacific","US/Samoa","UTC","W-SU","Zulu"],sC=[{text:"Afghanistan",value:"AF"},{text:"Albania",value:"AL"},{text:"Algeria",value:"DZ"},{text:"American Samoa",value:"AS"},{text:"Andorra",value:"AD"},{text:"Angola",value:"AO"},{text:"Anguilla",value:"AI"},{text:"Antarctica",value:"AQ"},{text:"Antigua and Barbuda",value:"AG"},{text:"Argentina",value:"AR"},{text:"Armenia",value:"AM"},{text:"Aruba",value:"AW"},{text:"Australia",value:"AU"},{text:"Austria",value:"AT"},{text:"Azerbaijan",value:"AZ"},{text:"Bahamas",value:"BS"},{text:"Bahrain",value:"BH"},{text:"Bangladesh",value:"BD"},{text:"Barbados",value:"BB"},{text:"Belarus",value:"BY"},{text:"Belgium",value:"BE"},{text:"Belize",value:"BZ"},{text:"Benin",value:"BJ"},{text:"Bermuda",value:"BM"},{text:"Bhutan",value:"BT"},{text:"Bolivia",value:"BO"},{text:"Bosnia and Herzegovina",value:"BA"},{text:"Botswana",value:"BW"},{text:"Bouvet Island",value:"BV"},{text:"Brazil",value:"BR"},{text:"British Indian Ocean Territory",value:"IO"},{text:"Brunei Darussalam",value:"BN"},{text:"Bulgaria",value:"BG"},{text:"Burkina Faso",value:"BF"},{text:"Burundi",value:"BI"},{text:"Cambodia",value:"KH"},{text:"Cameroon",value:"CM"},{text:"Canada",value:"CA"},{text:"Cape Verde",value:"CV"},{text:"Cayman Islands",value:"KY"},{text:"Central African Republic",value:"CF"},{text:"Chad",value:"TD"},{text:"Chile",value:"CL"},{text:"China",value:"CN"},{text:"Christmas Island",value:"CX"},{text:"Cocos (Keeling) Islands",value:"CC"},{text:"Colombia",value:"CO"},{text:"Comoros",value:"KM"},{text:"Congo",value:"CG"},{text:"Congo, the Democratic Republic of the",value:"CD"},{text:"Cook Islands",value:"CK"},{text:"Costa Rica",value:"CR"},{text:"C\xF4te d'Ivoire",value:"CI"},{text:"Croatia",value:"HR"},{text:"Cuba",value:"CU"},{text:"Cyprus",value:"CY"},{text:"Czech Republic",value:"CZ"},{text:"Denmark",value:"DK"},{text:"Djibouti",value:"DJ"},{text:"Dominica",value:"DM"},{text:"Dominican Republic",value:"DO"},{text:"Ecuador",value:"EC"},{text:"Egypt",value:"EG"},{text:"El Salvador",value:"SV"},{text:"Equatorial Guinea",value:"GQ"},{text:"Eritrea",value:"ER"},{text:"Estonia",value:"EE"},{text:"Ethiopia",value:"ET"},{text:"Falkland Islands (Malvinas)",value:"FK"},{text:"Faroe Islands",value:"FO"},{text:"Fiji",value:"FJ"},{text:"Finland",value:"FI"},{text:"France",value:"FR"},{text:"French Guiana",value:"GF"},{text:"French Polynesia",value:"PF"},{text:"French Southern Territories",value:"TF"},{text:"Gabon",value:"GA"},{text:"Gambia",value:"GM"},{text:"Georgia",value:"GE"},{text:"Germany",value:"DE"},{text:"Ghana",value:"GH"},{text:"Gibraltar",value:"GI"},{text:"Greece",value:"GR"},{text:"Greenland",value:"GL"},{text:"Grenada",value:"GD"},{text:"Guadeloupe",value:"GP"},{text:"Guam",value:"GU"},{text:"Guatemala",value:"GT"},{text:"Guernsey",value:"GG"},{text:"Guinea",value:"GN"},{text:"Guinea-Bissau",value:"GW"},{text:"Guyana",value:"GY"},{text:"Haiti",value:"HT"},{text:"Heard Island and McDonald Islands",value:"HM"},{text:"Holy See (Vatican City State)",value:"VA"},{text:"Honduras",value:"HN"},{text:"Hong Kong",value:"HK"},{text:"Hungary",value:"HU"},{text:"Iceland",value:"IS"},{text:"India",value:"IN"},{text:"Indonesia",value:"ID"},{text:"Iran, Islamic Republic of",value:"IR"},{text:"Iraq",value:"IQ"},{text:"Ireland",value:"IE"},{text:"Isle of Man",value:"IM"},{text:"Israel",value:"IL"},{text:"Italy",value:"IT"},{text:"Jamaica",value:"JM"},{text:"Japan",value:"JP"},{text:"Jersey",value:"JE"},{text:"Jordan",value:"JO"},{text:"Kazakhstan",value:"KZ"},{text:"Kenya",value:"KE"},{text:"Kiribati",value:"KI"},{text:"Korea, Democratic People's Republic of",value:"KP"},{text:"Korea, Republic of",value:"KR"},{text:"Kuwait",value:"KW"},{text:"Kyrgyzstan",value:"KG"},{text:"Lao People's Democratic Republic",value:"LA"},{text:"Latvia",value:"LV"},{text:"Lebanon",value:"LB"},{text:"Lesotho",value:"LS"},{text:"Liberia",value:"LR"},{text:"Libya",value:"LY"},{text:"Liechtenstein",value:"LI"},{text:"Lithuania",value:"LT"},{text:"Luxembourg",value:"LU"},{text:"Macao",value:"MO"},{text:"North Macedonia",value:"MK"},{text:"Madagascar",value:"MG"},{text:"Malawi",value:"MW"},{text:"Malaysia",value:"MY"},{text:"Maldives",value:"MV"},{text:"Mali",value:"ML"},{text:"Malta",value:"MT"},{text:"Marshall Islands",value:"MH"},{text:"Martinique",value:"MQ"},{text:"Mauritania",value:"MR"},{text:"Mauritius",value:"MU"},{text:"Mayotte",value:"YT"},{text:"Mexico",value:"MX"},{text:"Micronesia, Federated States of",value:"FM"},{text:"Moldova, Republic of",value:"MD"},{text:"Monaco",value:"MC"},{text:"Mongolia",value:"MN"},{text:"Montenegro",value:"ME"},{text:"Montserrat",value:"MS"},{text:"Morocco",value:"MA"},{text:"Mozambique",value:"MZ"},{text:"Myanmar",value:"MM"},{text:"Namibia",value:"NA"},{text:"Nauru",value:"NR"},{text:"Nepal",value:"NP"},{text:"Netherlands",value:"NL"},{text:"New Caledonia",value:"NC"},{text:"New Zealand",value:"NZ"},{text:"Nicaragua",value:"NI"},{text:"Niger",value:"NE"},{text:"Nigeria",value:"NG"},{text:"Niue",value:"NU"},{text:"Norfolk Island",value:"NF"},{text:"Northern Mariana Islands",value:"MP"},{text:"Norway",value:"NO"},{text:"Oman",value:"OM"},{text:"Pakistan",value:"PK"},{text:"Palau",value:"PW"},{text:"Palestine, State of",value:"PS"},{text:"Panama",value:"PA"},{text:"Papua New Guinea",value:"PG"},{text:"Paraguay",value:"PY"},{text:"Peru",value:"PE"},{text:"Philippines",value:"PH"},{text:"Pitcairn",value:"PN"},{text:"Poland",value:"PL"},{text:"Portugal",value:"PT"},{text:"Puerto Rico",value:"PR"},{text:"Qatar",value:"QA"},{text:"R\xE9union",value:"RE"},{text:"Romania",value:"RO"},{text:"Russian Federation",value:"RU"},{text:"Rwanda",value:"RW"},{text:"Saint Barth\xE9lemy",value:"BL"},{text:"Saint Helena, Ascension and Tristan da Cunha",value:"SH"},{text:"Saint Kitts and Nevis",value:"KN"},{text:"Saint Lucia",value:"LC"},{text:"Saint Martin (French part)",value:"MF"},{text:"Saint Pierre and Miquelon",value:"PM"},{text:"Saint Vincent and the Grenadines",value:"VC"},{text:"Samoa",value:"WS"},{text:"San Marino",value:"SM"},{text:"Sao Tome and Principe",value:"ST"},{text:"Saudi Arabia",value:"SA"},{text:"Senegal",value:"SN"},{text:"Serbia",value:"RS"},{text:"Seychelles",value:"SC"},{text:"Sierra Leone",value:"SL"},{text:"Singapore",value:"SG"},{text:"Sint Maarten (Dutch part)",value:"SX"},{text:"Slovakia",value:"SK"},{text:"Slovenia",value:"SI"},{text:"Solomon Islands",value:"SB"},{text:"Somalia",value:"SO"},{text:"South Africa",value:"ZA"},{text:"South Georgia and the South Sandwich Islands",value:"GS"},{text:"South Sudan",value:"SS"},{text:"Spain",value:"ES"},{text:"Sri Lanka",value:"LK"},{text:"Sudan",value:"SD"},{text:"Suriname",value:"SR"},{text:"Svalbard and Jan Mayen",value:"SJ"},{text:"Eswatini",value:"SZ"},{text:"Sweden",value:"SE"},{text:"Switzerland",value:"CH"},{text:"Syrian Arab Republic",value:"SY"},{text:"Taiwan, Province of China",value:"TW"},{text:"Tajikistan",value:"TJ"},{text:"Tanzania, United Republic of",value:"TZ"},{text:"Thailand",value:"TH"},{text:"Timor-Leste",value:"TL"},{text:"Togo",value:"TG"},{text:"Tokelau",value:"TK"},{text:"Tonga",value:"TO"},{text:"Trinidad and Tobago",value:"TT"},{text:"Tunisia",value:"TN"},{text:"Turkey",value:"TR"},{text:"Turkmenistan",value:"TM"},{text:"Turks and Caicos Islands",value:"TC"},{text:"Tuvalu",value:"TV"},{text:"Uganda",value:"UG"},{text:"Ukraine",value:"UA"},{text:"United Arab Emirates",value:"AE"},{text:"United Kingdom",value:"GB"},{text:"United States",value:"US"},{text:"United States Minor Outlying Islands",value:"UM"},{text:"Uruguay",value:"UY"},{text:"Uzbekistan",value:"UZ"},{text:"Vanuatu",value:"VU"},{text:"Venezuela",value:"VE"},{text:"Viet Nam",value:"VN"},{text:"Virgin Islands, British",value:"VG"},{text:"Virgin Islands, U.S.",value:"VI"},{text:"Wallis and Futuna",value:"WF"},{text:"Western Sahara",value:"EH"},{text:"Yemen",value:"YE"},{text:"Zambia",value:"ZM"},{text:"Zimbabwe",value:"ZW"}],aC=Object.defineProperty,iC=u((n,e)=>aC(n,"name",{value:e,configurable:!0}),"A$4");const np=class extends Ue{static{u(this,"v")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["text","image","audio","video","document","tools","search","reasoning"]);this.defaultModel=ct.getDefaultModel(e),this.anthropicThinkingModels=vs.getSortedModelsByFeatures("reasoning","anthropic").map(s=>s.entryId),this.openaiReasoningModels=vs.getModelsByFeatures("reasoning","openai").map(s=>s.entryId),this.searchModels=vs.getModelsByFeatures("search").map(s=>s.entryId),e.unshift("Echo");const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),this.setModelParams(t),!0}async init(){this.settings=await this.generateSettings();const e=["model","prompt","temperature","maxTokens","stopSequences","topP","topK","frequencyPenalty","presencePenalty","passthrough","useSystemPrompt","useContextWindow","maxContextWindowLength","useWebSearch","webSearchContextSize","webSearchCity","webSearchCountry","webSearchRegion","webSearchTimezone","useReasoning","maxThinkingTokens"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=[],this.properties.inputs.length==0&&(this.properties.inputs=["Input","Attachment"]);const t=this.properties.inputProps?.find(s=>s.name==="Attachment");t?(t.optional=!0,t.type="Binary"):this.properties.inputProps.push({name:"Attachment",type:"Binary",optional:!0}),this.properties.defaultOutputs=["Reply"],this.drawSettings.displayName="GenAI LLM",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Make a GenAI request to an AI model. Works with many input file types.",this.drawSettings.shortDescription="Make a GenAI request to an AI model. Works with many input file types.",this.drawSettings.color="#65a698",this._ready=!0}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){if(t!==this)return;const s=e.querySelector("form"),a=s?.querySelector("#useContextWindow"),o=s?.querySelector('[data-field-name="maxContextWindowLength"]');a.checked?o.classList.remove("hidden"):o.classList.add("hidden"),await $e(200),await ms(e,this);const r=s?.querySelector("#useWebSearch");r&&this.toggleWebSearchNestedFields(r,s);const i=s?.querySelector("#useReasoning");i&&this.toggleReasoningNestedFields(i,s)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}async modelChangeHandler(e){ct.updateFieldsInfo(e),ct.updateMaxTokens(e),ct.updateContextSize(e),ct.updateMaxThinkingTokens(e),this.setModelParams(e.value),this.settings=await this.generateSettings(),ct.toggleFields(e)}setModelParams(e){const t=window.__LLM_MODELS__?.[e]?.provider?.toLowerCase()||window.__LLM_MODELS__?.[e]?.llm?.toLowerCase(),s=Zn[t]||Zn.default;this.modelParams={allowedContextTokens:vs.getAllowedContextTokens(e),allowedCompletionTokens:vs.getAllowedCompletionTokens(e),allowedWebSearchContextTokens:vs.getWebSearchContextTokens(e),allowedReasoningTokens:vs.getMaxReasoningTokens(e),minMaxTokens:s?.minMaxTokens,maxTemperature:s?.maxTemperature,maxStopSequences:s?.maxStopSequences,maxTopP:s?.maxTopP,maxTopK:s?.maxTopK,defaultFrequencyPenalty:s?.defaultFrequencyPenalty,defaultPresencePenalty:s?.defaultPresencePenalty,maxFrequencyPenalty:s?.maxFrequencyPenalty,maxPresencePenalty:s?.maxPresencePenalty,minTopP:s?.minTopP,minTopK:s?.minTopK,defaultTemperature:s?.defaultTemperature,defaultMaxTokens:s?.defaultMaxTokens,defaultTopP:s?.defaultTopP,defaultTopK:s?.defaultTopK,hint:s.hint}}async generateSettings(){const{allowedContextTokens:e,allowedCompletionTokens:t,allowedWebSearchContextTokens:s,allowedReasoningTokens:a,maxTemperature:o,maxStopSequences:r,maxTopP:i,maxTopK:d,defaultFrequencyPenalty:c,defaultPresencePenalty:l,maxFrequencyPenalty:m,maxPresencePenalty:v,minTopP:x,minTopK:C,defaultTemperature:w,minMaxTokens:f,defaultMaxTokens:T,defaultThinkingTokens:k,defaultTopP:F,defaultTopK:O,hint:_}=this.modelParams,M="Summarize {{Input}} in one paragraph.";return{model:{type:"select",label:"Select a Model",help:"Choose an AI model to process the prompt.",hintPosition:"bottom",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:this.defaultModel,options:this.modelOptions,class:"mt-1 mb-6",dropdownHeight:350,attributes:{"data-supported-models":"all"},events:{change:async b=>{const P=b.target;await this.modelChangeHandler(P);const L=P.closest(".form-group")?.querySelector(".field-action-btn._model_pricing_link");P.value.startsWith("smythos/")?L?.classList?.remove("hidden"):L?.classList?.add("hidden");const N=P.closest("form"),z=N?.querySelector("#useWebSearch");this.toggleWebSearchNestedFields(z,N);const I=N?.querySelector("#useReasoning");I&&this.toggleReasoningNestedFields(I,N)}},actions:[{label:"Configure more models",icons:{left:{svg:ha,classes:"mr-2"},right:{svg:ma,classes:"absolute right-4"}},position:"after-dropdown",id:"configureMoreModelsBtn",classes:"custom_model_add_btn",events:{click:()=>{window.open("/vault","_blank")}}},{label:"$ View Pricing",icon:"dollar-sign",classes:"text-gray-600 top-[-8px] right-2 hover:underline _model_pricing_link hidden",tooltip:"SmythOS charges based on input and output tokens",events:{click:()=>{window.open(`${this.workspace.serverData.docUrl}/account-management/model-rates/#model-pricing`,"_blank")}}}]},prompt:{type:"textarea",label:"Prompt",validate:"required",validateMessage:"Please provide a prompt. It's required!",value:M,hint:`Your prompt is aware of any files you add to the Attachment or Binary type input.
See <a href="${Ft}/agent-studio/components/base/gen-ai-llm" class="underline" target="_blank">documentation</a>.`,hintPosition:"after_label",attributes:{"data-template-vars":"true","data-template-excluded-vars":"Attachment","data-template-excluded-var-types":"Binary","data-supported-models":"all",placeholder:`Write your AI prompt using the custom {{Input}} tags to dynamically reference the provided input and generate an LLM response. 
Ex: Please convert...`},events:{focus:b=>{const P=b.target;P.value===M&&P.select()}}},maxContextTokens:{type:"div",html:`<strong class="px-2">Context window size: <span class="tokens_num">${e?e.toLocaleString():"Unknown"}</span> tokens</strong>`,cls:"mb-0",attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,Perplexity,cohere"},section:"Advanced",help:"The total context window size includes both the request prompt length and output completion length.",class:"px-4 mb-0 bg-gray-50",tooltipIconClasses:"-ml-2 float-none",tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},webSearchContextSizeInfo:{type:"div",html:`<strong class="px-2">Search Context Size: <span class="tokens_num">${s?s.toLocaleString():"Unknown"}</span> tokens</strong>`,attributes:{"data-supported-models":this.searchModels.join(",")},section:"Advanced",help:"Web search is limited to a context window size of 128000",class:"px-4 bg-gray-50",tooltipIconClasses:"-ml-2 float-none",tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},temperature:{type:"range",label:"Temperature",min:0,max:o,value:w,step:.01,validate:`min=0 max=${o}`,validateMessage:`Allowed range 0 to ${o}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,Perplexity,cohere","data-excluded-models":this.anthropicThinkingModels.join(",")},section:"Advanced",help:_.temperature,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},maxTokens:{type:"range",label:"Maximum Output Tokens",min:f,max:t,value:T,step:4,validate:`min=${f} max=${t}`,validateMessage:`Allowed range ${f} to ${t}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,Perplexity,cohere"},section:"Advanced",help:_.maxTokens,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},stopSequences:{type:"tag",label:"Stop Sequence",maxTags:r,value:"",attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",help:_.stopSequences,tooltipClasses:"w-56 ",arrowClasses:"-ml-11",additionalHint:"Input a sequence and press Enter, Space, or Comma to add it to the list."},topP:{type:"range",label:"Top P",min:x,max:i,value:F,step:.01,validate:`min=${x} max=${i}`,validateMessage:`Allowed range ${x} to ${i}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,Perplexity,cohere","data-excluded-models":[...this.anthropicThinkingModels,...this.openaiReasoningModels].join(",")},section:"Advanced",help:_.topP,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},topK:{type:"range",label:"Top K",min:C,max:d,value:O,step:1,validate:`min=${C} max=${d}`,validateMessage:`Allowed range ${C} to ${d}`,attributes:{"data-supported-models":"GoogleAI,VertexAI,Anthropic,TogetherAI,Perplexity,cohere","data-excluded-models":this.anthropicThinkingModels.join(",")},section:"Advanced",help:_.topK,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},frequencyPenalty:{type:"range",label:"Frequency Penalty",min:0,max:m,value:c,step:.01,validate:`min=0 max=${m}`,validateMessage:`Allowed range 0 to ${m}`,attributes:{"data-supported-models":"OpenAI,TogetherAI,Perplexity,cohere"},section:"Advanced",help:_.frequencyPenalty,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},presencePenalty:{type:"range",label:"Presence Penalty",min:0,max:v,value:l,step:.01,validate:`min=0 max=${v}`,validateMessage:`Allowed range 0 to ${v}`,attributes:{"data-supported-models":"OpenAI,Perplexity,cohere"},section:"Advanced",help:_.presencePenalty,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},passthrough:{type:"checkbox",label:"Passthrough",value:!1,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere,Echo"},help:"If the component is running under a chatbot or agentLLM, The generated output will be directly streamed to the chat output",section:"Advanced",tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},useSystemPrompt:{type:"checkbox",label:"Use Agent System Prompt",value:!1,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},help:"The running Agent system prompt will be passed as a system prompt to this component",section:"Advanced",tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},useContextWindow:{type:"checkbox",label:"Use Context Window",value:!1,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},help:"The running Agent context window will be passed as a context window to this component",section:"Advanced",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",events:{change:b=>{const P=b.target,L=P.closest("form")?.querySelector('[data-field-name="maxContextWindowLength"]');P.checked?L.classList.remove("hidden"):L.classList.add("hidden")}}},maxContextWindowLength:{type:"range",label:"Max Context Window Length",min:0,max:e,step:1,value:4096,attributes:{},help:"The maximum length of the agent context window to share with the component",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:"Advanced",class:"hidden"},useReasoning:{type:"checkbox",label:"Use Reasoning",value:!1,attributes:{"data-supported-models":this.anthropicThinkingModels.join(",")},help:"Enable thinking capabilities to allow the model to break down complex problems into steps and think through solutions methodically",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:"Advanced",events:{change:b=>{const P=b.target,L=P.closest("form");this.toggleReasoningNestedFields(P,L)}}},maxThinkingTokens:{type:"range",label:"Max Thinking Tokens",min:f,max:a,value:k,step:4,help:_.maxThinkingTokens,tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:"Advanced",fieldsGroup:"Max Thinking Tokens"},...await this.getWebSearchFields()}}async getWebSearchFields(){const e=[{text:"Select a Country",value:""},...sC],t=[{text:"Select a Timezone",value:""},...nC],s={"data-supported-models":this.searchModels.join(",")};return{useWebSearch:{type:"checkbox",label:"Use Web Search",value:!1,attributes:s,help:"Allow models to search the web for the latest information before generating a response.",section:"Advanced",events:{change:a=>{const o=a.target,r=o.closest("form");this.toggleWebSearchNestedFields(o,r)}}},webSearchContextSize:{type:"select",label:"Web Search Context Size",value:"medium",attributes:s,class:"hidden",options:[{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],help:"Controls how much context is retrieved from the web to help the tool formulate a response.",section:"Advanced",fieldsGroup:"Search Context Size"},locationTitle:{type:"div",html:'<h3 class="font-bold text-md __fields_group_title">User Location</h3>',value:"",attributes:s,class:"mb-0 hidden",help:"To refine search results based on geography, you can specify an approximate user location using country, city, region, and/or timezone.",section:"Advanced",fieldsGroup:"Location"},webSearchCity:{type:"text",label:"City",value:"",attributes:s,class:"hidden",help:"The city: free text strings, like 'Minneapolis'.",validate:"maxlength=100",validateMessage:"City name cannot exceed 100 characters",section:"Advanced",fieldsGroup:"Location"},webSearchCountry:{type:"select",label:"Country",value:"",attributes:s,class:"hidden",options:e,help:"Country: a two-letter ISO country code, like 'US'.",section:"Advanced",fieldsGroup:"Location"},webSearchRegion:{type:"text",label:"Region",value:"",attributes:s,class:"hidden",help:"Region: free text strings, like 'Minnesota'.",validate:"maxlength=100",validateMessage:"Region name cannot exceed 100 characters",section:"Advanced",fieldsGroup:"Location"},webSearchTimezone:{type:"select",label:"Timezone",value:"",attributes:s,class:"hidden",options:t,help:"Timezone: an IANA timezone like America/Chicago.",section:"Advanced",fieldsGroup:"Location"}}}toggleNestedFields(e,t,s){s.forEach(a=>{const o=t?.querySelector(`[data-field-name="${a}"]`),r=e.closest(".form-group");!o||!r||(r.classList.contains("hidden")?o.classList.add("hidden"):o.classList.toggle("hidden",!e.checked))})}toggleWebSearchNestedFields(e,t){const s=["webSearchContextSize","locationTitle","webSearchCity","webSearchCountry","webSearchRegion","webSearchTimezone"];this.toggleNestedFields(e,t,s)}toggleReasoningNestedFields(e,t){const s=["maxThinkingTokens"];this.toggleNestedFields(e,t,s)}};iC(np,"GenAILLM");let oC=np;var rC=Object.defineProperty,lC=u((n,e)=>rC(n,"name",{value:e,configurable:!0}),"i$g");const sp=class extends Ue{static{u(this,"r")}async prepare(){this.name=this.data?.name||this.properties.sender?.querySelector(".name")?.textContent||"",this.desc=this.data?.desc||this.properties.sender?.getAttribute("smt-desc")||"",this.descForModel=this.data?.descForModel||this.properties.sender?.getAttribute("smt-desc-for-model")||"",this.specUrl=this.data?.specUrl||this.properties.sender?.getAttribute("smt-spec-url")||"",this.logoUrl=this.data?.logoUrl||this.properties.sender?.querySelector("img")?.src||"";const e=ct.prepareModelSelectOptionsByFeatures(["tools"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data?.model||this.data?.openAiModel||this.defaultModel;if(t&&![...e.map(s=>s?.value||s)].includes(t)){let s=Dt("Removed","text-smyth-red-500 border-smyth-red-500");t==="gpt-4-0613"&&(s+=Dt("alias of gpt-4","text-gray-500 border-gray-500")),e.push({text:t+"&nbsp;&nbsp",value:t,badge:s})}return this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={model:{type:"select",label:"Model",value:this.defaultModel,options:this.modelOptions},specUrl:{type:"hidden",value:this.specUrl},descForModel:{type:"textarea",label:"Description for Model",value:this.descForModel,validate:"maxlength=5000",validateMessage:"Your text exceeds the 5,000 character limit."}};const e=["model","specUrl","descForModel"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=["Query"],this.properties.defaultOutputs=["Output"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="+ out",this.drawSettings.addInputButton="+ in",this.drawSettings.displayName=this.name||this.constructor.name,this.drawSettings.shortDescription=this.desc||"",this._ready=!0}async run(){const e=this.properties.data?.logoUrl;Mn.call(this,e)}redraw(e=!0){const t=super.redraw(e),s=t.querySelector(".internal-name");return s.innerHTML=`<span class="internal-name-prefix gptplugin">OpenAPI</span>${this.drawSettings.displayName}`,this.data={...this.data,name:this.name,desc:this.desc,descForModel:this.descForModel,logoUrl:this.logoUrl,specUrl:this.specUrl},Mn.call(this,this.logoUrl),t}};lC(sp,"GPTPlugin");let cC=sp;var uC={inputs:{Text:{type:"string",desc:"(required) a string to be translated in the original languages",request_parameter_name:"inputs",request_parameter_type:"string"}},formatRequest:'inputs: "{{text}}"'},dC={inputs:{Text:{type:"string",desc:"(required) a string to be summarized",request_parameter_name:"inputs",request_parameter_type:"string"}},parameters:{min_length:{type:"number",default:"None",desc:"(Default: None). Integer to define the minimum length in tokens of the output summary."},max_length:{type:"number",default:"None",desc:"(Default: None). Integer to define the maximum length in tokens of the output summary."},top_k:{type:"number",default:"None",desc:"(Default: None). Integer to define the top tokens considered within the sample operation to create new text."},top_p:{type:"number",default:"None",desc:"(Default: None). Float to define the tokens that are within the sample operation of text generation. Add tokens in the sample for more probable to least probable until the sum of the probabilities is greater than top_p."},temperature:{type:"number",default:1,desc:"(Default: 1.0). Float (0.0-100.0). The temperature of the sampling operation. 1 means regular sampling, 0 means always take the highest score, 100.0 is getting closer to uniform probability."},repetition_penalty:{type:"number",default:"None",desc:"(Default: None). Float (0.0-100.0). The more a token is used within generation the more it is penalized to not be picked in successive generation passes."},max_time:{type:"number",default:"None",desc:"(Default: None). Float (0-120.0). The amount of time in seconds that the query should take maximum. Network can cause some overhead so it will be a soft limit."}},formatRequest:'inputs: "{{text}}"'},pC={inputs:{Text:{type:"string",desc:"(required) The last input from the user in the conversation.",request_parameter_name:"text",request_parameter_type:"string"},Generated_responses:{type:"string[]",desc:"A list of strings corresponding to the earlier replies from the model.",request_parameter_name:"generated_responses",request_parameter_type:"string[]"},Past_user_inputs:{type:"string[]",desc:"A list of strings corresponding to the earlier replies from the user. Should be of the same length of generated_responses.",request_parameter_name:"past_user_inputs",request_parameter_type:"string[]"}},parameters:{min_length:{type:"number",default:"None",desc:"(Default: None). Integer to define the minimum length in tokens of the output summary."},max_length:{type:"number",default:"None",desc:"(Default: None). Integer to define the maximum length in tokens of the output summary."},top_k:{type:"number",default:"None",desc:"(Default: None). Integer to define the top tokens considered within the sample operation to create new text."},top_p:{type:"number",default:"None",desc:"(Default: None). Float to define the tokens that are within the sample operation of text generation. Add tokens in the sample for more probable to least probable until the sum of the probabilities is greater than top_p."},temperature:{type:"number",default:1,desc:"(Default: 1.0). Float (0.0-100.0). The temperature of the sampling operation. 1 means regular sampling, 0 means always take the highest score, 100.0 is getting closer to uniform probability."},repetition_penalty:{type:"number",default:"None",desc:"(Default: None). Float (0.0-100.0). The more a token is used within generation the more it is penalized to not be picked in successive generation passes."},max_time:{type:"number",default:"None",desc:"(Default: None). Float (0-120.0). The amount of time in seconds that the query should take maximum. Network can cause some overhead so it will be a soft limit."}},formatRequest:'inputs: "{{text}}", past_user_inputs: [{{past_user_inputs}}], generated_responses: [{{generated_responses}}] }'},Nr={"text-classification":{inputs:{Text:{type:"string",desc:"(required) a string to be classified",request_parameter_name:"inputs",request_parameter_type:"string"}},formatRequest:'inputs: "{{text}}"'},"token-classification":{inputs:{Text:{type:"string",desc:"(required) a string to be classified",request_parameter_name:"inputs",request_parameter_type:"string"}},parameters:{aggregation_strategy:{type:"string",default:"simple",desc:"(Default: simple). There are several aggregation strategies:",supportedValues:[{value:"none",desc:"Every token gets classified without further aggregation."},{value:"simple",desc:"Entities are grouped according to the default schema (B-, I- tags get merged when the tag is similar)."},{value:"first",desc:"Same as the simple strategy except words cannot end up with different tags. Words will use the tag of the first token when there is ambiguity."},{value:"average",desc:"Same as the simple strategy except words cannot end up with different tags. Scores are averaged across tokens and then the maximum label is applied."},{value:"max",desc:"Same as the simple strategy except words cannot end up with different tags. Word entity will be the token with the maximum score."}]}},formatRequest:'inputs: "{{text}}"'},"table-question-answering":{inputs:{Query:{type:"string",desc:"(required) The query in plain text that you want to ask the table",request_parameter_name:"query",request_parameter_type:"string"},Table:{type:"string",desc:"(required) A table of data represented as a dict of list where entries are headers and the lists are all the values, all lists must have the same size.",request_parameter_name:"table",request_parameter_type:"Record<string, string[]>"}},formatRequest:'inputs: { query: "{{query}}", table: {{table}} }'},"question-answering":{inputs:{Question:{type:"string",request_parameter_name:"question",request_parameter_type:"string"},Context:{type:"string",request_parameter_name:"context",request_parameter_type:"string"}},formatRequest:'inputs: { context: "{{context}}", question: "{{question}}" }'},"document-question-answering":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"image",request_parameter_type:"Blob | ArrayBuffer"},Question:{type:"string",desc:"(required) Question about document image.",request_parameter_name:"question",request_parameter_type:"string"}},formatRequest:'inputs: { image: {{image}}, question: "{{question}}" }'},"visual-question-answering":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"image",request_parameter_type:"Blob | ArrayBuffer"},Question:{type:"string",desc:"(required) Question about visual image.",request_parameter_name:"question",request_parameter_type:"string"}},formatRequest:'inputs: { image: {{image}}, question: "{{question}}" }'},"zero-shot-classification":{inputs:{Text:{type:"string",desc:"(required) a string or list of strings",request_parameter_name:"inputs",request_parameter_type:"string | string[]"}},parameters:{candidate_labels:{type:"string[]",default:[],desc:"(required) a list of strings that are potential classes for inputs. (max 10 candidate_labels, for more, simply run multiple requests, results are going to be misleading if using too many candidate_labels anyway. If you want to keep the exact same, you can simply run multi_label=true and do the scaling on your end. )"},multi_label:{type:"boolean",default:!1,desc:"(Default: false) Boolean that is set to True if classes can overlap"}},formatRequest:'inputs: "{{text}}", parameters: { candidate_labels: [{{candidate_labels}}] }'},translation:uC,summarization:dC,conversational:pC,"text-generation":{inputs:{Text:{type:"string",desc:"(required) a string to be generated from",request_parameter_name:"inputs",request_parameter_type:"string"}},parameters:{do_sample:{type:"boolean",default:!0,desc:"(Optional: true). Bool. Whether or not to use sampling, use greedy decoding otherwise."},max_time:{type:"number",default:"None",desc:"(Default: None). Float (0-120.0). The amount of time in seconds that the query should take maximum. Network can cause some overhead so it will be a soft limit."},num_return_sequences:{type:"number",default:1,desc:"(Default: 1). Integer. The number of proposition you want to be returned."},repetition_penalty:{type:"number",default:"None",desc:"(Default: None). Float (0.0-100.0). The more a token is used within generation the more it is penalized to not be picked in successive generation passes."},return_full_text:{type:"boolean",default:!0,desc:"(Default: true). Bool. If set to False, the return results will not contain the original query making it easier for prompting."},temperature:{type:"number",default:1,desc:"(Default: 1.0). Float (0.0-100.0). The temperature of the sampling operation. 1 means regular sampling, 0 means always take the highest score, 100.0 is getting closer to uniform probability."},max_new_tokens:{type:"number",default:"None",desc:"(Default: None). Int (0-250). The amount of new tokens to be generated, this does not include the input length it is a estimate of the size of generated text you want. Each new tokens slows down the request, so look for balance between response times and length of text generated."},top_k:{type:"number",default:"None",desc:"(Default: None). Integer to define the top tokens considered within the sample operation to create new text."},top_p:{type:"number",default:"None",desc:"(Default: None). Float to define the tokens that are within the sample operation of text generation. Add tokens in the sample for more probable to least probable until the sum of the probabilities is greater than top_p."},truncate:{type:"number",default:"None",desc:"(Default: None). Integer. The maximum number of tokens from the input."}},formatRequest:'inputs: "{{text}}"'},"text2text-generation":{inputs:{Text:{type:"string",desc:"(required) a string to be generated from",request_parameter_name:"inputs",request_parameter_type:"string"}},parameters:{max_time:{type:"number",default:"None",desc:"(Default: None). Float (0-120.0). The amount of time in seconds that the query should take maximum. Network can cause some overhead so it will be a soft limit."},num_return_sequences:{type:"number",default:1,desc:"(Default: 1). Integer. The number of proposition you want to be returned."},repetition_penalty:{type:"number",default:"None",desc:"(Default: None). Float (0.0-100.0). The more a token is used within generation the more it is penalized to not be picked in successive generation passes."},temperature:{type:"number",default:1,desc:"(Default: 1.0). Float (0.0-100.0). The temperature of the sampling operation. 1 means regular sampling, 0 means always take the highest score, 100.0 is getting closer to uniform probability."},max_new_tokens:{type:"number",default:"None",desc:"(Default: None). Int (0-250). The amount of new tokens to be generated, this does not include the input length it is a estimate of the size of generated text you want. Each new tokens slows down the request, so look for balance between response times and length of text generated."},top_k:{type:"number",default:"None",desc:"(Default: None). Integer to define the top tokens considered within the sample operation to create new text."},top_p:{type:"number",default:"None",desc:"(Default: None). Float to define the tokens that are within the sample operation of text generation. Add tokens in the sample for more probable to least probable until the sum of the probabilities is greater than top_p."}},formatRequest:'inputs: "{{text}}"'},"fill-mask":{inputs:{Text:{type:"string",desc:"(required) a string to be filled from, must contain the [MASK] token (check model card for exact name of the mask)",request_parameter_name:"inputs",request_parameter_type:"string"}},formatRequest:'inputs: "{{text}}"'},"sentence-similarity":{inputs:{Source_sentence:{type:"string",desc:"(required) The string that you wish to compare the other strings with. This can be a phrase, sentence, or longer passage, depending on the model being used.",request_parameter_name:"source_sentence",request_parameter_type:"string"},Sentences:{type:"string[]",desc:"(required) A list of strings which will be compared against the source_sentence.",request_parameter_name:"sentences",request_parameter_type:"string[]"}},formatRequest:'inputs: { source_sentence: "{{source_sentence}}", sentences: [{{sentences}}] }'},"text-to-image":{inputs:{Text:{type:"string",desc:"(required) prompt to generate image from",request_parameter_name:"inputs",request_parameter_type:"string"}},formatRequest:'inputs: "{{text}}"'},"image-to-text":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{image}} "},"image-classification":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{image}}"},"object-detection":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{image}}"},"image-segmentation":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{image}}"},"zero-shot-image-classification":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"image",request_parameter_type:"Blob | ArrayBuffer"}},parameters:{candidate_labels:{type:"string[]",desc:"A list of strings that are potential classes for inputs. (max 10)"}},formatRequest:"inputs: { image: {{image}}, parameters: { candidate_labels: [{{candidate_labels}}] } }"},"image-to-image":{inputs:{Image:{type:"URL | base64 | file | SmythFileObject",desc:"(required) image URL, base64 string, uploaded image, or linked image output",request_parameter_name:"inputs",request_parameter_type:"Blob | ArrayBuffer"}},parameters:{prompt:{type:"string",desc:"(Optional) The text prompt to guide the image generation",default:"None"},strength:{type:"number",default:0,desc:"(Optional) The 'strength' parameter is effective only for SD img2img and alt diffusion img2img models. It conceptually indicates the extent of transformation applied to the reference 'image,' with values between 0 and 1. A higher 'strength' adds more noise to the initial 'image,' and the denoising process runs for the specified number of iterations in 'num_inference_steps.' A 'strength' of 1 ignores the 'image,' applying maximum added noise and running denoising for the full set of iterations."},negative_prompt:{type:"string",default:"None",desc:"(Optional) A negative prompt for the image generation"},height:{type:"number",default:"None",desc:"(Optional) The height in pixels of the generated image"},width:{type:"number",default:"None",desc:"(Optional) The width in pixels of the generated image"},num_inference_steps:{type:"number",default:"None",desc:"(Optional) The number of denoising steps. More denoising steps usually lead to a higher quality image at the expense of slower inference."},guidance_scale:{type:"number",default:"None",desc:"(Optional) Guidance scale: Higher guidance scale encourages to generate images that are closely linked to the text `prompt`, usually at the expense of lower image quality."},guess_mode:{type:"boolean",default:"None",desc:"(Optional) guess_mode only works for ControlNet models, defaults to False In this mode, the ControlNet encoder will try best to recognize the content of the input image even if you remove all prompts. The `guidance_scale` between 3.0 and 5.0 is recommended."}},formatRequest:"inputs: {{image}}"},"text-to-speech":{inputs:{Text:{type:"string",desc:"(required) a string to be converted to speech",request_parameter_name:"inputs",request_parameter_type:"string"}},formatRequest:'inputs: "{{text}}"'},"automatic-speech-recognition":{inputs:{Audio:{type:"URL | base64 | SmythFileObject",desc:"(required) audio URL, base64 string, SmythFileObject",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{audio}}"},"audio-to-audio":{inputs:{Audio:{type:"URL | base64 | SmythFileObject",desc:"(required) audio URL, base64 string, SmythFileObject",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{audio}}"},"audio-classification":{inputs:{Audio:{type:"URL | base64 | SmythFileObject",desc:"(required) audio URL, base64 string, SmythFileObject",request_parameter_name:"data",request_parameter_type:"Blob | ArrayBuffer"}},formatRequest:"data: {{audio}}"},"feature-extraction":{inputs:{Text:{type:"string | string[]",desc:"(required) a string or a list of strings to get the features from.",request_parameter_name:"inputs",request_parameter_type:"string | string[]"}},formatRequest:'inputs: "{{text}}"'}},hC=Object.defineProperty,mC=u((n,e)=>hC(n,"name",{value:e,configurable:!0}),"p$6");const ap=class extends Ue{static{u(this,"d")}async prepare(){this.name=this.data?.name||this.properties.sender?.getAttribute("smt-name")||"",this._displayName=this.data?.displayName||this.properties.sender?.querySelector(".name")?.textContent||"",this.desc=this.data?.desc||this.properties.sender?.getAttribute("smt-desc")||"",this.modelTask=this.data?.modelTask||this.properties.sender?.getAttribute("smt-model-task")||"",this.parametersInfo="",this.defaultParameters={},this.inputInfoHtml="";const e=Nr?.[this.modelTask]?.parameters;if(e)for(const s in e){const a=e[s];if(this.defaultParameters[s]=a.default,this.parametersInfo+=`<div class="comp-config-info">
                    <h6 class="info__title">${s}</h6>
                    <div class="info_item">${a?.desc}</div>
                `,a?.supportedValues?.length>0)for(const o of a.supportedValues)this.parametersInfo+=`
                            <div class="info_item">
                                <strong>${o?.value}:</strong>
                                <span>${o?.desc||""}</span>
                            </div>
                        `;this.parametersInfo+="</div>"}Nr?.[this.modelTask]?.formatRequest;const t=Nr?.[this.modelTask]?.inputs;if(t&&Object.keys(t).length>0){this.inputInfoHtml+=`
                <div class="comp-config-info">
                    <h5 class="info__title">Inputs: </h5>
            `;for(const s in t){this.properties.defaultInputs.push(s);const a=t[s];this.inputInfoHtml+=`
                    <div class="info_item">
                        <strong>${s}: </strong>
                        <span>${a?.desc||""}</span>
                    </div>
                `}this.inputInfoHtml+="<div>"}return!0}async init(){this.settings={modelNameInfo:{type:"div",html:`<div class="comp-config-info"><span><strong>Model: </strong> ${this.name}</span></div>`},modelName:{type:"hidden",value:this.name},modelTaskInfo:{type:"div",html:`<div class="comp-config-info"><span><strong>Task: </strong> ${rv(this.modelTask)}</span></div>`},modelTask:{type:"hidden",value:this.modelTask},inputsInfo:{type:"div",html:this.inputInfoHtml},accessToken:{type:"password",label:"Access Token",value:"",validate:"required maxlength=350",validateMessage:"Ensure a non-empty access token and limit text to 50 characters",attributes:{placeholder:"hf_...","data-vault":`${this.constructor.name},All`},events:{input:bs,focus:bs}},disableCache:{type:"checkbox",label:"Disable Cache",hint:"Hugging Face models automatically fetch cached responses. For a new response each time, you can Disable Cache.",value:!1}};let e=["accessToken","modelName","modelTask"];Object.keys(this.defaultParameters||{}).length>0&&(this.settings.parameters={type:"textarea",label:"Parameters",validate:"custom=isValidJsonWithoutEmptyField",validateMessage:"Provide a Valid JSON with non-empty keys/values",readonly:!0,value:JSON.stringify(this.defaultParameters,null,2),actions:[{label:"edit",events:{click:Ro.bind(this,"parameters")}}]},this.settings.parametersInfo={type:"div",html:this.parametersInfo},e.push("parameters"));for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="+ out",this.drawSettings.addInputButton="+ in",this.drawSettings.displayName=this._displayName||this.constructor.name,this.drawSettings.shortDescription=this.desc,this.properties.defaultOutputs=["Output"],this._ready=!0}async run(){const e=this.properties.data?.logoUrl;Mn.call(this,e),this.addEventListener("settingsOpened",t=>{const s=t?.querySelector("#accessToken");bs({target:s})})}redraw(e=!0){const t=super.redraw(e),s=this.properties.sender?.getAttribute("smt-name")||"",a=this.properties.sender?.querySelector(".name")?.textContent||"",o=this.properties.sender?.getAttribute("smt-desc")||"",r=this.properties.sender?.getAttribute("smt-model-task")||"",i=this.properties.sender?.querySelector("img")?.src||"",d=t.querySelector(".internal-name");return d.innerHTML=`<span class="internal-name-prefix huggingface">HuggingFace </span>${this.drawSettings.displayName}`,this.data={...this.data,name:s,displayName:a,desc:o,modelTask:r,logoUrl:i},Mn.call(this,i),t}};mC(ap,"HuggingFace");let gC=ap;const Ge={model({modelOptions:n,defaultModel:e,docUrl:t}){return{type:"select",label:"Model",hint:"Model name",value:e,options:n,events:{change:async s=>{const a=s?.target,o=a.closest(".form-group")?.querySelector(".field-action-btn._model_pricing_link");a.value.startsWith("smythos/")?o?.classList?.remove("hidden"):o?.classList?.add("hidden")}},actions:[{label:"$ View Pricing",icon:"dollar-sign",classes:"text-gray-600 top-[-8px] right-2 hover:underline _model_pricing_link hidden",tooltip:"SmythOS charges based on input and output tokens",events:{click:()=>{window.open(`${t}/#/account_management/modelRates?id=image-generation`,"_blank")}}}]}},positivePrompt(){return{type:"textarea",label:"Prompt",validate:"required minlength=2 maxlength=2000",validateMessage:"The length of the prompt must be between 2 and 2000 characters.",class:"mt-1 mb-6",value:"{{InputText}}",attributes:{"data-template-vars":"true","data-supported-models":"all"}}},negativePrompt({section:n}={}){return{type:"textarea",label:"Negative Prompt",validate:"maxlength=2000",validateMessage:"The length of the negative prompt must be less than 2000 characters.",value:"",hint:`A negative prompt is a text instruction to guide the model on generating the image. It is usually a sentence or a paragraph that provides negative guidance for the task. This parameter helps to avoid certain undesired results.
For example, if the negative prompt is "red dragon, cup", the model will follow the positive prompt but will avoid generating an image of a red dragon or including a cup. The more detailed the prompt, the more accurate the results.`,hintPosition:"left",section:n}},width({section:n}={}){return{type:"number",label:"Width",value:1024,validate:"min=128 max=2048 custom=isValidImageDimension",validateMessage:"Width must be between 128 and 2048 pixels and divisible by 64 (eg: 128...512, 576, 640...2048).",section:n}},height({section:n}={}){return{type:"number",label:"Height",value:1024,validate:"min=128 max=2048 custom=isValidImageDimension",validateMessage:"Height must be between 128 and 2048 pixels and divisible by 64 (eg: 128...512, 576, 640...2048).",section:n}},outputFormat({section:n}={}){return{type:"select",label:"Output Format",hint:"Image output format",value:"JPG",options:["JPG","PNG","WEBP"],section:n}},outputQuality({section:n}={}){return{type:"range",label:"Output Quality",value:95,min:20,max:99,step:1,hint:"Sets the compression quality of the output image. Higher values preserve more quality but increase file size, lower values reduce file size but decrease quality.",hintPosition:"left",section:n}},numberResults({section:n}={}){return{type:"range",label:"Number of Results",value:1,min:1,max:20,step:1,section:n}},strength({section:n}={}){return{type:"range",label:"Strength",value:.5,min:0,max:1,step:.1,help:"If the input includes an image attachment, a lower value results in more influence from the given image, while a higher value allows more creative deviation.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",attributes:{"data-supported-models":$s.RUNWARE},section:n}},steps({section:n}={}){return{type:"range",label:"Steps",value:20,min:1,max:100,step:1,help:`The number of steps is the number of iterations the model will perform to generate the image. The higher the number of steps, the more detailed the image will be. However, increasing the number of steps will also increase the time it takes to generate the image and may not always result in a better image (some schedulers work differently).
When using your own models you can specify a new default value for the number of steps.`,tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:n}},backgroundColor({section:n}={}){return{type:"color",label:"Background Color",value:"rgba(255, 255, 255, 0)",help:"The background color of the image. The default value is white (rgba(255, 255, 255, 0)).",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:n}},upscaleFactor({section:n}={}){return{type:"range",label:"Upscale Factor",helper:"Upscale factor",tooltipClasses:"w-36 ",arrowClasses:"-ml-11",value:2,min:2,max:4,step:1,section:n}},confidence({section:n}={}){return{type:"range",label:"Confidence",value:.25,min:0,max:1,step:.1,section:n}},maxDetections({section:n}={}){return{type:"range",label:"Max Detections",value:6,min:1,max:20,step:1,section:n}},maskPadding({section:n}={}){return{type:"range",label:"Mask Padding",value:4,min:0,max:100,step:1,section:n}},maskBlur({section:n}={}){return{type:"range",label:"Mask Blur",value:4,min:0,max:100,step:1,section:n}},preProcessorType({section:n}={}){return{type:"select",label:"Pre Processor Type",options:[{text:"Canny",value:"canny"},{text:"Depth",value:"depth"},{text:"Mlsd",value:"mlsd"},{text:"Normalbae",value:"normalbae"},{text:"Openpose",value:"openpose"},{text:"Tile",value:"tile"},{text:"Seg",value:"seg"},{text:"Lineart",value:"lineart"},{text:"Lineart Anime",value:"lineart_anime"},{text:"Shuffle",value:"shuffle"},{text:"Scribble",value:"scribble"},{text:"Softedge",value:"softedge"}],value:"none",section:n}},ipAdapters({section:n}={}){return{type:"textarea",label:"IP Adapters",value:"",hint:"IP Adapters",hintPosition:"left",section:n}},ctaButton(){return{type:"button",label:"Generate",cls:"rounded-lg px-4 py-1 h-[40px] text-white block ml-auto _image_comps_cta_btn",events:{click:async()=>{const n=document.querySelector(".debug-switcher");document.getElementById("debug-menu-tgl")?.checked||n?.click(),await $e(100),document.querySelector(".component.active").querySelector(".btn-debug")?.click()}}}}};var fC=Object.defineProperty,vC=u((n,e)=>fC(n,"name",{value:e,configurable:!0}),"a$h");const ip=class extends Ue{static{u(this,"s")}async init(){this.settings={outputFormat:Ge.outputFormat(),outputQuality:Ge.outputQuality(),backgroundColor:Ge.backgroundColor(),ctaButton:Ge.ctaButton()};const e=["outputFormat","outputQuality","backgroundColor"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputImage"];const t=this.properties.inputProps?.find(s=>s.name==="InputImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"InputImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Background Removal",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Removes background from image to isolate subject.",this.drawSettings.shortDescription="Removes background from image to isolate subject.",this.drawSettings.color="#65a698",this._ready=!0}};vC(ip,"BackgroundRemoval");let bC=ip;var yC=Object.defineProperty,xC=u((n,e)=>yC(n,"name",{value:e,configurable:!0}),"n$a");const op=class extends Ue{static{u(this,"s")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image-to-image"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={positivePrompt:Ge.positivePrompt(),model:Ge.model({modelOptions:this.modelOptions,defaultModel:this.defaultModel,docUrl:this.workspace.serverData.docUrl}),negativePrompt:Ge.negativePrompt({section:"Advanced"}),width:Ge.width({section:"Advanced"}),height:Ge.height({section:"Advanced"}),outputFormat:Ge.outputFormat({section:"Advanced"}),outputQuality:Ge.outputQuality({section:"Advanced"}),numberResults:Ge.numberResults({section:"Advanced"}),strength:Ge.strength({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["model","positivePrompt","negativePrompt","width","height","outputFormat","outputQuality","numberResults","strength"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputText","SeedImage"];const t=this.properties.inputProps?.find(s=>s.name==="SeedImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"SeedImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Image to Image",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Blend two images into a new creation.",this.drawSettings.shortDescription="Blend two images into a new creation.",this.drawSettings.color="#65a698",this._ready=!0}};xC(op,"ImageToImage");let wC=op;var SC=Object.defineProperty,CC=u((n,e)=>SC(n,"name",{value:e,configurable:!0}),"n$9");const rp=class extends Ue{static{u(this,"s")}async init(){this.settings={ctaButton:Ge.ctaButton()};const e=[];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputImage"];const t=this.properties.inputProps?.find(s=>s.name==="InputImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"InputImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Image To Text",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Convert images into text.",this.drawSettings.shortDescription="Convert images into text.",this.drawSettings.color="#65a698",this._ready=!0}};CC(rp,"ImageToText");let AC=rp;var EC=Object.defineProperty,kC=u((n,e)=>EC(n,"name",{value:e,configurable:!0}),"o$a");const lp=class extends Ue{static{u(this,"a")}async init(){this.settings={upscaleFactor:Ge.upscaleFactor({section:"Advanced"}),outputFormat:Ge.outputFormat(),outputQuality:Ge.outputQuality(),ctaButton:Ge.ctaButton()};const e=["outputFormat","outputQuality","upscaleFactor"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputImage"];const t=this.properties.inputProps?.find(s=>s.name==="InputImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"InputImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Image Upscaling",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Enhances image resolution, improving quality and sharpness.",this.drawSettings.shortDescription="Enhances image resolution, improving quality and sharpness.",this.drawSettings.color="#65a698",this._ready=!0}};kC(lp,"ImageUpscaling");let _C=lp;var PC=Object.defineProperty,IC=u((n,e)=>PC(n,"name",{value:e,configurable:!0}),"a$e");const cp=class extends Ue{static{u(this,"s")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image-inpainting"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={model:Ge.model({modelOptions:this.modelOptions,defaultModel:this.defaultModel,docUrl:this.workspace.serverData.docUrl}),outputFormat:Ge.outputFormat(),outputQuality:Ge.outputQuality(),confidence:Ge.confidence({section:"Advanced"}),maxDetections:Ge.maxDetections({section:"Advanced"}),maskPadding:Ge.maskPadding({section:"Advanced"}),maskBlur:Ge.maskBlur({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["model","outputFormat","outputQuality","confidence","maxDetections","maskPadding","maskBlur"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputImage"];const t=this.properties.inputProps?.find(s=>s.name==="InputImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"InputImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Inpainting",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Blend two images into a new creation.",this.drawSettings.shortDescription="Blend two images into a new creation.",this.drawSettings.color="#65a698",this._ready=!0}};IC(cp,"Inpainting");let LC=cp;var TC=Object.defineProperty,jC=u((n,e)=>TC(n,"name",{value:e,configurable:!0}),"r$e");const up=class extends Ue{static{u(this,"i")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image-to-image"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={positivePrompt:Ge.positivePrompt(),model:Ge.model({modelOptions:this.modelOptions,defaultModel:this.defaultModel,docUrl:this.workspace.serverData.docUrl}),negativePrompt:Ge.negativePrompt({section:"Advanced"}),width:Ge.width({section:"Advanced"}),height:Ge.height({section:"Advanced"}),outputFormat:Ge.outputFormat({section:"Advanced"}),numberResults:Ge.numberResults({section:"Advanced"}),strength:Ge.strength({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["model","positivePrompt","negativePrompt","width","height","outputFormat","numberResults","strength"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputText","SeedImage"];const t=this.properties.inputProps?.find(s=>s.name==="SeedImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"SeedImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Outpainting",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Extend your image beyond its original borders.",this.drawSettings.shortDescription="Extend your image beyond its original borders.",this.drawSettings.color="#65a698",this._ready=!0}};jC(up,"Outpainting");let OC=up;var DC=Object.defineProperty,MC=u((n,e)=>DC(n,"name",{value:e,configurable:!0}),"o$9");const dp=class extends Ue{static{u(this,"n")}async init(){this.settings={preProcessorType:Ge.preProcessorType(),width:Ge.width({section:"Advanced"}),height:Ge.height({section:"Advanced"}),outputFormat:Ge.outputFormat({section:"Advanced"}),outputQuality:Ge.outputQuality({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["width","height","outputFormat","outputQuality","preProcessorType"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputImage"];const t=this.properties.inputProps?.find(s=>s.name==="InputImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"InputImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Restyle (ControlNet)",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Generate images with precise control using a reference image and specific conditions.",this.drawSettings.shortDescription="Generate images with precise control using a reference image and specific conditions.",this.drawSettings.color="#65a698",this._ready=!0}};MC(dp,"RestyleControlNet");let NC=dp;var $C=Object.defineProperty,FC=u((n,e)=>$C(n,"name",{value:e,configurable:!0}),"r$c");const pp=class extends Ue{static{u(this,"s")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image-to-image"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={positivePrompt:Ge.positivePrompt(),model:Ge.model({modelOptions:this.modelOptions,defaultModel:this.defaultModel,docUrl:this.workspace.serverData.docUrl}),negativePrompt:Ge.negativePrompt({section:"Advanced"}),width:Ge.width({section:"Advanced"}),height:Ge.height({section:"Advanced"}),outputFormat:Ge.outputFormat({section:"Advanced"}),outputQuality:Ge.outputQuality({section:"Advanced"}),numberResults:Ge.numberResults({section:"Advanced"}),strength:Ge.strength({section:"Advanced"}),ipAdapters:Ge.ipAdapters({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["model","positivePrompt","negativePrompt","width","height","outputFormat","outputQuality","numberResults","strength","ipAdapters"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["Prompt","Image"],this.drawSettings.displayName="Restyle (IP Adapter)",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Generate images by guiding the AI with a reference image.",this.drawSettings.shortDescription="Generate images by guiding the AI with a reference image.",this.drawSettings.color="#65a698",this._ready=!0}};FC(pp,"RestyleIPAdapter");let RC=pp;var qC=Object.defineProperty,BC=u((n,e)=>qC(n,"name",{value:e,configurable:!0}),"r$b");const hp=class extends Ue{static{u(this,"i")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["text-to-image"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={positivePrompt:Ge.positivePrompt(),model:Ge.model({modelOptions:this.modelOptions,defaultModel:this.defaultModel,docUrl:this.workspace.serverData.docUrl}),negativePrompt:Ge.negativePrompt({section:"Advanced"}),width:Ge.width({section:"Advanced"}),height:Ge.height({section:"Advanced"}),outputFormat:Ge.outputFormat({section:"Advanced"}),outputQuality:Ge.outputQuality({section:"Advanced"}),numberResults:Ge.numberResults({section:"Advanced"}),steps:Ge.steps({section:"Advanced"}),ctaButton:Ge.ctaButton()};const e=["model","positivePrompt","negativePrompt","width","height","outputFormat","outputQuality","numberResults","steps"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=["InputText"];const t=this.properties.inputProps?.find(s=>s.name==="SeedImage");t?(t.optional=!1,t.type="Binary"):this.properties.inputProps.push({name:"SeedImage",type:"Binary",optional:!1}),this.drawSettings.displayName="Text to Image",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Generate images from text descriptions.",this.drawSettings.shortDescription="Generate images from text descriptions.",this.drawSettings.color="#65a698",this._ready=!0}};BC(hp,"TextToImage");let UC=hp;var zC=Object.defineProperty,wn=u((n,e)=>zC(n,"name",{value:e,configurable:!0}),"o$8"),GC=(n=>(n.DALL_E_2="dall-e-2",n.DALL_E_3="dall-e-3",n))(GC||{});const mp=class extends Ue{static{u(this,"p")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image-generation"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings=this.generateSettings();const e=["model","prompt","sizeDalle2","sizeDalle3","quality","style","isRawInputPrompt","negativePrompt","width","height","outputFormat","size"];for(let s of e)typeof this.data[s]>"u"&&(this.data[s]=this.settings?.[s]?.value);this.properties.inputs.length==0&&(this.properties.inputs=["Prompt","Attachment"]);const t=this.properties.inputProps?.find(s=>s.name==="Attachment");t?(t.optional=!0,t.type="Binary"):this.properties.inputProps.push({name:"Attachment",type:"Binary",optional:!0}),this.properties.defaultOutputs=["Output"],this.drawSettings.displayName="Image Generator",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Generate image from text descriptions using various AI image generation models",this.drawSettings.shortDescription="AI-powered text-to-image generation",this.drawSettings.color="#65a698",this._ready=!0}generateSettings(){return{model:{type:"select",withoutSearch:!0,label:"Select a model",help:"Choose an AI model to process the prompt.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:this.defaultModel,options:this.modelOptions,class:"mb-6",actions:[{label:"$ View Pricing",icon:"dollar-sign",classes:"text-gray-600 top-[-8px] right-2 hover:underline _model_pricing_link hidden",tooltip:"SmythOS charges based on input and output tokens",events:{click:()=>{window.open(`${this.workspace.serverData.docUrl}/account-management/model-rates/#image-generation`,"_blank")}}}],events:{change:async e=>{this.modelChangeHandler(e.target)}}},prompt:{type:"textarea",label:"Prompt",validate:"required minlength=2 maxlength=2000",validateMessage:"The length of the prompt must be between 2 and 2000 characters.",class:"mt-1",value:"{{Prompt}}",hint:`Your prompt is aware of any files you add to the Attachment or Binary type input.
See <a href="${Ft}/agent-studio/components/base/image-generator" class="underline" target="_blank">documentation</a>.`,hintPosition:"after_label",attributes:{"data-template-vars":"true","data-template-excluded-vars":"Attachment","data-template-excluded-var-types":"Binary","data-supported-models":"all"}},quality:{type:"select",withoutSearch:!0,label:"Quality",help:"Choose the image quality\u2014high for best clarity, medium for a balance between quality and size, or low for faster processing and smaller file size.",tooltipClasses:"w-56 ",arrowClasses:"-ml-15",value:"",options:[{text:"Standard",value:"standard"},{text:"HD",value:"hd"}],section:"Advanced",attributes:{"data-supported-models":`dall-e-3, ${Yi().join(",")}`}},outputFormat:{type:"select",withoutSearch:!0,label:"Output Format",help:"Select the output format: JPEG for smaller size, PNG for transparency support, or WebP for modern compression with good quality. ",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:"JPEG",options:["JPEG","PNG","WEBP"],section:"Advanced",attributes:{"data-supported-models":`${$s.RUNWARE}, ${Yi().join(",")}`}},...vp(this.data),...fp(this.data),...gp(this.data)}}modelChangeHandler(e){this.settings=this.generateSettings(),ct.toggleFields(e),$e(100).then(()=>{const t=e.value;yp(t,this.data)})}};wn(mp,"ImageGenerator");let HC=mp;function gp(n){return{size:{type:"select",label:"Size",help:"Choose the image size: 1024\xD71024 for square (1:1), 1536\xD71024 for landscape, or 1024\xD71536 for portrait orientation.",tooltipClasses:"w-56 ",withoutSearch:!0,arrowClasses:"-ml-15",value:n.size||"auto",options:[{text:"Auto",value:"auto"},{text:"1024x1024",value:"1024x1024"},{text:"1536x1024 (landscape)",value:"1536x1024"},{text:"1024x1536 (portrait)",value:"1024x1536"}],section:"Advanced",attributes:{"data-supported-models":Yi().join(",")}}}}u(gp,"E$2"),wn(gp,"getGPTSettings");function fp(n){return{strength:Ge.strength({section:"Advanced"}),negativePrompt:{type:"textarea",label:"Negative Prompt",validate:"maxlength=2000",validateMessage:"The length of the negative prompt must be less than 2000 characters.",value:n.negativePrompt||"",section:"Advanced",attributes:{"data-supported-models":$s.RUNWARE},help:`A negative prompt is a text instruction to guide the model on generating the image. It is usually a sentence or a paragraph that provides negative guidance for the task. This parameter helps to avoid certain undesired results.
For example, if the negative prompt is &#34;red dragon, cup&#34;, the model will follow the positive prompt but will avoid generating an image of a red dragon or including a cup. The more detailed the prompt, the more accurate the results.`,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},width:{type:"number",label:"Width",value:n.width||1024,section:"Advanced",attributes:{"data-supported-models":$s.RUNWARE},validate:"min=128 max=2048 custom=isValidImageDimension",validateMessage:"Width must be between 128 and 2048 pixels and divisible by 64 (eg: 128...512, 576, 640...2048)."},height:{type:"number",label:"Height",value:n.height||1024,section:"Advanced",attributes:{"data-supported-models":$s.RUNWARE},validate:"min=128 max=2048 custom=isValidImageDimension",validateMessage:"Height must be between 128 and 2048 pixels and divisible by 64 (eg: 128...512, 576, 640...2048)."}}}u(fp,"S$1"),wn(fp,"getRunwareSettings");function vp(n){return{sizeDalle2:{type:"select",label:"Size",withoutSearch:!0,help:"Pick the image size based on aspect ratio: 1024\xD71024 for square (1:1), 1536\xD71024 for landscape, or 1024\xD71536 for portrait orientation.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:n.sizeDalle2||"256x256",options:["256x256","512x512","1024x1024"],section:"Advanced",attributes:{"data-supported-models":"dall-e-2"}},sizeDalle3:{type:"select",withoutSearch:!0,label:"Size",help:"Pick the image size based on aspect ratio: 1024\xD71024 for square (1:1), 1792\xD71024 for landscape, or 1024\xD71792 for portrait orientation.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:n.sizeDalle3||"1024x1024",options:["1024x1024","1792x1024","1024x1792"],section:"Advanced",attributes:{"data-supported-models":"dall-e-3"}},style:{type:"select",withoutSearch:!0,label:"Style",help:"Image style",value:n.style||"vivid",options:["vivid","natural"],section:"Advanced",attributes:{"data-supported-models":"dall-e-3"}},isRawInputPrompt:{type:"checkbox",label:"Keep the Prompt as it is",value:n.isRawInputPrompt||!1,help:"I NEED to test how the tool works with extremely simple prompts. DO NOT add any detail, just use it AS-IS.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",section:"Advanced",attributes:{"data-supported-models":"dall-e-3, dall-e-2"}}}}u(vp,"A$3"),wn(vp,"getDallESettings");var VC=(n=>(n.GPT="gpt",n.RUNWARE="runware",n.DALL_E="dall-e",n))(VC||{});const bp=window.__LLM_MODELS__||{};function yp(n,e){const t=wp(n);if(!t)return;const s=WC[t];if(!s)return;const a=Object.keys(s);for(const o of a){const r=s[o];r&&xp({name:o,options:r.options,value:e[o]||r.defaultValue})}}u(yp,"M$1"),wn(yp,"redrawSelectBoxesByModel");function xp({name:n,options:e,value:t}){const s=document.getElementById(n);if(!s)return;const a=Metro.getPlugin(s,"select");a.removeOptions([...a?.elem?.options].map(o=>o.value)),e.forEach(o=>{const r=o?.text||o,i=o?.value||o,d=t==i;a.addOption(i,r,d)})}u(xp,"D"),wn(xp,"redrawSelectBox");const WC={gpt:{quality:{options:[{text:"Auto",value:"auto"},{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],defaultValue:"auto"},outputFormat:{options:[{text:"JPEG",value:"jpeg"},{text:"PNG",value:"png"},{text:"WEBP",value:"webp"}],defaultValue:"png"}},runware:{outputFormat:{options:["JPEG","PNG","WEBP"],defaultValue:"JPEG"}},"dall-e":{quality:{options:[{text:"Standard",value:"standard"},{text:"HD",value:"hd"}],defaultValue:"standard"}}};function wp(n){return $r(n)?"gpt":Sp(n)?"runware":Cp(n)?"dall-e":null}u(wp,"C$4"),wn(wp,"getModelFamily");function $r(n){return n?.replace("smythos/","")?.startsWith("gpt")}u($r,"g$2"),wn($r,"isGPTModel");function Sp(n){return Object.entries(bp).some(([e,t])=>e===n&&t.provider===$s.RUNWARE)}u(Sp,"O"),wn(Sp,"isRunwareModel");function Cp(n){return n?.replace("smythos/","")?.startsWith("dall-e")}u(Cp,"R$1"),wn(Cp,"isDallEModel");function Yi(){return Object.keys(bp).filter(n=>$r(n))}u(Yi,"u$6"),wn(Yi,"getGPTModels");var KC=Object.defineProperty,YC=u((n,e)=>KC(n,"name",{value:e,configurable:!0}),"s$b");const Ap=class extends Ue{static{u(this,"r")}async init(){this.settings={inputs:{type:"textarea",label:"Inputs",value:"",hint:"Comma separated list of inputs to wait for before triggering the outputs"}};const e=["inputs"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.inputs.length==0&&(this.properties.inputs=["Input"]),this.properties.outputs=[],this._ready=!0}redraw(e=!0){const t=super.redraw(e);t.classList.add(this.constructor.name);const s=this.domElement.querySelector(".title-bar").querySelector(".icon");return s.className="icon mif-share",this.domElement.querySelector(".btn-add-output").remove(),t}async addInput(e,t){const s=await super.addInput(e,t);return await super.addOutput(e.parentElement.querySelector(".output-container"),t),s}};YC(Ap,"InputSync");let XC=Ap;var JC=Object.defineProperty,ZC=u((n,e)=>JC(n,"name",{value:e,configurable:!0}),"i$d");const Ep=class extends Ue{static{u(this,"s")}async init(){this.settings={fields:{type:"textarea",label:"Fields",value:"",validate:"maxlength=1000",validateMessage:"Maximun 1000 characters",hint:"Comma separated json fields to keep",attributes:{"data-template-vars":""}}};const e=["fields"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=["Input"],this.properties.defaultOutputs=["Output"],this.drawSettings.displayName="JSON Filter",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Filters a JSON object based on the fields provided",this.drawSettings.shortDescription="Filters a JSON object based on the fields provided",this.drawSettings.color="#65a698",this.drawSettings.addInputButton=null,this.drawSettings.addInputButtonLabel="Inputs",this._ready=!0}};ZC(Ep,"JSONFilter");let QC=Ep;var eA=Object.defineProperty,kp=u((n,e)=>eA(n,"name",{value:e,configurable:!0}),"i$c");const _p=class extends Ue{static{u(this,"c")}constructor(){super(...arguments),this.authUrl="",this._state="",this._conCheckInterval=null}async prepare(){const e=this._uid+"::"+Date.now(),t=this.workspace.server+"/oauth2/linkedin/authUrl?state="+e;console.log("fetching authUrlReq = "+t);const s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(a=>{if(a.ok)return a.json();throw new Error("Something went wrong")}).catch(a=>{console.log(a)});return console.log({data:s}),this.authUrl=s.authUrl,this._state=e,!0}async init(){this.settings={account:{type:"input",label:"Account",value:"",attributes:{readonly:!0}},id:{type:"input",label:"Id",value:"",attributes:{readonly:!0}},token:{type:"password",label:"Token  ",value:"",attributes:{readonly:!0}},connect:{type:"button",label:"Connect",attributes:{},events:{click:e=>{window.open(this.authUrl,"_blank");const t=e.currentTarget;this._conCheckFunction=()=>this.linkedInConnectClick(t,this._state),window.addEventListener("focus",this._conCheckFunction)}}}},this.dataFields=["account","token","id"];for(let e of this.dataFields)typeof this.data[e]>"u"&&(this.data[e]=this.settings[e].value);this.properties.defaultOutputs=["Success","Error"],this.properties.defaultInputs=["Post"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton=null,this.drawSettings.showSettings=!0,this._ready=!0}async run(){return this.addEventListener("settingsClosed",()=>{this.cancelLinkedInConnect(),(!this.data.account||!this.data.token)&&this.domElement.classList.add("missing-config")}),this.addEventListener("settingsSaved",()=>{this.data.account&&this.data.token&&this.domElement.classList.remove("missing-config")}),!this.data.account||!this.data.token?this.domElement.classList.add("missing-config"):this.domElement.classList.remove("missing-config"),!0}async cancelLinkedInConnect(){clearInterval(this._conCheckInterval)}async linkedInConnectClick(e,t){const s=e.closest("form");console.log("start checking linkedIn auth state"),window.removeEventListener("focus",this._conCheckFunction);const a=`${this.workspace.server}/oauth2/linkedin/authState?state=${t}&scope=r_liteprofile r_emailaddress w_member_social`;let o=5;const r=kp(async()=>{console.log("checking linkedIn auth state");const i=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(d=>{if(d.ok)return d.json();throw new Error("Something went wrong")}).catch(d=>{console.log(d)});i&&i.access_token&&i.account&&i.id&&(clearInterval(this._conCheckInterval),s.querySelector('[name="account"]').value=i.account,s.querySelector('[name="id"]').value=i.id,s.querySelector('[name="token"]').value=i.access_token),o--,o==0&&clearInterval(this._conCheckInterval)},"checkAuth");this._conCheckInterval=setInterval(r,5e3),r()}};kp(_p,"LinkedIn");let tA=_p;var nA=Object.defineProperty,sA=u((n,e)=>nA(n,"name",{value:e,configurable:!0}),"n$5");const Pp=class extends Ue{static{u(this,"i")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["text"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={model:{type:"select",label:"Select a Model",help:"Primary language model<br />Used for chat and chatbot interactions<br />Affects response quality and capabilities",hintPosition:"bottom",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",value:this.defaultModel,options:this.modelOptions,dropdownHeight:350,events:{change:a=>{if(!a.target.value)return;const o=document.querySelector("#right-sidebar #modelInfo");o.innerHTML=this.renderModelInfo(a.target.value)}},actions:[{label:"Configure more models",icons:{left:{svg:ha,classes:"mr-2"},right:{svg:ma,classes:"absolute right-4"}},position:"after-dropdown",id:"configureMoreModelsBtn",classes:"custom_model_add_btn",events:{click:()=>{window.open("/vault","_blank")}}}]},modelInfo:{type:"div",cls:"model-info",label:"Model Info",html:this.renderModelInfo.bind(this)},behavior:{type:"textarea",label:"Behavior",class:"mb-6",validate:"required maxlength=30000",validateMessage:"The behavior prompt should be a non empty text of less than 30,000 characters",value:"You are a helpful assistant that helps people with their questions",attributes:{"data-template-vars":"true"},help:"Describe how the agent should behave\u2014include tone, decision-making style, or specific actions it should take when responding.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11"},passthrough:{type:"checkbox",label:"Passthrough",value:!1,attributes:{"data-supported-models":"all"},section:"Advanced",help:`Passthrough mode gives you control over what gets streamed to users. Enable it to manually handle assistant outputs before they're shown\u2014ideal for custom logic or post-processing.<br /><a href="${Ft}/agent-studio/components/advanced/llm-assistant" target="_blank">See LLM Assistant guide \u2192</a>`,tooltipClasses:"w-56 ",arrowClasses:"-ml-11"}};const e=["model","behavior"];for(let a of e)typeof this.data[a]>"u"&&(this.data[a]=this.settings[a].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=["UserId","ConversationId","UserInput"],this.properties.inputs.length==0&&(this.properties.inputs=["UserId","ConversationId","UserInput"]),this.properties.inputProps||(this.properties.inputProps=[]);const t=this.properties.inputProps?.find(a=>a.name==="ConversationId");t?t.optional=!0:this.properties.inputProps.push({name:"ConversationId",optional:!0});const s=this.properties.inputProps?.find(a=>a.name==="UserId");s?s.optional=!0:this.properties.inputProps.push({name:"UserId",optional:!0}),this.properties.defaultOutputs=["Response"],this.drawSettings.displayName="LLM Assistant",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Use LLM to handle a chat conversation",this.drawSettings.shortDescription="LLM Assistant - Handles a chat conversation",this.drawSettings.color="#65a698",this._ready=!0}renderModelInfo(e=this.data.model){let t="";const s=window.__LLM_MODELS__;if(s){const a=s[e];a&&(t+="<ul>",t+=`<li><b>Provider </b> ${a?.llm?a.llm:"Unknown"}</li>`,t+=`<li><b>Context Window Size: </b> ${a?.tokens?a.tokens:"Unknown"}</li>`,t+=`<li><b>Maximum Output Tokens </b> ${a?.completionTokens?a.completionTokens:"Unknown"}</li>`,t+="</ul>",!a.hasKey&&!a.isCustomLLM&&(t+="<hr/><p>The capabilities of this model are limited, enter an API Key to raise the limits</p>"))}return t}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this),e.querySelector("#model"))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}};sA(Pp,"LLMAssistant");let aA=Pp;var iA=Object.defineProperty,oA=u((n,e)=>iA(n,"name",{value:e,configurable:!0}),"i$a");const Ip=class extends Ue{static{u(this,"e")}async init(){this.settings={};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Verified","Unverified"],this.properties.defaultInputs=[],this.drawSettings.showSettings=!1,this.drawSettings.cssClass="logic-component",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#333",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.componentDescription="Set the output to true if all the inputs are set, otherwise set it to false"}};oA(Ip,"LogicAND");let rA=Ip;var lA=Object.defineProperty,cA=u((n,e)=>lA(n,"name",{value:e,configurable:!0}),"s$9");const Lp=class extends Ue{static{u(this,"i")}async init(){this.settings={minSetInputs:{type:"number",label:"Minimum Inputs",hint:"Minimum number of set inputs to trigger output",value:"",validate:"required max=9 min=0 custom=isValidInteger",validateMessage:"Please enter a positive number between 0 and 9."}};const e=["minSetInputs"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Verified","Unverified"],this.properties.defaultInputs=[],this.drawSettings.showSettings=!0,this.drawSettings.cssClass="logic-component",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#333",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.componentDescription="Set the output to true if minimumn number of inputs are set, otherwise set it to false"}};cA(Lp,"LogicAtLeast");let uA=Lp;var dA=Object.defineProperty,pA=u((n,e)=>dA(n,"name",{value:e,configurable:!0}),"s$8");const Tp=class extends Ue{static{u(this,"i")}async init(){this.settings={maxSetInputs:{type:"number",label:"Maximum Inputs",hint:"Maximum number of set inputs to trigger output",value:"",validate:"required max=9 min=0 custom=isValidInteger",validateMessage:"Please enter a positive number between 0 and 9."}};const e=["maxSetInputs"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Verified","Unverified"],this.properties.defaultInputs=[],this.drawSettings.showSettings=!0,this.drawSettings.cssClass="logic-component",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#333",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.componentDescription="Set the output to true if a maximum number of inputs are set, if the maximum is exceeded, output does not trigger"}};pA(Tp,"LogicAtMost");let hA=Tp;var mA=Object.defineProperty,gA=u((n,e)=>mA(n,"name",{value:e,configurable:!0}),"i$7");const jp=class extends Ue{static{u(this,"s")}async init(){this.settings={};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Verified","Unverified"],this.properties.defaultInputs=[],this.drawSettings.showSettings=!1,this.drawSettings.cssClass="logic-component",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#333",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.componentDescription="Set the output to true if one or more inputs are set, otherwise the output is not set"}};gA(jp,"LogicOR");let fA=jp;var vA=Object.defineProperty,bA=u((n,e)=>vA(n,"name",{value:e,configurable:!0}),"i$6");const Op=class extends Ue{static{u(this,"s")}async init(){this.settings={};const e=[];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Verified","Unverified"],this.properties.defaultInputs=[],this.drawSettings.showSettings=!1,this.drawSettings.cssClass="logic-component",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.color="#333",this.drawSettings.addOutputButton=null,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.addInputButton="Input",this.drawSettings.componentDescription="Set the output true if a single inputs is set, if an even number of inputs are set the output does not take a value"}};bA(Op,"LogicXOR");let yA=Op;var xA=Object.defineProperty,wA=u((n,e)=>xA(n,"name",{value:e,configurable:!0}),"i$5");const Dp=class extends Ue{static{u(this,"r")}async prepare(){this.name=this.data?.name||this.properties.sender?.querySelector(".name")?.textContent||"",this.desc=this.data?.desc||this.properties.sender?.getAttribute("smt-desc")||"",this.descForModel=this.data?.descForModel||this.properties.sender?.getAttribute("smt-desc-for-model")||"",this.mcpUrl=this.data?.mcpUrl||this.properties.sender?.getAttribute("smt-mcp-url")||"",this.logoUrl=this.data?.logoUrl||this.properties.sender?.querySelector("img")?.src||"";const e=ct.prepareModelSelectOptionsByFeatures(["tools"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data?.model||this.data?.openAiModel||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),!0}async init(){this.settings={mcpUrl:{type:"textarea",value:"",validate:"required",label:"MCP URL",validateMessage:"MCP URL is required"},prompt:{type:"textarea",label:"Prompt",value:"{{Prompt}}",validate:"required",validateMessage:"Prompt is required",attributes:{"data-template-vars":"true","data-template-excluded-vars":"Attachment","data-template-excluded-var-types":"Binary","data-supported-models":"all"}},model:{type:"select",label:"Model",value:this.defaultModel,options:this.modelOptions},descForModel:{type:"textarea",label:"System Prompt",hint:"The system prompt can be used to customize the behavior of your MCP",section:"Advanced",value:this.descForModel,validate:"maxlength=5000",validateMessage:"Your text exceeds the 5,000 character limit."}};const e=["model","mcpUrl","descForModel","prompt"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.inputs.length==0&&(this.properties.inputs=["Prompt"]),this.properties.defaultOutputs=["Output"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="Outputs",this.drawSettings.addInputButton="Inputs",this.drawSettings.displayName=this.name||this.constructor.name,this.drawSettings.shortDescription=this.desc||"",this._ready=!0}async run(){const e=this.properties.data?.logoUrl;Mn.call(this,e)}redraw(e=!0){const t=super.redraw(e);return this.data={...this.data,name:this.name,desc:this.desc,descForModel:this.descForModel,logoUrl:this.logoUrl,mcpUrl:this.mcpUrl},Mn.call(this,this.logoUrl),t}};wA(Dp,"MCPClient");let SA=Dp;var CA=Object.defineProperty,AA=u((n,e)=>CA(n,"name",{value:e,configurable:!0}),"r$7");const Mp=class extends Ue{static{u(this,"s")}async init(){this.settings={name:{type:"input",label:"name",value:"",hint:"Enter memory name"},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}},this.data={},this.properties.defaultOutputs=["_list"],this.properties.defaultInputs=["_reset"],this.drawSettings.showSettings=!1,this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addInputButton=null,this.drawSettings.addOutputButton=" + Mem Entry"}outputNameExists(e){return!!(this.outputContainer.querySelector(`.output-endpoint[smt-name="${e}"]`)||this.inputContainer.querySelector(`.input-endpoint[smt-name="${e}"]`))}async addOutput(e,t){if(this.properties.defaultInputs.includes(t))return super.addOutput(e,t);const s=await super.addOutput(e,t),a=e.parentElement.querySelector(".input-container"),o=await super.addInput(a,t);return s.querySelector(".ep").setAttribute("smt-con-thickness","8"),s.querySelector(".ep").setAttribute("smt-con-hide-overlays","true"),s._inputDivElement=o,o._outputDivElement=s,this.repaint(),s}async addInput(e,t){return this.properties.defaultInputs.includes(t)?super.addInput(e,t):null}async deleteEndpoint(e){console.log("deleting"),super.deleteEndpoint(e);const t=e._inputDivElement||e._outputDivElement;e._inputDivElement&&(e.inputDivElement=null),e._outputDivElement&&(e.outputDivElement=null),t&&super.deleteEndpoint(t)}async run(){return this.addEventListener("endpointNameChanged",(e,t,s)=>{console.log("endpointNameChanged",e,t,s);const a=e.classList.contains("input-endpoint")?e:e._inputDivElement,o=e.classList.contains("output-endpoint")?e:e._outputDivElement,r=a.getAttribute("smt-name"),i=o.getAttribute("smt-name");r!=s&&(a.setAttribute("smt-name",s),a.querySelector(".name").innerText=s),i!=s&&(o.setAttribute("smt-name",s),o.querySelector(".name").innerText=s)}),!0}};AA(Mp,"Memory");let EA=Mp;var kA=Object.defineProperty,_A=u((n,e)=>kA(n,"name",{value:e,configurable:!0}),"e$6");const Np=class extends Ue{static{u(this,"t")}async init(){this.settings={name:{type:"input",label:"name",value:"",hint:"Enter memory name",validate:"maxlength=50",validateMessage:"Enter a non-empty name, not more than 50 characters."},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}},this.data={},this.properties.defaultOutputs=[],this.properties.defaultInputs=["Key"],this.drawSettings.iconCSSClass="svg-icon Memory "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton="Mem Entry",this.drawSettings.addOutputButtonLabel=" "}};_A(Np,"MemoryDeleteKey");let PA=Np;var IA=Object.defineProperty,LA=u((n,e)=>IA(n,"name",{value:e,configurable:!0}),"e$5");const $p=class extends Ue{static{u(this,"t")}async init(){this.settings={name:{type:"input",label:"name",value:"",hint:"Enter memory name",validate:"maxlength=50",validateMessage:"Enter a non-empty name, not more than 50 characters."},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}},this.data={},this.properties.defaultOutputs=["Value"],this.properties.defaultInputs=["Key"],this.drawSettings.iconCSSClass="svg-icon Memory "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton=null,this.drawSettings.addInputButtonLabel=" "}};LA($p,"MemoryReadKeyVal");let TA=$p;var jA=Object.defineProperty,OA=u((n,e)=>jA(n,"name",{value:e,configurable:!0}),"e$4");const Fp=class extends Ue{static{u(this,"t")}async init(){this.settings={name:{type:"input",label:"name",value:"",hint:"Enter memory name",validate:"maxlength=50",validateMessage:"Enter a non-empty name, not more than 50 characters."},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}},this.data={},this.properties.defaultOutputs=[],this.properties.defaultInputs=[],this.drawSettings.showSettings=!1,this.drawSettings.iconCSSClass="svg-icon Memory "+this.constructor.name,this.drawSettings.addInputButton=null,this.drawSettings.addOutputButton="Mem Slot",this.drawSettings.addInputButtonLabel=" "}};OA(Fp,"MemoryReadOutput");let DA=Fp;var MA=Object.defineProperty,NA=u((n,e)=>MA(n,"name",{value:e,configurable:!0}),"e$3");const Rp=class extends Ue{static{u(this,"t")}async init(){this.settings={name:{type:"input",label:"name",value:"",hint:"Enter memory name",validate:"maxlength=50",validateMessage:"Enter a non-empty name, not more than 50 characters."},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}},this.data={},this.properties.defaultOutputs=[],this.properties.defaultInputs=[],this.drawSettings.displayName="Memory Slot Write",this.drawSettings.shortDescription="Write to memory by slot name",this.drawSettings.showSettings=!1,this.drawSettings.iconCSSClass="svg-icon Memory "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton="Mem Slot",this.drawSettings.addOutputButtonLabel=" "}};NA(Rp,"MemoryWriteInput");let $A=Rp;var FA=Object.defineProperty,RA=u((n,e)=>FA(n,"name",{value:e,configurable:!0}),"s$4");const qp=class extends Ue{static{u(this,"a")}async init(){this.settings={memoryName:{type:"input",label:"Memory Name",value:"",hint:"Enter memory name",validate:"maxlength=50",validateMessage:"Enter a non-empty name, not more than 50 characters."},key:{type:"textarea",label:"Key",value:"{{key}}",hint:"Enter key",validate:"maxlength=50",attributes:{"data-template-vars":"true"}},value:{type:"textarea",label:"Value",value:"{{value}}",hint:"Enter value",attributes:{"data-template-vars":"true"}},scope:{type:"select",label:"Scope",hint:"Memory Scope",value:"Session",options:["Session"]}};const e=["key","value"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.data={},this.properties.defaultOutputs=["Key","Value"],this.properties.defaultInputs=[],this.properties.inputs.length==0&&(this.properties.inputs=["Key","Value"]),this.drawSettings.iconCSSClass="svg-icon Memory "+this.constructor.name,this.drawSettings.addOutputButton=" ",this.drawSettings.addInputButton="Mem Entry",this.drawSettings.addOutputButtonLabel=" "}};RA(qp,"MemoryWriteKeyVal");let qA=qp;var BA=Object.defineProperty,UA=u((n,e)=>BA(n,"name",{value:e,configurable:!0}),"o$6");const Bp=class extends Ue{static{u(this,"a")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image","audio","video","document"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data?.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),this.setModelParams(t),!0}async init(){this.settings=this.generateSettings();const e=["model","prompt","maxTokens"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=["Input"],this.properties.defaultOutputs=["Reply"],this.drawSettings.displayName="Multimodal LLM",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="The Multimodal component processes information from different modalities, including images, videos, and text, using LLMs to generate context-aware outputs based on prompts and input variables.",this.drawSettings.shortDescription="Processes multimodal inputs (images, videos, text) to generate context-aware outputs.",this.drawSettings.color="#65a698",this._ready=!0}modelChangeHandler(e){const t=e.target;t.closest(".select.smt-input-select").classList.contains("focused")&&(fi.updateMaxTokens(e),this.setModelParams(t.value||this.defaultModel),this.settings=this.generateSettings()),fi.toggleFields(e)}setModelParams(e){const t=window.__LLM_MODELS__?.[e]?.provider?.toLowerCase()||window.__LLM_MODELS__?.[e]?.llm?.toLowerCase(),s=Zn[t]||Zn.default;this.modelParams={allowedContextTokens:qo(e),allowedCompletionTokens:Bo(e),hint:s?.hint}}generateSettings(){const{allowedContextTokens:e,allowedCompletionTokens:t,hint:s}=this.modelParams;return{model:{type:"select",label:"Model",hint:"Model name",value:this.defaultModel,options:this.modelOptions,events:{change:this.modelChangeHandler.bind(this)},attributes:{"data-supported-models":"all"}},prompt:{type:"textarea",label:"Prompt",class:"mb-6",validate:"required",validateMessage:"Please provide a prompt. It's required!",value:"What is the video about?",attributes:{"data-template-vars":"true"}},maxContextTokens:{type:"div",html:`<strong class="px-2">Context window size: <span class="tokens_num">${e?e.toLocaleString():"Unknown"}</span> tokens</strong><br/>`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:"The total context window size includes both the request prompt length and output completion length.",hintPosition:"left",class:"p-4"},maxTokens:{type:"range",label:"Maximum Output Tokens",min:1,max:t,value:300,step:1,validate:`min=1 max=${t}`,validateMessage:`Allowed range 1 to ${t}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:s.maxTokens,hintPosition:"left"},passthrough:{type:"checkbox",label:"Passthrough",value:!1,attributes:{"data-supported-models":"all"},section:"Advanced"}}}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}};UA(Bp,"MultimodalLLM");let zA=Bp;var GA=Object.defineProperty,HA=u((n,e)=>GA(n,"name",{value:e,configurable:!0}),"u$5");const Up=class extends Ue{static{u(this,"d")}async init(){this.settings={description:{type:"textarea",label:"Description",value:"",help:"Add a note's text content to keep track of ideas, tasks, or reminders.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",hintPosition:"bottom",validate:"maxlength=5000",validateMessage:"Your text exceeds the 5,000 character limit."},textColor:{type:"color",label:"Text Color",class:"w-full",value:"#000000",help:"Choose the color of the note's text to improve readability or match your style.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",hintPosition:"bottom",events:{change:t=>{this.domElement.style.color=t.target.value;const s=this.domElement.querySelector(".title .text");s&&(s.style.color=t.target.value)}}},color:{type:"color",label:"Background Color",class:"w-full",value:"#c7ff1529",help:"Set the background color of the note to organize or highlight different types of information.",tooltipClasses:"w-56 ",arrowClasses:"-ml-11",events:{change:t=>{this.domElement.style.backgroundColor=t.target.value}}}};const e=["color","textColor"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);!this.data._noteHeight&&this.properties.height&&(this.data._noteHeight=this.properties.height),this.properties.defaultOutputs=[],this.properties.defaultInputs=[],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton=null,this.drawSettings.componentDescription="",this.drawSettings.shortDescription="",this.drawSettings.color="#ff00f2",this.drawSettings.showSettings=!0,this?.domElement?.style?.zIndex&&(this.domElement.style.zIndex="1"),setTimeout(()=>{const t=this.domElement?.querySelector(".title .text");t&&t.style.color!==(this.data.textColor||"#000")&&(t.style.color=this.data.textColor||"#000")},550)}async run(){return this.addEventListener("settingsSaved",e=>{this.domElement.querySelector(".note-text").innerHTML=this.data.description,this.domElement.style.backgroundColor=this.data.color,this.domElement.style.borderColor=this.data.color,this.domElement.style.color=this.data.textColor;const t=this.domElement.querySelector(".title .text");t&&(t.style.color=this.data.textColor)}),!0}redraw(e=!1){const t=super.redraw(e);t.style.backgroundColor=this.data.color,t.style.borderColor=this.data.color,t.style.color=this.data.textColor,t.style.zIndex||(t.style.zIndex="1"),this.properties.width&&(t.style.width=this.properties.width),this.data._noteHeight?t.style.height=this.data._noteHeight:this.properties.height&&(t.style.height=this.properties.height,this.data._noteHeight=this.properties.height);const s=t.querySelector(".title .text");s&&(s.style.color=this.data.textColor),t.querySelector(".title-bar .description").classList.add("hidden"),t.querySelector(".title-bar .icon").classList.add("hidden"),t.querySelector(".debug-bar").classList.add("hidden"),t.querySelector(".ep-control.inputs").classList.add("hidden"),t.querySelector(".ep-control.outputs").classList.add("hidden"),t.querySelector(".input-container").classList.add("hidden"),t.querySelector(".output-container").classList.add("hidden"),t.querySelector(".button-container").classList.add("hidden");const a=document.createElement("pre");a.classList.add("note-text"),a.innerHTML=this.data.description||"",t.appendChild(a);const o=document.createElement("div");o.classList.add("resize-handle"),t.appendChild(o),a.addEventListener("wheel",d=>{d.stopPropagation()});const r=this,i=this.workspace;return Qn(t).resizable({edges:{left:!1,right:!0,bottom:!0,top:!1},listeners:{start(d){if(i?.locked||[...r.domElement.querySelectorAll(".pinned")].length>0)return!1;r.domElement.classList.add("resizing")},move(d){if(i?.locked||[...r.domElement.querySelectorAll(".pinned")].length>0)return!1;const c=d.target,l=Math.round(d.rect.width/i.scale)+"px",m=Math.round(d.rect.height/i.scale)+"px";c.style.width=l,c.style.height=m,r.properties.width=l,r.properties.height=m,r.data._noteHeight=m,r.repaint(!1)},end(d){if(i?.locked||[...r.domElement.querySelectorAll(".pinned")].length>0)return!1;const c=r.domElement.style.height;c&&(r.properties.height=c,r.data._noteHeight=c),r.repaint(),setTimeout(()=>{r.workspace.saveAgent(),r.domElement.classList.remove("resizing")},200)}},modifiers:[Qn.modifiers.restrictSize({min:{width:100,height:50}})],inertia:!1}),t}addDebugButton(){}};HA(Up,"Note");let VA=Up;var WA=Object.defineProperty,KA=u((n,e)=>WA(n,"name",{value:e,configurable:!0}),"u$4");const zp=class extends Ue{static{u(this,"o")}async init(){this.settings={endpoint:{type:"input",label:"Endpoint",value:"",validate:"required maxlength=50 custom=isValidEndpoint",validateMessage:"Provide a valid endpoint that only contains 'a-z', 'A-Z', '0-9', '-', '_' , without leading or trailing spaces.",hint:"Enter endpoint name"},ai_exposed:{type:"checkbox",label:"Expose to AI",value:!0,hint:"If checked, the endpoint can be used by AI (e.g. ChatGPT, Chatbot, ...)",events:{change:this.exposeIAChangeHandler.bind(this)}},description:{type:"textarea",label:"Instructions",value:"",hint:"Instructions for AI Agent, Describes how to use this endpoint when exposed to an LLM",validate:"maxlength=5000",validateMessage:"Your text exceeds the 5,000 character limit."},summary:{type:"textarea",label:"Description",value:"",hint:"Short description of the endpoint, used for documentation",validate:"maxlength=1000",validateMessage:"Your text exceeds the 1,000 character limit."}};const e=["endpoint","description","ai_exposed","summary"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.inputSettings={...this.inputSettings,description:{type:"string",label:"Description",default:"",editConfig:{type:"textarea"}},isFile:{type:"boolean",editConfig:{type:"checkbox",label:"Binary Input",value:!1,cls:"hidden"}}},this.properties.defaultOutputs=["headers","body","query"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="Request Parts",this.drawSettings.addInputButton="Parameters",this.drawSettings.showSettings=!0,this.drawSettings.inputMaxConnections=0,this.drawSettings.shortDescription="HTTP API Endpoint - Expose your agent as a REST API",this.drawSettings.color="#b700f1",this._ready=!0}async exposeIAChangeHandler(e){console.log(e,e.target,e.target.checked);const t=e.target.closest("form");if(!t)return;const s=t.querySelector('.form-box[data-field-name="description"]');s&&(e.target.checked?s.classList.remove("hidden"):s.classList.add("hidden"))}inputNameExists(e){return!!(this.inputContainer.querySelector(`.input-endpoint[smt-name="${e}"]`)||this.outputContainer.querySelector(`.output-endpoint[smt-name="${e}"]`))}async addInput(e,t){if(this.properties.defaultOutputs.includes(t))return super.addInput(e,t);const s=await super.addInput(e,t),a=e.parentElement.querySelector(".output-container"),o=`body.${t}`,r=await super.addOutput(a,o);return s.querySelector(".ep").setAttribute("smt-con-thickness","8"),s.querySelector(".ep").setAttribute("smt-con-hide-overlays","true"),s._outputDivElement=r,r._inputDivElement=s,this.repaint(),s}async addOutput(e,t){return this.properties.defaultOutputs.includes(t)?super.addOutput(e,t):null}async deleteEndpoint(e){console.log("deleting"),super.deleteEndpoint(e);const t=e._outputDivElement||e._inputDivElement;e._outputDivElement&&(e.outputDivElement=null),e._inputDivElement&&(e.inputDivElement=null),t&&super.deleteEndpoint(t)}async run(){this.addEventListener("settingsOpened",async e=>{await $e(50);const t=e.querySelector('.form-box[data-field-name="description"]');t&&(this.data.ai_exposed?t.classList.remove("hidden"):t.classList.add("hidden"))}),this.addEventListener("endpointChanged",(e,t,s,a)=>{if(e!="name")return;console.log("endpointNameChanged",t,s,a);const o=t.classList.contains("input-endpoint")?t:t._inputDivElement,r=t.classList.contains("output-endpoint")?t:t._outputDivElement,i=o.getAttribute("smt-name"),d=r.getAttribute("smt-name");if(i!=a&&(o.setAttribute("smt-name",a),o.querySelector(".name").innerText=a),d!=a){const c=`body.${a}`;r.setAttribute("smt-name",c),r.querySelector(".name").innerText=c}})}};KA(zp,"POST_APIEndpoint");let YA=zp;var XA=Object.defineProperty,JA=u((n,e)=>XA(n,"name",{value:e,configurable:!0}),"u$3");const Gp=class extends Ue{static{u(this,"m")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["text"]);this.defaultModel=ct.getDefaultModel(e),e.unshift("Echo");const t=this.data.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),this.setModelParams(t),!0}async init(){this.settings=this.generateSettings();const e=["model","prompt","temperature","maxTokens","stopSequences","topP","topK","frequencyPenalty","presencePenalty"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.outputSettings={...this.outputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultInputs=[],this.properties.inputs.length==0&&(this.properties.inputs=["Input"]),this.properties.defaultOutputs=["Reply"],this.drawSettings.displayName="LLM Prompt",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Use LLM to generate output based on prompt and input variables",this.drawSettings.shortDescription="LLM - Generates output based on prompt and input variables",this.drawSettings.color="#65a698",this._ready=!0}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this),e.querySelector("#model"))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}modelChangeHandler(e){e.closest(".select.smt-input-select"),Uo.updateFieldsInfo(e),Uo.updateMaxTokens(e),this.setModelParams(e.value||this.defaultModel),this.settings=this.generateSettings(),Uo.toggleFields(e)}setModelParams(e){const t=window.__LLM_MODELS__?.[e]?.provider?.toLowerCase()||window.__LLM_MODELS__?.[e]?.llm?.toLowerCase(),s=Zn[t]||Zn.default;this.modelParams={allowedContextTokens:qo(e),allowedCompletionTokens:Bo(e),maxTemperature:s?.maxTemperature,maxStopSequences:s?.maxStopSequences,maxTopP:s?.maxTopP,maxTopK:s?.maxTopK,maxFrequencyPenalty:s?.maxFrequencyPenalty,maxPresencePenalty:s?.maxPresencePenalty,minTopP:s?.minTopP,minTopK:s?.minTopK,defaultTemperature:s?.defaultTemperature,defaultMaxTokens:s?.defaultMaxTokens,defaultTopP:s?.defaultTopP,defaultTopK:s?.defaultTopK,hint:s.hint}}generateSettings(){const{allowedContextTokens:e,allowedCompletionTokens:t,maxTemperature:s,maxStopSequences:a,maxTopP:o,maxTopK:r,maxFrequencyPenalty:i,maxPresencePenalty:d,minTopP:c,minTopK:l,defaultTemperature:m,defaultMaxTokens:v,defaultTopP:x,defaultTopK:C,hint:w}=this.modelParams;return{model:{type:"select",label:"Model",hint:"Model name",value:this.defaultModel,options:this.modelOptions,dropdownHeight:350,attributes:{"data-supported-models":"all"},events:{change:f=>this.modelChangeHandler(f.target)},actions:[{label:"Configure more models",icons:{left:{svg:ha,classes:"mr-2"},right:{svg:ma,classes:"absolute right-4"}},position:"after-dropdown",id:"configureMoreModelsBtn",classes:"custom_model_add_btn",events:{click:()=>{window.open("/vault","_blank")}}}]},prompt:{type:"textarea",label:"Prompt",validate:"required",class:"mt-1 mb-6",validateMessage:"Please provide a prompt. It's required!",value:`Summarize the input text
Input : {{Input}}`,attributes:{"data-template-vars":"true","data-supported-models":"all"}},maxContextTokens:{type:"div",html:`<strong class="px-2">Context window size: <span class="tokens_num">${e?e.toLocaleString():"Unknown"}</span> tokens</strong><br/>`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:"The total context window size includes both the request prompt length and output completion length.",hintPosition:"left",class:"p-4"},temperature:{type:"range",label:"Temperature",min:0,max:s,value:m,step:.01,validate:`min=0 max=${s}`,validateMessage:`Allowed range 0 to ${s}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:w.temperature,hintPosition:"left"},maxTokens:{type:"range",label:"Maximum Output Tokens",min:1,max:t,value:v,step:1,validate:`min=1 max=${t}`,validateMessage:`Allowed range 1 to ${t}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:w.maxTokens,hintPosition:"left"},stopSequences:{type:"tag",label:"Stop Sequence",maxTags:a,value:"",attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:w.stopSequences,hintPosition:"left",additionalHint:"Input a sequence and press Enter, Space, or Comma to add it to the list."},topP:{type:"range",label:"Top P",min:c,max:o,value:x,step:.01,validate:`min=${c} max=${o}`,validateMessage:`Allowed range ${c} to ${o}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:w.topP,hintPosition:"left"},topK:{type:"range",label:"Top K",min:l,max:r,value:C,step:1,validate:`min=${l} max=${r}`,validateMessage:`Allowed range ${l} to ${r}`,attributes:{"data-supported-models":"GoogleAI,VertexAI,Anthropic,TogetherAI,cohere"},section:"Advanced",hint:w.topK,hintPosition:"left"},frequencyPenalty:{type:"range",label:"Frequency Penalty",min:0,max:i,value:0,step:.01,validate:`min=0 max=${i}`,validateMessage:`Allowed range 0 to ${i}`,attributes:{"data-supported-models":"OpenAI,TogetherAI,cohere"},section:"Advanced",hint:w.frequencyPenalty,hintPosition:"left"},presencePenalty:{type:"range",label:"Presence Penalty",min:0,max:d,value:0,step:.01,validate:`min=0 max=${d}`,validateMessage:`Allowed range 0 to ${d}`,attributes:{"data-supported-models":"OpenAI,cohere"},section:"Advanced",hint:w.presencePenalty,hintPosition:"left"},passthrough:{type:"checkbox",label:"Passthrough",value:!1,attributes:{"data-supported-models":"all"},section:"Advanced"}}}};JA(Gp,"PromptGenerator");let ZA=Gp;var QA=Object.defineProperty,eE=u((n,e)=>QA(n,"name",{value:e,configurable:!0}),"a$5");const Hp=class extends Ue{static{u(this,"s")}async init(){this.settings={url:{type:"input",label:"URL",validate:"required maxlength=8192 custom=isUrlValid",validateMessage:"Provide a valid URL",attributes:{"data-template-vars":"true"}}};const e=["url"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=[],this.properties.defaultInputs=[],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.outputMaxConnections=0,this.drawSettings.addOutputButtonLabel=" ",this.drawSettings.color="#8600f1"}};eE(Hp,"Redirect");let tE=Hp;var nE=Object.defineProperty,Vp=u((n,e)=>nE(n,"name",{value:e,configurable:!0}),"o$4");const Wp=class extends Ue{static{u(this,"d")}constructor(){super(...arguments),this.domains=["[NONE]"],this.errorLoading=""}async prepare(){return!0}async init(){this.settings={span:{type:"span",html:'<span class="">Schedule Job</span>',label:"Config jobs",value:"",actions:[{cls:"float-right",label:"add",id:"addJobs",events:{click:lv.bind(this,"jobs")}}]},jobs:{type:"hidden",value:""}};const e=["jobs","span"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.inputSettings={...this.inputSettings,description:{type:"string",default:"",editConfig:{type:"textarea"}}},this.properties.defaultOutputs=["headers","body","query"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="Request Parts",this.drawSettings.addInputButton="Parameters",this.drawSettings.showSettings=!0,this.drawSettings.inputMaxConnections=0,this.drawSettings.shortDescription="Scheduler Endpoint - Run your agent on a schedule",this.drawSettings.color="#b700f1",this._ready=!0}async run(){const e=Vp(t=>t.classList.contains("input-endpoint"),"isInput");this.addEventListener("settingsOpened",async(t,s)=>{s==this&&(console.log("sidebar",t),await this.drawSchedulerJobsUI(t))}),this.addEventListener("endpointRemoved",async(t,s)=>{if(this.data.jobs!==""&&this.data.jobs!=="{}"&&this.data.jobs!=="[]"){const a=document.querySelector("#right-sidebar .form-section"),o=await zo(this,"job-details");a?.appendChild(o)}}),this.addEventListener("endpointChanged",async(t,s,a,o)=>{const r=JSON?.parse(this.data.jobs)||[];if(t==="name"&&e(s)){let i=r.length&&r?.map(c=>(c[`${a}`]!==void 0&&(c[`${o}`]=c[`${a}`],delete c[`${a}`]),c));const d=JSON?.stringify(i);if(this.data.jobs=d,this.settings.jobs.value=d,this.editSettings(),this.data.jobs!==""&&this.data.jobs!=="{}"&&this.data.jobs!=="[]"){const c=document.querySelector("#right-sidebar .form-section"),l=await zo(this,"job-details");c?.appendChild(l)}}})}async drawSchedulerJobsUI(e){if(this.data.jobs!==""&&this.data.jobs!=="{}"&&this.data.jobs!=="[]"){let t=e?.querySelector(".form-section");const s=await zo(this,"job-details");t?.appendChild(s)}}};Vp(Wp,"SchedulerEndpoint");let sE=Wp;var aE=Object.defineProperty,iE=u((n,e)=>aE(n,"name",{value:e,configurable:!0}),"d$3");const Kp=class extends Ue{static{u(this,"c")}constructor(){super(...arguments),this.templateSupport=!0}async init(){const e=`/*
* Enter packages imports here
*/
import dayjs from 'dayjs';`,t=`/*
* Enter code body here
* return value is bound to component Output endpoint
*/
return dayjs().format();`;this.settings={code_imports:{type:"textarea",code:{mode:"javascript",theme:"chrome"},label:"Code Editor",value:e,attributes:{class:"code-imports","data-scroll-margin-top":5,"data-scroll-margin-bottom":5,"data-scroll-margin-left":0,"data-scroll-margin-right":0},classOverride:"code-imports-container"},function_label:{type:"div",html:`
        <div class="code-editor-label-container-wrapper">
        <div class="code-editor-label-container" id="function-label-top-container">
          <div class="code-editor-label-container-left-border"></div>
          <div id="function-label-text" class="code-editor-label-container-right-border">async main() {</div>
        </div>
        </div>`,label:"",attributes:{labelCase:"none"},classOverride:"function-label-container"},code_body:{type:"textarea",code:{mode:"javascript",theme:"chrome",disableWorker:!0},label:"",value:t,validate:"maxlength=500000",validateMessage:"The code length is limitted to 500,000 characters",attributes:{labelCase:"none",class:"code-body","data-scroll-margin-top":5,"data-scroll-margin-bottom":5,"data-scroll-margin-left":0,"data-scroll-margin-right":0},classOverride:"code-body-container"},function_label_end:{type:"div",html:`
        <div class="code-editor-label-container">
          <div class="code-editor-label-container-left-border"></div>
          <div class="code-editor-label-container-right-border">}</div>
        </div>`,label:"",attributes:{labelCase:"none"},classOverride:"function-label-container"},pricing_note:{type:"div",html:'<div class="pricing-note">* This component will incur cloud usage cost. Configure your custom keys in advance to avoid extra charges.</div>',label:"",attributes:{class:"pricing-note"}},...this.isLegacyPlan()?{}:{use_own_keys:{type:"toggle",label:"Use Custom Cloud Keys",value:!1,display:"inline",events:{change:this.useOwnKeysChangeHandler.bind(this)},section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`,attributes:{},classOverride:"use-own-keys"}},hintSelect:{type:"p",html:"<small>NodeJS is executed in AWS Lambda. You can bring your own keys or use our default keys.</small>",section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`,attributes:{class:"hint-select mt-[-30px]"}},accessKeyId:{type:"input",label:"AWS Access Key ID",value:"",validate:`${this.isLegacyPlan()?"required":""} maxlength=350`,validateMessage:"Ensure a non-empty AWS Access Key ID",attributes:{placeholder:"Select AWS Access Key ID","data-vault":"All","data-vault-exclusive":!0},events:{input:i=>bs(i,"AWS_ACCESS_KEY_ID"),focus:i=>bs(i,"AWS_ACCESS_KEY_ID")},section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`},secretAccessKey:{type:"input",label:"AWS Secret Access Key",value:"",validate:`${this.isLegacyPlan()?"required":""}maxlength=350`,validateMessage:"Ensure a non-empty AWS Secret Access Key",attributes:{placeholder:"Select AWS Secret Access Key","data-vault":"All","data-vault-exclusive":!0},events:{input:i=>bs(i,"AWS_SECRET_ACCESS_KEY"),focus:i=>bs(i,"AWS_SECRET_ACCESS_KEY")},section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`},region:{type:"select",label:"Region",value:"us-east-1",options:[{text:"US East (N. Virginia) - us-east-1",value:"us-east-1"},{text:"US East (Ohio) - us-east-2",value:"us-east-2"},{text:"US West (N. California) - us-west-1",value:"us-west-1"},{text:"US West (Oregon) - us-west-2",value:"us-west-2"},{text:"Africa (Cape Town) - af-south-1",value:"af-south-1"},{text:"Asia Pacific (Hong Kong) - ap-east-1",value:"ap-east-1"},{text:"Asia Pacific (Mumbai) - ap-south-1",value:"ap-south-1"},{text:"Asia Pacific (Osaka) - ap-northeast-3",value:"ap-northeast-3"},{text:"Asia Pacific (Seoul) - ap-northeast-2",value:"ap-northeast-2"},{text:"Asia Pacific (Singapore) - ap-southeast-1",value:"ap-southeast-1"},{text:"Asia Pacific (Sydney) - ap-southeast-2",value:"ap-southeast-2"},{text:"Asia Pacific (Tokyo) - ap-northeast-1",value:"ap-northeast-1"},{text:"Canada (Central) - ca-central-1",value:"ca-central-1"},{text:"EU (Frankfurt) - eu-central-1",value:"eu-central-1"},{text:"EU (Ireland) - eu-west-1",value:"eu-west-1"},{text:"EU (London) - eu-west-2",value:"eu-west-2"},{text:"EU (Milan) - eu-south-1",value:"eu-south-1"},{text:"EU (Paris) - eu-west-3",value:"eu-west-3"},{text:"EU (Stockholm) - eu-north-1",value:"eu-north-1"},{text:"Middle East (Bahrain) - me-south-1",value:"me-south-1"},{text:"South America (S\xE3o Paulo) - sa-east-1",value:"sa-east-1"}],help:"Select AWS Region for Lambda",section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`},role:{type:"div",html:"<div></div>",label:"Assigned Role",section:`${this.isLegacyPlan()?"Credentials":"Advanced"}`}};const s=["code_imports","code_body","use_own_keys"];for(let i of s)typeof this.data[i]>"u"&&(this.data[i]=this.settings[i]?.value);this.properties.defaultInputs=[],this.properties.defaultOutputs=["Output"],this.properties.outputs.length==0&&(this.properties.outputs=["Output","_error"]),this.drawSettings.displayName="NodeJS";const a=this.properties.template?.templateInfo?.icon||"",o=this.properties.template?.templateInfo?.color||"#000000",r=a&&a.startsWith("<svg");this.drawSettings.iconCSSClass=a?`tpl-fa-icon ${a}`:`svg-icon ${this.constructor.name}`,this.drawSettings.color=a?o:"#00BCD4",r&&(this.drawSettings.iconCSSClass=a),this.data.use_own_keys=!this.doHideAWSKeys(this.data),this.drawSettings.componentDescription="Execute code in a NodeJS environment",this.drawSettings.shortDescription="Execute code in a NodeJS environment",this._ready=!0}async run(){this.addEventListener("endpointAdded",this.updateCodeVars.bind(this)),this.addEventListener("endpointRemoved",this.updateCodeVars.bind(this)),this.addEventListener("endpointChanged",this.updateCodeVars.bind(this)),this.addEventListener("settingsOpened",async(e,t)=>{if(t!==this)return;const s=e.querySelector("#code_imports");if(s){s.classList.add("hidden");const r=s._editor;r&&(r.session.setOption("useWorker",!1),r.clearSelection())}const a=e.querySelector("#code_body");if(a){a.classList.add("hidden");const r=a._editor;r&&r.clearSelection()}const o=document.querySelector('[data-field-name="role"]');o&&o.classList.add("hidden"),this.setFunctionLabelStyling(),this.setCodeBodyTitle([]),this.toggleAWSKeys(this.isLegacyPlan()?!1:this.doHideAWSKeys(this.data))})}doHideAWSKeys(e){return e?.use_own_keys?!1:!this.isLegacyPlan()&&!e?.use_own_keys?!0:!(e?.accessKeyId&&e?.secretAccessKey&&e?.region)}setFunctionLabelStyling(){const e=document.querySelector('[data-field-name="function_label"]');e&&e.setAttribute("style","margin-top: 0 !important; margin-bottom: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; padding-right: 0 !important;");const t=document.querySelector('[data-field-name="function_label_end"]');t&&t.setAttribute("style","margin-top: 0 !important; margin-bottom: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; padding-right: 0 !important;")}useOwnKeysChangeHandler(e){const t=e.target.closest("form");if(!t)return;const s=t.querySelector('[data-field-name="accessKeyId"]'),a=t.querySelector('[data-field-name="secretAccessKey"]'),o=t.querySelector('[data-field-name="region"]');!s||!a||!o||(e.target.checked?this.toggleAWSKeys(!1):this.toggleAWSKeys(!0))}async updateRole(){const e=await this.fetchDeploymentStatus();if(e?.data){const t=e.data.role.split("/").pop(),s=`
        <a style="text-decoration: underline" href="${`https://${this.data.region}.console.aws.amazon.com/iam/home?region=${this.data.region}#/roles/details/${t}?section=permissions`}" target="_blank">Manage AWS Role</a>`,a=document.querySelector("#role");(a&&this.data.use_own_keys||this.isLegacyPlan())&&(a.innerHTML=s,document.querySelector('[data-field-name="role"]').classList.remove("hidden"))}}async toggleAWSKeys(e){const t=document.querySelector('[data-field-name="accessKeyId"]'),s=document.querySelector('[data-field-name="secretAccessKey"]'),a=document.querySelector('[data-field-name="region"]'),o=document.querySelector('[data-field-name="role"]'),r=document.querySelector('[data-field-name="hintSelect"]');!t||!s||!a||(e?(t.classList.add("hidden"),s.classList.add("hidden"),a.classList.add("hidden"),o.classList.add("hidden"),r.classList.add("hidden")):(t.classList.remove("hidden"),s.classList.remove("hidden"),a.classList.remove("hidden"),r.classList.remove("hidden"),await this.updateRole()))}validateServerlessCode(e){return e.split(`
`).every(t=>t.trim()===""||!cv.test(t))}async fetchDeploymentStatus(){return(await fetch("/api/page/builder/serverless-code/get-deployment-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:this.workspace.agent.id,componentId:Ue.curComponentSettings.uid,awsConfigs:{accessKeyId:this.data.accessKeyId,secretAccessKey:this.data.secretAccessKey,region:this.data.region}})})).json()}setCodeBodyTitle(e){if(this.getSettingsSidebar()){const t=e&&e.length?e:this.properties.inputs,s=document.querySelector("#function-label-text");s&&(s.textContent=`async main(${t.join(", ")}) {`)}}async updateCodeVars(){const e=[...this.domElement.querySelectorAll(".input-container .input-endpoint")].map(t=>t.getAttribute("smt-name"));this.setCodeBodyTitle(e)}exportTemplate(){let e=JSON.parse(JSON.stringify(this.data));const t={};e.code_body=e.code_body||"",e.code_body=this.parseTemplateString(e.code_body,t);const s=this.properties.inputProps,a=this.properties.outputProps;return{name:this.title,componentName:this.constructor.name,description:this.description,settings:t,data:e,inputs:s,outputs:a}}isLegacyPlan(){return this.workspace.teamData.isLegacyPlan}};iE(Kp,"ServerlessCode");let oE=Kp;var rE=Object.defineProperty,lE=u((n,e)=>rE(n,"name",{value:e,configurable:!0}),"i$3");const Yp=class extends Ue{static{u(this,"e")}async init(){this.settings={phone:{type:"input",label:"Phone Number",value:"",hint:"+1 555 555 5555"}};const e=["phone"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.outputs=["Success","Error"],this.properties.inputs.length==0&&(this.properties.inputs=["Input"]),this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addInputButton=null,this._ready=!0}};lE(Yp,"SMSSender");let cE=Yp;var uE=Object.defineProperty,dE=u((n,e)=>uE(n,"name",{value:e,configurable:!0}),"s$2");const Xp=class extends Ue{static{u(this,"r")}async init(){const e=this.properties.sender?.getAttribute("provider")||"";this.settings={format:{type:"input",label:"Format",value:e,attributes:{readonly:"readonly"}}};const t=["format"];for(let s of t)typeof this.data[s]>"u"&&(this.data[s]=this.settings[s].value);this.properties.inputs.length==0&&(this.properties.inputs=["Text"]),this.properties.outputs=["Audio"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addInputButton=null,this.drawSettings.addOutputButton=null,this._ready=!0}redraw(e=!0){const t=super.redraw(e),s=this.properties.sender?.querySelector(".icon").className||"icon mif-file-empty",a=this.domElement.querySelector(".title-bar").querySelector(".icon");return a.className=s,t}};dE(Xp,"TTS");let pE=Xp;var hE=Object.defineProperty,Jp=u((n,e)=>hE(n,"name",{value:e,configurable:!0}),"c$3");const Zp=class extends Ue{static{u(this,"r")}constructor(){super(...arguments),this.authUrl="",this._state="",this._conCheckInterval=null}async prepare(){const e=this._uid+"::"+Date.now(),t=this.workspace.server+"/oauth2/twitter/authUrl?state="+e;console.log("fetching authUrlReq = "+t);const s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(a=>{if(a.ok)return a.json();throw new Error("Something went wrong")}).catch(a=>{console.log(a)});return console.log({data:s}),this.authUrl=s.authUrl,this._state=e,!0}async init(){this.settings={account:{type:"input",label:"Account",value:"",attributes:{readonly:!0}},token:{type:"password",label:"Token",value:"",attributes:{readonly:!0}},secret:{type:"password",label:"Secret",value:"",attributes:{readonly:!0}},connect:{type:"button",label:"Connect",attributes:{},events:{click:e=>{window.open(this.authUrl,"_blank");const t=e.currentTarget;this._conCheckFunction=()=>this.twitterConnectClick(t,this._state),window.addEventListener("focus",this._conCheckFunction)}}}},this.dataFields=["account","token","secret"];for(let e of this.dataFields)typeof this.data[e]>"u"&&(this.data[e]=this.settings[e].value);this.properties.defaultOutputs=["Success","Error","id"],this.properties.defaultInputs=["message","id"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton=null,this.drawSettings.addInputButton=null,this.drawSettings.showSettings=!0,this._ready=!0}async run(){return this.addEventListener("settingsClosed",()=>{this.cancelTwitterConnect(),(!this.data.account||!this.data.token)&&this.domElement.classList.add("missing-config")}),this.addEventListener("settingsSaved",()=>{this.data.account&&this.data.token&&this.domElement.classList.remove("missing-config")}),!this.data.account||!this.data.token?this.domElement.classList.add("missing-config"):this.domElement.classList.remove("missing-config"),!0}async cancelTwitterConnect(){clearInterval(this._conCheckInterval)}async twitterConnectClick(e,t){const s=e.closest("form");console.log("start checking twitter auth state"),window.removeEventListener("focus",this._conCheckFunction);const a=`${this.workspace.server}/oauth2/twitter/authState?state=${t}&scope=tweet.read users.read follows.read follows.write tweet.write offline.access`;let o=5;const r=Jp(async()=>{console.log("checking twitter auth state");const i=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(d=>{if(d.ok)return d.json();throw new Error("Something went wrong")}).catch(d=>{console.log(d)});i&&i.access_token&&i.access_token_secret&&i.account&&(clearInterval(this._conCheckInterval),s.querySelector('[name="account"]').value=i.account,s.querySelector('[name="token"]').value=i.access_token,s.querySelector('[name="secret"]').value=i.access_token_secret),o--,o==0&&clearInterval(this._conCheckInterval)},"checkAuth");this._conCheckInterval=setInterval(r,5e3),r()}};Jp(Zp,"Twitter");let mE=Zp;var gE=Object.defineProperty,fE=u((n,e)=>gE(n,"name",{value:e,configurable:!0}),"i$2");const Qp=class extends Ue{static{u(this,"a")}async prepare(){const e=ct.prepareModelSelectOptionsByFeatures(["image"]);this.defaultModel=ct.getDefaultModel(e);const t=this.data?.model||this.defaultModel;return t&&![...e.map(s=>s?.value||s)].includes(t)&&e.push({text:t+"&nbsp;&nbsp",value:t,badge:Dt("Removed","text-smyth-red-500 border-smyth-red-500")}),this.modelOptions=e.filter(s=>s),this.setModelParams(this.data?.model),!0}async init(){this.settings=this.generateSettings();const e=["model","prompt","maxTokens"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultInputs=["Images"],this.properties.defaultOutputs=["Reply"],this.drawSettings.displayName="Vision LLM",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Vision LLM enables image processing and answering questions related to the visual content.",this.drawSettings.shortDescription="Answers questions related given image(s).",this.drawSettings.color="#65a698",this._ready=!0}modelChangeHandler(e){const t=e.target;t.closest(".select.smt-input-select").classList.contains("focused")&&(fi.updateMaxTokens(e),this.setModelParams(t.value),this.settings=this.generateSettings()),fi.toggleFields(e)}setModelParams(e){const t=window.__LLM_MODELS__?.[e]?.provider?.toLowerCase()||window.__LLM_MODELS__?.[e]?.llm?.toLowerCase(),s=Zn[t]||Zn.default;this.modelParams={allowedContextTokens:qo(e),allowedCompletionTokens:Bo(e),hint:s?.hint}}generateSettings(){const{allowedContextTokens:e,allowedCompletionTokens:t,hint:s}=this.modelParams;return{model:{type:"select",label:"Model",hint:"Model name",value:this.defaultModel,options:this.modelOptions,events:{change:this.modelChangeHandler.bind(this)},attributes:{"data-supported-models":"all"}},prompt:{type:"textarea",label:"Prompt",class:"mb-6",validate:"required",validateMessage:"Please provide a prompt. It's required!",value:"What\u2019s in this image?",attributes:{"data-template-vars":"true"}},maxContextTokens:{type:"div",html:`<strong class="px-2">Context window size: <span class="tokens_num">${e?e.toLocaleString():"Unknown"}</span> tokens</strong><br/>`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:"The total context window size includes both the request prompt length and output completion length.",hintPosition:"left",class:"p-4"},maxTokens:{type:"range",label:"Maximum Output Tokens",min:1,max:t,value:300,step:1,validate:`min=1 max=${t}`,validateMessage:`Allowed range 1 to ${t}`,attributes:{"data-supported-models":"OpenAI,Anthropic,GoogleAI,Groq,xAI,TogetherAI,VertexAI,Bedrock,cohere"},section:"Advanced",hint:s.maxTokens,hintPosition:"left"},passthrough:{type:"checkbox",label:"Passthrough",value:!1,attributes:{"data-supported-models":"all"},section:"Advanced"}}}async run(){this.addEventListener("settingsOpened",this.handleSettingsOpened.bind(this))}async handleSettingsOpened(e,t){t===this&&(await $e(200),await ms(e,this))}async handleElementClick(e){await Ns(e,this)}async saveApiKey(e,t,s){return await gs(e,t,s,this.workspace,this.refreshLLMModels.bind(this))}async refreshLLMModels(){await fs(this.workspace,this.prepare.bind(this),this.init.bind(this),this.refreshSettingsSidebar.bind(this))}};fE(Qp,"VisionLLM");let vE=Qp;var bE=Object.defineProperty,yE=u((n,e)=>bE(n,"name",{value:e,configurable:!0}),"s$1");const eh=class extends Ue{static{u(this,"a")}async init(){this.settings={format:{type:"select",label:"Format",hint:"Format of the results",value:"markdown",options:[{text:"Markdown",value:"markdown"},{text:"Markdown (Exclude images)",value:"markdown:no_images"},{text:"Markdown (Exclude links)",value:"markdown:no_links"},{text:"Raw",value:"raw"},{text:"Text",value:"text"},{text:"Clean HTML",value:"clean_html"},{text:"JSON",value:"json"}]},antiScrapingProtection:{type:"checkbox",label:"Bypass Anti-Bot Protection",help:"Enable if the website is protected by bot detection methods like Captchas.",value:!1},javascriptRendering:{type:"checkbox",label:"Javascript Rendering",help:"This will render the page using a headless browser and extract the text and images. Useful for websites that use javascript to load content.",value:!1},autoScroll:{type:"checkbox",label:"Auto Scroll",help:"To automatically scroll the page till the bottom and extract the text and images. Useful for websites that load content on scroll.",value:!1}};const e=["format","antiScrapingProtection","javascriptRendering","autoScroll"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Results","FailedURLs"],this.properties.inputs.length==0&&(this.properties.inputs=["URLs"]),this.drawSettings.displayName="Web Scrape",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Extract text and images from URLs",this.drawSettings.shortDescription="Extract text and images from URLs",this.drawSettings.color="#65a698",this._ready=!0}};yE(eh,"WebScrape");let xE=eh;var wE=Object.defineProperty,SE=u((n,e)=>wE(n,"name",{value:e,configurable:!0}),"a$1");const th=class extends Ue{static{u(this,"s")}async init(){this.settings={sourcesLimit:{type:"number",label:"Sources Limit",help:"The maximum number of search results to return. Ceiling is 20.",value:4,validate:"min=1 max=20"},searchTopic:{type:"select",label:"Search Topic",value:"general",options:["general","news"],help:"This will optimize the search for the selected topic. Currently, only supports &#34;general&#34; and &#34;news&#34; (default: &#34;general&#34;)."},includeQAs:{type:"checkbox",label:"Include Questions and Answers",help:"If selected, includes a rich summary based on the information found in the results. Response time will be longer if selected.",value:!1},includeImages:{type:"checkbox",label:"Include Image Results",help:"If selected, includes public images relevant to the query.",value:!1},timeRange:{type:"select",label:"Time Range",value:"None",options:["None","day","week","month","year"],help:"[Optional] Select the time range to filter the search results."},includeRawContent:{type:"checkbox",label:"Include Raw Content",help:"If selected, returns the parsed html content for each source.",value:!0},excludeDomains:{type:"textarea",label:"Exclude Domains",help:"A list of domains to exclude from search results. Separate multiple domains with a comma.",value:""}};const e=["sourcesLimit","searchTopic","includeQAs","includeImages","timeRange","includeRawContent","excludeDomains"];for(let t of e)typeof this.data[t]>"u"&&(this.data[t]=this.settings[t].value);this.properties.defaultOutputs=["Results","Images","Answer"],this.properties.defaultInputs=["SearchQuery"],this.drawSettings.displayName="Web Search",this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.componentDescription="Fetch web results from a query",this.drawSettings.shortDescription="Fetch web results from a query",this.drawSettings.color="#65a698",this._ready=!0}};SE(th,"WebSearch");let CE=th;var AE=Object.defineProperty,EE=u((n,e)=>AE(n,"name",{value:e,configurable:!0}),"e$1");const nh=class extends Ue{static{u(this,"a")}async prepare(){if(this.actionId=this.data?.actionId||this.properties.sender?.getAttribute("smt-id")||"",this.actionName=this.data?.actionName||this.properties.sender?.getAttribute("smt-name")||"",this.params=this.data?.params||this.properties.sender?.getAttribute("smt-params")||"",this.logoUrl=this.data?.logoUrl||this.properties.sender?.querySelector("img")?.src||"",this.apiKey=this.data?.apiKey||this.properties.sender?.getAttribute("smt-api-key")||"",this.params){const e=JSON.parse(this.params||"{}"),t=[];for(const s in e)t.push(s);this.inputs=t}return!0}async init(){this.properties.defaultInputs=this.inputs,this.properties.defaultOutputs=["Output"],this.drawSettings.iconCSSClass="svg-icon "+this.constructor.name,this.drawSettings.addOutputButton="+ out",this.drawSettings.addInputButton="",this.drawSettings.displayName=this.actionName||this.constructor.name,this.drawSettings.shortDescription=this.actionName||"",this.drawSettings.showSettings=!1,this._ready=!0}redraw(e=!0){const t=super.redraw(e),s=t.querySelector(".internal-name");return s.innerHTML=`<span class="internal-name-prefix zapier">Zapier </span>${this.drawSettings.displayName}`,this.data={...this.data,actionName:this.actionName,actionId:this.actionId,logoUrl:this.logoUrl,apiKey:this.apiKey,params:this.params},Mn.call(this,this.logoUrl),t.setAttribute("data-action-id",this.actionId),t}};EE(nh,"ZapierAction");let kE=nh;const Xi={Component:Ue,Classifier:nS,PromptGenerator:ZA,InputSync:XC,DataSourceLookup:vS,GPTPlugin:cC,EmailSender:CS,FileExport:qS,TTS:pE,SMSSender:cE,DBInsert:xS,APIEndpoint:Bw,APICall:Rw,Memory:EA,Twitter:mE,LinkedIn:tA,APIOutput:Gw,LogicAND:rA,LogicOR:fA,LogicXOR:yA,LogicAtLeast:uA,LogicAtMost:hA,Base64Encoder:Qw,HuggingFace:gC,AgentPlugin:Nw,ZapierAction:kE,MemoryWriteInput:$A,MemoryWriteKeyVal:qA,MemoryReadOutput:DA,MemoryReadKeyVal:TA,Note:VA,SchedulerEndpoint:sE,JSONFilter:QC,DataSourceIndexer:mS,DataSourceCleaner:dS,Code:iS,ServerlessCode:oE,ForEach:VS,VisionLLM:vE,LLMAssistant:aA,Redirect:tE,Async:Ww,FCrypto:PS,FHash:$S,FSign:YS,FEncDec:jS,FSleep:ZS,FTimestamp:tC,Await:Xw,POST_APIEndpoint:YA,MemoryDeleteKey:PA,MultimodalLLM:zA,GenAILLM:oC,FileStore:zS,WebScrape:xE,WebSearch:CE,ImageGenerator:HC,TextToImage:UC,ImageToImage:wC,ImageToText:AC,BackgroundRemoval:bC,ImageUpscaling:_C,RestyleControlNet:NC,RestyleIPAdapter:RC,Outpainting:OC,Inpainting:LC,AgentCard:Ta,ComputerUse:lS,MCPClient:SA};var _E=Object.defineProperty,sh=u((n,e)=>_E(n,"name",{value:e,configurable:!0}),"l$3"),ah=u((n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},"m$1"),Fr=u((n,e,t)=>(ah(n,e,"read from private field"),t?t.call(n):e.get(n)),"o$1"),PE=u((n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},"h"),ih=u((n,e,t,s)=>(ah(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),"b$4"),Es;const oh=class{static{u(this,"p")}constructor(e){if(this.mimetype="",this.size=0,PE(this,Es,void 0),e instanceof Blob)ih(this,Es,e),this.mimetype=e?.type||"",this.size=e?.size||0;else if(typeof e=="object")ih(this,Es,e),this.mimetype=e?.mimetype||"",this.size=e?.size||0;else throw new Error("Invalid input!")}toBlobUrl(){try{if(typeof Fr(this,Es)!="object")return Fr(this,Es);const e=Fr(this,Es).url.split(",")[1],t=atob(e),s=t.length,a=new Uint8Array(s);for(let r=0;r<s;r++)a[r]=t.charCodeAt(r);const o=new Blob([a],{type:this.mimetype});return URL.createObjectURL(o)}catch(e){return console.log("Error converting SmythFileObject to Blob: ",e),""}}static isSmythFileObject(e){return typeof e=="object"&&e!==null&&e?.url&&"size"in e&&"mimetype"in e}};Es=new WeakMap,sh(oh,"SmythFile");let IE=oh;function LE(n){return/^(https?:\/\/)([^\s.]+\.[^\s]{2,})(:[0-9]{1,5})?(\/[^\s]*)?(\?[^\s]*)?$/i.test(n)}u(LE,"z$1"),sh(LE,"isUrl");var rh={exports:{}};(function(n){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var t=function(s){var a=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,o=0,r={},i={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:u(function k(F){return F instanceof d?new d(F.type,k(F.content),F.alias):Array.isArray(F)?F.map(k):F.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},"encode"),type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++o}),k.__id},clone:u(function k(F,O){O=O||{};var _,M;switch(i.util.type(F)){case"Object":if(M=i.util.objId(F),O[M])return O[M];_={},O[M]=_;for(var b in F)F.hasOwnProperty(b)&&(_[b]=k(F[b],O));return _;case"Array":return M=i.util.objId(F),O[M]?O[M]:(_=[],O[M]=_,F.forEach(function(P,L){_[L]=k(P,O)}),_);default:return F}},"deepClone"),getLanguage:function(k){for(;k;){var F=a.exec(k.className);if(F)return F[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,F){k.className=k.className.replace(RegExp(a,"gi"),""),k.classList.add("language-"+F)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(_){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(_.stack)||[])[1];if(k){var F=document.getElementsByTagName("script");for(var O in F)if(F[O].src==k)return F[O]}return null}},isActive:function(k,F,O){for(var _="no-"+F;k;){var M=k.classList;if(M.contains(F))return!0;if(M.contains(_))return!1;k=k.parentElement}return!!O}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(k,F){var O=i.util.clone(i.languages[k]);for(var _ in F)O[_]=F[_];return O},insertBefore:function(k,F,O,_){_=_||i.languages;var M=_[k],b={};for(var P in M)if(M.hasOwnProperty(P)){if(P==F)for(var L in O)O.hasOwnProperty(L)&&(b[L]=O[L]);O.hasOwnProperty(P)||(b[P]=M[P])}var N=_[k];return _[k]=b,i.languages.DFS(i.languages,function(z,I){I===N&&z!=k&&(this[z]=b)}),b},DFS:u(function k(F,O,_,M){M=M||{};var b=i.util.objId;for(var P in F)if(F.hasOwnProperty(P)){O.call(F,P,F[P],_||P);var L=F[P],N=i.util.type(L);N==="Object"&&!M[b(L)]?(M[b(L)]=!0,k(L,O,null,M)):N==="Array"&&!M[b(L)]&&(M[b(L)]=!0,k(L,O,P,M))}},"DFS")},plugins:{},highlightAll:function(k,F){i.highlightAllUnder(document,k,F)},highlightAllUnder:function(k,F,O){var _={callback:O,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",_),_.elements=Array.prototype.slice.apply(_.container.querySelectorAll(_.selector)),i.hooks.run("before-all-elements-highlight",_);for(var M=0,b;b=_.elements[M++];)i.highlightElement(b,F===!0,_.callback)},highlightElement:function(k,F,O){var _=i.util.getLanguage(k),M=i.languages[_];i.util.setLanguage(k,_);var b=k.parentElement;b&&b.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(b,_);var P=k.textContent,L={element:k,language:_,grammar:M,code:P};function N(I){L.highlightedCode=I,i.hooks.run("before-insert",L),L.element.innerHTML=L.highlightedCode,i.hooks.run("after-highlight",L),i.hooks.run("complete",L),O&&O.call(L.element)}if(u(N,"insertHighlightedCode"),i.hooks.run("before-sanity-check",L),b=L.element.parentElement,b&&b.nodeName.toLowerCase()==="pre"&&!b.hasAttribute("tabindex")&&b.setAttribute("tabindex","0"),!L.code){i.hooks.run("complete",L),O&&O.call(L.element);return}if(i.hooks.run("before-highlight",L),!L.grammar){N(i.util.encode(L.code));return}if(F&&s.Worker){var z=new Worker(i.filename);z.onmessage=function(I){N(I.data)},z.postMessage(JSON.stringify({language:L.language,code:L.code,immediateClose:!0}))}else N(i.highlight(L.code,L.grammar,L.language))},highlight:function(k,F,O){var _={code:k,grammar:F,language:O};if(i.hooks.run("before-tokenize",_),!_.grammar)throw new Error('The language "'+_.language+'" has no grammar.');return _.tokens=i.tokenize(_.code,_.grammar),i.hooks.run("after-tokenize",_),d.stringify(i.util.encode(_.tokens),_.language)},tokenize:function(k,F){var O=F.rest;if(O){for(var _ in O)F[_]=O[_];delete F.rest}var M=new m;return v(M,M.head,k),l(k,M,F,M.head,0),C(M)},hooks:{all:{},add:function(k,F){var O=i.hooks.all;O[k]=O[k]||[],O[k].push(F)},run:function(k,F){var O=i.hooks.all[k];if(!(!O||!O.length))for(var _=0,M;M=O[_++];)M(F)}},Token:d};s.Prism=i;function d(k,F,O,_){this.type=k,this.content=F,this.alias=O,this.length=(_||"").length|0}u(d,"Token"),d.stringify=u(function k(F,O){if(typeof F=="string")return F;if(Array.isArray(F)){var _="";return F.forEach(function(N){_+=k(N,O)}),_}var M={type:F.type,content:k(F.content,O),tag:"span",classes:["token",F.type],attributes:{},language:O},b=F.alias;b&&(Array.isArray(b)?Array.prototype.push.apply(M.classes,b):M.classes.push(b)),i.hooks.run("wrap",M);var P="";for(var L in M.attributes)P+=" "+L+'="'+(M.attributes[L]||"").replace(/"/g,"&quot;")+'"';return"<"+M.tag+' class="'+M.classes.join(" ")+'"'+P+">"+M.content+"</"+M.tag+">"},"stringify");function c(k,F,O,_){k.lastIndex=F;var M=k.exec(O);if(M&&_&&M[1]){var b=M[1].length;M.index+=b,M[0]=M[0].slice(b)}return M}u(c,"matchPattern");function l(k,F,O,_,M,b){for(var P in O)if(!(!O.hasOwnProperty(P)||!O[P])){var L=O[P];L=Array.isArray(L)?L:[L];for(var N=0;N<L.length;++N){if(b&&b.cause==P+","+N)return;var z=L[N],I=z.inside,W=!!z.lookbehind,B=!!z.greedy,K=z.alias;if(B&&!z.pattern.global){var q=z.pattern.toString().match(/[imsuy]*$/)[0];z.pattern=RegExp(z.pattern.source,q+"g")}for(var X=z.pattern||z,Q=_.next,V=M;Q!==F.tail&&!(b&&V>=b.reach);V+=Q.value.length,Q=Q.next){var J=Q.value;if(F.length>k.length)return;if(!(J instanceof d)){var A=1,j;if(B){if(j=c(X,V,k,W),!j||j.index>=k.length)break;var Y=j.index,S=j.index+j[0].length,U=V;for(U+=Q.value.length;Y>=U;)Q=Q.next,U+=Q.value.length;if(U-=Q.value.length,V=U,Q.value instanceof d)continue;for(var G=Q;G!==F.tail&&(U<S||typeof G.value=="string");G=G.next)A++,U+=G.value.length;A--,J=k.slice(V,U),j.index-=V}else if(j=c(X,0,J,W),!j)continue;var Y=j.index,se=j[0],le=J.slice(0,Y),ne=J.slice(Y+se.length),he=V+J.length;b&&he>b.reach&&(b.reach=he);var pe=Q.prev;le&&(pe=v(F,pe,le),V+=le.length),x(F,pe,A);var fe=new d(P,I?i.tokenize(se,I):se,K,se);if(Q=v(F,pe,fe),ne&&v(F,Q,ne),A>1){var me={cause:P+","+N,reach:he};l(k,F,O,Q.prev,V,me),b&&me.reach>b.reach&&(b.reach=me.reach)}}}}}}u(l,"matchGrammar");function m(){var k={value:null,prev:null,next:null},F={value:null,prev:k,next:null};k.next=F,this.head=k,this.tail=F,this.length=0}u(m,"LinkedList");function v(k,F,O){var _=F.next,M={value:O,prev:F,next:_};return F.next=M,_.prev=M,k.length++,M}u(v,"addAfter");function x(k,F,O){for(var _=F.next,M=0;M<O&&_!==k.tail;M++)_=_.next;F.next=_,_.prev=F,k.length-=M}u(x,"removeRange");function C(k){for(var F=[],O=k.head.next;O!==k.tail;)F.push(O.value),O=O.next;return F}if(u(C,"toArray"),!s.document)return s.addEventListener&&(i.disableWorkerMessageHandler||s.addEventListener("message",function(k){var F=JSON.parse(k.data),O=F.language,_=F.code,M=F.immediateClose;s.postMessage(i.highlight(_,i.languages[O],O)),M&&s.close()},!1)),i;var w=i.util.currentScript();w&&(i.filename=w.src,w.hasAttribute("data-manual")&&(i.manual=!0));function f(){i.manual||i.highlightAll()}if(u(f,"highlightAutomaticallyCallback"),!i.manual){var T=document.readyState;T==="loading"||T==="interactive"&&w&&w.defer?document.addEventListener("DOMContentLoaded",f):window.requestAnimationFrame?window.requestAnimationFrame(f):window.setTimeout(f,16)}return i}(e);n.exports&&(n.exports=t),typeof mt<"u"&&(mt.Prism=t),t.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},t.languages.markup.tag.inside["attr-value"].inside.entity=t.languages.markup.entity,t.languages.markup.doctype.inside["internal-subset"].inside=t.languages.markup,t.hooks.add("wrap",function(s){s.type==="entity"&&(s.attributes.title=s.content.replace(/&amp;/,"&"))}),Object.defineProperty(t.languages.markup.tag,"addInlined",{value:u(function(a,o){var r={};r["language-"+o]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:t.languages[o]},r.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}};i["language-"+o]={pattern:/[\s\S]+/,inside:t.languages[o]};var d={};d[a]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return a}),"i"),lookbehind:!0,greedy:!0,inside:i},t.languages.insertBefore("markup","cdata",d)},"addInlined")}),Object.defineProperty(t.languages.markup.tag,"addAttribute",{value:function(s,a){t.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+s+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[a,"language-"+a],inside:t.languages[a]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),t.languages.html=t.languages.markup,t.languages.mathml=t.languages.markup,t.languages.svg=t.languages.markup,t.languages.xml=t.languages.extend("markup",{}),t.languages.ssml=t.languages.xml,t.languages.atom=t.languages.xml,t.languages.rss=t.languages.xml,function(s){var a=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+a.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+a.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+a.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+a.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:a,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var o=s.languages.markup;o&&(o.tag.addInlined("style","css"),o.tag.addAttribute("style","css"))}(t),t.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},t.languages.javascript=t.languages.extend("clike",{"class-name":[t.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),t.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,t.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:t.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:t.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:t.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:t.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:t.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),t.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:t.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),t.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),t.languages.markup&&(t.languages.markup.tag.addInlined("script","javascript"),t.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),t.languages.js=t.languages.javascript,function(){if(typeof t>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s="Loading\u2026",a=u(function(w,f){return"\u2716 Error "+w+" while fetching file: "+f},"FAILURE_MESSAGE"),o="\u2716 Error: File does not exist or is empty",r={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},i="data-src-status",d="loading",c="loaded",l="failed",m="pre[data-src]:not(["+i+'="'+c+'"]):not(['+i+'="'+d+'"])';function v(w,f,T){var k=new XMLHttpRequest;k.open("GET",w,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?f(k.responseText):k.status>=400?T(a(k.status,k.statusText)):T(o))},k.send(null)}u(v,"loadFile");function x(w){var f=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(w||"");if(f){var T=Number(f[1]),k=f[2],F=f[3];return k?F?[T,Number(F)]:[T,void 0]:[T,T]}}u(x,"parseRange"),t.hooks.add("before-highlightall",function(w){w.selector+=", "+m}),t.hooks.add("before-sanity-check",function(w){var f=w.element;if(f.matches(m)){w.code="",f.setAttribute(i,d);var T=f.appendChild(document.createElement("CODE"));T.textContent=s;var k=f.getAttribute("data-src"),F=w.language;if(F==="none"){var O=(/\.(\w+)$/.exec(k)||[,"none"])[1];F=r[O]||O}t.util.setLanguage(T,F),t.util.setLanguage(f,F);var _=t.plugins.autoloader;_&&_.loadLanguages(F),v(k,function(M){f.setAttribute(i,c);var b=x(f.getAttribute("data-range"));if(b){var P=M.split(/\r\n?|\n/g),L=b[0],N=b[1]==null?P.length:b[1];L<0&&(L+=P.length),L=Math.max(0,Math.min(L-1,P.length)),N<0&&(N+=P.length),N=Math.max(0,Math.min(N,P.length)),M=P.slice(L,N).join(`
`),f.hasAttribute("data-start")||f.setAttribute("data-start",String(L+1))}T.textContent=M,t.highlightElement(T)},function(M){f.setAttribute(i,l),T.textContent=M})}}),t.plugins.fileHighlight={highlight:u(function(f){for(var T=(f||document).querySelectorAll(m),k=0,F;F=T[k++];)t.highlightElement(F)},"highlight")};var C=!1;t.fileHighlight=function(){C||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),C=!0),t.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(rh);var TE=rh.exports,Ji=Io(TE);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}},Prism.languages.webmanifest=Prism.languages.json;var jE=`/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
`;uv(jE);var OE=Object.defineProperty,Rr=u((n,e)=>OE(n,"name",{value:e,configurable:!0}),"e");const DE=Rr(n=>/^-?\d+(\.\d+)?$/.test(n.trim()),"isNumber"),ME=Rr(n=>{const e=parseFloat(n);return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER&&e.toString()===n.trim()},"isValidNumber");function lh(n){if(!n)return null;if(DE(n)&&!ME(n)||!n.trim().startsWith("{")&&!n.trim().startsWith("["))return n;try{return JSON.parse(n)}catch{try{return JSON.parse(Go(n))}catch(e){return console.error("Error on parseJson: ",e.toString()),console.error("   Tried to parse: ",n),null}}}u(lh,"parseJson"),Rr(lh,"parseJson");var NE=Object.defineProperty,Zi=u((n,e)=>NE(n,"name",{value:e,configurable:!0}),"E$1");const ch=class{static{u(this,"A")}constructor(e,t={}){this.wrapper=e,this.options={debounceDelay:300,mutatingClass:"mutating",mutatingWrapperClass:"jfs_has_mutating",mutationDuration:300,jsonFieldClass:"jfs_json_field",...t},this.parentMap=new Map,this.previousValues=new Map,this.initializeStructure(),this.bindEvents()}initializeStructure(){Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression]`)).filter(e=>!/[\.\[\]]/.test(e.dataset.expression)).forEach(e=>{const t=e.dataset.expression,s=this.findChildren(t),a=s.some(o=>o.path.includes("["));this.parentMap.set(e,{data:a?[]:{},children:s,isArray:a})})}findChildren(e){return Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression^="${e}["], .${this.options.jsonFieldClass}[data-expression^="${e}."]`)).map(t=>({element:t,path:t.dataset.expression.replace(e,"")}))}bindEvents(){this.parentMap.forEach((e,t)=>{let s;t.addEventListener("input",()=>{clearTimeout(s),s=setTimeout(()=>this.handleParentUpdate(t,e),this.options.debounceDelay)}),e.children.forEach(a=>{a.element.addEventListener("input",()=>this.handleChildUpdate(t,a,e)),a.element.addEventListener("focus",()=>this.handleFocus(a.element,t)),a.element.addEventListener("blur",()=>this.handleBlur(a.element,t))}),t.addEventListener("focus",()=>this.handleFocus(t,t)),t.addEventListener("blur",()=>this.handleBlur(t,t))})}handleParentUpdate(e,t){const s=e.value?.trim()||"";try{let a,o=!0;if(t.data&&(t.isArray&&!Array.isArray(t.data)&&(o=!1),!t.isArray&&typeof t.data!="object"&&(o=!1)),o||(t.data=t.isArray?[]:{}),s)try{a=JSON.parse(s)}catch{try{const r=Zi(d=>{try{return JSON.parse(d)}catch{try{if(!i(d))return d.startsWith("[")?[]:{};let c=d;c=c.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let l=!1,m=!1,v="";for(let C=0;C<c.length;C++){const w=c[C];w==='"'&&(C===0||c[C-1]!=="\\")?(m||(l=!l),v+=w):w==="'"&&(C===0||c[C-1]!=="\\")?l?v+=w:(m=!m,v+='"'):v+=w}c=v.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const x=c.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(x)}catch{return d.startsWith("[")?[]:{}}}},"safeEval"),i=Zi(d=>{let c=!1,l=!1,m=[];for(let v=0;v<d.length;v++){const x=d[v],C=v>0?d[v-1]:"";if(x==='"'&&C!=="\\"?l||(c=!c):x==="'"&&C!=="\\"&&(c||(l=!l)),!(c||l)){if(x==="{"||x==="[")m.push(x);else if(x==="}"){if(m.length===0||m.pop()!=="{")return!1}else if(x==="]"&&(m.length===0||m.pop()!=="["))return!1}}return!c&&!l&&m.length===0},"validateSyntax");a=r(s)}catch{a=t.isArray?[]:{}}}else a=t.isArray?[]:{};t.data=a,typeof a!="object"||a===null?t.children.forEach(r=>{r.element.value=""}):this.updateChildren(t,e),e.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass)}catch{t.data=t.isArray?[]:{},t.children.forEach(a=>{a.element.value=""})}}handleChildUpdate(e,t,s){let a=t.element.value?.trim()||"";try{let o;try{if(o=JSON.parse(e.value),s.isArray&&!Array.isArray(o))throw new Error("Parent data structure mismatch");if(!s.isArray&&typeof o!="object")throw new Error("Parent data structure mismatch")}catch{o=s.isArray?[]:{}}s.data=o;const r=this.parsePath(t.path,s.isArray);this.clearAllMutations(),e.classList.add(this.options.mutatingClass),t.element.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass);let i=a;if(a&&(a.startsWith("{")&&a.endsWith("}")||a.startsWith("[")&&a.endsWith("]")))try{i=JSON.parse(a)}catch{try{i=Zi(d=>{try{return JSON.parse(d)}catch{try{let c=d;c=c.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let l=!1,m=!1,v="";for(let C=0;C<c.length;C++){const w=c[C],f=c[C+1]||"";w==='"'&&(C===0||c[C-1]!=="\\")?(m||(l=!l),v+=w):w==="'"&&(C===0||c[C-1]!=="\\")?l?v+=w:(m=!m,v+='"'):v+=w}c=v.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const x=c.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(x)}catch{return d}}},"safeEval")(a)}catch{}}this.updateValue(s.data,r,i),e.value=JSON.stringify(s.data,null,2),typeof i=="object"&&i!==null?this.previousValues.set(t.element,JSON.stringify(i)):this.previousValues.set(t.element,String(i)),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration)}catch{}}updateValue(e,t,s){if(t.isArray){let a=e;for(let r=0;r<t.indices.length-1;r++){const i=t.indices[r];for(;a.length<=i;)a.push(r===t.indices.length-2?[]:{});Array.isArray(a[i])||(a[i]=[]),a=a[i]}const o=t.indices[t.indices.length-1];for(;a.length<=o;)a.push({});if(t.props.length>0){let r=a[o];for(let i=0;i<t.props.length-1;i++){const d=t.props[i];(!r[d]||typeof r[d]!="object")&&(r[d]={}),r=r[d]}r[t.props[t.props.length-1]]=s}else a[o]=s}else{let a=e;t.props.length>0&&(t.props.slice(0,-1).forEach(o=>{(!a[o]||typeof a[o]!="object")&&(a[o]={}),a=a[o]}),a[t.props[t.props.length-1]]=s)}}parsePath(e,t){const s=[...e.matchAll(/\[(\d+)\]/g)].map(a=>parseInt(a[1]));if(s.length>0){const a=e.replace(/\[\d+\]/g,"").replace(/^\./,""),o=a?a.split(".").filter(Boolean):[];return{isArray:!0,indices:s,props:o}}return{isArray:!1,props:e.replace(/^\./,"").split(".").filter(Boolean)}}updateChildren(e,t){if(this.clearAllMutations(),typeof e.data!="object"||e.data===null){e.children.forEach(a=>{a.element.value=""});return}let s=!1;e.children.forEach(a=>{try{const o=this.parsePath(a.path,e.isArray),r=this.previousValues.get(a.element)||"",i=this.getValue(e.data,o);let d=!1;if(i.startsWith("{")||i.startsWith("["))try{const c=r?JSON.parse(r):null,l=i?JSON.parse(i):null;d=JSON.stringify(c)!==JSON.stringify(l)}catch{d=i!==r}else d=i!==r;d&&(a.element.classList.add(this.options.mutatingClass),s=!0,this.previousValues.set(a.element,i)),a.element.value=i}catch(o){console.error("Child update error:",o),a.element.value=""}}),s&&(t.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration))}getValue(e,t){if(!e||typeof e!="object")return"";let s=e;if(t.isArray){for(const a of t.indices){if(!Array.isArray(s)||a>=s.length)return"";s=s[a]}for(const a of t.props)if(!s||typeof s!="object"||(s=s[a],s===void 0))return"";return this.formatValueForDisplay(s)}else{for(let a=0;a<t.props.length;a++){const o=t.props[a];if(!s||typeof s!="object"||(s=s[o],s===void 0))return""}return this.formatValueForDisplay(s)}}formatValueForDisplay(e){return e==null?"":typeof e=="object"?JSON.stringify(e,null,2):String(e)}handleFocus(e,t){clearTimeout(this.blurTimeout),this.wrapper.classList.add("jfs_has_focused"),this.wrapper.querySelectorAll(".focused").forEach(s=>s.classList.remove("focused")),e.classList.add("focused"),e===t?this.parentMap.get(t).children.forEach(s=>s.element.classList.add("focused")):t.classList.add("focused")}handleBlur(e,t){this.blurTimeout=setTimeout(()=>{const s=[t,...this.parentMap.get(t).children.map(a=>a.element)];s.some(a=>a.matches(":focus"))||(s.forEach(a=>a.classList.remove("focused")),this.wrapper.querySelector(".focused")||this.wrapper.classList.remove("jfs_has_focused"))},50)}clearAllMutations(){this.wrapper.querySelectorAll(`.${this.options.mutatingClass}`).forEach(e=>e.classList.remove(this.options.mutatingClass)),this.wrapper.classList.remove(this.options.mutatingWrapperClass)}};Zi(ch,"JsonFieldSynchronizer");let uh=ch;var $E=Object.defineProperty,ns=u((n,e)=>$E(n,"name",{value:e,configurable:!0}),"d$1");async function ks(n){return(await Ys(n))?.enabled===!0}u(ks,"isMockDataEnabled"),ns(ks,"isMockDataEnabled");async function Ys(n){const e=ga.get(vi)||{};let t=e?.[n];if(!t)try{const s=workspace?.agent?.id;t=(await(await fetch(`/api/page/builder/mock-data/${s}/${n}`)).json())?.data,ga.set(vi,{...e,[n]:t})}catch{console.warn("Failed to fetch mock data:")}return t||{}}u(Ys,"getMockData"),ns(Ys,"getMockData");async function qr(n,e){const t={...e,updatedAt:new Date().toISOString()};try{const s=workspace?.agent?.id;if((await fetch(`/api/page/builder/mock-data/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[n]:t})})).ok){const a=ga.get(vi)||{},o={...a?.[n]||{},...t};a[n]=o,ga.set(vi,a)}}catch{console.warn("Failed to save Mock Data")}}u(qr,"C$2"),ns(qr,"insertOrUpdateMockData");const ss={BUTTON_CLASS:"_mock_data_toggle_btn",SAVE_BTN_CLASS:"_mock_data_save_btn",SAVE_BTN_LABEL_CLASS:"_mock_data_save_btn__label",LABEL_CLASS:"_btn_label",ICON_CLASS:"_btn_icon"},ln={ENABLED:{icon:"fa-toggle-on",label:"Mock Data Enabled",color:"text-[#3C89F9]"},DISABLED:{icon:"fa-toggle-off",label:"Use Mock Data",color:"text-grey-600"}};function Br(n){return new Promise(async(e,t)=>{const s=ns(async(r,i)=>{const d=(await Ys(n.uid))?.data?.outputs||{};return r.map((c,l)=>{let m=d?.[c?.name]??"";m=typeof m=="object"?JSON.stringify(m,null,2):String(m);const v=c?.fieldClasses||"",x=Object.entries(c?.attributes||{}).map(([C,w])=>`${C}="${w}"`).join(" ");return c.type==="file"?`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${c.name}
                </span>
                <input type="file" name="${c.name}" id="${i}-input-${l}" class="${i}-input input
                  block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4 file:rounded-md
                  file:border-0 file:text-sm file:font-semibold
                  file:bg-gray-200 file:text-gray-900
                  hover:file:bg-gray-300 pl-5
                " multiple>
              </div>`:`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${c.name}
                </span>
                <textarea id="${i}-input-${l}" name="${c.name}" class="${i}-input input block p-1 w-full text-sm text-gray-900 bg-gray-50 rounded-e-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 ${v}" style="min-height:44px; height: 44px;" ${x}>${m}</textarea>
              </div>`}).join("")},"createInputList"),a=[...n.domElement.querySelectorAll(".output-endpoint")].map(r=>{const i=r.getAttribute("smt-name"),d=r.getAttribute("smt-expression")||i;return{name:i,expression:d,fieldClasses:bi,attributes:{"data-expression":d}}}),o=await s(a,"outputs");No({title:"Configure Mock Output Data",content:`
        <div class="mb-4">
          <p class="text-xs text-gray-500">
            Mock output data allows you to test your component without requiring actual API keys or credentials. 
            Configure sample responses below to simulate the component's behavior.
          </p>
        </div>
        ${o}
      `,actions:[{label:`<span class="flex items-center gap-2">
                  <span class="fa-solid fa-save"></span>
                  <span class="!text-[#3b82f6] group-hover:!text-white ${ss.SAVE_BTN_LABEL_CLASS}">Save</span>
                </span>`,cssClass:`border border-[#3b82f6] bg-white hover:bg-[#3b82f6] group transition-all duration-200 !text-[#3b82f6] hover:!text-white ${ss.SAVE_BTN_CLASS}`,callback:async(r,i)=>{const d=i.querySelector(`.${ss.SAVE_BTN_CLASS}`),c=d.querySelector(`.${ss.SAVE_BTN_LABEL_CLASS}`);d.disabled=!0,d?.classList.add("cursor-not-allowed"),c.textContent="Saving...";const l={},m=Array.from(i.querySelectorAll(".outputs-input.input")).reduce((v,x,C)=>{let w;try{l[C]?w=l[C].value:w=lh(x.value)||x.value}catch{w=x.value}return v[a[C].name]=w,v},{});try{await qr(n.uid,{enabled:!0,data:{outputs:m}}),Ct.track("app_set_mock_data"),e("saved")}finally{d.disabled=!1,d?.classList.remove("cursor-not-allowed"),c.textContent="Save",ua(i)}}}],onCloseClick:(r,i)=>{t("close"),ua(i)},onDOMReady:function(r){new uh(r.querySelector(".__content"),{jsonFieldClass:bi});const i=r.querySelector(".__actions");i.classList.remove("justify-center"),i.classList.add("justify-end")}})})}u(Br,"saveMockOutputs"),ns(Br,"saveMockOutputs");const dh={getOutputFields(n){const e=n.querySelectorAll(".outputs-input.input");return Array.from(e)},async setMockData(n,e){try{const t=(await Ys(n))?.data?.outputs||{};this.getOutputFields(e).forEach(s=>{const a=s.getAttribute("name")||"";let o=t[a]??"";o=typeof o=="object"?JSON.stringify(o,null,2):String(o),s.value=o})}catch(t){console.error("Failed to set mock data:",t)}},applyJsonFieldSynchronizer(n){try{this.getOutputFields(n).forEach(t=>{const s=t.getAttribute("name")||"",a=t.getAttribute("smt-expression")||s;t.classList.add(bi),t.setAttribute("data-expression",a)});const e=n.querySelector("#outputs");if(!e)return;new uh(e,{jsonFieldClass:bi})}catch{console.error("Failed to apply JSON field synchronizer:")}}};async function Qi(n){const e=[...n.domElement.querySelectorAll(".output-endpoint")];if(await ks(n.uid)){const t=await Ys(n.uid);for(const s of e){const a=s.getAttribute("smt-name");let o=t?.data?.outputs?.[a];o&&s.setAttribute("smt-mock-data",typeof o=="object"?JSON.stringify(o):o)}}else e.forEach(t=>{t.removeAttribute("smt-mock-data")})}u(Qi,"toggleMockOutputPills"),ns(Qi,"toggleMockOutputPills");const ja={elements(n){return{button:n.domElement.querySelector(`.${ss.BUTTON_CLASS}`),label:n.domElement.querySelector(`.${ss.LABEL_CLASS}`),icon:n.domElement.querySelector(`.${ss.ICON_CLASS}`)}},turnOn(n){const{button:e,label:t,icon:s}=this.elements(n);e.classList.remove(ln.DISABLED.color),e.classList.add(ln.ENABLED.color),t.textContent=ln.ENABLED.label,s.classList.remove(ln.DISABLED.icon),s.classList.add(ln.ENABLED.icon)},turnOff(n){const{button:e,label:t,icon:s}=this.elements(n);e.classList.remove(ln.ENABLED.color),e.classList.add(ln.DISABLED.color),t.textContent=ln.DISABLED.label,s.classList.remove(ln.ENABLED.icon),s.classList.add(ln.DISABLED.icon)},setLoadingState(n){const{button:e}=this.elements(n);e.classList.contains("text-[#3C89F9]")&&e.classList.remove("text-[#3C89F9]"),e.disabled=!0,e.classList.add("cursor-not-allowed")},clearLoadingState(n){const{button:e}=this.elements(n);e.disabled=!1,e.classList.remove("cursor-not-allowed")}},Ur=new Set;async function ph(n){const e=n.uid;if(!Ur.has(e)){Ur.add(e);try{const t=await ks(e)?"ENABLED":"DISABLED";let s=ln[t].label,a=ln[t].icon,o=ln[t].color;n.addComponentButton(`<div class="fa-solid ${a} text-base _btn_icon"></div>
       <span class="ml-2 font-semibold _btn_label">${s}</span>`," ",{class:`${ss.BUTTON_CLASS} ${o} transition-opacity duration-300`,customStyle:"toggle",position:"top"},async()=>{try{const r=ns(async()=>{await ks(e)?(await qr(n.uid,{enabled:!1}),ja.turnOff(n)):(Ct.track("app_mock_screen_impression",{source:"use_mock_data_button"}),await Br(n),ja.turnOn(n))},"toggleMockData");ja.setLoadingState(n),await r(),await Qi(n)}catch{console.error("Failed to toggle mock data")}finally{ja.clearLoadingState(n)}})}finally{Ur.delete(e)}}}u(ph,"addMockDataToggleButton"),ns(ph,"addMockDataToggleButton");var FE=Object.defineProperty,Oa=u((n,e)=>FE(n,"name",{value:e,configurable:!0}),"r$3");function zr(n,e,t){if(!e)return;const s=Array.isArray(e)?e:e.trim().split(/\s+/);n.classList[t](...s)}u(zr,"b$3"),Oa(zr,"applyClasses");function as(n={step:{enable:!1},run:{enable:!1,tooltipText:"Run",icon:"mif-play"},stop:{enable:!1},attach:{enable:!1}},e={}){for(const[o,r]of Object.entries(n)){if(!r)continue;const i=document.getElementById(`debug-menubtn-${o}`);if(!i)continue;const{enable:d,classesToAdd:c,classesToRemove:l,tooltipText:m,icon:v}=r;if(d?i.removeAttribute("disabled"):i.setAttribute("disabled","true"),zr(i,c,"add"),zr(i,l,"remove"),m){const x=document.querySelector(`#tooltip-${o}`);x&&(x.textContent=m)}if(v){i.querySelectorAll(".debug-btn-icon").forEach(C=>C.classList.add("hidden"));const x=i.querySelector(`.${v}`);x&&x.classList.remove("hidden")}}const t=document.getElementById("debug-controls-overlay"),s=document.getElementById("tooltip-controls-overlay"),a=e.controlsOverlay;a?.enable?(t?.classList.remove("hidden"),a.tooltipText&&s&&(s.textContent=a.tooltipText)):t?.classList.add("hidden")}u(as,"updateDebugControls"),Oa(as,"updateDebugControls");function eo(n={}){as({run:{enable:!0},step:{enable:!0},stop:{enable:!0},attach:{enable:!0}},n)}u(eo,"enableAllDebugControls"),Oa(eo,"enableAllDebugControls");function RE(n={}){as({run:{enable:!1},step:{enable:!1},stop:{enable:!1},attach:{enable:!1}},n)}u(RE,"disableAllDebugControls"),Oa(RE,"disableAllDebugControls");function Da(){const n=!!document.querySelector(".component.selected"),e=!!document.querySelector(".component.dbg-active"),t=!!document.querySelector(".component.dbg-running"),s=ol()==="error";if(e||t)return;const a=document.getElementById("debug-menu-tgl")?.checked;n&&a?eo({controlsOverlay:{enable:!1}}):as({run:{enable:!1},step:{enable:!1},stop:{enable:s},attach:{enable:a}},{controlsOverlay:{enable:!a||!n&&!s,tooltipText:a?"Please select a component":"Click to toggle debug"}})}u(Da,"updateDebugControlsOnSelection"),Oa(Da,"updateDebugControlsOnSelection");var qE=Object.defineProperty,Re=u((n,e)=>qE(n,"name",{value:e,configurable:!0}),"r$2");const hh={CONTROL:"control",VARIANT_1:"variant_1",VARIANT_2:"variant_2"},BE={CONTROL:"control",VARIANT_1:"variant_1"};Ji.languages.smythLog={error:{pattern:/^Error\s:.*$/m,inside:{keyword:/^Error/},greedy:!0},json:{pattern:/{[^{}]*}/,inside:Ji.languages.json,greedy:!0}};const UE=Re(n=>/^-?\d+(\.\d+)?$/.test(n.trim()),"isNumber"),zE=Re(n=>{const e=parseFloat(n);return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER&&e.toString()===n.trim()},"isValidNumber");function Gr(n){if(!n)return null;if(UE(n)&&!zE(n)||!n.trim().startsWith("{")&&!n.trim().startsWith("["))return n;try{return JSON.parse(n)}catch{try{return JSON.parse(Go(n))}catch(e){return console.error("Error on parseJson: ",e.toString()),console.error("   Tried to parse: ",n),null}}}u(Gr,"Se"),Re(Gr,"parseJson");function mh(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}u(mh,"ot"),Re(mh,"escapeRegExp");const ft={},_s={};let Xs,to,Hr;function gh(){const n=workspace.agent;return ft?.[n.id]?.sessionID}u(gh,"getDebugSessionID"),Re(gh,"getDebugSessionID");let fh=!1,no=!1,vh=!1;function Vr(n){const e=document.querySelector(".debug-switcher"),t=document.getElementById("debug-switcher-container");document.getElementById("debug-menu");const s=e.querySelector(".debug-switcher-text"),a=e.querySelector(".pulsing-dot-container"),o=e.querySelector(".mif-bug"),r=document?.getElementById("cmp-inspect-btn"),i=document?.querySelector(".debug-switcher-massage");n&&Ct.track("debug_button_click",{position:"bottom center of builder",type:"debug"}),n?(i?.classList.remove("hidden"),i?.classList.add("block"),a.classList.remove("hidden"),s.textContent="Debug On",o.classList.add("hidden"),e.classList.add("active"),t.classList.add("active"),al(r,!0)):(lo({resetPinned:!0}),s.textContent="Debug Off",e.classList.remove("active"),t.classList.remove("active"),o.classList.remove("hidden"),a.classList.add("hidden"),i?.classList.remove("block"),i?.classList.add("hidden"),al(r,!1))}u(Vr,"Ae"),Re(Vr,"toggleSwitch");async function Wr(n,e="step"){const t=workspace.domElement.querySelector(".component.selected");if(!t){Jn("No component selected","Please select a component");return}const s=t?._control;await s.openDebugDialog.call(s,n,e)}u(Wr,"qe"),Re(Wr,"_openDebugDialog");function bh(n){document.querySelectorAll(".component .debug-bar").forEach(e=>{const t=e.querySelector(".btn-debug"),s=e.querySelector(".btn-debug-log"),a=e.querySelector(".btn-fix-with-ai");Kr(s,a);const o=e.querySelector(".btn-debug");o&&(n===hh.VARIANT_1&&(o.style.right="35px",o.insertAdjacentHTML("afterbegin",'<span class="text-white">Debug</span>')),n===hh.VARIANT_2&&(o.style.right="30px",o.insertAdjacentHTML("afterbegin",'<span class="text-white">Click</span>'))),e.addEventListener("click",r=>{r.stopPropagation(),r.stopImmediatePropagation(),t?.click()})})}u(bh,"rt$1"),Re(bh,"handleDebugButtons");function Kr(n,e){n&&n.classList.add("variant_2","h-6"),e&&e.classList.add("variant_2","h-6")}u(Kr,"Me"),Re(Kr,"applyDebugButtonStyles");function Yr(){try{const n=Ct.getFeatureFlag(Oo.DEBUG_INJECT_TEXT_EXPERIMENT);bh(n)}catch(n){console.error("Error on runDebugInjectButtonExperiment: ",n.toString())}}u(Yr,"Ce"),Re(Yr,"runDebugInjectButtonExperiment");function yh(){Ct.getFeatureFlag(Oo.POSTHOG_EXPERIMENT_FIX_WITH_AI)===BE.VARIANT_1&&document.querySelectorAll(".component .debug-bar")?.forEach(n=>{const e=n?.querySelector(".btn-fix-with-ai");e&&e.setAttribute("style","display:none !important")})}u(yh,"it"),Re(yh,"runFixWithAIEExperiment");async function GE(){if(fh){console.log("Debugger already initialized ... Skipping");return}await workspace.waitUnlock(),fh=!0,console.log("Initializing debugger");const n=document.getElementById("debug-menu"),e=document.getElementById("debug-menu-tgl"),t=document.getElementById("debug-status"),s=document.querySelector(".debug-switcher");function a(){e.checked=!e.checked;const c=new Event("change",{bubbles:!0});e.dispatchEvent(c),e.checked&&!no&&(Yr(),no=!0)}if(u(a,"o"),Re(a,"toggleDebugMenu"),s?.addEventListener("click",a),n?.addEventListener("click",()=>{e.checked||a()}),e?.addEventListener("change",()=>{is(),e?.checked?(Vr(!0),t.classList.remove("hidden"),n.classList.remove("hidden")):(Vr(!1),t.classList.add("hidden")),[...document.querySelectorAll(".debug-btn")].forEach(c=>{e?.checked?(c.removeAttribute("disabled"),workspace.domElement.classList.add("debug-enabled")):(c.setAttribute("disabled","true"),workspace.domElement.classList.remove("debug-enabled"),is(),t.classList.add("hidden"))}),workspace.saveAgent(),setTimeout(()=>{workspace.redraw(),Da()},500)}),workspace.agent.data.debugSessionEnabled){e.checked=!0;const c=new Event("change",{bubbles:!0});e.dispatchEvent(c),t.classList.remove("hidden"),[...document.querySelectorAll(".debug-btn")].forEach(l=>{l.removeAttribute("disabled"),workspace.domElement.classList.add("debug-enabled")}),setTimeout(()=>{workspace.redraw(),workspace?.agent?.id&&is(),no||(Yr(),no=!0),vh||(yh(),vh=!0)},500)}const o=document.getElementById("debug-menubtn-run"),r=document.getElementById("debug-menubtn-step"),i=document.getElementById("debug-menubtn-stop"),d=document.getElementById("debug-menubtn-attach");o?.addEventListener("click",async c=>{console.log("debug run"),Ct.track("debug_button_click",{position:"bottom center of builder",type:"run"});const l=o.querySelector(".mif-play"),m=o.querySelector(".mif-pause"),v=o.classList.contains("running"),x=workspace.agent;if(ft?.[x.id]?.sessionID||await Wr(c,"run"),v){const C=document.querySelector("#tooltip-run");C.innerHTML="Run",o.classList.remove("running"),l.classList.remove("hidden"),m.classList.add("hidden"),r.removeAttribute("disabled"),d.removeAttribute("disabled"),i.removeAttribute("disabled")}else{const{result:C}=await Xr();!C?.errorOccurred&&C?.states?.sessionClosed&&qa()}}),r.addEventListener("click",async c=>{console.log("debug Step"),Ct.track("debug_button_click",{position:"bottom center of builder",type:"step"});const l=workspace.agent;if(!ft?.[l.id]?.sessionID){Wr(c,"step");return}as({step:{enable:!1},run:{enable:!1},stop:{enable:!0},attach:{enable:!1}});try{if(await oo(l.id)){const m=await Js(l.id);!m?.errorOccurred&&m?.states?.sessionClosed&&qa()}else Je("Debug session terminated unexpectedly. Check logs for details.","Debug Interrupted")}finally{eo()}}),d.addEventListener("click",async c=>{Ct.track("debug_button_click",{position:"bottom center of builder",type:"attach"}),Pn("Attaching to live debug session ...");const l=workspace.agent;l&&(as({step:{enable:!1},run:{enable:!1},stop:{enable:!1},attach:{enable:!1}}),await Jr(l.id,1)?($t("Successfully attached to action","Debug Session Attached"),Pn("Successfully attached to action")):(Je("Failed to attach debugger","No active session found"),Pn("Failed to attach debugger, No active session found")))}),document.getElementById("debug-menubtn-stop").addEventListener("click",async c=>{Ct.track("debug_button_click",{position:"bottom center of builder",type:"stop"}),is(),o.removeAttribute("disabled"),r.removeAttribute("disabled"),d.removeAttribute("disabled"),i.removeAttribute("disabled"),Jn("Debug session stopped. Review and re-initiate if needed.","Debug Stopped")}),Ch(),Sh()}u(GE,"init"),Re(GE,"init");function xh(){return new Promise(n=>{const e=document.getElementById("debug-menubtn-step"),t=setInterval(()=>{e.getAttribute("disabled")||(clearInterval(t),n(!0))},100)})}u(xh,"at$1"),Re(xh,"waitDebugStep");function Pn(n){const e=document.querySelector("#debug-status pre");e.innerHTML=n+`
`+e.innerHTML}u(Pn,"log"),Re(Pn,"log");async function Xr(){const n=document.getElementById("debug-menubtn-run"),e=n.querySelector(".mif-play"),t=n.querySelector(".mif-pause"),s=document.getElementById("debug-menubtn-step"),a=document.getElementById("debug-menubtn-attach"),o=document.getElementById("debug-menubtn-stop"),r=document.querySelector("#tooltip-run");r.innerHTML="Pause",e.classList.add("hidden"),t.classList.remove("hidden"),s.setAttribute("disabled","true"),a.setAttribute("disabled","true"),o.setAttribute("disabled","true");let i=n.classList.contains("running");if(i)return;n.classList.add("running"),i=!0,Ct.track("app_run_agent");let d,c=!0,l="success",m;for(;i;){const v=workspace.agent;if(!ft?.[v.id]?.sessionID)break;if(c&&(d=await oo(v.id)),!d){Je("Debug session terminated unexpectedly. Check logs for details.","Debug Interrupted"),l="failed";break}m=await Js(v.id);const x=Object.values(m.states.state).filter(C=>C.active);if(console.log(x),c=x.length>0,m?.error&&(l="failed"),m.error||m.sessionClosed||m?.states?.sessionClosed)break;i=n.classList.contains("running")}return console.log("debug run end"),Ct.track("app_workflow_test_completed",{status:l,source:"debugger"}),r.innerHTML="Run",n.classList.remove("running"),e.classList.remove("hidden"),t.classList.add("hidden"),s.removeAttribute("disabled"),a.removeAttribute("disabled"),o.removeAttribute("disabled"),{result:m}}u(Xr,"runDebug"),Re(Xr,"runDebug");function wh(){return new Promise(n=>{const e=document.getElementById("debug-menubtn-run"),t=setInterval(()=>{e.classList.contains("running")||(clearInterval(t),n(!0))},100)})}u(wh,"lt"),Re(wh,"waitRunningDebug");function Sh(){const n={debugLastAction:async()=>{const e=document.getElementById("debug-menu-tgl");if(!(e&&!e.checked)&&!n.debugLastAction.running){n.debugLastAction.running=!0;try{so("Debugger:Attaching...");let t=3;console.log("Waiting for debugger to be ready ..."),await wh(),console.log("Waiting previous session to close ..."),await Eh(workspace.agent.id),console.log("debugger ready, trying to attach ..."),await Jr(workspace.agent.id,10)?(so("Debug is attached. Interact with the debug controls to proceed with debugging your agent"),Pn("Successfully attached to action")):(Je("Failed to attach debugger","No active session found"),Pn("Failed to attach debugger"))}catch(t){console.error("debugLastAction",t)}n.debugLastAction.running=!1}}};window.onmessage=function(e){const t=`${`${workspace.agent.id}.${workspace.serverData.agent_domain}`}`;if(e.origin.replace("https://","").replace("http://","")===t)try{const s=JSON.parse(e.data);if(s.function&&typeof n[s.function]=="function"){const a=s.args||[];n[s.function].apply(null,a)}else console.error("Invalid jsonRPC call",s)}catch(s){console.error("Invalid jsonRPC call",s)}}}u(Sh,"ct$1"),Re(Sh,"handleEmbodimentRPCDebug");async function Ch(n=!0){if(await workspace.waitServerData(),Xs=workspace.serverData.dbgUrl+"/api",to=workspace.serverData.dbgUrl,console.log("DBG Server Status:",workspace.serverData.status.toLowerCase()),!n)return;const e=document.querySelector(".debug-switcher");workspace.serverData.status.toLowerCase()==="offline"?(document.querySelectorAll("#debug-menu .debugger").forEach(t=>{$(t).removeClass("flex").addClass("hidden")}),e.disabled=!0,e.style.opacity="0.5",document.querySelectorAll("#debug-menu .no-debugger").forEach(t=>{$(t).addClass("flex").removeClass("hidden")})):(document.querySelectorAll("#debug-menu .debugger").forEach(t=>{$(t).removeClass("hidden").addClass("flex")}),e.disabled=!1,e.style.opacity="1",document.querySelectorAll("#debug-menu .no-debugger").forEach(t=>{$(t).addClass("hidden").removeClass("flex")}))}u(Ch,"dt$1"),Re(Ch,"updateServerStatus");async function Ah(n,e){const t=Xs+"?read",s={"Content-type":"application/json; charset=UTF-8","X-AGENT-ID":n,"X-DEBUG-READ":e};window.currentMonitorId&&(s["X-MONITOR-ID"]=window.currentMonitorId);let a=await fetch(t,{method:"POST",headers:s}).then(o=>o.json());try{const o=Object.keys(a.state),r=JSON.parse(JSON.stringify(a));for(const i of o)if(await ks(i)){const d=r.state?.[i];d?.output&&d?.output?.constructor===Object&&(r.state[i].output._debug="Response generated using mock data. Please disable mock data to see actual response.",a=r)}else Object.keys(r.state?.[i]?.output||{})?.length>0&&!r.state?.[i].output._debug&&(r.state[i].output._debug="Response generated with configured output data.",a=r)}catch{console.warn("Error mutating result for inject/mock output data")}return a}u(Ah,"ut"),Re(Ah,"readDebugInfo");function Eh(n){return new Promise(e=>{setInterval(()=>{if(!ft[n]?.sessionID)return e(!0)},1e3)})}u(Eh,"pt"),Re(Eh,"waitSessionClose");async function Jr(n,e=1){let t=e,s,a=0;for(;!s&&t>0;){if(await $e(100+a),document.querySelectorAll(".component.dbg-active").length>0){console.log("attachLiveDebugSession canceled, there is already an active debug session");break}s=await kh(workspace.agent.id),t--,!s&&t>0&&(console.log("Attach failed, retrying ..."),a+=500)}return setTimeout(()=>{const o=[...document.querySelectorAll(".component.dbg-active")].filter(r=>r.classList.contains("dbg-always-active")===!1)[0];workspace.scrollToComponent(o),as({step:{enable:!!s},run:{enable:!!s},stop:{enable:!!s},attach:{enable:!s}})},1e3),s}u(Jr,"attachLiveDebugSession"),Re(Jr,"attachLiveDebugSession");async function kh(n){console.log("attachLiveDebugSession",n),sl(),Hr!=n&&(await is(),await $e(200));const e=`${to}/debugSession/${n}`,t=await fetch(e).then(a=>a.json());console.log("getLiveDebugSession",t);const s=t.dbgSession;return s&&((await Js(workspace.agent.id,s)).attached||(Jn("Cannot attach to this session.<br />Make sure that the session ID is valid and that the corresponding agent is loaded","Invalid Debug Session"),Pn("Cannot attach to session "+s))),Hr=n,s}u(kh,"gt"),Re(kh,"_attachLiveDebugSession");function so(n){ya.send({function:"updateStatus",args:[n]},["chatbot"])}u(so,"ye"),Re(so,"updateChatbotStatus");function _h(n,e){const t=e.split(/\.|\[|\]\.|\]\[|\]/).filter(Boolean);let s=n;for(let a of t){if(s==null)return;s=s[a]}return s}u(_h,"mt$1"),Re(_h,"JSONExpression");function Zr(n,e){let t=!1,s="";const a=Re(i=>Na(i)||$a(i)||Fa(i),"isPreviewableUrl"),o=e===sn.imageGenerator;(Array.isArray(n)&&n.some(a)||a(n)||o)&&(t=!0),t&&(s=`<div class="text-center"><a href="#" class="w-[100px] px-3 py-1 text-xs font-medium text-center text-white bg-blue-700 rounded-md hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 btn-file-preview" data-is-image-generator="${o}">Preview</a></div>`);let r=typeof n!="string"?JSON.stringify(n,null,2):n;return r=r.replace(/\\n/g,`
`),n=`<textarea readonly class="dbg dbg-textarea text-gray-800">${r===""?"[empty string]":r}</textarea>${s}`,n}u(Zr,"Ie"),Re(Zr,"getFormattedContent");function Ph(n){n.querySelectorAll(".smyth.endpoint").forEach(e=>{e.id,e.classList.add("disabled-endpoint"),e.endpoint.canvas.style.display="none"})}u(Ph,"bt$1"),Re(Ph,"disableComponentEndpoints");function Qr(n){n.querySelectorAll(".smyth.endpoint").forEach(e=>{e.id,e.classList.remove("disabled-endpoint"),e.endpoint.canvas.style.display=""})}u(Qr,"De"),Re(Qr,"enableComponentEndpoints");function Ma(n,e){if(!e)return;e==="pin"?(n.classList.add("pinned"),n.closest(".endpoint").classList.add("pinned")):e==="toggle"&&(n.classList.toggle("pinned"),n.closest(".endpoint").classList.toggle("pinned"),n.classList.contains("pinned")||n.removeAttribute("style"));const t=n.closest(".component");[...t.querySelectorAll(".pinned")].length>0?(Ph(t),t.style.zIndex=500):(Qr(t),t.style.zIndex="")}u(Ma,"ne$2"),Re(Ma,"togglePinning");function Na(n){return IE.isSmythFileObject(n)}u(Na,"se$2"),Re(Na,"isSmythFileObject");function $a(n){return typeof n=="string"&&n.startsWith("smythfs://")}u($a,"oe$1"),Re($a,"isSmythFileUrl");function Fa(n){return typeof n=="string"&&dv(n)}u(Fa,"re$1"),Re(Fa,"isUrl");async function Ih(n){try{let e;try{e=JSON.parse(n)}catch{e=n.trim()}const t=Re(o=>({name:o.name||"",url:`${to}/file-proxy?url=${o.url}`,mimetype:o.mimetype||""}),"smythFileToOutput"),s=Re(o=>({name:"",url:`${to}/file-proxy?url=${o}`,mimetype:""}),"smythFileUrlToOutput"),a=Re(o=>({name:"",url:o,mimetype:""}),"urlToOutput");if(Array.isArray(e)){if(e.some(Na))return e.filter(Na).map(t);if(e.some($a))return e.filter($a).map(o=>s(o));if(e.some(Fa))return e.filter(Fa).map(o=>a(o))}else{if(Na(e))return[t(e)];if($a(e))return[s(e)];if(Fa(e))return[a(e)]}return[]}catch(e){return console.error("Error processing file content:",e),[]}}u(Ih,"ft"),Re(Ih,"processFileContent");async function el(n,e){if(n?.mimetype)return Ec(n.mimetype);try{const t=await pv(e);return Ec(t)}catch{return"unknown"}}u(el,"$e"),Re(el,"getFileType");function tl(n,e,t,s){const a="btn btn-primary font-medium text-sm text-gray-400 dark:text-gray-500 hover:underline";switch(n){case"image":return`
        <div class="image-container p-2">
          <div class="text-sm font-medium mb-2 text-gray-500">${t}</div>
          <div class="w-full flex justify-center bg-gray-100 rounded-lg relative">
            <img
              src="${e}"
              alt="${t}"
              class="max-w-full max-h-[80vh] object-contain rounded-lg"
              onerror="${s}"
              onload="${s}"
            />
          </div>
          <div class="text-center mt-2 flex justify-between gap-2">
            <a href="${e}" target="_blank" class="${a}">Open in new tab</a>
            <a href="${e}" download="${t}" class="${a}">Download</a>
          </div>
        </div>`;case"audio":return`
        <div class="audio-container p-2">
          <audio controls src="${e}" class="max-w-full m-auto" onerror="${s}" oncanplay="${s}"></audio>
          <div class="text-center mt-2">
            <a href="${e}" target="_blank" class="${a}">Open in new tab</a>
          </div>
        </div>`;case"video":return`
        <div class="video-container p-2">
          <video controls class="max-w-full m-auto" onerror="${s}" oncanplay="${s}">
            <source src="${e}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <div class="text-center mt-2">
            <a href="${e}" target="_blank" class="${a}">Open in new tab</a>
          </div>
        </div>`;case"pdf":return`
        <div class="pdf-container p-2">
          <div class="text-sm font-medium mb-2 text-gray-500">${t}</div>
          <div class="w-full h-[80vh] bg-gray-100 rounded-lg relative">
            <iframe
              src="${e}#toolbar=0"
              class="w-full h-full rounded-lg"
              type="application/pdf"
              onerror="${s}"
              onload="${s}"
            ></iframe>
          </div>
          <div class="text-center mt-2 flex justify-between gap-2">
            <a href="${e}" target="_blank" class="${a}">Open in new tab</a>
            <a href="${e}" download="${t}" class="${a}">Download</a>
            </div>
          </div>`;default:return`
          <div class="file-container p-2">
            <div class="text-sm font-medium mb-2 text-gray-700">${t}</div>
            <div class="text-center">
              <a href="${e}" target="_blank" download="${t}" class="btn btn-primary font-medium text-blue-600 dark:text-blue-500 hover:underline">Download File</a>
            </div>
          </div>`}}u(tl,"_e"),Re(tl,"generateFilePreviewHTML");function Lh(n){yi("File Preview",`${n}<div class="h-1 mt-1">
      <div data-role="progress" data-type="line" data-small="true" data-cls-back="bg-gray-300" class="file-preloader h-1"></div>
    </div>`,{Close:{class:"border border-gray-700 hover:opacity-75",handler:()=>{}}},{onShow:()=>{document.querySelector(".fallback-file-download-link")&&document.querySelector(".file-preloader")?.remove()}})}u(Lh,"yt$1"),Re(Lh,"showPreviewDialog");async function nl(n){n.preventDefault();const e=n.target,t=e.textContent||"Preview";e.textContent="...",e.classList.add("opacity-50","cursor-not-allowed"),e.setAttribute("disabled","true");try{const s="document.querySelector('.file-preloader')?.remove()",a=e.closest(".dbg-element")?.querySelector(".dbg-textarea");if(!a)throw new Error("Parent textarea not found");const o=e.getAttribute("data-is-image-generator")==="true"?"image":"",r=a.textContent,i=await Ih(r);let d;if(i.length>1)d=`
      <div class="file-gallery grid grid-cols-2 gap-4">
        ${(await Promise.all(i.map(async(c,l)=>{const m=c?.name||`File ${l+1}`,v=c?.url,x=o||await el(c,v);return tl(x,v,m,s)}))).join("")}
      </div>`;else if(i.length===1){const c=i[0],l=c.url,m=c.name||"File",v=o||await el(c,l);d=tl(v,l,m,s)}else throw new Error("No valid files found to preview");Lh(d)}catch(s){console.error("Preview error:",s);const a=s instanceof Error?s.message:"Failed to generate preview";Xn(`Preview failed: ${a}`)}finally{e.textContent=t,e.classList.remove("opacity-50","cursor-not-allowed"),e.removeAttribute("disabled")}}u(nl,"He"),Re(nl,"previewHandler");function Ra(n,e,t){let s=n.querySelector(".dbg-element.dbg-output");s||(s=document.createElement("div"),n.appendChild(s)),e===""||e===null||typeof e!="string"&&JSON.stringify(e,null,2);const a=e?Zr(e,t):e+"";s.innerHTML=`<button class="pin button primary"><span class="mif-pin icon"></span></button>${a}`,s.className="dbg-element dbg-output";const o=s.closest(".endpoint")?.classList.contains("pinned");Ma(s,o?"pin":""),s.querySelector(".pin").onclick=async r=>{r.stopPropagation(),r.stopImmediatePropagation(),Ma(s,"toggle")},s.querySelector(".btn-file-preview")?.addEventListener("click",nl),n.querySelector(".name").classList.add("dbg-info"),n.querySelector(".ep").classList.add("dbg-info")}u(Ra,"ie$2"),Re(Ra,"showOutputInfo");function Th(n,e){let t=n?.querySelector(".dbg-element.dbg-output");t||(t=document.createElement("div"),n?.appendChild(t));const s=Zr(e);t.innerHTML=`<button class="pin button primary"><span class="mif-pin icon"></span></button>${s}`,t.className="dbg-element dbg-output",n?.appendChild(t);const a=t.closest(".endpoint")?.classList.contains("pinned");Ma(t,a?"pin":""),t.querySelector(".pin").onclick=async o=>{o.stopPropagation(),o.stopImmediatePropagation(),Ma(t,"toggle")},t.querySelector(".btn-file-preview")?.addEventListener("click",nl),n?.querySelector(".name")?.classList?.add("dbg-info"),n?.querySelector(".ep")?.classList?.add("dbg-info")}u(Th,"ht"),Re(Th,"showInputInfo");let ao={};const io=1e4;async function Js(n,e,t){console.log("readDebugStep",n,e),e||(e=ft?.[n]?.sessionID),ft[n]||(ft[n]={}),ft[n].sessionID=e;const s=await Ah(n,e);ao=s;let a=!e;lo({resetPinned:!0});let o=!1;for(let d in s.state){if(t&&!t.includes(d))continue;const c=document.getElementById(d);if(c){const l=c.querySelectorAll(".smyth.output-endpoint.default");a||(a=!0);const m=s.state[d].active;m&&c.classList.add("dbg-active"),s.state[d].alwaysActive&&c.classList.add("dbg-always-active");const v=s.state[d].status;s.state[d].sourceId;let x=s.state[d].active?s.state[d].runtimeData.input:s.state[d]?.input,C=s.state[d]?.output;s.state[d]?.step;let w=s.state[d]?.runtimeData?._LoopData;const f=s.state[d]?.name;if(x){let k=!1,F=[];c.querySelectorAll(".smyth.input-endpoint").forEach(_=>{const M=_.getAttribute("smt-name"),b=_.getAttribute("smt-optional")==="true";if(!M)return;let P=!0;if(x[M]!==void 0){const L=x[M];P=!1,(L==null||typeof L=="string"&&L.trim()==="")&&(P=!0)}F.push({element:_,name:M,isEmpty:P,isOptional:b}),P&&!b&&(k=!0)});const O=c?._control?.isFunctionalComponent();if(k){if(c.classList.add("has-empty-inputs"),!Array.from(c.querySelectorAll(".messages-container .message")).some(_=>_.id!=="component-button")){const _=c._control;_&&_.addComponentMessage("Missing Required Inputs","missing-input")}for(let _ of F){const M=document.createElement("img");M.className="input-status-icon",M.src=_.isOptional?"/img/builder/empty-input.svg":"/img/builder/fill-input.svg",M.style.width=O?"12px":"16px",M.style.height=O?"12px":"16px",M.style.position="absolute",M.style.left=O?"-7px":"-8px",M.style.top=O?"1px":"6px",M.style.zIndex="100";const b=_.element.querySelector(".input-status-icon");b&&b.remove(),_.element.appendChild(M)}}for(let _ of F){const M=document.createElement("img");M.className="input-status-icon",M.src=_.isOptional?"/img/builder/empty-input.svg":"/img/builder/fill-input.svg",M.style.width=O?"12px":"16px",M.style.height=O?"12px":"16px",M.style.position="absolute",M.style.left=O?"-7px":"-8px",M.style.top=O?"1px":"6px",M.style.zIndex="100";const b=_.element.querySelector(".input-status-icon");b&&b.remove(),_.element.appendChild(M)}k&&c.classList.add("empty-inputs-style")}if(w){let k=w.loopIndex;const F=w.loopLength,O=c.querySelector('.smyth.output-endpoint[smt-name="Loop"]');if(O){let _=O.querySelector(".dbg-loop-info");_||(_=document.createElement("div"),_.className="dbg-loop-info",O.insertBefore(_,O.firstChild)),_.innerHTML=`[ ${k} / ${F} ]`}}let T=s.state[d]?._job_components;if(Array.isArray(T))for(let k of T){const F=document.getElementById(k);F&&F.classList.add("dbg-async")}if(v&&c.classList.add(`dbg-active-${v}`),m&&x){_s[d]={inputs:{}};for(let k in x){const F=c.querySelector(`.smyth.input-endpoint[smt-name="${k}"]`);if(F){Th(F,x[k]);const O=typeof x[k]!="string"?JSON.stringify(x[k],null,2):x[k];_s[d].inputs[k]=O}}}if(C){const k=c.querySelectorAll(".smyth.output-endpoint");for(let _ of k)Ra(_,"");const F=JSON.parse(JSON.stringify(C));for(let[_,M]of Object.entries(F))/[.\[\]]/.test(_)&&!M&&delete F[_];for(let _ in F){const M=[...c.querySelectorAll(`.smyth.output-endpoint[smt-expression*="${_}."], .smyth.output-endpoint[smt-name*="${_}."], .smyth.output-endpoint[smt-expression*="${_}["], .smyth.output-endpoint[smt-name*="${_}["]`)],b=c.querySelector(`.smyth.output-endpoint[smt-name="${_}"]`);if(b){Ra(b,C[_],f);for(let P of M){const L=P.getAttribute("smt-expression")||P.getAttribute("smt-name"),N=_h(C,L);Ra(P,N,f)}if(l.length<=1)for(let P in C[_]){const L=[...c.querySelectorAll(`.smyth.output-endpoint[smt-expression="${P}"], .smyth.output-endpoint[smt-name="${P}"]`)];for(let N of L)Ra(N,C[_][P])}}}for(let _ of l)if(!_.querySelector(".dbg-element.dbg-output")){let M=document.createElement("div");_.appendChild(M),M.innerHTML='<span class="mif-bug icon"></span>[undefined]',M.className="dbg-element dbg-output",_.querySelector(".name").classList.add("dbg-info"),_.querySelector(".ep").classList.add("dbg-info")}const O=c.querySelector(".debug-info");if(O.innerHTML="",C._debug){const _=document.createElement("div"),M=C._debug;_.textContent=M;const b=C?._error||"";b&&(_.append(`

${b}`),o=!0);let P=workspace.domElement.querySelector(`.debug-box[rel="${c.id}"]`);const L=`tooltip-${Math.random().toString(36).substr(2,9)}`,N=`tooltip-${Math.random().toString(36).substr(2,9)}`;if(!P){P=document.createElement("div"),P.className="debug-box bg-gray-800 exclude-panzoom hidden",P.setAttribute("rel",c.id);const S=c.offsetTop+100,U=c.offsetLeft-20;P.style.position="absolute",P.style.top=S+"px",P.style.left=U+"px",P.style.height="300px",P.style.width="500px",P.innerHTML=`<div class="debug-info-title flex justify-between px-2 py-1">
                                <h2 class="text-base">Debug Log</h2>
                                <div class="space-x-2">
                                    <input type="search" placeholder="Search ..." class="search-input w-24 h-6 rounded-md p-1 bg-gray-600 text-gray-200 hidden" />
                                    <button class="downlaod text-gray-400 hover:text-gray-200 hidden" data-tooltip-target="${L}"  data-tooltip-placement="top" type="button">
                                        <i class="fa-solid fa-download"></i>
                                    </button>
                                    <div
                                        id="${L}"
                                        role="tooltip"
                                        class="tooltip absolute z-10 inline-block bg-gray-900 shadow-lg text-white py-2 px-4 rounded-lg opacity-0 invisible"
                                        style="font-size: 12px; left:12px; top:30px;"
                                        data-popper-reference-hidden=""
                                        data-popper-escaped=""
                                        data-popper-placement="bottom"
                                    >
                                        Download log
                                    </div>
                                    <button class="copy text-gray-400 hover:text-gray-200 hidden" data-tooltip-target="${N}"   data-tooltip-placement="top" type="button" >
                                        <i class="fa-solid fa-copy"></i>
                                    </button>
                                    <div
                                        id="${N}"
                                        role="tooltip"
                                        class="tooltip absolute z-10 inline-block bg-gray-900 shadow-lg text-white py-2 px-4 rounded-lg opacity-0 invisible"
                                        style="font-size: 12px; left:68px; top:30px;"
                                        data-popper-reference-hidden=""
                                        data-popper-escaped=""
                                        data-popper-placement="bottom"
                                    >
                                        Copy log
                                    </div>
                                    <button class="close text-gray-400 hover:text-gray-200">
                                        <i class="fa-solid fa-xmark"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="dbg dbg-textarea syntax bg-gray-700">
                                <!-- this is the actual syntax highlighting -->
                                <div readonly class="dbg-log absolute top-0"></div>
                                <!-- this is the search highlighting layer with transparent background and text color -->
                                <div readonly class="dbg-search-highlight bg-transparent text-transparent absolute top-0"></div>
                            </div>
                            <div class="dbg-info-footer px-2 hidden">The data is too long to display, <a class="dbg-log-download-link" href="#">click here to download</a></div>
                        `,workspace.domElement.appendChild(P);const G=P.querySelector(".close");G.onclick=()=>{P.classList.add("hidden"),P._connection.canvas.classList.add("hidden")},Qn(P).draggable({allowFrom:".debug-info-title",onmove:function(Y){const se=Y.target,le=(parseFloat(se.style.left)||0)+Y.dx/workspace.scale,ne=(parseFloat(se.style.top)||0)+Y.dy/workspace.scale;se.style.left=le+"px",se.style.top=ne+"px",workspace.jsPlumbInstance.repaint(P)}})}const z=P.querySelector(".dbg-log");z.textContent=_.textContent.replace(/debug:/gm,"");const I=_.textContent.replace(/debug:/gm,""),W=I?.length>io?I?.substring(0,io)+"...":I,B=jh(W);z.innerHTML=I.length<io?Oh(B):B;const K=P.querySelector(".dbg-search-highlight"),q=P.querySelector(".dbg-info-footer"),X=P.querySelector(".copy"),Q=P.querySelector(".search-input"),V=P.querySelector(".downlaod");if(X.addEventListener("mouseenter",()=>r(N)),X.addEventListener("mouseleave",()=>i(N)),V.addEventListener("mouseenter",()=>r(L)),V.addEventListener("mouseleave",()=>i(L)),I?.length<io)q.classList.add("hidden"),X.classList.remove("hidden"),Q.classList.remove("hidden"),V.classList.remove("hidden"),X.onclick=()=>{try{navigator.clipboard.writeText(I),$t("Copied to clipboard","Success")}catch(S){Jn("Please manually select and copy the log.","Failed to copy"),console.error("debugger:copy",S)}},V.onclick=()=>{const S=`${M}

${b}`,U=new Blob([S],{type:"text/plain"}),G=URL?.createObjectURL(U),Y=document?.createElement("a");Y.href=G,Y.download="log.txt",document?.body?.appendChild(Y),Y?.click(),document?.body?.removeChild(Y),URL?.revokeObjectURL(G)},Q.oninput=()=>{const S=Q.value;if(S){const U=B.replace(new RegExp(mh(S),"gi"),`<mark>${S}</mark>`);K.innerHTML=U;const G=K.querySelector("mark");G&&G.scrollIntoView({behavior:"smooth",block:"nearest"})}else K.innerHTML=""};else{X.classList.add("hidden"),Q.classList.add("hidden"),V.classList.add("hidden"),q.classList.remove("hidden"),P.querySelector(".dbg-textarea").classList.add("dbg-textarea-with-footer");const S=P.querySelector(".dbg-log-download-link"),U=new Blob([`${M}

${b}`],{type:"text/plain"}),G=URL.createObjectURL(U);S.href=G,S.download="log.txt"}const J=c.querySelector(".btn-debug-log"),A=c.querySelector(".btn-fix-with-ai"),j=!0;if(J.classList.remove("hidden"),Kr(J,A),C._error){if(c.classList.add("state-error"),c.classList.remove("state-success"),c.classList.remove("has-empty-inputs"),c.querySelector(".message.missing-input")?.remove(),J.classList.add("error"),j){A?.classList.remove("hidden");const S=typeof C._error=="string"?C._error:JSON.stringify(C._error);A.setAttribute("data-error",S)}}else c.classList.remove("state-error"),c.classList.remove("has-empty-inputs"),c.classList.add("state-success"),c.querySelector(".message.missing-input")?.remove(),J.classList.remove("error"),A?.classList.add("hidden"),A?.removeAttribute("data-error");il(c),C._debug_time&&c.querySelector(".debug-bar").setAttribute("debug-time",C._debug_time+"ms")}}}workspace.jsPlumbInstance.repaint(c)}s.sessionClosed&&(document.querySelectorAll(".dbg-running")?.forEach(d=>d?.classList.remove("dbg-running")),o?(Je("Debug encountered an error. Please check the logs for details.","Debug Error"),Pn("Debug session failed: Check the debug log for error details")):Pn("Debug session completed successfully"),console.log("Deleting debug session",n,e),delete ft[n].sessionID,ro(!1),so("Debugger:Checking remaining debug jobs ...")),s.error&&(Xn("An error occured",s.error),Pn("An error occured : "+s.error),await is(!0));function r(d){const c=document?.querySelector(`#${d}`);c?.classList?.remove("invisible","opacity-0"),c?.classList?.add("visible","opacity-100")}u(r,"u"),Re(r,"showTooltip");function i(d){const c=document?.querySelector(`#${d}`);c?.classList?.remove("visible","opacity-100"),c?.classList?.add("invisible","opacity-0")}return u(i,"f"),Re(i,"hideTooltip"),{states:s,attached:a,errorOccurred:o}}u(Js,"readDebugStep"),Re(Js,"readDebugStep");function jh(n){const e=document.createElement("textarea");return e.textContent=n,e.innerHTML}u(jh,"vt"),Re(jh,"escapeHTML");function Oh(n,e="smythLog"){return Ji.highlight(n,Ji.languages[e],e)}u(Oh,"wt"),Re(Oh,"highlightCode");function HE(n,e,t){sl(),ft[n]||(ft[n]={}),e||(e=ft?.[n]?.sessionID),e&&(ft[n][e]=setInterval(async()=>{const s=await Js(n,e);typeof t=="function"&&t(s)},5e3))}u(HE,"startDebugListener"),Re(HE,"startDebugListener");function VE(n,e){ft[n]&&(clearInterval(ft[n][e]),delete ft[n][e])}u(VE,"stopDebugListener"),Re(VE,"stopDebugListener");async function WE(n,e,{input:t,output:s}){const a=ft?.[n]?.sessionID||"",o=Xs,r={"Content-type":"application/json; charset=UTF-8","X-AGENT-ID":n,"X-DEBUG-INJ":a};window.currentMonitorId&&(r["X-MONITOR-ID"]=window.currentMonitorId);let i=JSON.parse(JSON.stringify(s));if(await ks(e)){const m=(await Ys(e)).data?.outputs,v=Re(x=>!!(x==null||x===""||Array.isArray(x)&&x.length===0||typeof x=="object"&&Object.keys(x).length===0),"isEmptyValue");for(const[x,C]of Object.entries(i))i[x]=v(C)?m[x]:C}const d=[{id:e,ctx:{active:!0,input:t,output:i}}];$("#"+e).find(".cpt-overlay").show();const c=document.getElementById(e);c&&(workspace.refreshComponentSelection(c),c?.classList?.add("dbg-running"));const l=await fetch(o,{method:"POST",headers:r,body:JSON.stringify(d)}).then(m=>m.json()).catch(m=>{throw m});return ft[n]||(ft[n]={}),ft[n].sessionID=l.dbgSession,l}u(WE,"injectComponentDebugInfo"),Re(WE,"injectComponentDebugInfo");async function oo(n,e){if(e||(e=ft?.[n]?.sessionID),!e)return;for(let o in ao.state){ao?.state[o].active&&$("#"+o).find(".cpt-overlay").show();const r=document.getElementById(o);r&&(workspace.refreshComponentSelection(r),r.classList?.add("dbg-running"))}const t=Xs+"?run",s={"Content-type":"application/json; charset=UTF-8","X-AGENT-ID":n,"X-DEBUG-RUN":e};window.currentMonitorId&&(s["X-MONITOR-ID"]=window.currentMonitorId);const a=await fetch(t,{method:"POST",headers:s}).then(o=>o.json());return a.dbgSession?a.error?(Xn("Debug Runtime Error",a.error),is(!1),null):e:(console.log("Debug session ended"),delete ft[n].sessionID,ro(!1),null)}u(oo,"runDebugStep"),Re(oo,"runDebugStep");async function KE(n,e){if(e||(e=ft?.[n]?.sessionID),!e)return;const t=Xs,s={"Content-type":"application/json; charset=UTF-8","X-AGENT-ID":n,"X-DEBUG-STOP":e};return window.currentMonitorId&&(s["X-MONITOR-ID"]=window.currentMonitorId),!!(await fetch(t,{method:"POST",headers:s}).then(a=>a.json()).catch(a=>{})).success}u(KE,"clearDebuggerSession"),Re(KE,"clearDebuggerSession");async function YE(){const n=workspace.agent;if(!ft?.[n.id]?.sessionID)return;const e=await oo(n.id);if(!e)return;let t=[];do t=[...document.querySelectorAll(".dbg-async")].map(s=>s.id),console.log("asyncRunning",t,t.length),t.length>0&&await Js(n.id,e),await $e(3e3);while(t.length>0)}u(YE,"Xt$1"),Re(YE,"waitPendingAsyncComponents");function ro(n=!0){ao={},workspace.domElement.classList.remove("debugging"),workspace.domElement.querySelectorAll(".btn-debug").forEach(e=>{e.classList.remove("active")}),lo({resetPinned:!0}),n&&(workspace.domElement.querySelectorAll(".pinned").forEach(e=>{e.classList.remove("pinned")}),workspace.domElement.querySelectorAll(".disabled-endpoint").forEach(e=>{e.classList.remove("disabled-endpoint")}),workspace.domElement.querySelectorAll(".dbg-info").forEach(e=>{e.classList.remove("dbg-info")}),workspace.domElement.querySelectorAll(".debug-info").forEach(e=>{e.classList.add("hidden"),e.innerHTML="";const t=e.closest(".component").querySelector(".btn-debug-log"),s=e.closest(".component").querySelector(".btn-fix-with-ai");t?.classList.add("hidden"),t?.classList.remove("error"),s?.classList.add("hidden"),s?.removeAttribute("data-error"),il(e.closest(".component"))}),workspace.domElement.querySelectorAll(".debug-bar").forEach(e=>{e.removeAttribute("debug-time")}),workspace.domElement.querySelectorAll(".component").forEach(e=>{e.classList.remove("state-success","state-error","has-empty-inputs")}))}u(ro,"he"),Re(ro,"stopDebugUI");function sl(){[...workspace.domElement.querySelectorAll(".dbg-element")].forEach(n=>{n.remove()})}u(sl,"Oe"),Re(sl,"clearDebugUIInfo");async function is(n=!0){ro(n);const e=gh();if(!e)return;Hr=void 0;const t=workspace.agent;delete ft[t.id].sessionID;const s=Xs,a={"Content-type":"application/json; charset=UTF-8","X-AGENT-ID":t.id,"X-DEBUG-STOP":e};await fetch(s,{method:"POST",headers:a}).catch(o=>{console.error(o)})}u(is,"stopDebugSession"),Re(is,"stopDebugSession");function XE(n,e,t,s,a="step"){const o=Re((T,k)=>T.map((F,O)=>F.type==="file"?`
            <div class="flex mb-5">
              <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                ${F.name}
              </span>
              <input type="file" name="${F.name}" id="${k}-input-${O}" class="${k}-input input
                block w-full text-sm text-slate-500
                file:mr-4 file:py-2 file:px-4 file:rounded-md
                file:border-0 file:text-sm file:font-semibold
                file:bg-gray-200 file:text-gray-900
                hover:file:bg-gray-300 pl-5
              " multiple>
            </div>`:`
            <div class="flex mb-5">
              <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                ${F.name}
              </span>
              <textarea id="${k}-input-${O}" name="${F.name}" class="${k}-input input block p-1 w-full text-sm text-gray-900 bg-gray-50 outline-none rounded-e-md border-b border-gray-300 focus:border-gray-300 focus:border-b-smythos-blue-500 focus:border-b-2" style="min-height:44px; height: 44px; box-shadow: none;"></textarea>
            </div>`).join(""),"createInputList"),r=Re((T,k)=>T.map((F,O)=>`
      <div class="flex items-center py-2">
        <input type="checkbox" rel="${k}-input-${O}" class="
          relative w-[36px] h-[21px] bg-gray-100 border-transparent text-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200
          disabled:opacity-50 disabled:pointer-events-none checked:bg-none checked:text-smythos-blue-500 checked:border-smythos-blue-500 checked:bg-smythos-blue-500
          focus:ring-0 focus:ring-offset-0 focus:ring-offset-transparent
          before:inline-block before:w-4 before:h-4 before:bg-white checked:before:bg-white before:translate-x-0 checked:before:translate-x-full
          before:rounded-full before:shadow before:transform before:ring-0 before:transition before:ease-in-out before:duration-200
          mr-3
        ">
        <span class="text-sm text-gray-700">${F.name}</span>
      </div>
    `).join(""),"createToggleList"),i=o(e,"inputs"),d=o(t,"outputs"),c=r(e,"inputs"),l=r(t,"outputs"),m={},v={},x=`
    <div class="border bd-default p-2">
      <div id="inputs">
        ${i}
        <details class="mt-4 [&_summary::-webkit-details-marker]:hidden group">
          <summary class="cursor-pointer text-sm text-gray-700 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="11" height="7" viewBox="0 0 11 7" fill="none"
                 class="transition-transform duration-300 ease-in-out details-arrow">
              <path d="M9.40349 0.242188L5.69516 3.94245L1.98682 0.242188L0.847656 1.38135L5.69516 6.22885L10.5427 1.38135L9.40349 0.242188Z" fill="#808080"/>
            </svg>
            Advanced options
          </summary>
          <div class=" details-content">
            <div class="pt-5 transition-all duration-300 ease-in-out details-inner">
              <div class="flex items-center gap-2 mb-2">
                <p class="text-sm text-gray-600">Use Default Values</p>
                <div class="relative inline-block group" id="default-values-tooltip">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="cursor-help">
                    <path d="M8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.3181 11.6819 1.33333 8 1.33333C4.3181 1.33333 1.33333 4.3181 1.33333 8C1.33333 11.6819 4.3181 14.6667 8 14.6667Z" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 10.6667V8" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 5.33333H8.00667" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <div class="absolute left-full ml-2 -translate-y-1/2 top-1/2 hidden w-[320px] p-2 bg-gray-900 text-white text-sm rounded shadow-lg z-50 tooltip-content">
                    When toggled on, will use default value set in <a href="${Ft}/agent-studio/build-agents/building-workflows"
                      target="_blank"
                      class="underline hover:text-blue-300">Component Input Settings</a>.
                    <div class="absolute right-[98.5%] top-1/2 -translate-y-1/2 w-2 h-2">
                      <div class="bg-gray-900 w-2 h-2 transform rotate-45"></div>
                    </div>
                  </div>
                </div>
              </div>
              ${c}
            </div>
          </div>
        </details>
        <p class="mt-4 text-sm text-gray-600">
          Looking to set output values? <a href="#" class="text-blue-600 configure-output">Configure output</a>
        </p>
      </div>
      <div id="outputs" class="hidden">
        ${d}
        <details class="mt-4 [&_summary::-webkit-details-marker]:hidden group">
          <summary class="cursor-pointer text-sm text-gray-700 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="11" height="7" viewBox="0 0 11 7" fill="none"
                 class="transition-transform duration-300 ease-in-out details-arrow">
              <path d="M9.40349 0.242188L5.69516 3.94245L1.98682 0.242188L0.847656 1.38135L5.69516 6.22885L10.5427 1.38135L9.40349 0.242188Z" fill="#808080"/>
            </svg>
            Advanced options
          </summary>
          <div class="details-content transition-[height] duration-300 ease-in-out">
            <div class="pt-5 transition-all duration-300 ease-in-out details-inner">
              <div class="flex items-center gap-2 mb-2">
                <p class="text-sm text-gray-600">Use Default Values</p>
                <div class="relative inline-block group" id="default-values-tooltip-outputs">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="cursor-help">
                    <path d="M8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.3181 11.6819 1.33333 8 1.33333C4.3181 1.33333 1.33333 4.3181 1.33333 8C1.33333 11.6819 4.3181 14.6667 8 14.6667Z" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 10.6667V8" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 5.33333H8.00667" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <div class="absolute left-full ml-2 -translate-y-1/2 top-1/2 hidden w-[320px] p-2 bg-gray-900 text-white text-sm rounded shadow-lg z-50 tooltip-content">
                    When toggled on, will use default value set in <a href="${Ft}/agent-studio/build-agents/building-workflows"
                      target="_blank"
                      class="underline hover:text-blue-300">Component Input Settings</a>.
                    <div class="absolute right-[98.5%] top-1/2 -translate-y-1/2 w-2 h-2">
                      <div class="bg-gray-900 w-2 h-2 transform rotate-45"></div>
                    </div>
                  </div>
                </div>
              </div>
              ${l}
            </div>
          </div>
        </details>
        <p class="mt-4 text-sm text-gray-600">
          Looking to set input values? <a href="#" class="text-blue-600 configure-input">Configure input</a>
        </p>
      </div>
    </div>`,C=Re(async(T,k)=>{const F=Array.from(T.files||[]);k.files=F;const O=await Promise.all(F.map(_=>new Promise(M=>{const b=new FileReader;b.onload=P=>{let L=P.target.result;navigator.userAgent.includes("Windows")&&_.type===""&&_.name.toLowerCase().endsWith(".md")&&(L=L.replace("data:application/octet-stream;","data:text/markdown;")),M(L)},b.readAsDataURL(_)})));k.value=O.length===1?O[0]:O},"handleFileInput");function w(){const T=workspace?.userData?.email,k=workspace?.teamData?.id,F=workspace?.agent?.id;if(T&&k&&F){const O=`first-debug-session-${T}-${k}-${F}`,_=localStorage.getItem(O)===null,M=document.getElementById("bottom-bar");_&&M&&(M.classList.remove("hidden"),localStorage.setItem(O,"false"))}}u(w,"v"),Re(w,"handleFirstDebugSession");const f=Re(async function(T,k,F){const O=T.domElement.querySelector(".error"),_=ol();if(_==="error"&&!O||_==="inprogress"){Jn("A debug session is in progress. Please stop the current run before starting again.","Debug Running");return}_==="success"&&document.querySelectorAll(".component").forEach(z=>{z.classList.remove("state-success"),z.classList.remove("state-error"),z.classList.remove("has-empty-inputs")}),w(),_s[T.uid]={inputs:{}};const M=Array.from(k.querySelectorAll(".inputs-input.input")),b=M.reduce((z,I,W)=>{let B;try{if(k.querySelector(`input[type="checkbox"][rel="inputs-input-${W}"]`)?.checked){const q=I.getAttribute("name");B=T?.workspace?.agent?.data?.components?.filter(X=>X.id===T._uid)?.[0]?.inputs?.filter(X=>X.name===q)[0]?.defaultVal||void 0}else m[W]?B=m[W].value||void 0:B=I.getAttribute("disabled")?void 0:Gr(I.value)||I.value}catch{B=I.value}z[e[W].name]=B;const K=typeof B!="string"?JSON.stringify(B,null,2):B;return _s[T.uid].inputs[e[W].name]=K,z},{});let P=!0;for(let z in b){const I=b[z];let W=!1;if((I==null||typeof I=="string"&&I.trim()===""||Array.isArray(I)&&I.length===0||typeof I=="object"&&Object.keys(I).length===0)&&(W=!0),!W){P=!1;break}}if(P&&!await ks(T.uid)&&M.length>0){Array.from(T.domElement.querySelectorAll(".messages-container .message")).some(z=>z.id!=="component-button")||T.addComponentMessage("Missing Required Inputs","missing-input"),Jn("Cannot run with empty inputs","Please provide input values."),T.domElement.classList.add("has-empty-inputs");return}const L=Array.from(k.querySelectorAll(".outputs-input.input")).reduce((z,I,W)=>{let B;try{v[W]?B=v[W].value:B=Gr(I.value)||I.value}catch{B=I.value}return z[t[W].name]=B,z},{});let N;if(typeof s=="function"&&(N=await s({input:b,output:L})),F==="run"){const{result:z}=await Xr();(!N?.errorOccurred&&N?.states?.sessionClosed||!z?.errorOccurred&&z?.states?.sessionClosed)&&qa()}else await xh(),N?.errorOccurred||(N===null&&Jn("A debug session is in progress. Please stop the current run before starting again.","Debug Running"),N?.states?.sessionClosed&&qa());T.domElement.classList.remove("has-empty-inputs"),console.log(`Debug ${F} done`)},"handleDebugAction");hv({title:`<div class="flex items-center gap-2">
              <span>Debug Run</span>
              <div class="relative inline-block group" id="tooltip-container">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="cursor-help">
                  <path d="M8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.3181 11.6819 1.33333 8 1.33333C4.3181 1.33333 1.33333 4.3181 1.33333 8C1.33333 11.6819 4.3181 14.6667 8 14.6667Z" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 10.6667V8" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 5.33333H8.00667" stroke="#808080" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <div class="absolute left-full ml-2 -translate-y-1/2 top-1/2 hidden w-[420px] p-2 bg-gray-900 text-white text-sm rounded shadow-lg z-50 tooltip-content font-normal">
                  Configure input and output parameters for your debug run.
                  <br/>
                  See <a href="${Ft}/agent-studio/build-agents/debugging"
                        target="_blank"
                        class="underline hover:text-blue-300">debug documentation</a> for more details.
                  <div class="absolute right-[98.5%] top-1/2 -translate-y-1/2 w-2 h-2">
                    <div class="bg-gray-900 w-2 h-2 transform rotate-45"></div>
                  </div>
                </div>
              </div>
            </div>`,content:x,actions:[{label:`<span class="flex items-center gap-2">
                  <span class="debug-step-icon w-5 h-5 bg-contain bg-no-repeat bg-center" style="background-image: url('/img/debug-bar/step-blue.svg');"></span>
                  <span class="!text-[#3b82f6] group-hover:!text-white">Step</span>
                </span>`,cssClass:"border border-[#3b82f6] bg-white hover:bg-[#3b82f6] group transition-all duration-200 !text-[#3b82f6] hover:!text-white",callback:T=>f(n,T,"step")},{label:`<span class="flex items-center gap-2">
                  <span class="debug-play-icon w-5 h-5 bg-contain bg-no-repeat bg-center" style="background-image: url('/img/debug-bar/play-blue.svg');"></span>
                  <span class="!text-[#3b82f6] group-hover:!text-white">Run</span>
                </span>`,cssClass:"border border-[#3b82f6] bg-white hover:bg-[#3b82f6] group transition-all duration-200 !text-[#3b82f6] hover:!text-white",callback:T=>f(n,T,"run")}],onCloseClick:()=>{},onDOMReady:function(T){if(_s[n.uid]?.inputs)for(let _ in _s[n.uid]?.inputs){const M=T.querySelector(`.inputs-input[name="${_}"]`);if(M&&M.type!=="file"){const b=_s[n.uid]?.inputs[_]||"";M.value=b}}[...T.querySelectorAll('input[type="checkbox"]')].forEach(_=>{const M=_.getAttribute("rel"),b=T.querySelector(`#${M}`);b&&_.addEventListener("change",P=>{P.target.checked?(b.setAttribute("disabled","true"),b.value="",b.style.opacity="0.5"):(b.removeAttribute("disabled"),b.style.opacity="1")})});const k=T.querySelector("#inputs"),F=T.querySelector("#outputs");e.forEach((_,M)=>{if(_.type==="file"){const b=k.querySelector(`#inputs-input-${M}`),P={domElement:b,value:null,files:[]};m[M]=P,b.addEventListener("change",L=>{C(L.target,P)})}}),t.forEach((_,M)=>{if(_.type==="file"){const b=F.querySelector(`#outputs-input-${M}`),P={domElement:b,value:null,files:[]};v[M]=P,b.addEventListener("change",L=>{C(L.target,P)})}}),T.querySelector(".configure-output")?.addEventListener("click",async _=>{_.preventDefault(),T.querySelector("#inputs").classList.add("hidden"),T.querySelector("#outputs").classList.remove("hidden"),await dh.setMockData(n.uid,T),dh.applyJsonFieldSynchronizer(T)}),T.querySelector(".configure-input")?.addEventListener("click",_=>{_.preventDefault(),T.querySelector("#outputs").classList.add("hidden"),T.querySelector("#inputs").classList.remove("hidden")}),T.querySelectorAll("details").forEach(_=>{const M=_.querySelector(".details-content"),b=_.querySelector(".details-inner"),P=_.querySelector(".details-arrow");_.open?M.style.height=b.offsetHeight+"px":M.style.height="0",_.addEventListener("toggle",L=>{if(_.open){const N=b.offsetHeight;requestAnimationFrame(()=>{M.style.height=N+"px",P.style.transform="rotate(180deg)"})}else{const N=b.offsetHeight;M.style.height=N+"px",M.offsetHeight,requestAnimationFrame(()=>{M.style.height="0",P.style.transform="rotate(0)"})}}),M.addEventListener("transitionend",()=>{_.open&&(M.style.height="auto")})});const O=Re(_=>{const M=T.querySelector(_);if(!M)return;const b=M.querySelector(".tooltip-content");let P;M.addEventListener("mouseenter",()=>{clearTimeout(P),b.classList.remove("hidden")}),M.addEventListener("mouseleave",()=>{P=setTimeout(()=>{b.matches(":hover")||b.classList.add("hidden")},400)}),b.addEventListener("mouseenter",()=>{clearTimeout(P)}),b.addEventListener("mouseleave",()=>{P=setTimeout(()=>{b.classList.add("hidden")},400)})},"setupTooltip");O("#tooltip-container"),O("#default-values-tooltip"),O("#default-values-tooltip-outputs")}})}u(XE,"createDebugInjectDialog"),Re(XE,"createDebugInjectDialog");function al(n,e){n&&(e?n.classList.add("active"):n.classList.remove("active"))}u(al,"Be"),Re(al,"updateInspectButtonIcon");async function Dh(n){n.on("component",s=>{if(s.data.action==="callStop"&&s.data.duration){const a=document.querySelector(`#${s.data.id}`);if(!a)return;a.classList.remove("dbg-running"),s.data.duration<500?setTimeout(()=>{$(a.querySelector(".cpt-overlay")).hide(),console.log("HIDDEN OVERLAY FOR COMP ",s.data.id," BY MONITOR ")},500-s.data.duration):($(a.querySelector(".cpt-overlay")).hide(),console.log("HIDDEN OVERLAY FOR COMP ",s.data.id," BY MONITOR "))}else if(s.data.action==="callStart"){const a=document.querySelector(`#${s.data.id}`);if(!a)return;workspace.refreshComponentSelection(a),a.classList.add("dbg-running"),$(a.querySelector(".cpt-overlay")).show()}}),n.on("computer-use/ui-state",s=>{const a=document.querySelector(`#${s.data.componentId}`);if(!a)return;const o=a.querySelector(".computer-state-img");o&&(o.src=s.data.image_url)});function e(s){const a=document?.querySelector(`#${s}`);a?.classList?.remove("invisible","opacity-0"),a?.classList?.add("visible","opacity-100")}u(e,"e"),Re(e,"showTooltip");function t(s){const a=document?.querySelector(`#${s}`);a?.classList?.remove("visible","opacity-100"),a?.classList?.add("invisible","opacity-0")}u(t,"s"),Re(t,"hideTooltip")}u(Dh,"registerDbgMonitorUI"),Re(Dh,"registerDbgMonitorUI");function il(n){const e=n.querySelector(".debug-bar"),t=n.querySelector(".btn-debug-log"),s=n.querySelector(".btn-fix-with-ai");if(e){const a=t&&!t.classList.contains("hidden")||s&&!s.classList.contains("hidden");e.style.display=a?"":"none"}}u(il,"Ne"),Re(il,"toggleDebugBarVisibility");function lo({resetMessages:n=!1,resetPinned:e=!1}){document.querySelectorAll("#workspace-container .component").forEach(t=>{t.querySelectorAll(".input-status-icon").forEach(s=>s?.remove()),t.classList.remove("dbg-async"),t.classList.remove("dbg-active"),t.classList.remove("dbg-active-waiting"),t.classList.remove("dbg-active-in_progress"),t.classList.remove("dbg-active-error"),t.classList.remove("has-empty-inputs"),t.classList.remove("empty-input-style"),$(t.querySelector(".cpt-overlay")).hide(),n&&t._control?.clearComponentMessages(),e&&(t.querySelector(".pinned")||Qr(t))}),requestAnimationFrame(()=>{workspace.redraw()})}u(lo,"ve"),Re(lo,"resetComponentsState");function ol(){if(document.querySelectorAll(".component.dbg-active").length>0)return"inprogress";const n=(document.querySelector("#debug-status pre")?.innerHTML||"").trim().split(`
`)?.[0],e=document.querySelectorAll(".component .btn-debug-log:not(.hidden)");if(n.includes("Debug session completed successfully")&&e.length>0)return"success";const t=document.querySelectorAll(".component .error");return(n.includes("Debug session failed")||n.includes("An error occured"))&&t.length>0?"error":"default"}u(ol,"checkWorkflowStatus"),Re(ol,"checkWorkflowStatus");function qa(){$t("Debug run finished successfully. Ready to deploy?","Debug Complete",{ctaText:"Deploy Agent",ctaCallback:()=>{const n=document.querySelector("#deploy-button-topbar");n&&n.click()}})}u(qa,"ce$1"),Re(qa,"showDeployAgentToast");var JE=Object.defineProperty,pn=u((n,e)=>JE(n,"name",{value:e,configurable:!0}),"X");function Mh(n){var e=n.jsPlumb,t=n.jsPlumbUtil,s="Straight",a="Arc",o=pn(function(r){this.type="SmythFlowchart",r=r||{},r.stub=r.stub==null?30:r.stub;var i,d=e.Connectors.AbstractConnector.apply(this,arguments),c=r.midpoint==null||isNaN(r.midpoint)?.5:r.midpoint,l=r.alwaysRespectStubs===!0,m=null,v=null,x=r.cornerRadius!=null?r.cornerRadius:0;r.loopbackRadius;var C=pn(function(O){return O<0?-1:O===0?0:1},"sgn"),w=pn(function(O){return[C(O[2]-O[0]),C(O[3]-O[1])]},"segmentDirections"),f=pn(function(O,_,M,b){if(!(m===_&&v===M)){var P=m??b.sx,L=v??b.sy,N=P===_?"v":"h";m=_,v=M,O.push([P,L,_,M,N])}},"addSegment"),T=pn(function(O){return Math.sqrt(Math.pow(O[0]-O[2],2)+Math.pow(O[1]-O[3],2))},"segLength"),k=pn(function(O){var _=[];return _.push.apply(_,O),_},"_cloneArray"),F=pn(function(O,_,M){for(var b=null,P,L,N,z=0;z<_.length-1;z++){if(b=b||k(_[z]),P=k(_[z+1]),L=w(b),N=w(P),x>0&&b[4]!==P[4]){var I=Math.min(T(b),T(P)),W=Math.min(x,I/1.5);b[2]-=L[0]*W,b[3]-=L[1]*W,P[0]+=N[0]*W,P[1]+=N[1]*W;var B=L[1]===N[0]&&N[0]===1||L[1]===N[0]&&N[0]===0&&L[0]!==N[1]||L[1]===N[0]&&N[0]===-1,K=P[1]>b[3]?1:-1,q=P[0]>b[2]?1:-1,X=K===q,Q=X&&B||!X&&!B?P[0]:b[2],V=X&&B||!X&&!B?b[3]:P[1];d.addSegment(O,s,{x1:b[0],y1:b[1],x2:b[2],y2:b[3]}),d.addSegment(O,a,{r:W,x1:b[2],y1:b[3],x2:P[0],y2:P[1],cx:Q,cy:V,ac:B})}else{var J=b[2]===b[0]?0:b[2]>b[0]?M.lw/2:-(M.lw/2),A=b[3]===b[1]?0:b[3]>b[1]?M.lw/2:-(M.lw/2);d.addSegment(O,s,{x1:b[0]-J,y1:b[1]-A,x2:b[2]+J,y2:b[3]+A})}b=P}P!=null&&d.addSegment(O,s,{x1:P[0],y1:P[1],x2:P[2],y2:P[3]})},"writeSegments");this.midpoint=c,this._compute=function(O,_){i=[],m=null,v=null,O._meta||(O._meta={});var M=_.sourceEndpoint._domElement,b=_.targetEndpoint._domElement;M.classList.contains("output-endpoint")||([M,b]=[b,M]);let P=0;const L=this._jsPlumb.instance.getZoom();if(M&&b){const G=M.getBoundingClientRect(),Y=b.getBoundingClientRect(),se=O._meta.sourceComponentElement||M.closest(".component");O._meta.sourceComponentElement=se;const le=se.getBoundingClientRect(),ne=O._meta.targetComponentElement||b.closest(".component");O._meta.targetComponentElement=ne;const he=ne.getBoundingClientRect(),pe=O._meta.outputsElement||se.querySelector(".ep-control.outputs");O._meta.outputsElement=pe;const fe=O._meta.inputsElement||ne.querySelector(".ep-control.inputs");O._meta.inputsElement=fe;const me=pe.getBoundingClientRect(),we=fe.getBoundingClientRect();if(Y.left<=G.right){const _e=(le.bottom-G.top)/(le.bottom-me.bottom);c=(le.bottom-15*L-G.top)/(Y.bottom-G.bottom),c+=he.bottom>le.bottom?_e/10:-_e/10,he.bottom<le.top&&(c=(G.top-le.top+15*L)/(G.bottom-Y.bottom),c+=he.bottom<le.bottom?_e/10:-_e/10),P=26*_e}else{const _e=Y.left-G.right;c=(le.bottom-G.top)/(le.bottom-me.bottom),we.bottom<me.top&&(c=1-c),_e>110&&(c*=1/_e*100*.6),c*=L}}var N=pn(function(){return[O.startStubX,O.startStubY,O.endStubX,O.endStubY]},"commonStubCalculator"),z={perpendicular:N,orthogonal:N,opposite:function(G){var Y=O,se=G==="x"?0:1,le={x:function(){return Y.so[se]===1&&(Y.startStubX>Y.endStubX&&Y.tx>Y.startStubX||Y.sx>Y.endStubX&&Y.tx>Y.sx)||Y.so[se]===-1&&(Y.startStubX<Y.endStubX&&Y.tx<Y.startStubX||Y.sx<Y.endStubX&&Y.tx<Y.sx)},y:function(){return Y.so[se]===1&&(Y.startStubY>Y.endStubY&&Y.ty>Y.startStubY||Y.sy>Y.endStubY&&Y.ty>Y.sy)||Y.so[se]===-1&&(Y.startStubY<Y.endStubY&&Y.ty<Y.startStubY||Y.sy<Y.endStubY&&Y.ty<Y.sy)}};return!l&&le[G]()?{x:[(O.sx+O.tx)/2,O.startStubY,(O.sx+O.tx)/2,O.endStubY],y:[O.startStubX,(O.sy+O.ty)/2,O.endStubX,(O.sy+O.ty)/2]}[G]:[O.startStubX+P,O.startStubY,O.endStubX+P-20,O.endStubY]}},I=z[O.anchorOrientation](O.sourceAxis),W=O.sourceAxis==="x"?0:1,B=O.sourceAxis==="x"?1:0,K=I[W],q=I[B],X=I[W+2],Q=I[B+2];f(i,I[0],I[1],O);var V=O.startStubX+(O.endStubX-O.startStubX)*c,J=O.startStubY+(O.endStubY-O.startStubY)*c,A={x:[0,1],y:[1,0]},j={perpendicular:function(G){var Y=O,se={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},le={x:[[Y.startStubX,Y.endStubX],null,[Y.endStubX,Y.startStubX]],y:[[Y.startStubY,Y.endStubY],null,[Y.endStubY,Y.startStubY]]},ne={x:[[V,Y.startStubY],[V,Y.endStubY]],y:[[Y.startStubX,J],[Y.endStubX,J]]},he={x:[[Y.endStubX,Y.startStubY]],y:[[Y.startStubX,Y.endStubY]]},pe={x:[[Y.startStubX,Y.endStubY],[Y.endStubX,Y.endStubY]],y:[[Y.endStubX,Y.startStubY],[Y.endStubX,Y.endStubY]]},fe={x:[[Y.startStubX,J],[Y.endStubX,J],[Y.endStubX,Y.endStubY]],y:[[V,Y.startStubY],[V,Y.endStubY],[Y.endStubX,Y.endStubY]]},me={x:[Y.startStubY,Y.endStubY],y:[Y.startStubX,Y.endStubX]},we=A[G][0],_e=A[G][1],je=Y.so[we]+1,Pe=Y.to[_e]+1,qe=Y.to[_e]===-1&&me[G][1]<me[G][0]||Y.to[_e]===1&&me[G][1]>me[G][0],Me=le[G][je][0],ye=le[G][je][1],be=se[G][je][Pe];if(Y.segment===be[3]||Y.segment===be[2]&&qe)return ne[G];if(Y.segment===be[2]&&ye<Me)return he[G];if(Y.segment===be[2]&&ye>=Me||Y.segment===be[1]&&!qe)return fe[G];if(Y.segment===be[0]||Y.segment===be[1]&&qe)return pe[G]},orthogonal:function(G,Y,se,le,ne){var he=O,pe={x:he.so[0]===-1?Math.min(Y,le):Math.max(Y,le),y:he.so[1]===-1?Math.min(Y,le):Math.max(Y,le)}[G];return{x:[[pe,se],[pe,ne],[le,ne]],y:[[se,pe],[ne,pe],[ne,le]]}[G]},opposite:function(G,Y,se,le){var ne=O,he={x:"y",y:"x"}[G],pe={x:"height",y:"width"}[G],fe=ne["is"+G.toUpperCase()+"GreaterThanStubTimes2"];if(_.sourceEndpoint.elementId===_.targetEndpoint.elementId){var me=se+(1-_.sourceEndpoint.anchor[he])*_.sourceInfo[pe]+d.maxStub;return{x:[[Y,me],[le,me]],y:[[me,Y],[me,le]]}[G]}else{if(!fe||ne.so[W]===1&&Y>le||ne.so[W]===-1&&Y<le)return{x:[[Y,J],[le,J]],y:[[V,Y],[V,le]]}[G];if(ne.so[W]===1&&Y<le||ne.so[W]===-1&&Y>le)return{x:[[V,ne.sy],[V,ne.ty]],y:[[ne.sx,J],[ne.tx,J]]}[G]}}},S=j[O.anchorOrientation](O.sourceAxis,K,q,X,Q);if(S)for(var U=0;U<S.length;U++)f(i,S[U][0],S[U][1],O);f(i,I[2],I[3],O),f(i,O.tx,O.ty,O),F(this,i,O)}},"SmythFlowchart");e.Connectors.SmythFlowchart=o,t.extend(e.Connectors.SmythFlowchart,e.Connectors.AbstractConnector)}u(Mh,"dt"),pn(Mh,"initSmythFlowchartConnector");function Nh(n){var e=n.jsPlumb,t=n.jsPlumbUtil,s=pn(function(a){a=a||{},this.type="SmythBezier";var o=e.Connectors.AbstractBezierConnector.apply(this,arguments),r=a.curviness||150,i=10;this.getCurviness=function(){return r},this._findControlPoint=function(d,c,l,m,v,x,C){let w=r,f=m._domElement,T=v._domElement;try{if(f&&T){f.classList.contains("output-endpoint")||([f,T]=[T,f]);var k=f.closest(".component").getBoundingClientRect(),F=T.closest(".component").getBoundingClientRect();const M=F.left-k.right,b=k.bottom<F.top||F.bottom<k.top,P=Math.min(Math.abs(k.top-F.bottom),Math.abs(k.bottom-F.top));w=b||M>150?r:50}else w=i}catch(M){console.log("Error in _findControlPoint",M)}var O=x[0]!==C[0]||x[1]===C[1],_=[];return O?(C[0]===0?_.push(l[0]<c[0]?d[0]+i:d[0]-i):_.push(d[0]+w*C[0]),C[1]===0?_.push(l[1]<c[1]?d[1]+i:d[1]-i):_.push(d[1]+w*x[1])):(x[0]===0?_.push(c[0]<l[0]?d[0]+i:d[0]-i):_.push(d[0]-w*x[0]),x[1]===0?_.push(c[1]<l[1]?d[1]+i:d[1]-i):_.push(d[1]+w*C[1])),_},this._computeBezier=function(d,c,l,m,v,x){var C,w,f=l[0]<m[0]?v:0,T=l[1]<m[1]?x:0,k=l[0]<m[0]?0:v,F=l[1]<m[1]?0:x;C=this._findControlPoint([f,T],l,m,c.sourceEndpoint,c.targetEndpoint,d.so,d.to),w=this._findControlPoint([k,F],m,l,c.targetEndpoint,c.sourceEndpoint,d.to,d.so),o.addSegment(this,"Bezier",{x1:f,y1:T,x2:k,y2:F,cp1x:C[0],cp1y:C[1],cp2x:w[0],cp2y:w[1]})}},"SmythBezier");e.Connectors.SmythBezier=s,t.extend(s,e.Connectors.AbstractBezierConnector)}u(Nh,"mt"),pn(Nh,"initSmythBezierConnector");function $h(){Mh(window),Nh(window)}u($h,"extendJsPlumb"),pn($h,"extendJsPlumb");var ZE=Object.defineProperty,QE=u((n,e)=>ZE(n,"name",{value:e,configurable:!0}),"_");const Fh=class{static{u(this,"P")}constructor(e){this.workspace=e}write(e){const t=document.createElement("input");t.style.position="fixed",t.style.opacity="0",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)}async read(){return navigator.clipboard.readText()}copySelection(){const e=[...document.querySelectorAll(".component.selected")],t=e.map(i=>i.id),s=e.map(i=>{const d=i._control;return{id:i.id,name:i.querySelector(".title-bar").getAttribute("smt-name"),outputs:[...i.querySelectorAll(".output-endpoint")].map((c,l)=>({name:c.getAttribute("smt-name"),color:c.getAttribute("smt-color"),...this.workspace.extractComponentOutputProps(i,c),index:l,uuid:c.endpoint?.getUuid(),default:d.properties.defaultOutputs.includes(c.getAttribute("smt-name"))})),inputs:[...i.querySelectorAll(".input-endpoint")].map((c,l)=>({name:c.getAttribute("smt-name"),type:c.getAttribute("smt-type"),color:c.getAttribute("smt-color"),optional:c.getAttribute("smt-optional")==="true",...this.workspace.extractComponentInputProps(i,c),index:l,uuid:c.endpoint?.getUuid(),default:d.properties.defaultInputs.includes(c.getAttribute("smt-name"))})),data:d.data,top:i.style.top,left:i.style.left,width:i.style.width,height:i.style.height,displayName:d.drawSettings.displayName,title:d.title,aiTitle:d.aiTitle,description:d.description,template:d.properties.template}}),a=this.workspace.jsPlumbInstance.getAllConnections().map(i=>{const d=i.source,c=i.target,l=d.closest(".component"),m=c.closest(".component");return!l||!m||!t.includes(l.id)||!t.includes(m.id)?null:{sourceId:d.closest(".component").id,sourceIndex:[...d.parentElement.querySelectorAll(".output-endpoint")].findIndex(v=>v===d),targetId:c.closest(".component").id,targetIndex:[...c.parentElement.querySelectorAll(".input-endpoint")].findIndex(v=>v===c)}}).filter(i=>i),o=s.reduce((i,d)=>{const c=parseInt(d.top),l=parseInt(d.left);return{top:Math.min(i.top,c),left:Math.min(i.left,l)}},{top:1/0,left:1/0});s.forEach(i=>{i.top=`${parseInt(i.top)-o.top}px`,i.left=`${parseInt(i.left)-o.left}px`});const r=[];return s.forEach(i=>{const d=Dn();r.push({oldId:i.id,newId:d}),i.id=d}),a.forEach(i=>{const d=r.find(l=>l.oldId===i.sourceId)?.newId||i.sourceId,c=r.find(l=>l.oldId===i.targetId)?.newId||i.targetId;i.sourceId=d,i.targetId=c}),JSON.stringify({components:s,connections:a,partial:!0})}async pasteSelection(e,t,s){const a=this.workspace;a._loading=!0;try{const o=typeof e=="string"?JSON.parse(e):e,{components:r}=o;t===void 0&&(t=a.mouseCoords.x),s===void 0&&(s=a.mouseCoords.y);const i={};await Promise.all(r.map(async l=>{const m=await a.addComponent(l.name,{outputs:l?.outputs?.map(v=>v.name)||[],inputs:l?.inputs?.map(v=>v.name)||[],outputProps:l?.outputs||[],inputProps:l?.inputs||[],data:l?.data||{},top:`${parseInt(l.top)+s}px`,left:`${parseInt(l.left)+t}px`,width:l.width,title:l.title||"",aiTitle:l.aiTitle||"",description:l.description||"",uid:Dn(),template:l.template},!1);m.classList.add("selected"),i[l.id]=m.id}));const d=document.querySelector(".component.active");d?._control&&d._control.closeSettings(),await $e(50);const c=[];await Promise.all(o.connections.map(async l=>{await $e(~~(Math.random()*100));try{const m=i[l.sourceId],v=i[l.targetId],x=document.getElementById(m),C=document.getElementById(v),w=o.components.find(_=>_.id===l.sourceId),f=o.components.find(_=>_.id===l.targetId),T=w.outputs[l.sourceIndex].name,k=f.inputs[l.targetIndex].name;let F=5,O=100;for(let _=0;_<F;_++){const M=~~(Math.random()*50)+_*O;try{const b=x.querySelector(`.output-endpoint[smt-name='${T}']`),P=C.querySelector(`.input-endpoint[smt-name='${k}']`);if(!b||!P){await $e(M);continue}const L=b.id+":"+P.id;if(c.includes(L))continue;const N=a.jsPlumbInstance.connect({source:b.endpoint,target:P.endpoint,detachable:!0,cssClass:"exclude-panzoom"});this.workspace.updateConnectionStyle(N),c.push(L);break}catch{await $e(M)}}}catch(m){console.error("Error adding connection:",m)}})),console.log("selection pasted"),document.querySelectorAll(".component:not(.selected)").forEach(l=>{l.classList.add("unselected")}),await $e(100),a._loading=!1}catch(o){console.error("Error pasting selection:",o)}finally{await $e(100),a._loading=!1}a.checkConnectionsConsistency()}copySelection_deprecated(){const e=[...document.querySelectorAll(".component.selected")],t=e.map(l=>({uid:l?.properties?.uid||l?._control?.uid,name:l._control.constructor.name,properties:JSON.parse(JSON.stringify(l._control.properties)),data:JSON.parse(JSON.stringify(l._control.data)),title:l._control.title,description:l._control.description,noteText:l?.querySelector(".note-text")?.innerHTML||""})),s=this.workspace.jsPlumbInstance.getAllConnections().map(l=>{const m=l.source,v=l.target,x=m.closest(".component"),C=v.closest(".component");return!x||!C?null:{sourceId:m.closest(".component").id,sourceIndex:[...m.parentElement.querySelectorAll(".output-endpoint")].findIndex(w=>w===m),targetId:v.closest(".component").id,targetIndex:[...v.parentElement.querySelectorAll(".input-endpoint")].findIndex(w=>w===v)}}).filter(l=>l!==null),a=e.map(l=>l.id),o=s.filter(l=>a.includes(l.sourceId)&&a.includes(l.targetId)),r=t.reduce((l,m)=>parseInt(m.properties.top)<parseInt(l.properties.top)||parseInt(m.properties.top)===parseInt(l.properties.top)&&parseInt(m.properties.left)<parseInt(l.properties.left)?m:l),i=parseInt(r.properties.top),d=parseInt(r.properties.left);t.forEach(l=>{l.properties.top=parseInt(l.properties.top)-i+"px",l.properties.left=parseInt(l.properties.left)-d+"px"});const c=[];return t.forEach(l=>{const m=Dn();c.push({oldId:l.uid,newId:m}),l.properties.uid=m,l.properties.top=parseInt(l.properties.top)+100+"px",l.properties.left=parseInt(l.properties.left)+40+"px"}),o.forEach(l=>{const m=c.find(x=>x.oldId===l.sourceId)?.newId||l.sourceId,v=c.find(x=>x.oldId===l.targetId)?.newId||l.targetId;l.sourceId=m,l.targetId=v}),JSON.stringify({componentsProps:t,connections:o})}async pasteSelection_deprecated(e,t,s){const a=this.workspace,o=JSON.parse(e);if(t===void 0&&(t=a.mouseCoords.x),s===void 0&&(s=a.mouseCoords.y),o.name&&o.componentName){console.log("pasting component template");const m={uid:"TPL"+Dn(),top:s+"px",left:t+"px",sender:null,title:o.name,description:o.description,template:o},v=(await a.addComponent(o.componentName,m,!0))._control;for(let x in o.data)v.data[x]=o.data[x];await $e(100),v.checkSettings();return}const{componentsProps:r,connections:i}=o,d=[];r.forEach(m=>{const v=Dn();d.push({oldId:m.properties.uid,newId:v}),m.properties.uid=v,m.properties.top=parseInt(m.properties.top)+s+"px",m.properties.left=parseInt(m.properties.left)+t+"px",m.properties.sender=null}),i.forEach(m=>{const v=d.find(C=>C.oldId===m.sourceId)?.newId||m.sourceId,x=d.find(C=>C.oldId===m.targetId)?.newId||m.targetId;m.sourceId=v,m.targetId=x});let c=r.length;await new Promise(m=>{r.forEach(async v=>{const x=await a.addComponent(v.name,v.properties,!1);for(let C in v.data){x._control.data[C]=v.data[C],x._control.title=v.title,x._control.description=v.description,x.classList.add("selected");const w=x.querySelector(".title-bar"),f=w.querySelector(".title"),T=w.querySelector(".description");f.textContent=v?.title,T.textContent=v.description,x.style.zIndex||(x.style.zIndex="999");const k=x?.querySelector(".note-text");k&&(k.innerHTML=v?.noteText||"",f.style.color=v?.data?.textColor||"#000",k.style.color=v?.data?.textColor||"#000",x.style.backgroundColor=v?.data?.color||"#c7ff1529",x.style.borderColor=v?.data?.color||"#c7ff1529")}await $e(50),x._control.checkSettings(),c--,c<=0&&(await $e(300),m(!0))})});const l=document.querySelector(".component.active");l?._control&&l._control.closeSettings(),i.forEach(async m=>{const v=document.querySelector(`#${m.sourceId} .output-endpoint:nth-child(${m.sourceIndex+1})`),x=document.querySelector(`#${m.targetId} .input-endpoint:nth-child(${m.targetIndex+1})`);v.endpoint.id+""+x.endpoint.id,a.jsPlumbInstance.connect({source:v.endpoint,target:x.endpoint,detachable:!0,cssClass:"exclude-panzoom"})})}};QE(Fh,"ClipboardManager");let ek=Fh;var tk=Object.defineProperty,rl=u((n,e)=>tk(n,"name",{value:e,configurable:!0}),"n$1");function Rh(){let n=null;document.addEventListener("click",s=>{const a=s.target?.closest("[data-smyth-dropdown-toggle]");if(a){const o=a.getAttribute("data-smyth-dropdown-toggle");if(o){const r=document.getElementById(o);r&&e(r)}}else n&&t(n)});function e(s){n&&n!==s&&t(n),s?.classList?.remove("hidden"),n=s}u(e,"o"),rl(e,"show");function t(s){s?.classList?.add("hidden"),n=null}u(t,"d"),rl(t,"hide")}u(Rh,"registerDropdown"),rl(Rh,"registerDropdown");var nk=Object.defineProperty,ll=u((n,e)=>nk(n,"name",{value:e,configurable:!0}),"r");window.__GLOBAL_TEMPLATE_VARIABLES__=new Map;function qh(n){const e=document.createElement("button");e.className="mt-2 w-9 px-3 py-2 hover:opacity-75 relative bg-primary-100 text-white text-sm duration-200 font-bold text-center",e.innerHTML="Manage";const t=document.createElement("textarea");t.className="hidden",t.setAttribute("readonly","true"),t.id="global-vars-textarea";const s=document.createElement("div"),a=document.getElementById("agent-global-variables-button");s.className="relative",s.appendChild(t),a&&(s.appendChild(e),a.appendChild(e),a.appendChild(t));const o=document.getElementById("agent-status");function r(i){t.value=JSON.stringify(i.data.variables||{},null,2),cl(i.data.variables),e.onclick=async()=>{console.log("Agent Loaded : handling global vars",i);const d=await kc({title:"Agent Variables",content:'<div class="px-2 py-2">The declared Agent Variables are available to all components</div>',fields:{_globalVars:{type:"key-value",rel:"#global-vars-textarea",keyField:{attributes:{placeholder:"Name"}},valueField:{attributes:{placeholder:"Value","data-vault":"ALL_NON_GLOBAL_KEYS"}}}}});if(!d)return;console.log("Global Vars : ",d),t.value=JSON.stringify(d._globalVars,null,2);const c=d._globalVars;i.data.variables=c,cl(c),n.saveAgent()},o.appendChild(s)}u(r,"s"),ll(r,"updateGlobalVars"),n.addEventListener("AgentLoaded",r),n.addEventListener("agentUpdated",r)}u(qh,"registerGlobalVars"),ll(qh,"registerGlobalVars");function cl(n={}){window.__GLOBAL_TEMPLATE_VARIABLES__.clear();for(const[e,t]of Object.entries(n))window.__GLOBAL_TEMPLATE_VARIABLES__.set(e,{var:`{{${e}}}`,type:"global"})}u(cl,"c$1"),ll(cl,"setGlobalVars");const ul=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function dl(n,e,t,s){n.addEventListener?n.addEventListener(e,t,s):n.attachEvent&&n.attachEvent("on".concat(e),t)}u(dl,"addEvent");function Ba(n,e,t,s){n.removeEventListener?n.removeEventListener(e,t,s):n.detachEvent&&n.detachEvent("on".concat(e),t)}u(Ba,"removeEvent");function Bh(n,e){const t=e.slice(0,e.length-1);for(let s=0;s<t.length;s++)t[s]=n[t[s].toLowerCase()];return t}u(Bh,"getMods");function Uh(n){typeof n!="string"&&(n=""),n=n.replace(/\s/g,"");const e=n.split(",");let t=e.lastIndexOf("");for(;t>=0;)e[t-1]+=",",e.splice(t,1),t=e.lastIndexOf("");return e}u(Uh,"getKeys");function sk(n,e){const t=n.length>=e.length?n:e,s=n.length>=e.length?e:n;let a=!0;for(let o=0;o<t.length;o++)s.indexOf(t[o])===-1&&(a=!1);return a}u(sk,"compareArray");const Ua={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,arrowup:38,arrowdown:40,arrowleft:37,arrowright:39,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":ul?173:189,"=":ul?61:187,";":ul?59:186,"'":222,"{":219,"}":221,"[":219,"]":221,"\\":220},Sn={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,meta:91,command:91},za={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Mt={16:!1,18:!1,17:!1,91:!1},wt={};for(let n=1;n<20;n++)Ua["f".concat(n)]=111+n;let xt=[],Ga=null,zh="all";const qn=new Map,Zs=u(n=>Ua[n.toLowerCase()]||Sn[n.toLowerCase()]||n.toUpperCase().charCodeAt(0),"code"),ak=u(n=>Object.keys(Ua).find(e=>Ua[e]===n),"getKey"),ik=u(n=>Object.keys(Sn).find(e=>Sn[e]===n),"getModifier");function Gh(n){zh=n||"all"}u(Gh,"setScope");function Ha(){return zh||"all"}u(Ha,"getScope");function ok(){return xt.slice(0)}u(ok,"getPressedKeyCodes");function rk(){return xt.map(n=>ak(n)||ik(n)||String.fromCharCode(n))}u(rk,"getPressedKeyString");function lk(){const n=[];return Object.keys(wt).forEach(e=>{wt[e].forEach(t=>{let{key:s,scope:a,mods:o,shortcut:r}=t;n.push({scope:a,shortcut:r,mods:o,keys:s.split("+").map(i=>Zs(i))})})}),n}u(lk,"getAllKeyCodes");function ck(n){const e=n.target||n.srcElement,{tagName:t}=e;let s=!0;const a=t==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(a||t==="TEXTAREA"||t==="SELECT")&&!e.readOnly)&&(s=!1),s}u(ck,"filter");function uk(n){return typeof n=="string"&&(n=Zs(n)),xt.indexOf(n)!==-1}u(uk,"isPressed");function dk(n,e){let t,s;n||(n=Ha());for(const a in wt)if(Object.prototype.hasOwnProperty.call(wt,a))for(t=wt[a],s=0;s<t.length;)t[s].scope===n?t.splice(s,1).forEach(r=>{let{element:i}=r;return pl(i)}):s++;Ha()===n&&Gh(e||"all")}u(dk,"deleteScope");function pk(n){let e=n.keyCode||n.which||n.charCode;n.key&&n.key.toLowerCase()==="capslock"&&(e=Zs(n.key));const t=xt.indexOf(e);if(t>=0&&xt.splice(t,1),n.key&&n.key.toLowerCase()==="meta"&&xt.splice(0,xt.length),(e===93||e===224)&&(e=91),e in Mt){Mt[e]=!1;for(const s in Sn)Sn[s]===e&&(Bn[s]=!1)}}u(pk,"clearModifier");function Hh(n){if(typeof n>"u")Object.keys(wt).forEach(a=>{Array.isArray(wt[a])&&wt[a].forEach(o=>co(o)),delete wt[a]}),pl(null);else if(Array.isArray(n))n.forEach(a=>{a.key&&co(a)});else if(typeof n=="object")n.key&&co(n);else if(typeof n=="string"){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];let[a,o]=t;typeof a=="function"&&(o=a,a=""),co({key:n,scope:a,method:o,splitKey:"+"})}}u(Hh,"unbind");const co=u(n=>{let{key:e,scope:t,method:s,splitKey:a="+"}=n;Uh(e).forEach(r=>{const i=r.split(a),d=i.length,c=i[d-1],l=c==="*"?"*":Zs(c);if(!wt[l])return;t||(t=Ha());const m=d>1?Bh(Sn,i):[],v=[];wt[l]=wt[l].filter(x=>{const w=(s?x.method===s:!0)&&x.scope===t&&sk(x.mods,m);return w&&v.push(x.element),!w}),v.forEach(x=>pl(x))})},"eachUnbind");function Vh(n,e,t,s){if(e.element!==s)return;let a;if(e.scope===t||e.scope==="all"){a=e.mods.length>0;for(const o in Mt)Object.prototype.hasOwnProperty.call(Mt,o)&&(!Mt[o]&&e.mods.indexOf(+o)>-1||Mt[o]&&e.mods.indexOf(+o)===-1)&&(a=!1);(e.mods.length===0&&!Mt[16]&&!Mt[18]&&!Mt[17]&&!Mt[91]||a||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(xt),e.method(n,e)===!1&&(n.preventDefault?n.preventDefault():n.returnValue=!1,n.stopPropagation&&n.stopPropagation(),n.cancelBubble&&(n.cancelBubble=!0)))}}u(Vh,"eventHandler");function Wh(n,e){const t=wt["*"];let s=n.keyCode||n.which||n.charCode;if(n.key&&n.key.toLowerCase()==="capslock"||!Bn.filter.call(this,n))return;if((s===93||s===224)&&(s=91),xt.indexOf(s)===-1&&s!==229&&xt.push(s),["metaKey","ctrlKey","altKey","shiftKey"].forEach(i=>{const d=za[i];n[i]&&xt.indexOf(d)===-1?xt.push(d):!n[i]&&xt.indexOf(d)>-1?xt.splice(xt.indexOf(d),1):i==="metaKey"&&n[i]&&(xt=xt.filter(c=>c in za||c===s))}),s in Mt){Mt[s]=!0;for(const i in Sn)if(Object.prototype.hasOwnProperty.call(Sn,i)){const d=za[Sn[i]];Bn[i]=n[d]}if(!t)return}for(const i in Mt)Object.prototype.hasOwnProperty.call(Mt,i)&&(Mt[i]=n[za[i]]);n.getModifierState&&!(n.altKey&&!n.ctrlKey)&&n.getModifierState("AltGraph")&&(xt.indexOf(17)===-1&&xt.push(17),xt.indexOf(18)===-1&&xt.push(18),Mt[17]=!0,Mt[18]=!0);const a=Ha();if(t)for(let i=0;i<t.length;i++)t[i].scope===a&&(n.type==="keydown"&&t[i].keydown||n.type==="keyup"&&t[i].keyup)&&Vh(n,t[i],a,e);if(!(s in wt))return;const o=wt[s],r=o.length;for(let i=0;i<r;i++)if((n.type==="keydown"&&o[i].keydown||n.type==="keyup"&&o[i].keyup)&&o[i].key){const d=o[i],{splitKey:c}=d,l=d.key.split(c),m=[];for(let v=0;v<l.length;v++)m.push(Zs(l[v]));m.sort().join("")===xt.sort().join("")&&Vh(n,d,a,e)}}u(Wh,"dispatch");function Bn(n,e,t){xt=[];const s=Uh(n);let a=[],o="all",r=document,i=0,d=!1,c=!0,l="+",m=!1,v=!1;for(t===void 0&&typeof e=="function"&&(t=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(o=e.scope),e.element&&(r=e.element),e.keyup&&(d=e.keyup),e.keydown!==void 0&&(c=e.keydown),e.capture!==void 0&&(m=e.capture),typeof e.splitKey=="string"&&(l=e.splitKey),e.single===!0&&(v=!0)),typeof e=="string"&&(o=e),v&&Hh(n,o);i<s.length;i++)n=s[i].split(l),a=[],n.length>1&&(a=Bh(Sn,n)),n=n[n.length-1],n=n==="*"?"*":Zs(n),n in wt||(wt[n]=[]),wt[n].push({keyup:d,keydown:c,scope:o,mods:a,shortcut:s[i],method:t,key:s[i],splitKey:l,element:r});if(typeof r<"u"&&window){if(!qn.has(r)){const x=u(function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Wh(w,r)},"keydownListener"),C=u(function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Wh(w,r),pk(w)},"keyupListenr");qn.set(r,{keydownListener:x,keyupListenr:C,capture:m}),dl(r,"keydown",x,m),dl(r,"keyup",C,m)}if(!Ga){const x=u(()=>{xt=[]},"listener");Ga={listener:x,capture:m},dl(window,"focus",x,m)}}}u(Bn,"hotkeys");function hk(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(wt).forEach(t=>{wt[t].filter(a=>a.scope===e&&a.shortcut===n).forEach(a=>{a&&a.method&&a.method()})})}u(hk,"trigger");function pl(n){const e=Object.values(wt).flat();if(e.findIndex(s=>{let{element:a}=s;return a===n})<0){const{keydownListener:s,keyupListenr:a,capture:o}=qn.get(n)||{};s&&a&&(Ba(n,"keyup",a,o),Ba(n,"keydown",s,o),qn.delete(n))}if((e.length<=0||qn.size<=0)&&(Object.keys(qn).forEach(a=>{const{keydownListener:o,keyupListenr:r,capture:i}=qn.get(a)||{};o&&r&&(Ba(a,"keyup",r,i),Ba(a,"keydown",o,i),qn.delete(a))}),qn.clear(),Object.keys(wt).forEach(a=>delete wt[a]),Ga)){const{listener:a,capture:o}=Ga;Ba(window,"focus",a,o),Ga=null}}u(pl,"removeKeyEvent");const hl={getPressedKeyString:rk,setScope:Gh,getScope:Ha,deleteScope:dk,getPressedKeyCodes:ok,getAllKeyCodes:lk,isPressed:uk,filter:ck,trigger:hk,unbind:Hh,keyMap:Ua,modifier:Sn,modifierMap:za};for(const n in hl)Object.prototype.hasOwnProperty.call(hl,n)&&(Bn[n]=hl[n]);if(typeof window<"u"){const n=window.hotkeys;Bn.noConflict=e=>(e&&window.hotkeys===Bn&&(window.hotkeys=n),Bn),window.hotkeys=Bn}var mk=Object.defineProperty,Yt=u((n,e)=>mk(n,"name",{value:e,configurable:!0}),"p");let os=!1;function ml(n){if(!Array.isArray(n)||n.length===0)throw new Error("Input must be a non-empty array of DOM components.");let e=1/0,t=1/0,s=-1/0,a=-1/0;return n.forEach(o=>{const r=o.style,i=parseFloat(r.left)||0,d=parseFloat(r.top)||0,c=parseFloat(o.clientWidth)||0,l=parseFloat(o.clientHeight)||0,m=i+c,v=d+l;e=Math.min(e,i),t=Math.min(t,d),s=Math.max(s,m),a=Math.max(a,v)}),{x:e,y:t,width:s-e,height:a-t}}u(ml,"E"),Yt(ml,"calculateBoundingBox");function Va(n){n.forEach(e=>{const t=e.components.map(a=>document.getElementById(a.id)),s=ml(t);e.box?(e.box.x=s.x,e.box.y=s.y,e.box.width=s.width,e.box.height=s.height):e.box=s})}u(Va,"b$2"),Yt(Va,"updateWFBoundingBox");async function gl(n){const{components:e,connections:t}=n;function s(){const d=new Map;return e.forEach(c=>{d.set(c.id,[])}),t.forEach(({sourceId:c,targetId:l})=>{d.has(c)&&d.get(c).push(l)}),d}u(s,"t"),Yt(s,"buildGraph");function a(d,c){const l={},m=new Set;e.forEach(x=>{l[x.id]=x.name==="APIEndpoint"?0:1});function v(x,C){m.add(x),l[x]=Math.max(l[x],C),(c.get(x)||[]).forEach(w=>{v(w,l[x]+1)})}return u(v,"i"),Yt(v,"dfs"),v(d,0),l}u(a,"n"),Yt(a,"calculateLevels");function o(d){const c=s(),l=a(d,c);let m=new Set,v=[d],x=[],C=[];for(;v.length>0;){const w=v.pop();if(!m.has(w)){m.add(w);const f=e.find(T=>T.id===w);f&&(x.push({...f,_level:l[w]}),(t.filter(T=>T.sourceId===w)||[]).forEach(T=>{C.push(T),v.push(T.targetId)}))}}return e.sort((w,f)=>w._level-f._level),{components:x,connections:C}}u(o,"a"),Yt(o,"getConnectedComponentsAndConnections");function r(d){return t.filter(c=>c.targetId===d.id).length===0}u(r,"w"),Yt(r,"isSourceComponent");const i=[];if(!e)return i;for(let d of e)if(r(d)){const c=o(d.id);i.push(c)}return Va(i),i}u(gl,"I"),Yt(gl,"extractWorkflows");async function Kh(n,e,t){for(let s of n.components){const a=document.getElementById(s.id);if(!a)continue;a.style.transition="0.2s ease-in-out";const o=parseInt(a.style.left)+e,r=parseInt(a.style.top)+t;a.style.left=`${o}px`,a.style.top=`${r}px`}await $e(300);for(let s of n.components){const a=document.getElementById(s.id);a&&(a.style.transition="",workspace.jsPlumbInstance.repaint(a))}}u(Kh,"M"),Yt(Kh,"moveFlow");async function fl(n){if(!n||n.length===0)return[];const e=Math.min(...n.map(s=>s.box.x));n.sort((s,a)=>s.box.y-a.box.y);let t=0;for(let s of n)await Kh(s,e-s.box.x,t-s.box.y),await Va([s]),t+=s.box.height+100;await $e(200),workspace.jsPlumbInstance.repaintEverything()}u(fl,"B"),Yt(fl,"alignBoxes");async function vl(n,e,t){const s={};n.forEach(r=>{const i=r._level;s[i]||(s[i]=[]),s[i].push(r)});let a=e;const o=Object.keys(s).sort((r,i)=>parseInt(r)-parseInt(i));for(let r of o){const i=s[r],d=Math.max(...i.map(l=>{const m=document.getElementById(l.id);return m&&m.offsetWidth||0}));let c=t;for(let l of i){const m=document.getElementById(l.id);m&&(m.style.transition="0.1s ease-in-out",m.style.left=`${a}px`,m.style.top=`${c}px`,c+=(m.offsetHeight||0)+100,m.style.transition="",await $e(100),m.style.transition="0.1s ease-in-out",workspace.jsPlumbInstance.repaint(m))}a+=d+200}return n}u(vl,"C"),Yt(vl,"organizeComponents");async function Yh(){document.querySelector(".component.selected")?await Jh():await Xh()}u(Yh,"sortAgent"),Yt(Yh,"sortAgent");async function Xh(){if(!os)try{os=!0;const n=await workspace.export(!1)||workspace.agent.data,e=await gl(n);await $e(50),await workspace.export(),await $e(200),workspace.lock();const t=10;for(let s=0;s<e.length;s+=t){const a=e.slice(s,s+t);for(let o of a)await vl(o.components,o.box.x,o.box.y);await $e(100)}await $e(100),Va(e),await $e(100),await fl(e),await $e(200),workspace.jsPlumbInstance.repaintEverything()}catch(n){console.error("Error during sort:",n)}finally{workspace.unlock();try{await $e(1e3),await workspace.export(),await workspace.saveAgent(),await $e(100),os=!1}catch(n){console.error("Error saving agent:",n),os=!1}}}u(Xh,"P"),Yt(Xh,"sortAll");async function Jh(){if(!os)try{os=!0;const n=await workspace.export(!1)||workspace.agent.data,e=await gl(n),t=[...document.querySelectorAll(".component.selected")];if(!t.length)return;const s=e.filter(o=>t.some(r=>o.components.some(i=>i.id===r.id)));workspace.lock();for(let o of s)await vl(o.components,o.box.x,o.box.y);const a=[];for(let o of e)s.includes(o)||a.push(...o.components);if(a.length>0){await $e(100),Va(s);const o=ml(a.map(r=>document.getElementById(r.id)));s.unshift({box:o,components:a,connections:[]})}await $e(100),fl(s),await $e(100),workspace.jsPlumbInstance.repaintEverything()}catch(n){console.error("Error during sort:",n)}finally{workspace.unlock(),await $e(500);try{await workspace.saveAgent(),await $e(100),os=!1}catch(n){console.error("Error saving agent:",n),os=!1}}}u(Jh,"S"),Yt(Jh,"sortSelection");var gk=Object.defineProperty,Zh=u((n,e)=>gk(n,"name",{value:e,configurable:!0}),"u$1");function Qh(n){const e=navigator.userAgent.includes("Mac"),t={save:e?"command+s":"ctrl+s",copy:e?"command+c":"ctrl+c",paste:e?"command+v":"ctrl+v",undo:e?"command+z":"ctrl+z",redo:e?"command+shift+z":"ctrl+shift+z",selectAll:e?"command+a":"ctrl+a",sort:e?"command+option+a":"ctrl+alt+a",export:e?"command+shift+e":"ctrl+shift+e",componentPriorityUp:e?"command+shift+]":"ctrl+shift+]",componentPriorityDown:e?"command+shift+[":"ctrl+shift+["},s=Bn.noConflict(),a="del, backspace";let o=!1;s(a,async(r,i)=>{if(n.locked||o)return!1;const d=window.getSelection(),c=d.toString(),l=Zh(f=>{const T=f instanceof Element?f:f.parentElement;return T instanceof HTMLElement&&(T.isContentEditable||T.tagName==="INPUT"||T.tagName==="TEXTAREA")},"isEditableElement");if(c&&(l(d.anchorNode)||l(d.focusNode)))return!1;const m=[...document.querySelectorAll(".component.selected")];if(m.length<=0)return!1;const v=m.map(f=>f._control);o=!0;const x=m.length===1?"component":"components",C=await En("",`Are you sure you want to delete selected ${x}?`,{icon:"",btnNoLabel:"No, Cancel",btnYesLabel:"Yes, I'm sure",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"});if(o=!1,!C)return;const w=[];v.forEach(f=>{w.push(f.delete(!0,!1))}),await Promise.all(w),await $e(200),n.saveAgent()}),s(t.save,(r,i)=>{if(n.locked)return!1}),s(t.copy,(r,i)=>{if(window.getSelection().toString())return;if(n.locked)return!1;if(n.hoveredElement.tagName=="TEXTAREA"||n.hoveredElement.tagName=="INPUT"||n.hoveredElement.classList.contains("dbg")||n.hoveredElement.closest(".dbg")||document.activeElement!=document.body)return;const d=n.clipboard.copySelection();n.clipboard.write(d)}),s(t.paste,async(r,i)=>{if(n.locked)return!1;if(n.hoveredElement.tagName=="TEXTAREA"||n.hoveredElement.tagName=="INPUT"||n.hoveredElement.classList.contains("dbg")||n.hoveredElement.closest(".dbg")||document.activeElement!=document.body)return;document.querySelectorAll(".component.selected").forEach(c=>c.classList.remove("selected"));const d=await n.clipboard.read();n.clipboard.pasteSelection(d),n.redraw()}),s(t.undo,(r,i)=>{if(n.locked)return!1;try{n.stateManager.undo()}catch(d){console.error("Error during undo",d)}}),s(t.redo,(r,i)=>{if(n.locked)return!1;try{n.stateManager.redo()}catch(d){console.error("Error during redo",d)}}),s(t.selectAll,(r,i)=>{if(n.locked)return!1;if(n.hoveredElement.classList.contains("dbg")||n.hoveredElement.closest(".dbg")){const l=n.hoveredElement.classList.contains("dbg")?n.hoveredElement:n.hoveredElement.closest(".dbg");window.getSelection().selectAllChildren(l),r.preventDefault(),r.stopPropagation(),r.stopImmediatePropagation();return}if(n.hoveredElement.tagName=="TEXTAREA"||n.hoveredElement.tagName=="INPUT")return;r.preventDefault(),r.stopPropagation(),r.stopImmediatePropagation();const d=document.querySelectorAll("#workspace-container .component.selected"),c=document.querySelectorAll("#workspace-container .component");d.length===c.length?c.forEach(l=>l.classList.remove("selected","unselected")):c.forEach(l=>{l.classList.add("selected"),l.classList.remove("unselected")})}),s("esc",(r,i)=>{if(n.locked)return!1}),s("enter",(r,i)=>{if(n.locked)return!1;mv()}),s(t.sort,async(r,i)=>{console.log("Sorting agent ..."),await Yh(),console.log("Agent sorted")}),s(t.export,async(r,i)=>{await n.exportTemplate()}),s(t.componentPriorityUp,(r,i)=>{if(n.locked)return!1;if(n.hoveredElement.tagName==="TEXTAREA"||n.hoveredElement.tagName==="INPUT"||n.hoveredElement.classList.contains("dbg")||n.hoveredElement.closest(".dbg"))return;const d=document.querySelectorAll(".component.selected");d.length!==0&&(d.forEach(c=>{c.style.zIndex="999",setTimeout(()=>{document.querySelectorAll(".component:not(.selected)").forEach(l=>{const m=l;(!m.style.zIndex||parseInt(m.style.zIndex)>900)&&(m.style.zIndex="1")})},50)}),n.redraw(),n.saveAgent())}),s(t.componentPriorityDown,(r,i)=>{if(n.locked)return!1;if(n.hoveredElement.tagName==="TEXTAREA"||n.hoveredElement.tagName==="INPUT"||n.hoveredElement.classList.contains("dbg")||n.hoveredElement.closest(".dbg"))return;const d=document.querySelectorAll(".component.selected");d.length!==0&&(d.forEach(c=>{c.style.zIndex="0"}),n.redraw(),n.saveAgent())})}u(Qh,"registerHotkeys"),Zh(Qh,"registerHotkeys");var fk=Object.defineProperty,Wa=u((n,e)=>fk(n,"name",{value:e,configurable:!0}),"u");function em(n){const e=document.querySelector("#minimap");if(!e)return;const t=e.getContext("2d"),s=n.container,a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");window.requestAnimationFrame(r);function r(){t.clearRect(0,0,e.width,e.height),o.clearRect(0,0,a.width,a.height),o.globalCompositeOperation="source-over";const x=i(),C=d(x);document.querySelectorAll(".component, .agent-card").forEach(f=>{const T=f.getBoundingClientRect(),k=T.width*C,F=T.height*C;t.fillStyle="#fff",t.beginPath(),t.roundRect((T.left-x.left)*C,(T.top-x.top)*C,k,F,2),t.fill()}),o.fillStyle="rgba(204, 204, 204, 0.8)",o.fillRect(0,0,a.width,a.height);const w=s.getBoundingClientRect();o.globalCompositeOperation="destination-out",o.fillRect((w.left-x.left)*C,(w.top-x.top)*C,s.offsetWidth*C,s.offsetHeight*C),t.globalAlpha=.5,t.drawImage(a,0,0),t.globalAlpha=1,t.strokeStyle="#ccc",t.lineWidth=2,t.strokeRect((w.left-x.left)*C,(w.top-x.top)*C,s.offsetWidth*C,s.offsetHeight*C),window.requestAnimationFrame(r)}u(r,"E"),Wa(r,"updateMiniMap");function i(){let x=Number.POSITIVE_INFINITY,C=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY;document.querySelectorAll(".component, .agent-card").forEach(k=>{const F=k.getBoundingClientRect();x=Math.min(x,F.left),C=Math.min(C,F.top),w=Math.max(w,F.right),f=Math.max(f,F.bottom)});const T=s.getBoundingClientRect();return x=Math.min(x,T.left),C=Math.min(C,T.top),w=Math.max(w,T.right),f=Math.max(f,T.bottom),x===Number.POSITIVE_INFINITY&&(x=0,C=0,w=100,f=100),{left:x,top:C,right:w,bottom:f}}u(i,"f"),Wa(i,"calculateWorkspaceBounds");function d(x){const C=x.right-x.left,w=x.bottom-x.top,f=e.width,T=e.height,k=f/C,F=T/w;let O=Math.min(k,F);return O=Math.min(O,.08),O}u(d,"I"),Wa(d,"calculateScaleFactor");function c(x){const C=n.panzoom,w=e.getBoundingClientRect(),f=s.getBoundingClientRect(),T=x.clientX-w.left,k=x.clientY-w.top,F=i(),O=d(F),_=s.getBoundingClientRect(),M=(_.left-F.left)*O,b=(_.top-F.top)*O,P=C.getPan();C.pan(P.x+f.width/2+(M-T)/O,P.y+f.height/2+(b-k)/O)}u(c,"b"),Wa(c,"canvasClick");let l=!1,m=0,v=0;e.addEventListener("mousedown",x=>{l=!0,m=x.clientX,v=x.clientY,c(x)}),e.addEventListener("mouseup",()=>{l=!1}),e.addEventListener("mouseleave",()=>{l=!1}),e.addEventListener("mousemove",x=>{const C=n.panzoom,w=C.getPan();if(l){const f=i(),T=d(f),k=x.clientX-m,F=x.clientY-v;m=x.clientX,v=x.clientY,C.pan(w.x-k/T,w.y-F/T,{animate:!1})}})}u(em,"registerMiniMap"),Wa(em,"registerMiniMap");var vk=Object.defineProperty,bl=u((n,e)=>vk(n,"name",{value:e,configurable:!0}),"n");const tm=class extends pa{static{u(this,"i")}constructor(e){super(),this.controller=null,this.monitorId=null,this.workspace=e}get id(){return this.monitorId}async init(){try{this.workspace?.serverData?.dbgUrl||(console.log("Waiting for server data to be loaded"),await new Promise(e=>{let t=bl(()=>{this.workspace.removeEventListener("ServerDataLoaded",t),e(!0),console.log("Server data loaded so we can initialize the monitor")},"listener");this.workspace.addEventListener("ServerDataLoaded",t)})),this.workspace?.agent?.id||(console.log("Waiting for agent to be loaded"),await new Promise(e=>{let t=bl(()=>{this.workspace.removeEventListener("AgentLoaded",t),e(!0),console.log("Agent loaded so we can initialize the monitor")},"listener");this.workspace.addEventListener("AgentLoaded",t)})),this.controller=await this.setupMonitor()}catch(e){console.error("Failed to initialize monitor:",e),this.emit("error",e)}}close(){this.controller&&(this.controller.abort(),this.controller=null,this.monitorId=null)}async setupMonitor(){const e=new AbortController;let t=`${this.workspace.serverData.dbgUrl}/sse/agent/${this.workspace.agent.id}/monitor`,s={"X-AGENT-ID":this.workspace.agent.id};return lu(t,{signal:e.signal,headers:s,async onopen(a){if(!a.ok)throw new Error(`Failed to open monitor connection: ${a.status}`);console.log("Monitor connection opened")},onmessage:a=>{this.processEvent(a)},onclose:()=>{console.log("Monitor connection closed"),this.emit("closed"),this.monitorId=null,this.controller=null,setTimeout(()=>this.init(),1e3)},onerror:a=>{console.error("Monitor connection error:",a),this.emit("error",a)},openWhenHidden:!0}),e}processEvent(e){const t={init:s=>{const a=s;return console.log("Monitor initialized:",a),this.monitorId=a,window.currentMonitorId=a,this.emit("initialized",{monitorId:a}),ya.send({function:"attachHeaders",args:[{"X-MONITOR-ID":a}]},["all"]),!1},agent:s=>(window.debugCurrentRunningAgentTimestamp=s.endTime?void 0:s.startTime,!0)};try{if(!(t[e.event]||(()=>!0))(e.data))return;const s=JSON.parse(e.data);this.emit(e.event,{type:e.event,timestamp:new Date().toISOString(),data:s})}catch(s){this.emit("error",s)}}};bl(tm,"Monitor");let bk=tm;var yk=Object.defineProperty,xk=u((n,e)=>yk(n,"name",{value:e,configurable:!0}),"x");const nm=class{static{u(this,"w")}constructor(e){this.workspace=e,this.lastState={components:[],connections:[]},this.state=[],this.redoStack=[],this.enabled=!0,this.queue=[],this.processingQueue=!1,this._saving=!1,e.addEventListener("AgentLoaded",async t=>{this.lastState=this.processState(t.data),this.state=[]}),e.addEventListener("DataExported",t=>{this.enabled&&(this.queue.push(t),this.processQueue())})}reset(e){e&&(this.lastState=this.processState(e)),this.state=[]}async processQueue(){if(!this.processingQueue){for(this.processingQueue=!0;this.queue.length>0;){if(this.locked){await $e(30);continue}const e=this.queue.shift();this.saveState(e)}this.processingQueue=!1}}diffState(e){const t={add:{components:[],connections:[]},remove:{components:[],connections:[]},update:{components:[],connections:[]}},s=this.lastState.components.map(v=>v.id),a=e.components.map(v=>v.id),o=e.components.filter(v=>!s.includes(v.id));t.add.components=o;const r=this.lastState.components.filter(v=>!a.includes(v.id));t.remove.components=r;const i=this.lastState.connections.map(v=>`${v.sourceId}:${v.sourceIndex},${v.targetId}:${v.targetIndex}`),d=e.connections.map(v=>`${v.sourceId}:${v.sourceIndex},${v.targetId}:${v.targetIndex}`),c=e.connections.filter(v=>!i.includes(v.id));t.add.connections=c;const l=this.lastState.connections.filter(v=>!d.includes(v.id));t.remove.connections=l;const m=e.components.filter(v=>{const x=this.lastState.components.find(C=>C.id===v.id);return x&&JSON.stringify(v)!==JSON.stringify(x)}).map(v=>v.id);t.remove.components.push(...this.lastState.components.filter(v=>m.includes(v.id))),t.add.components.push(...e.components.filter(v=>m.includes(v.id))),t.update.components=m,!(t.add.components.length===0&&t.remove.components.length===0&&t.add.connections.length===0&&t.remove.connections.length===0)&&(this.redoStack=[],this.state.push(t))}processState(e){const t=JSON.parse(JSON.stringify(e));return t.connections=t.connections.map(s=>({...s,id:`${s.sourceId}:${s.sourceIndex},${s.targetId}:${s.targetIndex}`})),t}saveState(e){if(e){this.lock();try{let t=this.processState(e);this.diffState(t),this.lastState=t}catch(t){console.warn("Error during saveState",t)}setTimeout(this.unlock.bind(this),100)}}get locked(){return this._saving}lock(){this._saving=!0,this.workspace._loading=!0}unlock(){this._saving=!1,this.workspace._loading=!1}async undo(){if(this.locked)return;const e=this.state.pop();if(e){this.redoStack.push(e),this.lock();try{for(let i of e.add?.connections||[]){const d=document.getElementById(i.sourceId),c=document.getElementById(i.targetId);if(!d||!c)continue;const l=d.querySelectorAll(".output-container .endpoint")[i.sourceIndex],m=c.querySelectorAll(".input-container .endpoint")[i.targetIndex];if(!l||!m)continue;const v=this.workspace.jsPlumbInstance.getConnections({source:l,target:m});this.workspace.jsPlumbInstance.deleteConnection(v[0],{force:!0})}await $e(50);let t=[],s=[];for(let i of e.add?.components||[]){const d=document.getElementById(i.id),c=d._control,l=[...d.querySelectorAll(".input-container .endpoint")].map(C=>C.id),m=[...d.querySelectorAll(".output-container .endpoint")].map(C=>C.id),v=this.workspace.jsPlumbInstance.getConnections({target:l}).map(C=>{const w=C.source.id,f=C.target.id,T=document.getElementById(w).closest(".component").id,k=document.getElementById(f).closest(".component").id,F=[...document.getElementById(w).parentElement.querySelectorAll(".endpoint")].map(_=>_.id).indexOf(w),O=[...document.getElementById(f).parentElement.querySelectorAll(".endpoint")].map(_=>_.id).indexOf(f);return{sourceId:T,targetId:k,sourceIndex:F,targetIndex:O}}),x=this.workspace.jsPlumbInstance.getConnections({source:m}).map(C=>{const w=C.source.id,f=C.target.id,T=document.getElementById(w).closest(".component").id,k=document.getElementById(f).closest(".component").id,F=[...document.getElementById(w).parentElement.querySelectorAll(".endpoint")].map(_=>_.id).indexOf(w),O=[...document.getElementById(f).parentElement.querySelectorAll(".endpoint")].map(_=>_.id).indexOf(f);return{sourceId:T,targetId:k,sourceIndex:F,targetIndex:O}});t.push(...v,...x),c.delete(),s.push("#"+i.id)}let a=30;for(;s.length>0&&document.querySelectorAll(s.join(",")).length>0&&a>0;)await $e(33),a--;const o={};for(let i of e.remove?.components||[]){o[i.id]=!0;const d=this.workspace.addComponent(i.name,{outputs:i.outputs.map(c=>c.name),inputs:i.inputs.map(c=>c.name),outputProps:i.outputs,inputProps:i.inputs,data:i.data,top:i.top,left:i.left,width:i.width,title:i.title||"",aiTitle:i.aiTitle||"",description:i.description||"",uid:i.id,template:i.template},!1)}for(a=30;Object.keys(o).length>0&&a>0;){const i=Object.keys(o);for(let d of i)document.getElementById(d)&&delete o[d];await $e(33),a--}await $e(300);let r=[];if(r.push(...t,...e.remove?.connections),r=r.filter((i,d,c)=>d===c.findIndex(l=>l.sourceId===i.sourceId&&l.targetId===i.targetId)),r.length>0)for(let i of r){const d=document.getElementById(i.sourceId),c=document.getElementById(i.targetId);if(!d||!c)continue;const l=d.querySelectorAll(".output-container .endpoint")?.[i.sourceIndex],m=c.querySelectorAll(".input-container .endpoint")?.[i.targetIndex];if(!l||!m||!l?.endpoint||!m?.endpoint)continue;const v=this.workspace.jsPlumbInstance.connect({source:l.endpoint,target:m.endpoint,detachable:!0,cssClass:"exclude-panzoom"});this.workspace.updateConnectionStyle(v),await $e(5)}await $e(100),this.lastState=this.processState(await this.workspace.export(!1))}catch(t){console.error("Error during undo",t)}return this.unlock(),this.workspace.saveAgent(void 0,void 0,void 0,void 0,!1),e}}async redo(){if(this.locked)return;const e=this.redoStack.pop();if(e){this.state.push(e),this.lock();try{for(let o of e.remove?.connections||[]){const r=document.getElementById(o.sourceId),i=document.getElementById(o.targetId);if(!r||!i)continue;const d=r.querySelectorAll(".output-container .endpoint")[o.sourceIndex],c=i.querySelectorAll(".input-container .endpoint")[o.targetIndex];if(!d||!c)continue;const l=this.workspace.jsPlumbInstance.getConnections({source:d,target:c});this.workspace.jsPlumbInstance.deleteConnection(l[0],{force:!0})}await $e(50);let t=[],s=[];for(let o of e.remove?.components||[]){const r=document.getElementById(o.id),i=r._control,d=[...r.querySelectorAll(".input-container .endpoint")].map(v=>v.id),c=[...r.querySelectorAll(".output-container .endpoint")].map(v=>v.id),l=this.workspace.jsPlumbInstance.getConnections({target:d}).map(v=>{const x=v.source.id,C=v.target.id,w=document.getElementById(x).closest(".component").id,f=document.getElementById(C).closest(".component").id,T=[...document.getElementById(x).parentElement.querySelectorAll(".endpoint")].map(F=>F.id).indexOf(x),k=[...document.getElementById(C).parentElement.querySelectorAll(".endpoint")].map(F=>F.id).indexOf(C);return{sourceId:w,targetId:f,sourceIndex:T,targetIndex:k}}),m=this.workspace.jsPlumbInstance.getConnections({source:c}).map(v=>{const x=v.source.id,C=v.target.id,w=document.getElementById(x).closest(".component").id,f=document.getElementById(C).closest(".component").id,T=[...document.getElementById(x).parentElement.querySelectorAll(".endpoint")].map(F=>F.id).indexOf(x),k=[...document.getElementById(C).parentElement.querySelectorAll(".endpoint")].map(F=>F.id).indexOf(C);return{sourceId:w,targetId:f,sourceIndex:T,targetIndex:k}});t.push(...l,...m),i.delete(),s.push("#"+o.id)}let a=10;for(;s.length>0&&document.querySelectorAll(s.join(",")).length>0&&a>0;)await $e(100),a--;for(let o of e.add?.components||[]){const r=await this.workspace.addComponent(o.name,{outputs:o.outputs.map(i=>i.name),inputs:o.inputs.map(i=>i.name),outputProps:o.outputs,inputProps:o.inputs,data:o.data,top:o.top,left:o.left,width:o.width,title:o.title||"",aiTitle:o.aiTitle||"",description:o.description||"",uid:o.id,template:o.template},!1)}if(await $e(300),t.length>0)for(let o of t){const r=document.getElementById(o.sourceId),i=document.getElementById(o.targetId);if(!r||!i)continue;const d=r.querySelectorAll(".output-container .endpoint")?.[o.sourceIndex],c=i.querySelectorAll(".input-container .endpoint")?.[o.targetIndex],l=this.workspace.jsPlumbInstance.connect({source:d.endpoint,target:c.endpoint,detachable:!0,cssClass:"exclude-panzoom"});this.workspace.updateConnectionStyle(l)}for(let o of e.add?.connections||[]){const r=document.getElementById(o.sourceId),i=document.getElementById(o.targetId);if(!r||!i)continue;const d=r.querySelectorAll(".output-container .endpoint")?.[o.sourceIndex],c=i.querySelectorAll(".input-container .endpoint")?.[o.targetIndex];if(!d||!c||!d?.endpoint||!c?.endpoint)continue;const l=this.workspace.jsPlumbInstance.connect({source:d.endpoint,target:c.endpoint,detachable:!0,cssClass:"exclude-panzoom"});this.workspace.updateConnectionStyle(l)}await $e(100),this.lastState=this.processState(await this.workspace.export(!1))}catch(t){console.error("Error during redo",t)}return this.unlock(),this.workspace.saveAgent(void 0,void 0,void 0,void 0,!1),e}}initState(){}};xk(nm,"StateManager");let wk=nm;var sm={exports:{}};(function(n,e){(function(t,s){s()})(mt,function(){function t(c,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}u(t,"b");function s(c,l,m){var v=new XMLHttpRequest;v.open("GET",c),v.responseType="blob",v.onload=function(){d(v.response,l,m)},v.onerror=function(){console.error("could not download file")},v.send()}u(s,"c");function a(c){var l=new XMLHttpRequest;l.open("HEAD",c,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}u(a,"d");function o(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(l)}}u(o,"e");var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof mt=="object"&&mt.global===mt?mt:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(c,l,m){var v=r.URL||r.webkitURL,x=document.createElement("a");l=l||c.name||"download",x.download=l,x.rel="noopener",typeof c=="string"?(x.href=c,x.origin===location.origin?o(x):a(x.href)?s(c,l,m):o(x,x.target="_blank")):(x.href=v.createObjectURL(c),setTimeout(function(){v.revokeObjectURL(x.href)},4e4),setTimeout(function(){o(x)},0))}:"msSaveOrOpenBlob"in navigator?function(c,l,m){if(l=l||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(t(c,m),l);else if(a(c))s(c,l,m);else{var v=document.createElement("a");v.href=c,v.target="_blank",setTimeout(function(){o(v)})}}:function(c,l,m,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof c=="string")return s(c,l,m);var x=c.type==="application/octet-stream",C=/constructor/i.test(r.HTMLElement)||r.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||x&&C||i)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var F=f.result;F=w?F:F.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=F:location=F,v=null},f.readAsDataURL(c)}else{var T=r.URL||r.webkitURL,k=T.createObjectURL(c);v?v.location=k:location.href=k,v=null,setTimeout(function(){T.revokeObjectURL(k)},4e4)}});r.saveAs=d.saveAs=d,n.exports=d})})(sm);var Sk=sm.exports,Ck=Object.defineProperty,yl=u((n,e)=>Ck(n,"name",{value:e,configurable:!0}),"l$1");function am(){const n=document.getElementById("agent-template-id-input"),e=document.getElementById("agent-template-name-input"),t=document.getElementById("agent-template-description-input"),s=document.getElementById("agent-template-icon-input"),a=document.getElementById("agent-template-category-input"),o=document.getElementById("agent-template-publish-input"),r=document.getElementById("agent-template-color-input"),i=document.getElementById("agent-template-image-url-input"),d=document.getElementById("agent-template-doc-link-input"),c=document.getElementById("agent-template-video-link-input"),l=document.getElementById("agent-template-value-proposition-input"),m=e?.value||this.agent.name||"Untitled";return{id:n?.value||gv(m),name:m,description:t?.value||this.agent?.shortDescription||this.agent?.description||"",icon:s?.value||"",category:a?.value||"",publish:o?.checked||!1,color:r?.value||"#000000",imageUrl:i?.value||"",docLink:d?.value||"",videoLink:c?.value||"",valueProposition:l?.value||""}}u(am,"getTemplateInfo"),yl(am,"getTemplateInfo");async function im(){if(this.locked||!this.agent.id)return!1;console.log("Template saving...");try{const n=await this.export();if(delete n.debugSessionEnabled,!n?.templateInfo){const t=this.getTemplateInfo();n.templateInfo=t}const e=n?.templateInfo?.id;return await fetch("/api/page/builder/agent-templates",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),await this.saveAgent(this.agent?.name,this.agent?.domain,n),e}catch(n){throw n}}u(im,"saveTemplate"),yl(im,"saveTemplate");async function om(){if(this.locked||!this.agent.id)return!1;console.log("Template exporting...");try{const n=await this.export(),e=this.getTemplateInfo(),t={...n,templateInfo:e};try{const o=document.querySelector('textarea[name="introMessage"]')??`Hi, I'm ${this.agent.name||"an AI Agent"}. How can I help you today?`;o&&!t?.introMessage&&(o instanceof HTMLTextAreaElement?t.introMessage=o.value:t.introMessage=o)}catch(o){console.error("Error trying to access introMessage textarea:",o)}delete t.debugSessionEnabled;const s=new Blob([JSON.stringify(t)],{type:"text/plain;charset=utf-8"}),a=t?.templateInfo?.id;return Sk.saveAs(s,`${a}.smyth`),a}catch(n){throw console.error("Error exporting template:",n),n}}u(om,"exportTemplate"),yl(om,"exportTemplate");var Ak=Object.defineProperty,xl=u((n,e)=>Ak(n,"name",{value:e,configurable:!0}),"A");$h();function wl(n){if(n.search("rgb")==-1)return n;n=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(,\s?\d+\.\d+)?\);?$/);function e(t){return("0"+parseInt(t).toString(16)).slice(-2)}return u(e,"C"),xl(e,"hex"),"#"+e(n[1])+e(n[2])+e(n[3])}u(wl,"q"),xl(wl,"rgb2hex");const Tt={conStartColor:"#3C89F9",conEndColor:"#F35063"},Ek=class Ja extends pa{static{u(this,"b")}constructor(e,t){super(),this.container=e,this.server=t,this.clipboard=new ek(this),this.stateManager=new wk(this),this.collapsed=!1,this._locked=!1,this.jsPlumbInstance=nu.jsPlumb.getInstance(),this._loading=!1,this._saving=!1,this.scale=1,this.serverData={debugUrl:"",docUrl:""},this.userData={},this.teamData={},this.hoveredElement=null,this.mouseCoords={x:0,y:0},this._draggingConnection=null,this.pendingAddComponent=null,this.deployments={},this.domainData={},this.componentTemplates={},this.ACL={},this.agent=new fv(this.server),this.registerAgentEvents(),this.domElement=document.getElementById("workspace"),this.domElement||(this.domElement=document.createElement("div"),this.domElement.id="workspace",e&&e.appendChild(this.domElement)),window.addEventListener("queryClientInvalidate",s=>{s.detail.queryKey.includes("latest_deployment")&&this.getDeploymentInfo().then(a=>{this.emit("deploymentsUpdated",a)})}),this.jsPlumbInstance.setContainer(this.domElement),this.jsPlumbInstance.importDefaults({Connector:["Bezier",{curviness:200}],PaintStyle:{strokeWidth:2,stroke:`${Tt.conStartColor}bb`,gradient:{stops:[[0,`${Tt.conStartColor}bb`],[1,`${Tt.conEndColor}bb`]]}},Endpoint:["Dot",{radius:1}],EndpointStyle:{fill:"transparent"},Anchors:["Right","Left"],Overlays:[["Arrow",{width:10,length:10,location:.9,PaintStyle:{fill:"#ffffff55"}}]]}),this.jsPlumbInstance.bind("beforeDrop",s=>(console.log("beforeDrop: ",s),!(this.collapsed||this.locked||this.jsPlumbInstance.getConnections({source:s.sourceId,target:s.targetId}).length>0))),this.jsPlumbInstance.bind("connection",async s=>{Ta.isCardConn(s)&&Ta.setConnPaintStyles(s.connection),this.updateConnectionColors(s.connection),this.updateConnectionStyle(s.connection),s.connection.bind("click",async r=>{if(!this.collapsed){if(this.locked)return!1;await En("","Are you sure you want to delete this connection?",{btnNoLabel:"No, Cancel",btnYesLabel:"Yes, I'm sure",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})&&this.jsPlumbInstance.deleteConnection(r)}}),await this.checkConnectionsConsistency(s.connection)&&this.jsPlumbInstance.deleteConnection(s.connection),Ta.checkConnValidity(s)||this.jsPlumbInstance.deleteConnection(s.connection);//! SHOULDN'T WE ABORT EARLY IF THERE WAS A CONFLICT!!?? I feel like it aborts and works correctly
//! but cannot detect how and where does it abort if a conflict or non-valid conn was detected
const a=s.source.closest(".component")?._control,o=s.target.closest(".component")?._control;a?.emit("connectionAttached",s.source.getAttribute("smt-name"),s.source,s),o?.emit("connectionAttached",s.target.getAttribute("smt-name"),s.target,s),setTimeout(()=>{this.saveAgent()},300)}),this.jsPlumbInstance.bind("connectionDrag",s=>{this._draggingConnection=s,s._originalPaintStyle=s.getPaintStyle(),s.setPaintStyle({stroke:Tt.conStartColor,strokeWidth:4}),s.endpoints.forEach(a=>{a._domElement&&a._domElement.classList.add("active")})}),this.jsPlumbInstance.bind("connectionDragStop",s=>{this._draggingConnection=null,s._originalPaintStyle&&(s.setPaintStyle(s._originalPaintStyle),delete s._originalPaintStyle),s.endpoints.forEach(a=>{a._domElement&&a._domElement.classList.remove("active")}),this.updateConnectionColors(s),this.setComponentsTags()}),this.jsPlumbInstance.bind("beforeDetach",s=>{if(this.collapsed||this.locked)return!1;s._originalPaintStyle&&(s.setPaintStyle(s._originalPaintStyle),delete s._originalPaintStyle),s.endpoints.forEach(a=>{a._domElement&&a._domElement.classList.remove("active")})}),this.jsPlumbInstance.bind("connectionDetached",s=>{const a=s.source.closest(".component")?._control,o=s.target.closest(".component")?._control;a&&a.emit("connectionDetached",s.source.getAttribute("smt-name"),s.source,s),o&&o.emit("connectionDetached",s.target.getAttribute("smt-name"),s.target,s),setTimeout(async()=>{await this.checkConnectionsConsistency(),this.saveAgent()},300)}),this.initEvents(),Qh(this),em(this),qh(this),dd(this),Rh(),this.initMonitor(),Dh(this.monitor)}get locked(){return this._locked||this._loading}set locked(e){this._locked=e}get RSidebarComponent(){return Ue.curComponentSettings}async getDeploymentInfo(){const e=`${this.server}/api/page/builder/ai-agent/${this.agent.id}/deployments`,t=await fetch(e).then(a=>a.json());this.deployments=t?.deployments;const s=await fetch("/api/page/builder/domains",{method:"GET",headers:{"Content-Type":"application/json"}});return this.domainData=await s.json(),t}updateConnectionStyle(e){const t=e.source,s=e.target;if(!t||!s)return;const a=t.closest(".component"),o=s.closest(".component");if(!a||!o)return;const r=t.getBoundingClientRect(),i=s.getBoundingClientRect(),d=a.getBoundingClientRect(),c=o.getBoundingClientRect();if(r.right>i.left){const l=d.left-c.left>100&&d.top-c.bottom>100?80:30;e.setConnector(["SmythFlowchart",{stub:15,gap:4,cornerRadius:l,alwaysRespectStubs:!0}]),e.removeOverlay("Custom"),e?.__smt_overlay?e.addOverlay(["Custom",{create:function(m){const v=document.createElement("div");return v.innerHTML=e?.__smt_overlay,v},location:.3,id:"Custom"}]):e.addOverlay(["Arrow",{width:10,length:10,location:l==30?.8:.9,PaintStyle:{fill:"#ffffff55"}}])}else{const l=i.left-r.right;l<200?e.setConnector(["SmythBezier",{curviness:160}]):e.setConnector(["SmythFlowchart",{stub:15,gap:4,cornerRadius:30,alwaysRespectStubs:!0}]),e.removeOverlay("Custom"),e?.__smt_overlay?e.addOverlay(["Custom",{create:function(m){const v=document.createElement("div");return v.innerHTML=e?.__smt_overlay,v},location:.3,id:"Custom"}]):e.addOverlay(["Arrow",{width:10,length:10,location:l>=200?.9:.8,PaintStyle:{fill:"#ffffff55"}}])}}updateConnectionColors(e){if(!e?.endpoints?.[0]?._domElement?.querySelector(".ep"))return;const t=e?.__smt_color||e?.__smt_startColor||wl(e?.endpoints?.[0]?._domElement?.querySelector(".ep")?.style.backgroundColor)||`${Tt.conStartColor}`,s=e?.__smt_color||e?.__smt_endColor||wl(e?.endpoints?.[1]?._domElement?.querySelector(".ep")?.style.backgroundColor)||`${Tt.conEndColor}`,a=e?.__smt_thickness||parseInt(e?.endpoints?.[0]?._domElement?.querySelector(".ep")?.getAttribute("smt-con-thickness")||2),o=e?.endpoints?.[0]?._domElement?.querySelector(".ep")?.getAttribute("smt-con-hide-overlays")==="true",r=e?.__smt_dashstyle||void 0;e.setHoverPaintStyle({stroke:`${Tt.conStartColor}`,strokeWidth:a+1,gradient:{stops:[[0,t],[1,s]]}}),e.setPaintStyle({strokeWidth:a,stroke:t+"cc",...r?{dashstyle:r}:{},gradient:{stops:[[0,t+"cc"],[1,s+"cc"]]}}),o&&e.hideOverlays(),e.removeOverlay("Custom"),e?.__smt_overlay&&e.addOverlay(["Custom",{create:function(i){const d=document.createElement("div");return d.innerHTML=e?.__smt_overlay,d},location:.3,id:"Custom"}]),setTimeout(this.saveAgent.bind(this),300)}static getInstance(e={container:HTMLElement,server:String}){return Ja.instance||(Ja.instance=new Ja(e.container,e.server)),Ja.instance}async loadAgent(e,t){if(await this.agent.load(e,{lockAfterFetch:t?.lockAfterFetch||!1})&&this.import(this.agent.data).then(()=>{this.emit("agentUpdated",this.agent),this.setAgentInfo(this.agent.id,this.agent.name,this.agent.domain,this.agent.data),this.emit("AgentReady",this.agent)}),this.agent.data?.ui?.panzoom){const s=document.getElementById("zoom"),a=s.style.transition;s.style.transition="none";const o=this.agent.data.ui.panzoom;this.domElement.style.opacity="0",await $e(300),o?.currentPan&&this.panzoom?.pan(o?.currentPan.x,o?.currentPan.y),o?.currentZoom&&this.panzoom?.zoom(o?.currentZoom),this.scale=o?.currentZoom,this.jsPlumbInstance.setZoom(o?.currentZoom),await $e(100),this.domElement.style.opacity="1",s.style.transition=a}this.emit("AgentLoaded",this.agent),this.getDeploymentInfo(),this.populateSharedState()}populateSharedState(){let e=this.agent.domain;const t=`${this.agent.id}.${this.serverData.prod_agent_domain}`;if(!e&&this.deployments?.length>0){const a=this.domainData?.filter(o=>o.aiAgent.id===this.agent.id);a.length>0?e=a[0].name:e=t}const s=this.serverData?.agent_domain?.includes(":")?"http":"https";Nt.setState({agentDomains:{dev:`${this.agent.id}.${this.serverData.agent_domain}`,prod:e||null,defaultProd:t,scheme:s}}),console.log("Populated shared state")}async loadUserSubscription(){try{const e=await(await fetch("/api/page/user/me/subscription")).json();this.userData.subscription=e?.teamsSubs}catch(e){console.error("Failed to load user subscription:",e),this.userData.subscription=null}}async saveAgent(e,t,s,a,o=!0){if(await $e(400),!this._loading){if(this._saving){o&&await this.export(o);return}this._saving=!0,this.setComponentsTags(),e||(e=this.agent?.name),a||(a=this.agent?.id),s||(s=await this.export(o)),t||(t=this.agent?.domain),o&&this.emit("AgentSaving",this.agent,s),this.updateAgentSaveStatus("","progress");try{const r=await this.agent.save(e,t,s,a);return r&&this.setAgentInfo(r.id,r.name,r.domain,r.data),await this.setComponentsTags(),this._saving=!1,o&&this.emit("AgentSaved",this.agent,s),this.updateAgentSaveStatus("","success"),e&&(document.title=e+" | SmythOS"),r}catch(r){this._saving=!1,console.error("Error",r),typeof r?.error=="string"&&(r.error.includes("403")?Je("You are not authorized to save or create agent"):Je(r.error)),this.updateAgentSaveStatus("Error","alert")}}}async createAgent(e,t="",s){const a={description:t,components:[],connections:[]};return this.agent.resetData(),typeof s=="function"&&s(a),this.saveAgent(e,"",a)}setAgentInfo(e,t,s,a){this.agent.setData({id:e,name:t,domain:s,data:a});const o=document.getElementById("agent-name-input"),r=document.getElementById("agent-id-input"),i=document.getElementById("agent-behavior-input");r&&(r.value=e),o&&(o.value=t),i&&(i.value=a.behavior||a.description),Pl(t),Il(t),this.emit("agentUpdated",this.agent)}updateAgentSaveStatus(e,t){const s=document.getElementById("agent-top-bar-status"),a=document.getElementById("agent-save-status");s&&(s.classList.remove("st-success","st-alert","st-info","st-progress"),t&&s.classList.add("st-"+t)),!(!a||!a.textContent)&&(a.textContent=e,a.classList.remove("st-success","st-alert","st-info","st-progress"),t&&a.classList.add("st-"+t))}async deleteAgent(e){try{const t=await this.agent.delete(e);return console.log("Agent Delete result",t),t.error||!t?.success?!1:(this.domElement.innerHTML="",!0)}catch(t){return Je(t.message??"Deleting Failed"),!1}}redraw(){this.jsPlumbInstance.repaintEverything()}toggleJsPlumbInteractions(e){var t=document.querySelectorAll(".jsplumb-draggable");t.forEach(function(s){var a=this.jsPlumbInstance.getEndpoints(s);a&&a.forEach(function(o){o.setDraggable(e)}),this.jsPlumbInstance.setDraggable(s,e)})}areComponentsCollapsed(){return this.collapsed}collapseComponents(){this.domElement.classList.add("collapsed"),this.redraw(),this.collapsed=!0,this.toggleJsPlumbInteractions(!1)}expandComponents(){this.domElement.classList.remove("collapsed"),this.redraw(),this.collapsed=!1,this.toggleJsPlumbInteractions(!0)}async copyComponent(e){const t=document.getElementById(e),s=t._control;if(!t||!s)return null;const a=s.constructor.name,o=JSON.parse(JSON.stringify(s.properties));delete o.uid,delete o.sender,o.top=parseInt(o.top)+100+"px",o.left=parseInt(o.left)+40+"px";const r=await this.addComponent(a,o,!1);return r.style.zIndex="999",r.classList.add("selected"),r}async zoomTo(e){const t=this.panzoom.zoom(e,{animate:!0,duration:150,easing:"ease-out"});this.scale=t.scale,this.jsPlumbInstance.setZoom(t.scale)}initEvents(){this.initServerData();const e=this.jsPlumbInstance;e.ready(()=>{setTimeout(()=>{document.querySelectorAll(".ribbon-menu button").forEach(i=>i.setAttribute("disabled","disabled"))},100);const t=this.container,s=this.domElement,a=document.getElementById("zoom");let o=1;s.addEventListener("click",async i=>{const d=s.getBoundingClientRect(),c=Math.round((i.clientX-d.x)/o),l=Math.round((i.clientY-d.y)/o);if(this.pendingAddComponent){const m=this.pendingAddComponent.name,v=this.pendingAddComponent.properties,x=this.pendingAddComponent.triggerSettings;v.top||(v.top=l-20+"px"),v.left||(v.left=c-85+"px"),v.sender&&v.sender.classList.remove("active");const C=Xi[m]||Xi.Component,w=new C(this,{...v},x);await w.ready(),v.data&&(w.data=v.data);const f=w.domElement;this.pendingAddComponent.resolve(f),this.pendingAddComponent=null}}),this.panzoom=tu(a,{canvas:!1,animate:!0,noBind:!0,excludeClass:"exclude-panzoom",cursor:"default",smoothScroll:!0,duration:300,easing:"ease-out",handleStartEvent(i){}});const r=a.parentElement;t.addEventListener("pointerdown",i=>{this.panzoom.handleDown(i)}),document.addEventListener("pointermove",i=>{i.ctrlKey||i.metaKey||this.panzoom.handleMove(i)}),document.addEventListener("pointerup",this.panzoom.handleUp),r.addEventListener("wheel",i=>{if(!i.ctrlKey&&!i.metaKey){if(this.hoveredElement.tagName=="TEXTAREA"||this.hoveredElement.tagName=="INPUT"||this.hoveredElement.classList.contains("dbg")||this.hoveredElement.closest(".dbg"))return;if(i.shiftKey){const x=this.panzoom.getPan();this.panzoom.pan(x.x-i.deltaY*.7/this.scale,x.y);return}const v=this.panzoom.getPan();this.panzoom.pan(v.x,v.y-i.deltaY*.7/this.scale);return}i.preventDefault();const d=this.panzoom.getScale(),c=Math.abs(i.deltaY)<50?.04:.1;let l=d;if(i.deltaY>0?l=Math.max(d-c*d,this.panzoom.getOptions().minScale):l=Math.min(d+c*d,this.panzoom.getOptions().maxScale),Math.abs(l-d)<.001)return;const m=this.panzoom.zoomToPoint(l,i,{animate:!0,duration:150,easing:"ease-out"});this.scale=m.scale,e.setZoom(m.scale)}),this.handleSelection(),this.preloadComponentsTemplates(),document.addEventListener("wheel",i=>{(i.ctrlKey||i.metaKey)&&i.preventDefault()},{passive:!1})}),document.addEventListener("mouseover",t=>{this.hoveredElement=t.target}),document.addEventListener("mousemove",t=>{const s=this.domElement.getBoundingClientRect(),a=Math.round((t.clientX-s.x)/this.scale),o=Math.round((t.clientY-s.y)/this.scale);this.mouseCoords.x=a,this.mouseCoords.y=o})}handleSelection(){let e=!1,t={x:0,y:0},s=null;document.getElementById("workspace-container").addEventListener("mousedown",a=>{document.querySelectorAll("#workspace-container .component").forEach(o=>o.classList.remove("selected","unselected")),Da()}),document.addEventListener("mousedown",a=>{const o=a.target;(a.ctrlKey||a.metaKey)&&!o.classList.contains("component")&&(e=!0,t={x:a.clientX,y:a.clientY},s=document.createElement("div"),s.classList.add("selection-rectangle"),s.style.left=`${a.clientX}px`,s.style.top=`${a.clientY}px`,document.body.appendChild(s),s.style.border="1px dashed black",s.style.background="#00000010",s.style.position="fixed",s.style.pointerEvents="none")}),document.addEventListener("mousemove",a=>{if(e){const o=a.clientX-t.x,r=a.clientY-t.y;s.style.width=`${Math.abs(o)}px`,s.style.height=`${Math.abs(r)}px`,s.style.left=`${o>0?t.x:a.clientX}px`,s.style.top=`${r>0?t.y:a.clientY}px`}}),document.addEventListener("mouseup",()=>{if(e){const a=document.querySelector(".component.active");a&&a?.classList?.remove("active"),e=!1;const o=s.getBoundingClientRect();document.body.removeChild(s),s=null,Array.from(document.querySelectorAll(".component")).forEach(r=>{const i=r.getBoundingClientRect();i.top>=o.top&&i.bottom<=o.bottom&&i.left>=o.left&&i.right<=o.right?(r.classList.add("selected"),r.classList.remove("unselected")):(r.classList.remove("selected"),r.classList.add("unselected"))})}})}async preloadComponentsTemplates(){((await fetch("/api/page/builder/app-config/components").then(e=>e.json()))?.components||[]).forEach(e=>{try{this.componentTemplates[e.id]=JSON.parse(e.data)}catch{}})}async initServerData(){const e=await fetch("/api/status").then(t=>t.json());this.serverData.baseUrl=e.status.url,this.serverData.frontUrl=e.status.frontUrl,this.serverData.debugUrl=e.status.url+"/api",this.serverData.docUrl=Ft,this.serverData.dbgUrl=e.status.dbg_url,this.serverData.agent_domain=e.status.agent_domain,this.serverData.env=e.status.env,this.serverData.status=e.status.server,this.serverData.prod_agent_domain=e.status.prod_agent_domain,this.userData={...e.status.user},this.teamData={...e.status.team},this.emit("ServerDataLoaded")}waitServerData(){return new Promise(e=>{if(this.serverData.baseUrl)e(this.serverData);else{const t=setInterval(()=>{this.serverData.baseUrl&&(clearInterval(t),e(this.serverData))},100)}})}addComponent(e,t={outputs:void 0,inputs:void 0,data:{},top:"",left:"",sender:null},s){return new Promise(async(a,o)=>{if(t?.data?.headers&&(t.data.headers=fa(t.data.headers)),t?.data?.body&&(t.data.body=fa(t.data.body)),t?.data?.metadata&&(t.data.metadata=fa(t.data.metadata)),t?.data){for(const c in t.data)if(c.startsWith("KVJSON")){const l=t.data[c];t.data[c]=fa(l)}}if(t?.data?._templateVars){for(const c in t.data._templateVars)if(c.startsWith("KVJSON")){const l=t.data._templateVars[c];t.data._templateVars[c]=fa(l)}}if(t.uid){const c=document.getElementById(t.uid);if(c)return console.warn("Tried to create the same component twice ==> returning existing component"),a(c)}if(t.sender){if(t.sender.classList.contains("active"))return t.sender.classList.remove("active"),t.sender.parentElement.classList.remove("active"),this.pendingAddComponent=null,a(null);document.querySelectorAll("#left-menu [smt-component]").forEach(c=>{c.classList.remove("active"),c.parentElement.classList.remove("active")}),this.pendingAddComponent={name:e,properties:t,triggerSettings:s,resolve:a,reject:o}}const r=Xi[e]||Xi.Component,i=new r(this,{...t},s);await i.ready(),this.emit("componentAdded",i),t.data&&(i.data=t.data);const d=i.domElement;this.pendingAddComponent=null,a(d)})}addConnection(e,t,s,a){const o=typeof e=="string"?document.getElementById(e):e,r=typeof t=="string"?document.getElementById(t):t;let i,d;if(typeof s=="string"?(i=o.querySelector(`.output-endpoint[smt-name='${s}']`),i||(i=o.querySelector(`.output-endpoint[smt-expression='${s}']`))):i=[...o.querySelectorAll(".output-endpoint")][s],typeof a=="string"?(d=r.querySelector(`.input-endpoint[smt-name='${a}']`),d||(d=r.querySelector(`.input-endpoint[smt-expression='${a}']`))):d=[...r.querySelectorAll(".input-endpoint")][a],this.jsPlumbInstance.getConnections({source:i,target:d}).length>0){console.warn("Connection already exists, Skip AddConnection  ...");return}const c=this.jsPlumbInstance.connect({source:i.endpoint,target:d.endpoint,detachable:!0,cssClass:"exclude-panzoom"});return this.updateConnectionStyle(c),setTimeout(()=>{this.jsPlumbInstance.repaint(o),this.jsPlumbInstance.repaint(r)},300),c}deleteConnection(e,t,s,a){const o=typeof e=="string"?document.getElementById(e):e,r=typeof t=="string"?document.getElementById(t):t;let i,d;typeof s=="string"?i=o.querySelector(`.output-endpoint[smt-name='${s}']`):i=[...o.querySelectorAll(".output-endpoint")][s],typeof a=="string"?d=r.querySelector(`.input-endpoint[smt-name='${a}']`):d=[...r.querySelectorAll(".input-endpoint")][a];const c=this.jsPlumbInstance.getConnections({source:i,target:d});c.length>0&&this.jsPlumbInstance.deleteConnection(c[0])}extractComponentInputProps(e,t){const s=e._control,a={};for(let o in s.inputSettings){let r=t.getAttribute(`smt-${o}`);r==="true"&&(r=!0),r==="false"&&(r=!1),r&&(a[o]=r)}return a}extractComponentOutputProps(e,t){const s=e._control,a={};for(let o in s.outputSettings){let r=t.getAttribute(`smt-${o}`);r==="true"&&(r=!0),r==="false"&&(r=!1),r&&(a[o]=r)}return a}async export(e=!0){const t=[...this.domElement.querySelectorAll(".component")].map(v=>{const x=v._control;return{id:v.id,name:v.querySelector(".title-bar").getAttribute("smt-name"),outputs:[...v.querySelectorAll(".output-endpoint")].map((C,w)=>({name:C.getAttribute("smt-name"),color:C.getAttribute("smt-color"),...this.extractComponentOutputProps(v,C),index:w,uuid:C.endpoint?.getUuid(),default:x.properties.defaultOutputs.includes(C.getAttribute("smt-name"))})),inputs:[...v.querySelectorAll(".input-endpoint")].map((C,w)=>({name:C.getAttribute("smt-name"),type:C.getAttribute("smt-type"),friendlyInputType:C.getAttribute("smt-friendly-input-type"),coreInputType:C.getAttribute("smt-core-input-type"),color:C.getAttribute("smt-color"),optional:C.getAttribute("smt-optional")==="true",...this.extractComponentInputProps(v,C),index:w,uuid:C.endpoint?.getUuid(),default:x.properties.defaultInputs.includes(C.getAttribute("smt-name"))})),data:x.data,top:v.style.top,left:v.style.left,width:v.style.width,height:v.style.height,displayName:x.drawSettings.displayName,title:x.title,aiTitle:x.aiTitle,description:x.description,template:x.properties.template}}),s=this.jsPlumbInstance.getAllConnections().map(v=>{const x=v.source,C=v.target,w=x.closest(".component"),f=C.closest(".component");return!w||!f?null:{sourceId:x.closest(".component").id,sourceIndex:[...x.parentElement.querySelectorAll(".output-endpoint")].findIndex(T=>T===x),targetId:C.closest(".component").id,targetIndex:[...C.parentElement.querySelectorAll(".input-endpoint")].findIndex(T=>T===C)}}).filter(v=>v),a=this.domElement.classList.contains("debug-enabled");let o=this.agent.data?.auth;const r=this.agent.data.variables;let i,d;if(this.panzoom&&(i=this.panzoom.getPan(),d=this.panzoom.getScale()),o?.provider)try{(await vv(this.agent.id,o))?.success&&(o={method:o.method})}catch(v){console.error("Error saving agent auth data",v)}let c=document.querySelector(".agent-card"),l={left:"",top:""};c&&(l.left=c.style.left,l.top=c.style.top);const m={version:"1.0.0",id:this.agent.id,name:this.agent.name,teamId:this.teamData.id,parentTeamId:this.teamData.parentId,components:t,connections:s,description:this.agent.description,shortDescription:this.agent.shortDescription,behavior:this.agent.data.behavior,variables:r,debugSessionEnabled:a,auth:o,ui:{panzoom:{currentPan:i,currentZoom:d},agentCard:l},introMessage:this.agent.data.introMessage||""};return document.getElementById("agent-template-id-input")?.value&&(m.templateInfo=this.getTemplateInfo()),e&&this.emit("DataExported",m),m}migrateConfiguration(e){const t=JSON.parse(JSON.stringify(e));if(!t.version)for(const s of t.components)s.outputs=s.connectors,s.inputs=s.receptors,s.outputProps=s.connectorProps,s.inputProps=s.receptorProps,delete s.connectors,delete s.receptors,delete s.connectorProps,delete s.receptorProps;if(t.version==="1.0.0"){for(const s of t.components)if(s?.template?.settings)for(let a in s.template.settings){const o=s.template.settings[a];o.attributes&&o.attributes["data-vault"]=="true"&&(o.attributes["data-vault"]=`${s.name},ALL`)}t.description&&!t.behavior&&(t.behavior=t.description,this.agent.data.behavior=t.behavior)}return t}async import(e){try{e=this.migrateConfiguration(e),this._loading=!0,ys("Loading Agent Data ..."),this.domElement.innerHTML="",this.jsPlumbInstance.deleteEveryConnection(),this.jsPlumbInstance.deleteEveryEndpoint(),ys("Importing Components ...");const t={};for(const a of e.components){const o=await this.addComponent(a.name,{outputs:a.outputs.map(r=>r.name),inputs:a.inputs.map(r=>r.name),outputProps:a.outputs,inputProps:a.inputs,data:a.data,top:a.top,left:a.left,width:a.width,title:a.title||"",aiTitle:a.aiTitle||"",description:a.description||"",uid:a.id,template:a.template},!1);t[a.id]=o.id}ys("Connecting Components ..."),await $e(300);const s=[];if(e.connections.forEach(a=>{const o=`${a.sourceId}.${a.sourceIndex}:${a.targetId}.${a.targetIndex}`;if(s.includes(o))return;const r=this.addConnection(a.sourceId,a.targetId,a.sourceIndex,a.targetIndex);s.push(o)}),this.renderAgentCard(e),await this.setComponentsTags(),ys("Almost Ready ..."),await $e(300),this.redraw(),Ho(),!this.getComponentsInViewPort().length){const a=this.domElement.querySelector(".component");this.scrollToComponent(a)}return setTimeout(()=>this.checkConnectionsConsistency(),1e3),this._loading=!1,this.emit("agentUpdated",this.agent),window.refetchSettingsSidebarData&&window.refetchSettingsSidebarData(),!0}catch(t){Ho(),this._loading=!1,console.error("Error",t),Je("Loading failed")}}renderAgentCard(e){let t=!1,s=!1,a={};if(e?.ui?.agentCard)a.left=e.ui.agentCard.left,a.top=e.ui.agentCard.top;else{const o=e?.components?.filter(r=>r.name==="APIEndpoint");if(console.log("skills to compare",o),o.length>0){const r=o.reduce((i,d)=>Number(i.top.split("px")[0]||0)<Number(d.top.split("px")[0]||0)?i:d);a.left=r.left.split("px")[0]-630+"px",a.top=r.top.split("px")[0]-250+"px",t=!0}else a.left="-700px",a.top="-6px",t=!0,s=!0}this.agentCard=new Ta(this,a,e),s&&this.agentCard.addEventListener("AgentCardCreated",()=>{this.scrollToAgentCard()}),t&&this.saveAgent()}getLock(){return this.locked}waitUnlock(e=1e4){return new Promise((t,s)=>{const a=Date.now(),o=setInterval(()=>{this.locked?Date.now()-a>e&&(clearInterval(o),s()):(clearInterval(o),t(!0))},500)})}lock(e){console.log("Locking Workspace"),this.locked=!0,document.querySelector("#builder-container")?.classList.remove("locked"),e?.showViewOnlyMsg&&this.toggleViewOnlyModeMsg(!0),xs(document.querySelector(".agentTab")),xs(document.querySelector(".deployTab")),xs(document.querySelector(".authTab")),xs(document.querySelector(".templateTab")),xs(document.querySelector(".agentBuilderTab"),["stop-btn","close-btn"]),xs(document.querySelector("#deploy-button-topbar")),window.dispatchEvent(new CustomEvent("update-widget-access",{detail:{writeAccess:!1}})),this.container.classList.add("locked"),document.body.classList.add("locked")}unlock(){console.log("Unlocking Workspace"),this.locked=!1,document.querySelector("#builder-container")?.classList.remove("locked"),this.toggleViewOnlyModeMsg(!1),Fs(document.querySelector(".agentTab")),Fs(document.querySelector(".deployTab")),Fs(document.querySelector(".authTab")),Fs(document.querySelector(".templateTab")),Fs(document.querySelector(".agentBuilderTab")),Fs(document.querySelector("#deploy-button-topbar")),window.dispatchEvent(new CustomEvent("update-widget-access",{detail:{writeAccess:!0}})),this.container.classList.remove("locked"),document.body.classList.remove("locked")}toggleViewOnlyModeMsg(e=!1){const t=document.getElementById("view-only-mode");t&&(e?(t.classList.remove("opacity-0"),t.classList.add("opacity-100"),t.classList.remove("hidden")):(t.classList.remove("opacity-100"),t.classList.add("opacity-0"),t.classList.add("hidden")))}registerAgentEvents(){this.agent.addEventListener("lock-as-view-mode",e=>{(e?.startsWith("unlock")||!e)&&this.lock({showViewOnlyMsg:!0})}),this.agent.addEventListener("lock",e=>{console.log("lock",e),(e?.startsWith("unlock")||!e)&&this.lock({showViewOnlyMsg:!1})}),this.agent.addEventListener("unlock",e=>{e?.startsWith("lock")&&this.unlock()})}getComponentsInViewPort(){const e=this.domElement.querySelectorAll(".component"),t=document.querySelector("#workspace-container").getBoundingClientRect(),s=[];for(let a of e){const o=a.getBoundingClientRect();o.top<t.bottom&&o.bottom>t.top&&o.left<t.right&&o.right>t.left&&s.push(a)}return s}scrollToComponent(e){if(!e||!e.classList.contains("component")||e.classList.contains("agent-card"))return;const t=this.panzoom,s=this.scale,a=e.getBoundingClientRect(),o=document.querySelector("#workspace-container").getBoundingClientRect();if(a.top<o.top||a.left<o.left||a.bottom>o.bottom||a.right>o.right){const r=(o.left-a.left+100)/s,i=(o.top-a.top+100)/s,d=t.getPan().x,c=t.getPan().y,l=Math.max(-1e4,Math.min(d+r,1e4)),m=Math.max(-1e4,Math.min(c+i,1e4));t.pan(l,m)}}scrollToAgentCard(){const e=this.panzoom,t=this.scale;if(!this.agentCard)return;const s=this.agentCard.domElement.getBoundingClientRect(),a=document.querySelector("#workspace-container").getBoundingClientRect();if(s.top<a.top||s.left<a.left||s.bottom>a.bottom||s.right>a.right){const o=(a.left-s.left+100)/t,r=(a.top-s.top+100)/t,i=e.getPan().x,d=e.getPan().y,c=Math.max(-1e4,Math.min(i+o,1e4)),l=Math.max(-1e4,Math.min(d+r,1e4));e.pan(c,l)}}getJsplumbConnection(e){const t=document.querySelector(`#${e.sourceId}`),s=document.querySelector(`#${e.targetId}`);if(!t||!s)return null;const a=t.querySelector(`.output-endpoint:nth-child(${e.sourceIndex+1})`),o=s.querySelector(`.input-endpoint:nth-child(${e.targetIndex+1})`);if(!a||!o)return null;const r=a,i=o;return this.jsPlumbInstance.getConnections({source:r,target:i})[0]}async checkConnectionsConsistency(e=null){const t=this.jsPlumbInstance;let s=!1;if(this._loading)return s;const a=this.jsPlumbInstance.getAllConnections();for(let r of a)delete r.___Async_tag,delete r.___Loop_tag;this.setComponentsTags();const o=this.jsPlumbInstance.getAllConnections();for(let r of o){let i=!1;const d=r.source.closest(".component"),c=r.target.closest(".component");if(!d||!c)continue;const l=d._control,m=c._control;if(!(!l||!m)){if(e||(e=r),m.constructor.name=="Async"&&d.___Async_tag=="async"||m.constructor.name=="Async"&&l.constructor.name=="Async"){s=!0,this.scrollToComponent(d);const v=t.getConnections({source:[...d.querySelectorAll(".output-endpoint")]});for(let x of v)x.__smt_overlay='<b style="color:red;position:relative;top:-20px">Conflict !!!</b>',x.__smt_color="#ff0000",x.__smt_thickness=8,this.updateConnectionColors(x),i=!0;await Xn("Connection Consistency Check Failed",`Nested Async Component is not allowed ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`),console.error(`Nested Async Component is not allowed ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`,d,d.___Async_tag,c,c.___Async_tag,r)}else if(l.constructor.name!=="Async"&&d.___Async_tag!=="async"&&c.___Async_tag==="async"){s=!0,this.scrollToComponent(d);const v=t.getConnections({source:[...d.querySelectorAll(".output-endpoint")]});for(let x of v)x.__smt_overlay='<b style="color:red;position:relative;top:-20px">Conflict !!!</b>',x.__smt_color="#ff0000",x.__smt_thickness=8,this.updateConnectionColors(x),i=!0;await Xn("Connection Consistency Check Failed",`Connection from Synchronous to Asynchronous component is not allowed ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`),console.error(`Connection from Synchronous to Asynchronous component is not allowed ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`,d,d.___Async_tag,c,c.___Async_tag,r)}if(r.___Loop_tag&&r.___Loop_tag!=c.___Loop_tag){s=!0,this.scrollToComponent(d);const v=t.getConnections({source:[...d.querySelectorAll(".output-endpoint")]});for(let x of v)x.__smt_overlay='<b style="color:red;position:relative;top:-20px">Conflict !!!</b>',x.__smt_color="#ff0000",x.__smt_thickness=8,this.updateConnectionColors(x),i=!0;await Xn("Loop Branches Conflict Detected",`Loop Branches cannot be connected to other branches ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`),console.error(`Loop Branches cannot be connected to other branches ==> ${l.drawSettings.displayName} -> ${m.drawSettings.displayName}`,d,c,r)}!i&&r.__smt_overlay&&(delete r.__smt_overlay,delete r.__smt_color,delete r.__smt_thickness,this.updateConnectionColors(r))}}return s}async setComponentsTags(){this.agent;const e=[...this.domElement.querySelectorAll(".component")];e.map(a=>a._control);const t=e.filter(a=>a._control.constructor.name=="Async"),s=e.filter(a=>a._control.constructor.name=="ForEach");for(let a of e)delete a.___Async_tag,delete a.___Loop_tag,a.classList.remove("async"),a._control.async=!1;for(let a of t){const o=[...new Set(this.jsPlumbInstance.getAllConnections().filter(r=>r.source.closest(".component")==a&&r.source.getAttribute("smt-name")!=="JobID").map(r=>({connection:r,component:r.target.closest(".component")})))].filter(r=>r.component);for(let r of o)this.recursiveSetChildTag(r,"Async","async")}for(let a of s){const o=[...new Set(this.jsPlumbInstance.getAllConnections().filter(i=>i.source.closest(".component")==a).map(i=>({connection:i,component:i.target.closest(".component")})))].filter(i=>i);let r=1;for(let i of o)this.recursiveSetChildTag(i,"Loop",r++,!1)}for(let a of e)a.___Async_tag||(a.classList.add("sync"),a.___Async_tag="sync")}recursiveSetChildTag(e,t,s,a=!0){const o=e.component;if(!o)return;const r=e.connection;o._control,o.classList.add(s);const i=`___${t}_tag`;if(o?.[i]===s&&r?.[i]===s)return;(o[i]&&a||o[i]===void 0)&&(o[i]=s),(r[i]&&a||r[i]===void 0)&&(r[i]=s);const d=[...new Set(this.jsPlumbInstance.getAllConnections().filter(c=>c.source.closest(".component")==o).map(c=>({connection:c,component:c.target.closest(".component")})))];for(let c of d)this.recursiveSetChildTag(c,t,s)}async saveTemplate(){return im.call(this)}async exportTemplate(){return om.call(this)}getTemplateInfo(){return am.call(this)}initMonitor(){console.log("INIT MONITOR"),this.monitor&&this.monitor.close(),this.monitor=new bk(this);try{this.monitor.init()}catch(e){console.error("Failed to initialize monitor:",e)}}refreshComponentSelection(e){document.querySelectorAll("#workspace-container .component").forEach(t=>{if(t.classList.remove("selected","unselected"),!!e){if(t.id!==e.id){t.classList.add("unselected");return}t.classList.add("selected")}})}async updateWeaverData(e){this.userData.weaver=e}};xl(Ek,"Workspace");var rm=(n=>(n.APIEndpoint="/agent-studio/components/base/agent-skill",n.APIOutput="/agent-studio/components/base/api-output",n.Classifier="/agent-studio/components/base/classifier",n.GenAILLM="/agent-studio/components/base/gen-ai-llm",n.ImageGenerator="/agent-studio/components/base/image-generator",n.Note="/agent-studio/components/base/note",n.APICall="/agent-studio/components/advanced/api-call",n.Async="/agent-studio/components/advanced/async",n.Await="/agent-studio/components/advanced/await",n.Code="/agent-studio/components/advanced/code",n.ForEach="/agent-studio/components/advanced/for-each",n.JSONFilter="/agent-studio/components/advanced/json-filter",n.LLMAssistant="/agent-studio/components/advanced/llm-assistant",n.FSleep="/agent-studio/components/advanced/sleep",n.ComputerUse="/agent-studio/components/tools/computer-use",n.MCPClient="/agent-studio/components/tools/mcp-client",n.ServerlessCode="/agent-studio/components/tools/node-js",n.WebScrape="/agent-studio/components/tools/web-scrape",n.WebSearch="/agent-studio/components/tools/web-search",n.FEncDec="/agent-studio/components/crypto/encode-decode",n.FHash="/agent-studio/components/crypto/hash",n.FSign="/agent-studio/components/crypto/sign",n.FTimestamp="/agent-studio/components/crypto/timestamp",n.DataSourceCleaner="/agent-studio/components/rag-data/rag-forget",n.DataSourceIndexer="/agent-studio/components/rag-data/rag-remember",n.DataSourceLookup="/agent-studio/components/rag-data/rag-search",n.LogicAND="/agent-studio/components/logic/logical-and",n.LogicOR="/agent-studio/components/logic/logical-or",n.LogicXOR="/agent-studio/components/logic/logical-xor",n.LogicAtLeast="/agent-studio/components/logic/logical-at-least",n.LogicAtMost="/agent-studio/components/logic/logical-at-most",n.PromptGenerator="/agent-studio/components/legacy/llm-prompts",n.MultimodalLLM="/agent-studio/components/legacy/multimodal-llm",n.VisionLLM="/agent-studio/components/legacy/vision-llm",n.GPTPlugin="/agent-studio/integrations/openapi-integration",n.AgentPlugin="/agent-studio/integrations/smythos-agents-integration",n.HuggingFace="/agent-studio/integrations/hugging-face-integration",n.ZapierAction="/agent-studio/integrations/zapier-integration",n))(rm||{}),kk=Object.defineProperty,qt=u((n,e)=>kk(n,"name",{value:e,configurable:!0}),"y");function lm(n){const e=this;n.querySelector(".title");const t=n.querySelector(".dialog-actions");n.querySelector(".title-right-buttons");const s=n.querySelector(".title-left-buttons"),a=t.querySelector("button.del-btn");a.classList.remove("hidden"),a.onclick=e.delete.bind(this,!1);const o=e.properties?.template?.templateInfo?.docPath||"/not-set",r=e.properties?.template?e.workspace.serverData.docUrl+o:e.docUrl,i=s.querySelector(".action-help");i.onclick=()=>{window.open(r,"_blank")},e.properties?.template&&!e.properties?.template?.templateInfo?.docPath&&i.classList.add("hidden"),e.workspace?.locked?(xs(n,["close-btn","action-help"]),n.querySelector(".save-btn").classList.add("hidden"),n.querySelector(".del-btn").classList.add("hidden")):(n.querySelector(".save-btn").classList.remove("hidden"),n.querySelector(".del-btn").classList.remove("hidden"));const d=n.querySelector("form");function c(m){dm(e)}u(c,"o"),qt(c,"handleChange");const l=bv(c,500);d.addEventListener("input",function(m){(m.target.tagName==="INPUT"||m.target.tagName==="TEXTAREA")&&l(m)}),d.addEventListener("change",function(m){(m.target.tagName==="SELECT"||m.target.tagName==="INPUT"&&(m.target.type==="checkbox"||m.target.type==="radio"))&&l(m)}),e.emit("settingsOpened",n,this)}u(lm,"ee$1"),qt(lm,"onComponentLoad");function cm(n){const e=this;e.properties.template,n.querySelector(".title");const t=n.querySelector(".dialog-actions"),s=n.querySelector(".title-right-buttons"),a=n.querySelector(".title-left-buttons");s.querySelector("button.close-btn").classList.remove("hidden"),s.querySelector("button.save-btn").classList.add("hidden"),t.querySelector("button.del-btn").classList.add("hidden"),a.querySelector(".action-help").classList.add("hidden"),e.data._templateVars;const o=e.properties?.template?.templateInfo,r=n.querySelector("form.Settings");if(r){const i=[...r.querySelectorAll(".form-box")],d=qt((c,l)=>{let m=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm.exec(c.value);const v=c.closest(".form-box").querySelector(".chk-bind-setting");if(!v)return;const x=v?.previousElementSibling;m?(v.checked=!1,v.disabled=!0,v.classList.add("hidden"),x.innerHTML="Override Not allowed With Custom Variables"):(v.disabled=!1,v.classList.remove("hidden"),x.innerText="Allow Override")},"fieldChangeCheck");for(let c of i){const l=document.createElement("div");c.appendChild(l);const m=c.querySelectorAll("input, textarea");m?.forEach(F=>{F.addEventListener("change",O=>{console.log("Change Event",O),d(O.target)}),F.addEventListener("mouseout",O=>d(O.target)),F.addEventListener("keyup",O=>{(O.ctrlKey||O.metaKey)&&d(O.target)}),setTimeout(()=>d(F),1e3)}),r.addEventListener("mouseout",F=>{m.forEach(O=>{d(O)})});const v=document.createElement("div");v.className="float-right inline-block rounded-full",v.style.pointerEvents="auto";const x=document.createElement("div");x.className="bg-gray-300 rounded-full pr-6 pl-2 py-1 absolute inset-0",x.style.pointerEvents="none";const C=document.createElement("div");C.className="relative flex items-center gap-2",C.style.pointerEvents="none";const w=document.createElement("label");w.innerText="Allow Override",w.className="px-1 cursor-pointer";const f=document.createElement("input");f.type="checkbox",f.className="chk-bind-setting w-4 h-4 text-gray-600 focus:outline-none cursor-pointer relative z-10",f.style.pointerEvents="auto";const T=`chk-${c.getAttribute("data-field-name")}`;f.id=T,w.htmlFor=T,C.appendChild(w),C.appendChild(f),v.appendChild(x),v.appendChild(C),l.appendChild(v);const k=c.getAttribute("data-field-name");f.checked=k&&o?.includedSettings?.includes(k)}}}u(cm,"te$1"),qt(cm,"onTemplateCreateLoad");async function Sl(n){if(!n){console.log("Invalid form");return}const e=this,t=n.Settings;if(e.emit("settingsSaving",t),t?.prompt&&(e.title===e.displayName||e.aiTitle===e.title)){const s=e.settingsEntries;t?.prompt&&t?.prompt!==s?.prompt?.value&&await e.updateTitle()}if(!await e.save(t)){Je("Error saving settings");return}if(e.properties.template){const s=e.templateSettings;e.data._templateVars;const a=e.properties?.template?.templateInfo?.includedSettings||[];for(let o of a)e.data[o]=t[o];e.data._templateVars={};for(let o in s)e.data._templateVars[o]=t[o]}else for(let s in e.settings)e.data[s]=t[s];e.emit("settingsSaved",t),e.emit("settingsClosed"),e.domElement.classList.remove("active"),Ue.curComponentSettings=null,await $e(100),e.workspace.saveAgent(),e.unsetTemplateEditMode()}u(Sl,"K"),qt(Sl,"onSave");async function um(n){const e=this,t=n.Settings;let s={};for(let a in t)s[a]=t[a]?.value||"";e.emit("settingsDraftUpdated",s)}u(um,"le$1"),qt(um,"onDraft");const _k={html1:{type:"div",classOverride:"all-initial p-2 px-4",html:`
<h1 class="text-lg font-bold text-emerald-600 mt-6">Component Template Builder Help</h1>

<div class="bg-gray-200 p-4 rounded-md" ><b>Note : </b> This help section explains the usage of custom template variables, this is an MVP implementation, a <b>Visual Editor</b> will replace it later</div>

<p class="mt-4">You can use the following annotations inside text inputs in order to generate additional fields in the new component : </p>
<ul>
<li><b class="w-8"> * Select</b> : {{<span class="font-bold text-indigo-700">SELECT</span>:<span class="font-bold text-emerald-700">Select label</span>:<span class="font-bold text-blue-700">["value1", "value2", "value3"]</span>}}</li>
<li><b class="w-8"> * Range</b> : {{<span class="font-bold text-indigo-700">RANGE</span>:<span class="font-bold text-emerald-700">Range label</span>:<span class="font-bold text-blue-700">{"min":0,"max":10,"step":1,"value":5}</span>}}</li>
<li><b class="w-8"> * Key-Value</b> : {{<span class="font-bold text-indigo-700">KVJSON</span>:<span class="font-bold text-emerald-700">KV label</span>:<span class="font-bold text-blue-700">{"field1":"value1","field2":10,"field3":""}</span>}}</li>
<li><b class="w-8"> * Text Input</b> : {{<span class="font-bold text-indigo-700">INPUT</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}} </li>
<li><b class="w-8"> * Text Area</b> : {{<span class="font-bold text-indigo-700">TEXTAREA</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
<li><b class="w-8"> * Password</b> : {{<span class="font-bold text-indigo-700">PASSWORD</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
</ul>


<p class="mt-4">

The <span class="font-bold text-indigo-700">first field</span> (in CAPITAL letters) is the field type, it should always be one of the following : SELECT, INPUT, TEXTAREA, PASSWORD.<br/>
you can use variant annotations like : <br />
 - VARINPUT, VARTEXTAREA for an text inputs that accepts variables<br />
 - VAULTPASSWORD for a password field that can be managed using the vault <br />
</p>

<p class="mt-4">
The <span class="font-bold text-emerald-700">second field</span> is the label that will be displayed in the component settings, this is a free text, but keep it short.
</p>

<p class="mt-4">
The <span class="font-bold text-blue-700">last field</span> should be an array of possible values for SELECT input, or an empty element [""].<br/>
<b>It's important to use the empty element [""] even if no value is configured.</b>
</p>

        `}};async function dm(n){const e=n.getSettingsSidebar();if(!e)return;const t=await yv(e);if(!t)return;const s=t.Settings;if(!n.properties.template)for(let a in n.settings)s[a]&&s[a].valid&&(n.data[a]=s[a].value);n.checkSettings()}u(dm,"writeSettings"),qt(dm,"writeSettings");async function pm(n,e=!1){const t=n.settingsChanged();!e&&t&&(await n.confirmSaveSettings(),await $e(100)),await xv(),Ue.curComponentSettings=null,n.domElement.classList.remove("active")}u(pm,"closeSettings"),qt(pm,"closeSettings");async function hm(n){Ue.curComponentSettings=n,n.workspace.domElement.querySelectorAll(".component.active").forEach(x=>{x.classList.remove("active")}),n.domElement.classList.add("active");const e={};for(let x in n.settings){const C=n.settings[x],w={...C,value:n.data[x]};C?.type==="composite"?e[x]=xi(w):e[x]=w}let t=null;if(n.properties.template){t={};const x=n.properties?.template?.templateInfo?.includedSettings||[];for(let w of x)t[w]=n.settings[w],t[w].value=n.data[w];const C=n.data._templateVars;for(let w in n.templateSettings){const f=n.templateSettings[w],T={...f,value:C[w]||f.value||""};f?.type==="composite"?t[w]=xi(T):t[w]=T}}n.settingsEntries=n.properties.template?t:e;const s=n.properties?.template?.templateInfo?.name||n.title||"",a=qt(async()=>(await n.confirmSaveSettings(),!0),"onBeforeCancel"),o=qt(()=>{Ue.curComponentSettings=null,n.emit("settingsClosed"),n.domElement.classList.remove("active"),n.unsetTemplateEditMode()},"onCancel"),r=qt(x=>{const C=x.target.value,w=C.match(/<i class="([^"]+)"/),f=w?w[1]:C;x.target.value=f;const T=x.target.closest(".form-box");if(T){let k=T.querySelector(".tpl-icon-preview");k||(k=document.createElement("div"),k.classList.add("tpl-icon-preview","absolute","bottom-0","right-0","w-12","h-12"),T.appendChild(k)),f.startsWith("fa")?k.innerHTML=`<i class="icon tpl-fa-icon ${f}"></i>`:k.innerHTML=`<div class="w-8 h-8">${f}</div>`}},"iconUpdate");rs=null;async function i(x,C="#000000",w=""){try{const f=await fetch("/api/page/collection/create-collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x,color:C,icon:w})});if(!f.ok)throw new Error("Failed to add new collection");const T=await f.json();return T.error?(Je("Error adding new collection"),null):T}catch{return Je("Error adding new collection"),null}}u(i,"S"),qt(i,"addNewCollection");const d={name:{type:"input",label:"Name",value:n.properties?.template?.templateInfo?.name||n.title||""},description:{type:"textarea",label:"Description",value:n.properties?.template?.templateInfo?.description||n.description||""},icon:{type:"textarea",label:"Font Awesome Class or SVG",value:n.properties?.template?.templateInfo?.icon||"",events:{change:r,mouseup:r,keyup:x=>{(x.ctrlKey||x.metaKey)&&r(x)}}},color:{type:"color",value:n.properties?.template?.templateInfo?.color||"#000000"},docPath:{type:"input",label:"Documentation Path",value:n.properties?.template?.templateInfo?.docPath||""},ytLink:{type:"input",label:"Youtube Tutorial Link",value:n.properties?.template?.templateInfo?.ytLink||""},newCollectionCheckbox:{type:"checkbox",label:"Do you want to create a new collection?",value:!1,events:{change:x=>{const C=document.querySelector('[data-field-name="newCollectionInput"]'),w=document.querySelector('[data-field-name="newCollectionButton"]');x.target.checked?(C.classList.remove("invisible","hidden"),C.classList.add("block","visible"),w.classList.remove("invisible","hidden"),w.classList.add("inline-block","visible")):(C.classList.remove("block","visible"),C.classList.add("invisible","hidden"),w.classList.remove("inline-block","visible"),w.classList.add("invisible","hidden"))}}},newCollectionInput:{type:"input",label:"New Collection Name",value:"",class:"invisible hidden"},newCollectionButton:{type:"button",label:"Add Collection",class:"invisible hidden",attributes:{},events:{click:async x=>{const C=x.target,w=C.innerHTML,f=document.querySelector('[data-field-name="newCollectionInput"]'),T=f.querySelector("input").value.trim(),k=document.getElementById("color").value.trim(),F=document.getElementById("icon").value.trim();if(T){C.innerHTML='<i class="fas fa-spinner fa-spin"></i>',C.disabled=!0;const O=await i(T,k,F);if(C.innerHTML=w,C.disabled=!1,O){f.querySelector("input").value="";const _=document.getElementById("newCollectionCheckbox");_.checked=!1;const M=document.querySelector('[data-field-name="newCollectionButton"]');f.classList.remove("block","visible"),f.classList.add("invisible","hidden"),M.classList.remove("inline-block","visible"),M.classList.add("invisible","hidden"),$t("New collection added")}}else Je("Please enter a collection name")}}},collection:{type:"select",label:"Collection",value:n.properties?.template?.templateInfo?.collection||"",options:mm.bind(n),events:{change:x=>{const C=rs.find(F=>F.value===x.target.value),w=document.querySelector('.form-box[data-field-name="icon"] #icon'),f=n.properties?.template?.templateInfo?.icon||"",T=n.properties?.template?.templateInfo?.color||"#000000";(w&&!f||!w?.value)&&(w.value=C.icon);const k=document.querySelector('.form-box[data-field-name="color"] #color');if(!T||T=="#000000"||k.value=="#000000"){k.value=C.color,k.setAttribute("value",C.color);const F=k.closest(".clr-field");F&&(F.style.color=C.color)}}}},version:{type:"input",label:"Version",validate:"custom=isValidSemVer",validateMessage:"Invalid version number. Must be in the format x.x.x",value:n.properties?.template?.templateInfo?.version||"1.0.0"},published:{type:"checkbox",class:"w-32",label:"Published",value:n.properties?.template?.templateInfo?.published||!1}},c=n?.templateSupport&&n.workspace?.userData?.acl?.["/templates"]=="rw"&&n.workspace?.userData?.isSmythStaff?{template:{type:"button",label:n.properties.template?'<i class="fa-solid fa-pen-to-square"></i>':'<i class="fa-solid fa-screwdriver-wrench"></i>',icon:"",hint:n.properties.template?"Edit This Template":"Create Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async()=>{let x=!0;n.properties.template&&(x=!1,n.settingsEntries=e);const C={Info:d,Settings:n.settingsEntries,Help:_k},w={template:{type:"button",label:'<i class="fa-regular fa-floppy-disk"></i>',icon:"",hint:"Save Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async f=>{console.log("collecting settings data");const T=f.target.closest(".right-sidebar")?.querySelector("form.Settings");let k={};T&&(k=[...T.querySelectorAll(".chk-bind-setting")].filter(b=>b.checked).map(b=>b.closest(".form-box").getAttribute("data-field-name")),console.log(k));const F={};for(let b in C){const P=document.querySelector(`#right-sidebar form.${b}`),L=C[b];if(wv(P),await $e(30),P.querySelector(".invalid"))return;const N=wi(P,L);F[b]=N}const O=F.Settings;if(n.emit("settingsSaving",O),!await n.save(O)){Je("Error saving settings");return}if(!n.properties.template||!x)for(let b in n.settings)n.data[b]=O[b];else{const b=n.templateSettings,P=n.data._templateVars,L=n.properties?.template?.templateInfo?.includedSettings||[];for(let N of L)n.data[N]=O[N];for(let N in b)P[N]=O[N]}console.log("template save settings",n.settings);const _=n.exportTemplate();_.templateInfo={...n.properties.template?.templateInfo,...F.Info,includedSettings:k},_.data={..._.data,...n.data},_.templateInfo.icon,n.emit("settingsSaved",O);let M=x?null:_?.templateInfo?.id;try{const b=rs.find(I=>I.value===_.templateInfo.collection);let P=_.templateInfo.icon||"";P||(_.templateInfo.icon=b?b.icon:P);let L=_.templateInfo.color||"#000000";L==="#000000"&&(_.templateInfo.color=b?b.color:L);const N=await gm(M,_,_.templateInfo?.published||!1).catch(I=>({error:I}));if(N.error){console.log("error saving template",N.error),Je(N.error?.error?.message||"Cannot save component","Error Saving template");return}_.templateInfo.id=N.component.id,n.properties.template=_,n.title=_.templateInfo.name,n.description=_.templateInfo.description,n.domElement.querySelector(".internal-name").textContent=`T: ${_.templateInfo.name}`;const z=n.domElement.querySelector(".title-bar");if(z){z.querySelector(".title .text").textContent=_.templateInfo.name,z.querySelector(".description .text").textContent=_.templateInfo.description;const I=rs.find(q=>q.value===_.templateInfo.collection),W=z.querySelector(".icon");let B=_.templateInfo.icon||"",K=_.templateInfo.color||"#000000";if(B.startsWith("<svg")){W.className="icon w-6 h-6";const q=B.replace(/<path/g,"<path");W.innerHTML=`${q}`;const X=W.querySelectorAll("path");[...X].find(Q=>Q.getAttribute("fill")&&Q.getAttribute("fill")!=="none")||X.forEach(Q=>Q.setAttribute("fill",K))}else W.className=`icon tpl-fa-icon ${B}`,W.innerHTML="",W.style.backgroundColor="",W.style.color=K}if(x){n.data._templateVars=n.data._templateVars||{};let I=null;if(n.properties.template){I={};const W=n.data._templateVars;for(let B in n.templateSettings){const K=n.templateSettings[B],q={...K,value:W[B]};K?.type==="composite"?I[B]=xi(q):I[B]=q}}n.settingsEntries=I}x=!1,n.workspace.saveAgent(),x?$t("Component Template Created"):$t("Component Template Updated")}catch(b){console.log("error saving template",b),Je("Error saving template")}}}};n.setTemplateEditMode(),_c({title:`Template Editor : ${s}`,entriesObject:C,features:{templateVars:!0},actions:w,onSave:Sl.bind(n),onBeforeCancel:a,onCancel:o,onLoad:cm.bind(n)})}}}:null,l=fm(n),m=n.constructor.name;let v="";switch(m){case"ServerlessCode":v="Run scalable, cloud-based code. This option supports npm packages and third-party libraries, making it perfect for more complex, enterprise-level workflows.";break;case"Code":v="Execute pure JavaScript in a secure, sandboxed environment\u2014ideal for lightweight tasks.";break;default:v=""}_c({title:l,entriesObject:{Settings:n.settingsEntries},features:{templateVars:!0},actions:c,onSave:Sl.bind(n),onDraft:um.bind(n),onBeforeCancel:a,onCancel:o,onLoad:lm.bind(n),helpTooltip:v}),n.emit("settingsOpened",n.getSettingsSidebar())}u(hm,"editSettings"),qt(hm,"editSettings");let rs;async function mm(){if(rs)return rs;console.log("getComponentsCollections");const n=await fetch("/api/page/builder/app-config/collections").then(e=>e.json());return n.error?(Je("Error fetching collections"),[]):(console.log("collectionResult",n),rs=(n?.collections||[]).map(e=>({value:e.id,text:e.name,color:e.color||"#000000",icon:e.icon})),rs)}u(mm,"ne$1"),qt(mm,"getComponentsCollections");async function gm(n,e,t=!1){let s="/api/page/builder/app-config/components";n&&(s+=`/${n}`);const a=e?.templateInfo?.name||e.name,o=e?.templateInfo?.collection||null,r={name:a,data:JSON.stringify(e),collectionId:o,visible:t};return await fetch(s,{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(i=>i.json())}u(gm,"ae$1"),qt(gm,"saveComponentTemplate");function fm(n){const e=n.properties?.template?.templateInfo?.name||n.title||"";let t=n.data?.logoUrl||n?.logoUrl,s="";const a=["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost","Await","MultimodalLLM","LLMAssistant"],o=["APIEndpoint","GenAILLM","ImageGenerator","Classifier","Note","APIOutput"];let r="w-6 h-6",i="";if(!t&&n?.drawSettings?.iconCSSClass==="svg-icon HuggingFace"&&(t="https://huggingface.co/front/assets/huggingface_logo-noborder.svg"),typeof t=="string"&&t.trim()!=="")a.some(d=>e.includes(d))&&(r="w-8 h-8"),s=`<img src="${t}" alt="${e} icon" class="inline-block align-middle ${r} object-contain rounded">`;else{let d=n.drawSettings.iconCSSClass||"";i=d;const c="#242424";if(a.some(l=>i.includes(l))&&(r="w-8 h-8"),d.startsWith("fa"))s=`<i class="${d.includes("tpl-fa-icon")?d:`tpl-fa-icon ${d}`} inline-block align-middle" style="color: ${c}; font-size: 1.5rem; vertical-align: middle;"></i>`;else if(d.trim().startsWith("<svg")){let l=d;l=l.replace(/<path[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),l=l.replace(/<svg[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),l.includes('class="')?(l=l.replace("<svg",`<svg fill="${c}"`),l.includes("w-full")||(l=l.replace(/class="([^"]*)"/,'class="$1 w-full"')),l.includes("h-full")||(l=l.replace(/class="([^"]*)"/,'class="$1 h-full"'))):l=l.replace("<svg",`<svg fill="${c}" class="w-full h-full"`),s=`<span class="inline-block align-middle ${r}">${l}</span>`}else if(d){d.includes("svg-icon")||(d=`svg-icon ${d}`);const l=o.some(v=>d.includes(v)),m=`background-color: ${c}${l?" !important":""};`;s=`<span class="${d} ${r} inline-block align-middle" style="${m}"></span>`}}return`
    <div class="flex items-center gap-2">
      ${s}
      <span class="truncate">${e}</span>
    </div>
  `}u(fm,"ie$1"),qt(fm,"generateSidebarTitleHTML");var Pk=Object.defineProperty,bt=u((n,e)=>Pk(n,"name",{value:e,configurable:!0}),"k");const Cl={},Ik=bt(n=>{if(localStorage.getItem("sidebarOpen"),localStorage.getItem("currentSidebarTab"),window._fixWithAIBtnDispatched)return;window._fixWithAIBtnDispatched=!0;const e=new CustomEvent("fixWithAIBtn",{detail:{data:n},bubbles:!0,composed:!0});window.dispatchEvent(e),setTimeout(()=>{window._fixWithAIBtnDispatched=!1},100)},"triggerFixWithAIBtn"),Lk={VANILLA:kc,REACT:n=>Id({config:n})};window.__INPUT_TEMPLATE_VARIABLES__={},window.__FIELD_TEMPLATE_VARIABLES__={},window.interact=Qn;function vm(n){const e=bt(s=>/^-?\d+(\.\d+)?$/.test(s.trim()),"isNumber"),t=bt(s=>{const a=parseFloat(s);return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER&&a.toString()===s.trim()},"isValidNumber");if(!n)return null;if(e(n)&&!t(n)||!n.trim().startsWith("{")&&!n.trim().startsWith("["))return n;try{return JSON.parse(n)}catch{return JSON.parse(Go(n))}}u(vm,"Yt"),bt(vm,"parseEndpointJson");function uo(n){if(Array.isArray(n)){for(let t=0;t<n.length;t++)n[t]=uo(n[t]);return n}if(typeof n=="object"&&n!==null){for(let t in n)n[t]=uo(n[t]);return n}const e=typeof n=="string"?n:JSON.stringify(n);return e.length>100?e.substring(0,100)+"...(long content truncated)":e}u(uo,"at"),bt(uo,"recursiveTruncateLongJsonValues");const bm=class Qs extends pa{static{u(this,"J")}constructor(e,t={outputs:[],inputs:[],data:{},top:"",left:"",width:"",height:"",title:"",description:"",sender:null,uid:null,template:null,aiTitle:"",displayName:""},s=!0){if(super(),this.workspace=e,this.properties=t,this.settings={},this.inputEditor=Lk.VANILLA,this.inputSettings={defaultVal:{type:"string",default:"",allowDefaultEdit:!0,editConfig:{type:"textarea",label:"Default Value",fieldCls:"min-h-[50px] px-3 py-1 resize-y",attributes:{"data-agent-vars":"true","data-auto-size":"false",style:"height: 34px;"},section:"Advanced_Options",hint:"Value assigned if no specific value provided by user.",hintPosition:"after_label"}}},this.outputSettings={expression:{type:"string",default:"",editConfig:{type:"input",section:"Advanced_Options",help:"JSON path"}}},this.data={},this.drawSettings={displayName:this.constructor.name,cssClass:"",iconCSSClass:"mif-cog",showSettings:!0,addOutputButton:"Outputs",addInputButton:"Inputs",inputMaxConnections:-1,outputMaxConnections:-1,firendlyName:this.constructor.name,category:"Base",componentDescription:"",shortDescription:"",color:"#fff"},this._destroyed=!1,this.docUrl=Ft+(rm[this.constructor.name]||""),this.settingsEntries={},this.async=!1,this.templateSupport=!1,this.templateEditing=!1,this._ready=!1,this.displayName=this.constructor.name,this._uid=this.properties.uid||"C"+Dn(),this.properties||(this.properties={top:"",left:""}),this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=[],this.properties.outputs||(this.properties.outputs=[]),this.properties.inputs||(this.properties.inputs=[]),this.properties.inputProps||(this.properties.inputProps=[]),this.properties.outputProps||(this.properties.outputProps=[]),this.data=this.properties.data||{},this.properties.template){const a=this.properties.template;this.properties.inputs=[...new Set([...this.properties.inputs,...a.inputs?.map(i=>i.name)||[]])],this.properties.outputs=[...new Set([...this.properties.outputs,...a.outputs?.map(i=>i.name)||[]])];const o=[];for(let i of this.properties.inputs){const d=a.inputs?.find(l=>l.name===i),c=this.properties.inputProps.find(l=>l.name===i);o.push({...d,...c})}this.properties.inputProps=o;const r=[];for(let i of this.properties.outputs){const d=a.outputs?.find(l=>l.name===i),c=this.properties.outputProps.find(l=>l.name===i);r.push({...d,...c})}this.properties.outputProps=r}this.prepare().then(this.init.bind(this)).then(()=>{this.title=this.properties.aiTitle||this.properties.title||this.drawSettings.displayName,this.aiTitle=this.properties.aiTitle||"",this.description=this.properties.description||this.drawSettings.shortDescription||this.drawSettings.componentDescription||"";const a=this.properties.defaultOutputs.reverse();for(let r of a)this.properties.outputs.indexOf(r)===-1&&this.properties.outputs.unshift(r);const o=this.properties.defaultInputs.reverse();for(let r of o)this.properties.inputs.indexOf(r)===-1&&this.properties.inputs.unshift(r);this.redraw(s),this._ready=!0}).then(this.run.bind(this)).finally(()=>{this.syncTemplateVars()}),Cl[this.uid]=this}get uid(){return this._uid}get settingsOpen(){return Qs.curComponentSettings==this}get templateSettings(){return this.properties?.template?.settings}set templateSettings(e){this.properties?.template&&(this.properties.template.settings=e)}async prepare(){return!0}async run(){return!0}syncTemplateVars(){window.__INPUT_TEMPLATE_VARIABLES__[this._uid]=new Map;const e=bt((o,r="Any")=>{const i={var:`{{${o}}}`,type:r};window.__INPUT_TEMPLATE_VARIABLES__[this._uid].set(o,i)},"addVar"),t=bt(o=>{window.__INPUT_TEMPLATE_VARIABLES__[this._uid].delete(o)},"deleteVar"),s=bt(()=>{const o=window.__INPUT_TEMPLATE_VARIABLES__?.[this._uid]||new Map,r=window.__LAST_FIELD_WITH_TEMPLATE_VARS__,i=window.__FIELD_TEMPLATE_VARIABLES__?.[r]||new Map,d=new Map([...o,...i]);Sv(d,this._uid)},"generateVarBtns");this.properties.inputProps?.forEach(o=>e(o.name,o.type));const a=bt(o=>o.classList.contains("input-endpoint"),"isInput");this.addEventListener("endpointAdded",(o,r)=>{a(r)&&(setTimeout(()=>{const i=r.getAttribute("smt-type");e(o,i)},100),s())}),this.addEventListener("endpointChanged",(o,r,i,d)=>{a(r)&&((o==="name"||o==="type")&&setTimeout(()=>{const c=o==="name"?d:r.getAttribute("smt-name"),l=o==="type"?d:r.getAttribute("smt-type");o==="name"&&t(i),e(c,l)},100),s())}),this.addEventListener("endpointRemoved",(o,r)=>{a(r)&&(t(o),s())})}addFieldVariable(e,t){const s=window.__FIELD_TEMPLATE_VARIABLES__?.[e]||new Map;for(const[a,o]of Object.entries(t))s.set(a,{var:o,type:"field"});window.__FIELD_TEMPLATE_VARIABLES__[e]=s}ready(e){return new Promise((t,s)=>{if(this._ready)return t(!0);const a=setInterval(()=>{this._ready&&(clearInterval(a),e&&e(),t(!0))},15)})}async repaint(e=!1){if(e){let t=[...this.domElement.querySelectorAll(".endpoint")].map(s=>s?.endpoint?.connections).flat(1/0);t=[...new Set(t)],t.forEach(s=>{this.workspace.updateConnectionStyle(s)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async init(){}async clean(){return!0}isFunctionalComponent(){return["FSign","FEncDec","FSleep","FTimestamp","FHash"].includes(this.constructor.name)}isLogicalComponent(){return["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost"].includes(this.constructor.name)}addDebugButton(){if(!this.domElement)return;const e=this.domElement.querySelector(".title-bar");if(!e)return;e.querySelector(".btn-debug")?.remove();const t=document.createElement("button");t.className="btn-debug button-icon absolute z-10",this.isFunctionalComponent()?(t.style.top="1px",t.style.right="4px"):(t.style.top="9px",t.style.right="7px");const s=document.createElement("div");s.className="debug-icon-container",s.innerHTML=`
          <img src="" class="debug-icon default-icon w-8 h-8" alt="Debug" style="opacity: 1;" />
      `,t.appendChild(s),t.onclick=this.openDebugDialog.bind(this),new iu(t,{text:"Run with Debug",position:this.isLogicalComponent()?"left":"top",showWhen:"hover"}),e.appendChild(t)}async checkSettings(){this.clearComponentMessages();const{data:e}=await Cc({scope:void 0}),t=Object.values(e);let s=[];for(let l in this.settings){const m=this.settings[l];m.validate?.includes("required")&&s.push({id:l,name:m.label||l})}const a=s.filter(l=>!this.data[l.id]);a.length>0&&this.addComponentMessage(`Missing Settings ${a.map(l=>l.name).join(", ")}`,"alert pointer",()=>{Ct.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});const o="_manage_keys_message",r=this.hasComponentMessage(`.${o}`),i=bt(async({addMockToggle:l=!1,addManageMessage:m=!1})=>{try{m&&this?.addComponentMessage("Manage keys","info pointer",()=>window.open("/vault","_blank"),o),l&&(await ph(this),await Qi(this))}catch{console.error("Failed to update UI for vault keys")}},"updateUIForVaultKeys");if(this.properties.template){let l=null;if(this.properties.template){l={};const m=this.properties?.template?.templateInfo?.includedSettings||[];for(let x of m)this.settings?.[x]?.type!=="button"&&(l[x]=this.settings[x],l[x].value=this.data[x]);const v=this.data._templateVars;for(let x in this.templateSettings){const C=this.templateSettings[x],w={...C,value:v[x]||C.value||""};C?.type==="composite"?l[x]=xi(w):l[x]=w}}if(Object.keys(l||{}).filter(m=>{const v=this.data?._templateVars?.[m],x=this.data?.[m],C=bt(w=>w==null||typeof w=="string"&&w.trim()==="","isEmptyValue");return C(v)&&C(x)}).length>0)this.addComponentMessage("Missing Settings","alert pointer",()=>{Ct.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});else{const m=Object.keys(l||[]).filter(C=>Cv(this.data?._templateVars?.[C]));let v=!1,x=!1;for(let C of m){const w=this.data?._templateVars?.[C],f=await this.checkVaultKeys(w,t);f?.allKeys?.size>0&&(v=!0),f?.existKeys?.size>0&&!r&&(x=!0)}i({addMockToggle:v,addManageMessage:x})}}let d=!1,c=!1;for(let l in this.settings){let m="";try{m=decodeURIComponent(this.data[l])}catch{m=this.data[l]}const v=await this.checkVaultKeys(m,t);v?.allKeys?.size>0&&(d=!0),v?.existKeys?.size>0&&!r&&(c=!0)}i({addMockToggle:d,addManageMessage:c});for(let l in this.settings){let m="";try{m=decodeURI(this.data[l])}catch{m=this.data[l]}const v=/{{INFO\:([^}]*)}}/g;let x;for(;(x=v.exec(m))!==null;){const C=x[1];this.addComponentMessage(C,"warning pointer",()=>{window.open("/vault","_blank")})}}}async checkVaultKeys(e="",t){const s=/{{KEY\(([^}]*)\)}}/g;let a=[],o;for(;(o=s.exec(e))!==null;)o[1]&&a.push(o[1]);const r=new Set(a),i=new Set,d=new Set;for(let c of a)if(c&&t.find(l=>l.name===c||l.name===c.replace(/\+/g," ")))console.log("Vault Key Found",c),i.add(c);else{if(console.log("Vault Key Missing",c),d.add(c),this.hasComponentMessage(`.${po(c)}`))continue;this.addComponentMessage(`Missing Key "${c}"`,"alert pointer",()=>{Ct.track("app_component_alert_click",{type:"missing key"}),wm.bind(this,c)()},po(c))}return{allKeys:r,existKeys:i,missingKeys:d}}async save(e){return this.checkSettings(),setTimeout(async()=>{this.checkSettings()},1e3),!0}destroy(){this._destroyed=!0,this.domElement.remove()}getSettingsSidebar(){return Qs.curComponentSettings!==this?null:document.querySelector("#right-sidebar")}async deleteEndpoint(e){this.workspace.jsPlumbInstance.deleteEndpoint(e.endpoint),e.classList.contains("input-endpoint")&&(this.properties.inputs=this.properties.inputs.filter(t=>t!==e.getAttribute("smt-name")),this.properties.inputProps=this.properties.inputProps.filter(t=>t.name!==e.getAttribute("smt-name"))),e.classList.contains("output-endpoint")&&(this.properties.outputs=this.properties.outputs.filter(t=>t!==e.getAttribute("smt-name")),this.properties.outputProps=this.properties.outputProps.filter(t=>t.name!==e.getAttribute("smt-name"))),e.remove(),this.workspace.redraw(),this.workspace.saveAgent()}syncProps(e,t,s){const a=e==="input"?"inputs":"outputs",o=e==="input"?"inputProps":"outputProps",r=this.properties[a].findIndex(c=>c===t),i=this.properties[o],d=i.findIndex(c=>c?.name===t);if(r>=0&&d>=0){this.properties[a][r]=s.name;const c=i.find(l=>l?.name===t);this.properties[o][d]={...c,...s}}}inputNameExists(e){return!!this.inputContainer.querySelector(`.input-endpoint[smt-name="${e}"]`)}outputNameExists(e){return!!this.outputContainer.querySelector(`.output-endpoint[smt-name="${e}"]`)}parseOutputProp(e,t,s){if(!this.outputSettings[t])return;const a=this.properties.outputProps?.find(r=>r.name===e),o=this.outputSettings[t];switch(o?.type){case"string":return a?.[t]||o?.default||s;case"number":return a?.[t]||o?.default||s;case"boolean":return a?.[t]||o?.default||s}}async addOutput(e,t,s={},a={}){if(this.outputNameExists(t)){Je(`${t} already exists`);return}const o=this.workspace.jsPlumbInstance,r=document.createElement("div");r.className=`smyth endpoint output-endpoint ${this.constructor.name}`,r.setAttribute("smt-name",t);const i=this.properties.outputProps?.find(k=>k.name===t),d=i?.color||`${Tt.conStartColor}`;r.setAttribute("smt-color",d);for(let k in this.outputSettings)r.setAttribute(`smt-${k}`,this.parseOutputProp(t,k,""));for(let k in s)this.inputSettings[k]&&r.setAttribute(`smt-${k}`,s[k]);for(let k in s)this.outputSettings[k]&&r.setAttribute(`smt-${k}`,s[k]);Object.keys(s)?.length>0&&this.properties.outputs.push(t),e.appendChild(r),await $e(50);const c=o.addEndpoint(r,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:this.drawSettings.outputMaxConnections,cssClass:"exclude-panzoom"}),l=document.createElement("span");l.className="name",l.innerHTML=`<span class="label">${t}</span>`,r.appendChild(l);const m=this.properties.defaultOutputs.includes(t),v=!this.templateEditing&&this.properties.template?.outputs?.find(k=>k.name==t),x=document.createElement("button");x.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",x.innerHTML='<span class="icon mif-pencil"></span>',x.setAttribute("rel",r.id),x.addEventListener("click",async k=>{k.stopPropagation();let F=!0;if(a.onEditBtnClick&&(F=await a.onEditBtnClick(k),F===!1))return;k.stopImmediatePropagation();const O=r.getAttribute("smt-name"),_=!this.templateEditing&&this.properties.template?.outputs?.find(z=>z.name==O),M=r.getAttribute("smt-color")||`${Tt.conStartColor}`,b={name:{label:"Output Name",type:"text",class:"stg-output stg-name",value:O,readonly:m||_,validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:Ya(M)};for(let z in this.outputSettings){const I=this.outputSettings[z];if(I){let W=r.getAttribute(`smt-${z}`);W==="true"&&(W=!0),W==="false"&&(W=!1),b[z]={...I.editConfig,value:W},I.allowDefaultEdit||(b[z].readonly=m||_,b[z].class+=m||_?" hidden":"")}}b?.description&&(b.description.section="Advanced_Options");const P=this.constructor.name===sn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Output</span>':'<span class="text-xl">Edit Output</span>',L=Ka(b,["description","expression","additionalOptionsLabel","color"]),N=await this.inputEditor({title:P,fields:L,onDOMReady:z=>{const I=z.querySelector("#name"),W=z.querySelector(".agent-skill-dialog-title"),B=document.querySelector("#add-skill-input-info-icon");W&&B&&(B.classList.remove("hidden"),W.appendChild(B)),$e(50).then(()=>Si(I))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(N){if(N.name!=O){if(this.outputNameExists(N.name)){Je(`${N.name} already used`);return}r.setAttribute("smt-name",N.name),r.querySelector(".name").innerHTML=N.name,this.emit("endpointChanged","name",r,O,N.name)}if(r&&N.color!=M){r.setAttribute("smt-color",N.color),r.querySelector(".ep").style.backgroundColor=N.color||`${Tt.conStartColor}`,r.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${N.color}) 1`;const z=r.endpoint;if(z&&z.connections)for(let I of z.connections)this.workspace.updateConnectionColors(I);this.emit("endpointChanged","color",r,M,N.color)}for(let z in this.outputSettings){const I=this.outputSettings[z];if(r&&I){const W=r.getAttribute(`smt-${z}`);N[z]!==W&&N[z]!=null&&(r.setAttribute(`smt-${z}`,N[z]),this.emit("endpointChanged",z,r,W,N[z]))}}this.syncProps("output",O,N),this.workspace.saveAgent()}});const C=document.createElement("button");C.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",C.innerHTML='<span class="icon mif-bin"></span>',C.setAttribute("rel",r.id),C.addEventListener("click",async k=>{const F=r.getAttribute("smt-name"),O=!this.templateEditing&&this.properties.template?.outputs?.find(_=>_.name==F);if(!(m||O))return k.stopPropagation(),k.stopImmediatePropagation(),await En("Deleting Output. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})?this.deleteEndpoint(r):!1}),!m&&v&&C.setAttribute("templateEditable","true"),r.appendChild(C),C.classList.add("hidden"),!m&&!v?C.classList.remove("hidden"):r.classList.add("default"),r.appendChild(x);const w=document.createElement("button");w.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",w.innerHTML='<span class="icon mif-arrow-up"></span>',w.addEventListener("click",async k=>{k.stopPropagation(),r.parentElement.insertBefore(r,r.previousSibling),this.repaint(),this.workspace.saveAgent()}),r.appendChild(w);const f=document.createElement("button");f.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",f.innerHTML='<span class="icon mif-arrow-down"></span>',f.addEventListener("click",async k=>{k.stopPropagation(),r?.parentElement?.insertBefore(r?.nextSibling,r),this.repaint(),this.workspace.saveAgent()}),r.appendChild(f);const T=document.createElement("span");T.className=`ep ep-Output ep-${t}`,T.innerHTML=" ",T.style.backgroundColor=i?.color||`${Tt.conStartColor}`,r.appendChild(T),r.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${d}) 1`;for(let k of c.connections)this.workspace.updateConnectionColors(k);return r.endpoint=c,c._domElement=r,!i&&s.name&&(s.default||(s.default=!1),this.properties.outputProps.push(s)),this.emit("endpointAdded",t,r),this.workspace.saveAgent(),r}setTemplateEditMode(){this.templateEditing=!0,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(e=>e.classList.remove("hidden"))}unsetTemplateEditMode(){this.templateEditing=!1,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(e=>e.classList.add("hidden"))}parseInputProp(e,t,s){if(!this.inputSettings[t])return;const a=this.properties.inputProps?.find(r=>r.name===e),o=this.inputSettings[t];switch(o?.type){case"string":return a?.[t]||o?.default||s;case"number":return a?.[t]||o?.default||s;case"boolean":return a?.[t]||o?.default||s}}async addInput(e,t,s={}){if(this.inputNameExists(t)){Je(`${t} already exists`);return}const a=this.workspace.jsPlumbInstance,o=document.createElement("div");o.className=`smyth endpoint input-endpoint ${this.constructor.name}`,o.setAttribute("smt-name",t);const r=this.properties.inputProps?.find(f=>f.name===t);o.setAttribute("smt-optional",r?.optional||"false"),o.setAttribute("smt-color",r?.color||`${Tt.conEndColor}`),o.setAttribute("smt-type",r?.type||"Any"),o.setAttribute("smt-friendly-input-type",r?.friendlyInputType||""),o.setAttribute("smt-core-input-type",r?.coreInputType||""),r?.optional?o.classList.add("optional"):o.classList.remove("optional");for(let f in this.inputSettings)o.setAttribute(`smt-${f}`,this.parseInputProp(t,f,""));for(let f in s)this.inputSettings[f]&&o.setAttribute(`smt-${f}`,s[f]);Object.keys(s)?.length>0&&this.properties.inputs.push(t),e.appendChild(o),await $e(50);const i=a.addEndpoint(o,{paintStyle:{fill:"transparent"},endpoint:["Dot",{radius:10}],anchor:["Left",{dx:40}],isTarget:!0,maxConnections:this.drawSettings.inputMaxConnections,cssClass:"exclude-panzoom"});i._listeners.mouseup||(i._listeners.mouseup=[]),i._listeners.mouseup.push(()=>{if(this.workspace._draggingConnection){const f=this.workspace._draggingConnection.source.endpoint;if(f.connections.find(T=>T.endpoints.includes(i)))return;this.workspace.jsPlumbInstance.connect({source:f,target:i,cssClass:"exclude-panzoom"}),this.workspace.jsPlumbInstance.deleteConnection(this.workspace._draggingConnection)}document.querySelectorAll(".endpoint.active").forEach(f=>f.classList.remove("active"))});const d=document.createElement("span");d.className=`ep ep-Input ep-${t}`,d.innerHTML=" ",d.style.backgroundColor=r?.color||`${Tt.conEndColor}`,o.appendChild(d);const c=document.createElement("span");c.className="name",c.innerHTML=t,o.appendChild(c);const l=this.properties.defaultInputs.includes(t),m=!this.templateEditing&&this.properties.template?.inputs?.find(f=>f.name==t),v=document.createElement("button");v.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",v.innerHTML='<span class="icon mif-pencil"></span>',v.setAttribute("rel",o.id),v.addEventListener("click",async f=>{f.stopPropagation();const T=o.getAttribute("smt-name"),k=this.properties.inputProps?.find(q=>q.name===T),F=!this.templateEditing&&this.properties.template?.inputs?.find(q=>q.name==T),O=o.getAttribute("smt-optional")=="true",_=o.getAttribute("smt-color")||`${Tt.conEndColor}`;let M=o.getAttribute("smt-type")&&o.getAttribute("smt-type")!=="undefined"?o.getAttribute("smt-type"):"",b=o.getAttribute("smt-friendly-input-type")||"",P=o.getAttribute("smt-core-input-type")||"";M&&!b&&(b="Others",P=M);const L=o.getAttribute("smt-isfile")=="true";let N=!1;L&&(N=!0,M="Binary");const z=l||F,I={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:T,readonly:l||F,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores."}};if(!z){const q=kl({compName:this.constructor.name,values:{friendlyInputType:b,coreInputType:k?.type||P,type:k?.type||M}});q?.friendlyInputType&&(I.friendlyInputType=q.friendlyInputType),q?.coreInputType&&(I.coreInputType=q.coreInputType),q?.type&&(I.type=q.type)}I.additionalOptionsLabel={type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},I.optional=El(O,l||F),I.color=Ya(_);for(let q in this.inputSettings){const X=this.inputSettings[q];if(X){let Q=o.getAttribute(`smt-${q}`);Q==="true"&&(Q=!0),Q==="false"&&(Q=!1),I[q]={...X.editConfig,value:Q},X.allowDefaultEdit||(I[q].readonly=l||F,I[q].class+=l||F?" hidden":"")}}const W=this.constructor.name===sn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Input</span>':'<span class="text-xl">Edit Input</span>';I?.description&&(I.description.section="Advanced_Options");const B=Ka(I,["name","type","description","additionalOptionsLabel","optional","color"]),K=await this.inputEditor({title:W,fields:B,onDOMReady:q=>{const X=q.querySelector("#name"),Q=q.querySelector(".agent-skill-dialog-title"),V=document.querySelector("#add-skill-input-info-icon");Q&&V&&(V.classList.remove("hidden"),Q.appendChild(V)),$e(50).then(()=>Si(X))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(K){if(K.name!==T){if(this.inputNameExists(K.name)){Je(`${K.name} already used`);return}o.setAttribute("smt-name",K.name),o.querySelector(".name").innerHTML=K.name,this.emit("endpointChanged","name",o,T,K.name)}if(K.optional!==O&&(o.setAttribute("smt-optional",K.optional),K.optional?o.classList.add("optional"):o.classList.remove("optional"),this.emit("endpointChanged","optional",o,O,K.optional)),o&&K.color!==_){o.setAttribute("smt-color",K.color),o.querySelector(".ep").style.backgroundColor=K.color||`${Tt.conEndColor}`,o.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${K.color}) 1`;const q=o.endpoint;if(q&&q.connections)for(let X of q.connections)this.workspace.updateConnectionColors(X);this.emit("endpointChanged","color",o,_,K.color)}K.type||(K.type="Any"),(o&&K.type!==M||N)&&(o.setAttribute("smt-type",K.type),this.emit("endpointChanged","type",o,M,K.type)),o?.setAttribute("smt-friendly-input-type",K?.friendlyInputType||""),o?.setAttribute("smt-core-input-type",K?.coreInputType||"");for(let q in this.inputSettings){const X=this.inputSettings[q];if(o&&X){const Q=o.getAttribute(`smt-${q}`);K[q]!==Q&&K[q]!=null&&(o.setAttribute(`smt-${q}`,K[q]),this.emit("endpointChanged",q,o,Q,K[q]))}}this.syncProps("input",T,K),this.workspace.saveAgent()}});const x=document.createElement("button");x.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",x.innerHTML='<span class="icon mif-bin"></span>',x.setAttribute("rel",o.id),x.addEventListener("click",async f=>{const T=o.getAttribute("smt-name"),k=!this.templateEditing&&this.properties.template?.inputs?.find(F=>F.name==T);if(!(l||k)){if(f.stopPropagation(),f.stopImmediatePropagation(),await En("Deleting Input. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){this.deleteEndpoint(o);const F=o.getAttribute("smt-name");return this.emit("endpointRemoved",F,o),!0}return!1}}),!l&&m&&x.setAttribute("templateEditable","true"),o.appendChild(x),x.classList.add("hidden"),!l&&!m?x.classList.remove("hidden"):o.classList.add("default"),o.appendChild(v);const C=document.createElement("button");C.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",C.innerHTML='<span class="icon mif-arrow-up"></span>',C.addEventListener("click",async f=>{f.stopPropagation(),o.parentElement.insertBefore(o,o.previousSibling),this.repaint(),this.workspace.saveAgent()}),o.appendChild(C);const w=document.createElement("button");w.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",w.innerHTML='<span class="icon mif-arrow-down"></span>',w.addEventListener("click",async f=>{f.stopPropagation(),o.parentElement.insertBefore(o.nextSibling,o),this.repaint(),this.workspace.saveAgent()}),o.appendChild(w);for(let f of i.connections)this.workspace.updateConnectionColors(f);return o.endpoint=i,i._domElement=o,!r&&s.name&&(s.default||(s.default=!1),this.properties.inputProps.push(s)),this.emit("endpointAdded",t,o),this.workspace.saveAgent(),o}refreshSettingsSidebar(){this.settingsOpen&&this.editSettings()}parseTemplateString(e,t){let s=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm,a=/{{([A-Z]+):([\w\s]+):(\{.*?\})}}/gm;const o=e.matchAll(s),r=e.matchAll(a),i=[...o,...r];for(const d of i){const c={"data-template-vars":"false"};let l=d[1].toUpperCase();const m=`${l}-${Dn()}`;l.startsWith("VAR")&&(l=l.replace("VAR",""),c["data-template-vars"]="true"),l.startsWith("VAULT")&&(l=l.replace("VAULT",""),c["data-vault"]=`${this.constructor.name},All`);const v=d[2];let x,C;if(d[3].trim().startsWith("{")&&d[3].trim().endsWith("}"))try{C=JSON.parse(d[3])}catch{}if(!C)try{const T=JSON.parse(`[${d[3]||""}]`);T.length>1?(x=T.map(k=>({text:k,value:k})),x.unshift({text:" ",value:""})):x=T}catch{x=[]}let w=x?.[0]||"",f={};switch(l){case"KVJSON":w=JSON.stringify(C,null,2);break;default:f=C}t[m]={id:m,type:l,label:v,value:w,options:x,attributes:c,_templateEntry:!0,...f},e=e.replace(d[0],`{{${m}}}`)}return e}parseCompositeTemplateString(e,t){let s=JSON.parse(e||"{}")||{};const a=Array.isArray(s);s=a?s[0]:s;for(let o in s){let r=s[o];typeof r=="object"&&r!==null?(r=this.parseCompositeTemplateString(JSON.stringify(r),t),r=JSON.parse(r)):typeof r=="string"&&(r=this.parseTemplateString(r,t)),s[o]=r}return JSON.stringify(a?[s]:s)}normalizeTemplateSettings(e){}async editSettings(){return hm(this)}async confirmSaveSettings(){if(this.settingsChanged()&&await En("Settings Changed","You have unsaved changes. Are you sure you want to discard your changes?",{btnNoLabel:"Discard Changes",btnYesLabel:"Save Changes"})){const e=document.querySelector("#right-sidebar form"),t=wi(e,this.settingsEntries);if(!await this.save(t)){Je("Error saving settings");return}if(this.properties.template){const s=this.data._templateVars,a=this.templateSettings,o=this.properties?.template?.templateInfo?.includedSettings||[];for(let r of o)this.data[r]=t[r];for(let r in a)s[r]=t[r]}else for(let s in this.settings)this.data[s]=t[s];return console.log("new settings",t),this.emit("settingsSaved",t),!0}return!1}settingsChanged(){if(!this.settingsOpen)return!1;const e=this.settingsEntries,t=document.querySelector("#right-sidebar form.Settings");if(!t)return!1;const s=wi(t,e);if(console.log("settingsChanged()",s,e),this.properties.template){const a=this.data._templateVars;for(let o in e)if(a[o]!==void 0&&a[o]!=s[o])return!0}else for(let a in e)if(this.data[a]!==void 0&&this.data[a]!=s[a])return!0}async closeSettings(e=!1){return pm(this,e)}showOverlay(e){this.overlay.querySelector(".content").innerHTML=e,this.overlay.style.display="block"}hideOverlay(){this.overlay.querySelector(".content").innerHTML="",this.overlay.style.display="none"}hasComponentMessage(e){return this.domElement.querySelector(e)!==null}hasComponentButton(e){return this.domElement.querySelector(e)!==null}clearComponentMessage(e){const t=this.domElement.querySelector(e);t&&t.remove()}clearComponentMessages(){this.domElement.querySelector(".messages-container").innerHTML=""}addComponentMessage(e,t="info",s,a){const o=document.createElement("div");return o.className=`message ${t} ${a}`,o.innerHTML=typeof e=="string"?e:e.text,s&&(o.style.cursor="pointer",o.addEventListener("click",s)),this.domElement.querySelector(".messages-container").appendChild(o),o}addComponentButton(e,t="info",s,a){const o=document.createElement("div");o.className=`message ${t} flex flex-wrap justify-center items-center p-2`,o.id="component-button";const r=document.createElement("button"),i={primary:"flex flex-row w-full items-center content-center text-xs justify-start gap-1 h-sm px-2 py-1 rounded-xl text-white bg-blue-500 pointer active:text-gray-100 active:bg-blue-600 active:ring-0",secondary:"flex flex-row w-full items-center justify-center text-xs gap-1 h-sm px-2 py-2 rounded-md text-[#3C89F9] border-[#3C89F9] bg-transparent pointer border-2 ",toggle:"flex flex-row w-full items-center justify-start text-xs gap-1 h-sm px-1 rounded-md bg-transparent pointer"};if(r.className=i[s?.customStyle]||i.primary,r.innerHTML=e,s)for(let d in s)d=="class"?r.className+=` ${s[d]}`:r.setAttribute(d,s[d]);return a&&(r.onclick=a),o.appendChild(r),s?.position==="top"?this.domElement.querySelector(".messages-container").prepend(o):this.domElement.querySelector(".messages-container").appendChild(o),o}redraw(e=!0){this.workspace.jsPlumbInstance;const t=this.workspace,s=this,a=this.properties.outputs||[],o=this.properties.inputs||[],r=document.createElement("div");r.className=`component exclude-panzoom group ${this.drawSettings.cssClass||""}`,r.id=`${this._uid}`,r.style.left=this.properties.left||"20px",r.style.top=this.properties.top||"20px",this.properties.width&&(r.style.width=this.properties.width),this.properties.height&&(r.style.height=this.properties.height),r.classList.add(this.constructor.name);const i=document.createElement("div");i.className="internal-name";const d=this.properties.template?.templateInfo?.name||this.properties.template?.name||this.drawSettings.displayName||this.constructor.name;this.displayName=d,this.properties.template?.templateInfo?.description||this.properties.template?.shortDescription||this.drawSettings.shortDescription||this.drawSettings.componentDescription,i.innerHTML=this.properties.template?"T:"+d:d,r.appendChild(i);const c=document.createElement("div");c.className="title-bar";const l=this.drawSettings.iconCSSClass||"";if(l.startsWith("<svg")){const V=this.drawSettings.color||"#000",J=l.replace(/<path/g,"<path ");c.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
          <span class="icon w-6 h-6">${J}</span>
          <span class="title">${this.title}</span>
        </div>
        <span class="description">${this.description}</span>
      `;const A=c.querySelectorAll("path");[...A].find(j=>j.getAttribute("fill")&&j.getAttribute("fill")!=="none")||A.forEach(j=>j.setAttribute("fill",V))}else c.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
        <span class="icon ${l} h-full"></span>
        <span class="title font-semibold">${this.title}</span>
      </div>
      <span class="description">${this.description}</span>
      `;c.setAttribute("smt-name",this.constructor.name);const m=c.querySelector(".title"),v=c.querySelector(".description");m.style.cursor="default",v.style.cursor="default",r.appendChild(c),setTimeout(()=>{this.addDebugButton()},500);const x=bt((V,J)=>{const A=V.target;if(A instanceof HTMLElement){if(A.hasAttribute("contenteditable")){V.stopPropagation();return}!V.ctrlKey&&!V.metaKey&&(this.workspace.refreshComponentSelection(),Q(V)),J.classList.toggle("selected"),J.classList.remove("unselected"),document.querySelectorAll("#workspace-container .component:not(.selected)").forEach(j=>j.classList.add("unselected")),Da()}},"handleComponentElementClick");m.addEventListener("click",V=>x(V,r)),v.addEventListener("click",V=>x(V,r)),setTimeout(()=>{Pc(m,{callback:V=>{V||(V=d||""),m.querySelector(".text").textContent=V,this.title=V,this.aiTitle="",this.workspace.saveAgent()},editOnClick:!1,showButtons:!0}),Pc(v,{callback:V=>{V||(V=""),v.querySelector(".text").textContent=V,this.description=V,this.workspace.saveAgent()},editOnClick:!1,showButtons:!0})},500),setTimeout(()=>{const V=m.querySelector(".text");V&&V.classList.add("truncate")},550);const C=document.createElement("div");C.className=`debug-bar cursor-pointer px-[10px] mx-auto text-white variant_2 rounded-lg ${this.isFunctionalComponent()?"mt-[10px]":""}`,r.appendChild(C),C.addEventListener("click",V=>{V.stopPropagation(),V.stopImmediatePropagation(),this.workspace.refreshComponentSelection(r)});const w=document.createElement("div");w.className="debug-info hidden",C.appendChild(w);const f=document.createElement("button");f.innerHTML='<span class="mif-search icon"></span> Log',f.className="btn-debug-log button primary mini outline hidden",f.onclick=V=>{V.stopPropagation(),V.stopImmediatePropagation(),this.workspace.refreshComponentSelection(r);const J=this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"]`);if(J?.classList?.toggle("hidden"),J.classList.contains("hidden"))J._connection.canvas.classList.add("hidden");else{if(!J._connection&&!J.classList.contains("hidden")){const A=t.jsPlumbInstance.connect({source:J.querySelector("h2"),target:C,detachable:!1,cssClass:"exclude-panzoom z-100",anchors:["Continuous","Left"]});A.setPaintStyle({stroke:"#7d7c96",strokeWidth:1,dashstyle:"4 3"}),A.removeAllOverlays(),A.endpoints[0]._domElement=J,A.endpoints[1]._domElement=C,J._connection=A}J._connection.canvas.classList.remove("hidden")}},C.appendChild(f);const T=document.createElement("button");T.innerHTML=' <i class="fa-solid fa-wand-magic-sparkles"></i> Fix with AI',T.className="btn-fix-with-ai button primary mini outline hidden",T.onclick=async V=>{if(V.stopPropagation(),this.workspace.refreshComponentSelection(r),!document.getElementById("builder-button")){Je("Agent Weaver is not enabled");return}document.getElementById("agentMessageInput"),document.getElementById("agentSendButton"),this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"] .dbg-log`)?.textContent;const J=T.getAttribute("data-error")||"",A=this.domElement.querySelectorAll(".input-container .endpoint");let j="";for(let U of A){const G=U.querySelector("span.name").innerText,Y=U.querySelector("div.dbg-output textarea.dbg");let se=Y?Y?.value:"",le;try{le=vm(se),le=uo(le),Array.isArray(le)&&le.length>3&&(le=le.slice(0,3),le.push("...(truncated to 3 items)")),j+=`${G}: ${JSON.stringify(le)}
`,j=j.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}catch{se.length>300&&(se=se.substring(0,300)+"...(long content truncated)"),j+=`${G}: ${se}
`}}j&&(j=`===
Received Inputs:
${j}

`);const S=`Component With ID=${this._uid} has a runtime error:
      ${J.substring(0,500)}

      ${j}
      ####

      
Please fix the issue, or explain it if you can't fix it`;console.log("Weaver Error fix prompt: ",S),Ik({weaverPrompt:S,componentId:this._uid})},C.appendChild(T);const k=document.createElement("div");if(k.className="ep-control inputs px-2",k.innerHTML=`<span>${this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton}</span>`,r.appendChild(k),this.drawSettings.addInputButton){const V=document.createElement("button");V.innerHTML="+",k.innerHTML="",V.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",k.appendChild(V);const J=document.createElement("span");J.innerHTML=this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton,k.appendChild(J),V.onclick=A=>{A.stopPropagation(),A.stopImmediatePropagation(),this.addInputDialog()}}const F=document.createElement("div");F.className="input-container",r.appendChild(F);const O=document.createElement("div");if(O.className="ep-control outputs px-2",O.innerHTML=`<span>${this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton}</span>`,r.appendChild(O),this.drawSettings.addOutputButton){const V=document.createElement("button");V.innerHTML="+",O.innerHTML="",V.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",O.appendChild(V);const J=document.createElement("span");J.innerHTML=this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton,O.appendChild(J),V.onclick=A=>{A.stopPropagation(),A.stopImmediatePropagation(),this.addOutputDialog()}}const _=document.createElement("div");_.className="output-container",r.appendChild(_);const M=document.createElement("div");M.className="button-container messages-container",M.addEventListener("click",V=>{V.stopPropagation()}),r.appendChild(M);const b=document.createElement("div");b.className="right-side-button-container absolute right-0 flex transition-opacity opacity-0 group-hover:opacity-100";const P=document.createElement("button");P.className="w-6 h-6 rounded del-btn relative group/delete",P.innerHTML='<i class="fas fa-trash text-[#757575] text-xs hover:text-[#aaa]"></i>',P.onclick=V=>{V.stopPropagation(),s.delete(!1)};const L=document.createElement("div");L.className="absolute left-[-20px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/delete:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",L.innerText="Delete",P.appendChild(L),b.appendChild(P);const N=s.properties?.template?.templateInfo?.docPath||"/not-set",z=s.properties?.template?s.workspace.serverData.docUrl+N:s.docUrl,I=document.createElement("button");I.className="w-6 h-6 rounded action-help relative group/help",I.innerHTML='<span class="font-bold text-lg text-[#757575] hover:text-[#aaa]">?</span>',I.onclick=V=>{V.stopPropagation(),window.open(z,"_blank")},s.properties?.template&&!s.properties?.template?.templateInfo?.docPath&&I.classList.add("hidden");const W=document.createElement("div");W.className="absolute left-[-15px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/help:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",W.innerText="Help",I.appendChild(W),b.appendChild(I);const B=document.createElement("button");B.className="w-6 h-6 rounded relative group/settings",B.innerHTML='<i class="fas fa-cog text-[#757575] text-xs hover:text-[#aaa]"></i>';const K=document.createElement("div");K.className="absolute left-[-25px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/settings:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",this.drawSettings?.showSettings!==!1&&b.appendChild(B),K.innerText="Settings",B.appendChild(K),b.appendChild(B),r.appendChild(b);const q=document.createElement("div");q.className="loading-icon",q.innerHTML=`
      <svg
        aria-hidden="true"
        class="inline text-gray-200 animate-spin dark:text-gray-600 fill-primary-100 w-8 h-8"
        viewBox="0 0 100 101"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
          fill="currentColor"
        />
        <path
          d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
          fill="currentFill"
        />
      </svg>
    `,q.classList.add("hidden"),r.appendChild(q);const X=document.createElement("div");X.className="cpt-overlay",X.innerHTML=`<div class="content"></div><span class="dbg-loader"><svg height="48px" width="64px">
    <polyline id="front" points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24"></polyline>
  </svg></span>`,r.appendChild(X),X.style.display="none";const Q=bt(async V=>{this.domElement.classList.contains("dragging")||this.domElement.classList.contains("resizing")||m.hasAttribute("contenteditable")&&V.target==m||v.hasAttribute("contenteditable")&&V.target==v||V.target?.classList?.contains("dbg")||!r.querySelector(".debug-info").classList.contains("hidden")||[...r.querySelectorAll(".dbg-element")].filter(J=>J.checkVisibility?.()).length>0||(Qs.curComponentSettings&&Qs.curComponentSettings!==this&&await Qs.curComponentSettings.confirmSaveSettings(),this.settingsOpen?this.closeSettings():this.editSettings())},"openSettingsSidebar");return r.addEventListener("click",V=>{if(V.target!==B){!V.ctrlKey&&!V.metaKey&&(this.workspace.refreshComponentSelection(),Q(V)),this.domElement.classList.toggle("selected"),this.domElement.classList.remove("unselected");const J=document.querySelectorAll("#workspace-container .component:not(.selected)");for(let A of J)A.classList.add("unselected");Da()}}),B.addEventListener("click",V=>{V.stopPropagation(),Q(V),this.workspace.refreshComponentSelection(this.domElement)}),this.inputContainer=F,this.outputContainer=_,this.buttonContainer=M,this.overlay=X,this.loadingIcon=q,a.forEach((V,J)=>{this.addOutput(_,V)}),o.forEach((V,J)=>{this.addInput(F,V)}),Qn(r).draggable({allowFrom:".component",ignoreFrom:".dbg-element,.debug-info",listeners:{start(V){if(t?.locked)return!1;s.domElement.classList.add("dragging"),s.domElement.style.cursor="grabbing"},move(V){if(t?.locked)return!1;if(!V.target)return;let J=[V.target];V.target.classList.contains("selected")?J=[...document.querySelectorAll(".component.selected")]:document.querySelectorAll(".component.selected").forEach(A=>A.classList.remove("selected"));for(let A of J){const j=(parseFloat(A.style.left)||0)+V.dx/t.scale,S=(parseFloat(A.style.top)||0)+V.dy/t.scale;A.style.left=j+"px",A.style.top=S+"px",A._control.repaint()}},end(V){if(t?.locked)return!1;s.repaint(!0),s.domElement.style.cursor="",setTimeout(()=>{s.workspace.saveAgent(),s.domElement.classList.remove("dragging")},200)}},modifiers:[],inertia:!0}).styleCursor(!1),$(c.querySelector(".svg-icon")).css("background-color","#000"),$(c.querySelector(".tpl-fa-icon")).css("color",this.drawSettings.color),this.domElement=r,this.workspace.domElement.appendChild(r),r.addEventListener("mousedown",function(V){V.stopPropagation()}),r.addEventListener("click",function(V){V.stopPropagation()}),Qn(r).resizable({edges:{left:!1,right:!0,bottom:!1,top:!1},listeners:{start(V){if(t?.locked||[...s.domElement.querySelectorAll(".pinned")].length>0)return!1;s.domElement.classList.add("resizing")},move(V){if(t?.locked||[...s.domElement.querySelectorAll(".pinned")].length>0)return!1;const J=V.target;J.style.width=V.rect.width/t.scale+"px",s.repaint()},end(V){if(t?.locked||[...s.domElement.querySelectorAll(".pinned")].length>0)return!1;s.repaint(),setTimeout(()=>{s.workspace.saveAgent(),s.domElement.classList.remove("resizing")},200)}},modifiers:[Qn.modifiers.restrictSize({min:{width:100,height:50}})],inertia:!1}),r._control=this,this.checkSettings(),e&&(setTimeout(()=>{this.workspace.saveAgent()},300),!this.properties.template&&this.drawSettings.showSettings&&this.editSettings()),this.emit("componentCreated",this),r}async delete(e=!0,t=!0){const s=this.workspace.jsPlumbInstance,a=this.domElement;if(e||await En("Are you sure you want to delete this component?","This action cannot be undone. Deleting will remove the component permanently.",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){if(this.settingsOpen&&this.closeSettings(!0),this.showOverlay("Deleting..."),this.emit("beforeDelete",this),!await this.clean()){this.hideOverlay();return}const o=[...a.querySelectorAll(".output-endpoint"),...a.querySelectorAll(".input-endpoint"),...a.querySelectorAll(".agent-card-connection")].map(d=>s.getEndpoints(d)).flat(),r=[];for(let d of o)r.push(d);r.forEach(d=>s.deleteEndpoint(d)),this.destroy();const i=document.querySelector(`.debug-box[rel="${this.uid}"]`);if(i){const d=i._connection;d&&s.deleteConnection(d),i.remove()}document.querySelectorAll(".component").forEach(d=>d.classList.remove("selected","unselected")),delete Cl[this.uid],t&&this.workspace.saveAgent(),this.hideOverlay()}}async addInputDialog(){const e={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:"",required:!0,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores.",attributes:{placeholder:"E.g. Username"}},...kl({compName:this.constructor.name,values:{type:"Any"}}),additionalOptionsLabel:{type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:Ya(`${Tt.conEndColor}`),optional:El()};for(let o in this.inputSettings){const r=this.inputSettings[o];r&&(e[o]={...r.editConfig,value:r.editConfig?.defaultVal||""})}const t=this.constructor.name===sn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Input</span>':'<span class="text-xl">Add Input</span>';e?.description&&(e.description.section="Advanced_Options");const s=Ka(e,["name","type","description","additionalOptionsLabel","optional","color"]),a=await this.inputEditor({title:t,fields:s,onDOMReady:o=>{const r=o.querySelector("#name"),i=o.querySelector(".agent-skill-dialog-title"),d=document.querySelector("#add-skill-input-info-icon");i&&d&&(d.classList.remove("hidden"),i.appendChild(d)),$e(50).then(()=>Si(r))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(a?.name){const o=await this.addInput(this.inputContainer,a.name,a);if(a.optional&&(o.setAttribute("smt-optional",a.optional),a.optional?o.classList.add("optional"):o.classList.remove("optional")),o&&a.color){o.setAttribute("smt-color",a.color),o.querySelector(".ep").style.backgroundColor=a.color||`${Tt.conEndColor}`,o.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${a.color}) 1`;const r=o.endpoint;if(r&&r.connections)for(let i of r.connections)this.workspace.updateConnectionColors(i)}o?.setAttribute("smt-type",a?.type||""),o?.setAttribute("smt-friendly-input-type",a?.friendlyInputType||""),o?.setAttribute("smt-core-input-type",a?.coreInputType||"");for(let r in this.inputSettings){const i=this.inputSettings[r];if(o&&i){const d=o.getAttribute(`smt-${r}`);a[r]!==d&&a[r]!=null&&o.setAttribute(`smt-${r}`,a[r])}}this.repaint(),this.workspace.saveAgent()}}async addOutputDialog(){const e={name:{type:"text",label:"Output Name",class:"stg-input stg-name",value:"",validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:Ya(`${Tt.conStartColor}`)};for(let o in this.outputSettings){const r=this.outputSettings[o];r&&(e[o]={...r.editConfig,value:r.editConfig?.defaultVal||""})}e?.description&&(e.description.section="Advanced_Options");const t=this.constructor.name===sn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Output</span>':'<span class="text-xl">Add Output</span>',s=Ka(e,["description","expression","additionalOptionsLabel","color"]),a=await this.inputEditor({title:t,fields:s,onDOMReady:o=>{const r=o.querySelector("#name"),i=o.querySelector(".agent-skill-dialog-title"),d=document.querySelector("#add-skill-input-info-icon");i&&d&&(d.classList.remove("hidden"),i.appendChild(d)),$e(50).then(()=>Si(r))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(a?.name){const o=await this.addOutput(this.outputContainer,a.name,a);if(o&&a.color){o.setAttribute("smt-color",a.color),o.querySelector(".ep").style.backgroundColor=a.color||`${Tt.conStartColor}`,o.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${a.color}) 1`;const r=o.endpoint;if(r&&r.connections)for(let i of r.connections)this.workspace.updateConnectionColors(i)}for(let r in this.outputSettings){const i=this.outputSettings[r];if(o&&i){const d=o.getAttribute(`smt-${r}`);a[r]!==d&&a[r]!=null&&o.setAttribute(`smt-${r}`,a[r])}}this.repaint()}}async openDebugDialog(e,t="step"){Ct.track("app_debug_inject_click",{}),e.stopPropagation(),e.stopImmediatePropagation();const s=this.domElement.querySelector(".btn-debug"),a=[...this.domElement.querySelectorAll(".input-endpoint")].map(r=>({name:r.getAttribute("smt-name"),type:r.getAttribute("smt-isfile")=="true"||Av.includes(r.getAttribute("smt-type"))?"file":"text"})),o=[...this.domElement.querySelectorAll(".output-endpoint")].map(r=>({name:r.getAttribute("smt-name")}));return new Promise((r,i)=>{this.workspace.debugger.createDebugInjectDialog(this,a,o,async d=>{if(this.workspace.debugger.getDebugSessionID())return null;as({step:{enable:!1},run:t==="run"?{enable:!0,icon:"mif-pause",tooltipText:"Pause"}:{enable:!1},stop:{enable:t!=="run"},attach:{enable:!1}});const c=this.workspace.agent;try{this.workspace.domElement.classList.add("debugging"),s.classList.add("active"),await this.workspace.debugger.injectComponentDebugInfo(c.id,this._uid,d);const l=await this.workspace.debugger.readDebugStep(c.id);return r({status:"success"}),l}catch(l){return l&&l?.status==413&&Je("Payload Too Large"),Je("Something went wrong, please try again later!"),i({status:"error"}),{errorOccurred:!0}}finally{eo()}},t)})}exportTemplate(){return null}export(){const e=this,t=this.domElement;return{id:t.id,name:t.querySelector(".title-bar").getAttribute("smt-name"),outputs:[...t.querySelectorAll(".output-endpoint")].map((s,a)=>({name:s.getAttribute("smt-name"),color:s.getAttribute("smt-color"),...workspace.extractComponentOutputProps(t,s),index:a,uuid:s.endpoint?.getUuid(),default:e.properties.defaultOutputs.includes(s.getAttribute("smt-name"))})),inputs:[...t.querySelectorAll(".input-endpoint")].map((s,a)=>({name:s.getAttribute("smt-name"),type:s.getAttribute("smt-type"),friendlyInputType:s.getAttribute("smt-friendly-input-type"),coreInputType:s.getAttribute("smt-core-input-type"),color:s.getAttribute("smt-color"),optional:s.getAttribute("smt-optional")==="true",...workspace.extractComponentInputProps(t,s),index:a,uuid:s.endpoint?.getUuid(),default:e.properties.defaultInputs.includes(s.getAttribute("smt-name"))})),data:typeof e.data=="object"?JSON.parse(JSON.stringify(e.data)):e.data,top:t.style.top,left:t.style.left,width:t.style.width,height:t.style.height,displayName:e.drawSettings.displayName,title:e.title,aiTitle:e.aiTitle,description:e.description,template:typeof e.properties.template=="object"?JSON.parse(JSON.stringify(e.properties.template)):e.properties.template}}async updateTitle(){const e=this.settingsEntries,t=document.querySelector("#right-sidebar form"),s=wi(t,e),a=Ev("Generating Title..."),o=this.domElement.querySelector(".title-bar .title"),r=o.querySelector(".text"),i=o.querySelector(".btn-edit-inline");r.style.display="none",i.style.display="none",o.appendChild(a);try{const d=await this.generateTitle(s?.prompt);d&&(this.aiTitle=d,r.textContent=d)}finally{a.remove(),r.style.display="inline",i.style.display="inline-flex"}}async generateTitle(e){if(!(!e||typeof e!="string"))try{const t=await(await fetch("/api/page/builder/data/generate-component-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})})).json();if(!t?.success)throw new Error("Error generating title!");return t?.data}catch{return""}}};bt(bm,"Component");let Ue=bm;function Ka(n,e){const t={...n};let s={};for(let a of e)t[a]&&(s[a]=t[a],delete t[a]);return s={...s,...t},s}u(Ka,"nt"),bt(Ka,"getOrderedValConfig");function ym({value:n="",label:e=""}){const t=[{value:"Text",text:"Text",classes:{check:"svg-icon Text border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Image",text:"Image",classes:{check:"svg-icon Image border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Audio",text:"Audio",classes:{check:"svg-icon Audio border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Video",text:"Video",classes:{check:"svg-icon Video border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Others",text:"Others",classes:{check:"svg-icon Others border-0 rounded-none w-6 h-6",caption:"text-base"}}];for(let[s,a]of t.entries())a.classes.radio=a.value===n?"active":"",t[s]=a;return $e(100).then(()=>{if(n==="Others"){const s=document.querySelector('[data-field-name="coreInputType"]'),a=document.getElementById("type");s?.classList?.remove("hidden");const o=document.getElementById("coreInputType");a&&(a.value=o?.value||"Any")}}),{type:"radio",label:e,class:"stg-input stg-type",formControlCls:"flex justify-between bg-white",fieldCls:"border border-solid border-[#D9D9D9] rounded-lg p-3 h-auto",value:n,options:t,events:{change:s=>{const a=s.target,o=a.value,r=document.querySelector('[data-field-name="coreInputType"]'),i=document.getElementById("type");if(o==="Others"){r?.classList?.remove("hidden");const c=document.getElementById("coreInputType");i&&(i.value=c?.value||"Any")}else r?.classList?.add("hidden"),i&&(i.value=o);a.closest(".form-group").querySelectorAll(".radio")?.forEach(c=>c.classList.remove("active"));const d=a.closest(".radio");d&&d.classList.add("active")}}}}u(ym,"Gt"),bt(ym,"getFriendlyInputTypeField");function Al({value:n="",label:e="",classes:t=""}){return{type:"select",class:t,label:e,value:n,options:[{value:"Any",text:"Any"},{value:"String",text:"String"},{value:"Number",text:"Number (can include floating point)"},{value:"Integer",text:"Integer (without a fraction part)"},{value:"Boolean",text:"Boolean"},{value:"Array",text:"Array"},{value:"Object",text:"Object"},{value:"Binary",text:"Binary"},{value:"Date",text:"Date (ISO 8601 Standard)"}],events:{change:s=>{const a=s.target.value,o=document.getElementById("type");o&&(o.value=a)}}}}u(Al,"yt"),bt(Al,"getCoreInputTypeField");function Ya(n=""){return{type:"color",class:"w-44 stg-input stg-color stg-circle-color-picker",value:n,section:"Advanced_Options",fieldsGroup:"additionalOptions"}}u(Ya,"st"),bt(Ya,"getColorField");function El(n=!1,e=!1){return{type:"radio",label:"",value:n,section:"Advanced_Options",class:"w-2/4 stg-input stg-optional",fieldsGroup:"additionalOptions",readonly:e,options:[{value:!1,text:"Required"},{value:!0,text:"Optional"}]}}u(El,"bt"),bt(El,"getOptionalField");function kl({compName:n,values:e}){return n===sn.apiEndpoint?{friendlyInputType:ym({value:e.friendlyInputType,label:"Input type"}),coreInputType:Al({value:e.coreInputType,classes:"w-full h-12 hidden"}),type:{type:"hidden",class:"stg-input stg-type",value:e.type,attributes:{"data-cls-option":"option-input-type"}}}:{coreInputType:Al({value:e.coreInputType,label:"Input type",classes:"w-full"}),type:{type:"hidden",class:"stg-input stg-type",value:e.type,attributes:{"data-cls-option":"option-input-type"}}}}u(kl,"St"),bt(kl,"getTypeFields");function xm({keyName:n,component:e,onSuccess:t,onError:s}){const a={keyName:{label:"Name",type:"text",class:"w-2/5",value:n,readonly:!0},apiKey:{label:"Key",type:"textarea",fieldCls:"max-h-64 min-h-[34px] h-[34px] px-3 py-1",class:"w-3/5",validate:"required maxlength=10000",validateMessage:"API Key is required",value:"",autoSize:!1,attributes:{placeholder:"Please enter your Key"}}},o="_add_missing_key_submit_btn",r="_mock_data_btn",i=bt(async(l,m)=>{const{keyName:v,apiKey:x}=l,C=Ic("white","mr-2"),w=m.querySelector(`.${o}`);w.textContent="Adding Key...",w.prepend(C),w.disabled=!0;try{const f=["All"],T=await fetch(`${kv.env.UI_SERVER}/api/page/builder/keys`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:v,key:x,scope:f})}).then(k=>k.json());ua(m),t({[T?.data?.keyId]:{name:v,scope:f}})}catch{s()}finally{C.remove(),w.disabled=!1,w.textContent="Add Key"}},"saveKey"),d={label:"Skip for now and set mock data",cssClass:`underline hover:no-underline text-gray-500 ${r}`,callback:async(l,m)=>{const v=bt(w=>(w+Math.random()).toString(36).replace(".",""),"getRandomString"),x=`sos-mock-key-${v(Date.now())}-${v(123456789)}`,C=m.querySelector("#apiKey");C.value=x,await i({...l,apiKey:x},m),Ct.track("app_mock_screen_impression",{source:"skip_and_set_mock_data"}),await Br(e),ja.turnOn(e),await Qi(e)}},c={label:"Continue",cssClass:`disabled:opacity-50 bg-v2-blue hover:bg-v2-blue/80 text-white cursor-pointer ml-auto mt-2 ${o}`,requiresValidation:!0,callback:i};No({title:"Configure API Key",fields:a,content:`<span class="text-xs text-gray-500 block mb-4">The component <span class="font-bold">${e?.title||""}</span> requires an API key to function. Please retrieve your API key from the provider and securely store it in the SmythOS vault.</span>`,actions:[d,c],onCloseClick:(l,m)=>{ua(m)},onDOMReady:async l=>{const m=l.querySelector(`.${o}`);m.classList.remove("w-[340px]"),m.classList.add("w-40");const v=l.querySelector(`.${r}`);v?.classList.remove("w-[340px]"),v?.classList.remove("text-white"),v?.classList.remove("hover:opacity-75"),v?.classList.add("auto");const x=l.querySelector(".__actions");x?.classList.remove("justify-center"),x?.classList.add("justify-between")}},"auto","auto","none","672px","672px")}u(xm,"Zt"),bt(xm,"addMissingKey");function po(n){return"_comp_message_"+n.replace(/\+/g,"_").replace(/\s+/g,"_").toLowerCase()}u(po,"rt"),bt(po,"formatKeyAsClassName");function wm(n,e){xm({keyName:n,component:this,onSuccess:t=>{$t("Key saved successfully"),this?.clearComponentMessage(`.${po(n)}`),_v(t);const s=this.workspace?.agent?.data?.components.map(a=>{const o=a.data,r=[];for(const i in o){let d=o[i];if(!d||(d=typeof d=="object"?JSON.stringify(d):d,typeof d!="string"))continue;const c=/{{KEY\(([^}]*)\)}}/g;let l;for(;(l=c.exec(d))!==null;)if(l[1]){const m=l[1];(m===n||m.replace(/\+/g," ")===n)&&r.push({id:a.id,keyName:m})}}return r}).flat(1/0).filter(a=>a.id);s.length>0&&s.forEach(async({id:a,keyName:o})=>{await Cl[a]?.checkSettings()})},onError:()=>{Je("Error saving key, please try again or contact support.")}})}u(wm,"Xt"),bt(wm,"missingKeyMessageClickHandler");var Tk=Object.defineProperty,dt=u((n,e)=>Tk(n,"name",{value:e,configurable:!0}),"m");let ot;function Sm(){Or({rootID:"agent-settings-root"})}u(Sm,"Q"),dt(Sm,"setupAgentSettingsScripts");async function Cm(n){ot=n,Lm(),Dm(),await km(),_m(),Sm()}u(Cm,"setupAgentScripts"),dt(Cm,"setupAgentScripts");function Am(){return new Promise((n,e)=>{let t=10;const s=setInterval(()=>{ot.serverData.docUrl&&(clearInterval(s),n(!0)),t--<=0&&(clearInterval(s),n(!1))},100)})}u(Am,"Z"),dt(Am,"waitWorkspaceServerData");function Em(){return new Promise(async(n,e)=>{const t=document.querySelector("#studio");t?.classList.add("hidden");const s=new URLSearchParams(window.location.search).get("templateId"),a=document.querySelector("#newAgentModal"),o=document.querySelector("#newAgentModal .agentName"),r=document.querySelector("#newAgentModal .name-error"),i=document.querySelector("#newAgentModal .agentDescription"),d=document.querySelector("#newAgentModal .btnCreate"),c=document.querySelector("#newAgentModal .agentTemplate");s||Ho(!1,100),r.classList.add("hidden"),o.value="Untitled Agent",i.value="",c.innerHTML='<option value="NONE">Select Template</option><option value="NONE">Empty Agent</option>';function l(w,f,T){return w.trim().length>=f&&w.trim().length<=T}u(l,"y"),dt(l,"inputLengthCheck");function m(){d.disabled=!l(o.value,3,60)}u(m,"p"),dt(m,"handleSubmitFormButtonState");function v(w=!1){let f=o.value.trim().length,T=f<3||f>60;w||(r.innerText=f<3?"Name should be at least 3 characters long.":f>60?"Name should not be more than 60 characters long.":"",r.classList.toggle("hidden",!T)),m()}u(v,"f"),dt(v,"handleNameChange"),v(!0);let x=await Im();if(x)for(let w in x){const f=x[w],T=document.createElement("option");T.value=w,T.innerText=f.name,s&&w==s&&T.setAttribute("selected",""),c.appendChild(T)}else x={};c.onchange=()=>{const w=c.options[c.options.selectedIndex].value,f=x[w]?.template;f&&(i.value=f.description,o.value=x[w]?.name||"",v())},c.dispatchEvent(new Event("change")),o.oninvalid=w=>{w.preventDefault(),o.setCustomValidity(""),v()},o.oninput=()=>{o.setCustomValidity(""),v()},o.onkeyup=w=>(v(),w.preventDefault(),w.stopPropagation(),!1);const C=dt(async()=>{a.classList.add("hidden"),ys("Creating Agent ...");const w=c.options[c.options.selectedIndex].value;let f=x[w]?.template,T=!1;if(!f)try{f=JSON.parse(i.value),(!f?.components||!f?.version)&&(f=null),T=!0}catch{}if(await $e(200),await ot.createAgent(o.value,T?"":i.value,k=>{f&&(k.components=f.components,k.connections=f.connections,k.description=f.description,k.version=f.version,k.templateInfo=f.templateInfo,k.variables=f.variables,k.behavior=f.behavior)})){f&&ys("Loading Template Data ..."),a.classList.add("hidden"),t?.classList.remove("hidden");const k=new URLSearchParams(window.location.search),F=k.get("chat"),O=k.get("attach");k.get("from"),F&&(localStorage.setItem("chatMessage",JSON.stringify({message:F,ttl:Date.now()+1e3*60*3})),setTimeout(()=>{try{JSON.parse(localStorage.getItem("chatMessage")).ttl<Date.now()&&localStorage.removeItem("chatMessage")}catch{}},1e3*60*3.1)),O&&(localStorage.setItem("chatAttachments",JSON.stringify({attachments:[O],ttl:Date.now()+1e3*60*3})),setTimeout(()=>{try{JSON.parse(localStorage.getItem("file")).ttl<Date.now()&&localStorage.removeItem("file")}catch{}},1e3*60*3.1)),n(ot.agent.id)}else ys('<span class="text-red-700/70">Could not create agent</span>')},"createAgentClick");C(),s&&(await $e(100),C())})}u(Em,"ee"),dt(Em,"createAgent");async function km(n=null){const e=document.location?.pathname?.split("/");n||(n=e?.length==3?e?.pop():null),n||(n=await Em()),await Am(),await ot.loadAgent(n,{lockAfterFetch:!0}).catch(s=>{console.log("Error loading agent",s);const a=s?.status||500,o=s?.status==404?"You don't have access to this agent.":s?.message||s?.error||"Operation failed";console.log(s),s?.status==404&&(s?.errorData?.errKey?.includes("DIFFERENT_TEAM")?yi("Access Error","You are not authorized to access this agent. Would you like to switch to the correct team?",{"Switch Team":{class:"text-white bg-smyth-emerald-400 z-50",handler:async()=>{const r=s?.errorData?.errKey?.split("DIFFERENT_TEAM_")[1];r?(await fetch(`/api/app/user-settings/${jv.USER_TEAM}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:r})}),window.location.reload()):window.location.href="/"}},"Go to Home":{class:"border border-gray-700 hover:opacity-75",handler:()=>{window.location.href="/"}}},null,{bringToFront:!0}):s?.errorData?.errKey?.includes("NOT_ALLOWED_TO_ACCESS_AGENT")?yi("Access Error",o,{"Request Access":{class:"text-white bg-smyth-emerald-400 z-50",handler:()=>{Mm(n,ot?.userData?.email)}},"Go to Home":{class:"border border-gray-700 hover:opacity-75",handler:()=>{window.location.href="/"}}},null,{bringToFront:!0}):document.location.href=`/error/${a}?message=${o}`)}),await ot.loadUserSubscription();const t=document.querySelector("#watermark-agent-name");return t&&(t.innerText=ot.agent.name),ot.agent?.name&&(document.title=ot.agent.name+" | SmythOS"),history.replaceState(null,"","/builder/"+n),n}u(km,"te"),dt(km,"loadAgent");async function _m(n){const e=document.getElementById("agent-name-input"),t=document.querySelector("#agent-behavior-input"),s=document.querySelector("#agent-save-btn"),a=document.querySelector("#agent-delete-btn"),o=document.querySelector("#agent-domains-input"),r=document.querySelector('label[for="agent-domains-input"] a.domain'),i=document.querySelector('label[for="agent-domains-input"] a.api'),d=ot?.serverData?.agent_domain?`${new URL(ot.serverData.frontUrl).protocol}//${ot.agent.id}.${ot.serverData.agent_domain}`:"",c=document.querySelector('label[for="agent-testdom-input"] a.domain'),l=document.querySelector('label[for="agent-testdom-input"] a.api'),m=document.querySelectorAll(".agent-menu-loading-overlay");if(await ot.waitServerData(),c&&l&&(c.href=`${d}`,l.href=`${d}/swagger`),o){let x=o.options[o.options.selectedIndex]?.value;r&&i&&(x!=="[None]"?(r.href=`https://${x}`,i.href=`https://${x}/swagger`,r.classList.remove("hidden"),i.classList.remove("hidden")):(r.href="#",i.href="#",r.classList.add("hidden"),i.classList.add("hidden"))),o.onchange=()=>{const w=o.options[o.options.selectedIndex].value;w!=="[None]"?(r.href=`https://${w}`,i.href=`https://${w}/swagger`,r.classList.remove("hidden"),i.classList.remove("hidden")):(r.href="#",i.href="#",r.classList.add("hidden"),i.classList.add("hidden"))};const C=await Pm();o.innerHTML="";for(let w of C){const f=document.createElement("option");f.value=w=="[None]"?"":w,f.innerText=w,ot.agent.domain==w&&f.setAttribute("selected",""),o.appendChild(f)}await $e(200),m.forEach(w=>w.classList.add("hidden")),a.classList.remove("hidden"),o.dispatchEvent(new Event("change"))}s?.addEventListener("click",async()=>{const x=Ic();s.disabled=!0,s.prepend(x);const C=document.getElementById("agent-id-input"),w=e.value,f=t.value;ot.agent.name=w,ot.agent.behavior=f;const T=await ot.export(),k=ot.agent.id||C.value,F=ot.agent.domain,O=o.options[o.options.selectedIndex].value;let _=F!=O;if(F&&F!=O&&(F===""?console.log("Domain Set",O):O===""?console.log("Domain Unset",F):console.log("Domain Updated ",F,O)),await ot.saveAgent(w,O,T,k)){C.value=ot.agent.id,e.value=ot.agent.name;const M=document.querySelector("#watermark-agent-name");M&&(M.innerText=ot.agent.name),$t("Agent saved")}else Je("Save failed");return _&&await fetch("/api/page/builder/updateDomain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:ot.agent.id,curDomain:F,domain:O})}).then(M=>{M.ok?($t("Domain Updated"),ot.agent.domain=O,v(O)):Je("Domain Update failed")}).catch(M=>{console.log(M),Je("Domain Update failed")}),s.disabled=!1,x.remove(),!1});function v(x){const C=document.querySelector("#deploy-agent-domain");C&&(C.value=x,C.dispatchEvent(new Event("input")))}u(v,"p"),dt(v,"updateDeploymentDomainField"),a?.addEventListener("click",async()=>{if(!await En("Are you sure you want to delete this agent ?","",{btnNoLabel:"No, Cancel",btnYesLabel:"Yes, I'm sure",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"}))return;const x=ot.agent.id;await ot.deleteAgent(x)?($t("Agent deleted"),await $e(1e3),document.location.href="/agents"):Je("Delete failed")})}u(_m,"ne"),dt(_m,"handleAgentSettings");async function Pm(){const n=await fetch("/api/page/builder/domains",{method:"GET",headers:{"Content-Type":"application/json"}}).then(t=>t.ok?t.json():{error:"Failed to load domains"}).catch(t=>{console.log(t)});if(n.error)return console.log("data.error",n.error),!1;n.map(t=>t.name);const e=n.filter(t=>t.aiAgent==null||t.aiAgent.id==ot.agent.id).map(t=>t.name);return["[None]",`${ot.agent.id}.${ot.serverData.prod_agent_domain}`,...new Set(e)]}u(Pm,"oe"),dt(Pm,"loadAgentDomainsList");async function Im(){const n=await fetch("/api/page/builder/agent-templates",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.ok?e.json():{error:"Failed to load templates"}).catch(e=>{console.log(e)});return n.data?n.data:(console.log("Error reading agents templates"),{})}u(Im,"ae"),dt(Im,"loadAgentTemplatesList");function _l(n){let e=0;const t=document.querySelector("#btn-emb-chatbot"),s=document.querySelector("#btn-emb-api"),a=document.querySelector("#btn-emb-postman"),o=document.querySelector("#btn-emb-chatgpt"),r=document.querySelector("#btn-emb-video-tutorial"),i=document.querySelector("#btn-emb-doc"),d=document.querySelector("#btn-emb-agentllm");document.querySelector("#btn-emb-skill-preview");const c=document.querySelector("#btn-emb-alexa"),l=document.querySelector("#btn-emb-mcp");if(t&&(t.onclick=fo,n.description.length>10||n.hasAPIEndpoints()?(t.classList.remove("opacity-30"),t.disabled=!1,e++):(t.classList.add("opacity-30"),t.disabled=!0)),d&&(d.onclick=()=>{Ov(ot,Bt)},n.hasAPIEndpoints()?(d.classList.remove("opacity-30"),d.disabled=!1,e++):(d.classList.add("opacity-30"),d.disabled=!0)),s&&(s.onclick=vo,n.hasAPIEndpoints()?(s.classList.remove("opacity-30"),s.disabled=!1,e++):(s.classList.add("opacity-30"),s.disabled=!0)),a&&(a.onclick=mo,n.hasAPIEndpoints()?(a.classList.remove("opacity-30"),a.disabled=!1,e++):(a.classList.add("opacity-30"),a.disabled=!0)),c&&(c.onclick=go,n.hasAPIEndpoints()?(c.classList.remove("opacity-30"),c.disabled=!1,e++):(c.classList.add("opacity-30"),c.disabled=!0)),l&&(console.log("btnMCP","Clicked"),l.onclick=bo,n.hasAPIEndpoints()?(l.classList.remove("opacity-30"),l.disabled=!1,e++):(l.classList.add("opacity-30"),l.disabled=!0)),o&&(o.onclick=ho,n.description.length>10||n.hasAPIEndpoints()?(o.classList.remove("opacity-30"),o.disabled=!1,e++):(o.classList.add("opacity-30"),o.disabled=!0)),r){const m=n?.data?.templateInfo?.videoLink;r.onclick=jm.bind(this,m),m?(r.classList.remove("opacity-30"),r.disabled=!1):(r.classList.add("opacity-30"),r.disabled=!0)}if(i){const m=n?.data?.templateInfo?.docLink;i.onclick=()=>window.open(m,"_blank"),m?(i.classList.remove("opacity-30"),i.disabled=!1):(i.classList.add("opacity-30"),i.disabled=!0)}}u(_l,"U"),dt(_l,"updateWorkspaceEmbodiments");function Lm(){!ot||!ot.agent||(ot.addEventListener("AgentSaved",_l),ot.addEventListener("AgentLoaded",_l))}u(Lm,"se"),dt(Lm,"handleAgentEvents");async function Bt(n,e={},t,s){window.dispatchEvent(new CustomEvent("sidebarStateChanged",{detail:{rightSidebarOpen:!1,isSidebarOpen:window?.localStorage?.getItem("sidebarOpen")==="true",currentSidebarTab:window?.localStorage?.getItem("currentSidebarTab")}})),Ue.curComponentSettings&&await Ue.curComponentSettings.closeSettings(),ot.domElement.classList.contains("debug-enabled");const a=document.querySelector("#embodiment-sidebar").querySelector(".title");let o;if(n)o=await Iv(t,n,e,s);else{o=await Lv();const r=Tv(t,s);a.innerHTML=r}o.querySelector("button.close-btn")?.classList?.remove("hidden")}u(Bt,"openEmbodimentDialog"),dt(Bt,"openEmbodimentDialog");async function ho(){const{dev:n,prod:e,scheme:t}=Nt.getState().agentDomains;if(!n&&!e){Bt('<div class="p-4">Agent domain is not set. Cannot provide chatGPT configuration</div>',{},"ChatGPT deployment instructions");return}const s=`<div class="emb-instructions p-4">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">${gt.chatgpt.description}</p>
        </div>
        <p>In order to create a custom GPT using your agent</p>
        &nbsp;<br />
        <ul class="steps">
            <li><a href="https://chat.openai.com/gpts/editor" target="_blank">Click Here</a> to Create a custom GPT from chatGPT interface.</li>
            <li>Click on "Configure" tab</li>
            <li>Enter your Custom GPT information: We recommend to copy the content of SmythOS Agent behavior inside "Instructions" area in order to have a consistent behavior</li>
            <li>Scroll down and Click on "Create new action" button.<br />
            ${n?`<li>- Click Import URL and enter the following URL if you want to use your test agent: <b>${t}://${n}/api-docs/openapi-llm.json</b></li>`:""}
            ${e?`<li> - Click Import URL and enter the following URL if you want to use your production agent: <b>${t}://${e}/api-docs/openapi-llm.json</b></li>`:""}
            </li>
            <li>Click on "Create" button on the top right</li>
            <li>Your custom GPT is ready, you can keep customizing it or just start using it</li>
        </ul>
        &nbsp;<br />
        <hr />
        &nbsp;<br />
        <p>
        <b>Note :</b> If you use the test url, your Custom GPT will use the current edited agent. When debug mode is enabled, the agent will not respond until you attach the debugger and run the workflow, this allows you to capture incoming requests to your agent in test mode and test them.
        </p>
        </div>
    `;Bt(s,{},gt.chatgpt.title,gt.chatgpt.tooltipTitle)}u(ho,"openChatGPTEmbodiment"),dt(ho,"openChatGPTEmbodiment");async function mo(){const{dev:n,prod:e,scheme:t}=Nt.getState().agentDomains;if(!n&&!e){Bt('<div class="p-4">Agent domain is not set. Cannot provide Postman features</div>',{},gt.api.title,gt.api.tooltipTitle);return}const s=n?`${t}://${n}/postman`:"",a=e?`${t}://${e}/postman`:"",o=s?`<div class="my-2"><a href="${s}" target="_blank" class="flex items-center justify-center text-sm font-normal border border-solid text-base px-4 py-2 text-center rounded transition-all duration-200 outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none ${Fo}">Export Test Endpoints</a></div>`:"",r=a?`<div class="my-2"><a href="${a}" target="_blank" class="flex items-center justify-center text-sm font-normal border border-solid text-base px-4 py-2 text-center rounded transition-all duration-200 outline-none focus:outline-none focus:ring-0 focus:ring-offset-0 focus:ring-shadow-none ${Fo}">Export Prod Endpoints</a></div>`:"",i=`<div class="emb-instructions p-4 flex-row">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">Test your agent using Postman or import Postman collections to your agent workspace. Includes tools for exporting and debugging API calls.</p>
        </div>
        &nbsp;<br />
        <h2>Exporting Agent to Postman Collection</h2>
        <div class="flex space-x-3 justify-between">
        ${o}

        ${r}
        </div>
        &nbsp;<br />
        <p>
        When you use the test agent, you can enable the debug mode to capture incoming requests to your agent, in this case, the request will remain stuck until you attach the debugger and run the workflow from SmythOS builder.<a href="${Ft}/agent-studio/build-agents/debugging" target="_blank"> Learn more</a>
        </p>
        &nbsp;<br />
        <h2>Importing Postman Collection to Agent</h2>
        <p>You can import a postman collection to your agent by dragging the collection .json file to the agent workspace.</p>
        &nbsp;<br />
        <hr />
        </div>
    `;Bt(i,{},gt.postman.title,gt.postman.tooltipTitle)}u(mo,"openPostmanEmbodiment"),dt(mo,"openPostmanEmbodiment");async function go(){Ct.track("alexa_embodiment_click",{position:"top right of builder inside dropdown"});const{dev:n,prod:e,scheme:t}=Nt.getState().agentDomains,s=dt(c=>`<div id="alexa-embodiment-wrapper">${c}</div>`,"wrapContent");if(!n&&!e){const c=s('<div class="p-4">Agent domain is not set. Cannot provide Alexa features</div>');Bt(c,{},gt.alexa.title,gt.alexa.tooltipTitle);return}const a=n?`${t}://${n}/alexa`:"",o=e?`${t}://${e}/alexa`:"Agent is not deployed yet",r=`(() => {
    document.getElementById('alexa-access-token').value = '';
    document.getElementById('alexa-vendor-id').value = '';
    document.querySelector('#alexa-publish-modal .publish-btn').innerHTML = 'Publish';
    document.querySelector('#alexa-publish-modal .publish-btn').disabled = false;
    document.getElementById('alexa-publish-modal').classList.add('hidden');
  })()`,i=`<button onclick="(async () => {
    const btn = event.target;
    try {
      // Show loading state
      const spinner = document.createElement('div');
      spinner.className = 'inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2';
      btn.innerHTML = '';
      btn.appendChild(spinner);
      btn.appendChild(document.createTextNode('Publishing...'));
      btn.disabled = true;

      const accessToken = document.getElementById('alexa-access-token').value;
      const vendorId = document.getElementById('alexa-vendor-id').value;

      const response = await fetch('${a}', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          accessToken,
          vendorId
        })
      });

      if (!response.ok) {
        throw new Error('Failed to publish');
      }

      // Show success state
      document.getElementById('alexa-publish-modal').classList.add('hidden');
      successToast('Alexa Skill published successfully');

    } catch (error) {
      console.error(error);
      btn.innerHTML = 'Failed to Publish';
      errorToast('Failed to publish Alexa Skill');
      
      // Reset button after delay
      setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = 'Publish';
      }, 2000);
    }
  })()"
    class="publish-btn px-4 py-2 text-sm text-white bg-smyth-emerald-400 rounded-md hover:opacity-75 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2">
    Publish
  </button>`,d=s(`<div class="emb-instructions p-4 flex-row">
        <div class="flex items-center gap-2 mb-4">
          <p class="text-gray-700">Publish your agent as an Alexa Skill. You can publish your skill to the Alexa Skill Store or use it in your own Alexa devices.</p>
        </div>
        <div class="space-x-3 justify-between">
         <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Alexa Dev Endpoint</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="alexa-dev-url" 
                value="${a}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${a}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Alexa Prod Endpoint</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="alexa-prod-url" 
                value="${o}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${o}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
        </div>
        &nbsp;<br />
        <hr />

        <!-- Modal -->
        <div id="alexa-publish-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
          <div class="bg-white rounded-lg p-6 w-[500px] max-w-[90%]">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-semibold">Publish Alexa Skill</h3>
              <button onclick="${r}" class="text-gray-500 hover:text-gray-700">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Access Token</label>
                <input type="text" id="alexa-access-token" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-emerald-500"
                  placeholder="Enter Access Token">
              </div>


              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Vendor ID</label>
                <input type="text" id="alexa-vendor-id" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-emerald-500"
                  placeholder="Enter Vendor ID">
              </div>
            </div>

            <div class="mt-6 flex justify-end space-x-3">
              <button onclick="${r}" class="px-4 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50">
                Cancel
              </button>
              ${i}
            </div>
          </div>
        </div>
    </div>`);Bt(d,{},gt.alexa.title,gt.alexa.tooltipTitle),Nt.subscribe(c=>[c.agentDomains.prod,c.agentDomains.scheme],([c,l])=>{const m=c?`${l}://${c}/alexa`:"Agent is not deployed yet",v=document.querySelector("#alexa-embodiment-wrapper #alexa-prod-url");if(v){v.value=m;const x=v.nextElementSibling;x&&x.setAttribute("onclick",`(function(){ navigator.clipboard.writeText('${m}'); successToast('URL copied to clipboard', 'Info'); })()`)}})}u(go,"openAlexaEmbodiment"),dt(go,"openAlexaEmbodiment");async function fo(){const{dev:n,scheme:e}=Nt.getState().agentDomains,t=document.querySelector(".modalBox");t&&(t.style.width="600px");let s=document.querySelector("#chatbot-iframe"),a,o={};const r=`${e||"https"}://${n}/chatBot?allowAttachments=true`,i=`chatbot-spinner-${Date.now()}`,d='<span class="mif-refresh text-[#757575] hover:text-[#374151] cursor-pointer flex items-center justify-center w-4 h-4"></span>',c=`<svg class="w-4 h-4 animate-spin cursor-default flex items-center justify-center" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
    <path fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
  </svg>`;(!s||s.src!=r)&&(a=`
      <div class="p-4 h-full">
        <div class="flex items-center gap-2">
          <p class="text-gray-700">${gt.chat.description}</p>
        </div>
        <div id="${i}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
        <iframe src="${r}" id="chatbot-iframe" frameborder="0" style="width:100%;height:calc(100% - 2rem);"></iframe>
      </div>
    `,o={Refresh:{click:async m=>{const v=document.querySelector(".refresh-chat-btn"),x=document.querySelector("#chatbot-iframe");if(x&&v&&!v.classList.contains("loading")){v.classList.add("loading"),v.style.pointerEvents="none",v.style.opacity="0.7",v.innerHTML=c;const C=dt(()=>{v.innerHTML=d,v.classList.remove("loading"),v.style.pointerEvents="auto",v.style.opacity="1",x.removeEventListener("load",C)},"onLoad");x.addEventListener("load",C),x.src+=""}},label:`<span class="refresh-chat-btn loading flex items-center justify-center w-4 h-4" style="pointer-events: none; opacity: 0.7;">${c}</span>`,tooltip:"Refresh chat session",tooltipPlacement:"left"}}),await Bt(a,o,gt.chat.title,gt.chat.tooltipTitle),s=document.querySelector("#chatbot-iframe");const l=document.getElementById(i);s&&s.addEventListener("load",async()=>{l&&l.style.setProperty("display","none","important"),s.style.display="block";const m=document.querySelector(".refresh-chat-btn");m&&(m.innerHTML=d,m.classList.remove("loading"),m.style.pointerEvents="auto",m.style.opacity="1"),await $e(200),ot.debugger.stopDebugSession(),ya.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["chatbot"])})}u(fo,"openChatbotEmbodiment"),dt(fo,"openChatbotEmbodiment");async function vo(){const{dev:n,scheme:e}=Nt.getState().agentDomains;console.log("test domain found,",n,"Store:",Nt.getState());const t=document.querySelector(".modalBox");t&&(t.style.width="800px");let s=`${e||"https"}://${n}/swagger`;const a=`swagger-spinner-${Date.now()}`,o=`
    <div class="p-4 h-full">
      <div class="flex items-center gap-2 mb-4">
        <p class="text-gray-700">${gt.api.description}</p>
      </div>
      <div id="${a}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <iframe src="${s}" id="swagger-iframe" frameborder="0" style="width:100%;height:calc(100% - 3rem);display:none;"></iframe>
    </div>
  `;await Bt(o,{},gt.api.title,gt.api.tooltipTitle);const r=document.querySelector("#swagger-iframe"),i=document.getElementById(a);r&&r.addEventListener("load",async()=>{i&&i.style.setProperty("display","none","important"),r.style.display="block",await $e(200),ya.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["swagger"])})}u(vo,"openAPIEmbodiment"),dt(vo,"openAPIEmbodiment");async function bo(){Ct.track("mcp_embodiment_click",{position:"top right of builder inside dropdown"});const{dev:n,prod:e,scheme:t}=Nt.getState().agentDomains,s=dt(i=>`<div id="mcp-embodiment-wrapper">${i}</div>`,"wrapContent");if(!n){const i=s('<div class="p-4">Agent domain is not set. Cannot provide MCP features</div>');Bt(i,{},gt.mcp.title,gt.mcp.tooltipTitle);return}const a=`${t}://${n}/emb/mcp/sse`;let o="Agent is not deployed yet";e&&(o=`${t}://${e}/emb/mcp/sse`);const r=s(`
    <div class="emb-instructions p-4 flex-row">
      <div class="flex items-center gap-2 mb-4">
        <p class="text-gray-700">Turn your agents into an MCP server, ready to integrate and ship with one click.</p>
      </div>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">MCP Dev URL</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="mcp-dev-url" 
                value="${a}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${a}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">MCP Prod URL</label>
          <div class="flex items-center gap-2">
            <div class="flex-1 relative">
              <input type="text" 
                id="mcp-prod-url" 
                value="${o}"
                readonly 
                class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm focus:outline-none focus:ring-1 focus:ring-gray-300 overflow-hidden text-ellipsis"
                style="text-overflow: ellipsis; white-space: nowrap;"
              />
              <button onclick="(function(){ 
                  navigator.clipboard.writeText('${o}');
                  successToast('URL copied to clipboard', 'Info');
                })()" 
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
                title="Copy URL">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `);Bt(r,{},gt.mcp.title,gt.mcp.tooltipTitle),Nt.subscribe(i=>[i.agentDomains.prod,i.agentDomains.scheme],([i,d])=>{const c=`${d}://${i}/emb/mcp/sse`,l=document.querySelector("#mcp-embodiment-wrapper #mcp-prod-url");if(l){l.value=c;const m=l.nextElementSibling;m&&m.setAttribute("onclick",`(function(){ navigator.clipboard.writeText('${c}'); successToast('URL copied to clipboard', 'Info'); })()`)}})}u(bo,"openMCPEmbodiment"),dt(bo,"openMCPEmbodiment");async function Tm(){const n=document.querySelector(".modalBox");n&&(n.style.width="800px");const e="skill-preview-sidebar-root",t=`
    <div class="p-4 h-full">
      <div id="${e}"></div>
    </div>`;await Bt(t,{},gt.agent_skill.title,gt.agent_skill.tooltipTitle),jr({rootID:e})}u(Tm,"ie"),dt(Tm,"openFormPreviewEmbodiment");function jm(n){const e=new URL(n).searchParams.get("v"),t=`
        <iframe width="100%" height="320" src="${e?`https://www.youtube.com/embed/${e}`:n}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        `;yi("",t,{Close:{class:"border border-gray-700 hover:opacity-75",handler:()=>{}},"Open in new tab":{class:"text-white bg-smyth-emerald-400",handler:()=>{window.open(n,"_blank")}}})}u(jm,"re"),dt(jm,"openVideoTutorialDialog");function Pl(n){n&&document.querySelectorAll(".builder-topbar-agent-name")?.forEach(e=>{e.textContent=n})}u(Pl,"updateBuilderTopbarAgentName"),dt(Pl,"updateBuilderTopbarAgentName");function Il(n="A"){document.querySelectorAll(".agent-avatar-placeholder-topbar")?.forEach(e=>{e.textContent=n?.charAt(0)?.toLocaleUpperCase()||"A"})}u(Il,"updateBuilderTopbarAgentAvatar"),dt(Il,"updateBuilderTopbarAgentAvatar");async function Om(){const n=new URLSearchParams({page:"1",limit:"30",sortField:"createdAt",order:"desc",search:""});try{const e=await fetch(`/api/page/agents/agents?${n.toString()}`),{agents:t}=await e.json();return t.filter(s=>s?.id!==ot?.agent?.id)}catch(e){return console.error("Error fetching recent agents:",e),[]}}u(Om,"le"),dt(Om,"fetchRecentAgents");function Dm(){const n=document.querySelector(".new-agent-btn");let e=!1;n?.addEventListener("mouseenter",async()=>{if(e)return;const t=document.getElementById("recent-agents-dropdown");if(!t)return;const s=await Om();if(s.length===0){t.innerHTML=`
        <div class="text-sm text-gray-500 text-center py-2">
          No recent agents found
        </div>
      `;return}const a=dt(r=>r.aiAgentSettings?.find(i=>i.key==="avatar")?.value,"getAgentAvatar"),o=s.map(r=>`
      <a href="/builder/${r.id}" target="_blank" class="block p-2 hover:bg-gray-200 rounded-lg transition-colors bg-gray-50 border border-solid border-gray-200">
        <div class="flex items-center gap-2">
          ${a(r)?`<img src="${a(r)}" alt="${r.name}" class="w-8 h-8 rounded-full">`:`<div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 font-medium">
                ${r.name?.charAt(0)?.toUpperCase()}
              </div>`}
          <div class="min-w-0 flex-1">
            <div class="text-gray-900 truncate max-w-[200px]" title="${r.name}">${r.name}</div>
            <div class="text-xs text-gray-500 truncate max-w-[200px]" ${(()=>{const i=r.contributors?.[0]?.user?.name,d=r.contributors?.[0]?.user?.email,c=i||d||"Unknown",l=c.includes("@")?c.split("@")[0]:c;return`title="${c}">by ${l}`})()}</div>
          </div>
        </div>
      </a>
    `).join("");t.innerHTML=o,e=!0})}u(Dm,"ce"),dt(Dm,"initializeRecentAgentsDropdown");async function Mm(n,e){try{if(!(await fetch("/api/agent/request-access",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:n,email:e})})).ok)throw new Error("Failed to request access. Please try again later.");window.location.href="/"}catch(t){throw new Error(t.message||"An error occurred requesting access")}}u(Mm,"de"),dt(Mm,"requestAgentAccess"),Pv({openEmbodimentDialog:Bt,openChatGPTEmbodiment:ho,openPostmanEmbodiment:mo,openChatbotEmbodiment:fo,openAPIEmbodiment:vo,openFormPreviewEmbodiment:Tm,openAlexaEmbodiment:go,openMCPEmbodiment:bo});export{vo as openAPIEmbodiment,go as openAlexaEmbodiment,ho as openChatGPTEmbodiment,fo as openChatbotEmbodiment,Bt as openEmbodimentDialog,bo as openMCPEmbodiment,mo as openPostmanEmbodiment,Cm as setupAgentScripts,Il as updateBuilderTopbarAgentAvatar,Pl as updateBuilderTopbarAgentName};
//# sourceMappingURL=agent-settings-2576e15e.dev.js.map
