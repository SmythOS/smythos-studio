import{c as ie,g as Na,n as Ko,u as kr,d as ye,o as Fa,e as Ra,P as Ze,f as Ba,s as qa,l as Hi,M as $i,J as Do,t as Jo,h as Gi,i as Oo,j as za,k as zi,m as de,p as To,q as Ua,v as Va,w as Ui,x as Ha,y as $a,z as Ga,A as Ya,C as Jn,B as Oi,D as Ti,E as Mo,F as Xa,G as Wa,H as Ka,I as Ja,K as Za,L as Qa,N as tl,O as el,Q as nl,S as il,T as rl,U as ol,V as Be,W as sl}from"./app.bundle.min.js";class al{constructor(a,i){this.isVisible=!1,this.hideTimeoutId=null,this.element=a,this.options=i,this.init()}init(){this.element.style.position="relative",this.element.setAttribute("data-tooltip",this.options.text),this.element.setAttribute("data-tooltip-position",this.options.position),this.element.classList.add("tooltip-trigger"),this.options.tooltipClass&&this.element.classList.add(this.options.tooltipClass),this.options.showWhen==="hover"?(this.element.addEventListener("mouseenter",()=>this.show()),this.element.addEventListener("mouseleave",()=>this.hide())):this.options.showWhen==="click"&&(this.element.addEventListener("click",()=>this.toggle()),document.addEventListener("click",a=>{this.element.contains(a.target)||this.hide()}))}show(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!0,this.element.classList.add("tooltip-active")}hide(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.isVisible=!1,this.element.classList.remove("tooltip-active")}toggle(){this.isVisible?this.hide():this.show()}destroy(){this.hideTimeoutId!==null&&(window.clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.element.removeAttribute("data-tooltip"),this.element.removeAttribute("data-tooltip-position"),this.element.classList.remove("tooltip-trigger","tooltip-active"),this.options.tooltipClass&&this.element.classList.remove(this.options.tooltipClass)}}class Cn extends Error{constructor(a,i){super(a+" at position "+i),this.position=i}}const Mi=92,Sr=47,ll=42,jo=123,ji=125,Lo=91,Li=93,ul=40,cl=41,dl=32,Ir=10,Zo=9,Qo=13,fl=8,hl=12,Yi=34,Io=43,No=45,ts=39,es=48,ns=57,Ii=44,pl=46,gl=58,vl=59,ml=65,yl=97,bl=69,_l=101,Sl=70,El=102,wl=160,Cl=8192,xl=8202,Pl=8239,Al=8287,kl=12288,Dl=8220,Ol=8221,Tl=8216,Ml=8217,jl=96,Ll=180;function Il(g){return g>=es&&g<=ns||g>=ml&&g<=Sl||g>=yl&&g<=El}function Ni(g){return g>=es&&g<=ns}function Nl(g){return g>=32&&g<=1114111}function Fi(g){return Fl.test(g)}const Fl=/^[,:[\]/{}()\n+]$/;function Fo(g){return Rl.test(g)||g&&Vi(g.charCodeAt(0))}const Rl=/^[[{\w-]$/;function Bl(g){return g===Ir||g===Qo||g===Zo||g===fl||g===hl}function ti(g){return g===dl||g===Ir||g===Zo||g===Qo}function ql(g){return g===wl||g>=Cl&&g<=xl||g===Pl||g===Al||g===kl}function Vi(g){return is(g)||Dr(g)}function is(g){return g===Yi||g===Dl||g===Ol}function Ro(g){return g===Yi}function Dr(g){return g===ts||g===Tl||g===Ml||g===jl||g===Ll}function Bo(g){return g===ts}function Kn(g,a){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const h=g.lastIndexOf(a);return h!==-1?g.substring(0,h)+(i?"":g.substring(h+1)):g}function He(g,a){let i=g.length;if(!ti(g.charCodeAt(i-1)))return g+a;for(;ti(g.charCodeAt(i-1));)i--;return g.substring(0,i)+a+g.substring(i)}function zl(g,a,i){return g.substring(0,a)+g.substring(a+i)}function Ul(g){return/[,\n][ \t\r]*$/.test(g)}const Vl={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},Hl={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function rs(g){let a=0,i="";C()||B();const j=u(Ii);for(j&&A(),Fo(g[a])&&Ul(i)?(j||(i=He(i,",")),k()):j&&(i=Kn(i,","));g.charCodeAt(a)===ji||g.charCodeAt(a)===Li;)a++,A();if(a>=g.length)return i;x();function C(){A();const O=D()||L()||v()||z()||q()||Y();return A(),O}function A(){const O=a;let y=s();do y=_(),y&&(y=s());while(y);return a>O}function s(){let O="",y;for(;(y=ti(g.charCodeAt(a)))||ql(g.charCodeAt(a));)y?O+=g[a]:O+=" ",a++;return O.length>0?(i+=O,!0):!1}function _(){if(g.charCodeAt(a)===Sr&&g.charCodeAt(a+1)===ll){for(;a<g.length&&!$l(g,a);)a++;return a+=2,!0}if(g.charCodeAt(a)===Sr&&g.charCodeAt(a+1)===Sr){for(;a<g.length&&g.charCodeAt(a)!==Ir;)a++;return!0}return!1}function u(O){return g.charCodeAt(a)===O?(i+=g[a],a++,!0):!1}function o(O){return g.charCodeAt(a)===O?(a++,!0):!1}function m(){return o(Mi)}function D(){if(g.charCodeAt(a)===jo){i+="{",a++,A();let O=!0;for(;a<g.length&&g.charCodeAt(a)!==ji;){let y;if(O?(y=!0,O=!1):(y=u(Ii),y||(i=He(i,",")),A()),!(v()||Y())){g.charCodeAt(a)===ji||g.charCodeAt(a)===jo||g.charCodeAt(a)===Li||g.charCodeAt(a)===Lo||g[a]===void 0?i=Kn(i,","):W();break}A();const ot=u(gl),Q=a>=g.length;ot||(Fo(g[a])||Q?i=He(i,":"):w()),C()||(ot||Q?i+="null":w())}return g.charCodeAt(a)===ji?(i+="}",a++):i=He(i,"}"),!0}return!1}function L(){if(g.charCodeAt(a)===Lo){i+="[",a++,A();let O=!0;for(;a<g.length&&g.charCodeAt(a)!==Li;)if(O?O=!1:u(Ii)||(i=He(i,",")),!C()){i=Kn(i,",");break}return g.charCodeAt(a)===Li?(i+="]",a++):i=He(i,"]"),!0}return!1}function k(){let O=!0,y=!0;for(;y;)O?O=!1:u(Ii)||(i=He(i,",")),y=C();y||(i=Kn(i,",")),i=`[
`.concat(i,`
]`)}function v(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=g.charCodeAt(a)===Mi;if(y&&(a++,y=!0),Vi(g.charCodeAt(a))){const X=Ro(g.charCodeAt(a))?Ro:Bo(g.charCodeAt(a))?Bo:Dr(g.charCodeAt(a))?Dr:is,ot=a,Q=i.length;let it='"';for(a++;;){if(a>=g.length)return O?(it=He(it,'"'),i+=it,!0):(a=ot,i=i.substring(0,Q),v(!0));if(X(g.charCodeAt(a))){const f=a,S=it.length;if(it+='"',a++,i+=it,A(),O||a>=g.length||Fi(g.charAt(a))||Vi(g.charCodeAt(a)))return l(),!0;if(Fi(g.charAt(I(f-1))))return a=ot,i=i.substring(0,Q),v(!0);i=i.substring(0,Q),a=f+1,it=it.substring(0,S)+"\\"+it.substring(S)}else{if(O&&Fi(g[a]))return it=He(it,'"'),i+=it,l(),!0;if(g.charCodeAt(a)===Mi){const f=g.charAt(a+1);if(Hl[f]!==void 0)it+=g.slice(a,a+2),a+=2;else if(f==="u"){let c=2;for(;c<6&&Il(g.charCodeAt(a+c));)c++;c===6?(it+=g.slice(a,a+6),a+=6):a+c>=g.length?a=g.length:K()}else it+=f,a+=2}else{const f=g.charAt(a),S=g.charCodeAt(a);S===Yi&&g.charCodeAt(a-1)!==Mi?(it+="\\"+f,a++):Bl(S)?(it+=Vl[f],a++):(Nl(S)||E(f),it+=f,a++)}}y&&m()}}return!1}function l(){let O=!1;for(A();g.charCodeAt(a)===Io;){O=!0,a++,A(),i=Kn(i,'"',!0);const y=i.length;v()?i=zl(i,y,1):i=He(i,'"')}return O}function z(){const O=a;if(g.charCodeAt(a)===No&&(a++,p(O)))return!0;for(;Ni(g.charCodeAt(a));)a++;if(g.charCodeAt(a)===pl){if(a++,p(O))return!0;for(;Ni(g.charCodeAt(a));)a++}if(g.charCodeAt(a)===_l||g.charCodeAt(a)===bl){if(a++,(g.charCodeAt(a)===No||g.charCodeAt(a)===Io)&&a++,p(O))return!0;for(;Ni(g.charCodeAt(a));)a++}if(a>O){const y=g.slice(O,a),X=/^0\d/.test(y);return i+=X?'"'.concat(y,'"'):y,!0}return!1}function q(){return tt("true","true")||tt("false","false")||tt("null","null")||tt("True","true")||tt("False","false")||tt("None","null")}function tt(O,y){return g.slice(a,a+O.length)===O?(i+=y,a+=O.length,!0):!1}function Y(){const O=a;for(;a<g.length&&!Fi(g[a])&&!Vi(g.charCodeAt(a));)a++;if(a>O){if(g.charCodeAt(a)===ul)return a++,C(),g.charCodeAt(a)===cl&&(a++,g.charCodeAt(a)===vl&&a++),!0;{for(;ti(g.charCodeAt(a-1))&&a>0;)a--;const y=g.slice(O,a);return i+=y==="undefined"?"null":JSON.stringify(y),g.charCodeAt(a)===Yi&&a++,!0}}}function I(O){let y=O;for(;y>0&&ti(g.charCodeAt(y));)y--;return y}function H(O){if(!Ni(g.charCodeAt(a))){const y=g.slice(O,a);throw new Cn("Invalid number '".concat(y,"', expecting a digit ").concat(U()),a)}}function p(O){return a>=g.length?(i+=g.slice(O,a)+"0",!0):(H(O),!1)}function E(O){throw new Cn("Invalid character "+JSON.stringify(O),a)}function x(){throw new Cn("Unexpected character "+JSON.stringify(g[a]),a)}function B(){throw new Cn("Unexpected end of json string",g.length)}function W(){throw new Cn("Object key expected",a)}function w(){throw new Cn("Colon expected",a)}function K(){const O=g.slice(a,a+6);throw new Cn('Invalid unicode character "'.concat(O,'"'),a)}function U(){return g[a]?"but got '".concat(g[a],"'"):"but reached end of input"}}function $l(g,a){return g[a]==="*"&&g[a+1]==="/"}var Gl={};(function(g){(function(){typeof Math.sgn>"u"&&(Math.sgn=function(y){return y==0?0:y>0?1:-1});var a={subtract:function(y,X){return{x:y.x-X.x,y:y.y-X.y}},dotProduct:function(y,X){return y.x*X.x+y.y*X.y},square:function(y){return Math.sqrt(y.x*y.x+y.y*y.y)},scale:function(y,X){return{x:y.x*X,y:y.y*X}}},i=64,h=Math.pow(2,-i-1),j=function(y,X){for(var ot=[],Q=A(y,X),it=X.length-1,f=2*it-1,S=s(Q,f,ot,0),c=a.subtract(y,X[0]),R=a.square(c),M=0,V=0;V<S;V++){c=a.subtract(y,m(X,it,ot[V],null,null));var et=a.square(c);et<R&&(R=et,M=ot[V])}return c=a.subtract(y,X[it]),et=a.square(c),et<R&&(R=et,M=1),{location:M,distance:R}},C=function(y,X){var ot=j(y,X);return{point:m(X,X.length-1,ot.location,null,null),location:ot.location}},A=function(y,X){for(var ot=X.length-1,Q=2*ot-1,it=[],f=[],S=[],c=[],R=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],M=0;M<=ot;M++)it[M]=a.subtract(X[M],y);for(var M=0;M<=ot-1;M++)f[M]=a.subtract(X[M+1],X[M]),f[M]=a.scale(f[M],3);for(var V=0;V<=ot-1;V++)for(var et=0;et<=ot;et++)S[V]||(S[V]=[]),S[V][et]=a.dotProduct(f[V],it[et]);for(M=0;M<=Q;M++)c[M]||(c[M]=[]),c[M].y=0,c[M].x=parseFloat(M)/Q;for(var lt=ot,st=ot-1,ct=0;ct<=lt+st;ct++){var Et=Math.max(0,ct-st),yt=Math.min(ct,lt);for(M=Et;M<=yt;M++){var vt=ct-M;c[M+vt].y+=S[vt][M]*R[vt][M]}}return c},s=function(y,X,ot,Q){var it=[],f=[],S,c,R=[],M=[];switch(_(y,X)){case 0:return 0;case 1:{if(Q>=i)return ot[0]=(y[0].x+y[X].x)/2,1;if(u(y,X))return ot[0]=o(y,X),1;break}}m(y,X,.5,it,f),S=s(it,X,R,Q+1),c=s(f,X,M,Q+1);for(var V=0;V<S;V++)ot[V]=R[V];for(var V=0;V<c;V++)ot[V+S]=M[V];return S+c},_=function(y,X){var ot=0,Q,it;Q=it=Math.sgn(y[0].y);for(var f=1;f<=X;f++)Q=Math.sgn(y[f].y),Q!=it&&ot++,it=Q;return ot},u=function(y,X){var ot,Q,it,f,S,c,R,M,V,et,lt,st,ct,Et,yt,vt;c=y[0].y-y[X].y,R=y[X].x-y[0].x,M=y[0].x*y[X].y-y[X].x*y[0].y;var Ct,Ot;Ct=Ot=0;for(var xt=1;xt<X;xt++){var Pt=c*y[xt].x+R*y[xt].y+M;Pt>Ct?Ct=Pt:Pt<Ot&&(Ot=Pt)}return lt=0,st=1,ct=0,Et=c,yt=R,vt=M-Ct,V=lt*yt-Et*st,et=1/V,Q=(st*vt-yt*ct)*et,Et=c,yt=R,vt=M-Ot,V=lt*yt-Et*st,et=1/V,it=(st*vt-yt*ct)*et,f=Math.min(Q,it),S=Math.max(Q,it),ot=S-f,ot<h?1:0},o=function(y,X){var ot=1,Q=0,it=y[X].x-y[0].x,f=y[X].y-y[0].y,S=y[0].x-0,c=y[0].y-0,R=it*Q-f*ot,M=1/R,V=(it*c-f*S)*M;return 0+ot*V},m=function(y,X,ot,Q,it){for(var f=[[]],S=0;S<=X;S++)f[0][S]=y[S];for(var c=1;c<=X;c++)for(var S=0;S<=X-c;S++)f[c]||(f[c]=[]),f[c][S]||(f[c][S]={}),f[c][S].x=(1-ot)*f[c-1][S].x+ot*f[c-1][S+1].x,f[c][S].y=(1-ot)*f[c-1][S].y+ot*f[c-1][S+1].y;if(Q!=null)for(S=0;S<=X;S++)Q[S]=f[S][0];if(it!=null)for(S=0;S<=X;S++)it[S]=f[X-S][S];return f[X][0]},D={},L=function(y){var X=D[y];if(!X){X=[];var ot=function(){return function(et){return Math.pow(et,y)}},Q=function(){return function(et){return Math.pow(1-et,y)}},it=function(et){return function(lt){return et}},f=function(){return function(et){return et}},S=function(){return function(et){return 1-et}},c=function(et){return function(lt){for(var st=1,ct=0;ct<et.length;ct++)st=st*et[ct](lt);return st}};X.push(new ot);for(var R=1;R<y;R++){for(var M=[new it(y)],V=0;V<y-R;V++)M.push(new f);for(var V=0;V<R;V++)M.push(new S);X.push(new c(M))}X.push(new Q),D[y]=X}return X},k=function(y,X){for(var ot=L(y.length-1),Q=0,it=0,f=0;f<y.length;f++)Q=Q+y[f].x*ot[f](X),it=it+y[f].y*ot[f](X);return{x:Q,y:it}},v=function(y,X){return Math.sqrt(Math.pow(y.x-X.x,2)+Math.pow(y.y-X.y,2))},l=function(y){return y[0].x===y[1].x&&y[0].y===y[1].y},z=function(y,X,ot){if(l(y))return{point:y[0],location:X};for(var Q=k(y,X),it=0,f=X,S=ot>0?1:-1,c=null;it<Math.abs(ot);)f+=.005*S,c=k(y,f),it+=v(c,Q),Q=c;return{point:c,location:f}},q=function(y){var X=new Date().getTime();if(l(y))return 0;for(var ot=k(y,0),Q=0,it=0,f=1,S=null;it<1;)it+=.005*f,S=k(y,it),Q+=v(S,ot),ot=S;return console.log("length",new Date().getTime()-X),Q},tt=function(y,X,ot){return z(y,X,ot).point},Y=function(y,X,ot){return z(y,X,ot).location},I=function(y,X){var ot=k(y,X),Q=k(y.slice(0,y.length-1),X),it=Q.y-ot.y,f=Q.x-ot.x;return it===0?1/0:Math.atan(it/f)},H=function(y,X,ot){var Q=z(y,X,ot);return Q.location>1&&(Q.location=1),Q.location<0&&(Q.location=0),I(y,Q.location)},p=function(y,X,ot,Q){Q=Q??0;var it=z(y,X,Q),f=I(y,it.location),S=Math.atan(-1/f),c=ot/2*Math.sin(S),R=ot/2*Math.cos(S);return[{x:it.point.x+R,y:it.point.y+c},{x:it.point.x-R,y:it.point.y-c}]},E=function(y,X,ot,Q,it){var f=Q-X,S=y-ot,c=y*(X-Q)+X*(ot-y),R=w(it),M=[f*R[0][0]+S*R[1][0],f*R[0][1]+S*R[1][1],f*R[0][2]+S*R[1][2],f*R[0][3]+S*R[1][3]+c],V=U.apply(null,M),et=[];if(V!=null)for(var lt=0;lt<3;lt++){var st=V[lt],ct=Math.pow(st,2),Et=Math.pow(st,3),yt=[R[0][0]*Et+R[0][1]*ct+R[0][2]*st+R[0][3],R[1][0]*Et+R[1][1]*ct+R[1][2]*st+R[1][3]],vt;ot-y!==0?vt=(yt[0]-y)/(ot-y):vt=(yt[1]-X)/(Q-X),st>=0&&st<=1&&vt>=0&&vt<=1&&et.push(yt)}return et},x=function(y,X,ot,Q,it){var f=[];return f.push.apply(f,E(y,X,y+ot,X,it)),f.push.apply(f,E(y+ot,X,y+ot,X+Q,it)),f.push.apply(f,E(y+ot,X+Q,y,X+Q,it)),f.push.apply(f,E(y,X+Q,y,X,it)),f},B=function(y,X){var ot=[];return ot.push.apply(ot,E(y.x,y.y,y.x+y.w,y.y,X)),ot.push.apply(ot,E(y.x+y.w,y.y,y.x+y.w,y.y+y.h,X)),ot.push.apply(ot,E(y.x+y.w,y.y+y.h,y.x,y.y+y.h,X)),ot.push.apply(ot,E(y.x,y.y+y.h,y.x,y.y,X)),ot};function W(y,X){return[-y[0][X]+3*y[1][X]+-3*y[2][X]+y[3][X],3*y[0][X]-6*y[1][X]+3*y[2][X],-3*y[0][X]+3*y[1][X],y[0][X]]}function w(y){return[W(y,"x"),W(y,"y")]}function K(y){return y<0?-1:y>0?1:0}function U(y,X,ot,Q){var it=X/y,f=ot/y,S=Q/y,c=(3*f-Math.pow(it,2))/9,R=(9*it*f-27*S-2*Math.pow(it,3))/54,M=Math.pow(c,3)+Math.pow(R,2),V,et,lt=[];if(M>=0)V=K(R+Math.sqrt(M))*Math.pow(Math.abs(R+Math.sqrt(M)),1/3),et=K(R-Math.sqrt(M))*Math.pow(Math.abs(R-Math.sqrt(M)),1/3),lt[0]=-it/3+(V+et),lt[1]=-it/3-(V+et)/2,lt[2]=-it/3-(V+et)/2,Math.abs(Math.sqrt(3)*(V-et)/2)!==0&&(lt[1]=-1,lt[2]=-1);else{var st=Math.acos(R/Math.sqrt(-Math.pow(c,3)));lt[0]=2*Math.sqrt(-c)*Math.cos(st/3)-it/3,lt[1]=2*Math.sqrt(-c)*Math.cos((st+2*Math.PI)/3)-it/3,lt[2]=2*Math.sqrt(-c)*Math.cos((st+4*Math.PI)/3)-it/3}for(var ct=0;ct<3;ct++)(lt[ct]<0||lt[ct]>1)&&(lt[ct]=-1);return lt}var O=this.jsBezier={distanceFromCurve:j,gradientAtPoint:I,gradientAtPointAlongCurveFrom:H,nearestPointOnCurve:C,pointOnCurve:k,pointAlongCurveFrom:tt,perpendicularToCurveAt:p,locationAlongCurveFrom:Y,getLength:q,lineIntersection:E,boxIntersection:x,boundingBoxIntersection:B,version:"0.9.0"};g.jsBezier=O}).call(typeof window<"u"?window:ie),function(){var a=this,i=a.Biltong={version:"0.4.0"};g.Biltong=i;var h=function(u){return Object.prototype.toString.call(u)==="[object Array]"},j=function(u,o,m){return u=h(u)?u:[u.x,u.y],o=h(o)?o:[o.x,o.y],m(u,o)},C=i.gradient=function(u,o){return j(u,o,function(m,D){return D[0]==m[0]?D[1]>m[1]?1/0:-1/0:D[1]==m[1]?D[0]>m[0]?0:-0:(D[1]-m[1])/(D[0]-m[0])})};i.normal=function(u,o){return-1/C(u,o)},i.lineLength=function(u,o){return j(u,o,function(m,D){return Math.sqrt(Math.pow(D[1]-m[1],2)+Math.pow(D[0]-m[0],2))})};var A=i.quadrant=function(u,o){return j(u,o,function(m,D){return D[0]>m[0]||D[0]==m[0]?D[1]>m[1]?2:1:D[1]>m[1]?3:4})};i.theta=function(u,o){return j(u,o,function(m,D){var L=C(m,D),k=Math.atan(L),v=A(m,D);return(v==4||v==3)&&(k+=Math.PI),k<0&&(k+=2*Math.PI),k})},i.intersects=function(u,o){var m=u.x,D=u.x+u.w,L=u.y,k=u.y+u.h,v=o.x,l=o.x+o.w,z=o.y,q=o.y+o.h;return m<=v&&v<=D&&L<=z&&z<=k||m<=l&&l<=D&&L<=z&&z<=k||m<=v&&v<=D&&L<=q&&q<=k||m<=l&&v<=D&&L<=q&&q<=k||v<=m&&m<=l&&z<=L&&L<=q||v<=D&&D<=l&&z<=L&&L<=q||v<=m&&m<=l&&z<=k&&k<=q||v<=D&&m<=l&&z<=k&&k<=q},i.encloses=function(u,o,m){var D=u.x,L=u.x+u.w,k=u.y,v=u.y+u.h,l=o.x,z=o.x+o.w,q=o.y,tt=o.y+o.h,Y=function(I,H,p,E){return m?I<=H&&p>=E:I<H&&p>E};return Y(D,l,L,z)&&Y(k,q,v,tt)};var s=[null,[1,-1],[1,1],[-1,1],[-1,-1]],_=[null,[-1,-1],[-1,1],[1,1],[1,-1]];i.pointOnLine=function(u,o,m){var D=C(u,o),L=A(u,o),k=m>0?s[L]:_[L],v=Math.atan(D),l=Math.abs(m*Math.sin(v))*k[1],z=Math.abs(m*Math.cos(v))*k[0];return{x:u.x+z,y:u.y+l}},i.perpendicularLineTo=function(u,o,m){var D=C(u,o),L=Math.atan(-1/D),k=m/2*Math.sin(L),v=m/2*Math.cos(L);return[{x:o.x+v,y:o.y+k},{x:o.x-v,y:o.y-k}]}}.call(typeof window<"u"?window:ie),function(){function a(f,S,c,R,M,V,et,lt){return new Touch({target:S,identifier:it(),pageX:c,pageY:R,screenX:M,screenY:V,clientX:et||M,clientY:lt||V})}function i(){var f=[];return Array.prototype.push.apply(f,arguments),f.item=function(S){return this[S]},f}function h(f,S,c,R,M,V,et,lt){return i(a.apply(null,arguments))}var j=this,C=function(f,S,c){c=c||f.parentNode;for(var R=c.querySelectorAll(S),M=0;M<R.length;M++)if(R[M]===f)return!0;return!1},A=function(f){return typeof f=="string"||f.constructor===String?document.getElementById(f):f},s=function(f){return f.srcElement||f.target},_=function(f,S,c,R){if(R){if(typeof f.path<"u"&&f.path.indexOf)return{path:f.path,end:f.path.indexOf(c)};var M={path:[],end:-1},V=function(et){M.path.push(et),et===c?M.end=M.path.length-1:et.parentNode!=null&&V(et.parentNode)};return V(S),M}else return{path:[S],end:1}},u=function(f,S){for(var c=0,R=f.length;c<R&&f[c]!=S;c++);c<f.length&&f.splice(c,1)},o=1,m=function(f,S,c){var R=o++;return f.__ta=f.__ta||{},f.__ta[S]=f.__ta[S]||{},f.__ta[S][R]=c,c.__tauid=R,R},D=function(f,S,c){if(f.__ta&&f.__ta[S]&&delete f.__ta[S][c.__tauid],c.__taExtra){for(var R=0;R<c.__taExtra.length;R++)ot(f,c.__taExtra[R][0],c.__taExtra[R][1]);c.__taExtra.length=0}c.__taUnstore&&c.__taUnstore()},L=function(f,S,c,R){if(f==null)return c;var M=f.split(","),V=function(et){V.__tauid=c.__tauid;var lt=s(et),st=lt,ct=_(et,lt,S,f!=null);if(ct.end!=-1)for(var Et=0;Et<ct.end;Et++){st=ct.path[Et];for(var yt=0;yt<M.length;yt++)C(st,M[yt],S)&&c.apply(st,arguments)}};return k(c,R,V),V},k=function(f,S,c){f.__taExtra=f.__taExtra||[],f.__taExtra.push([S,c])},v=function(f,S,c,R){if(I&&p[S]){var M=L(R,f,c,p[S]);X(f,p[S],M,c)}S==="focus"&&f.getAttribute("tabindex")==null&&f.setAttribute("tabindex","1"),X(f,S,L(R,f,c,S),c)},l=function(f,S,c,R){if(f.__taSmartClicks==null){var M=function(lt){f.__tad=W(lt)},V=function(lt){f.__tau=W(lt)},et=function(lt){if(f.__tad&&f.__tau&&f.__tad[0]===f.__tau[0]&&f.__tad[1]===f.__tau[1])for(var st=0;st<f.__taSmartClicks.length;st++)f.__taSmartClicks[st].apply(s(lt),[lt])};v(f,"mousedown",M,R),v(f,"mouseup",V,R),v(f,"click",et,R),f.__taSmartClicks=[]}f.__taSmartClicks.push(c),c.__taUnstore=function(){u(f.__taSmartClicks,c)}},z={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},q=function(f,S){return function(c,R,M,V){if(R=="contextmenu"&&H)v(c,R,M,V);else{if(c.__taTapHandler==null){var et=c.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},lt=function(yt){for(var vt=s(yt),Ct=_(yt,vt,c,V!=null),Ot=!1,xt=0;xt<Ct.end;xt++){if(Ot)return;vt=Ct.path[xt];for(var Pt=0;Pt<et.downSelectors.length;Pt++)if(et.downSelectors[Pt]==null||C(vt,et.downSelectors[Pt],c)){et.down=!0,setTimeout(ct,f),setTimeout(Et,S),Ot=!0;break}}},st=function(yt){if(et.down){var vt=s(yt),Ct,Ot;et.taps++;var xt=y(yt);for(var Pt in z)if(z.hasOwnProperty(Pt)){var Bt=z[Pt];if(Bt.touches===xt&&(Bt.taps===1||Bt.taps===et.taps))for(var Mt=0;Mt<et[Pt].length;Mt++){Ot=_(yt,vt,c,et[Pt][Mt][1]!=null);for(var gt=0;gt<Ot.end;gt++)if(Ct=Ot.path[gt],et[Pt][Mt][1]==null||C(Ct,et[Pt][Mt][1],c)){et[Pt][Mt][0].apply(Ct,[yt]);break}}}}},ct=function(){et.down=!1},Et=function(){et.taps=0};v(c,"mousedown",lt),v(c,"mouseup",st)}c.__taTapHandler.downSelectors.push(V),c.__taTapHandler[R].push([M,V]),M.__taUnstore=function(){u(c.__taTapHandler[R],M)}}}},tt=function(f,S,c,R){for(var M in c.__tamee[f])c.__tamee[f].hasOwnProperty(M)&&c.__tamee[f][M].apply(R,[S])},Y=function(){var f=[];return function(S,c,R,M){if(!S.__tamee){S.__tamee={over:!1,mouseenter:[],mouseexit:[]};var V=function(lt){var st=s(lt);(M==null&&st==S&&!S.__tamee.over||C(st,M,S)&&(st.__tamee==null||!st.__tamee.over))&&(tt("mouseenter",lt,S,st),st.__tamee=st.__tamee||{},st.__tamee.over=!0,f.push(st))},et=function(lt){for(var st=s(lt),ct=0;ct<f.length;ct++)st==f[ct]&&!C(lt.relatedTarget||lt.toElement,"*",st)&&(st.__tamee.over=!1,f.splice(ct,1),tt("mouseexit",lt,S,st))};X(S,"mouseover",L(M,S,V,"mouseover"),V),X(S,"mouseout",L(M,S,et,"mouseout"),et)}R.__taUnstore=function(){delete S.__tamee[c][R.__tauid]},m(S,c,R),S.__tamee[c][R.__tauid]=R}},I="ontouchstart"in document.documentElement||navigator.maxTouchPoints,H="onmousedown"in document.documentElement,p={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},E=function(){var f=-1;if(navigator.appName=="Microsoft Internet Explorer"){var S=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(S)!=null&&(f=parseFloat(RegExp.$1))}return f}(),x=E>-1&&E<9,B=function(f,S){if(f==null)return[0,0];var c=O(f),R=U(c,0);return[R[S+"X"],R[S+"Y"]]},W=function(f){return f==null?[0,0]:x?[f.clientX+document.documentElement.scrollLeft,f.clientY+document.documentElement.scrollTop]:B(f,"page")},w=function(f){return B(f,"screen")},K=function(f){return B(f,"client")},U=function(f,S){return f.item?f.item(S):f[S]},O=function(f){return f.touches&&f.touches.length>0?f.touches:f.changedTouches&&f.changedTouches.length>0?f.changedTouches:f.targetTouches&&f.targetTouches.length>0?f.targetTouches:[f]},y=function(f){return O(f).length},X=function(f,S,c,R){if(m(f,S,c),R.__tauid=c.__tauid,f.addEventListener)f.addEventListener(S,c,!1);else if(f.attachEvent){var M=S+c.__tauid;f["e"+M]=c,f[M]=function(){f["e"+M]&&f["e"+M](window.event)},f.attachEvent("on"+S,f[M])}},ot=function(f,S,c){c!=null&&Q(f,function(){var R=A(this);if(D(R,S,c),c.__tauid!=null){if(R.removeEventListener)R.removeEventListener(S,c,!1),I&&p[S]&&R.removeEventListener(p[S],c,!1);else if(this.detachEvent){var M=S+c.__tauid;R[M]&&R.detachEvent("on"+S,R[M]),R[M]=null,R["e"+M]=null}}c.__taTouchProxy&&ot(f,c.__taTouchProxy[1],c.__taTouchProxy[0])})},Q=function(f,S){if(f!=null){f=typeof Window<"u"&&typeof f.top!="unknown"&&f==f.top?[f]:typeof f!="string"&&f.tagName==null&&f.length!=null?f:typeof f=="string"?document.querySelectorAll(f):[f];for(var c=0;c<f.length;c++)S.apply(f[c])}},it=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var S=Math.random()*16|0,c=f=="x"?S:S&3|8;return c.toString(16)})};j.Mottle=function(f){f=f||{};var S=f.clickThreshold||250,c=f.dblClickThreshold||450,R=new Y,M=new q(S,c),V=f.smartClicks,et=function(lt,st,ct,Et){ct!=null&&Q(lt,function(){var yt=A(this);V&&st==="click"?l(yt,st,ct,Et):st==="tap"||st==="dbltap"||st==="contextmenu"?M(yt,st,ct,Et):st==="mouseenter"||st=="mouseexit"?R(yt,st,ct,Et):v(yt,st,ct,Et)})};this.remove=function(lt){return Q(lt,function(){var st=A(this);if(st.__ta){for(var ct in st.__ta)if(st.__ta.hasOwnProperty(ct))for(var Et in st.__ta[ct])st.__ta[ct].hasOwnProperty(Et)&&ot(st,ct,st.__ta[ct][Et])}st.parentNode&&st.parentNode.removeChild(st)}),this},this.on=function(lt,st,ct,Et){var yt=arguments[0],vt=arguments.length==4?arguments[2]:null,Ct=arguments[1],Ot=arguments[arguments.length-1];return et(yt,Ct,Ot,vt),this},this.off=function(lt,st,ct){return ot(lt,st,ct),this},this.trigger=function(lt,st,ct,Et){var yt=H&&(typeof MouseEvent>"u"||ct==null||ct.constructor===MouseEvent),vt=I&&!H&&p[st]?p[st]:st,Ct=!(I&&!H&&p[st]),Ot=W(ct),xt=w(ct),Pt=K(ct);return Q(lt,function(){var Bt=A(this),Mt;ct=ct||{screenX:xt[0],screenY:xt[1],clientX:Pt[0],clientY:Pt[1]};var gt=function(Nt){Et&&(Nt.payload=Et)},ht={TouchEvent:function(Nt){var Yt=h(window,Bt,0,Ot[0],Ot[1],xt[0],xt[1],Pt[0],Pt[1]),Qt=Nt.initTouchEvent||Nt.initEvent;Qt(vt,!0,!0,window,null,xt[0],xt[1],Pt[0],Pt[1],!1,!1,!1,!1,Yt,Yt,Yt,1,0)},MouseEvents:function(Nt){Nt.initMouseEvent(vt,!0,!0,window,0,xt[0],xt[1],Pt[0],Pt[1],!1,!1,!1,!1,1,Bt)}};if(document.createEvent){var bt=!Ct&&!yt&&I&&p[st],Dt=bt?"TouchEvent":"MouseEvents";Mt=document.createEvent(Dt),ht[Dt](Mt),gt(Mt),Bt.dispatchEvent(Mt)}else document.createEventObject&&(Mt=document.createEventObject(),Mt.eventType=Mt.eventName=vt,Mt.screenX=xt[0],Mt.screenY=xt[1],Mt.clientX=Pt[0],Mt.clientY=Pt[1],gt(Mt),Bt.fireEvent("on"+vt,Mt))}),this}},j.Mottle.consume=function(f,S){f.stopPropagation?f.stopPropagation():f.returnValue=!1,!S&&f.preventDefault&&f.preventDefault()},j.Mottle.pageLocation=W,j.Mottle.setForceTouchEvents=function(f){I=f},j.Mottle.setForceMouseEvents=function(f){H=f},j.Mottle.version="0.8.0",g.Mottle=j.Mottle}.call(typeof window>"u"?ie:window),function(){var a=this,i=function(f,S,c){return f.indexOf(S)===-1?(c?f.unshift(S):f.push(S),!0):!1},h=function(f,S){var c=f.indexOf(S);c!==-1&&f.splice(c,1)},j=function(f,S){for(var c=[],R=0;R<f.length;R++)S.indexOf(f[R])===-1&&c.push(f[R]);return c},C=function(f){return f==null?!1:typeof f=="string"||f.constructor===String},A=function(f){var S=f.getBoundingClientRect(),c=document.body,R=document.documentElement,M=window.pageYOffset||R.scrollTop||c.scrollTop,V=window.pageXOffset||R.scrollLeft||c.scrollLeft,et=R.clientTop||c.clientTop||0,lt=R.clientLeft||c.clientLeft||0,st=S.top+M-et,ct=S.left+V-lt;return{top:Math.round(st),left:Math.round(ct)}},s=function(f,S,c){c=c||f.parentNode;for(var R=c.querySelectorAll(S),M=0;M<R.length;M++)if(R[M]===f)return!0;return!1},_=function(f,S,c){if(s(S,c,f))return S;for(var R=S.parentNode;R!=null&&R!==f;){if(s(R,c,f))return R;R=R.parentNode}},u=function(f,S,c){for(var R=null,M=S.getAttribute("katavorio-draggable"),V=M!=null?"[katavorio-draggable='"+M+"'] ":"",et=0;et<f.length;et++)if(R=_(S,c,V+f[et].selector),R!=null){if(f[et].filter){var lt=s(c,f[et].filter,R),st=f[et].filterExclude===!0;if(st&&!lt||lt)return null}return[f[et],R]}return null},o=function(){var f=-1;if(navigator.appName==="Microsoft Internet Explorer"){var S=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(S)!=null&&(f=parseFloat(RegExp.$1))}return f}(),m=10,D=10,L=o>-1&&o<9,k=o===9,v=function(f){if(L)return[f.clientX+document.documentElement.scrollLeft,f.clientY+document.documentElement.scrollTop];var S=z(f),c=l(S,0);return k?[c.pageX||c.clientX,c.pageY||c.clientY]:[c.pageX,c.pageY]},l=function(f,S){return f.item?f.item(S):f[S]},z=function(f){return f.touches&&f.touches.length>0?f.touches:f.changedTouches&&f.changedTouches.length>0?f.changedTouches:f.targetTouches&&f.targetTouches.length>0?f.targetTouches:[f]},q={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},tt="katavorio-drag-scope",Y=["stop","start","drag","drop","over","out","beforeStart"],I=function(){},H=function(){return!0},p=function(f,S,c){for(var R=0;R<f.length;R++)f[R]!=c&&S(f[R])},E=function(f,S,c,R){p(f,function(M){M.setActive(S),S&&M.updatePosition(),c&&M.setHover(R,S)})},x=function(f,S){if(f!=null){f=!C(f)&&f.tagName==null&&f.length!=null?f:[f];for(var c=0;c<f.length;c++)S.apply(f[c],[f[c]])}},B=function(f){f.stopPropagation?(f.stopPropagation(),f.preventDefault()):f.returnValue=!1},W="input,textarea,select,button,option",w=function(f,S,c){var R=f.srcElement||f.target;return!s(R,c.getInputFilterSelector(),S)},K=function(f,S,c,R){this.params=S||{},this.el=f,this.params.addClass(this.el,this._class),this.uuid=ot();var M=!0;return this.setEnabled=function(V){M=V},this.isEnabled=function(){return M},this.toggleEnabled=function(){M=!M},this.setScope=function(V){this.scopes=V?V.split(/\s+/):[R]},this.addScope=function(V){var et={};x(this.scopes,function(st){et[st]=!0}),x(V?V.split(/\s+/):[],function(st){et[st]=!0}),this.scopes=[];for(var lt in et)this.scopes.push(lt)},this.removeScope=function(V){var et={};x(this.scopes,function(st){et[st]=!0}),x(V?V.split(/\s+/):[],function(st){delete et[st]}),this.scopes=[];for(var lt in et)this.scopes.push(lt)},this.toggleScope=function(V){var et={};x(this.scopes,function(st){et[st]=!0}),x(V?V.split(/\s+/):[],function(st){et[st]?delete et[st]:et[st]=!0}),this.scopes=[];for(var lt in et)this.scopes.push(lt)},this.setScope(S.scope),this.k=S.katavorio,S.katavorio},U=function(){return!0},O=function(){return!1},y=function(f,S,c,R){this._class=c.draggable;var M=K.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var V=[0,0],et=null,lt=null,st=[0,0],ct=!1,Et=[0,0],yt=this.params.consumeStartEvent!==!1,vt=this.el,Ct=this.params.clone;this.params.scroll;var Ot=S.multipleDrop!==!1,xt=!1,Pt,Bt,Mt=null,gt=[],ht=null,bt=S.ghostProxyParent,Dt,Nt,Yt,Qt;if(S.ghostProxy===!0?Pt=U:S.ghostProxy&&typeof S.ghostProxy=="function"?Pt=S.ghostProxy:Pt=function(_t,qt){return ht&&ht.useGhostProxy?ht.useGhostProxy(_t,qt):!1},S.makeGhostProxy?Bt=S.makeGhostProxy:Bt=function(_t){return ht&&ht.makeGhostProxy?ht.makeGhostProxy(_t):_t.cloneNode(!0)},S.selector){var _e=f.getAttribute("katavorio-draggable");_e==null&&(_e=""+new Date().getTime(),f.setAttribute("katavorio-draggable",_e)),gt.push(S)}var Se=S.snapThreshold,Oe=function(_t,qt,$t,Ft,Vt){var Wt=Math.floor(_t[0]/qt),b=qt*Wt,Z=b+qt,G=Math.abs(_t[0]-b)<=Ft?b:Math.abs(Z-_t[0])<=Ft?Z:_t[0],J=Math.floor(_t[1]/$t),at=$t*J,ft=at+$t,St=Math.abs(_t[1]-at)<=Vt?at:Math.abs(ft-_t[1])<=Vt?ft:_t[1];return[G,St]};this.posses=[],this.posseRoles={},this.toGrid=function(_t){if(this.params.grid==null)return _t;var qt=this.params.grid?this.params.grid[0]/2:Se||m/2,$t=this.params.grid?this.params.grid[1]/2:Se||D/2;return Oe(_t,this.params.grid[0],this.params.grid[1],qt,$t)},this.snap=function(_t,qt){if(vt!=null){_t=_t||(this.params.grid?this.params.grid[0]:m),qt=qt||(this.params.grid?this.params.grid[1]:D);var $t=this.params.getPosition(vt),Ft=this.params.grid?this.params.grid[0]/2:Se,Vt=this.params.grid?this.params.grid[1]/2:Se,Wt=Oe($t,_t,qt,Ft,Vt);return this.params.setPosition(vt,Wt),Wt}},this.setUseGhostProxy=function(_t){Pt=_t?U:O};var Pe,dn=function(_t){return S.allowNegative===!1?[Math.max(0,_t[0]),Math.max(0,_t[1])]:_t},Qe=function(_t){Pe=typeof _t=="function"?_t:_t?function(qt,$t,Ft,Vt){return dn([Math.max(0,Math.min(Ft.w-Vt[0],qt[0])),Math.max(0,Math.min(Ft.h-Vt[1],qt[1]))])}.bind(this):function(qt){return dn(qt)}}.bind(this);Qe(typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(_t){Qe(_t)};var tn=function(_t,qt,$t,Ft){return ht!=null&&ht.constrain&&typeof ht.constrain=="function"?ht.constrain(_t,qt,$t,Ft):Pe(_t,qt,$t,Ft)},Te;this.setRevert=function(_t){Te=_t},this.params.revert&&(Te=this.params.revert);var Ge=function(_t){return typeof _t=="function"?(_t._katavorioId=ot(),_t._katavorioId):_t},Le={},qe=function(_t){for(var qt in Le){var $t=Le[qt],Ft=$t[0](_t);if($t[1]&&(Ft=!Ft),!Ft)return!1}return!0},Ye=this.setFilter=function(_t,qt){if(_t){var $t=Ge(_t);Le[$t]=[function(Ft){var Vt=Ft.srcElement||Ft.target,Wt;return C(_t)?Wt=s(Vt,_t,f):typeof _t=="function"&&(Wt=_t(Ft,f)),Wt},qt!==!1]}};this.addFilter=Ye,this.removeFilter=function(_t){var qt=typeof _t=="function"?_t._katavorioId:_t;delete Le[qt]},this.clearAllFilters=function(){Le={}},this.canDrag=this.params.canDrag||H;var Xe,oe=[],Ce=[];this.addSelector=function(_t){_t.selector&&gt.push(_t)},this.downListener=function(_t){if(!_t.defaultPrevented){var qt=this.rightButtonCanDrag||_t.which!==3&&_t.button!==2;if(qt&&this.isEnabled()&&this.canDrag()){var $t=qe(_t)&&w(_t,this.el,this.k);if($t){if(ht=null,Mt=null,gt.length>0){var Ft=u(gt,this.el,_t.target||_t.srcElement);if(Ft!=null&&(ht=Ft[0],Mt=Ft[1]),Mt==null)return}else Mt=this.el;if(Ct)if(vt=Mt.cloneNode(!0),this.params.addClass(vt,q.clonedDrag),vt.setAttribute("id",null),vt.style.position="absolute",this.params.parent!=null){var Vt=this.params.getPosition(this.el);vt.style.left=Vt[0]+"px",vt.style.top=Vt[1]+"px",this.params.parent.appendChild(vt)}else{var Wt=A(Mt);vt.style.left=Wt.left+"px",vt.style.top=Wt.top+"px",document.body.appendChild(vt)}else vt=Mt;yt&&B(_t),V=v(_t),vt&&vt.parentNode&&(Et=[vt.parentNode.scrollLeft,vt.parentNode.scrollTop]),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),M.markSelection(this),M.markPosses(this),this.params.addClass(document.body,c.noSelect),Me("beforeStart",{el:this.el,pos:et,e:_t,drag:this})}else this.params.consumeFilteredEvents&&B(_t)}}}.bind(this),this.moveListener=function(_t){if(V){if(!ct){var qt=Me("start",{el:this.el,pos:et,e:_t,drag:this});if(qt!==!1){if(!V)return;this.mark(!0),ct=!0}else this.abort()}if(V){Ce.length=0;var $t=v(_t),Ft=$t[0]-V[0],Vt=$t[1]-V[1],Wt=this.params.ignoreZoom?1:M.getZoom();vt&&vt.parentNode&&(Ft+=vt.parentNode.scrollLeft-Et[0],Vt+=vt.parentNode.scrollTop-Et[1]),Ft/=Wt,Vt/=Wt,this.moveBy(Ft,Vt,_t),M.updateSelection(Ft,Vt,this),M.updatePosses(Ft,Vt,this)}}}.bind(this),this.upListener=function(_t){V&&(V=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,c.noSelect),this.unmark(_t),M.unmarkSelection(this,_t),M.unmarkPosses(this,_t),this.stop(_t),M.notifyPosseDragStop(this,_t),ct=!1,Ce.length=0,Ct?(vt&&vt.parentNode&&vt.parentNode.removeChild(vt),vt=null):Te&&Te(vt,this.params.getPosition(vt))===!0&&(this.params.setPosition(vt,et),Me("revert",vt)))}.bind(this),this.getFilters=function(){return Le},this.abort=function(){V!=null&&this.upListener()},this.getDragElement=function(_t){return _t?Mt||this.el:vt||this.el};var fe={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};S.events.start&&fe.start.push(S.events.start),S.events.beforeStart&&fe.beforeStart.push(S.events.beforeStart),S.events.stop&&fe.stop.push(S.events.stop),S.events.drag&&fe.drag.push(S.events.drag),S.events.revert&&fe.revert.push(S.events.revert),this.on=function(_t,qt){fe[_t]&&fe[_t].push(qt)},this.off=function(_t,qt){if(fe[_t]){for(var $t=[],Ft=0;Ft<fe[_t].length;Ft++)fe[_t][Ft]!==qt&&$t.push(fe[_t][Ft]);fe[_t]=$t}};var Me=function(_t,qt){var $t=null;if(ht&&ht[_t])$t=ht[_t](qt);else if(fe[_t])for(var Ft=0;Ft<fe[_t].length;Ft++)try{var Vt=fe[_t][Ft](qt);Vt!=null&&($t=Vt)}catch{}return $t};this.notifyStart=function(_t){Me("start",{el:this.el,pos:this.params.getPosition(vt),e:_t,drag:this})},this.stop=function(_t,qt){if(qt||ct){var $t=[],Ft=M.getSelection(),Vt=this.params.getPosition(vt);if(Ft.length>0)for(var Wt=0;Wt<Ft.length;Wt++){var b=this.params.getPosition(Ft[Wt].el);$t.push([Ft[Wt].el,{left:b[0],top:b[1]},Ft[Wt]])}else $t.push([vt,{left:Vt[0],top:Vt[1]},this]);Me("stop",{el:vt,pos:pe||Vt,finalPos:Vt,e:_t,drag:this,selection:$t})}},this.mark=function(_t){et=this.params.getPosition(vt),lt=this.params.getPosition(vt,!0),st=[lt[0]-et[0],lt[1]-et[1]],this.size=this.params.getSize(vt),oe=M.getMatchingDroppables(this),E(oe,!0,!1,this),this.params.addClass(vt,this.params.dragClass||c.drag);var qt;this.params.getConstrainingRectangle?qt=this.params.getConstrainingRectangle(vt):qt=this.params.getSize(vt.parentNode),Xe={w:qt[0],h:qt[1]},Yt=0,Qt=0,_t&&M.notifySelectionDragStart(this)};var pe;this.unmark=function(_t,qt){if(E(oe,!1,!0,this),xt&&Pt(Mt,vt)?(pe=[vt.offsetLeft-Yt,vt.offsetTop-Qt],vt.parentNode.removeChild(vt),vt=Mt):pe=null,this.params.removeClass(vt,this.params.dragClass||c.drag),oe.length=0,xt=!1,!qt){Ce.length>0&&pe&&S.setPosition(Mt,pe),Ce.sort(Q);for(var $t=0;$t<Ce.length;$t++){var Ft=Ce[$t].drop(this,_t);if(Ft===!0)break}}},this.moveBy=function(_t,qt,$t){Ce.length=0;var Ft=this.toGrid([et[0]+_t,et[1]+qt]),Vt=tn(Ft,vt,Xe,this.size);if(Pt(this.el,vt))if(Ft[0]!==Vt[0]||Ft[1]!==Vt[1]){if(!xt){var Wt=Bt(Mt);S.addClass(Wt,q.ghostProxy),bt?(bt.appendChild(Wt),Dt=S.getPosition(Mt.parentNode,!0),Nt=S.getPosition(S.ghostProxyParent,!0),Yt=Dt[0]-Nt[0],Qt=Dt[1]-Nt[1]):Mt.parentNode.appendChild(Wt),vt=Wt,xt=!0}Vt=Ft}else xt&&(vt.parentNode.removeChild(vt),vt=Mt,xt=!1,Dt=null,Nt=null,Yt=0,Qt=0);var b={x:Vt[0],y:Vt[1],w:this.size[0],h:this.size[1]},Z={x:b.x+st[0],y:b.y+st[1],w:b.w,h:b.h},G=null;this.params.setPosition(vt,[Vt[0]+Yt,Vt[1]+Qt]);for(var J=0;J<oe.length;J++){var at={x:oe[J].pagePosition[0],y:oe[J].pagePosition[1],w:oe[J].size[0],h:oe[J].size[1]};this.params.intersects(Z,at)&&(Ot||G==null||G===oe[J].el)&&oe[J].canDrop(this)?(G||(G=oe[J].el),Ce.push(oe[J]),oe[J].setHover(this,!0,$t)):oe[J].isHover()&&oe[J].setHover(this,!1,$t)}Me("drag",{el:this.el,pos:Vt,e:$t,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?Ye(this.params.handle,!1):Ye(this.params.filter,this.params.filterExclude)},X=function(f,S,c,R){this._class=c.droppable,this.params=S||{},this.rank=S.rank||0,this._activeClass=this.params.activeClass||c.active,this._hoverClass=this.params.hoverClass||c.hover,K.apply(this,arguments);var M=!1;this.allowLoopback=this.params.allowLoopback!==!1,this.setActive=function(V){this.params[V?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(V){return!0},this.isHover=function(){return M},this.setHover=function(V,et,lt){(et||this.el._katavorioDragHover==null||this.el._katavorioDragHover===V.el._katavorio)&&(this.params[et?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=et?V.el._katavorio:null,M!==et&&this.params.events[et?"over":"out"]({el:this.el,e:lt,drag:V,drop:this}),M=et)},this.drop=function(V,et){return this.params.events.drop({drag:V,e:et,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,M=null}},ot=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var S=Math.random()*16|0,c=f==="x"?S:S&3|8;return c.toString(16)})},Q=function(f,S){return f.rank<S.rank?1:f.rank>S.rank?-1:0},it=function(f){return f==null||(f=typeof f=="string"||f.constructor===String?document.getElementById(f):f,f==null)?null:(f._katavorio=f._katavorio||ot(),f)};a.Katavorio=function(f){var S=[],c={};this._dragsByScope={},this._dropsByScope={};var R=1,M=function(gt,ht){x(gt,function(bt){for(var Dt=0;Dt<bt.scopes.length;Dt++)ht[bt.scopes[Dt]]=ht[bt.scopes[Dt]]||[],ht[bt.scopes[Dt]].push(bt)})},V=function(gt,ht){var bt=0;return x(gt,function(Dt){for(var Nt=0;Nt<Dt.scopes.length;Nt++)if(ht[Dt.scopes[Nt]]){var Yt=f.indexOf(ht[Dt.scopes[Nt]],Dt);Yt!==-1&&(ht[Dt.scopes[Nt]].splice(Yt,1),bt++)}}),bt>0};this.getMatchingDroppables=function(gt){for(var ht=[],bt={},Dt=0;Dt<gt.scopes.length;Dt++){var Nt=this._dropsByScope[gt.scopes[Dt]];if(Nt)for(var Yt=0;Yt<Nt.length;Yt++)Nt[Yt].canDrop(gt)&&!bt[Nt[Yt].uuid]&&(Nt[Yt].allowLoopback||Nt[Yt].el!==gt.el)&&(bt[Nt[Yt].uuid]=!0,ht.push(Nt[Yt]))}return ht.sort(Q),ht};var et=function(gt){gt=gt||{};var ht={events:{}},bt;for(bt in f)ht[bt]=f[bt];for(bt in gt)ht[bt]=gt[bt];for(bt=0;bt<Y.length;bt++)ht.events[Y[bt]]=gt[Y[bt]]||I;return ht.katavorio=this,ht}.bind(this),lt=function(gt,ht){for(var bt=0;bt<Y.length;bt++)ht[Y[bt]]&&gt.on(Y[bt],ht[Y[bt]])}.bind(this),st={},ct=f.css||{},Et=f.scope||tt;for(var yt in q)st[yt]=q[yt];for(var yt in ct)st[yt]=ct[yt];var vt=f.inputFilterSelector||W;this.getInputFilterSelector=function(){return vt},this.setInputFilterSelector=function(gt){return vt=gt,this},this.draggable=function(gt,ht){var bt=[];return x(gt,function(Dt){if(Dt=it(Dt),Dt!=null)if(Dt._katavorioDrag==null){var Nt=et(ht);Dt._katavorioDrag=new y(Dt,Nt,st,Et),M(Dt._katavorioDrag,this._dragsByScope),bt.push(Dt._katavorioDrag),f.addClass(Dt,Nt.selector?st.delegatedDraggable:st.draggable)}else lt(Dt._katavorioDrag,ht)}.bind(this)),bt},this.droppable=function(gt,ht){var bt=[];return x(gt,function(Dt){if(Dt=it(Dt),Dt!=null){var Nt=new X(Dt,et(ht),st,Et);Dt._katavorioDrop=Dt._katavorioDrop||[],Dt._katavorioDrop.push(Nt),M(Nt,this._dropsByScope),bt.push(Nt),f.addClass(Dt,st.droppable)}}.bind(this)),bt},this.select=function(gt){return x(gt,function(){var ht=it(this);ht&&ht._katavorioDrag&&(c[ht._katavorio]||(S.push(ht._katavorioDrag),c[ht._katavorio]=[ht,S.length-1],f.addClass(ht,st.selected)))}),this},this.deselect=function(gt){return x(gt,function(){var ht=it(this);if(ht&&ht._katavorio){var bt=c[ht._katavorio];if(bt){for(var Dt=[],Nt=0;Nt<S.length;Nt++)S[Nt].el!==ht&&Dt.push(S[Nt]);S=Dt,delete c[ht._katavorio],f.removeClass(ht,st.selected)}}}),this},this.deselectAll=function(){for(var gt in c){var ht=c[gt];f.removeClass(ht[0],st.selected)}S.length=0,c={}},this.markSelection=function(gt){p(S,function(ht){ht.mark()},gt)},this.markPosses=function(gt){gt.posses&&x(gt.posses,function(ht){gt.posseRoles[ht]&&Bt[ht]&&p(Bt[ht].members,function(bt){bt.mark()},gt)})},this.unmarkSelection=function(gt,ht){p(S,function(bt){bt.unmark(ht)},gt)},this.unmarkPosses=function(gt,ht){gt.posses&&x(gt.posses,function(bt){gt.posseRoles[bt]&&Bt[bt]&&p(Bt[bt].members,function(Dt){Dt.unmark(ht,!0)},gt)})},this.getSelection=function(){return S.slice(0)},this.updateSelection=function(gt,ht,bt){p(S,function(Dt){Dt.moveBy(gt,ht)},bt)};var Ct=function(gt,ht){ht.posses&&x(ht.posses,function(bt){ht.posseRoles[bt]&&Bt[bt]&&p(Bt[bt].members,function(Dt){gt(Dt)},ht)})};this.updatePosses=function(gt,ht,bt){Ct(function(Dt){Dt.moveBy(gt,ht)},bt)},this.notifyPosseDragStop=function(gt,ht){Ct(function(bt){bt.stop(ht,!0)},gt)},this.notifySelectionDragStop=function(gt,ht){p(S,function(bt){bt.stop(ht,!0)},gt)},this.notifySelectionDragStart=function(gt,ht){p(S,function(bt){bt.notifyStart(ht)},gt)},this.setZoom=function(gt){R=gt},this.getZoom=function(){return R};var Ot=function(gt,ht,bt,Dt){x(gt,function(Nt){V(Nt,bt),Nt[Dt](ht),M(Nt,bt)})};x(["set","add","remove","toggle"],function(gt){this[gt+"Scope"]=function(ht,bt){Ot(ht._katavorioDrag,bt,this._dragsByScope,gt+"Scope"),Ot(ht._katavorioDrop,bt,this._dropsByScope,gt+"Scope")}.bind(this),this[gt+"DragScope"]=function(ht,bt){Ot(ht.constructor===y?ht:ht._katavorioDrag,bt,this._dragsByScope,gt+"Scope")}.bind(this),this[gt+"DropScope"]=function(ht,bt){Ot(ht.constructor===X?ht:ht._katavorioDrop,bt,this._dropsByScope,gt+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(gt,ht){for(var bt in this._dragsByScope)p(this._dragsByScope[bt],function(Dt){Dt.snap(gt,ht)})},this.getDragsForScope=function(gt){return this._dragsByScope[gt]},this.getDropsForScope=function(gt){return this._dropsByScope[gt]};var xt=function(gt,ht,bt){if(gt=it(gt),gt[ht]){var Dt=S.indexOf(gt[ht]);Dt>=0&&S.splice(Dt,1),V(gt[ht],bt)&&x(gt[ht],function(Nt){Nt.destroy()}),delete gt[ht]}},Pt=function(gt,ht,bt,Dt){gt=it(gt),gt[ht]&&gt[ht].off(bt,Dt)};this.elementRemoved=function(gt){gt._katavorioDrag&&this.destroyDraggable(gt),gt._katavorioDrop&&this.destroyDroppable(gt)},this.destroyDraggable=function(gt,ht,bt){arguments.length===1?xt(gt,"_katavorioDrag",this._dragsByScope):Pt(gt,"_katavorioDrag",ht,bt)},this.destroyDroppable=function(gt,ht,bt){arguments.length===1?xt(gt,"_katavorioDrop",this._dropsByScope):Pt(gt,"_katavorioDrop",ht,bt)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},S=[],c={},Bt={}};var Bt={},Mt=function(gt,ht,bt){var Dt=C(ht)?ht:ht.id,Nt=C(ht)?!0:ht.active!==!1,Yt=Bt[Dt]||function(){var Qt={name:Dt,members:[]};return Bt[Dt]=Qt,Qt}();return x(gt,function(Qt){if(Qt._katavorioDrag){if(bt&&Qt._katavorioDrag.posseRoles[Yt.name]!=null)return;i(Yt.members,Qt._katavorioDrag),i(Qt._katavorioDrag.posses,Yt.name),Qt._katavorioDrag.posseRoles[Yt.name]=Nt}}),Yt};this.addToPosse=function(gt,ht){for(var bt=[],Dt=1;Dt<arguments.length;Dt++)bt.push(Mt(gt,arguments[Dt]));return bt.length===1?bt[0]:bt},this.setPosse=function(gt,ht){for(var bt=[],Dt=1;Dt<arguments.length;Dt++)bt.push(Mt(gt,arguments[Dt],!0).name);return x(gt,function(Nt){if(Nt._katavorioDrag){var Yt=j(Nt._katavorioDrag.posses,bt),Qt=[];Array.prototype.push.apply(Qt,Nt._katavorioDrag.posses);for(var _e=0;_e<Yt.length;_e++)this.removeFromPosse(Nt,Yt[_e])}}.bind(this)),bt.length===1?bt[0]:bt},this.removeFromPosse=function(gt,ht){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var bt=1;bt<arguments.length;bt++)ht=arguments[bt],x(gt,function(Dt){if(Dt._katavorioDrag&&Dt._katavorioDrag.posses){var Nt=Dt._katavorioDrag;x(ht,function(Yt){h(Bt[Yt].members,Nt),h(Nt.posses,Yt),delete Nt.posseRoles[Yt]})}})},this.removeFromAllPosses=function(gt){x(gt,function(ht){if(ht._katavorioDrag&&ht._katavorioDrag.posses){var bt=ht._katavorioDrag;x(bt.posses,function(Dt){h(Bt[Dt].members,bt)}),bt.posses.length=0,bt.posseRoles={}}})},this.setPosseState=function(gt,ht,bt){var Dt=Bt[ht];Dt&&x(gt,function(Nt){Nt._katavorioDrag&&Nt._katavorioDrag.posses&&(Nt._katavorioDrag.posseRoles[Dt.name]=bt)})}},a.Katavorio.version="1.0.0",g.Katavorio=a.Katavorio}.call(typeof window<"u"?window:ie),function(){var a=this;a.jsPlumbUtil=a.jsPlumbUtil||{};var i=a.jsPlumbUtil;g.jsPlumbUtil=i;function h(f){return Object.prototype.toString.call(f)==="[object Array]"}i.isArray=h;function j(f){return Object.prototype.toString.call(f)==="[object Number]"}i.isNumber=j;function C(f){return typeof f=="string"}i.isString=C;function A(f){return typeof f=="boolean"}i.isBoolean=A;function s(f){return f==null}i.isNull=s;function _(f){return f==null?!1:Object.prototype.toString.call(f)==="[object Object]"}i.isObject=_;function u(f){return Object.prototype.toString.call(f)==="[object Date]"}i.isDate=u;function o(f){return Object.prototype.toString.call(f)==="[object Function]"}i.isFunction=o;function m(f){return o(f)&&f.name!=null&&f.name.length>0}i.isNamedFunction=m;function D(f){for(var S in f)if(f.hasOwnProperty(S))return!1;return!0}i.isEmpty=D;function L(f){if(C(f))return""+f;if(A(f))return!!f;if(u(f))return new Date(f.getTime());if(o(f))return f;if(h(f)){for(var S=[],c=0;c<f.length;c++)S.push(L(f[c]));return S}else if(_(f)){var R={};for(var M in f)R[M]=L(f[M]);return R}else return f}i.clone=L;function k(f,S,c,R){var M={},V,et,lt={};for(c=c||[],R=R||[],et=0;et<c.length;et++)M[c[et]]=!0;for(et=0;et<R.length;et++)lt[R[et]]=!0;var st=L(f);for(et in S)if(st[et]==null||lt[et])st[et]=S[et];else if(C(S[et])||A(S[et]))M[et]?(V=[],V.push.apply(V,h(st[et])?st[et]:[st[et]]),V.push.apply(V,A(S[et])?S[et]:[S[et]]),st[et]=V):st[et]=S[et];else if(h(S[et]))V=[],h(st[et])&&V.push.apply(V,st[et]),V.push.apply(V,S[et]),st[et]=V;else if(_(S[et])){_(st[et])||(st[et]={});for(var ct in S[et])st[et][ct]=S[et][ct]}return st}i.merge=k;function v(f,S,c){if(f!=null){var R=f,M=R;return S.replace(/([^\.])+/g,function(V,et,lt,st){var ct=V.match(/([^\[0-9]+){1}(\[)([0-9+])/),Et=lt+V.length>=st.length,yt=function(){return M[ct[1]]||function(){return M[ct[1]]=[],M[ct[1]]}()};if(Et)ct?yt()[ct[3]]=c:M[V]=c;else if(ct){var vt=yt();M=vt[ct[3]]||function(){return vt[ct[3]]={},vt[ct[3]]}()}else M=M[V]||function(){return M[V]={},M[V]}();return""}),f}}i.replace=v;function l(f,S,c){for(var R=0;R<c.length;R++){var M=c[R][0][c[R][1]].apply(c[R][0],c[R][2]);if(M===S)return M}return f}i.functionChain=l;function z(f,S,c,R){var M=function(et){var lt=et.match(/(\${.*?})/g);if(lt!=null)for(var st=0;st<lt.length;st++){var ct=S[lt[st].substring(2,lt[st].length-1)]||"";ct!=null&&(et=et.replace(lt[st],ct))}return et},V=function(et){if(et!=null){if(C(et))return M(et);if(o(et)&&!R&&(c==null||(et.name||"").indexOf(c)===0))return et(S);if(h(et)){for(var lt=[],st=0;st<et.length;st++)lt.push(V(et[st]));return lt}else if(_(et)){var ct={};for(var Et in et)ct[Et]=V(et[Et]);return ct}else return et}};return V(f)}i.populate=z;function q(f,S){if(f){for(var c=0;c<f.length;c++)if(S(f[c]))return c}return-1}i.findWithFunction=q;function tt(f,S){var c=q(f,S);return c>-1&&f.splice(c,1),c!==-1}i.removeWithFunction=tt;function Y(f,S){var c=f.indexOf(S);return c>-1&&f.splice(c,1),c!==-1}i.remove=Y;function I(f,S,c){q(f,c)===-1&&f.push(S)}i.addWithFunction=I;function H(f,S,c,R){var M=f[S];return M==null&&(M=[],f[S]=M),M[R?"unshift":"push"](c),M}i.addToList=H;function p(f,S,c){return f.indexOf(S)===-1?(c?f.unshift(S):f.push(S),!0):!1}i.suggest=p;function E(f,S,c){var R;S=h(S)?S:[S];var M=function(st){for(var ct=st.__proto__;ct!=null;)if(ct.prototype!=null){for(var Et in ct.prototype)ct.prototype.hasOwnProperty(Et)&&!f.prototype.hasOwnProperty(Et)&&(f.prototype[Et]=ct.prototype[Et]);ct=ct.prototype.__proto__}else ct=null};for(R=0;R<S.length;R++){for(var V in S[R].prototype)S[R].prototype.hasOwnProperty(V)&&!f.prototype.hasOwnProperty(V)&&(f.prototype[V]=S[R].prototype[V]);M(S[R])}var et=function(st,ct){return function(){for(R=0;R<S.length;R++)S[R].prototype[st]&&S[R].prototype[st].apply(this,arguments);return ct.apply(this,arguments)}},lt=function(st){for(var ct in st)f.prototype[ct]=et(ct,st[ct])};if(arguments.length>2)for(R=2;R<arguments.length;R++)lt(arguments[R]);return f}i.extend=E;for(var x=[],B=0;B<256;B++)x[B]=(B<16?"0":"")+B.toString(16);function W(){var f=Math.random()*4294967295|0,S=Math.random()*4294967295|0,c=Math.random()*4294967295|0,R=Math.random()*4294967295|0;return x[f&255]+x[f>>8&255]+x[f>>16&255]+x[f>>24&255]+"-"+x[S&255]+x[S>>8&255]+"-"+x[S>>16&15|64]+x[S>>24&255]+"-"+x[c&63|128]+x[c>>8&255]+"-"+x[c>>16&255]+x[c>>24&255]+x[R&255]+x[R>>8&255]+x[R>>16&255]+x[R>>24&255]}i.uuid=W;function w(f){if(f==null)return null;for(var S=f.replace(/^\s\s*/,""),c=/\s/,R=S.length;c.test(S.charAt(--R)););return S.slice(0,R+1)}i.fastTrim=w;function K(f,S){f=f.length==null||typeof f=="string"?[f]:f;for(var c=0;c<f.length;c++)S(f[c])}i.each=K;function U(f,S){for(var c=[],R=0;R<f.length;R++)c.push(S(f[R]));return c}i.map=U;function O(f,S,c){c=c||"parent";var R=function(st){return st?S[st]:null},M=function(st){return st?R(st[c]):null},V=function(st,ct){if(st==null)return ct;var Et=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];ct.mergeStrategy==="override"&&Array.prototype.push.apply(Et,["events","overlays"]);var yt=k(st,ct,[],Et);return V(M(st),yt)},et=function(st){if(st==null)return{};if(typeof st=="string")return R(st);if(st.length){for(var ct=!1,Et=0,yt=void 0;!ct&&Et<st.length;)yt=et(st[Et]),yt?ct=!0:Et++;return yt}},lt=et(f);return lt?V(M(lt),lt):{}}i.mergeWithParents=O,i.logEnabled=!0;function y(){if(i.logEnabled&&typeof console<"u")try{var f=arguments[arguments.length-1];console.log(f)}catch{}}i.log=y;function X(f,S,c){return function(){var R=null;try{S!=null&&(R=S.apply(this,arguments))}catch(M){y("jsPlumb function failed : "+M)}if(f!=null&&(c==null||R!==c))try{R=f.apply(this,arguments)}catch(M){y("wrapped function failed : "+M)}return R}}i.wrap=X;var ot=function(){function f(){var S=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(c,R,M){var V=function(lt){H(S._listeners,lt,R,M),R.__jsPlumb=R.__jsPlumb||{},R.__jsPlumb[W()]=lt};if(typeof c=="string")V(c);else if(c.length!=null)for(var et=0;et<c.length;et++)V(c[et]);return S},this.fire=function(c,R,M){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[c]){var V=this._listeners[c].length,et=0,lt=!1,st=null;if(!this.shouldFireEvent||this.shouldFireEvent(c,R,M))for(;!lt&&et<V&&st!==!1;){if(this.eventsToDieOn[c])this._listeners[c][et].apply(this,[R,M]);else try{st=this._listeners[c][et].apply(this,[R,M])}catch(ct){y("jsPlumb: fire failed for event "+c+" : "+ct)}et++,(this._listeners==null||this._listeners[c]==null)&&(lt=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var c=S.queue.pop();c&&S.fire.apply(S,c)},this.unbind=function(c,R){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof c=="string")delete this._listeners[c];else if(c.__jsPlumb){var M=void 0;for(var V in c.__jsPlumb)M=c.__jsPlumb[V],Y(this._listeners[M]||[],c)}}else arguments.length===2&&Y(this._listeners[c]||[],R);return this},this.getListener=function(c){return S._listeners[c]},this.setSuspendEvents=function(c){S.eventsSuspended=c},this.isSuspendEvents=function(){return S.eventsSuspended},this.silently=function(c){S.setSuspendEvents(!0);try{c()}catch(R){y("Cannot execute silent function "+R)}S.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var c in S._listeners)S._listeners[c]=null}}return f}();i.EventGenerator=ot;function Q(f,S,c){var R=[f[0]-S[0],f[1]-S[1]],M=Math.cos(c/360*Math.PI*2),V=Math.sin(c/360*Math.PI*2);return[R[0]*M-R[1]*V+S[0],R[1]*M+R[0]*V+S[1],M,V]}i.rotatePoint=Q;function it(f,S){var c=Q(f,[0,0],S);return[Math.round(c[0]),Math.round(c[1])]}i.rotateAnchorOrientation=it}.call(typeof window<"u"?window:ie),function(){var a=this;a.jsPlumbUtil.matchesSelector=function(i,h,j){j=j||i.parentNode;for(var C=j.querySelectorAll(h),A=0;A<C.length;A++)if(C[A]===i)return!0;return!1},a.jsPlumbUtil.consume=function(i,h){i.stopPropagation?i.stopPropagation():i.returnValue=!1,!h&&i.preventDefault&&i.preventDefault()},a.jsPlumbUtil.sizeElement=function(i,h,j,C,A){i&&(i.style.height=A+"px",i.height=A,i.style.width=C+"px",i.width=C,i.style.left=h+"px",i.style.top=j+"px")}}.call(typeof window<"u"?window:ie),function(){var a={deriveAnchor:function(C,A,s,_){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[C][A]}},i=this,h=function(C,A){this.count=0,this.instance=C,this.lists={},this.options=A||{},this.instance.addList=function(s,_){return this.listManager.addList(s,_)},this.instance.removeList=function(s){this.listManager.removeList(s)},this.instance.bind("manageElement",function(s){for(var _=this.instance.getSelector(s.el,"[jtk-scrollable-list]"),u=0;u<_.length;u++)this.addList(_[u])}.bind(this)),this.instance.bind("unmanageElement",function(s){this.removeList(s.el)}),this.instance.bind("connection",function(s,_){_==null&&(this._maybeUpdateParentList(s.source),this._maybeUpdateParentList(s.target))}.bind(this))};i.jsPlumbListManager=h,h.prototype={addList:function(C,A){var s=this.instance.extend({},a);this.instance.extend(s,this.options),A=this.instance.extend(s,A||{});var _=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[_]=new j(this.instance,C,A,_)},removeList:function(C){var A=this.lists[C._jsPlumbList];A&&(A.destroy(),delete this.lists[C._jsPlumbList])},_maybeUpdateParentList:function(C){for(var A=C.parentNode,s=this.instance.getContainer();A!=null&&A!==s;){if(A._jsPlumbList!=null&&this.lists[A._jsPlumbList]!=null){A._jsPlumbScrollHandler();return}A=A.parentNode}}};var j=function(C,A,s,_){A._jsPlumbList=_;function u(L,k,v,l){return s.anchor?s.anchor:s.deriveAnchor(L,k,v,l)}function o(L,k,v,l){return s.deriveEndpoint?s.deriveEndpoint(L,k,v,l):s.endpoint?s.endpoint:v.type}function m(L){for(var k=L.parentNode,v=C.getContainer();k!=null&&k!==v;){if(C.hasClass(k,"jtk-managed")){C.recalculateOffsets(k);return}k=k.parentNode}}var D=function(L){for(var k=C.getSelector(A,".jtk-managed"),v=C.getId(A),l=0;l<k.length;l++){if(k[l].offsetTop<A.scrollTop)k[l]._jsPlumbProxies||(k[l]._jsPlumbProxies=k[l]._jsPlumbProxies||[],C.select({source:k[l]}).each(function(q){C.proxyConnection(q,0,A,v,function(){return o("top",0,q.endpoints[0],q)},function(){return u("top",0,q.endpoints[0],q)}),k[l]._jsPlumbProxies.push([q,0])}),C.select({target:k[l]}).each(function(q){C.proxyConnection(q,1,A,v,function(){return o("top",1,q.endpoints[1],q)},function(){return u("top",1,q.endpoints[1],q)}),k[l]._jsPlumbProxies.push([q,1])}));else if(k[l].offsetTop+k[l].offsetHeight>A.scrollTop+A.offsetHeight)k[l]._jsPlumbProxies||(k[l]._jsPlumbProxies=k[l]._jsPlumbProxies||[],C.select({source:k[l]}).each(function(q){C.proxyConnection(q,0,A,v,function(){return o("bottom",0,q.endpoints[0],q)},function(){return u("bottom",0,q.endpoints[0],q)}),k[l]._jsPlumbProxies.push([q,0])}),C.select({target:k[l]}).each(function(q){C.proxyConnection(q,1,A,v,function(){return o("bottom",1,q.endpoints[1],q)},function(){return u("bottom",1,q.endpoints[1],q)}),k[l]._jsPlumbProxies.push([q,1])}));else if(k[l]._jsPlumbProxies){for(var z=0;z<k[l]._jsPlumbProxies.length;z++)C.unproxyConnection(k[l]._jsPlumbProxies[z][0],k[l]._jsPlumbProxies[z][1],v);delete k[l]._jsPlumbProxies}C.revalidate(k[l])}m(A)};C.setAttribute(A,"jtk-scrollable-list","true"),A._jsPlumbScrollHandler=D,C.on(A,"scroll",D),D(),this.destroy=function(){C.off(A,"scroll",D),delete A._jsPlumbScrollHandler;for(var L=C.getSelector(A,".jtk-managed"),k=C.getId(A),v=0;v<L.length;v++)if(L[v]._jsPlumbProxies){for(var l=0;l<L[v]._jsPlumbProxies.length;l++)C.unproxyConnection(L[v]._jsPlumbProxies[l][0],L[v]._jsPlumbProxies[l][1],k);delete L[v]._jsPlumbProxies}}}}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumbUtil,h=function(v){if(v._jsPlumb.paintStyle&&v._jsPlumb.hoverPaintStyle){var l={};k.extend(l,v._jsPlumb.paintStyle),k.extend(l,v._jsPlumb.hoverPaintStyle),delete v._jsPlumb.hoverPaintStyle,l.gradient&&v._jsPlumb.paintStyle.fill&&delete l.gradient,v._jsPlumb.hoverPaintStyle=l}},j=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],C=function(v,l,z,q){var tt=v.getAttachedElements();if(tt)for(var Y=0,I=tt.length;Y<I;Y++)(!q||q!==tt[Y])&&tt[Y].setHover(l,!0,z)},A=function(v){return v==null?null:v.split(" ")},s=function(v,l,z){for(var q in l)v[q]=z},_=function(v,l,z){if(v.getDefaultType){var q=v.getTypeDescriptor(),tt={},Y=v.getDefaultType(),I=i.merge({},Y);s(tt,Y,"__default");for(var H=0,p=v._jsPlumb.types.length;H<p;H++){var E=v._jsPlumb.types[H];if(E!=="__default"){var x=v._jsPlumb.instance.getType(E,q);if(x!=null){var B=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"],W=[];x.mergeStrategy==="override"?Array.prototype.push.apply(B,["events","overlays","cssClass"]):W.push("cssClass"),I=i.merge(I,x,W,B),s(tt,x,E)}}}l&&(I=i.populate(I,l,"_")),v.applyType(I,z,tt),z||v.repaint()}},u=a.jsPlumbUIComponent=function(v){i.EventGenerator.apply(this,arguments);var l=this,z=arguments,q=l.idPrefix,tt=q+new Date().getTime();this._jsPlumb={instance:v._jsPlumb,parameters:v.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:v.beforeDetach,beforeDrop:v.beforeDrop,overlayPlacements:[],hoverClass:v.hoverClass||v._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(W,w,K){this._jsPlumb.typeCache[K]=this._jsPlumb.typeCache[K]||{},this._jsPlumb.typeCache[K][W]=w},this.getCachedTypeItem=function(W,w){return this._jsPlumb.typeCache[w]?this._jsPlumb.typeCache[w][W]:null},this.getId=function(){return tt};var Y=v.overlays||[],I={};if(this.defaultOverlayKeys){for(var H=0;H<this.defaultOverlayKeys.length;H++)Array.prototype.push.apply(Y,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[H]]||[]);for(H=0;H<Y.length;H++){var p=k.convertToFullOverlaySpec(Y[H]);I[p[1].id]=p}}var E={overlays:I,parameters:v.parameters||{},scope:v.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return E},this.appendToDefaultType=function(W){for(var w in W)E[w]=W[w]},v.events)for(var x in v.events)l.bind(x,v.events[x]);this.clone=function(){var W=Object.create(this.constructor.prototype);return this.constructor.apply(W,z),W}.bind(this),this.isDetachAllowed=function(W){var w=!0;if(this._jsPlumb.beforeDetach)try{w=this._jsPlumb.beforeDetach(W)}catch(K){i.log("jsPlumb: beforeDetach callback failed",K)}return w},this.isDropAllowed=function(W,w,K,U,O,y,X){var ot=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:W,targetId:w,scope:K,connection:U,dropEndpoint:O,source:y,target:X});if(this._jsPlumb.beforeDrop)try{ot=this._jsPlumb.beforeDrop({sourceId:W,targetId:w,scope:K,connection:U,dropEndpoint:O,source:y,target:X})}catch(Q){i.log("jsPlumb: beforeDrop callback failed",Q)}return ot};var B=[];this.setListenerComponent=function(W){for(var w=0;w<B.length;w++)B[w][3]=W}},o=function(v,l){var z=v._jsPlumb.types[l],q=v._jsPlumb.instance.getType(z,v.getTypeDescriptor());q!=null&&q.cssClass&&v.canvas&&v._jsPlumb.instance.removeClass(v.canvas,q.cssClass)};i.extend(a.jsPlumbUIComponent,i.EventGenerator,{getParameter:function(v){return this._jsPlumb.parameters[v]},setParameter:function(v,l){this._jsPlumb.parameters[v]=l},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(v){this._jsPlumb.parameters=v},getClass:function(){return k.getClass(this.canvas)},hasClass:function(v){return k.hasClass(this.canvas,v)},addClass:function(v){k.addClass(this.canvas,v)},removeClass:function(v){k.removeClass(this.canvas,v)},updateClasses:function(v,l){k.updateClasses(this.canvas,v,l)},setType:function(v,l,z){this.clearTypes(),this._jsPlumb.types=A(v)||[],_(this,l,z)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(v,l){_(this,v,l)},hasType:function(v){return this._jsPlumb.types.indexOf(v)!==-1},addType:function(v,l,z){var q=A(v),tt=!1;if(q!=null){for(var Y=0,I=q.length;Y<I;Y++)this.hasType(q[Y])||(this._jsPlumb.types.push(q[Y]),tt=!0);tt&&_(this,l,z)}},removeType:function(v,l,z){var q=A(v),tt=!1,Y=function(p){var E=this._jsPlumb.types.indexOf(p);return E!==-1?(o(this,E),this._jsPlumb.types.splice(E,1),!0):!1}.bind(this);if(q!=null){for(var I=0,H=q.length;I<H;I++)tt=Y(q[I])||tt;tt&&_(this,l,z)}},clearTypes:function(v,l){for(var z=this._jsPlumb.types.length,q=0;q<z;q++)o(this,0),this._jsPlumb.types.splice(0,1);_(this,v,l)},toggleType:function(v,l,z){var q=A(v);if(q!=null){for(var tt=0,Y=q.length;tt<Y;tt++){var I=this._jsPlumb.types.indexOf(q[tt]);I!==-1?(o(this,I),this._jsPlumb.types.splice(I,1)):this._jsPlumb.types.push(q[tt])}_(this,l,z)}},applyType:function(v,l){if(this.setPaintStyle(v.paintStyle,l),this.setHoverPaintStyle(v.hoverPaintStyle,l),v.parameters)for(var z in v.parameters)this.setParameter(z,v.parameters[z]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(v,l){this._jsPlumb.paintStyle=v,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,h(this),l||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(v,l){this._jsPlumb.hoverPaintStyle=v,h(this),l||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(v){(v||this.typeId==null)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(v,l,z){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=v;var q=v?"addClass":"removeClass";this.canvas!=null&&(this._jsPlumb.instance.hoverClass!=null&&this._jsPlumb.instance[q](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[q](this.canvas,this._jsPlumb.hoverClass)),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=v?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(z=z||jsPlumbUtil.uuid(),this.repaint({timestamp:z,recalc:!1}))),this.getAttachedElements&&!l&&C(this,v,jsPlumbUtil.uuid(),this)}}});var m=0,D=function(){var v=m+1;return m++,v},L=a.jsPlumbInstance=function(v){this.version="2.15.6",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},ListStyle:{},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},v&&k.extend(this.Defaults,v),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},i.EventGenerator.apply(this);var l=this,z=D(),q=l.bind,tt={},Y=1,I=function(b){if(b==null)return null;if(b.nodeType===3||b.nodeType===8)return{el:b,text:!0};var Z=l.getElement(b);return{el:Z,id:i.isString(b)&&Z==null?b:Pt(Z)}};this.getInstanceIndex=function(){return z},this.setZoom=function(b,Z){return Y=b,l.fire("zoom",Y),Z&&l.repaintEverything(),!0},this.getZoom=function(){return Y};for(var H in this.Defaults)tt[H]=this.Defaults[H];var p,E=[];this.unbindContainer=function(){if(p!=null&&E.length>0)for(var b=0;b<E.length;b++)l.off(p,E[b][0],E[b][1])},this.setContainer=function(b){this.unbindContainer(),b=this.getElement(b),this.select().each(function(Tt){Tt.moveParent(b)}),this.selectEndpoints().each(function(Tt){Tt.moveParent(b)});var Z=p;p=b,E.length=0;for(var G={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},J=function(Tt,jt,Gt){var zt=jt.srcElement||jt.target,Ht=(zt&&zt.parentNode?zt.parentNode._jsPlumb:null)||(zt?zt._jsPlumb:null)||(zt&&zt.parentNode&&zt.parentNode.parentNode?zt.parentNode.parentNode._jsPlumb:null);if(Ht){Ht.fire(Tt,Ht,jt);var Zt=Gt&&G[Gt+Tt]||Tt;l.fire(Zt,Ht.component||Ht,jt)}},at=function(Tt,jt,Gt){E.push([Tt,Gt]),l.on(p,Tt,jt,Gt)},ft=function(Tt){at(Tt,".jtk-connector",function(jt){J(Tt,jt)}),at(Tt,".jtk-endpoint",function(jt){J(Tt,jt,"endpoint")}),at(Tt,".jtk-overlay",function(jt){J(Tt,jt)})},St=0;St<j.length;St++)ft(j[St]);for(var Lt in U){var wt=U[Lt].el;wt.parentNode===Z&&(Z.removeChild(wt),p.appendChild(wt))}},this.getContainer=function(){return p},this.bind=function(b,Z){b==="ready"&&B?Z():q.apply(l,[b,Z])},l.importDefaults=function(b){for(var Z in b)l.Defaults[Z]=b[Z];return b.Container&&l.setContainer(b.Container),l},l.restoreDefaults=function(){return l.Defaults=k.extend({},tt),l};var x=null,B=!1,W=[],w={},K={},U={},O={},y={},X=!1,ot=[],Q=!1,it=null,f=this.Defaults.Scope,S=1,c=function(){return""+S++},R=function(b,Z){p?p.appendChild(b):Z?this.getElement(Z).appendChild(b):this.appendToRoot(b)}.bind(this),M=function(b,Z,G,J){var at={c:[],e:[]};if(!Q&&(b=l.getElement(b),b!=null)){var ft=Pt(b),St=b.querySelectorAll(".jtk-managed");G==null&&(G=jsPlumbUtil.uuid()),oe({elId:ft,offset:Z,recalc:!1,timestamp:G});for(var Lt=0;Lt<St.length;Lt++)oe({elId:St[Lt].getAttribute("id"),recalc:!0,timestamp:G});var wt=l.router.redraw(ft,Z,G,null,J);if(Array.prototype.push.apply(at.c,wt.c),Array.prototype.push.apply(at.e,wt.e),St)for(var Tt=0;Tt<St.length;Tt++)wt=l.router.redraw(St[Tt].getAttribute("id"),null,G,null,J,!0),Array.prototype.push.apply(at.c,wt.c),Array.prototype.push.apply(at.e,wt.e)}return at},V=function(b){return K[b]},et=function(b,Z){for(var G=b.scope.split(/\s/),J=Z.scope.split(/\s/),at=0;at<G.length;at++)for(var ft=0;ft<J.length;ft++)if(J[ft]===G[at])return!0;return!1},lt=function(b,Z){var G=k.extend({},b);for(var J in Z)Z[J]&&(G[J]=Z[J]);return G},st=function(b,Z){var G=k.extend({},b);if(Z&&k.extend(G,Z),G.source&&(G.source.endpoint?G.sourceEndpoint=G.source:G.source=l.getElement(G.source)),G.target&&(G.target.endpoint?G.targetEndpoint=G.target:G.target=l.getElement(G.target)),b.uuids&&(G.sourceEndpoint=V(b.uuids[0]),G.targetEndpoint=V(b.uuids[1])),G.sourceEndpoint&&G.sourceEndpoint.isFull()){i.log(l,"could not add connection; source endpoint is full");return}if(G.targetEndpoint&&G.targetEndpoint.isFull()){i.log(l,"could not add connection; target endpoint is full");return}if(!G.type&&G.sourceEndpoint&&(G.type=G.sourceEndpoint.connectionType),G.sourceEndpoint&&G.sourceEndpoint.connectorOverlays){G.overlays=G.overlays||[];for(var J=0,at=G.sourceEndpoint.connectorOverlays.length;J<at;J++)G.overlays.push(G.sourceEndpoint.connectorOverlays[J])}G.sourceEndpoint&&G.sourceEndpoint.scope&&(G.scope=G.sourceEndpoint.scope),!G["pointer-events"]&&G.sourceEndpoint&&G.sourceEndpoint.connectorPointerEvents&&(G["pointer-events"]=G.sourceEndpoint.connectorPointerEvents);var ft=function(Lt,wt,Tt){var jt=lt(wt,{anchor:G.anchors?G.anchors[Tt]:G.anchor,endpoint:G.endpoints?G.endpoints[Tt]:G.endpoint,paintStyle:G.endpointStyles?G.endpointStyles[Tt]:G.endpointStyle,hoverPaintStyle:G.endpointHoverStyles?G.endpointHoverStyles[Tt]:G.endpointHoverStyle});return l.addEndpoint(Lt,jt)},St=function(Lt,wt,Tt,jt){if(G[Lt]&&!G[Lt].endpoint&&!G[Lt+"Endpoint"]&&!G.newConnection){var Gt=Pt(G[Lt]),zt=Tt[Gt];if(zt=zt?zt[jt]:null,zt){if(!zt.enabled)return!1;var Ht=k.extend({},zt.def);delete Ht.label;var Zt=zt.endpoint!=null&&zt.endpoint._jsPlumb?zt.endpoint:ft(G[Lt],Ht,wt);if(Zt.isFull())return!1;G[Lt+"Endpoint"]=Zt,!G.scope&&Ht.scope&&(G.scope=Ht.scope),zt.uniqueEndpoint?zt.endpoint?Zt.finalEndpoint=zt.endpoint:(zt.endpoint=Zt,Zt.setDeleteOnEmpty(!1)):Zt.setDeleteOnEmpty(!0),wt===0&&zt.def.connectorOverlays&&(G.overlays=G.overlays||[],Array.prototype.push.apply(G.overlays,zt.def.connectorOverlays))}}};if(St("source",0,this.sourceEndpointDefinitions,G.type||"default")!==!1&&St("target",1,this.targetEndpointDefinitions,G.type||"default")!==!1)return G.sourceEndpoint&&G.targetEndpoint&&(et(G.sourceEndpoint,G.targetEndpoint)||(G=null)),G}.bind(l),ct=function(b){var Z=l.Defaults.ConnectionType||l.getDefaultConnectionType();b._jsPlumb=l,b.newConnection=ct,b.newEndpoint=yt,b.endpointsByUUID=K,b.endpointsByElement=w,b.finaliseConnection=Et,b.id="con_"+c();var G=new Z(b);return G.isDetachable()&&(G.endpoints[0].initDraggable("_jsPlumbSource"),G.endpoints[1].initDraggable("_jsPlumbTarget")),G},Et=l.finaliseConnection=function(b,Z,G,J){if(Z=Z||{},b.suspendedEndpoint||W.push(b),b.pending=null,b.endpoints[0].isTemporarySource=!1,J!==!1&&l.router.newConnection(b),M(b.source),!Z.doNotFireConnectionEvent&&Z.fireEvent!==!1){var at={connection:b,source:b.source,target:b.target,sourceId:b.sourceId,targetId:b.targetId,sourceEndpoint:b.endpoints[0],targetEndpoint:b.endpoints[1]};l.fire("connection",at,G)}},yt=function(b,Z){var G=l.Defaults.EndpointType||k.Endpoint,J=k.extend({},b);J._jsPlumb=l,J.newConnection=ct,J.newEndpoint=yt,J.endpointsByUUID=K,J.endpointsByElement=w,J.fireDetachEvent=gt,J.elementId=Z||Pt(J.source);var at=new G(J);return at.id="ep_"+c(),Xe(J.elementId,J.source),k.headless||l.getDragManager().endpointAdded(J.source,Z),at},vt=function(b,Z,G){var J=w[b];if(J&&J.length)for(var at=0,ft=J.length;at<ft;at++){for(var St=0,Lt=J[at].connections.length;St<Lt;St++){var wt=Z(J[at].connections[St]);if(wt)return}G&&G(J[at])}},Ct=function(b,Z,G){Z=Z==="block";var J=null;G&&(J=function(ft){ft.setVisible(Z,!0,!0)});var at=I(b);vt(at.id,function(ft){if(Z&&G){var St=ft.sourceId===at.id?1:0;ft.endpoints[St].isVisible()&&ft.setVisible(!0)}else ft.setVisible(Z)},J)},Ot=function(b,Z){var G=null;Z&&(G=function(J){var at=J.isVisible();J.setVisible(!at)}),vt(b,function(J){var at=J.isVisible();J.setVisible(!at)},G)},xt=function(b){var Z=O[b];return Z?{o:Z,s:ot[b]}:oe({elId:b})},Pt=function(b,Z,G){if(i.isString(b))return b;if(b==null)return null;var J=l.getAttribute(b,"id");return(!J||J==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?J=Z:(arguments.length===1||arguments.length===3&&!arguments[2])&&(J="jsPlumb_"+z+"_"+c()),G||l.setAttribute(b,"id",J)),J};this.setConnectionBeingDragged=function(b){X=b},this.isConnectionBeingDragged=function(){return X},this.getManagedElements=function(){return U},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(b,Z,G){G=G||{};var J=k.extend({},G);k.extend(J,Z),J.endpoint=J.endpoint||l.Defaults.Endpoint,J.paintStyle=J.paintStyle||l.Defaults.EndpointStyle;for(var at=[],ft=i.isArray(b)||b.length!=null&&!i.isString(b)?b:[b],St=0,Lt=ft.length;St<Lt;St++){J.source=l.getElement(ft[St]),qe(J.source);var wt=Pt(J.source),Tt=yt(J,wt),jt=Xe(wt,J.source,null,!Q).info.o;i.addToList(w,wt,Tt),Q||Tt.paint({anchorLoc:Tt.anchor.compute({xy:[jt.left,jt.top],wh:ot[wt],element:Tt,timestamp:it,rotation:this.getRotation(wt)}),timestamp:it}),at.push(Tt)}return at.length===1?at[0]:at},this.addEndpoints=function(b,Z,G){for(var J=[],at=0,ft=Z.length;at<ft;at++){var St=l.addEndpoint(b,Z[at],G);i.isArray(St)?Array.prototype.push.apply(J,St):J.push(St)}return J},this.animate=function(b,Z,G){if(!this.animationSupported)return!1;G=G||{};var J=l.getElement(b),at=Pt(J),ft=k.animEvents.step,St=k.animEvents.complete;G[ft]=i.wrap(G[ft],function(){l.revalidate(at)}),G[St]=i.wrap(G[St],function(){l.revalidate(at)}),l.doAnimate(J,Z,G)},this.checkCondition=function(b,Z){var G=l.getListener(b),J=!0;if(G&&G.length>0){var at=Array.prototype.slice.call(arguments,1);try{for(var ft=0,St=G.length;ft<St;ft++)J=J&&G[ft].apply(G[ft],at)}catch(Lt){i.log(l,"cannot check condition ["+b+"]"+Lt)}}return J},this.connect=function(b,Z){var G=st(b,Z),J;if(G){if(G.source==null&&G.sourceEndpoint==null){i.log("Cannot establish connection - source does not exist");return}if(G.target==null&&G.targetEndpoint==null){i.log("Cannot establish connection - target does not exist");return}qe(G.source),J=ct(G),Et(J,G)}return J};var Bt=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Mt=function(b,Z,G,J){var at,ft=Bt[G],St=b[ft.elId];b[ft.el];var Lt,wt,Tt=b.endpoints[G],jt={index:G,originalSourceId:G===0?St:b.sourceId,newSourceId:b.sourceId,originalTargetId:G===1?St:b.targetId,newTargetId:b.targetId,connection:b};if(Z.constructor===k.Endpoint)at=Z,at.addConnection(b),Z=at.element;else if(Lt=Pt(Z),wt=this[ft.epDefs][Lt],Lt===b[ft.elId])at=null;else if(wt)for(var Gt in wt){if(!wt[Gt].enabled)return;at=wt[Gt].endpoint!=null&&wt[Gt].endpoint._jsPlumb?wt[Gt].endpoint:this.addEndpoint(Z,wt[Gt].def),wt[Gt].uniqueEndpoint&&(wt[Gt].endpoint=at),at.addConnection(b)}else at=b.makeEndpoint(G===0,Z,Lt);return at!=null&&(Tt.detachFromConnection(b),b.endpoints[G]=at,b[ft.el]=at.element,b[ft.elId]=at.elementId,jt[G===0?"newSourceId":"newTargetId"]=at.elementId,ht(jt),J||b.repaint()),jt.element=Z,jt}.bind(this);this.setSource=function(b,Z,G){var J=Mt(b,Z,0,G);this.router.sourceOrTargetChanged(J.originalSourceId,J.newSourceId,b,J.el,0)},this.setTarget=function(b,Z,G){var J=Mt(b,Z,1,G);this.router.sourceOrTargetChanged(J.originalTargetId,J.newTargetId,b,J.el,1)},this.deleteEndpoint=function(b,Z,G){var J=typeof b=="string"?K[b]:b;return J&&l.deleteObject({endpoint:J,dontUpdateHover:Z,deleteAttachedObjects:G}),l},this.deleteEveryEndpoint=function(){var b=l.setSuspendDrawing(!0);for(var Z in w){var G=w[Z];if(G&&G.length)for(var J=0,at=G.length;J<at;J++)l.deleteEndpoint(G[J],!0)}w={},U={},K={},O={},y={},l.router.reset();var ft=l.getDragManager();return ft&&ft.reset(),b||l.setSuspendDrawing(!1),l};var gt=function(b,Z,G){var J=l.Defaults.ConnectionType||l.getDefaultConnectionType(),at=b.constructor===J,ft=at?{connection:b,source:b.source,target:b.target,sourceId:b.sourceId,targetId:b.targetId,sourceEndpoint:b.endpoints[0],targetEndpoint:b.endpoints[1]}:b;Z&&l.fire("connectionDetached",ft,G),l.fire("internal.connectionDetached",ft,G),l.router.connectionDetached(ft)},ht=l.fireMoveEvent=function(b,Z){l.fire("connectionMoved",b,Z)};this.unregisterEndpoint=function(b){b._jsPlumb.uuid&&(K[b._jsPlumb.uuid]=null),l.router.deleteEndpoint(b);for(var Z in w){var G=w[Z];if(G){for(var J=[],at=0,ft=G.length;at<ft;at++)G[at]!==b&&J.push(G[at]);w[Z]=J}w[Z].length<1&&delete w[Z]}};var bt="isDetachAllowed",Dt="beforeDetach",Nt="checkCondition";this.deleteConnection=function(b,Z){return b!=null&&(Z=Z||{},Z.force||i.functionChain(!0,!1,[[b.endpoints[0],bt,[b]],[b.endpoints[1],bt,[b]],[b,bt,[b]],[l,Nt,[Dt,b]]]))?(b.setHover(!1),gt(b,!b.pending&&Z.fireEvent!==!1,Z.originalEvent),b.endpoints[0].detachFromConnection(b),b.endpoints[1].detachFromConnection(b),i.removeWithFunction(W,function(G){return b.id===G.id}),b.cleanup(),b.destroy(),!0):!1},this.deleteEveryConnection=function(b){b=b||{};var Z=W.length,G=0;return l.batch(function(){for(var J=0;J<Z;J++)G+=l.deleteConnection(W[0],b)?1:0}),G},this.deleteConnectionsForElement=function(b,Z){Z=Z||{},b=l.getElement(b);var G=Pt(b),J=w[G];if(J&&J.length)for(var at=0,ft=J.length;at<ft;at++)J[at].deleteEveryConnection(Z);return l},this.deleteObject=function(b){var Z={endpoints:{},connections:{},endpointCount:0,connectionCount:0},G=b.deleteAttachedObjects!==!1,J=function(jt){jt!=null&&Z.connections[jt.id]==null&&(!b.dontUpdateHover&&jt._jsPlumb!=null&&jt.setHover(!1),Z.connections[jt.id]=jt,Z.connectionCount++)},at=function(jt){if(jt!=null&&Z.endpoints[jt.id]==null&&(!b.dontUpdateHover&&jt._jsPlumb!=null&&jt.setHover(!1),Z.endpoints[jt.id]=jt,Z.endpointCount++,G))for(var Gt=0;Gt<jt.connections.length;Gt++){var zt=jt.connections[Gt];J(zt)}};b.connection?J(b.connection):at(b.endpoint);for(var ft in Z.connections){var St=Z.connections[ft];if(St._jsPlumb){i.removeWithFunction(W,function(jt){return St.id===jt.id}),gt(St,b.fireEvent===!1?!1:!St.pending,b.originalEvent);var Lt=b.deleteAttachedObjects==null?null:!b.deleteAttachedObjects;St.endpoints[0].detachFromConnection(St,null,Lt),St.endpoints[1].detachFromConnection(St,null,Lt),St.cleanup(!0),St.destroy(!0)}}for(var wt in Z.endpoints){var Tt=Z.endpoints[wt];Tt._jsPlumb&&(l.unregisterEndpoint(Tt),Tt.cleanup(!0),Tt.destroy(!0))}return Z};var Yt=function(b,Z,G,J){for(var at=0,ft=b.length;at<ft;at++)b[at][Z].apply(b[at],G);return J(b)},Qt=function(b,Z,G){for(var J=[],at=0,ft=b.length;at<ft;at++)J.push([b[at][Z].apply(b[at],G),b[at]]);return J},_e=function(b,Z,G){return function(){return Yt(b,Z,arguments,G)}},Se=function(b,Z){return function(){return Qt(b,Z,arguments)}},Oe=function(b,Z){var G=[];if(b)if(typeof b=="string"){if(b==="*")return b;G.push(b)}else if(Z)G=b;else if(b.length)for(var J=0,at=b.length;J<at;J++)G.push(I(b[J]).id);else G.push(I(b).id);return G},Pe=function(b,Z,G){return b==="*"?!0:b.length>0?b.indexOf(Z)!==-1:!G};this.getConnections=function(b,Z){b?b.constructor===String&&(b={scope:b}):b={};for(var G=b.scope||l.getDefaultScope(),J=Oe(G,!0),at=Oe(b.source),ft=Oe(b.target),St=!Z&&J.length>1?{}:[],Lt=function(Ht,Zt){if(!Z&&J.length>1){var ue=St[Ht];ue==null&&(ue=St[Ht]=[]),ue.push(Zt)}else St.push(Zt)},wt=0,Tt=W.length;wt<Tt;wt++){var jt=W[wt],Gt=jt.proxies&&jt.proxies[0]?jt.proxies[0].originalEp.elementId:jt.sourceId,zt=jt.proxies&&jt.proxies[1]?jt.proxies[1].originalEp.elementId:jt.targetId;Pe(J,jt.scope)&&Pe(at,Gt)&&Pe(ft,zt)&&Lt(jt.scope,jt)}return St};var dn=function(b,Z){return function(G){for(var J=0,at=b.length;J<at;J++)G(b[J]);return Z(b)}},Qe=function(b){return function(Z){return b[Z]}},tn=function(b,Z){var G={length:b.length,each:dn(b,Z),get:Qe(b)},J=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],at=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],ft,St;for(ft=0,St=J.length;ft<St;ft++)G[J[ft]]=_e(b,J[ft],Z);for(ft=0,St=at.length;ft<St;ft++)G[at[ft]]=Se(b,at[ft]);return G},Te=function(b){var Z=tn(b,Te);return k.extend(Z,{setDetachable:_e(b,"setDetachable",Te),setReattach:_e(b,"setReattach",Te),setConnector:_e(b,"setConnector",Te),delete:function(){for(var G=0,J=b.length;G<J;G++)l.deleteConnection(b[G])},isDetachable:Se(b,"isDetachable"),isReattach:Se(b,"isReattach")})},Ge=function(b){var Z=tn(b,Ge);return k.extend(Z,{setEnabled:_e(b,"setEnabled",Ge),setAnchor:_e(b,"setAnchor",Ge),isEnabled:Se(b,"isEnabled"),deleteEveryConnection:function(){for(var G=0,J=b.length;G<J;G++)b[G].deleteEveryConnection()},delete:function(){for(var G=0,J=b.length;G<J;G++)l.deleteEndpoint(b[G])}})};this.select=function(b){return b=b||{},b.scope=b.scope||"*",Te(b.connections||l.getConnections(b,!0))},this.selectEndpoints=function(b){b=b||{},b.scope=b.scope||"*";var Z=!b.element&&!b.source&&!b.target,G=Z?"*":Oe(b.element),J=Z?"*":Oe(b.source),at=Z?"*":Oe(b.target),ft=Oe(b.scope,!0),St=[];for(var Lt in w){var wt=Pe(G,Lt,!0),Tt=Pe(J,Lt,!0),jt=J!=="*",Gt=Pe(at,Lt,!0),zt=at!=="*";if(wt||Tt||Gt)t:for(var Ht=0,Zt=w[Lt].length;Ht<Zt;Ht++){var ue=w[Lt][Ht];if(Pe(ft,ue.scope,!0)){var fn=jt&&J.length>0&&!ue.isSource,hn=zt&&at.length>0&&!ue.isTarget;if(fn||hn)continue t;St.push(ue)}}}return Ge(St)},this.getAllConnections=function(){return W},this.getDefaultScope=function(){return f},this.getEndpoint=V,this.getEndpoints=function(b){return w[I(b).id]||[]},this.getDefaultEndpointType=function(){return k.Endpoint},this.getDefaultConnectionType=function(){return k.Connection},this.getId=Pt,this.draw=M,this.info=I,this.appendElement=R;var Le=!1;this.isHoverSuspended=function(){return Le},this.setHoverSuspended=function(b){Le=b},this.hide=function(b,Z){return Ct(b,"none",Z),l},this.idstamp=c;var qe=function(b){if(!p&&b){var Z=l.getElement(b);Z.offsetParent&&l.setContainer(Z.offsetParent)}},Ye=function(){l.Defaults.Container&&l.setContainer(l.Defaults.Container)},Xe=l.manage=function(b,Z,G,J){return U[b]?J&&(U[b].info=oe({elId:b,timestamp:it,recalc:!0})):(U[b]={el:Z,endpoints:[],connections:[],rotation:0},U[b].info=oe({elId:b,timestamp:it}),l.addClass(Z,"jtk-managed"),G||l.fire("manageElement",{id:b,info:U[b].info,el:Z})),U[b]};this.unmanage=function(b){if(U[b]){var Z=U[b].el;l.removeClass(Z,"jtk-managed"),delete U[b],l.fire("unmanageElement",{id:b,el:Z})}},this.rotate=function(b,Z,G){return U[b]&&(U[b].rotation=Z,U[b].el.style.transform="rotate("+Z+"deg)",U[b].el.style.transformOrigin="center center",G!==!0)?this.revalidate(b):{c:[],e:[]}},this.getRotation=function(b){return U[b]&&U[b].rotation||0};var oe=function(b){var Z=b.timestamp,G=b.recalc,J=b.offset,at=b.elId,ft;return Q&&!Z&&(Z=it),!G&&Z&&Z===y[at]?{o:b.offset||O[at],s:ot[at]}:(G||!J&&O[at]==null?(ft=U[at]?U[at].el:null,ft!=null&&(ot[at]=l.getSize(ft),O[at]=l.getOffset(ft),y[at]=Z)):(O[at]=J||O[at],ot[at]==null&&(ft=U[at].el,ft!=null&&(ot[at]=l.getSize(ft))),y[at]=Z),O[at]&&!O[at].right&&(O[at].right=O[at].left+ot[at][0],O[at].bottom=O[at].top+ot[at][1],O[at].width=ot[at][0],O[at].height=ot[at][1],O[at].centerx=O[at].left+O[at].width/2,O[at].centery=O[at].top+O[at].height/2),{o:O[at],s:ot[at]})};this.updateOffset=oe,this.init=function(){B||(Ye(),l.router=new a.jsPlumb.DefaultRouter(l),l.anchorManager=l.router.anchorManager,B=!0,l.fire("ready",l))}.bind(this),this.log=x,this.jsPlumbUIComponent=u,this.makeAnchor=function(){var b,Z=function(St,Lt){if(a.jsPlumb.Anchors[St])return new a.jsPlumb.Anchors[St](Lt);if(!l.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+St+"'"}};if(arguments.length===0)return null;var G=arguments[0],J=arguments[1],at=null;if(G.compute&&G.getOrientation)return G;if(typeof G=="string")at=Z(arguments[0],{elementId:J,jsPlumbInstance:l});else if(i.isArray(G))if(i.isArray(G[0])||i.isString(G[0]))G.length===2&&i.isObject(G[1])?i.isString(G[0])?(b=a.jsPlumb.extend({elementId:J,jsPlumbInstance:l},G[1]),at=Z(G[0],b)):(b=a.jsPlumb.extend({elementId:J,jsPlumbInstance:l,anchors:G[0]},G[1]),at=new a.jsPlumb.DynamicAnchor(b)):at=new k.DynamicAnchor({anchors:G,selector:null,elementId:J,jsPlumbInstance:l});else{var ft={x:G[0],y:G[1],orientation:G.length>=4?[G[2],G[3]]:[0,0],offsets:G.length>=6?[G[4],G[5]]:[0,0],elementId:J,jsPlumbInstance:l,cssClass:G.length===7?G[6]:null};at=new a.jsPlumb.Anchor(ft),at.clone=function(){return new a.jsPlumb.Anchor(ft)}}return at.id||(at.id="anchor_"+c()),at},this.makeAnchors=function(b,Z,G){for(var J=[],at=0,ft=b.length;at<ft;at++)typeof b[at]=="string"?J.push(a.jsPlumb.Anchors[b[at]]({elementId:Z,jsPlumbInstance:G})):i.isArray(b[at])&&J.push(l.makeAnchor(b[at],Z,G));return J},this.makeDynamicAnchor=function(b,Z){return new a.jsPlumb.DynamicAnchor({anchors:b,selector:Z,elementId:null,jsPlumbInstance:l})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var Ce=function(b,Z,G,J,at){for(var ft=b.target||b.srcElement,St=!1,Lt=J.getSelector(Z,G),wt=0;wt<Lt.length;wt++)if(Lt[wt]===ft){St=!0;break}return at?!St:St},fe=function(b,Z,G,J,at){var ft=new u(Z),St=Z._jsPlumb.EndpointDropHandler({jsPlumb:l,enabled:function(){return b.def.enabled},isFull:function(){var wt=l.select({target:b.id}).length;return b.def.maxConnections>0&&wt>=b.def.maxConnections},element:b.el,elementId:b.id,isSource:J,isTarget:at,addClass:function(wt){l.addClass(b.el,wt)},removeClass:function(wt){l.removeClass(b.el,wt)},onDrop:function(wt){var Tt=wt.endpoints[0];Tt.anchor.locked=!1},isDropAllowed:function(){return ft.isDropAllowed.apply(ft,arguments)},isRedrop:function(wt){return wt.suspendedElement!=null&&wt.suspendedEndpoint!=null&&wt.suspendedEndpoint.element===b.el},getEndpoint:function(wt){var Tt=b.def.endpoint;if(Tt==null||Tt._jsPlumb==null){var jt=l.deriveEndpointAndAnchorSpec(wt.getType().join(" "),!0),Gt=jt.endpoints?a.jsPlumb.extend(Z,{endpoint:b.def.def.endpoint||jt.endpoints[1]}):Z;jt.anchors&&(Gt=a.jsPlumb.extend(Gt,{anchor:b.def.def.anchor||jt.anchors[1]})),Tt=l.addEndpoint(b.el,Gt),Tt._mtNew=!0}if(Z.uniqueEndpoint&&(b.def.endpoint=Tt),Tt.setDeleteOnEmpty(!0),wt.isDetachable()&&Tt.initDraggable(),Tt.anchor.positionFinder!=null){var zt=l.getUIPosition(arguments,l.getZoom()),Ht=l.getOffset(b.el),Zt=l.getSize(b.el),ue=zt==null?[0,0]:Tt.anchor.positionFinder(zt,Ht,Zt,Tt.anchor.constructorParams);Tt.anchor.x=ue[0],Tt.anchor.y=ue[1]}return Tt},maybeCleanup:function(wt){wt._mtNew&&wt.connections.length===0?l.deleteObject({endpoint:wt}):delete wt._mtNew}}),Lt=a.jsPlumb.dragEvents.drop;return G.scope=G.scope||Z.scope||l.Defaults.Scope,G[Lt]=i.wrap(G[Lt],St,!0),G.rank=Z.rank||0,at&&(G[a.jsPlumb.dragEvents.over]=function(){return!0}),Z.allowLoopback===!1&&(G.canDrop=function(wt){var Tt=wt.getDragElement()._jsPlumbRelatedElement;return Tt!==b.el}),l.initDroppable(b.el,G,"internal"),St};this.makeTarget=function(b,Z,G){var J=a.jsPlumb.extend({_jsPlumb:this},G);a.jsPlumb.extend(J,Z);for(var at=J.maxConnections||-1,ft=function(Tt){var jt=I(Tt),Gt=jt.id,zt=a.jsPlumb.extend({},J.dropOptions||{}),Ht=J.connectionType||"default";this.targetEndpointDefinitions[Gt]=this.targetEndpointDefinitions[Gt]||{},qe(Gt),jt.el._isJsPlumbGroup&&zt.rank==null&&(zt.rank=-1);var Zt={def:a.jsPlumb.extend({},J),uniqueEndpoint:J.uniqueEndpoint,maxConnections:at,enabled:!0};J.createEndpoint&&(Zt.uniqueEndpoint=!0,Zt.endpoint=l.addEndpoint(Tt,Zt.def),Zt.endpoint.setDeleteOnEmpty(!1)),jt.def=Zt,this.targetEndpointDefinitions[Gt][Ht]=Zt,fe(jt,J,zt,J.isSource===!0,!0),jt.el._katavorioDrop[jt.el._katavorioDrop.length-1].targetDef=Zt}.bind(this),St=b.length&&b.constructor!==String?b:[b],Lt=0,wt=St.length;Lt<wt;Lt++)ft(St[Lt]);return this},this.unmakeTarget=function(b,Z){var G=I(b);return l.destroyDroppable(G.el,"internal"),Z||delete this.targetEndpointDefinitions[G.id],this},this.makeSource=function(b,Z,G){var J=a.jsPlumb.extend({_jsPlumb:this},G);a.jsPlumb.extend(J,Z);var at=J.connectionType||"default",ft=l.deriveEndpointAndAnchorSpec(at);J.endpoint=J.endpoint||ft.endpoints[0],J.anchor=J.anchor||ft.anchors[0];for(var St=J.maxConnections||-1,Lt=J.onMaxConnections,wt=function(zt){var Ht=zt.id,Zt=this.getElement(zt.el);this.sourceEndpointDefinitions[Ht]=this.sourceEndpointDefinitions[Ht]||{},qe(Ht);var ue={def:a.jsPlumb.extend({},J),uniqueEndpoint:J.uniqueEndpoint,maxConnections:St,enabled:!0};J.createEndpoint&&(ue.uniqueEndpoint=!0,ue.endpoint=l.addEndpoint(b,ue.def),ue.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[Ht][at]=ue,zt.def=ue;var fn=a.jsPlumb.dragEvents.stop,hn=a.jsPlumb.dragEvents.drag,Ae=a.jsPlumb.extend({},J.dragOptions||{}),In=Ae.drag,Pn=Ae.stop,he=null,An=!1;Ae.scope=Ae.scope||J.scope,Ae[hn]=i.wrap(Ae[hn],function(){In&&In.apply(this,arguments),An=!1}),Ae[fn]=i.wrap(Ae[fn],function(){if(Pn&&Pn.apply(this,arguments),this.currentlyDragging=!1,he._jsPlumb!=null){var ke=J.anchor||this.Defaults.Anchor,ce=he.anchor,en=he.connections[0],ze=this.makeAnchor(ke,Ht,this),pn=he.element;if(ze.positionFinder!=null){var Ee=l.getOffset(pn),Ue=this.getSize(pn),Ie={left:Ee.left+ce.x*Ue[0],top:Ee.top+ce.y*Ue[1]},gn=ze.positionFinder(Ie,Ee,Ue,ze.constructorParams);ze.x=gn[0],ze.y=gn[1]}he.setAnchor(ze,!0),he.repaint(),this.repaint(he.elementId),en!=null&&this.repaint(en.targetId)}}.bind(this));var oi=function(ke){if(!(ke.which===3||ke.button===2)){Ht=this.getId(this.getElement(zt.el));var ce=this.sourceEndpointDefinitions[Ht][at];if(ce.enabled){if(J.filter){var en=i.isString(J.filter)?Ce(ke,zt.el,J.filter,this,J.filterExclude):J.filter(ke,zt.el);if(en===!1)return}var ze=this.select({source:Ht}).length;if(ce.maxConnections>=0&&ze>=ce.maxConnections)return Lt&&Lt({element:zt.el,maxConnections:St},ke),!1;var pn=a.jsPlumb.getPositionOnElement(ke,Zt,Y),Ee={};a.jsPlumb.extend(Ee,ce.def),Ee.isTemporarySource=!0,Ee.anchor=[pn[0],pn[1],0,0],Ee.dragOptions=Ae,ce.def.scope&&(Ee.scope=ce.def.scope),he=this.addEndpoint(Ht,Ee),An=!0,he.setDeleteOnEmpty(!0),ce.uniqueEndpoint&&(ce.endpoint?he.finalEndpoint=ce.endpoint:(ce.endpoint=he,he.setDeleteOnEmpty(!1)));var Ue=function(){l.off(he.canvas,"mouseup",Ue),l.off(zt.el,"mouseup",Ue),An&&(An=!1,l.deleteEndpoint(he))};l.on(he.canvas,"mouseup",Ue),l.on(zt.el,"mouseup",Ue);var Ie={};if(ce.def.extract)for(var gn in ce.def.extract){var si=(ke.srcElement||ke.target).getAttribute(gn);si&&(Ie[ce.def.extract[gn]]=si)}l.trigger(he.canvas,"mousedown",ke,Ie),i.consume(ke)}}}.bind(this);this.on(zt.el,"mousedown",oi),ue.trigger=oi,J.filter&&(i.isString(J.filter)||i.isFunction(J.filter))&&l.setDragFilter(zt.el,J.filter);var kn=a.jsPlumb.extend({},J.dropOptions||{});fe(zt,J,kn,!0,J.isTarget===!0)}.bind(this),Tt=b.length&&b.constructor!==String?b:[b],jt=0,Gt=Tt.length;jt<Gt;jt++)wt(I(Tt[jt]));return this},this.unmakeSource=function(b,Z,G){var J=I(b);l.destroyDroppable(J.el,"internal");var at=this.sourceEndpointDefinitions[J.id];if(at){for(var ft in at)if(Z==null||Z===ft){var St=at[ft].trigger;St&&l.off(J.el,"mousedown",St),G||delete this.sourceEndpointDefinitions[J.id][ft]}}return this},this.unmakeEverySource=function(){for(var b in this.sourceEndpointDefinitions)l.unmakeSource(b,null,!0);return this.sourceEndpointDefinitions={},this};var Me=function(b,Z,G){Z=i.isArray(Z)?Z:[Z];var J=Pt(b);G=G||"default";for(var at=0;at<Z.length;at++){var ft=this[Z[at]][J];if(ft&&ft[G])return ft[G].def.scope||this.Defaults.Scope}}.bind(this),pe=function(b,Z,G,J){G=i.isArray(G)?G:[G];var at=Pt(b);J=J||"default";for(var ft=0;ft<G.length;ft++){var St=this[G[ft]][at];St&&St[J]&&(St[J].def.scope=Z)}}.bind(this);this.getScope=function(b,Z){return Me(b,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(b){return Me(b,"sourceEndpointDefinitions")},this.getTargetScope=function(b){return Me(b,"targetEndpointDefinitions")},this.setScope=function(b,Z,G){this.setSourceScope(b,Z,G),this.setTargetScope(b,Z,G)},this.setSourceScope=function(b,Z,G){pe(b,Z,"sourceEndpointDefinitions",G),this.setDragScope(b,Z)},this.setTargetScope=function(b,Z,G){pe(b,Z,"targetEndpointDefinitions",G),this.setDropScope(b,Z)},this.unmakeEveryTarget=function(){for(var b in this.targetEndpointDefinitions)l.unmakeTarget(b,!0);return this.targetEndpointDefinitions={},this};var _t=function(b,Z,G,J,at){var ft=b==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,St,Lt,wt;if(at=at||"default",Z.length&&!i.isString(Z)){St=[];for(var Tt=0,jt=Z.length;Tt<jt;Tt++)Lt=I(Z[Tt]),ft[Lt.id]&&ft[Lt.id][at]&&(St[Tt]=ft[Lt.id][at].enabled,wt=J?!St[Tt]:G,ft[Lt.id][at].enabled=wt,l[wt?"removeClass":"addClass"](Lt.el,"jtk-"+b+"-disabled"))}else{Lt=I(Z);var Gt=Lt.id;ft[Gt]&&ft[Gt][at]&&(St=ft[Gt][at].enabled,wt=J?!St:G,ft[Gt][at].enabled=wt,l[wt?"removeClass":"addClass"](Lt.el,"jtk-"+b+"-disabled"))}return St}.bind(this),qt=function(b,Z){if(b!=null){if(i.isString(b)||!b.length)return Z.apply(this,[b]);if(b.length)return Z.apply(this,[b[0]])}}.bind(this);this.toggleSourceEnabled=function(b,Z){return _t("source",b,null,!0,Z),this.isSourceEnabled(b,Z)},this.setSourceEnabled=function(b,Z,G){return _t("source",b,Z,null,G)},this.isSource=function(b,Z){return Z=Z||"default",qt(b,function(G){var J=this.sourceEndpointDefinitions[I(G).id];return J!=null&&J[Z]!=null}.bind(this))},this.isSourceEnabled=function(b,Z){return Z=Z||"default",qt(b,function(G){var J=this.sourceEndpointDefinitions[I(G).id];return J&&J[Z]&&J[Z].enabled===!0}.bind(this))},this.toggleTargetEnabled=function(b,Z){return _t("target",b,null,!0,Z),this.isTargetEnabled(b,Z)},this.isTarget=function(b,Z){return Z=Z||"default",qt(b,function(G){var J=this.targetEndpointDefinitions[I(G).id];return J!=null&&J[Z]!=null}.bind(this))},this.isTargetEnabled=function(b,Z){return Z=Z||"default",qt(b,function(G){var J=this.targetEndpointDefinitions[I(G).id];return J&&J[Z]&&J[Z].enabled===!0}.bind(this))},this.setTargetEnabled=function(b,Z,G){return _t("target",b,Z,null,G)},this.ready=function(b){l.bind("ready",b)};var $t=function(b,Z){if(typeof b=="object"&&b.length)for(var G=0,J=b.length;G<J;G++)Z(b[G]);else Z(b);return l};this.repaint=function(b,Z,G){return $t(b,function(J){M(J,Z,G)})},this.revalidate=function(b,Z,G){var J=G?b:l.getId(b);l.updateOffset({elId:J,recalc:!0,timestamp:Z});var at=l.getDragManager();return at&&at.updateOffsets(J),M(b,null,Z)},this.repaintEverything=function(){var b=jsPlumbUtil.uuid(),Z;for(Z in w)l.updateOffset({elId:Z,recalc:!0,timestamp:b});for(Z in w)M(Z,null,b);return this},this.removeAllEndpoints=function(b,Z,G){G=G||[];var J=function(at){var ft=I(at),St=w[ft.id],Lt,wt;if(St)for(G.push(ft),Lt=0,wt=St.length;Lt<wt;Lt++)l.deleteEndpoint(St[Lt],!1);if(delete w[ft.id],Z&&ft.el&&ft.el.nodeType!==3&&ft.el.nodeType!==8)for(Lt=0,wt=ft.el.childNodes.length;Lt<wt;Lt++)J(ft.el.childNodes[Lt])};return J(b),this};var Ft=function(b,Z){l.removeAllEndpoints(b.id,!0,Z);for(var G=l.getDragManager(),J=function(ft){G&&G.elementRemoved(ft.id),l.router.elementRemoved(ft.id),l.isSource(ft.el)&&l.unmakeSource(ft.el),l.isTarget(ft.el)&&l.unmakeTarget(ft.el),l.destroyDraggable(ft.el),l.destroyDroppable(ft.el),delete l.floatingConnections[ft.id],delete U[ft.id],delete O[ft.id],ft.el&&(l.removeElement(ft.el),ft.el._jsPlumb=null)},at=1;at<Z.length;at++)J(Z[at]);J(b)};this.remove=function(b,Z){var G=I(b),J=[];return G.text&&G.el.parentNode?G.el.parentNode.removeChild(G.el):G.id&&l.batch(function(){Ft(G,J)},Z===!0),l},this.empty=function(b,Z){var G=[],J=function(at,ft){var St=I(at);if(St.text)St.el.parentNode.removeChild(St.el);else if(St.el){for(;St.el.childNodes.length>0;)J(St.el.childNodes[0]);ft||Ft(St,G)}};return l.batch(function(){J(b,!0)},Z===!1),l},this.reset=function(b){l.silently(function(){Le=!1,l.removeAllGroups(),l.removeGroupManager(),l.deleteEveryEndpoint(),b||l.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},W.length=0,this.doReset&&this.doReset()}.bind(this))},this.destroy=function(){this.reset(),p=null,E=null};var Vt=function(b){b.canvas&&b.canvas.parentNode&&b.canvas.parentNode.removeChild(b.canvas),b.cleanup(),b.destroy()};this.clear=function(){l.select().each(Vt),l.selectEndpoints().each(Vt),w={},K={}},this.setDefaultScope=function(b){return f=b,l},this.deriveEndpointAndAnchorSpec=function(b,Z){for(var G=((Z?"":"default ")+b).split(/[\s]/),J=null,at=null,ft=null,St=null,Lt=0;Lt<G.length;Lt++){var wt=l.getType(G[Lt],"connection");wt&&(wt.endpoints&&(J=wt.endpoints),wt.endpoint&&(at=wt.endpoint),wt.anchors&&(St=wt.anchors),wt.anchor&&(ft=wt.anchor))}return{endpoints:J||[at,at],anchors:St||[ft,ft]}},this.setId=function(b,Z,G){var J;i.isString(b)?J=b:(b=this.getElement(b),J=this.getId(b));var at=this.getConnections({source:J,scope:"*"},!0),ft=this.getConnections({target:J,scope:"*"},!0);Z=""+Z,G?b=this.getElement(Z):(b=this.getElement(J),this.setAttribute(b,"id",Z)),w[Z]=w[J]||[];for(var St=0,Lt=w[Z].length;St<Lt;St++)w[Z][St].setElementId(Z),w[Z][St].setReferenceElement(b);delete w[J],this.sourceEndpointDefinitions[Z]=this.sourceEndpointDefinitions[J],delete this.sourceEndpointDefinitions[J],this.targetEndpointDefinitions[Z]=this.targetEndpointDefinitions[J],delete this.targetEndpointDefinitions[J],this.router.changeId(J,Z);var wt=this.getDragManager();wt&&wt.changeId(J,Z),U[Z]=U[J],delete U[J];var Tt=function(jt,Gt,zt){for(var Ht=0,Zt=jt.length;Ht<Zt;Ht++)jt[Ht].endpoints[Gt].setElementId(Z),jt[Ht].endpoints[Gt].setReferenceElement(b),jt[Ht][zt+"Id"]=Z,jt[Ht][zt]=b};Tt(at,0,"source"),Tt(ft,1,"target"),this.repaint(Z)},this.setDebugLog=function(b){x=b},this.setSuspendDrawing=function(b,Z){var G=Q;return Q=b,b?it=new Date().getTime():it=null,Z&&this.repaintEverything(),G},this.isSuspendDrawing=function(){return Q},this.getSuspendedAt=function(){return it},this.batch=function(b,Z){var G=this.isSuspendDrawing();G||this.setSuspendDrawing(!0);try{b()}catch(J){i.log("Function run while suspended failed",J)}G||this.setSuspendDrawing(!1,!Z)},this.doWhileSuspended=this.batch,this.getCachedData=xt,this.show=function(b,Z){return Ct(b,"block",Z),l},this.toggleVisible=Ot,this.addListener=this.bind;var Wt=[];this.registerFloatingConnection=function(b,Z,G){Wt[b.id]=Z,i.addToList(w,b.id,G)},this.getFloatingConnectionFor=function(b){return Wt[b]},this.listManager=new a.jsPlumbListManager(this,this.Defaults.ListStyle)};i.extend(a.jsPlumbInstance,i.EventGenerator,{setAttribute:function(v,l,z){this.setAttribute(v,l,z)},getAttribute:function(v,l){return this.getAttribute(a.jsPlumb.getElement(v),l)},convertToFullOverlaySpec:function(v){return i.isString(v)&&(v=[v,{}]),v[1].id=v[1].id||i.uuid(),v},registerConnectionType:function(v,l){if(this._connectionTypes[v]=a.jsPlumb.extend({},l),l.overlays){for(var z={},q=0;q<l.overlays.length;q++){var tt=this.convertToFullOverlaySpec(l.overlays[q]);z[tt[1].id]=tt}this._connectionTypes[v].overlays=z}},registerConnectionTypes:function(v){for(var l in v)this.registerConnectionType(l,v[l])},registerEndpointType:function(v,l){if(this._endpointTypes[v]=a.jsPlumb.extend({},l),l.overlays){for(var z={},q=0;q<l.overlays.length;q++){var tt=this.convertToFullOverlaySpec(l.overlays[q]);z[tt[1].id]=tt}this._endpointTypes[v].overlays=z}},registerEndpointTypes:function(v){for(var l in v)this.registerEndpointType(l,v[l])},getType:function(v,l){return l==="connection"?this._connectionTypes[v]:this._endpointTypes[v]},setIdChanged:function(v,l){this.setId(v,l,!0)},setParent:function(v,l){var z=this.getElement(v),q=this.getId(z),tt=this.getElement(l),Y=this.getId(tt),I=this.getDragManager();z.parentNode.removeChild(z),tt.appendChild(z),I&&I.setParent(z,q,tt,Y)},extend:function(v,l,z){var q;if(z)for(q=0;q<z.length;q++)v[z[q]]=l[z[q]];else for(q in l)v[q]=l[q];return v},floatingConnections:{},getFloatingAnchorIndex:function(v){return v.endpoints[0].isFloating()?0:v.endpoints[1].isFloating()?1:-1},proxyConnection:function(v,l,z,q,tt,Y){var I,H=v.endpoints[l].elementId,p=v.endpoints[l];v.proxies=v.proxies||[],v.proxies[l]?I=v.proxies[l].ep:I=this.addEndpoint(z,{endpoint:tt(v,l),anchor:Y(v,l),parameters:{isProxyEndpoint:!0}}),I.setDeleteOnEmpty(!0),v.proxies[l]={ep:I,originalEp:p},l===0?this.router.sourceOrTargetChanged(H,q,v,z,0):this.router.sourceOrTargetChanged(H,q,v,z,1),p.detachFromConnection(v,null,!0),I.connections=[v],v.endpoints[l]=I,p.setVisible(!1),v.setVisible(!0),this.revalidate(z)},unproxyConnection:function(v,l,z){if(!(v._jsPlumb==null||v.proxies==null||v.proxies[l]==null)){var q=v.proxies[l].originalEp.element,tt=v.proxies[l].originalEp.elementId;v.endpoints[l]=v.proxies[l].originalEp,l===0?this.router.sourceOrTargetChanged(z,tt,v,q,0):this.router.sourceOrTargetChanged(z,tt,v,q,1),v.proxies[l].ep.detachFromConnection(v,null),v.proxies[l].originalEp.addConnection(v),v.isVisible()&&v.proxies[l].originalEp.setVisible(!0),delete v.proxies[l]}}});var k=new L;a.jsPlumb=k,k.getInstance=function(v,l){var z=new L(v);if(l)for(var q in l)z[q]=l[q];return z.init(),z},k.each=function(v,l){if(v!=null)if(typeof v=="string")l(k.getElement(v));else if(v.length!=null)for(var z=0;z<v.length;z++)l(k.getElement(v[z]));else l(v)},g.jsPlumb=k}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j="__label",C=function(s,_){var u={cssClass:_.cssClass,labelStyle:s.labelStyle,id:j,component:s,_jsPlumb:s._jsPlumb.instance},o=i.extend(u,_);return new i.Overlays[s._jsPlumb.instance.getRenderMode()].Label(o)},A=function(s,_){var u=null;if(h.isArray(_)){var o=_[0],m=i.extend({component:s,_jsPlumb:s._jsPlumb.instance},_[1]);_.length===3&&i.extend(m,_[2]),u=new i.Overlays[s._jsPlumb.instance.getRenderMode()][o](m)}else _.constructor===String?u=new i.Overlays[s._jsPlumb.instance.getRenderMode()][_]({component:s,_jsPlumb:s._jsPlumb.instance}):u=_;return u.id=u.id||h.uuid(),s.cacheTypeItem("overlay",u,u.id),s._jsPlumb.overlays[u.id]=u,u};i.OverlayCapableJsPlumbUIComponent=function(s){a.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},s.label&&(this.getDefaultType().overlays[j]=["Label",{label:s.label,location:s.labelLocation||this.defaultLabelLocation||.5,labelStyle:s.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:j}]),this.setListenerComponent=function(_){if(this._jsPlumb)for(var u in this._jsPlumb.overlays)this._jsPlumb.overlays[u].setListenerComponent(_)}},i.OverlayCapableJsPlumbUIComponent.applyType=function(s,_){if(_.overlays){var u={},o;for(o in _.overlays){var m=s._jsPlumb.overlays[_.overlays[o][1].id];if(m)m.updateFrom(_.overlays[o][1]),u[_.overlays[o][1].id]=!0,m.reattach(s._jsPlumb.instance,s);else{var D=s.getCachedTypeItem("overlay",_.overlays[o][1].id);D!=null?(D.reattach(s._jsPlumb.instance,s),D.setVisible(!0),D.updateFrom(_.overlays[o][1]),s._jsPlumb.overlays[D.id]=D):D=s.addOverlay(_.overlays[o],!0),u[D.id]=!0}}for(o in s._jsPlumb.overlays)u[s._jsPlumb.overlays[o].id]==null&&s.removeOverlay(s._jsPlumb.overlays[o].id,!0)}},h.extend(i.OverlayCapableJsPlumbUIComponent,a.jsPlumbUIComponent,{setHover:function(s,_){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var u in this._jsPlumb.overlays)this._jsPlumb.overlays[u][s?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(s,_){var u=A(this,s);if(this.getData&&u.type==="Label"&&h.isArray(s)){var o=this.getData(),m=s[1];if(o){var D=m.labelLocationAttribute||"labelLocation",L=o?o[D]:null;L&&(u.loc=L)}}return _||this.repaint(),u},getOverlay:function(s){return this._jsPlumb.overlays[s]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(s){var _=this.getOverlay(s);_&&_.hide()},hideOverlays:function(){for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s].hide()},showOverlay:function(s){var _=this.getOverlay(s);_&&_.show()},showOverlays:function(){for(var s in this._jsPlumb.overlays)this._jsPlumb.overlays[s].show()},removeAllOverlays:function(s){for(var _ in this._jsPlumb.overlays)this._jsPlumb.overlays[_].cleanup&&this._jsPlumb.overlays[_].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,this._jsPlumb.overlayPlacements={},s||this.repaint()},removeOverlay:function(s,_){var u=this._jsPlumb.overlays[s];u&&(u.setVisible(!1),!_&&u.cleanup&&u.cleanup(),delete this._jsPlumb.overlays[s],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[s],this._jsPlumb.overlayPlacements&&delete this._jsPlumb.overlayPlacements[s])},removeOverlays:function(){for(var s=0,_=arguments.length;s<_;s++)this.removeOverlay(arguments[s])},moveParent:function(s){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),s.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),s.appendChild(this.canvas);for(var _ in this._jsPlumb.overlays)if(this._jsPlumb.overlays[_].isAppendedAtTopLevel){var u=this._jsPlumb.overlays[_].getElement();u.parentNode.removeChild(u),s.appendChild(u)}}},getLabel:function(){var s=this.getOverlay(j);return s!=null?s.getLabel():null},getLabelOverlay:function(){return this.getOverlay(j)},setLabel:function(s){var _=this.getOverlay(j);if(_)s.constructor===String||s.constructor===Function?_.setLabel(s):(s.label&&_.setLabel(s.label),s.location&&_.setLocation(s.location));else{var u=s.constructor===String||s.constructor===Function?{label:s}:s;_=C(this,u),this._jsPlumb.overlays[j]=_}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(s){for(var _ in this._jsPlumb.overlays)this._jsPlumb.overlays[_].cleanup(s),this._jsPlumb.overlays[_].destroy(s);s&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(s){this[s?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(s,_){this._jsPlumb.overlayPositions[s.id]=_},getAbsoluteOverlayPosition:function(s){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[s.id]:null},_clazzManip:function(s,_,u){if(!u)for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o][s+"Class"](_)},addClass:function(s,_){this._clazzManip("add",s,_)},removeClass:function(s,_){this._clazzManip("remove",s,_)}})}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j=function(u,o,m){var D=!1;return{drag:function(){if(D)return D=!1,!0;if(o.element){var L=m.getUIPosition(arguments,m.getZoom());L!=null&&m.setPosition(o.element,L),m.repaint(o.element,L),u.paint({anchorPoint:u.anchor.getCurrentLocation({element:u})})}},stopDrag:function(){D=!0}}},C=function(u,o,m,D){var L=o.createElement("div",{position:"absolute"});o.appendElement(L);var k=o.getId(L);o.setPosition(L,m),L.style.width=D[0]+"px",L.style.height=D[1]+"px",o.manage(k,L,!0),u.id=k,u.element=L},A=function(u,o,m,D,L,k,v,l){var z=new i.FloatingAnchor({reference:o,referenceCanvas:D,jsPlumbInstance:k});return v({paintStyle:u,endpoint:m,anchor:z,source:L,scope:l})},s=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],_=function(u,o){var m=0;if(o!=null){for(var D=0;D<u.connections.length;D++)if(u.connections[D].sourceId===o||u.connections[D].targetId===o){m=D;break}}return u.connections[m]};i.Endpoint=function(u){var o=u._jsPlumb,m=u.newConnection,D=u.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],i.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:u.connectionType,maxConnections:u.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:u.maxConnections,paintStyle:u.endpointStyle||u.paintStyle||u.style||this._jsPlumb.instance.Defaults.EndpointStyle||i.Defaults.EndpointStyle,hoverPaintStyle:u.endpointHoverStyle||u.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||i.Defaults.EndpointHoverStyle,connectorStyle:u.connectorStyle,connectorHoverStyle:u.connectorHoverStyle,connectorClass:u.connectorClass,connectorHoverClass:u.connectorHoverClass,connectorOverlays:u.connectorOverlays,connector:u.connector,connectorTooltip:u.connectorTooltip}),this._jsPlumb.enabled=u.enabled!==!1,this._jsPlumb.visible=!0,this.element=i.getElement(u.source),this._jsPlumb.uuid=u.uuid,this._jsPlumb.floatingEndpoint=null,this._jsPlumb.uuid&&(u.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=u.elementId,this.dragProxy=u.dragProxy,this._jsPlumb.connectionCost=u.connectionCost,this._jsPlumb.connectionsDirected=u.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var L=u.deleteOnEmpty===!0;this.setDeleteOnEmpty=function(I){L=I};var k=function(){var I=o.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var H=o.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(I),this.addClass(H),i.updateClasses(this.element,H,I)}.bind(this);this.prepareAnchor=function(I){var H=this._jsPlumb.instance.makeAnchor(I,this.elementId,o);return H.bind("anchorChanged",function(p){this.fire("anchorChanged",{endpoint:this,anchor:p}),k()}.bind(this)),H},this.setPreparedAnchor=function(I,H){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=I,k(),H||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(I,H){var p=this.prepareAnchor(I);return this.setPreparedAnchor(p,H),this};var v=function(I){if(this.connections.length>0)for(var H=0;H<this.connections.length;H++)this.connections[H].setHover(I,!1);else this.setHover(I)}.bind(this);this.bind("mouseover",function(){v(!0)}),this.bind("mouseout",function(){v(!1)}),u._transient||this._jsPlumb.instance.router.addEndpoint(this,this.elementId),this.prepareEndpoint=function(I,H){var p=function(B,W){var w=o.getRenderMode();if(i.Endpoints[w][B])return new i.Endpoints[w][B](W);if(!o.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+B+"'"}},E={_jsPlumb:this._jsPlumb.instance,cssClass:u.cssClass,container:u.container,tooltip:u.tooltip,connectorTooltip:u.connectorTooltip,endpoint:this},x;return h.isString(I)?x=p(I,E):h.isArray(I)?(E=h.merge(I[1],E),x=p(I[0],E)):x=I.clone(),x.clone=function(){if(h.isString(I))return p(I,E);if(h.isArray(I))return E=h.merge(I[1],E),p(I[0],E)}.bind(this),x.typeId=H,x},this.setEndpoint=function(I,H){var p=this.prepareEndpoint(I);this.setPreparedEndpoint(p,!0)},this.setPreparedEndpoint=function(I,H){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=I,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},i.extend(this,u,s),this.isSource=u.isSource||!1,this.isTemporarySource=u.isTemporarySource||!1,this.isTarget=u.isTarget||!1,this.connections=u.connections||[],this.connectorPointerEvents=u["connector-pointer-events"],this.scope=u.scope||o.getDefaultScope(),this.timestamp=null,this.reattachConnections=u.reattach||o.Defaults.ReattachConnections,this.connectionsDetachable=o.Defaults.ConnectionsDetachable,(u.connectionsDetachable===!1||u.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=u.dragAllowedWhenFull!==!1,u.onMaxConnections&&this.bind("maxConnections",u.onMaxConnections),this.addConnection=function(I){this.connections.push(I),this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass)},this.detachFromConnection=function(I,H,p){H=H??this.connections.indexOf(I),H>=0&&(this.connections.splice(H,1),this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass)),!p&&L&&this.connections.length===0&&o.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:p!==!0})},this.deleteEveryConnection=function(I){for(var H=this.connections.length,p=0;p<H;p++)o.deleteConnection(this.connections[0],I)},this.detachFrom=function(I,H,p){for(var E=[],x=0;x<this.connections.length;x++)(this.connections[x].endpoints[1]===I||this.connections[x].endpoints[0]===I)&&E.push(this.connections[x]);for(var B=0,W=E.length;B<W;B++)o.deleteConnection(E[0]);return this},this.getElement=function(){return this.element},this.setElement=function(I){var H=this._jsPlumb.instance.getId(I),p=this.elementId;return h.removeWithFunction(u.endpointsByElement[this.elementId],function(E){return E.id===this.id}.bind(this)),this.element=i.getElement(I),this.elementId=o.getId(this.element),o.router.rehomeEndpoint(this,p,this.element),o.dragManager.endpointAdded(this.element),h.addToList(u.endpointsByElement,H,this),this},this.makeInPlaceCopy=function(){var I=this.anchor.getCurrentLocation({element:this}),H=this.anchor.getOrientation(this),p=this.anchor.getCssClass(),E={bind:function(){},compute:function(){return[I[0],I[1]]},getCurrentLocation:function(){return[I[0],I[1]]},getOrientation:function(){return H},getCssClass:function(){return p}};return D({dropOptions:u.dropOptions,anchor:E,source:this.element,paintStyle:this.getPaintStyle(),endpoint:u.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(I){I=I||{};var H=I.timestamp,p=I.recalc!==!1;if(!H||this.timestamp!==H){var E=o.updateOffset({elId:this.elementId,timestamp:H}),x=I.offset?I.offset.o:E.o;if(x!=null){var B=I.anchorPoint,W=I.connectorPaintStyle;if(B==null){var w=I.dimensions||E.s,K={xy:[x.left,x.top],wh:w,element:this,timestamp:H};if(p&&this.anchor.isDynamic&&this.connections.length>0){var U=_(this,I.elementWithPrecedence),O=U.endpoints[0]===this?1:0,y=O===0?U.sourceId:U.targetId,X=o.getCachedData(y),ot=X.o,Q=X.s;K.index=O===0?1:0,K.connection=U,K.txy=[ot.left,ot.top],K.twh=Q,K.tElement=U.endpoints[O],K.tRotation=o.getRotation(y)}else this.connections.length>0&&(K.connection=this.connections[0]);K.rotation=o.getRotation(this.elementId),B=this.anchor.compute(K)}this.endpoint.compute(B,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,W||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=H;for(var it in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(it)){var f=this._jsPlumb.overlays[it];f.isVisible()&&(this._jsPlumb.overlayPlacements[it]=f.draw(this.endpoint,this._jsPlumb.paintStyleInUse),f.paint(this._jsPlumb.overlayPlacements[it]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var l=!1;this.initDraggable=function(){if(!l&&i.isDragSupported(this.element)){var I={id:null,element:null},H=null,p=!1,E=null,x=j(this,I,o),B=u.dragOptions||{},W={},w=i.dragEvents.start,K=i.dragEvents.stop,U=i.dragEvents.drag,O=i.dragEvents.beforeStart,y,X=function(it){y=it.e.payload||{}},ot=function(it){H=this.connectorSelector();var f=!0;this.isEnabled()||(f=!1),H==null&&!this.isSource&&!this.isTemporarySource&&(f=!1),this.isSource&&this.isFull()&&!(H!=null&&this.dragAllowedWhenFull)&&(f=!1),H!=null&&!H.isDetachable(this)&&(this.isFull()?f=!1:H=null);var S=o.checkCondition(H==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:H});if(S===!1?f=!1:typeof S=="object"?i.extend(S,y||{}):S=y||{},f===!1)return o.stopDrag&&o.stopDrag(this.canvas),x.stopDrag(),!1;for(var c=0;c<this.connections.length;c++)this.connections[c].setHover(!1);this.addClass("endpointDrag"),o.setConnectionBeingDragged(!0),H&&!this.isFull()&&this.isSource&&(H=null),o.updateOffset({elId:this.elementId});var R=this._jsPlumb.instance.getOffset(this.canvas),M=this.canvas,V=this._jsPlumb.instance.getSize(this.canvas);C(I,o,R,V),o.setAttributes(this.canvas,{dragId:I.id,elId:this.elementId});var et=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var lt=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);lt.endpoints[1]&&(et=lt.endpoints[1])}var st=this._jsPlumb.instance.makeAnchor("Center");st.isFloating=!0,this._jsPlumb.floatingEndpoint=A(this.getPaintStyle(),st,et,this.canvas,I.element,o,D,this.scope);var ct=this._jsPlumb.floatingEndpoint.anchor;if(H==null)this.setHover(!1,!1),H=m({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:I.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:u.connectorStyle,hoverPaintStyle:u.connectorHoverStyle,connector:u.connector,overlays:u.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:u.scope,data:S}),H.pending=!0,H.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.anchor=ct,o.fire("connectionDrag",H),o.router.newConnection(H);else{p=!0,H.setHover(!1);var Et=H.endpoints[0].id===this.id?0:1;this.detachFromConnection(H,null,!0);var yt=o.getDragScope(M);o.setAttribute(this.canvas,"originalScope",yt),o.fire("connectionDrag",H),Et===0?(E=[H.source,H.sourceId,M,yt],o.router.sourceOrTargetChanged(H.endpoints[Et].elementId,I.id,H,I.element,0)):(E=[H.target,H.targetId,M,yt],o.router.sourceOrTargetChanged(H.endpoints[Et].elementId,I.id,H,I.element,1)),H.suspendedEndpoint=H.endpoints[Et],H.suspendedElement=H.endpoints[Et].getElement(),H.suspendedElementId=H.endpoints[Et].elementId,H.suspendedElementType=Et===0?"source":"target",H.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=H.suspendedEndpoint,H.endpoints[Et]=this._jsPlumb.floatingEndpoint,H.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass)}o.registerFloatingConnection(I,H,this._jsPlumb.floatingEndpoint),o.currentlyDragging=!0}.bind(this),Q=function(){if(o.setConnectionBeingDragged(!1),H&&H.endpoints!=null){var it=o.getDropEvent(arguments),f=o.getFloatingAnchorIndex(H);if(H.endpoints[f===0?1:0].anchor.locked=!1,H.removeClass(o.draggingClass),this._jsPlumb&&(H.deleteConnectionNow||H.endpoints[f]===this._jsPlumb.floatingEndpoint)&&p&&H.suspendedEndpoint){f===0?(H.floatingElement=H.source,H.floatingId=H.sourceId,H.floatingEndpoint=H.endpoints[0],H.floatingIndex=0,H.source=E[0],H.sourceId=E[1]):(H.floatingElement=H.target,H.floatingId=H.targetId,H.floatingEndpoint=H.endpoints[1],H.floatingIndex=1,H.target=E[0],H.targetId=E[1]);var S=this._jsPlumb.floatingEndpoint;o.setDragScope(E[2],E[3]),H.endpoints[f]=H.suspendedEndpoint,H.isReattach()||H._forceReattach||H._forceDetach||!o.deleteConnection(H,{originalEvent:it})?(H.setHover(!1),H._forceDetach=null,H._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(H),H.suspendedEndpoint.addConnection(H),f===1?o.router.sourceOrTargetChanged(H.floatingId,H.targetId,H,H.target,f):o.router.sourceOrTargetChanged(H.floatingId,H.sourceId,H,H.source,f),o.repaint(E[1])):o.deleteObject({endpoint:S})}this.deleteAfterDragStop?o.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),o.fire("connectionDragStop",H,it),H.pending&&o.fire("connectionAborted",H,it),o.currentlyDragging=!1,H.suspendedElement=null,H.suspendedEndpoint=null,H=null}I&&I.element&&o.remove(I.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);B=i.extend(W,B),B.scope=this.scope||B.scope,B[O]=h.wrap(B[O],X,!1),B[w]=h.wrap(B[w],ot,!1),B[U]=h.wrap(B[U],x.drag),B[K]=h.wrap(B[K],Q),B.multipleDrop=!1,B.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==!1}.bind(this),o.initDraggable(this.canvas,B,"internal"),this.canvas._jsPlumbRelatedElement=this.element,l=!0}};var z=u.endpoint||this._jsPlumb.instance.Defaults.Endpoint||i.Defaults.Endpoint;this.setEndpoint(z,!0);var q=u.anchor?u.anchor:u.anchors?u.anchors:o.Defaults.Anchor||"Top";this.setAnchor(q,!0);var tt=["default",u.type||""].join(" ");this.addType(tt,u.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var Y=function(I,H,p,E){if(i.isDropSupported(this.element)){var x=u.dropOptions||o.Defaults.DropOptions||i.Defaults.DropOptions;x=i.extend({},x),x.scope=x.scope||this.scope;var B=i.dragEvents.drop,W=i.dragEvents.over,w=i.dragEvents.out,K=this,U=o.EndpointDropHandler({getEndpoint:function(){return K},jsPlumb:o,enabled:function(){return p!=null?p.isEnabled():!0},isFull:function(){return p.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(O){K.addClass(O)},removeClass:function(O){K.removeClass(O)},isDropAllowed:function(){return K.isDropAllowed.apply(K,arguments)},reference:E,isRedrop:function(O,y){return O.suspendedEndpoint&&y.reference&&O.suspendedEndpoint.id===y.reference.id}});x[B]=h.wrap(x[B],U,!0),x[W]=h.wrap(x[W],function(){var O=i.getDragObject(arguments),y=o.getAttribute(i.getElement(O),"dragId"),X=o.getFloatingConnectionFor(y);if(X!=null){var ot=o.getFloatingAnchorIndex(X),Q=this.isTarget&&ot!==0||X.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===X.suspendedEndpoint.id;if(Q){var it=o.checkCondition("checkDropAllowed",{sourceEndpoint:X.endpoints[ot],targetEndpoint:this,connection:X});this[(it?"add":"remove")+"Class"](o.endpointDropAllowedClass),this[(it?"remove":"add")+"Class"](o.endpointDropForbiddenClass),X.endpoints[ot].anchor.over(this.anchor,this)}}}.bind(this)),x[w]=h.wrap(x[w],function(){var O=i.getDragObject(arguments),y=O==null?null:o.getAttribute(i.getElement(O),"dragId"),X=y?o.getFloatingConnectionFor(y):null;if(X!=null){var ot=o.getFloatingAnchorIndex(X),Q=this.isTarget&&ot!==0||X.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===X.suspendedEndpoint.id;Q&&(this.removeClass(o.endpointDropAllowedClass),this.removeClass(o.endpointDropForbiddenClass),X.endpoints[ot].anchor.out())}}.bind(this)),o.initDroppable(I,x,"internal",H)}}.bind(this);return this.anchor.isFloating||Y(this.canvas,!(u._transient||this.anchor.isFloating),this,u.reference),this},h.extend(i.Endpoint,i.OverlayCapableJsPlumbUIComponent,{setVisible:function(u,o,m){if(this._jsPlumb.visible=u,this.canvas&&(this.canvas.style.display=u?"block":"none"),this[u?"showOverlays":"hideOverlays"](),!o){for(var D=0;D<this.connections.length;D++)if(this.connections[D].setVisible(u),!m){var L=this===this.connections[D].endpoints[0]?1:0;this.connections[D].endpoints[L].connections.length===1&&this.connections[D].endpoints[L].setVisible(u,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(u,o){this.setPaintStyle(u.endpointStyle||u.paintStyle,o),this.setHoverPaintStyle(u.endpointHoverStyle||u.hoverPaintStyle,o),u.maxConnections!=null&&(this._jsPlumb.maxConnections=u.maxConnections),u.scope&&(this.scope=u.scope),i.extend(this,u,s),u.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,u.cssClass),i.OverlayCapableJsPlumbUIComponent.applyType(this,u)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(u){this._jsPlumb.enabled=u},cleanup:function(){var u=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");i.removeClass(this.element,u),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(u){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(u)},isFull:function(){return this._jsPlumb.maxConnections===0?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(u){var o=!1;if(u){for(var m=0;m<this.connections.length;m++)if(this.connections[m].endpoints[1]===u||this.connections[m].endpoints[0]===u){o=!0;break}}return o},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(u){this._jsPlumb.connectionCost=u},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(u){this._jsPlumb.connectionsDirected=u},setElementId:function(u){this.elementId=u,this.anchor.elementId=u},setReferenceElement:function(u){this.element=i.getElement(u)},setDragAllowedWhenFull:function(u){this.dragAllowedWhenFull=u},equals:function(u){return this.anchor.equals(u.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(u){return this.anchor.compute(u)}}),a.jsPlumbInstance.prototype.EndpointDropHandler=function(u){return function(o){var m=u.jsPlumb;u.removeClass(m.endpointDropAllowedClass),u.removeClass(m.endpointDropForbiddenClass);var D=m.getDropEvent(arguments),L=m.getDragObject(arguments),k=m.getAttribute(L,"dragId");m.getAttribute(L,"elId");var v=m.getAttribute(L,"originalScope"),l=m.getFloatingConnectionFor(k);if(l!=null){var z=l.suspendedEndpoint!=null;if(!(z&&l.suspendedEndpoint._jsPlumb==null)){var q=u.getEndpoint(l);if(q!=null){if(u.isRedrop(l,u)){l._forceReattach=!0,l.setHover(!1),u.maybeCleanup&&u.maybeCleanup(q);return}var tt=m.getFloatingAnchorIndex(l);if(tt===0&&!u.isSource||tt===1&&!u.isTarget){u.maybeCleanup&&u.maybeCleanup(q);return}u.onDrop&&u.onDrop(l),v&&m.setDragScope(L,v);var Y=u.isFull(o);if(Y&&q.fire("maxConnections",{endpoint:this,connection:l,maxConnections:q._jsPlumb.maxConnections},D),!Y&&u.enabled()){var I=!0;tt===0?(l.floatingElement=l.source,l.floatingId=l.sourceId,l.floatingEndpoint=l.endpoints[0],l.floatingIndex=0,l.source=u.element,l.sourceId=m.getId(u.element)):(l.floatingElement=l.target,l.floatingId=l.targetId,l.floatingEndpoint=l.endpoints[1],l.floatingIndex=1,l.target=u.element,l.targetId=m.getId(u.element)),z&&l.suspendedEndpoint.id!==q.id&&(!l.isDetachAllowed(l)||!l.endpoints[tt].isDetachAllowed(l)||!l.suspendedEndpoint.isDetachAllowed(l)||!m.checkCondition("beforeDetach",l))&&(I=!1);var H=function(E){l.endpoints[tt].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),l.endpoints[tt]=q,q.addConnection(l);var x=q.getParameters();for(var B in x)l.setParameter(B,x[B]);if(!z)x.draggable&&m.initDraggable(this.element,u.dragOptions,"internal",m);else{var W=l.suspendedEndpoint.elementId;m.fireMoveEvent({index:tt,originalSourceId:tt===0?W:l.sourceId,newSourceId:tt===0?q.elementId:l.sourceId,originalTargetId:tt===1?W:l.targetId,newTargetId:tt===1?q.elementId:l.targetId,originalSourceEndpoint:tt===0?l.suspendedEndpoint:l.endpoints[0],newSourceEndpoint:tt===0?q:l.endpoints[0],originalTargetEndpoint:tt===1?l.suspendedEndpoint:l.endpoints[1],newTargetEndpoint:tt===1?q:l.endpoints[1],connection:l},D)}if(tt===1?m.router.sourceOrTargetChanged(l.floatingId,l.targetId,l,l.target,1):m.router.sourceOrTargetChanged(l.floatingId,l.sourceId,l,l.source,0),l.endpoints[0].finalEndpoint){var w=l.endpoints[0];w.detachFromConnection(l),l.endpoints[0]=l.endpoints[0].finalEndpoint,l.endpoints[0].addConnection(l)}h.isObject(E)&&l.mergeData(E),m.finaliseConnection(l,null,D,!1),l.setHover(!1),m.revalidate(l.endpoints[0].element)}.bind(this),p=function(){l.suspendedEndpoint&&(l.endpoints[tt]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,tt===0?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),tt===1?m.router.sourceOrTargetChanged(l.floatingId,l.targetId,l,l.target,1):m.router.sourceOrTargetChanged(l.floatingId,l.sourceId,l,l.source,0),m.repaint(l.sourceId),l._forceDetach=!1)};if(I=I&&u.isDropAllowed(l.sourceId,l.targetId,l.scope,l,q),I)return H(I),!0;p()}u.maybeCleanup&&u.maybeCleanup(q),m.currentlyDragging=!1}}}}}}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j=function(s,_,u,o,m){if(i.Connectors[_]=i.Connectors[_]||{},i.Connectors[_][u]==null){if(i.Connectors[u]==null){if(s.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+u+"'")}i.Connectors[_][u]=function(){i.Connectors[u].apply(this,arguments),i.ConnectorRenderers[_].apply(this,arguments)},h.extend(i.Connectors[_][u],[i.Connectors[u],i.ConnectorRenderers[_]])}return new i.Connectors[_][u](o,m)},C=function(s,_,u){return s?u.makeAnchor(s,_,u):null},A=function(s,_,u,o){_!=null&&(_._jsPlumbConnections=_._jsPlumbConnections||{},o?delete _._jsPlumbConnections[s.id]:_._jsPlumbConnections[s.id]=!0,h.isEmpty(_._jsPlumbConnections)?u.removeClass(_,u.connectedClass):u.addClass(_,u.connectedClass))};i.Connection=function(s){var _=s.newEndpoint;this.id=s.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=s.previousConnection,this.source=i.getElement(s.source),this.target=i.getElement(s.target),i.OverlayCapableJsPlumbUIComponent.apply(this,arguments),s.sourceEndpoint?(this.source=s.sourceEndpoint.getElement(),this.sourceId=s.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),s.targetEndpoint?(this.target=s.targetEndpoint.getElement(),this.targetId=s.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=s.scope,this.endpoints=[],this.endpointStyles=[];var u=this._jsPlumb.instance;u.manage(this.sourceId,this.source),u.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:s.cssClass,container:s.container,"pointer-events":s["pointer-events"],editorParams:s.editorParams,overlays:s.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(B,W,w,K,U){return w=w||this._jsPlumb.instance.getId(W),this.prepareEndpoint(u,_,this,K,B?0:1,s,W,w,U)},s.type&&(s.endpoints=s.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(s.type).endpoints);var o=this.makeEndpoint(!0,this.source,this.sourceId,s.sourceEndpoint),m=this.makeEndpoint(!1,this.target,this.targetId,s.targetEndpoint);o&&h.addToList(s.endpointsByElement,this.sourceId,o),m&&h.addToList(s.endpointsByElement,this.targetId,m),this.scope||(this.scope=this.endpoints[0].scope),s.deleteEndpointsOnEmpty!=null&&(this.endpoints[0].setDeleteOnEmpty(s.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(s.deleteEndpointsOnEmpty));var D=u.Defaults.ConnectionsDetachable;s.detachable===!1&&(D=!1),this.endpoints[0].connectionsDetachable===!1&&(D=!1),this.endpoints[1].connectionsDetachable===!1&&(D=!1);var L=s.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||u.Defaults.ReattachConnections;this.appendToDefaultType({detachable:D,reattach:L,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||s.paintStyle||u.Defaults.PaintStyle||i.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||s.hoverPaintStyle||u.Defaults.HoverPaintStyle||i.Defaults.HoverPaintStyle});var k=u.getSuspendedAt();if(!u.isSuspendDrawing()){var v=u.getCachedData(this.sourceId),l=v.o,z=v.s,q=u.getCachedData(this.targetId),tt=q.o,Y=q.s,I=k||jsPlumbUtil.uuid(),H=this.endpoints[0].anchor.compute({xy:[l.left,l.top],wh:z,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[tt.left,tt.top],twh:Y,tElement:this.endpoints[1],timestamp:I,rotation:u.getRotation(this.endpoints[0].elementId)});this.endpoints[0].paint({anchorLoc:H,timestamp:I}),H=this.endpoints[1].anchor.compute({xy:[tt.left,tt.top],wh:Y,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[l.left,l.top],twh:z,tElement:this.endpoints[0],timestamp:I,rotation:u.getRotation(this.endpoints[1].elementId)}),this.endpoints[1].paint({anchorLoc:H,timestamp:I})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(B){return this._jsPlumb.detachable===!1?!1:B!=null?B.connectionsDetachable===!0:this._jsPlumb.detachable===!0},this.setDetachable=function(B){this._jsPlumb.detachable=B===!0},this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0},this.setReattach=function(B){this._jsPlumb.reattach=B===!0},this._jsPlumb.cost=s.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=s.directed,s.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var p=i.extend({},this.endpoints[1].getParameters());i.extend(p,this.endpoints[0].getParameters()),i.extend(p,this.getParameters()),this.setParameters(p),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||s.connector||u.Defaults.Connector||i.Defaults.Connector,!0);var E=s.data==null||!h.isObject(s.data)?{}:s.data;this.getData=function(){return E},this.setData=function(B){E=B||{}},this.mergeData=function(B){E=i.extend(E,B)};var x=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,s.type].join(" ");/[^\s]/.test(x)&&this.addType(x,s.data,!0),this.updateConnectedClass()},h.extend(i.Connection,i.OverlayCapableJsPlumbUIComponent,{applyType:function(s,_,u){var o=null;s.connector!=null&&(o=this.getCachedTypeItem("connector",u.connector),o==null&&(o=this.prepareConnector(s.connector,u.connector),this.cacheTypeItem("connector",o,u.connector)),this.setPreparedConnector(o)),s.detachable!=null&&this.setDetachable(s.detachable),s.reattach!=null&&this.setReattach(s.reattach),s.scope&&(this.scope=s.scope),s.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,s.cssClass);var m=null;s.anchor?(m=this.getCachedTypeItem("anchors",u.anchor),m==null&&(m=[this._jsPlumb.instance.makeAnchor(s.anchor),this._jsPlumb.instance.makeAnchor(s.anchor)],this.cacheTypeItem("anchors",m,u.anchor))):s.anchors&&(m=this.getCachedTypeItem("anchors",u.anchors),m==null&&(m=[this._jsPlumb.instance.makeAnchor(s.anchors[0]),this._jsPlumb.instance.makeAnchor(s.anchors[1])],this.cacheTypeItem("anchors",m,u.anchors))),m!=null&&(this.endpoints[0].anchor=m[0],this.endpoints[1].anchor=m[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),i.OverlayCapableJsPlumbUIComponent.applyType(this,s)},addClass:function(s,_){_&&(this.endpoints[0].addClass(s),this.endpoints[1].addClass(s),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(s)),this.connector&&this.connector.addClass(s)},removeClass:function(s,_){_&&(this.endpoints[0].removeClass(s),this.endpoints[1].removeClass(s),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(s)),this.connector&&this.connector.removeClass(s)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(s){this._jsPlumb.visible=s,this.connector&&this.connector.setVisible(s),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(s){this._jsPlumb&&(A(this,this.source,this._jsPlumb.instance,s),A(this,this.target,this._jsPlumb.instance,s))},setHover:function(s){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(s),a.jsPlumb[s?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),a.jsPlumb[s?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(s){this._jsPlumb.cost=s},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(s,_){var u={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},o=this._jsPlumb.instance.getRenderMode(),m;return h.isString(s)?m=j(this._jsPlumb.instance,o,s,u,this):h.isArray(s)&&(s.length===1?m=j(this._jsPlumb.instance,o,s[0],u,this):m=j(this._jsPlumb.instance,o,s[0],h.merge(s[1],u),this)),_!=null&&(m.typeId=_),m},setPreparedConnector:function(s,_,u,o){if(this.connector!==s){var m,D="";if(this.connector!=null&&(m=this.connector,D=m.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=s,o&&this.cacheTypeItem("connector",s,o),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.connector.reattach(this._jsPlumb.instance),this.addClass(D),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),m!=null)for(var L=this.getOverlays(),k=0;k<L.length;k++)L[k].transfer&&L[k].transfer(this.connector);u||this.setListenerComponent(this.connector),_||this.repaint()}},setConnector:function(s,_,u,o){var m=this.prepareConnector(s,o);this.setPreparedConnector(m,_,u,o)},paint:function(s){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){s=s||{};var _=s.timestamp,u=!1,o=u?this.sourceId:this.targetId,m=u?this.targetId:this.sourceId,D=u?0:1,L=u?1:0;if(_==null||_!==this._jsPlumb.lastPaintedAt){var k=this._jsPlumb.instance.updateOffset({elId:m}).o,v=this._jsPlumb.instance.updateOffset({elId:o}).o,l=this.endpoints[L],z=this.endpoints[D],q=l.anchor.getCurrentLocation({xy:[k.left,k.top],wh:[k.width,k.height],element:l,timestamp:_,rotation:this._jsPlumb.instance.getRotation(this.sourceId)}),tt=z.anchor.getCurrentLocation({xy:[v.left,v.top],wh:[v.width,v.height],element:z,timestamp:_,rotation:this._jsPlumb.instance.getRotation(this.targetId)});this.connector.resetBounds(),this.connector.compute({sourcePos:q,targetPos:tt,sourceOrientation:l.anchor.getOrientation(l),targetOrientation:z.anchor.getOrientation(z),sourceEndpoint:this.endpoints[L],targetEndpoint:this.endpoints[D],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:k,targetInfo:v});var Y={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var I in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(I)){var H=this._jsPlumb.overlays[I];H.isVisible()&&(this._jsPlumb.overlayPlacements[I]=H.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(H)),Y.minX=Math.min(Y.minX,this._jsPlumb.overlayPlacements[I].minX),Y.maxX=Math.max(Y.maxX,this._jsPlumb.overlayPlacements[I].maxX),Y.minY=Math.min(Y.minY,this._jsPlumb.overlayPlacements[I].minY),Y.maxY=Math.max(Y.maxY,this._jsPlumb.overlayPlacements[I].maxY))}var p=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,E=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),x={xmin:Math.min(this.connector.bounds.minX-(p+E),Y.minX),ymin:Math.min(this.connector.bounds.minY-(p+E),Y.minY),xmax:Math.max(this.connector.bounds.maxX+(p+E),Y.maxX),ymax:Math.max(this.connector.bounds.maxY+(p+E),Y.maxY)};this.connector.paintExtents=x,this.connector.paint(this._jsPlumb.paintStyleInUse,null,x);for(var B in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(B)){var W=this._jsPlumb.overlays[B];W.isVisible()&&W.paint(this._jsPlumb.overlayPlacements[B],x)}}this._jsPlumb.lastPaintedAt=_}},repaint:function(s){var _=jsPlumb.extend(s||{},{});_.elId=this.sourceId,this.paint(_)},prepareEndpoint:function(s,_,u,o,m,D,L,k,v){var l;if(o)u.endpoints[m]=o,o.addConnection(u);else{D.endpoints||(D.endpoints=[null,null]);var z=v||D.endpoints[m]||D.endpoint||s.Defaults.Endpoints[m]||i.Defaults.Endpoints[m]||s.Defaults.Endpoint||i.Defaults.Endpoint;D.endpointStyles||(D.endpointStyles=[null,null]),D.endpointHoverStyles||(D.endpointHoverStyles=[null,null]);var q=D.endpointStyles[m]||D.endpointStyle||s.Defaults.EndpointStyles[m]||i.Defaults.EndpointStyles[m]||s.Defaults.EndpointStyle||i.Defaults.EndpointStyle;q.fill==null&&D.paintStyle!=null&&(q.fill=D.paintStyle.stroke),q.outlineStroke==null&&D.paintStyle!=null&&(q.outlineStroke=D.paintStyle.outlineStroke),q.outlineWidth==null&&D.paintStyle!=null&&(q.outlineWidth=D.paintStyle.outlineWidth);var tt=D.endpointHoverStyles[m]||D.endpointHoverStyle||s.Defaults.EndpointHoverStyles[m]||i.Defaults.EndpointHoverStyles[m]||s.Defaults.EndpointHoverStyle||i.Defaults.EndpointHoverStyle;D.hoverPaintStyle!=null&&(tt==null&&(tt={}),tt.fill==null&&(tt.fill=D.hoverPaintStyle.stroke));var Y=D.anchors?D.anchors[m]:D.anchor?D.anchor:C(s.Defaults.Anchors[m],k,s)||C(i.Defaults.Anchors[m],k,s)||C(s.Defaults.Anchor,k,s)||C(i.Defaults.Anchor,k,s),I=D.uuids?D.uuids[m]:null;l=_({paintStyle:q,hoverPaintStyle:tt,endpoint:z,connections:[u],uuid:I,anchor:Y,source:L,scope:D.scope,reattach:D.reattach||s.Defaults.ReattachConnections,detachable:D.detachable||s.Defaults.ConnectionsDetachable}),o==null&&l.setDeleteOnEmpty(!0),u.endpoints[m]=l,D.drawEndpoints===!1&&l.setVisible(!1,!0,!0)}return l},replaceEndpoint:function(s,_){var u=this.endpoints[s],o=u.elementId,m=this._jsPlumb.instance.getEndpoints(o),D=m.indexOf(u),L=this.makeEndpoint(s===0,u.element,o,null,_);this.endpoints[s]=L,m.splice(D,1,L),this._jsPlumb.instance.deleteObject({endpoint:u,deleteAttachedObjects:!1}),this._jsPlumb.instance.fire("endpointReplaced",{previous:u,current:L}),this._jsPlumb.instance.router.sourceOrTargetChanged(this.endpoints[1].elementId,this.endpoints[1].elementId,this,this.endpoints[1].element,1)}})}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumbUtil,h=a.jsPlumb;h.AnchorManager=function(s){var _={},u={},o={},m={},D=this,L={},k=s.jsPlumbInstance,v={},l=function(x,B,W,w,K,U,O,y){for(var X=[],ot=B[K?0:1]/(w.length+1),Q=0;Q<w.length;Q++){var it=(Q+1)*ot,f=U*B[K?1:0];O&&(it=B[K?0:1]-it);var S=K?it:f,c=W.left+S,R=S/B[0],M=K?f:it,V=W.top+M,et=M/B[1];if(y!==0){var lt=jsPlumbUtil.rotatePoint([c,V],[W.centerx,W.centery],y);c=lt[0],V=lt[1]}X.push([c,V,R,et,w[Q][1],w[Q][2]])}return X},z=function(x,B){return B[0][0]-x[0][0]},q=function(x,B){var W=x[0][0]<0?-Math.PI-x[0][0]:Math.PI-x[0][0],w=B[0][0]<0?-Math.PI-B[0][0]:Math.PI-B[0][0];return W-w},tt={top:q,right:z,bottom:z,left:q},Y=function(x,B){return x.sort(B)},I=function(x,B){var W=k.getCachedData(x),w=W.s,K=W.o,U=function(O,y,X,ot,Q,it,f){if(ot.length>0)for(var S=Y(ot,tt[O]),c=O==="right"||O==="top",R=k.getRotation(x),M=l(O,y,X,S,Q,it,c,R),V=function(Et,yt){u[Et.id]=[yt[0],yt[1],yt[2],yt[3]],o[Et.id]=f},et=0;et<M.length;et++){var lt=M[et][4],st=lt.endpoints[0].elementId===x,ct=lt.endpoints[1].elementId===x;st&&V(lt.endpoints[0],M[et]),ct&&V(lt.endpoints[1],M[et])}};U("bottom",w,K,B.bottom,!0,1,[0,1]),U("top",w,K,B.top,!0,0,[0,-1]),U("left",w,K,B.left,!1,0,[-1,0]),U("right",w,K,B.right,!1,1,[1,0])};this.reset=function(){_={},m={},L={}},this.addFloatingConnection=function(x,B){v[x]=B},this.newConnection=function(x){var B=x.sourceId,W=x.targetId,w=x.endpoints,K=!0,U=function(O,y,X,ot,Q){B===W&&X.isContinuous&&(x._jsPlumb.instance.removeElement(w[1].canvas),K=!1),i.addToList(m,ot,[Q,y,X.constructor===h.DynamicAnchor])};U(0,w[0],w[0].anchor,W,x),K&&U(1,w[1],w[1].anchor,B,x)};var H=function(x){(function(B,W){if(B){var w=function(K){return K[4]===W};i.removeWithFunction(B.top,w),i.removeWithFunction(B.left,w),i.removeWithFunction(B.bottom,w),i.removeWithFunction(B.right,w)}})(L[x.elementId],x.id)};this.connectionDetached=function(x,B){var W=x.connection||x,w=x.sourceId,K=x.targetId,U=W.endpoints,O=function(y,X,ot,Q,it){i.removeWithFunction(m[Q],function(f){return f[0].id===it.id})};O(1,U[1],U[1].anchor,w,W),O(0,U[0],U[0].anchor,K,W),W.floatingId&&(O(W.floatingIndex,W.floatingEndpoint,W.floatingEndpoint.anchor,W.floatingId,W),H(W.floatingEndpoint)),H(W.endpoints[0]),H(W.endpoints[1]),B||(D.redraw(W.sourceId),W.targetId!==W.sourceId&&D.redraw(W.targetId))},this.addEndpoint=function(x,B){i.addToList(_,B,x)},this.changeId=function(x,B){m[B]=m[x],_[B]=_[x],delete m[x],delete _[x]},this.getConnectionsFor=function(x){return m[x]||[]},this.getEndpointsFor=function(x){return _[x]||[]},this.deleteEndpoint=function(x){i.removeWithFunction(_[x.elementId],function(B){return B.id===x.id}),H(x)},this.elementRemoved=function(x){delete v[x],delete _[x],_[x]=[]};var p=function(x,B,W,w,K,U,O,y,X,ot,Q,it){var f=-1,S=w.endpoints[O],c=S.id,R=[1,0][O],M=[[B,W],w,K,U,c],V=x[X],et=S._continuousAnchorEdge?x[S._continuousAnchorEdge]:null,lt,st;if(et){var ct=i.findWithFunction(et,function(yt){return yt[4]===c});if(ct!==-1)for(et.splice(ct,1),lt=0;lt<et.length;lt++)st=et[lt][1],i.addWithFunction(Q,st,function(yt){return yt.id===st.id}),i.addWithFunction(it,et[lt][1].endpoints[O],function(yt){return yt.id===st.endpoints[O].id}),i.addWithFunction(it,et[lt][1].endpoints[R],function(yt){return yt.id===st.endpoints[R].id})}for(lt=0;lt<V.length;lt++)st=V[lt][1],s.idx===1&&V[lt][3]===U&&f===-1&&(f=lt),i.addWithFunction(Q,st,function(yt){return yt.id===st.id}),i.addWithFunction(it,V[lt][1].endpoints[O],function(yt){return yt.id===st.endpoints[O].id}),i.addWithFunction(it,V[lt][1].endpoints[R],function(yt){return yt.id===st.endpoints[R].id});{var Et=y?f!==-1?f:0:V.length;V.splice(Et,0,M)}S._continuousAnchorEdge=X};this.sourceOrTargetChanged=function(x,B,W,w,K){if(K===0){if(x!==B){W.sourceId=B,W.source=w,i.removeWithFunction(m[x],function(ot){return ot[0].id===W.id});var U=i.findWithFunction(m[W.targetId],function(ot){return ot[0].id===W.id});U>-1&&(m[W.targetId][U][0]=W,m[W.targetId][U][1]=W.endpoints[0],m[W.targetId][U][2]=W.endpoints[0].anchor.constructor===h.DynamicAnchor),i.addToList(m,B,[W,W.endpoints[1],W.endpoints[1].anchor.constructor===h.DynamicAnchor]),W.endpoints[1].anchor.isContinuous&&(W.source===W.target?W._jsPlumb.instance.removeElement(W.endpoints[1].canvas):W.endpoints[1].canvas.parentNode==null&&W._jsPlumb.instance.appendElement(W.endpoints[1].canvas)),W.updateConnectedClass()}}else if(K===1){var O=W.endpoints[0].elementId;W.target=w,W.targetId=B;var y=i.findWithFunction(m[O],function(ot){return ot[0].id===W.id}),X=i.findWithFunction(m[x],function(ot){return ot[0].id===W.id});y!==-1&&(m[O][y][0]=W,m[O][y][1]=W.endpoints[1],m[O][y][2]=W.endpoints[1].anchor.constructor===h.DynamicAnchor),X>-1&&(m[x].splice(X,1),i.addToList(m,B,[W,W.endpoints[0],W.endpoints[0].anchor.constructor===h.DynamicAnchor])),W.updateConnectedClass()}},this.rehomeEndpoint=function(x,B,W){var w=_[B]||[],K=k.getId(W);if(K!==B){var U=w.indexOf(x);if(U>-1){var O=w.splice(U,1)[0];D.add(O,K)}}for(var y=0;y<x.connections.length;y++)x.connections[y].sourceId===B?D.sourceOrTargetChanged(B,x.elementId,x.connections[y],x.element,0):x.connections[y].targetId===B&&D.sourceOrTargetChanged(B,x.elementId,x.connections[y],x.element,1)},this.redraw=function(x,B,W,w,K,U){var O=[],y=[],X=[];if(!k.isSuspendDrawing()){var ot=_[x]||[],Q=m[x]||[];W=W||jsPlumbUtil.uuid(),w=w||{left:0,top:0},B&&(B={left:B.left+w.left,top:B.top+w.top});for(var it=k.updateOffset({elId:x,offset:B,recalc:!1,timestamp:W}),f={},S=0;S<Q.length;S++){var c=Q[S][0],R=c.sourceId,M=c.targetId,V=c.endpoints[0].anchor.isContinuous,et=c.endpoints[1].anchor.isContinuous;if(V||et){var lt=R+"_"+M,st=f[lt],ct=c.sourceId===x?1:0,Et=k.getRotation(M),yt=k.getRotation(R);V&&!L[R]&&(L[R]={top:[],right:[],bottom:[],left:[]}),et&&!L[M]&&(L[M]={top:[],right:[],bottom:[],left:[]}),x!==M&&k.updateOffset({elId:M,timestamp:W}),x!==R&&k.updateOffset({elId:R,timestamp:W});var vt=k.getCachedData(M),Ct=k.getCachedData(R);M===R&&(V||et)?(p(L[R],-Math.PI/2,0,c,!1,M,0,!1,"top",R,O,y),p(L[M],-Math.PI/2,0,c,!1,R,1,!1,"top",M,O,y)):(st||(st=this.calculateOrientation(R,M,Ct.o,vt.o,c.endpoints[0].anchor,c.endpoints[1].anchor,c,yt,Et),f[lt]=st),V&&p(L[R],st.theta,0,c,!1,M,0,!1,st.a[0],R,O,y),et&&p(L[M],st.theta2,-1,c,!0,R,1,!0,st.a[1],M,O,y)),V&&i.addWithFunction(X,R,function(Mt){return Mt===R}),et&&i.addWithFunction(X,M,function(Mt){return Mt===M}),i.addWithFunction(O,c,function(Mt){return Mt.id===c.id}),(V&&ct===0||et&&ct===1)&&i.addWithFunction(y,c.endpoints[ct],function(Mt){return Mt.id===c.endpoints[ct].id})}}for(S=0;S<ot.length;S++)ot[S].connections.length===0&&ot[S].anchor.isContinuous&&(L[x]||(L[x]={top:[],right:[],bottom:[],left:[]}),p(L[x],-Math.PI/2,0,{endpoints:[ot[S],ot[S]],paint:function(){}},!1,x,0,!1,ot[S].anchor.getDefaultFace(),x,O,y),i.addWithFunction(X,x,function(Mt){return Mt===x}));for(S=0;S<X.length;S++)I(X[S],L[X[S]]);for(S=0;S<ot.length;S++)ot[S].paint({timestamp:W,offset:it,dimensions:it.s,recalc:U!==!0});for(S=0;S<y.length;S++){var Ot=k.getCachedData(y[S].elementId);y[S].paint({timestamp:null,offset:Ot,dimensions:Ot.s})}for(S=0;S<Q.length;S++){var xt=Q[S][1];if(xt.anchor.constructor===h.DynamicAnchor){xt.paint({elementWithPrecedence:x,timestamp:W}),i.addWithFunction(O,Q[S][0],function(Mt){return Mt.id===Q[S][0].id});for(var Pt=0;Pt<xt.connections.length;Pt++)xt.connections[Pt]!==Q[S][0]&&i.addWithFunction(O,xt.connections[Pt],function(Mt){return Mt.id===xt.connections[Pt].id})}else i.addWithFunction(O,Q[S][0],function(Mt){return Mt.id===Q[S][0].id})}var Bt=v[x];for(Bt&&Bt.paint({timestamp:W,recalc:!1,elId:x}),S=0;S<O.length;S++)O[S].paint({elId:x,timestamp:null,recalc:!1,clearEdits:K})}return{c:O,e:y}};var E=function(x){i.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var B=x.faces||["top","right","bottom","left"],W=x.clockwise!==!1,w={},K={top:"bottom",right:"left",left:"right",bottom:"top"},U={top:"right",right:"bottom",left:"top",bottom:"left"},O={top:"left",right:"top",left:"bottom",bottom:"right"},y=W?U:O,X=W?O:U,ot=x.cssClass||"",Q=null,it=null,f=["left","right"],S=["top","bottom"],c=null,R=0;R<B.length;R++)w[B[R]]=!0;this.getDefaultFace=function(){return B.length===0?"top":B[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(M){return w[M]?M:w[K[M]]?K[M]:w[y[M]]?y[M]:w[X[M]]?X[M]:M},this.isEdgeSupported=function(M){return c==null?it==null?w[M]===!0:it===M:c.indexOf(M)!==-1},this.setCurrentFace=function(M,V){Q=M,V&&it!=null&&(it=Q)},this.getCurrentFace=function(){return Q},this.getSupportedFaces=function(){var M=[];for(var V in w)w[V]&&M.push(V);return M},this.lock=function(){it=Q},this.unlock=function(){it=null},this.isLocked=function(){return it!=null},this.lockCurrentAxis=function(){Q!=null&&(c=Q==="left"||Q==="right"?f:S)},this.unlockCurrentAxis=function(){c=null},this.compute=function(M){return u[M.element.id]||[0,0]},this.getCurrentLocation=function(M){return u[M.element.id]||[0,0]},this.getOrientation=function(M){return o[M.id]||[0,0]},this.getCssClass=function(){return ot}};k.continuousAnchorFactory={get:function(x){return new E(x)},clear:function(x){delete u[x]}}},h.AnchorManager.prototype.calculateOrientation=function(s,_,u,o,m,D,L,k,v){var l={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},z=["left","top","right","bottom"];if(s===_)return{orientation:l.IDENTITY,a:["top","top"]};var q=Math.atan2(o.centery-u.centery,o.centerx-u.centerx),tt=Math.atan2(u.centery-o.centery,u.centerx-o.centerx),Y=[],I={};(function(W,w){for(var K=0;K<W.length;K++)if(I[W[K]]={left:[w[K][0].left,w[K][0].centery],right:[w[K][0].right,w[K][0].centery],top:[w[K][0].centerx,w[K][0].top],bottom:[w[K][0].centerx,w[K][0].bottom]},w[K][1]!==0)for(var U in I[W[K]])I[W[K]][U]=jsPlumbUtil.rotatePoint(I[W[K]][U],[w[K][0].centerx,w[K][0].centery],w[K][1])})(["source","target"],[[u,k],[o,v]]);for(var H=0;H<z.length;H++)for(var p=0;p<z.length;p++)Y.push({source:z[H],target:z[p],dist:Biltong.lineLength(I.source[z[H]],I.target[z[p]])});Y.sort(function(W,w){return W.dist<w.dist?-1:W.dist>w.dist?1:0});for(var E=Y[0].source,x=Y[0].target,B=0;B<Y.length&&(m.isContinuous&&m.locked?E=m.getCurrentFace():!m.isContinuous||m.isEdgeSupported(Y[B].source)?E=Y[B].source:E=null,D.isContinuous&&D.locked?x=D.getCurrentFace():!D.isContinuous||D.isEdgeSupported(Y[B].target)?x=Y[B].target:x=null,!(E!=null&&x!=null));B++);return m.isContinuous&&m.setCurrentFace(E),D.isContinuous&&D.setCurrentFace(x),{a:[E,x],theta:q,theta2:tt}},h.Anchor=function(s){this.x=s.x||0,this.y=s.y||0,this.elementId=s.elementId,this.cssClass=s.cssClass||"",this.orientation=s.orientation||[0,0],this.lastReturnValue=null,this.offsets=s.offsets||[0,0],this.timestamp=null,this._unrotatedOrientation=[this.orientation[0],this.orientation[1]],this.relocatable=s.relocatable!==!1,this.snapOnRelocate=s.snapOnRelocate!==!1,this.locked=!1,i.EventGenerator.apply(this),this.compute=function(_){var u=_.xy,o=_.wh,m=_.timestamp;if(m&&m===this.timestamp)return this.lastReturnValue;var D=[u[0]+this.x*o[0]+this.offsets[0],u[1]+this.y*o[1]+this.offsets[1],this.x,this.y],L=_.rotation;if(L!=null&&L!==0){var k=jsPlumbUtil.rotatePoint(D,[u[0]+o[0]/2,u[1]+o[1]/2],L);this.orientation[0]=Math.round(this._unrotatedOrientation[0]*k[2]-this._unrotatedOrientation[1]*k[3]),this.orientation[1]=Math.round(this._unrotatedOrientation[1]*k[2]+this._unrotatedOrientation[0]*k[3]),this.lastReturnValue=[k[0],k[1],this.x,this.y]}else this.orientation[0]=this._unrotatedOrientation[0],this.orientation[1]=this._unrotatedOrientation[1],this.lastReturnValue=D;return this.timestamp=m,this.lastReturnValue},this.getCurrentLocation=function(_){return _=_||{},this.lastReturnValue==null||_.timestamp!=null&&this.timestamp!==_.timestamp?this.compute(_):this.lastReturnValue},this.setPosition=function(_,u,o,m,D){(!this.locked||D)&&(this.x=_,this.y=u,this.orientation=[o,m],this.lastReturnValue=null)}},i.extend(h.Anchor,i.EventGenerator,{equals:function(s){if(!s)return!1;var _=s.getOrientation(),u=this.getOrientation();return this.x===s.x&&this.y===s.y&&this.offsets[0]===s.offsets[0]&&this.offsets[1]===s.offsets[1]&&u[0]===_[0]&&u[1]===_[1]},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),h.FloatingAnchor=function(s){h.Anchor.apply(this,arguments);var _=s.reference,u=s.referenceCanvas,o=h.getSize(u),m=0,D=0,L=null,k=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(v){var l=v.xy,z=[l[0]+o[0]/2,l[1]+o[1]/2];return k=z,z},this.getOrientation=function(v){if(L)return L;var l=_.getOrientation(v);return[Math.abs(l[0])*m*-1,Math.abs(l[1])*D*-1]},this.over=function(v,l){L=v.getOrientation(l)},this.out=function(){L=null},this.getCurrentLocation=function(v){return k??this.compute(v)}},i.extend(h.FloatingAnchor,h.Anchor);var j=function(s,_,u){return s.constructor===h.Anchor?s:_.makeAnchor(s,u,_)};h.DynamicAnchor=function(s){h.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=s.elementId,this.jsPlumbInstance=s.jsPlumbInstance;for(var _=0;_<s.anchors.length;_++)this.anchors[_]=j(s.anchors[_],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};var u=this.anchors.length>0?this.anchors[0]:null,o=u,m=function(L,k,v,l,z,q,tt){var Y=l[0]+L.x*z[0],I=l[1]+L.y*z[1],H=l[0]+z[0]/2,p=l[1]+z[1]/2;if(q!=null&&q!==0){var E=jsPlumbUtil.rotatePoint([Y,I],[H,p],q);Y=E[0],I=E[1]}return Math.sqrt(Math.pow(k-Y,2)+Math.pow(v-I,2))+Math.sqrt(Math.pow(H-Y,2)+Math.pow(p-I,2))},D=s.selector||function(L,k,v,l,z,q,tt){for(var Y=v[0]+l[0]/2,I=v[1]+l[1]/2,H=-1,p=1/0,E=0;E<tt.length;E++){var x=m(tt[E],Y,I,L,k,z);x<p&&(H=E+0,p=x)}return tt[H]};this.compute=function(L){var k=L.xy,v=L.wh,l=L.txy,z=L.twh,q=L.rotation,tt=L.tRotation;return this.timestamp=L.timestamp,this.locked||l==null||z==null?(this.lastReturnValue=u.compute(L),this.lastReturnValue):(L.timestamp=null,u=D(k,v,l,z,q,tt,this.anchors),this.x=u.x,this.y=u.y,u!==o&&this.fire("anchorChanged",u),o=u,this.lastReturnValue=u.compute(L),this.lastReturnValue)},this.getCurrentLocation=function(L){return u!=null?u.getCurrentLocation(L):null},this.getOrientation=function(L){return u!=null?u.getOrientation(L):[0,0]},this.over=function(L,k){u?.over(L,k)},this.out=function(){u?.out()},this.setAnchor=function(L){u=L},this.getCssClass=function(){return u&&u.getCssClass()||""},this.setAnchorCoordinates=function(L){var k=jsPlumbUtil.findWithFunction(this.anchors,function(v){return v.x===L[0]&&v.y===L[1]});return k!==-1?(this.setAnchor(this.anchors[k]),!0):!1}},i.extend(h.DynamicAnchor,h.Anchor);var C=function(s,_,u,o,m,D){h.Anchors[m]=function(L){var k=L.jsPlumbInstance.makeAnchor([s,_,u,o,0,0],L.elementId,L.jsPlumbInstance);return k.type=m,D&&D(k,L),k}};C(.5,0,0,-1,"TopCenter"),C(.5,1,0,1,"BottomCenter"),C(0,.5,-1,0,"LeftMiddle"),C(1,.5,1,0,"RightMiddle"),C(.5,0,0,-1,"Top"),C(.5,1,0,1,"Bottom"),C(0,.5,-1,0,"Left"),C(1,.5,1,0,"Right"),C(.5,.5,0,0,"Center"),C(1,0,0,-1,"TopRight"),C(1,1,0,1,"BottomRight"),C(0,0,0,-1,"TopLeft"),C(0,1,0,1,"BottomLeft"),h.Defaults.DynamicAnchors=function(s){return s.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],s.elementId,s.jsPlumbInstance)},h.Anchors.AutoDefault=function(s){var _=s.jsPlumbInstance.makeDynamicAnchor(h.Defaults.DynamicAnchors(s));return _.type="AutoDefault",_};var A=function(s,_){h.Anchors[s]=function(u){var o=u.jsPlumbInstance.makeAnchor(["Continuous",{faces:_}],u.elementId,u.jsPlumbInstance);return o.type=s,o}};h.Anchors.Continuous=function(s){return s.jsPlumbInstance.continuousAnchorFactory.get(s)},A("ContinuousLeft",["left"]),A("ContinuousTop",["top"]),A("ContinuousBottom",["bottom"]),A("ContinuousRight",["right"]),C(0,0,0,0,"Assign",function(s,_){var u=_.position||"Fixed";s.positionFinder=u.constructor===String?_.jsPlumbInstance.AnchorPositionFinders[u]:u,s.constructorParams=_}),a.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(s,_,u){return[(s.left-_.left)/u[0],(s.top-_.top)/u[1]]},Grid:function(s,_,u,o){var m=s.left-_.left,D=s.top-_.top,L=u[0]/o.grid[0],k=u[1]/o.grid[1],v=Math.floor(m/L),l=Math.floor(D/k);return[(v*L+L/2)/u[0],(l*k+k/2)/u[1]]}},h.Anchors.Perimeter=function(s){s=s||{};var _=s.anchorCount||60,u=s.shape;if(!u)throw new Error("no shape supplied to Perimeter Anchor type");var o=function(){for(var q=.5,tt=Math.PI*2/_,Y=0,I=[],H=0;H<_;H++){var p=q+q*Math.sin(Y),E=q+q*Math.cos(Y);I.push([p,E,0,0]),Y+=tt}return I},m=function(q){for(var tt=_/q.length,Y=[],I=function(p,E,x,B,W,w,K){tt=_*W;for(var U=(x-p)/tt,O=(B-E)/tt,y=0;y<tt;y++)Y.push([p+U*y,E+O*y,w??0,K??0])},H=0;H<q.length;H++)I.apply(null,q[H]);return Y},D=function(q){for(var tt=[],Y=0;Y<q.length;Y++)tt.push([q[Y][0],q[Y][1],q[Y][2],q[Y][3],1/q.length,q[Y][4],q[Y][5]]);return m(tt)},L=function(){return D([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])},k={Circle:o,Ellipse:o,Diamond:function(){return D([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:L,Square:L,Triangle:function(){return D([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(q){for(var tt=q.points,Y=[],I=0,H=0;H<tt.length-1;H++){var p=Math.sqrt(Math.pow(tt[H][2]-tt[H][0])+Math.pow(tt[H][3]-tt[H][1]));I+=p,Y.push([tt[H][0],tt[H][1],tt[H+1][0],tt[H+1][1],p])}for(var E=0;E<Y.length;E++)Y[E][4]=Y[E][4]/I;return m(Y)}},v=function(q,tt){for(var Y=[],I=tt/180*Math.PI,H=0;H<q.length;H++){var p=q[H][0]-.5,E=q[H][1]-.5;Y.push([.5+(p*Math.cos(I)-E*Math.sin(I)),.5+(p*Math.sin(I)+E*Math.cos(I)),q[H][2],q[H][3]])}return Y};if(!k[u])throw new Error("Shape ["+u+"] is unknown by Perimeter Anchor type");var l=k[u](s);s.rotation&&(l=v(l,s.rotation));var z=s.jsPlumbInstance.makeDynamicAnchor(l);return z.type="Perimeter",z}}.call(typeof window<"u"?window:ie),function(){var a=this;a.jsPlumbUtil;var i=a.jsPlumb;i.DefaultRouter=function(h){this.jsPlumbInstance=h,this.anchorManager=new i.AnchorManager({jsPlumbInstance:h}),this.sourceOrTargetChanged=function(j,C,A,s,_){this.anchorManager.sourceOrTargetChanged(j,C,A,s,_)},this.reset=function(){this.anchorManager.reset()},this.changeId=function(j,C){this.anchorManager.changeId(j,C)},this.elementRemoved=function(j){this.anchorManager.elementRemoved(j)},this.newConnection=function(j){this.anchorManager.newConnection(j)},this.connectionDetached=function(j,C){this.anchorManager.connectionDetached(j,C)},this.redraw=function(j,C,A,s,_,u){return this.anchorManager.redraw(j,C,A,s,_,u)},this.deleteEndpoint=function(j){this.anchorManager.deleteEndpoint(j)},this.rehomeEndpoint=function(j,C,A){this.anchorManager.rehomeEndpoint(j,C,A)},this.addEndpoint=function(j,C){this.anchorManager.addEndpoint(j,C)}}}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j=a.Biltong;i.Segments={AbstractSegment:function(o){this.params=o,this.findClosestPointOnPath=function(m,D){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(o.x1,o.x2),minY:Math.min(o.y1,o.y2),maxX:Math.max(o.x1,o.x2),maxY:Math.max(o.y1,o.y2)}},this.lineIntersection=function(m,D,L,k){return[]},this.boxIntersection=function(m,D,L,k){var v=[];return v.push.apply(v,this.lineIntersection(m,D,m+L,D)),v.push.apply(v,this.lineIntersection(m+L,D,m+L,D+k)),v.push.apply(v,this.lineIntersection(m+L,D+k,m,D+k)),v.push.apply(v,this.lineIntersection(m,D+k,m,D)),v},this.boundingBoxIntersection=function(m){return this.boxIntersection(m.x,m.y,m.w,m.y)}},Straight:function(o){i.Segments.AbstractSegment.apply(this,arguments);var m,D,L,k,v,l,z,q=function(){m=Math.sqrt(Math.pow(v-k,2)+Math.pow(z-l,2)),D=j.gradient({x:k,y:l},{x:v,y:z}),L=-1/D};this.type="Straight",this.getLength=function(){return m},this.getGradient=function(){return D},this.getCoordinates=function(){return{x1:k,y1:l,x2:v,y2:z}},this.setCoordinates=function(p){k=p.x1,l=p.y1,v=p.x2,z=p.y2,q()},this.setCoordinates({x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2}),this.getBounds=function(){return{minX:Math.min(k,v),minY:Math.min(l,z),maxX:Math.max(k,v),maxY:Math.max(l,z)}},this.pointOnPath=function(p,E){if(p===0&&!E)return{x:k,y:l};if(p===1&&!E)return{x:v,y:z};var x=E?p>0?p:m+p:p*m;return j.pointOnLine({x:k,y:l},{x:v,y:z},x)},this.gradientAtPoint=function(p){return D},this.pointAlongPathFrom=function(p,E,x){var B=this.pointOnPath(p,x),W=E<=0?{x:k,y:l}:{x:v,y:z};return E<=0&&Math.abs(E)>1&&(E*=-1),j.pointOnLine(B,W,E)};var tt=function(p,E,x){return x>=Math.min(p,E)&&x<=Math.max(p,E)},Y=function(p,E,x){return Math.abs(x-p)<Math.abs(x-E)?p:E};this.findClosestPointOnPath=function(p,E){var x={d:1/0,x:null,y:null,l:null,x1:k,x2:v,y1:l,y2:z};if(D===0)x.y=l,x.x=tt(k,v,p)?p:Y(k,v,p);else if(D===1/0||D===-1/0)x.x=k,x.y=tt(l,z,E)?E:Y(l,z,E);else{var B=l-D*k,W=E-L*p,w=(W-B)/(D-L),K=D*w+B;x.x=tt(k,v,w)?w:Y(k,v,w),x.y=tt(l,z,K)?K:Y(l,z,K)}var U=j.lineLength([x.x,x.y],[k,l]);return x.d=j.lineLength([p,E],[x.x,x.y]),x.l=U/m,x};var I=function(p,E,x){return x>E?E<=p&&p<=x:E>=p&&p>=x},H=I;this.lineIntersection=function(p,E,x,B){var W=Math.abs(j.gradient({x:p,y:E},{x,y:B})),w=Math.abs(D),K=w===1/0?k:l-w*k,U=[],O=W===1/0?p:E-W*p;if(W!==w)if(W===1/0&&w===0)H(p,k,v)&&H(l,E,B)&&(U=[p,l]);else if(W===0&&w===1/0)H(E,l,z)&&H(k,p,x)&&(U=[k,E]);else{var y,X;W===1/0?(y=p,H(y,k,v)&&(X=w*p+K,H(X,E,B)&&(U=[y,X]))):W===0?(X=E,H(X,l,z)&&(y=(E-K)/w,H(y,p,x)&&(U=[y,X]))):(y=(O-K)/(w-W),X=w*y+K,H(y,k,v)&&H(X,l,z)&&(U=[y,X]))}return U},this.boxIntersection=function(p,E,x,B){var W=[];return W.push.apply(W,this.lineIntersection(p,E,p+x,E)),W.push.apply(W,this.lineIntersection(p+x,E,p+x,E+B)),W.push.apply(W,this.lineIntersection(p+x,E+B,p,E+B)),W.push.apply(W,this.lineIntersection(p,E+B,p,E)),W},this.boundingBoxIntersection=function(p){return this.boxIntersection(p.x,p.y,p.w,p.h)}},Arc:function(o){i.Segments.AbstractSegment.apply(this,arguments);var m=function(Y,I){return j.theta([o.cx,o.cy],[Y,I])},D=function(Y,I){if(Y.anticlockwise){var H=Y.startAngle<Y.endAngle?Y.startAngle+L:Y.startAngle,p=Math.abs(H-Y.endAngle);return H-p*I}else{var E=Y.endAngle<Y.startAngle?Y.endAngle+L:Y.endAngle,x=Math.abs(E-Y.startAngle);return Y.startAngle+x*I}},L=2*Math.PI;this.radius=o.r,this.anticlockwise=o.ac,this.type="Arc",o.startAngle&&o.endAngle?(this.startAngle=o.startAngle,this.endAngle=o.endAngle,this.x1=o.cx+this.radius*Math.cos(o.startAngle),this.y1=o.cy+this.radius*Math.sin(o.startAngle),this.x2=o.cx+this.radius*Math.cos(o.endAngle),this.y2=o.cy+this.radius*Math.sin(o.endAngle)):(this.startAngle=m(o.x1,o.y1),this.endAngle=m(o.x2,o.y2),this.x1=o.x1,this.y1=o.y1,this.x2=o.x2,this.y2=o.y2),this.endAngle<0&&(this.endAngle+=L),this.startAngle<0&&(this.startAngle+=L);var k=this.endAngle<this.startAngle?this.endAngle+L:this.endAngle;this.sweep=Math.abs(k-this.startAngle),this.anticlockwise&&(this.sweep=L-this.sweep);var v=2*Math.PI*this.radius,l=this.sweep/L,z=v*l;this.getLength=function(){return z},this.getBounds=function(){return{minX:o.cx-o.r,maxX:o.cx+o.r,minY:o.cy-o.r,maxY:o.cy+o.r}};var q=1e-10,tt=function(Y){var I=Math.floor(Y),H=Math.ceil(Y);return Y-I<q?I:H-Y<q?H:Y};this.pointOnPath=function(Y,I){if(Y===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(Y===1)return{x:this.x2,y:this.y2,theta:this.endAngle};I&&(Y=Y/z);var H=D(this,Y),p=o.cx+o.r*Math.cos(H),E=o.cy+o.r*Math.sin(H);return{x:tt(p),y:tt(E),theta:H}},this.gradientAtPoint=function(Y,I){var H=this.pointOnPath(Y,I),p=j.normal([o.cx,o.cy],[H.x,H.y]);return!this.anticlockwise&&(p===1/0||p===-1/0)&&(p*=-1),p},this.pointAlongPathFrom=function(Y,I,H){var p=this.pointOnPath(Y,H),E=I/v*2*Math.PI,x=this.anticlockwise?-1:1,B=p.theta+x*E,W=o.cx+this.radius*Math.cos(B),w=o.cy+this.radius*Math.sin(B);return{x:W,y:w}}},Bezier:function(o){this.curve=[{x:o.x1,y:o.y1},{x:o.cp1x,y:o.cp1y},{x:o.cp2x,y:o.cp2y},{x:o.x2,y:o.y2}];var m=function(z){return z[0].x===z[1].x&&z[0].y===z[1].y},D=function(z,q){return Math.sqrt(Math.pow(z.x-q.x,2)+Math.pow(z.y-q.y,2))},L=function(z){var q={x:0,y:0};if(z===0)return this.curve[0];var tt=this.curve.length-1;if(z===1)return this.curve[tt];var Y=this.curve,I=1-z;if(tt===0)return this.curve[0];if(tt===1)return{x:I*Y[0].x+z*Y[1].x,y:I*Y[0].y+z*Y[1].y};if(tt<4){var H=I*I,p=z*z,E=0,x,B,W;return tt===2?(Y=[Y[0],Y[1],Y[2],q],x=H,B=2*(I*z),W=p):tt===3&&(x=H*I,B=3*(H*z),W=3*(I*p),E=z*p),{x:x*Y[0].x+B*Y[1].x+W*Y[2].x+E*Y[3].x,y:x*Y[0].y+B*Y[1].y+W*Y[2].y+E*Y[3].y}}else return q}.bind(this),k=function(z){var q=[];z--;for(var tt=0;tt<=z;tt++)q.push(L(tt/z));return q},v=function(){m(this.curve)&&(this.length=0);var z=16,q=k(z);this.length=0;for(var tt=0;tt<z-1;tt++){var Y=q[tt],I=q[tt+1];this.length+=D(Y,I)}}.bind(this);i.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(o.x1,o.x2,o.cp1x,o.cp2x),minY:Math.min(o.y1,o.y2,o.cp1y,o.cp2y),maxX:Math.max(o.x1,o.x2,o.cp1x,o.cp2x),maxY:Math.max(o.y1,o.y2,o.cp1y,o.cp2y)},this.type="Bezier",v();var l=function(z,q,tt){return tt&&(q=a.jsBezier.locationAlongCurveFrom(z,q>0?0:1,q)),q};this.pointOnPath=function(z,q){return z=l(this.curve,z,q),a.jsBezier.pointOnCurve(this.curve,z)},this.gradientAtPoint=function(z,q){return z=l(this.curve,z,q),a.jsBezier.gradientAtPoint(this.curve,z)},this.pointAlongPathFrom=function(z,q,tt){return z=l(this.curve,z,tt),a.jsBezier.pointAlongCurveFrom(this.curve,z,q)},this.getLength=function(){return this.length},this.getBounds=function(){return this.bounds},this.findClosestPointOnPath=function(z,q){var tt=a.jsBezier.nearestPointOnCurve({x:z,y:q},this.curve);return{d:Math.sqrt(Math.pow(tt.point.x-z,2)+Math.pow(tt.point.y-q,2)),x:tt.point.x,y:tt.point.y,l:1-tt.location,s:this}},this.lineIntersection=function(z,q,tt,Y){return a.jsBezier.lineIntersection(z,q,tt,Y,this.curve)}}},i.SegmentRenderer={getPath:function(o,m){return{Straight:function(D){var L=o.getCoordinates();return(D?"M "+L.x1+" "+L.y1+" ":"")+"L "+L.x2+" "+L.y2},Bezier:function(D){var L=o.params;return(D?"M "+L.x2+" "+L.y2+" ":"")+"C "+L.cp2x+" "+L.cp2y+" "+L.cp1x+" "+L.cp1y+" "+L.x1+" "+L.y1},Arc:function(D){var L=o.params,k=o.sweep>Math.PI?1:0,v=o.anticlockwise?0:1;return(D?"M"+o.x1+" "+o.y1+" ":"")+"A "+o.radius+" "+L.r+" 0 "+k+","+v+" "+o.x2+" "+o.y2}}[o.type](m)}};var C=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};i.Connectors.AbstractConnector=function(o){C.apply(this,arguments);var m=[],D=0,L=[],k=[],v=o.stub||0,l=h.isArray(v)?v[0]:v,z=h.isArray(v)?v[1]:v,q=o.gap||0,tt=h.isArray(q)?q[0]:q,Y=h.isArray(q)?q[1]:q,I=null,H=null;this.getPathData=function(){for(var w="",K=0;K<m.length;K++)w+=i.SegmentRenderer.getPath(m[K],K===0),w+=" ";return w},this.findSegmentForPoint=function(w,K){for(var U={d:1/0,s:null,x:null,y:null,l:null},O=0;O<m.length;O++){var y=m[O].findClosestPointOnPath(w,K);y.d<U.d&&(U.d=y.d,U.l=y.l,U.x=y.x,U.y=y.y,U.s=m[O],U.x1=y.x1,U.x2=y.x2,U.y1=y.y1,U.y2=y.y2,U.index=O,U.connectorLocation=L[O][0]+y.l*(L[O][1]-L[O][0]))}return U},this.lineIntersection=function(w,K,U,O){for(var y=[],X=0;X<m.length;X++)y.push.apply(y,m[X].lineIntersection(w,K,U,O));return y},this.boxIntersection=function(w,K,U,O){for(var y=[],X=0;X<m.length;X++)y.push.apply(y,m[X].boxIntersection(w,K,U,O));return y},this.boundingBoxIntersection=function(w){for(var K=[],U=0;U<m.length;U++)K.push.apply(K,m[U].boundingBoxIntersection(w));return K};var p=function(){for(var w=0,K=0;K<m.length;K++){var U=m[K].getLength();k[K]=U/D,L[K]=[w,w+=U/D]}},E=function(w,K){var U,O,y;if(K&&(w=w>0?w/D:(D+w)/D),w===1)U=m.length-1,y=1;else if(w===0)y=0,U=0;else if(w>=.5){for(U=0,y=0,O=L.length-1;O>-1;O--)if(L[O][1]>=w&&L[O][0]<=w){U=O,y=(w-L[O][0])/k[O];break}}else for(U=L.length-1,y=1,O=0;O<L.length;O++)if(L[O][1]>=w){U=O,y=(w-L[O][0])/k[O];break}return{segment:m[U],proportion:y,index:U}},x=function(w,K,U){if(!(U.x1===U.x2&&U.y1===U.y2)){var O=new i.Segments[K](U);m.push(O),D+=O.getLength(),w.updateBounds(O)}},B=function(){D=m.length=L.length=k.length=0};this.setSegments=function(w){I=[],D=0;for(var K=0;K<w.length;K++)I.push(w[K]),D+=w[K].getLength()},this.getLength=function(){return D};var W=function(w){this.strokeWidth=w.strokeWidth;var K=j.quadrant(w.sourcePos,w.targetPos),U=w.targetPos[0]<w.sourcePos[0],O=w.targetPos[1]<w.sourcePos[1],y=w.strokeWidth||1,X=w.sourceEndpoint.anchor.getOrientation(w.sourceEndpoint),ot=w.targetEndpoint.anchor.getOrientation(w.targetEndpoint),Q=U?w.targetPos[0]:w.sourcePos[0],it=O?w.targetPos[1]:w.sourcePos[1],f=Math.abs(w.targetPos[0]-w.sourcePos[0]),S=Math.abs(w.targetPos[1]-w.sourcePos[1]);if(X[0]===0&&X[1]===0||ot[0]===0&&ot[1]===0){var c=f>S?0:1,R=[1,0][c];X=[],ot=[],X[c]=w.sourcePos[c]>w.targetPos[c]?-1:1,ot[c]=w.sourcePos[c]>w.targetPos[c]?1:-1,X[R]=0,ot[R]=0}var M=U?f+tt*X[0]:tt*X[0],V=O?S+tt*X[1]:tt*X[1],et=U?Y*ot[0]:f+Y*ot[0],lt=O?Y*ot[1]:S+Y*ot[1],st=X[0]*ot[0]+X[1]*ot[1],ct={sx:M,sy:V,tx:et,ty:lt,lw:y,xSpan:Math.abs(et-M),ySpan:Math.abs(lt-V),mx:(M+et)/2,my:(V+lt)/2,so:X,to:ot,x:Q,y:it,w:f,h:S,segment:K,startStubX:M+X[0]*l,startStubY:V+X[1]*l,endStubX:et+ot[0]*z,endStubY:lt+ot[1]*z,isXGreaterThanStubTimes2:Math.abs(M-et)>l+z,isYGreaterThanStubTimes2:Math.abs(V-lt)>l+z,opposite:st===-1,perpendicular:st===0,orthogonal:st===1,sourceAxis:X[0]===0?"y":"x",points:[Q,it,f,S,M,V,et,lt],stubs:[l,z]};return ct.anchorOrientation=ct.opposite?"opposite":ct.orthogonal?"orthogonal":"perpendicular",ct};return this.getSegments=function(){return m},this.updateBounds=function(w){var K=w.getBounds();this.bounds.minX=Math.min(this.bounds.minX,K.minX),this.bounds.maxX=Math.max(this.bounds.maxX,K.maxX),this.bounds.minY=Math.min(this.bounds.minY,K.minY),this.bounds.maxY=Math.max(this.bounds.maxY,K.maxY)},this.pointOnPath=function(w,K){var U=E(w,K);return U.segment&&U.segment.pointOnPath(U.proportion,!1)||[0,0]},this.gradientAtPoint=function(w,K){var U=E(w,K);return U.segment&&U.segment.gradientAtPoint(U.proportion,!1)||0},this.pointAlongPathFrom=function(w,K,U){var O=E(w,U);return O.segment&&O.segment.pointAlongPathFrom(O.proportion,K,!1)||[0,0]},this.compute=function(w){H=W.call(this,w),B(),this._compute(H,w),this.x=H.points[0],this.y=H.points[1],this.w=H.points[2],this.h=H.points[3],this.segment=H.segment,p()},{addSegment:x,prepareCompute:W,sourceStub:l,targetStub:z,maxStub:Math.max(l,z),sourceGap:tt,targetGap:Y,maxGap:Math.max(tt,Y)}},h.extend(i.Connectors.AbstractConnector,C),i.Endpoints.AbstractEndpoint=function(o){C.apply(this,arguments);var m=this.compute=function(D,L,k,v){var l=this._compute.apply(this,arguments);return this.x=l[0],this.y=l[1],this.w=l[2],this.h=l[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,l};return{compute:m,cssClass:o.cssClass}},h.extend(i.Endpoints.AbstractEndpoint,C),i.Endpoints.Dot=function(o){this.type="Dot",i.Endpoints.AbstractEndpoint.apply(this,arguments),o=o||{},this.radius=o.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(m,D,L,k){this.radius=L.radius||this.radius;var v=m[0]-this.radius,l=m[1]-this.radius,z=this.radius*2,q=this.radius*2;if(L.stroke){var tt=L.strokeWidth||1;v-=tt,l-=tt,z+=tt*2,q+=tt*2}return[v,l,z,q,this.radius]}},h.extend(i.Endpoints.Dot,i.Endpoints.AbstractEndpoint),i.Endpoints.Rectangle=function(o){this.type="Rectangle",i.Endpoints.AbstractEndpoint.apply(this,arguments),o=o||{},this.width=o.width||20,this.height=o.height||20,this._compute=function(m,D,L,k){var v=L.width||this.width,l=L.height||this.height,z=m[0]-v/2,q=m[1]-l/2;return[z,q,v,l]}},h.extend(i.Endpoints.Rectangle,i.Endpoints.AbstractEndpoint);var A=function(o){i.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};h.extend(A,i.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(o){this._jsPlumb.displayElements.push(o)}}),i.Endpoints.Image=function(o){this.type="Image",A.apply(this,arguments),i.Endpoints.AbstractEndpoint.apply(this,arguments);var m=o.onload,D=o.src||o.url,L=o.cssClass?" "+o.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=o.width,this._jsPlumb.heightToUse=o.height,this._jsPlumb.endpoint=o.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,m&&m(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(k,v){var l=k.constructor===String?k:k.src;m=v,this._jsPlumb.img.src=l,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(D,m),this._compute=function(k,v,l,z){return this.anchorPoint=k,this._jsPlumb.ready?[k[0]-this._jsPlumb.widthToUse/2,k[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=i.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+L),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(k,v,l){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var z=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,q=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;h.sizeElement(this.canvas,z,q,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(k,v){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(k,v):a.setTimeout(function(){this.paint(k,v)}.bind(this),200))}},h.extend(i.Endpoints.Image,[A,i.Endpoints.AbstractEndpoint],{cleanup:function(o){o&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),i.Endpoints.Blank=function(o){i.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",A.apply(this,arguments),this._compute=function(D,L,k,v){return[D[0],D[1],10,0]};var m=o.cssClass?" "+o.cssClass:"";this.canvas=i.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+m),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(D,L){h.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},h.extend(i.Endpoints.Blank,[i.Endpoints.AbstractEndpoint,A],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),i.Endpoints.Triangle=function(o){this.type="Triangle",i.Endpoints.AbstractEndpoint.apply(this,arguments);var m=this;o=o||{},o.width=o.width||55,o.height=o.height||55,this.width=o.width,this.height=o.height,this._compute=function(D,L,k,v){var l=k.width||m.width,z=k.height||m.height,q=D[0]-l/2,tt=D[1]-z/2;return[q,tt,l,z]}};var s=i.Overlays.AbstractOverlay=function(o){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=o.component,this.loc=o.location==null?.5:o.location,this.endpointLoc=o.endpointLocation==null?[.5,.5]:o.endpointLocation,this.visible=o.visible!==!1};s.prototype={cleanup:function(o){o&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(o,m){},setVisible:function(o){this.visible=o,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(o){this.loc+=o,this.component.repaint()},setLocation:function(o){this.loc=o,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},i.Overlays.Arrow=function(o){this.type="Arrow",s.apply(this,arguments),this.isAppendedAtTopLevel=!1,o=o||{};var m=this;this.length=o.length||20,this.width=o.width||20,this.id=o.id,this.direction=(o.direction||1)<0?-1:1;var D=o.paintStyle||{"stroke-width":1},L=o.foldback||.623;this.computeMaxSize=function(){return m.width*1.5},this.elementCreated=function(k,v){if(this.path=k,o.events)for(var l in o.events)i.on(k,l,o.events[l])},this.draw=function(k,v){var l,z,q,tt,Y;if(k.pointAlongPathFrom){if(h.isString(this.loc)||this.loc>1||this.loc<0){var I=parseInt(this.loc,10),H=this.loc<0?1:0;l=k.pointAlongPathFrom(H,I,!1),z=k.pointAlongPathFrom(H,I-this.direction*this.length/2,!1),q=j.pointOnLine(l,z,this.length)}else if(this.loc===1){if(l=k.pointOnPath(this.loc),z=k.pointAlongPathFrom(this.loc,-this.length),q=j.pointOnLine(l,z,this.length),this.direction===-1){var p=q;q=l,l=p}}else if(this.loc===0){if(q=k.pointOnPath(this.loc),z=k.pointAlongPathFrom(this.loc,this.length),l=j.pointOnLine(q,z,this.length),this.direction===-1){var E=q;q=l,l=E}}else l=k.pointAlongPathFrom(this.loc,this.direction*this.length/2),z=k.pointOnPath(this.loc),q=j.pointOnLine(l,z,this.length);tt=j.perpendicularLineTo(l,q,this.width),Y=j.pointOnLine(l,q,L*this.length);var x={hxy:l,tail:tt,cxy:Y},B=D.stroke||v.stroke,W=D.fill||v.stroke,w=D.strokeWidth||v.strokeWidth;return{component:k,d:x,"stroke-width":w,stroke:B,fill:W,minX:Math.min(l.x,tt[0].x,tt[1].x),maxX:Math.max(l.x,tt[0].x,tt[1].x),minY:Math.min(l.y,tt[0].y,tt[1].y),maxY:Math.max(l.y,tt[0].y,tt[1].y)}}else return{component:k,minX:0,maxX:0,minY:0,maxY:0}}},h.extend(i.Overlays.Arrow,s,{updateFrom:function(o){this.length=o.length||this.length,this.width=o.width||this.width,this.direction=o.direction!=null?o.direction:this.direction,this.foldback=o.foldback||this.foldback},cleanup:function(){this.path&&this.path.parentNode&&this.path.parentNode.removeChild(this.path)}}),i.Overlays.PlainArrow=function(o){o=o||{};var m=i.extend(o,{foldback:1});i.Overlays.Arrow.call(this,m),this.type="PlainArrow"},h.extend(i.Overlays.PlainArrow,i.Overlays.Arrow),i.Overlays.Diamond=function(o){o=o||{};var m=o.length||40,D=i.extend(o,{length:m/2,foldback:2});i.Overlays.Arrow.call(this,D),this.type="Diamond"},h.extend(i.Overlays.Diamond,i.Overlays.Arrow);var _=function(o,m){return(o._jsPlumb.cachedDimensions==null||m)&&(o._jsPlumb.cachedDimensions=o.getDimensions()),o._jsPlumb.cachedDimensions},u=function(o){i.jsPlumbUIComponent.apply(this,arguments),s.apply(this,arguments);var m=this.fire;this.fire=function(){m.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=o.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=o.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=o.create,this._jsPlumb.initiallyInvisible=o.visible===!1,this.getElement=function(){if(this._jsPlumb.div==null){var D=this._jsPlumb.div=i.getElement(this._jsPlumb.create(this._jsPlumb.component));D.style.position="absolute",jsPlumb.addClass(D,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:o.cssClass?o.cssClass:"")),this._jsPlumb.instance.appendElement(D),this._jsPlumb.instance.getId(D),this.canvas=D;var L="translate(-50%, -50%)";D.style.webkitTransform=L,D.style.mozTransform=L,D.style.msTransform=L,D.style.oTransform=L,D.style.transform=L,D._jsPlumb=this,o.visible===!1&&(D.style.display="none")}return this._jsPlumb.div},this.draw=function(D,L,k){var v=_(this);if(v!=null&&v.length===2){var l={x:0,y:0};if(k)l={x:k[0],y:k[1]};else if(D.pointOnPath){var z=this.loc,q=!1;(h.isString(this.loc)||this.loc<0||this.loc>1)&&(z=parseInt(this.loc,10),q=!0),l=D.pointOnPath(z,q)}else{var tt=this.loc.constructor===Array?this.loc:this.endpointLoc;l={x:tt[0]*D.w,y:tt[1]*D.h}}var Y=l.x-v[0]/2,I=l.y-v[1]/2;return{component:D,d:{minx:Y,miny:I,td:v,cxy:l},minX:Y,maxX:Y+v[0],minY:I,maxY:I+v[1]}}else return{minX:0,maxX:0,minY:0,maxY:0}}};h.extend(u,[i.jsPlumbUIComponent,s],{getDimensions:function(){return[1,1]},setVisible:function(o){this._jsPlumb.div&&(this._jsPlumb.div.style.display=o?"block":"none",o&&this._jsPlumb.initiallyInvisible&&(_(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(o){o?this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(o,m){this._jsPlumb.div!=null&&o.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var o=_(this);return Math.max(o[0],o[1])},paint:function(o,m){this._jsPlumb.initialised||(this.getElement(),o.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=o.component.x+o.d.minx+"px",this._jsPlumb.div.style.top=o.component.y+o.d.miny+"px"}}),i.Overlays.Custom=function(o){this.type="Custom",u.apply(this,arguments)},h.extend(i.Overlays.Custom,u),i.Overlays.GuideLines=function(){var o=this;o.length=50,o.strokeWidth=5,this.type="GuideLines",s.apply(this,arguments),i.jsPlumbUIComponent.apply(this,arguments),this.draw=function(m,D){var L=m.pointAlongPathFrom(o.loc,o.length/2),k=m.pointOnPath(o.loc),v=j.pointOnLine(L,k,o.length),l=j.perpendicularLineTo(L,v,40),z=j.perpendicularLineTo(v,L,20);return{connector:m,head:L,tail:v,headLine:z,tailLine:l,minX:Math.min(L.x,v.x,z[0].x,z[1].x),minY:Math.min(L.y,v.y,z[0].y,z[1].y),maxX:Math.max(L.x,v.x,z[0].x,z[1].x),maxY:Math.max(L.y,v.y,z[0].y,z[1].y)}}},i.Overlays.Label=function(o){this.labelStyle=o.labelStyle,this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var m=i.extend({create:function(){return i.createElement("div")}},o);if(i.Overlays.Custom.call(this,m),this.type="Label",this.label=o.label||"",this.labelText=null,this.labelStyle){var D=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",D.style.font=this.labelStyle.font,D.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(D.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var L=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";D.style.border=this.labelStyle.borderWidth+"px solid "+L}this.labelStyle.padding&&(D.style.padding=this.labelStyle.padding)}},h.extend(i.Overlays.Label,i.Overlays.Custom,{cleanup:function(o){o&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(o){this.label=o,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),u.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var o=this.label(this);this.getElement().innerHTML=o.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(o){o.label!=null&&this.setLabel(o.label)}})}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumbUtil,h=a.jsPlumbInstance,j="jtk-group-collapsed",C="jtk-group-expanded",A="[jtk-group-content]",s="elementDraggable",_="stop",u="revert",o="_groupManager",m="_jsPlumbGroup",D="_jsPlumbGroupDrag",L="group:addMember",k="group:removeMember",v="group:add",l="group:remove",z="group:expand",q="group:collapse",tt="groupDragStop",Y="connectionMoved",I="internal.connectionDetached",H="removeAll",p="orphanAll",E="show",x="hide",B=function(w){var K={},U={},O={},y=this;function X(c,R){for(var M=w.getContainer(),V=!1;!V;){if(c==null||c===M)return!1;if(c===R)return!0;c=c.parentNode}}w.bind("connection",function(c){var R=w.getGroupFor(c.source),M=w.getGroupFor(c.target);R!=null&&M!=null&&R===M?(U[c.connection.id]=R,O[c.connection.id]=R):(R!=null&&(i.suggest(R.connections.source,c.connection),U[c.connection.id]=R),M!=null&&(i.suggest(M.connections.target,c.connection),O[c.connection.id]=M))});function ot(c){delete c.proxies;var R=U[c.id],M;R!=null&&(M=function(V){return V.id===c.id},i.removeWithFunction(R.connections.source,M),i.removeWithFunction(R.connections.target,M),delete U[c.id]),R=O[c.id],R!=null&&(M=function(V){return V.id===c.id},i.removeWithFunction(R.connections.source,M),i.removeWithFunction(R.connections.target,M),delete O[c.id])}w.bind(I,function(c){ot(c.connection)}),w.bind(Y,function(c){var R=c.index===0?U:O,M=R[c.connection.id];if(M){var V=M.connections[c.index===0?"source":"target"],et=V.indexOf(c.connection);et!==-1&&V.splice(et,1)}}),this.addGroup=function(c){w.addClass(c.getEl(),C),K[c.id]=c,c.manager=this,S(c),w.fire(v,{group:c})},this.addToGroup=function(c,R,M){if(c=this.getGroup(c),c){var V=c.getEl();if(R._isJsPlumbGroup)return;var et=R._jsPlumbGroup;if(et!==c){w.removeFromDragSelection(R);var lt=w.getOffset(R,!0),st=c.collapsed?w.getOffset(V,!0):w.getOffset(c.getDragArea(),!0);et!=null&&(et.remove(R,!1,M,!1,c),y.updateConnectionsForGroup(et)),c.add(R,M);var ct=function(Ct,Ot){var xt=Ot===0?1:0;Ct.each(function(Pt){Pt.setVisible(!1),Pt.endpoints[xt].element._jsPlumbGroup===c?(Pt.endpoints[xt].setVisible(!1),f(Pt,xt,c)):(Pt.endpoints[Ot].setVisible(!1),it(Pt,Ot,c))})};c.collapsed&&(ct(w.select({source:R}),0),ct(w.select({target:R}),1));var Et=w.getId(R);w.dragManager.setParent(R,Et,V,w.getId(V),lt);var yt={left:lt.left-st.left,top:lt.top-st.top};if(w.setPosition(R,yt),w.dragManager.revalidateParent(R,Et,lt),y.updateConnectionsForGroup(c),w.revalidate(Et),!M){var vt={group:c,el:R,pos:yt};et&&(vt.sourceGroup=et),w.fire(L,vt)}}}},this.removeFromGroup=function(c,R,M){if(c=this.getGroup(c),c){if(c.collapsed){var V=function(et,lt){for(var st=0;st<et.length;st++){var ct=et[st];if(ct.proxies){for(var Et=0;Et<ct.proxies.length;Et++)if(ct.proxies[Et]!=null){var yt=ct.proxies[Et].originalEp.element;(yt===R||X(yt,R))&&f(ct,lt,c)}}}};V(c.connections.source.slice(),0),V(c.connections.target.slice(),1)}c.remove(R,null,M)}},this.getGroup=function(c){var R=c;if(i.isString(c)&&(R=K[c],R==null))throw new TypeError("No such group ["+c+"]");return R},this.getGroups=function(){var c=[];for(var R in K)c.push(K[R]);return c},this.removeGroup=function(c,R,M,V){c=this.getGroup(c),this.expandGroup(c,!0);var et=c[R?H:p](M,V);return w.remove(c.getEl()),delete K[c.id],delete w._groups[c.id],w.fire(l,{group:c}),et},this.removeAllGroups=function(c,R,M){for(var V in K)this.removeGroup(K[V],c,R,M)};function Q(c,R){for(var M=c.getEl().querySelectorAll(".jtk-managed"),V=0;V<M.length;V++)w[R?E:x](M[V],!0)}var it=function(c,R,M){var V=c.endpoints[R===0?1:0].element;if(!(V[m]&&!V[m].shouldProxy()&&V[m].collapsed)){var et=M.getEl(),lt=w.getId(et);w.proxyConnection(c,R,et,lt,function(st,ct){return M.getEndpoint(st,ct)},function(st,ct){return M.getAnchor(st,ct)})}};this.collapseGroup=function(c){if(c=this.getGroup(c),!(c==null||c.collapsed)){var R=c.getEl();if(Q(c,!1),c.shouldProxy()){var M=function(V,et){for(var lt=0;lt<V.length;lt++){var st=V[lt];it(st,et,c)}};M(c.connections.source,0),M(c.connections.target,1)}c.collapsed=!0,w.removeClass(R,C),w.addClass(R,j),w.revalidate(R),w.fire(q,{group:c})}};var f=function(c,R,M){w.unproxyConnection(c,R,w.getId(M.getEl()))};this.expandGroup=function(c,R){if(c=this.getGroup(c),!(c==null||!c.collapsed)){var M=c.getEl();if(Q(c,!0),c.shouldProxy()){var V=function(et,lt){for(var st=0;st<et.length;st++){var ct=et[st];f(ct,lt,c)}};V(c.connections.source,0),V(c.connections.target,1)}c.collapsed=!1,w.addClass(M,C),w.removeClass(M,j),w.revalidate(M),this.repaintGroup(c),R||w.fire(z,{group:c})}},this.repaintGroup=function(c){c=this.getGroup(c);for(var R=c.getMembers(),M=0;M<R.length;M++)w.revalidate(R[M])};function S(c){for(var R=c.getMembers().slice(),M=[],V=0;V<R.length;V++)Array.prototype.push.apply(M,R[V].querySelectorAll(".jtk-managed"));Array.prototype.push.apply(R,M);var et=w.getConnections({source:R,scope:"*"},!0),lt=w.getConnections({target:R,scope:"*"},!0),st={};c.connections.source.length=0,c.connections.target.length=0;var ct=function(Et){for(var yt=0;yt<Et.length;yt++)if(!st[Et[yt].id]){st[Et[yt].id]=!0;var vt=w.getGroupFor(Et[yt].source),Ct=w.getGroupFor(Et[yt].target);vt===c?(Ct!==c&&c.connections.source.push(Et[yt]),U[Et[yt].id]=c):Ct===c&&(c.connections.target.push(Et[yt]),O[Et[yt].id]=c)}};ct(et),ct(lt)}this.updateConnectionsForGroup=S,this.refreshAllGroups=function(){for(var c in K)S(K[c]),w.dragManager.updateOffsets(w.getId(K[c].getEl()))}},W=function(w,K){var U=this,O=K.el;this.getEl=function(){return O},this.id=K.id||i.uuid(),O._isJsPlumbGroup=!0;var y=this.getDragArea=function(){var Ct=w.getSelector(O,A);return Ct&&Ct.length>0?Ct[0]:O},X=K.ghost===!0,ot=X||K.constrain===!0,Q=K.revert!==!1,it=K.orphan===!0,f=K.prune===!0,S=K.dropOverride===!0,c=K.proxied!==!1,R=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(Ct,Ot){return K.anchor||"Continuous"},this.getEndpoint=function(Ct,Ot){return K.endpoint||["Dot",{radius:10}]},this.collapsed=!1,K.draggable!==!1){var M={drag:function(){for(var Ct=0;Ct<R.length;Ct++)w.draw(R[Ct])},stop:function(Ct){w.fire(tt,jsPlumb.extend(Ct,{group:U}))},scope:D};K.dragOptions&&a.jsPlumb.extend(M,K.dragOptions),w.draggable(K.el,M)}K.droppable!==!1&&w.droppable(K.el,{drop:function(Ct){var Ot=Ct.drag.el;if(!Ot._isJsPlumbGroup){var xt=Ot._jsPlumbGroup;if(xt!==U){if(xt!=null&&xt.overrideDrop(Ot,U))return;w.getGroupManager().addToGroup(U,Ot,!1)}}}});var V=function(Ct,Ot){for(var xt=Ct.nodeType==null?Ct:[Ct],Pt=0;Pt<xt.length;Pt++)Ot(xt[Pt])};this.overrideDrop=function(Ct,Ot){return S&&(Q||f||it)},this.add=function(Ct,Ot){var xt=y();V(Ct,function(Pt){if(Pt._jsPlumbGroup!=null){if(Pt._jsPlumbGroup===U)return;Pt._jsPlumbGroup.remove(Pt,!0,Ot,!1)}Pt._jsPlumbGroup=U,R.push(Pt),w.isAlreadyDraggable(Pt)&&vt(Pt),Pt.parentNode!==xt&&xt.appendChild(Pt)}),w.getGroupManager().updateConnectionsForGroup(U)},this.remove=function(Ct,Ot,xt,Pt,Bt){V(Ct,function(Mt){if(Mt._jsPlumbGroup===U){if(delete Mt._jsPlumbGroup,i.removeWithFunction(R,function(ht){return ht===Mt}),Ot)try{U.getDragArea().removeChild(Mt)}catch(ht){jsPlumbUtil.log("Could not remove element from Group "+ht)}if(yt(Mt),!xt){var gt={group:U,el:Mt};Bt&&(gt.targetGroup=Bt),w.fire(k,gt)}}}),Pt||w.getGroupManager().updateConnectionsForGroup(U)},this.removeAll=function(Ct,Ot){for(var xt=0,Pt=R.length;xt<Pt;xt++){var Bt=R[0];U.remove(Bt,Ct,Ot,!0),w.remove(Bt,!0)}R.length=0,w.getGroupManager().updateConnectionsForGroup(U)},this.orphanAll=function(){for(var Ct={},Ot=0;Ot<R.length;Ot++){var xt=st(R[Ot]);Ct[xt[0]]=xt[1]}return R.length=0,Ct},this.getMembers=function(){return R},O[m]=this,w.bind(s,function(Ct){Ct.el._jsPlumbGroup===this&&vt(Ct.el)}.bind(this));function et(Ct){return Ct.offsetParent}function lt(Ct,Ot){var xt=et(Ct),Pt=w.getSize(xt),Bt=w.getSize(Ct),Mt=Ot[0],gt=Mt+Bt[0],ht=Ot[1],bt=ht+Bt[1];return gt>0&&Mt<Pt[0]&&bt>0&&ht<Pt[1]}function st(Ct){var Ot=w.getId(Ct),xt=w.getOffset(Ct);return Ct.parentNode.removeChild(Ct),w.getContainer().appendChild(Ct),w.setPosition(Ct,xt),yt(Ct),w.dragManager.clearParent(Ct,Ot),[Ot,xt]}function ct(Ct){var Ot=[];function xt(Bt,Mt,gt){var ht=null;if(!lt(Bt,[Mt,gt])){var bt=Bt._jsPlumbGroup;f?w.remove(Bt):ht=st(Bt),bt.remove(Bt)}return ht}for(var Pt=0;Pt<Ct.selection.length;Pt++)Ot.push(xt(Ct.selection[Pt][0],Ct.selection[Pt][1].left,Ct.selection[Pt][1].top));return Ot.length===1?Ot[0]:Ot}function Et(Ct){var Ot=w.getId(Ct);w.revalidate(Ct),w.dragManager.revalidateParent(Ct,Ot)}function yt(Ct){Ct._katavorioDrag&&((f||it)&&Ct._katavorioDrag.off(_,ct),!f&&!it&&Q&&(Ct._katavorioDrag.off(u,Et),Ct._katavorioDrag.setRevert(null)))}function vt(Ct){Ct._katavorioDrag&&((f||it)&&Ct._katavorioDrag.on(_,ct),ot&&Ct._katavorioDrag.setConstrain(!0),X&&Ct._katavorioDrag.setUseGhostProxy(!0),!f&&!it&&Q&&(Ct._katavorioDrag.on(u,Et),Ct._katavorioDrag.setRevert(function(Ot,xt){return!lt(Ot,xt)})))}this.shouldProxy=function(){return c},w.getGroupManager().addGroup(this)};h.prototype.addGroup=function(w){var K=this;if(K._groups=K._groups||{},K._groups[w.id]!=null)throw new TypeError("cannot create Group ["+w.id+"]; a Group with that ID exists");if(w.el[m]!=null)throw new TypeError("cannot create Group ["+w.id+"]; the given element is already a Group");var U=new W(K,w);return K._groups[U.id]=U,w.collapsed&&this.collapseGroup(U),U},h.prototype.addToGroup=function(w,K,U){var O=function(X){var ot=this.getId(X);this.manage(ot,X),this.getGroupManager().addToGroup(w,X,U)}.bind(this);if(Array.isArray(K))for(var y=0;y<K.length;y++)O(K[y]);else O(K)},h.prototype.removeFromGroup=function(w,K,U){this.getGroupManager().removeFromGroup(w,K,U),this.getContainer().appendChild(K)},h.prototype.removeGroup=function(w,K,U,O){return this.getGroupManager().removeGroup(w,K,U,O)},h.prototype.removeAllGroups=function(w,K,U){this.getGroupManager().removeAllGroups(w,K,U)},h.prototype.getGroup=function(w){return this.getGroupManager().getGroup(w)},h.prototype.getGroups=function(){return this.getGroupManager().getGroups()},h.prototype.expandGroup=function(w){this.getGroupManager().expandGroup(w)},h.prototype.collapseGroup=function(w){this.getGroupManager().collapseGroup(w)},h.prototype.repaintGroup=function(w){this.getGroupManager().repaintGroup(w)},h.prototype.toggleGroup=function(w){w=this.getGroupManager().getGroup(w),w!=null&&this.getGroupManager()[w.collapsed?"expandGroup":"collapseGroup"](w)},h.prototype.getGroupManager=function(){var w=this[o];return w==null&&(w=this[o]=new B(this)),w},h.prototype.removeGroupManager=function(){delete this[o]},h.prototype.getGroupFor=function(w){if(w=this.getElement(w),w){for(var K=this.getContainer(),U=!1,O=null;!U;)w==null||w===K?U=!0:w[m]?(O=w[m],U=!0):w=w.parentNode;return O}}}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j="Straight",C="Arc",A=function(s){this.type="Flowchart",s=s||{},s.stub=s.stub==null?30:s.stub;var _,u=i.Connectors.AbstractConnector.apply(this,arguments),o=s.midpoint==null||isNaN(s.midpoint)?.5:s.midpoint,m=s.alwaysRespectStubs===!0,D=null,L=null,k=s.cornerRadius!=null?s.cornerRadius:0;s.loopbackRadius;var v=function(I){return I<0?-1:I===0?0:1},l=function(I){return[v(I[2]-I[0]),v(I[3]-I[1])]},z=function(I,H,p,E){if(!(D===H&&L===p)){var x=D??E.sx,B=L??E.sy,W=x===H?"v":"h";D=H,L=p,I.push([x,B,H,p,W])}},q=function(I){return Math.sqrt(Math.pow(I[0]-I[2],2)+Math.pow(I[1]-I[3],2))},tt=function(I){var H=[];return H.push.apply(H,I),H},Y=function(I,H,p){for(var E=null,x,B,W,w=0;w<H.length-1;w++){if(E=E||tt(H[w]),x=tt(H[w+1]),B=l(E),W=l(x),k>0&&E[4]!==x[4]){var K=Math.min(q(E),q(x)),U=Math.min(k,K/2);E[2]-=B[0]*U,E[3]-=B[1]*U,x[0]+=W[0]*U,x[1]+=W[1]*U;var O=B[1]===W[0]&&W[0]===1||B[1]===W[0]&&W[0]===0&&B[0]!==W[1]||B[1]===W[0]&&W[0]===-1,y=x[1]>E[3]?1:-1,X=x[0]>E[2]?1:-1,ot=y===X,Q=ot&&O||!ot&&!O?x[0]:E[2],it=ot&&O||!ot&&!O?E[3]:x[1];u.addSegment(I,j,{x1:E[0],y1:E[1],x2:E[2],y2:E[3]}),u.addSegment(I,C,{r:U,x1:E[2],y1:E[3],x2:x[0],y2:x[1],cx:Q,cy:it,ac:O})}else{var f=E[2]===E[0]?0:E[2]>E[0]?p.lw/2:-(p.lw/2),S=E[3]===E[1]?0:E[3]>E[1]?p.lw/2:-(p.lw/2);u.addSegment(I,j,{x1:E[0]-f,y1:E[1]-S,x2:E[2]+f,y2:E[3]+S})}E=x}x!=null&&u.addSegment(I,j,{x1:x[0],y1:x[1],x2:x[2],y2:x[3]})};this.midpoint=o,this._compute=function(I,H){_=[],D=null,L=null;var p=function(){return[I.startStubX,I.startStubY,I.endStubX,I.endStubY]},E={perpendicular:p,orthogonal:p,opposite:function(S){var c=I,R=S==="x"?0:1,M={x:function(){return c.so[R]===1&&(c.startStubX>c.endStubX&&c.tx>c.startStubX||c.sx>c.endStubX&&c.tx>c.sx)||c.so[R]===-1&&(c.startStubX<c.endStubX&&c.tx<c.startStubX||c.sx<c.endStubX&&c.tx<c.sx)},y:function(){return c.so[R]===1&&(c.startStubY>c.endStubY&&c.ty>c.startStubY||c.sy>c.endStubY&&c.ty>c.sy)||c.so[R]===-1&&(c.startStubY<c.endStubY&&c.ty<c.startStubY||c.sy<c.endStubY&&c.ty<c.sy)}};return!m&&M[S]()?{x:[(I.sx+I.tx)/2,I.startStubY,(I.sx+I.tx)/2,I.endStubY],y:[I.startStubX,(I.sy+I.ty)/2,I.endStubX,(I.sy+I.ty)/2]}[S]:[I.startStubX,I.startStubY,I.endStubX,I.endStubY]}},x=E[I.anchorOrientation](I.sourceAxis),B=I.sourceAxis==="x"?0:1,W=I.sourceAxis==="x"?1:0,w=x[B],K=x[W],U=x[B+2],O=x[W+2];z(_,x[0],x[1],I);var y=I.startStubX+(I.endStubX-I.startStubX)*o,X=I.startStubY+(I.endStubY-I.startStubY)*o,ot={x:[0,1],y:[1,0]},Q={perpendicular:function(S){var c=I,R={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},M={x:[[c.startStubX,c.endStubX],null,[c.endStubX,c.startStubX]],y:[[c.startStubY,c.endStubY],null,[c.endStubY,c.startStubY]]},V={x:[[y,c.startStubY],[y,c.endStubY]],y:[[c.startStubX,X],[c.endStubX,X]]},et={x:[[c.endStubX,c.startStubY]],y:[[c.startStubX,c.endStubY]]},lt={x:[[c.startStubX,c.endStubY],[c.endStubX,c.endStubY]],y:[[c.endStubX,c.startStubY],[c.endStubX,c.endStubY]]},st={x:[[c.startStubX,X],[c.endStubX,X],[c.endStubX,c.endStubY]],y:[[y,c.startStubY],[y,c.endStubY],[c.endStubX,c.endStubY]]},ct={x:[c.startStubY,c.endStubY],y:[c.startStubX,c.endStubX]},Et=ot[S][0],yt=ot[S][1],vt=c.so[Et]+1,Ct=c.to[yt]+1,Ot=c.to[yt]===-1&&ct[S][1]<ct[S][0]||c.to[yt]===1&&ct[S][1]>ct[S][0],xt=M[S][vt][0],Pt=M[S][vt][1],Bt=R[S][vt][Ct];if(c.segment===Bt[3]||c.segment===Bt[2]&&Ot)return V[S];if(c.segment===Bt[2]&&Pt<xt)return et[S];if(c.segment===Bt[2]&&Pt>=xt||c.segment===Bt[1]&&!Ot)return st[S];if(c.segment===Bt[0]||c.segment===Bt[1]&&Ot)return lt[S]},orthogonal:function(S,c,R,M,V){var et=I,lt={x:et.so[0]===-1?Math.min(c,M):Math.max(c,M),y:et.so[1]===-1?Math.min(c,M):Math.max(c,M)}[S];return{x:[[lt,R],[lt,V],[M,V]],y:[[R,lt],[V,lt],[V,M]]}[S]},opposite:function(S,c,R,M){var V=I,et={x:"y",y:"x"}[S],lt={x:"height",y:"width"}[S],st=V["is"+S.toUpperCase()+"GreaterThanStubTimes2"];if(H.sourceEndpoint.elementId===H.targetEndpoint.elementId){var ct=R+(1-H.sourceEndpoint.anchor[et])*H.sourceInfo[lt]+u.maxStub;return{x:[[c,ct],[M,ct]],y:[[ct,c],[ct,M]]}[S]}else{if(!st||V.so[B]===1&&c>M||V.so[B]===-1&&c<M)return{x:[[c,X],[M,X]],y:[[y,c],[y,M]]}[S];if(V.so[B]===1&&c<M||V.so[B]===-1&&c>M)return{x:[[y,V.sy],[y,V.ty]],y:[[V.sx,X],[V.tx,X]]}[S]}}},it=Q[I.anchorOrientation](I.sourceAxis,w,K,U,O);if(it)for(var f=0;f<it.length;f++)z(_,it[f][0],it[f][1],I);z(_,x[2],x[3],I),z(_,I.tx,I.ty,I),Y(this,_,I)}};i.Connectors.Flowchart=A,h.extend(i.Connectors.Flowchart,i.Connectors.AbstractConnector)}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil;i.Connectors.AbstractBezierConnector=function(C){C=C||{};var A=C.showLoopback!==!1;C.curviness;var s=C.margin||5;C.proximityLimit;var _=C.orientation&&C.orientation==="clockwise",u=C.loopbackRadius||25,o;return this._compute=function(m,D){var L=D.sourcePos,k=D.targetPos,v=Math.abs(L[0]-k[0]),l=Math.abs(L[1]-k[1]);if(!A||D.sourceEndpoint.elementId!==D.targetEndpoint.elementId)this._computeBezier(m,D,L,k,v,l);else{var z=D.sourcePos[0],q=D.sourcePos[1]-s,tt=z,Y=q-u,I=tt-u,H=Y-u;v=2*u,l=2*u,m.points[0]=I,m.points[1]=H,m.points[2]=v,m.points[3]=l,o.addSegment(this,"Arc",{loopback:!0,x1:z-I+4,y1:q-H,startAngle:0,endAngle:2*Math.PI,r:u,ac:!_,x2:z-I-4,y2:q-H,cx:tt-I,cy:Y-H})}},o=i.Connectors.AbstractConnector.apply(this,arguments),o},h.extend(i.Connectors.AbstractBezierConnector,i.Connectors.AbstractConnector);var j=function(C){C=C||{},this.type="Bezier";var A=i.Connectors.AbstractBezierConnector.apply(this,arguments),s=C.curviness||150,_=10;this.getCurviness=function(){return s},this._findControlPoint=function(u,o,m,D,L,k,v){var l=k[0]!==v[0]||k[1]===v[1],z=[];return l?(v[0]===0?z.push(m[0]<o[0]?u[0]+_:u[0]-_):z.push(u[0]+s*v[0]),v[1]===0?z.push(m[1]<o[1]?u[1]+_:u[1]-_):z.push(u[1]+s*k[1])):(k[0]===0?z.push(o[0]<m[0]?u[0]+_:u[0]-_):z.push(u[0]-s*k[0]),k[1]===0?z.push(o[1]<m[1]?u[1]+_:u[1]-_):z.push(u[1]+s*v[1])),z},this._computeBezier=function(u,o,m,D,L,k){var v,l,z=m[0]<D[0]?L:0,q=m[1]<D[1]?k:0,tt=m[0]<D[0]?0:L,Y=m[1]<D[1]?0:k;v=this._findControlPoint([z,q],m,D,o.sourceEndpoint,o.targetEndpoint,u.so,u.to),l=this._findControlPoint([tt,Y],D,m,o.targetEndpoint,o.sourceEndpoint,u.to,u.so),A.addSegment(this,"Bezier",{x1:z,y1:q,x2:tt,y2:Y,cp1x:v[0],cp1y:v[1],cp2x:l[0],cp2y:l[1]})}};i.Connectors.Bezier=j,h.extend(j,i.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j=function(s,_,u,o){return s<=u&&o<=_?1:s<=u&&_<=o?2:u<=s&&o>=_?3:4},C=function(s,_,u,o,m,D,L,k,v){if(k<=v)return[s,_];if(u===1)return o[3]<=0&&m[3]>=1?[s+(o[2]<.5?-1*D:D),_]:o[2]>=1&&m[2]<=0?[s,_+(o[3]<.5?-1*L:L)]:[s+-1*D,_+-1*L];if(u===2)return o[3]>=1&&m[3]<=0?[s+(o[2]<.5?-1*D:D),_]:o[2]>=1&&m[2]<=0?[s,_+(o[3]<.5?-1*L:L)]:[s+D,_+-1*L];if(u===3)return o[3]>=1&&m[3]<=0?[s+(o[2]<.5?-1*D:D),_]:o[2]<=0&&m[2]>=1?[s,_+(o[3]<.5?-1*L:L)]:[s+-1*D,_+-1*L];if(u===4)return o[3]<=0&&m[3]>=1?[s+(o[2]<.5?-1*D:D),_]:o[2]<=0&&m[2]>=1?[s,_+(o[3]<.5?-1*L:L)]:[s+D,_+-1*L]},A=function(s){s=s||{},this.type="StateMachine";var _=i.Connectors.AbstractBezierConnector.apply(this,arguments),u=s.curviness||10,o=s.margin||5,m=s.proximityLimit||80;s.orientation&&s.orientation;var D;this._computeBezier=function(L,k,v,l,z,q){var tt=k.sourcePos[0]<k.targetPos[0]?0:z,Y=k.sourcePos[1]<k.targetPos[1]?0:q,I=k.sourcePos[0]<k.targetPos[0]?z:0,H=k.sourcePos[1]<k.targetPos[1]?q:0;k.sourcePos[2]===0&&(tt-=o),k.sourcePos[2]===1&&(tt+=o),k.sourcePos[3]===0&&(Y-=o),k.sourcePos[3]===1&&(Y+=o),k.targetPos[2]===0&&(I-=o),k.targetPos[2]===1&&(I+=o),k.targetPos[3]===0&&(H-=o),k.targetPos[3]===1&&(H+=o);var p=(tt+I)/2,E=(Y+H)/2,x=j(tt,Y,I,H),B=Math.sqrt(Math.pow(I-tt,2)+Math.pow(H-Y,2)),W,w,K,U;D=C(p,E,x,k.sourcePos,k.targetPos,u,u,B,m),W=D[0],w=D[0],K=D[1],U=D[1],_.addSegment(this,"Bezier",{x1:I,y1:H,x2:tt,y2:Y,cp1x:W,cp1y:K,cp2x:w,cp2y:U})}};i.Connectors.StateMachine=A,h.extend(A,i.Connectors.AbstractBezierConnector)}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j="Straight",C=function(A){this.type=j;var s=i.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(_,u){s.addSegment(this,j,{x1:_.sx,y1:_.sy,x2:_.startStubX,y2:_.startStubY}),s.addSegment(this,j,{x1:_.startStubX,y1:_.startStubY,x2:_.endStubX,y2:_.endStubY}),s.addSegment(this,j,{x1:_.endStubX,y1:_.endStubY,x2:_.tx,y2:_.ty})}};i.Connectors.Straight=C,h.extend(C,i.Connectors.AbstractConnector)}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},C="stroke-dasharray",A="dashstyle",s="linearGradient",_="radialGradient",u="defs",o="fill",m="stop",D="stroke",L="stroke-width",k="style",v="none",l="jsplumb_gradient_",z="strokeWidth",q={svg:"http://www.w3.org/2000/svg"},tt=function(U,O){for(var y in O)U.setAttribute(y,""+O[y])},Y=function(U,O){return O=O||{},O.version="1.1",O.xmlns=q.svg,i.createElementNS(q.svg,U,null,null,O)},I=function(U){return"position:absolute;left:"+U[0]+"px;top:"+U[1]+"px"},H=function(U){for(var O=U.querySelectorAll(" defs,linearGradient,radialGradient"),y=0;y<O.length;y++)O[y].parentNode.removeChild(O[y])},p=function(U,O,y,X,ot){var Q=l+ot._jsPlumb.instance.idstamp();H(U);var it;y.gradient.offset?it=Y(_,{id:Q}):it=Y(s,{id:Q,gradientUnits:"userSpaceOnUse"});var f=Y(u);U.appendChild(f),f.appendChild(it);for(var S=0;S<y.gradient.stops.length;S++){var c=ot.segment===1||ot.segment===2?S:y.gradient.stops.length-1-S,R=y.gradient.stops[c][1],M=Y(m,{offset:Math.floor(y.gradient.stops[S][0]*100)+"%","stop-color":R});it.appendChild(M)}var V=y.stroke?D:o;O.setAttribute(V,"url(#"+Q+")")},E=function(U,O,y,X,ot){if(O.setAttribute(o,y.fill?y.fill:v),O.setAttribute(D,y.stroke?y.stroke:v),y.gradient?p(U,O,y,X,ot):(H(U),O.setAttribute(k,"")),y.strokeWidth&&O.setAttribute(L,y.strokeWidth),y[A]&&y[z]&&!y[C]){var Q=y[A].indexOf(",")===-1?" ":",",it=y[A].split(Q),f="";it.forEach(function(c){f+=Math.floor(c*y.strokeWidth)+Q}),O.setAttribute(C,f)}else y[C]&&O.setAttribute(C,y[C]);for(var S in j)y[S]&&O.setAttribute(j[S],y[S])},x=function(U,O,y){U.childNodes.length>y?U.insertBefore(O,U.childNodes[y]):U.appendChild(O)};h.svg={node:Y,attr:tt,pos:I};var B=function(U){var O=U.pointerEventsSpec||"all",y={};i.jsPlumbUIComponent.apply(this,U.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var X=U.cssClass+" "+(U.originalArgs[0].cssClass||""),ot={style:"",width:0,height:0,"pointer-events":O,position:"absolute"};this.svg=Y("svg",ot),U.useDivWrapper?(this.canvas=i.createElement("div",{position:"absolute"}),h.sizeElement(this.canvas,0,0,1,1),this.canvas.className=X):(tt(this.svg,{class:X}),this.canvas=this.svg),U._jsPlumb.appendElement(this.canvas,U.originalArgs[0].parent),U.useDivWrapper&&this.canvas.appendChild(this.svg);var Q=[this.canvas];return this.getDisplayElements=function(){return Q},this.appendDisplayElement=function(it){Q.push(it)},this.paint=function(it,f,S){if(it!=null){var c=[this.x,this.y],R=[this.w,this.h],M;S!=null&&(S.xmin<0&&(c[0]+=S.xmin),S.ymin<0&&(c[1]+=S.ymin),R[0]=S.xmax+(S.xmin<0?-S.xmin:0),R[1]=S.ymax+(S.ymin<0?-S.ymin:0)),U.useDivWrapper?(h.sizeElement(this.canvas,c[0],c[1],R[0]>0?R[0]:1,R[1]>0?R[1]:1),c[0]=0,c[1]=0,M=I([0,0])):M=I([c[0],c[1]]),y.paint.apply(this,arguments),tt(this.svg,{style:M,width:R[0]||1,height:R[1]||1})}},{renderer:y}};h.extend(B,i.jsPlumbUIComponent,{cleanup:function(U){U||this.typeId==null?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null,this._jsPlumb=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(U){var O=U.getContainer();this.canvas&&this.canvas.parentNode==null&&O.appendChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode==null&&O.appendChild(this.bgCanvas)},setVisible:function(U){this.canvas&&(this.canvas.style.display=U?"block":"none")}}),i.ConnectorRenderers.svg=function(U){var O=this,y=B.apply(this,[{cssClass:U._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:U._jsPlumb}]);y.renderer.paint=function(X,ot,Q){var it=O.getSegments(),f="",S=[0,0];if(Q.xmin<0&&(S[0]=-Q.xmin),Q.ymin<0&&(S[1]=-Q.ymin),it.length>0){f=O.getPathData();var c={d:f,transform:"translate("+S[0]+","+S[1]+")","pointer-events":U["pointer-events"]||"visibleStroke"},R=null,M=[O.x,O.y,O.w,O.h];if(X.outlineStroke){var V=X.outlineWidth||1,et=X.strokeWidth+2*V;R=i.extend({},X),delete R.gradient,R.stroke=X.outlineStroke,R.strokeWidth=et,O.bgPath==null?(O.bgPath=Y("path",c),i.addClass(O.bgPath,i.connectorOutlineClass),x(O.svg,O.bgPath,0)):tt(O.bgPath,c),E(O.svg,O.bgPath,R,M,O)}O.path==null?(O.path=Y("path",c),x(O.svg,O.path,X.outlineStroke?1:0)):tt(O.path,c),E(O.svg,O.path,X,M,O)}}},h.extend(i.ConnectorRenderers.svg,B);var W=i.SvgEndpoint=function(U){var O=B.apply(this,[{cssClass:U._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:U._jsPlumb}]);O.renderer.paint=function(y){var X=i.extend({},y);X.outlineStroke&&(X.stroke=X.outlineStroke),this.node==null?(this.node=this.makeNode(X),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node),E(this.svg,this.node,X,[this.x,this.y,this.w,this.h],this),I(this.node,[this.x,this.y])}.bind(this)};h.extend(W,B),i.Endpoints.svg.Dot=function(){i.Endpoints.Dot.apply(this,arguments),W.apply(this,arguments),this.makeNode=function(U){return Y("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(U){tt(U,{cx:this.w/2,cy:this.h/2,r:this.radius})}},h.extend(i.Endpoints.svg.Dot,[i.Endpoints.Dot,W]),i.Endpoints.svg.Rectangle=function(){i.Endpoints.Rectangle.apply(this,arguments),W.apply(this,arguments),this.makeNode=function(U){return Y("rect",{width:this.w,height:this.h})},this.updateNode=function(U){tt(U,{width:this.w,height:this.h})}},h.extend(i.Endpoints.svg.Rectangle,[i.Endpoints.Rectangle,W]),i.Endpoints.svg.Image=i.Endpoints.Image,i.Endpoints.svg.Blank=i.Endpoints.Blank,i.Overlays.svg.Label=i.Overlays.Label,i.Overlays.svg.Custom=i.Overlays.Custom;var w=function(U,O){U.apply(this,O),i.jsPlumbUIComponent.apply(this,O),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(X,ot){if(X.component.svg&&ot){this.path==null&&(this.path=Y("path",{"pointer-events":"all"}),X.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,X.component),this.canvas=X.component.svg);var Q=O&&O.length===1&&O[0].cssClass||"",it=[0,0];ot.xmin<0&&(it[0]=-ot.xmin),ot.ymin<0&&(it[1]=-ot.ymin),tt(this.path,{d:y(X.d),class:Q,stroke:X.stroke?X.stroke:null,fill:X.fill?X.fill:null,transform:"translate("+it[0]+","+it[1]+")"})}};var y=function(X){return isNaN(X.cxy.x)||isNaN(X.cxy.y)?"":"M"+X.hxy.x+","+X.hxy.y+" L"+X.tail[0].x+","+X.tail[0].y+" L"+X.cxy.x+","+X.cxy.y+" L"+X.tail[1].x+","+X.tail[1].y+" L"+X.hxy.x+","+X.hxy.y};this.transfer=function(X){X.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),X.canvas.appendChild(this.path))}},K={cleanup:function(U){this.path!=null&&(U?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(U,O){this.path&&O.canvas&&O.canvas.appendChild(this.path)},setVisible:function(U){this.path!=null&&(this.path.style.display=U?"block":"none")}};h.extend(w,[i.jsPlumbUIComponent,i.Overlays.AbstractOverlay]),i.Overlays.svg.Arrow=function(){w.apply(this,[i.Overlays.Arrow,arguments])},h.extend(i.Overlays.svg.Arrow,[i.Overlays.Arrow,w],K),i.Overlays.svg.PlainArrow=function(){w.apply(this,[i.Overlays.PlainArrow,arguments])},h.extend(i.Overlays.svg.PlainArrow,[i.Overlays.PlainArrow,w],K),i.Overlays.svg.Diamond=function(){w.apply(this,[i.Overlays.Diamond,arguments])},h.extend(i.Overlays.svg.Diamond,[i.Overlays.Diamond,w],K),i.Overlays.svg.GuideLines=function(){var U=null,O=this,y,X;i.Overlays.GuideLines.apply(this,arguments),this.paint=function(Q,it){U==null&&(U=Y("path"),Q.connector.svg.appendChild(U),O.attachListeners(U,Q.connector),O.attachListeners(U,O),y=Y("path"),Q.connector.svg.appendChild(y),O.attachListeners(y,Q.connector),O.attachListeners(y,O),X=Y("path"),Q.connector.svg.appendChild(X),O.attachListeners(X,Q.connector),O.attachListeners(X,O));var f=[0,0];it.xmin<0&&(f[0]=-it.xmin),it.ymin<0&&(f[1]=-it.ymin),tt(U,{d:ot(Q.head,Q.tail),stroke:"red",fill:null,transform:"translate("+f[0]+","+f[1]+")"}),tt(y,{d:ot(Q.tailLine[0],Q.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+f[0]+","+f[1]+")"}),tt(X,{d:ot(Q.headLine[0],Q.headLine[1]),stroke:"green",fill:null,transform:"translate("+f[0]+","+f[1]+")"})};var ot=function(Q,it){return"M "+Q.x+","+Q.y+" L"+it.x+","+it.y}},h.extend(i.Overlays.svg.GuideLines,i.Overlays.GuideLines)}.call(typeof window<"u"?window:ie),function(){var a=this,i=a.jsPlumb,h=a.jsPlumbUtil,j=a.Katavorio,C=a.Biltong,A=function(p){var E=p._mottle;return E||(E=p._mottle=new a.Mottle),E},s=function(p,E){E=E||"main";var x="_katavorio_"+E,B=p[x],W=p.getEventManager();return B||(B=new j({bind:W.on,unbind:W.off,getSize:i.getSize,getConstrainingRectangle:function(w){return[w.parentNode.scrollWidth,w.parentNode.scrollHeight]},getPosition:function(w,K){var U=p.getOffset(w,K,w._katavorioDrag?w.offsetParent:null);return[U.left,U.top]},setPosition:function(w,K){w.style.left=K[0]+"px",w.style.top=K[1]+"px"},addClass:i.addClass,removeClass:i.removeClass,intersects:C.intersects,indexOf:function(w,K){return w.indexOf(K)},scope:p.getDefaultScope(),css:{noSelect:p.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),B.setZoom(p.getZoom()),p[x]=B,p.bind("zoom",B.setZoom)),B},_=function(p){var E=p.el._jsPlumbDragOptions,x=!0;return E.canDrag&&(x=E.canDrag()),x&&(this.setHoverSuspended(!0),this.select({source:p.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:p.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),this.setConnectionBeingDragged(!0)),x},u=function(p){var E=this.getUIPosition(arguments,this.getZoom());if(E!=null){var x=p.el._jsPlumbDragOptions;this.draw(p.el,E,null,!0),x._dragging&&this.addClass(p.el,"jtk-dragged"),x._dragging=!0}},o=function(p){for(var E=p.selection,x,B=function(w){var K;w[1]!=null&&(x=this.getUIPosition([{el:w[2].el,pos:[w[1].left,w[1].top]}]),K=this.draw(w[2].el,x)),w[0]._jsPlumbDragOptions!=null&&delete w[0]._jsPlumbDragOptions._dragging,this.removeClass(w[0],"jtk-dragged"),this.select({source:w[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,!0),this.select({target:w[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,!0),p.e._drawResult=p.e._drawResult||{c:[],e:[],a:[]},Array.prototype.push.apply(p.e._drawResult.c,K.c),Array.prototype.push.apply(p.e._drawResult.e,K.e),Array.prototype.push.apply(p.e._drawResult.a,K.a),this.getDragManager().dragEnded(w[2].el)}.bind(this),W=0;W<E.length;W++)B(E[W]);this.setHoverSuspended(!1),this.setConnectionBeingDragged(!1)},m=function(p,E){var x=function(B){if(E[B]!=null)if(h.isString(E[B])){var W=E[B].match(/-=/)?-1:1,w=E[B].substring(2);return p[B]+W*w}else return E[B];else return p[B]};return[x("left"),x("top")]},D=function(p,E){if(E==null)return[0,0];var x=z(E),B=l(x,0);return[B[p+"X"],B[p+"Y"]]},L=D.bind(this,"page"),k=D.bind(this,"screen"),v=D.bind(this,"client"),l=function(p,E){return p.item?p.item(E):p[E]},z=function(p){return p.touches&&p.touches.length>0?p.touches:p.changedTouches&&p.changedTouches.length>0?p.changedTouches:p.targetTouches&&p.targetTouches.length>0?p.targetTouches:[p]},q=function(p){var E={},x=[],B={},W={},w={};this.register=function(K){var U=p.getId(K),O;E[U]||(E[U]=K,x.push(K),B[U]={});var y=function(X){if(X){for(var ot=0;ot<X.childNodes.length;ot++)if(X.childNodes[ot].nodeType!==3&&X.childNodes[ot].nodeType!==8){var Q=jsPlumb.getElement(X.childNodes[ot]),it=p.getId(X.childNodes[ot],null,!0);if(it&&W[it]&&W[it]>0){O||(O=p.getOffset(K));var f=p.getOffset(Q);B[U][it]={id:it,offset:{left:f.left-O.left,top:f.top-O.top}},w[it]=U}y(X.childNodes[ot])}}};y(K)},this.updateOffsets=function(K,U){if(K!=null){U=U||{};var O=jsPlumb.getElement(K),y=p.getId(O),X=B[y],ot;if(X){for(var Q in X)if(X.hasOwnProperty(Q)){var it=jsPlumb.getElement(Q),f=U[Q]||p.getOffset(it);if(it.offsetParent==null&&B[y][Q]!=null)continue;ot||(ot=p.getOffset(O)),B[y][Q]={id:Q,offset:{left:f.left-ot.left,top:f.top-ot.top}},w[Q]=y}}}},this.endpointAdded=function(K,U){U=U||p.getId(K);var O=document.body,y=K.parentNode;for(W[U]=W[U]?W[U]+1:1;y!=null&&y!==O;){var X=p.getId(y,null,!0);if(X&&E[X]){var ot=p.getOffset(y);if(B[X][U]==null){var Q=p.getOffset(K);B[X][U]={id:U,offset:{left:Q.left-ot.left,top:Q.top-ot.top}},w[U]=X}break}y=y.parentNode}},this.endpointDeleted=function(K){if(W[K.elementId]&&(W[K.elementId]--,W[K.elementId]<=0))for(var U in B)B.hasOwnProperty(U)&&B[U]&&(delete B[U][K.elementId],delete w[K.elementId])},this.changeId=function(K,U){B[U]=B[K],B[K]={},w[U]=w[K],w[K]=null},this.getElementsForDraggable=function(K){return B[K]},this.elementRemoved=function(K){var U=w[K];U&&(B[U]&&delete B[U][K],delete w[K])},this.reset=function(){E={},x=[],B={},W={}},this.dragEnded=function(K){if(K.offsetParent!=null){var U=p.getId(K),O=w[U];O&&this.updateOffsets(O)}},this.setParent=function(K,U,O,y,X){var ot=w[U];B[y]||(B[y]={});var Q=p.getOffset(O),it=X||p.getOffset(K);ot&&B[ot]&&delete B[ot][U],B[y][U]={id:U,offset:{left:it.left-Q.left,top:it.top-Q.top}},w[U]=y},this.clearParent=function(K,U){var O=w[U];O&&(delete B[O][U],delete w[U])},this.revalidateParent=function(K,U,O){var y=w[U];if(y){var X={};X[U]=O,this.updateOffsets(y,X),p.revalidate(y)}},this.getDragAncestor=function(K){var U=jsPlumb.getElement(K),O=p.getId(U),y=w[O];return y?jsPlumb.getElement(y):null}},tt=function(p,E,x){E=h.fastTrim(E),typeof p.className.baseVal<"u"?p.className.baseVal=E:p.className=E;try{var B=p.classList;if(B!=null){for(;B.length>0;)B.remove(B.item(0));for(var W=0;W<x.length;W++)x[W]&&B.add(x[W])}}catch(w){h.log("JSPLUMB: cannot set class list",w)}},Y=function(p){return typeof p.className.baseVal>"u"?p.className:p.className.baseVal},I=function(p,E,x){E=E==null?[]:h.isArray(E)?E:E.split(/\s+/),x=x==null?[]:h.isArray(x)?x:x.split(/\s+/);var B=Y(p),W=B.split(/\s+/),w=function(K,U){for(var O=0;O<U.length;O++)if(K)W.indexOf(U[O])===-1&&W.push(U[O]);else{var y=W.indexOf(U[O]);y!==-1&&W.splice(y,1)}};w(!0,E),w(!1,x),tt(p,W.join(" "),W)};a.jsPlumb.extend(a.jsPlumbInstance.prototype,{headless:!1,pageLocation:L,screenLocation:k,clientLocation:v,getDragManager:function(){return this.dragManager==null&&(this.dragManager=new q(this)),this.dragManager},recalculateOffsets:function(p){this.getDragManager().updateOffsets(p)},createElement:function(p,E,x,B){return this.createElementNS(null,p,E,x,B)},createElementNS:function(p,E,x,B,W){var w=p==null?document.createElement(E):document.createElementNS(p,E),K;x=x||{};for(K in x)w.style[K]=x[K];B&&(w.className=B),W=W||{};for(K in W)w.setAttribute(K,""+W[K]);return w},getAttribute:function(p,E){return p.getAttribute!=null?p.getAttribute(E):null},setAttribute:function(p,E,x){p.setAttribute!=null&&p.setAttribute(E,x)},setAttributes:function(p,E){for(var x in E)E.hasOwnProperty(x)&&p.setAttribute(x,E[x])},appendToRoot:function(p){document.body.appendChild(p)},getRenderModes:function(){return["svg"]},getClass:Y,addClass:function(p,E){jsPlumb.each(p,function(x){I(x,E)})},hasClass:function(p,E){return p=jsPlumb.getElement(p),p.classList?p.classList.contains(E):Y(p).indexOf(E)!==-1},removeClass:function(p,E){jsPlumb.each(p,function(x){I(x,null,E)})},toggleClass:function(p,E){jsPlumb.hasClass(p,E)?jsPlumb.removeClass(p,E):jsPlumb.addClass(p,E)},updateClasses:function(p,E,x){jsPlumb.each(p,function(B){I(B,E,x)})},setClass:function(p,E){E!=null&&jsPlumb.each(p,function(x){tt(x,E,E.split(/\s+/))})},setPosition:function(p,E){p.style.left=E.left+"px",p.style.top=E.top+"px"},getPosition:function(p){var E=function(x){var B=p.style[x];return B?B.substring(0,B.length-2):0};return{left:E("left"),top:E("top")}},getStyle:function(p,E){return typeof window.getComputedStyle<"u"?getComputedStyle(p,null).getPropertyValue(E):p.currentStyle[E]},getSelector:function(p,E){var x=null;return arguments.length===1?x=p.nodeType!=null?p:document.querySelectorAll(p):x=p.querySelectorAll(E),x},getOffset:function(p,E,x){p=jsPlumb.getElement(p),x=x||this.getContainer();for(var B={left:p.offsetLeft,top:p.offsetTop},W=E||x!=null&&p!==x&&p.offsetParent!==x?p.offsetParent:null,w=function(O){O!=null&&O!==document.body&&(O.scrollTop>0||O.scrollLeft>0)&&(B.left-=O.scrollLeft,B.top-=O.scrollTop)}.bind(this);W!=null;)B.left+=W.offsetLeft,B.top+=W.offsetTop,w(W),W=E?W.offsetParent:W.offsetParent===x?null:W.offsetParent;if(x!=null&&!E&&(x.scrollTop>0||x.scrollLeft>0)){var K=p.offsetParent!=null?this.getStyle(p.offsetParent,"position"):"static",U=this.getStyle(p,"position");U!=="absolute"&&U!=="fixed"&&K!=="absolute"&&K!=="fixed"&&(B.left-=x.scrollLeft,B.top-=x.scrollTop)}return B},getPositionOnElement:function(p,E,x){var B=typeof E.getBoundingClientRect<"u"?E.getBoundingClientRect():{left:0,top:0,width:0,height:0},W=document.body,w=document.documentElement,K=window.pageYOffset||w.scrollTop||W.scrollTop,U=window.pageXOffset||w.scrollLeft||W.scrollLeft,O=w.clientTop||W.clientTop||0,y=w.clientLeft||W.clientLeft||0,X=0,ot=0,Q=B.top+K-O+X*x,it=B.left+U-y+ot*x,f=jsPlumb.pageLocation(p),S=B.width||E.offsetWidth*x,c=B.height||E.offsetHeight*x,R=(f[0]-it)/S,M=(f[1]-Q)/c;return[R,M]},getAbsolutePosition:function(p){var E=function(x){var B=p.style[x];if(B)return parseFloat(B.substring(0,B.length-2))};return[E("left"),E("top")]},setAbsolutePosition:function(p,E,x,B){x?this.animate(p,{left:"+="+(E[0]-x[0]),top:"+="+(E[1]-x[1])},B):(p.style.left=E[0]+"px",p.style.top=E[1]+"px")},getSize:function(p){return[p.offsetWidth,p.offsetHeight]},getWidth:function(p){return p.offsetWidth},getHeight:function(p){return p.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(p,E){var x;return p=h.isArray(p)||p.length!=null&&!h.isString(p)?p:[p],Array.prototype.slice.call(p).forEach(function(B){x=this.info(B),x.el&&this._initDraggableIfNecessary(x.el,!0,E,x.id,!0)}.bind(this)),this},snapToGrid:function(p,E,x){var B=[],W=function(U){var O=this.info(U);if(O.el!=null&&O.el._katavorioDrag){var y=O.el._katavorioDrag.snap(E,x);this.revalidate(O.el),B.push([O.el,y])}}.bind(this);if(arguments.length===1||arguments.length===3)W(p,E,x);else{var w=this.getManagedElements();for(var K in w)W(K,arguments[0],arguments[1])}return B},initDraggable:function(p,E,x){s(this,x).draggable(p,E),p._jsPlumbDragOptions=E},destroyDraggable:function(p,E){s(this,E).destroyDraggable(p),p._jsPlumbDragOptions=null,p._jsPlumbRelatedElement=null},unbindDraggable:function(p,E,x,B){s(this,B).destroyDraggable(p,E,x)},setDraggable:function(p,E){return jsPlumb.each(p,function(x){this.isDragSupported(x)&&(this._draggableStates[this.getAttribute(x,"id")]=E,this.setElementDraggable(x,E))}.bind(this))},_draggableStates:{},toggleDraggable:function(p){var E;return jsPlumb.each(p,function(x){var B=this.getAttribute(x,"id");return E=this._draggableStates[B]==null?!1:this._draggableStates[B],E=!E,this._draggableStates[B]=E,this.setDraggable(x,E),E}.bind(this)),E},_initDraggableIfNecessary:function(p,E,x,B,W){if(!jsPlumb.headless){var w=E??!1;if(w&&jsPlumb.isDragSupported(p,this)){var K=x||this.Defaults.DragOptions;if(K=jsPlumb.extend({},K),jsPlumb.isAlreadyDraggable(p,this))x.force&&this.initDraggable(p,K);else{var U=jsPlumb.dragEvents.drag,O=jsPlumb.dragEvents.stop,y=jsPlumb.dragEvents.start;this.manage(B,p),K[y]=h.wrap(K[y],_.bind(this)),K[U]=h.wrap(K[U],u.bind(this)),K[O]=h.wrap(K[O],o.bind(this));var X=this.getId(p);this._draggableStates[X]=!0;var ot=this._draggableStates[X];K.disabled=ot==null?!1:!ot,this.initDraggable(p,K),this.getDragManager().register(p),W&&this.fire("elementDraggable",{el:p,options:K})}}}},animationSupported:!0,getElement:function(p){return p==null?null:(p=typeof p=="string"?p:p.tagName==null&&p.length!=null&&p.enctype==null?p[0]:p,typeof p=="string"?document.getElementById(p):p)},removeElement:function(p){s(this).elementRemoved(p),this.getEventManager().remove(p)},doAnimate:function(p,E,x){x=x||{};var B=this.getOffset(p),W=m(B,E),w=W[0]-B.left,K=W[1]-B.top,U=x.duration||250,O=15,y=U/O,X=O/U*w,ot=O/U*K,Q=0,it=setInterval(function(){i.setPosition(p,{left:B.left+X*(Q+1),top:B.top+ot*(Q+1)}),x.step!=null&&x.step(Q,Math.ceil(y)),Q++,Q>=y&&(window.clearInterval(it),x.complete!=null&&x.complete())},O)},destroyDroppable:function(p,E){s(this,E).destroyDroppable(p)},unbindDroppable:function(p,E,x,B){s(this,B).destroyDroppable(p,E,x)},droppable:function(p,E){p=h.isArray(p)||p.length!=null&&!h.isString(p)?p:[p];var x;return E=E||{},E.allowLoopback=!1,Array.prototype.slice.call(p).forEach(function(B){x=this.info(B),x.el&&this.initDroppable(x.el,E)}.bind(this)),this},initDroppable:function(p,E,x){s(this,x).droppable(p,E)},isAlreadyDraggable:function(p){return p._katavorioDrag!=null},isDragSupported:function(p,E){return!0},isDropSupported:function(p,E){return!0},isElementDraggable:function(p){return p=i.getElement(p),p._katavorioDrag&&p._katavorioDrag.isEnabled()},getDragObject:function(p){return p[0].drag.getDragElement()},getDragScope:function(p){return p._katavorioDrag&&p._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(p){return p[0].e},getUIPosition:function(p,E){var x=p[0].el;if(x.offsetParent==null)return null;var B=p[0].finalPos||p[0].pos,W={left:B[0],top:B[1]};if(x._katavorioDrag&&x.offsetParent!==this.getContainer()){var w=this.getOffset(x.offsetParent);W.left+=w.left,W.top+=w.top}return W},setDragFilter:function(p,E,x){p._katavorioDrag&&p._katavorioDrag.setFilter(E,x)},setElementDraggable:function(p,E){p=i.getElement(p),p._katavorioDrag&&p._katavorioDrag.setEnabled(E)},setDragScope:function(p,E){p._katavorioDrag&&p._katavorioDrag.k.setDragScope(p,E)},setDropScope:function(p,E){p._katavorioDrop&&p._katavorioDrop.length>0&&p._katavorioDrop[0].k.setDropScope(p,E)},addToPosse:function(p,E){var x=Array.prototype.slice.call(arguments,1),B=s(this);i.each(p,function(W){W=[i.getElement(W)],W.push.apply(W,x),B.addToPosse.apply(B,W)})},setPosse:function(p,E){var x=Array.prototype.slice.call(arguments,1),B=s(this);i.each(p,function(W){W=[i.getElement(W)],W.push.apply(W,x),B.setPosse.apply(B,W)})},removeFromPosse:function(p,E){var x=Array.prototype.slice.call(arguments,1),B=s(this);i.each(p,function(W){W=[i.getElement(W)],W.push.apply(W,x),B.removeFromPosse.apply(B,W)})},removeFromAllPosses:function(p){var E=s(this);i.each(p,function(x){E.removeFromAllPosses(i.getElement(x))})},setPosseState:function(p,E,x){var B=s(this);i.each(p,function(W){B.setPosseState(i.getElement(W),E,x)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(p){p._katavorioDrag&&p._katavorioDrag.abort()},addToDragSelection:function(p){var E=this.getElement(p);E!=null&&(E._isJsPlumbGroup||E._jsPlumbGroup==null)&&s(this).select(p)},removeFromDragSelection:function(p){s(this).deselect(p)},getDragSelection:function(){return s(this).getSelection()},clearDragSelection:function(){s(this).deselectAll()},trigger:function(p,E,x,B){this.getEventManager().trigger(p,E,x,B)},doReset:function(){for(var p in this)p.indexOf("_katavorio_")===0&&this[p].reset()},getEventManager:function(){return A(this)},on:function(p,E,x){return this.getEventManager().on.apply(this,arguments),this},off:function(p,E,x){return this.getEventManager().off.apply(this,arguments),this}});var H=function(p){var E=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body<"u"&&document.body!=null?p():setTimeout(E,9)};E()};H(i.init)}.call(typeof window<"u"?window:ie)})(Gl);var os={exports:{}};(function(g,a){(function(i){g.exports=i()})(function(){var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default=function(t){return!(!t||!t.Window)&&t instanceof t.Window};var h={};Object.defineProperty(h,"__esModule",{value:!0}),h.getWindow=function(t){return(0,i.default)(t)?t:(t.ownerDocument||t).defaultView||C.window},h.init=A,h.window=h.realWindow=void 0;var j=void 0;h.realWindow=j;var C=void 0;function A(t){h.realWindow=j=t;var e=t.document.createTextNode("");e.ownerDocument!==t.document&&typeof t.wrap=="function"&&t.wrap(e)===e&&(t=t.wrap(t)),h.window=C=t}h.window=C,typeof window<"u"&&window&&A(window);var s={};function _(t){return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(t)}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var u=function(t){return!!t&&_(t)==="object"},o=function(t){return typeof t=="function"},m={window:function(t){return t===h.window||(0,i.default)(t)},docFrag:function(t){return u(t)&&t.nodeType===11},object:u,func:o,number:function(t){return typeof t=="number"},bool:function(t){return typeof t=="boolean"},string:function(t){return typeof t=="string"},element:function(t){if(!t||_(t)!=="object")return!1;var e=h.getWindow(t)||h.window;return/object|function/.test(typeof Element>"u"?"undefined":_(Element))?t instanceof Element||t instanceof e.Element:t.nodeType===1&&typeof t.nodeName=="string"},plainObject:function(t){return u(t)&&!!t.constructor&&/function Object\b/.test(t.constructor.toString())},array:function(t){return u(t)&&t.length!==void 0&&o(t.splice)}};s.default=m;var D={};function L(t){var e=t.interaction;if(e.prepared.name==="drag"){var n=e.prepared.axis;n==="x"?(e.coords.cur.page.y=e.coords.start.page.y,e.coords.cur.client.y=e.coords.start.client.y,e.coords.velocity.client.y=0,e.coords.velocity.page.y=0):n==="y"&&(e.coords.cur.page.x=e.coords.start.page.x,e.coords.cur.client.x=e.coords.start.client.x,e.coords.velocity.client.x=0,e.coords.velocity.page.x=0)}}function k(t){var e=t.iEvent,n=t.interaction;if(n.prepared.name==="drag"){var r=n.prepared.axis;if(r==="x"||r==="y"){var d=r==="x"?"y":"x";e.page[d]=n.coords.start.page[d],e.client[d]=n.coords.start.client[d],e.delta[d]=0}}}Object.defineProperty(D,"__esModule",{value:!0}),D.default=void 0;var v={id:"actions/drag",install:function(t){var e=t.actions,n=t.Interactable,r=t.defaults;n.prototype.draggable=v.draggable,e.map.drag=v,e.methodDict.drag="draggable",r.actions.drag=v.defaults},listeners:{"interactions:before-action-move":L,"interactions:action-resume":L,"interactions:action-move":k,"auto-start:check":function(t){var e=t.interaction,n=t.interactable,r=t.buttons,d=n.options.drag;if(d&&d.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||r&n.options.drag.mouseButtons))return t.action={name:"drag",axis:d.lockAxis==="start"?d.startAxis:d.lockAxis},!1}},draggable:function(t){return s.default.object(t)?(this.options.drag.enabled=t.enabled!==!1,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^(xy|x|y|start)$/.test(t.lockAxis)&&(this.options.drag.lockAxis=t.lockAxis),/^(xy|x|y)$/.test(t.startAxis)&&(this.options.drag.startAxis=t.startAxis),this):s.default.bool(t)?(this.options.drag.enabled=t,this):this.options.drag},beforeMove:L,move:k,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"}},l=v;D.default=l;var z={};Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var q={init:function(t){var e=t;q.document=e.document,q.DocumentFragment=e.DocumentFragment||tt,q.SVGElement=e.SVGElement||tt,q.SVGSVGElement=e.SVGSVGElement||tt,q.SVGElementInstance=e.SVGElementInstance||tt,q.Element=e.Element||tt,q.HTMLElement=e.HTMLElement||q.Element,q.Event=e.Event,q.Touch=e.Touch||tt,q.PointerEvent=e.PointerEvent||e.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function tt(){}var Y=q;z.default=Y;var I={};Object.defineProperty(I,"__esModule",{value:!0}),I.default=void 0;var H={init:function(t){var e=z.default.Element,n=t.navigator||{};H.supportsTouch="ontouchstart"in t||s.default.func(t.DocumentTouch)&&z.default.document instanceof t.DocumentTouch,H.supportsPointerEvent=n.pointerEnabled!==!1&&!!z.default.PointerEvent,H.isIOS=/iP(hone|od|ad)/.test(n.platform),H.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),H.isIe9=/MSIE 9/.test(n.userAgent),H.isOperaMobile=n.appName==="Opera"&&H.supportsTouch&&/Presto/.test(n.userAgent),H.prefixedMatchesSelector="matches"in e.prototype?"matches":"webkitMatchesSelector"in e.prototype?"webkitMatchesSelector":"mozMatchesSelector"in e.prototype?"mozMatchesSelector":"oMatchesSelector"in e.prototype?"oMatchesSelector":"msMatchesSelector",H.pEventTypes=H.supportsPointerEvent?z.default.PointerEvent===t.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,H.wheelEvent=z.default.document&&"onmousewheel"in z.default.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},p=H;I.default=p;var E={};function x(t){var e=t.parentNode;if(s.default.docFrag(e)){for(;(e=e.host)&&s.default.docFrag(e););return e}return e}function B(t,e){return h.window!==h.realWindow&&(e=e.replace(/\/deep\//g," ")),t[I.default.prefixedMatchesSelector](e)}Object.defineProperty(E,"__esModule",{value:!0}),E.closest=function(t,e){for(;s.default.element(t);){if(B(t,e))return t;t=x(t)}return null},E.getActualElement=function(t){return t.correspondingUseElement||t},E.getElementClientRect=U,E.getElementRect=function(t){var e=U(t);if(!I.default.isIOS7&&e){var n=K(h.getWindow(t));e.left+=n.x,e.right+=n.x,e.top+=n.y,e.bottom+=n.y}return e},E.getPath=function(t){for(var e=[];t;)e.push(t),t=x(t);return e},E.getScrollXY=K,E.indexOfDeepestElement=function(t){for(var e,n=[],r=0;r<t.length;r++){var d=t[r],P=t[e];if(d&&r!==e)if(P){var F=W(d),T=W(P);if(F!==d.ownerDocument)if(T!==d.ownerDocument)if(F!==T){n=n.length?n:w(P);var N=void 0;if(P instanceof z.default.HTMLElement&&d instanceof z.default.SVGElement&&!(d instanceof z.default.SVGSVGElement)){if(d===T)continue;N=d.ownerSVGElement}else N=d;for(var nt=w(N,P.ownerDocument),rt=0;nt[rt]&&nt[rt]===n[rt];)rt++;var ut=[nt[rt-1],nt[rt],n[rt]];if(ut[0])for(var pt=ut[0].lastChild;pt;){if(pt===ut[1]){e=r,n=nt;break}if(pt===ut[2])break;pt=pt.previousSibling}}else mt=d,dt=P,(parseInt(h.getWindow(mt).getComputedStyle(mt).zIndex,10)||0)>=(parseInt(h.getWindow(dt).getComputedStyle(dt).zIndex,10)||0)&&(e=r);else e=r}else e=r}var mt,dt;return e},E.matchesSelector=B,E.matchesUpTo=function(t,e,n){for(;s.default.element(t);){if(B(t,e))return!0;if((t=x(t))===n)return B(t,e)}return!1},E.nodeContains=function(t,e){if(t.contains)return t.contains(e);for(;e;){if(e===t)return!0;e=e.parentNode}return!1},E.parentNode=x,E.trySelector=function(t){return!!s.default.string(t)&&(z.default.document.querySelector(t),!0)};var W=function(t){return t.parentNode||t.host};function w(t,e){for(var n,r=[],d=t;(n=W(d))&&d!==e&&n!==d.ownerDocument;)r.unshift(d),d=n;return r}function K(t){return{x:(t=t||h.window).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}}function U(t){var e=t instanceof z.default.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}var O={};Object.defineProperty(O,"__esModule",{value:!0}),O.default=function(t,e){for(var n in e)t[n]=e[n];return t};var y={};function X(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ot(t,e,n){return t==="parent"?(0,E.parentNode)(n):t==="self"?e.getRect(n):(0,E.closest)(n,t)}Object.defineProperty(y,"__esModule",{value:!0}),y.addEdges=function(t,e,n){t.left&&(e.left+=n.x),t.right&&(e.right+=n.x),t.top&&(e.top+=n.y),t.bottom&&(e.bottom+=n.y),e.width=e.right-e.left,e.height=e.bottom-e.top},y.getStringOptionResult=ot,y.rectToXY=function(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}},y.resolveRectLike=function(t,e,n,r){var d,P=t;return s.default.string(P)?P=ot(P,e,n):s.default.func(P)&&(P=P.apply(void 0,function(F){if(Array.isArray(F))return X(F)}(d=r)||function(F){if(typeof Symbol<"u"&&F[Symbol.iterator]!=null||F["@@iterator"]!=null)return Array.from(F)}(d)||function(F,T){if(F){if(typeof F=="string")return X(F,T);var N=Object.prototype.toString.call(F).slice(8,-1);return N==="Object"&&F.constructor&&(N=F.constructor.name),N==="Map"||N==="Set"?Array.from(F):N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N)?X(F,T):void 0}}(d)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())),s.default.element(P)&&(P=(0,E.getElementRect)(P)),P},y.tlbrToXywh=function(t){return!t||"x"in t&&"y"in t||((t=(0,O.default)({},t)).x=t.left||0,t.y=t.top||0,t.width=t.width||(t.right||0)-t.x,t.height=t.height||(t.bottom||0)-t.y),t},y.xywhToTlbr=function(t){return!t||"left"in t&&"top"in t||((t=(0,O.default)({},t)).left=t.x||0,t.top=t.y||0,t.right=t.right||t.left+t.width,t.bottom=t.bottom||t.top+t.height),t};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=function(t,e,n){var r=t.options[n],d=r&&r.origin||t.options.origin,P=(0,y.resolveRectLike)(d,t,e,[t&&e]);return(0,y.rectToXY)(P)||{x:0,y:0}};var it={};function f(t){return t.trim().split(/ +/)}Object.defineProperty(it,"__esModule",{value:!0}),it.default=function t(e,n,r){if(r=r||{},s.default.string(e)&&e.search(" ")!==-1&&(e=f(e)),s.default.array(e))return e.reduce(function(N,nt){return(0,O.default)(N,t(nt,n,r))},r);if(s.default.object(e)&&(n=e,e=""),s.default.func(n))r[e]=r[e]||[],r[e].push(n);else if(s.default.array(n))for(var d=0;d<n.length;d++){var P;P=n[d],t(e,P,r)}else if(s.default.object(n))for(var F in n){var T=f(F).map(function(N){return"".concat(e).concat(N)});t(T,n[F],r)}return r};var S={};Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0,S.default=function(t,e){return Math.sqrt(t*t+e*e)};var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(t,e){t.__set||(t.__set={});var n=function(d){if(R.some(function(P){return d.indexOf(P)===0}))return"continue";typeof t[d]!="function"&&d!=="__set"&&Object.defineProperty(t,d,{get:function(){return d in t.__set?t.__set[d]:t.__set[d]=e[d]},set:function(P){t.__set[d]=P},configurable:!0})};for(var r in e)n(r);return t};var R=["webkit","moz"],M={};function V(t){return t instanceof z.default.Event||t instanceof z.default.Touch}function et(t,e,n){return t=t||"page",(n=n||{}).x=e[t+"X"],n.y=e[t+"Y"],n}function lt(t,e){return e=e||{x:0,y:0},I.default.isOperaMobile&&V(t)?(et("screen",t,e),e.x+=window.scrollX,e.y+=window.scrollY):et("page",t,e),e}function st(t,e){return e=e||{},I.default.isOperaMobile&&V(t)?et("screen",t,e):et("client",t,e),e}function ct(t){var e=[];return s.default.array(t)?(e[0]=t[0],e[1]=t[1]):t.type==="touchend"?t.touches.length===1?(e[0]=t.touches[0],e[1]=t.changedTouches[0]):t.touches.length===0&&(e[0]=t.changedTouches[0],e[1]=t.changedTouches[1]):(e[0]=t.touches[0],e[1]=t.touches[1]),e}function Et(t){for(var e={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},n=0;n<t.length;n++){var r=t[n];for(var d in e)e[d]+=r[d]}for(var P in e)e[P]/=t.length;return e}Object.defineProperty(M,"__esModule",{value:!0}),M.coordsToEvent=function(t){return{coords:t,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}},M.copyCoords=function(t,e){t.page=t.page||{},t.page.x=e.page.x,t.page.y=e.page.y,t.client=t.client||{},t.client.x=e.client.x,t.client.y=e.client.y,t.timeStamp=e.timeStamp},M.getClientXY=st,M.getEventTargets=function(t){var e=s.default.func(t.composedPath)?t.composedPath():t.path;return[E.getActualElement(e?e[0]:t.target),E.getActualElement(t.currentTarget)]},M.getPageXY=lt,M.getPointerId=function(t){return s.default.number(t.pointerId)?t.pointerId:t.identifier},M.getPointerType=function(t){return s.default.string(t.pointerType)?t.pointerType:s.default.number(t.pointerType)?[void 0,void 0,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type||"")||t instanceof z.default.Touch?"touch":"mouse"},M.getTouchPair=ct,M.getXY=et,M.isNativePointer=V,M.newCoords=function(){return{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},M.pointerAverage=Et,Object.defineProperty(M,"pointerExtend",{enumerable:!0,get:function(){return c.default}}),M.setCoordDeltas=function(t,e,n){t.page.x=n.page.x-e.page.x,t.page.y=n.page.y-e.page.y,t.client.x=n.client.x-e.client.x,t.client.y=n.client.y-e.client.y,t.timeStamp=n.timeStamp-e.timeStamp},M.setCoordVelocity=function(t,e){var n=Math.max(e.timeStamp/1e3,.001);t.page.x=e.page.x/n,t.page.y=e.page.y/n,t.client.x=e.client.x/n,t.client.y=e.client.y/n,t.timeStamp=n},M.setCoords=function(t,e,n){var r=e.length>1?Et(e):e[0];lt(r,t.page),st(r,t.client),t.timeStamp=n},M.setZeroCoords=function(t){t.page.x=0,t.page.y=0,t.client.x=0,t.client.y=0},M.touchAngle=function(t,e){var n=e+"X",r=e+"Y",d=ct(t),P=d[1][n]-d[0][n],F=d[1][r]-d[0][r];return 180*Math.atan2(F,P)/Math.PI},M.touchBBox=function(t){if(!t.length)return null;var e=ct(t),n=Math.min(e[0].pageX,e[1].pageX),r=Math.min(e[0].pageY,e[1].pageY),d=Math.max(e[0].pageX,e[1].pageX),P=Math.max(e[0].pageY,e[1].pageY);return{x:n,y:r,left:n,top:r,right:d,bottom:P,width:d-n,height:P-r}},M.touchDistance=function(t,e){var n=e+"X",r=e+"Y",d=ct(t),P=d[0][n]-d[1][n],F=d[0][r]-d[1][r];return(0,S.default)(P,F)};var yt={};function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ct(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(yt,"__esModule",{value:!0}),yt.BaseEvent=void 0;var Ot=function(){function t(r){(function(d,P){if(!(d instanceof P))throw new TypeError("Cannot call a class as a function")})(this,t),Ct(this,"immediatePropagationStopped",!1),Ct(this,"propagationStopped",!1),this._interaction=r}var e,n;return e=t,(n=[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&vt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();yt.BaseEvent=Ot,Object.defineProperty(Ot.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.remove=xt.merge=xt.from=xt.findIndex=xt.find=xt.contains=void 0,xt.contains=function(t,e){return t.indexOf(e)!==-1},xt.remove=function(t,e){return t.splice(t.indexOf(e),1)};var Pt=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];t.push(r)}return t};xt.merge=Pt,xt.from=function(t){return Pt([],t)};var Bt=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1};xt.findIndex=Bt,xt.find=function(t,e){return t[Bt(t,e)]};var Mt={};function gt(t){return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t,e){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},bt(t,e)}function Dt(t,e){if(e&&(gt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nt(t)}function Nt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yt(t){return Yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yt(t)}function Qt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.DropEvent=void 0;var _e=function(t){(function(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),N&&bt(T,N)})(F,t);var e,n,r,d,P=(r=F,d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var T,N=Yt(r);if(d){var nt=Yt(this).constructor;T=Reflect.construct(N,arguments,nt)}else T=N.apply(this,arguments);return Dt(this,T)});function F(T,N,nt){var rt;(function(dt,At){if(!(dt instanceof At))throw new TypeError("Cannot call a class as a function")})(this,F),Qt(Nt(rt=P.call(this,N._interaction)),"dropzone",void 0),Qt(Nt(rt),"dragEvent",void 0),Qt(Nt(rt),"relatedTarget",void 0),Qt(Nt(rt),"draggable",void 0),Qt(Nt(rt),"propagationStopped",!1),Qt(Nt(rt),"immediatePropagationStopped",!1);var ut=nt==="dragleave"?T.prev:T.cur,pt=ut.element,mt=ut.dropzone;return rt.type=nt,rt.target=pt,rt.currentTarget=pt,rt.dropzone=mt,rt.dragEvent=N,rt.relatedTarget=N.target,rt.draggable=N.interactable,rt.timeStamp=N.timeStamp,rt}return e=F,(n=[{key:"reject",value:function(){var T=this,N=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&N.cur.dropzone===this.dropzone&&N.cur.element===this.target)if(N.prev.dropzone=this.dropzone,N.prev.element=this.target,N.rejected=!0,N.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var nt=N.activeDrops,rt=xt.findIndex(nt,function(pt){var mt=pt.dropzone,dt=pt.element;return mt===T.dropzone&&dt===T.target});N.activeDrops.splice(rt,1);var ut=new F(N,this.dragEvent,"dropdeactivate");ut.dropzone=this.dropzone,ut.target=this.target,this.dropzone.fire(ut)}else this.dropzone.fire(new F(N,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&ht(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),F}(yt.BaseEvent);Mt.DropEvent=_e;var Se={};function Oe(t,e){for(var n=0;n<t.slice().length;n++){var r=t.slice()[n],d=r.dropzone,P=r.element;e.dropzone=d,e.target=P,d.fire(e),e.propagationStopped=e.immediatePropagationStopped=!1}}function Pe(t,e){for(var n=function(P,F){for(var T=P.interactables,N=[],nt=0;nt<T.list.length;nt++){var rt=T.list[nt];if(rt.options.drop.enabled){var ut=rt.options.drop.accept;if(!(s.default.element(ut)&&ut!==F||s.default.string(ut)&&!E.matchesSelector(F,ut)||s.default.func(ut)&&!ut({dropzone:rt,draggableElement:F})))for(var pt=s.default.string(rt.target)?rt._context.querySelectorAll(rt.target):s.default.array(rt.target)?rt.target:[rt.target],mt=0;mt<pt.length;mt++){var dt=pt[mt];dt!==F&&N.push({dropzone:rt,element:dt,rect:rt.getRect(dt)})}}}return N}(t,e),r=0;r<n.length;r++){var d=n[r];d.rect=d.dropzone.getRect(d.element)}return n}function dn(t,e,n){for(var r=t.dropState,d=t.interactable,P=t.element,F=[],T=0;T<r.activeDrops.length;T++){var N=r.activeDrops[T],nt=N.dropzone,rt=N.element,ut=N.rect;F.push(nt.dropCheck(e,n,d,P,rt,ut)?rt:null)}var pt=E.indexOfDeepestElement(F);return r.activeDrops[pt]||null}function Qe(t,e,n){var r=t.dropState,d={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return n.type==="dragstart"&&(d.activate=new Mt.DropEvent(r,n,"dropactivate"),d.activate.target=null,d.activate.dropzone=null),n.type==="dragend"&&(d.deactivate=new Mt.DropEvent(r,n,"dropdeactivate"),d.deactivate.target=null,d.deactivate.dropzone=null),r.rejected||(r.cur.element!==r.prev.element&&(r.prev.dropzone&&(d.leave=new Mt.DropEvent(r,n,"dragleave"),n.dragLeave=d.leave.target=r.prev.element,n.prevDropzone=d.leave.dropzone=r.prev.dropzone),r.cur.dropzone&&(d.enter=new Mt.DropEvent(r,n,"dragenter"),n.dragEnter=r.cur.element,n.dropzone=r.cur.dropzone)),n.type==="dragend"&&r.cur.dropzone&&(d.drop=new Mt.DropEvent(r,n,"drop"),n.dropzone=r.cur.dropzone,n.relatedTarget=r.cur.element),n.type==="dragmove"&&r.cur.dropzone&&(d.move=new Mt.DropEvent(r,n,"dropmove"),d.move.dragmove=n,n.dropzone=r.cur.dropzone)),d}function tn(t,e){var n=t.dropState,r=n.activeDrops,d=n.cur,P=n.prev;e.leave&&P.dropzone.fire(e.leave),e.enter&&d.dropzone.fire(e.enter),e.move&&d.dropzone.fire(e.move),e.drop&&d.dropzone.fire(e.drop),e.deactivate&&Oe(r,e.deactivate),n.prev.dropzone=d.dropzone,n.prev.element=d.element}function Te(t,e){var n=t.interaction,r=t.iEvent,d=t.event;if(r.type==="dragmove"||r.type==="dragend"){var P=n.dropState;e.dynamicDrop&&(P.activeDrops=Pe(e,n.element));var F=r,T=dn(n,F,d);P.rejected=P.rejected&&!!T&&T.dropzone===P.cur.dropzone&&T.element===P.cur.element,P.cur.dropzone=T&&T.dropzone,P.cur.element=T&&T.element,P.events=Qe(n,0,F)}}Object.defineProperty(Se,"__esModule",{value:!0}),Se.default=void 0;var Ge={id:"actions/drop",install:function(t){var e=t.actions,n=t.interactStatic,r=t.Interactable,d=t.defaults;t.usePlugin(D.default),r.prototype.dropzone=function(P){return function(F,T){if(s.default.object(T)){if(F.options.drop.enabled=T.enabled!==!1,T.listeners){var N=(0,it.default)(T.listeners),nt=Object.keys(N).reduce(function(rt,ut){return rt[/^(enter|leave)/.test(ut)?"drag".concat(ut):/^(activate|deactivate|move)/.test(ut)?"drop".concat(ut):ut]=N[ut],rt},{});F.off(F.options.drop.listeners),F.on(nt),F.options.drop.listeners=nt}return s.default.func(T.ondrop)&&F.on("drop",T.ondrop),s.default.func(T.ondropactivate)&&F.on("dropactivate",T.ondropactivate),s.default.func(T.ondropdeactivate)&&F.on("dropdeactivate",T.ondropdeactivate),s.default.func(T.ondragenter)&&F.on("dragenter",T.ondragenter),s.default.func(T.ondragleave)&&F.on("dragleave",T.ondragleave),s.default.func(T.ondropmove)&&F.on("dropmove",T.ondropmove),/^(pointer|center)$/.test(T.overlap)?F.options.drop.overlap=T.overlap:s.default.number(T.overlap)&&(F.options.drop.overlap=Math.max(Math.min(1,T.overlap),0)),"accept"in T&&(F.options.drop.accept=T.accept),"checker"in T&&(F.options.drop.checker=T.checker),F}return s.default.bool(T)?(F.options.drop.enabled=T,F):F.options.drop}(this,P)},r.prototype.dropCheck=function(P,F,T,N,nt,rt){return function(ut,pt,mt,dt,At,It,kt){var Rt=!1;if(!(kt=kt||ut.getRect(It)))return!!ut.options.drop.checker&&ut.options.drop.checker(pt,mt,Rt,ut,It,dt,At);var Ut=ut.options.drop.overlap;if(Ut==="pointer"){var Xt=(0,Q.default)(dt,At,"drag"),Jt=M.getPageXY(pt);Jt.x+=Xt.x,Jt.y+=Xt.y;var ne=Jt.x>kt.left&&Jt.x<kt.right,Kt=Jt.y>kt.top&&Jt.y<kt.bottom;Rt=ne&&Kt}var ee=dt.getRect(At);if(ee&&Ut==="center"){var Ne=ee.left+ee.width/2,Je=ee.top+ee.height/2;Rt=Ne>=kt.left&&Ne<=kt.right&&Je>=kt.top&&Je<=kt.bottom}return ee&&s.default.number(Ut)&&(Rt=Math.max(0,Math.min(kt.right,ee.right)-Math.max(kt.left,ee.left))*Math.max(0,Math.min(kt.bottom,ee.bottom)-Math.max(kt.top,ee.top))/(ee.width*ee.height)>=Ut),ut.options.drop.checker&&(Rt=ut.options.drop.checker(pt,mt,Rt,ut,It,dt,At)),Rt}(this,P,F,T,N,nt,rt)},n.dynamicDrop=function(P){return s.default.bool(P)?(t.dynamicDrop=P,n):t.dynamicDrop},(0,O.default)(e.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),e.methodDict.drop="dropzone",t.dynamicDrop=!1,d.actions.drop=Ge.defaults},listeners:{"interactions:before-action-start":function(t){var e=t.interaction;e.prepared.name==="drag"&&(e.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(t,e){var n=t.interaction,r=(t.event,t.iEvent);if(n.prepared.name==="drag"){var d=n.dropState;d.activeDrops=null,d.events=null,d.activeDrops=Pe(e,n.element),d.events=Qe(n,0,r),d.events.activate&&(Oe(d.activeDrops,d.events.activate),e.fire("actions/drop:start",{interaction:n,dragEvent:r}))}},"interactions:action-move":Te,"interactions:after-action-move":function(t,e){var n=t.interaction,r=t.iEvent;n.prepared.name==="drag"&&(tn(n,n.dropState.events),e.fire("actions/drop:move",{interaction:n,dragEvent:r}),n.dropState.events={})},"interactions:action-end":function(t,e){if(t.interaction.prepared.name==="drag"){var n=t.interaction,r=t.iEvent;Te(t,e),tn(n,n.dropState.events),e.fire("actions/drop:end",{interaction:n,dragEvent:r})}},"interactions:stop":function(t){var e=t.interaction;if(e.prepared.name==="drag"){var n=e.dropState;n&&(n.activeDrops=null,n.events=null,n.cur.dropzone=null,n.cur.element=null,n.prev.dropzone=null,n.prev.element=null,n.rejected=!1)}}},getActiveDrops:Pe,getDrop:dn,getDropEvents:Qe,fireDropEvents:tn,defaults:{enabled:!1,accept:null,overlap:"pointer"}},Le=Ge;Se.default=Le;var qe={};function Ye(t){var e=t.interaction,n=t.iEvent,r=t.phase;if(e.prepared.name==="gesture"){var d=e.pointers.map(function(nt){return nt.pointer}),P=r==="start",F=r==="end",T=e.interactable.options.deltaSource;if(n.touches=[d[0],d[1]],P)n.distance=M.touchDistance(d,T),n.box=M.touchBBox(d),n.scale=1,n.ds=0,n.angle=M.touchAngle(d,T),n.da=0,e.gesture.startDistance=n.distance,e.gesture.startAngle=n.angle;else if(F){var N=e.prevEvent;n.distance=N.distance,n.box=N.box,n.scale=N.scale,n.ds=0,n.angle=N.angle,n.da=0}else n.distance=M.touchDistance(d,T),n.box=M.touchBBox(d),n.scale=n.distance/e.gesture.startDistance,n.angle=M.touchAngle(d,T),n.ds=n.scale-e.gesture.scale,n.da=n.angle-e.gesture.angle;e.gesture.distance=n.distance,e.gesture.angle=n.angle,s.default.number(n.scale)&&n.scale!==1/0&&!isNaN(n.scale)&&(e.gesture.scale=n.scale)}}Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=void 0;var Xe={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(t){var e=t.actions,n=t.Interactable,r=t.defaults;n.prototype.gesturable=function(d){return s.default.object(d)?(this.options.gesture.enabled=d.enabled!==!1,this.setPerAction("gesture",d),this.setOnEvents("gesture",d),this):s.default.bool(d)?(this.options.gesture.enabled=d,this):this.options.gesture},e.map.gesture=Xe,e.methodDict.gesture="gesturable",r.actions.gesture=Xe.defaults},listeners:{"interactions:action-start":Ye,"interactions:action-move":Ye,"interactions:action-end":Ye,"interactions:new":function(t){t.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(t){if(!(t.interaction.pointers.length<2)){var e=t.interactable.options.gesture;if(e&&e.enabled)return t.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""}},oe=Xe;qe.default=oe;var Ce={};function fe(t,e,n,r,d,P,F){if(!e)return!1;if(e===!0){var T=s.default.number(P.width)?P.width:P.right-P.left,N=s.default.number(P.height)?P.height:P.bottom-P.top;if(F=Math.min(F,Math.abs((t==="left"||t==="right"?T:N)/2)),T<0&&(t==="left"?t="right":t==="right"&&(t="left")),N<0&&(t==="top"?t="bottom":t==="bottom"&&(t="top")),t==="left"){var nt=T>=0?P.left:P.right;return n.x<nt+F}if(t==="top"){var rt=N>=0?P.top:P.bottom;return n.y<rt+F}if(t==="right")return n.x>(T>=0?P.right:P.left)-F;if(t==="bottom")return n.y>(N>=0?P.bottom:P.top)-F}return!!s.default.element(r)&&(s.default.element(e)?e===r:E.matchesUpTo(r,e,d))}function Me(t){var e=t.iEvent,n=t.interaction;if(n.prepared.name==="resize"&&n.resizeAxes){var r=e;n.interactable.options.resize.square?(n.resizeAxes==="y"?r.delta.x=r.delta.y:r.delta.y=r.delta.x,r.axes="xy"):(r.axes=n.resizeAxes,n.resizeAxes==="x"?r.delta.y=0:n.resizeAxes==="y"&&(r.delta.x=0))}}Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.default=void 0;var pe={id:"actions/resize",before:["actions/drag"],install:function(t){var e=t.actions,n=t.browser,r=t.Interactable,d=t.defaults;pe.cursors=function(P){return P.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(n),pe.defaultMargin=n.supportsTouch||n.supportsPointerEvent?20:10,r.prototype.resizable=function(P){return function(F,T,N){return s.default.object(T)?(F.options.resize.enabled=T.enabled!==!1,F.setPerAction("resize",T),F.setOnEvents("resize",T),s.default.string(T.axis)&&/^x$|^y$|^xy$/.test(T.axis)?F.options.resize.axis=T.axis:T.axis===null&&(F.options.resize.axis=N.defaults.actions.resize.axis),s.default.bool(T.preserveAspectRatio)?F.options.resize.preserveAspectRatio=T.preserveAspectRatio:s.default.bool(T.square)&&(F.options.resize.square=T.square),F):s.default.bool(T)?(F.options.resize.enabled=T,F):F.options.resize}(this,P,t)},e.map.resize=pe,e.methodDict.resize="resizable",d.actions.resize=pe.defaults},listeners:{"interactions:new":function(t){t.interaction.resizeAxes="xy"},"interactions:action-start":function(t){(function(e){var n=e.iEvent,r=e.interaction;if(r.prepared.name==="resize"&&r.prepared.edges){var d=n,P=r.rect;r._rects={start:(0,O.default)({},P),corrected:(0,O.default)({},P),previous:(0,O.default)({},P),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},d.edges=r.prepared.edges,d.rect=r._rects.corrected,d.deltaRect=r._rects.delta}})(t),Me(t)},"interactions:action-move":function(t){(function(e){var n=e.iEvent,r=e.interaction;if(r.prepared.name==="resize"&&r.prepared.edges){var d=n,P=r.interactable.options.resize.invert,F=P==="reposition"||P==="negate",T=r.rect,N=r._rects,nt=N.start,rt=N.corrected,ut=N.delta,pt=N.previous;if((0,O.default)(pt,rt),F){if((0,O.default)(rt,T),P==="reposition"){if(rt.top>rt.bottom){var mt=rt.top;rt.top=rt.bottom,rt.bottom=mt}if(rt.left>rt.right){var dt=rt.left;rt.left=rt.right,rt.right=dt}}}else rt.top=Math.min(T.top,nt.bottom),rt.bottom=Math.max(T.bottom,nt.top),rt.left=Math.min(T.left,nt.right),rt.right=Math.max(T.right,nt.left);for(var At in rt.width=rt.right-rt.left,rt.height=rt.bottom-rt.top,rt)ut[At]=rt[At]-pt[At];d.edges=r.prepared.edges,d.rect=rt,d.deltaRect=ut}})(t),Me(t)},"interactions:action-end":function(t){var e=t.iEvent,n=t.interaction;if(n.prepared.name==="resize"&&n.prepared.edges){var r=e;r.edges=n.prepared.edges,r.rect=n._rects.corrected,r.deltaRect=n._rects.delta}},"auto-start:check":function(t){var e=t.interaction,n=t.interactable,r=t.element,d=t.rect,P=t.buttons;if(d){var F=(0,O.default)({},e.coords.cur.page),T=n.options.resize;if(T&&T.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||P&T.mouseButtons)){if(s.default.object(T.edges)){var N={left:!1,right:!1,top:!1,bottom:!1};for(var nt in N)N[nt]=fe(nt,T.edges[nt],F,e._latestPointer.eventTarget,r,d,T.margin||pe.defaultMargin);N.left=N.left&&!N.right,N.top=N.top&&!N.bottom,(N.left||N.right||N.top||N.bottom)&&(t.action={name:"resize",edges:N})}else{var rt=T.axis!=="y"&&F.x>d.right-pe.defaultMargin,ut=T.axis!=="x"&&F.y>d.bottom-pe.defaultMargin;(rt||ut)&&(t.action={name:"resize",axes:(rt?"x":"")+(ut?"y":"")})}return!t.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(t){var e=t.edges,n=t.axis,r=t.name,d=pe.cursors,P=null;if(n)P=d[r+n];else if(e){for(var F="",T=["top","bottom","left","right"],N=0;N<T.length;N++){var nt=T[N];e[nt]&&(F+=nt)}P=d[F]}return P},defaultMargin:null},_t=pe;Ce.default=_t;var qt={};Object.defineProperty(qt,"__esModule",{value:!0}),qt.default=void 0;var $t={id:"actions",install:function(t){t.usePlugin(qe.default),t.usePlugin(Ce.default),t.usePlugin(D.default),t.usePlugin(Se.default)}};qt.default=$t;var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.default=void 0;var Vt,Wt,b=0,Z={request:function(t){return Vt(t)},cancel:function(t){return Wt(t)},init:function(t){if(Vt=t.requestAnimationFrame,Wt=t.cancelAnimationFrame,!Vt)for(var e=["ms","moz","webkit","o"],n=0;n<e.length;n++){var r=e[n];Vt=t["".concat(r,"RequestAnimationFrame")],Wt=t["".concat(r,"CancelAnimationFrame")]||t["".concat(r,"CancelRequestAnimationFrame")]}Vt=Vt&&Vt.bind(t),Wt=Wt&&Wt.bind(t),Vt||(Vt=function(d){var P=Date.now(),F=Math.max(0,16-(P-b)),T=t.setTimeout(function(){d(P+F)},F);return b=P+F,T},Wt=function(d){return clearTimeout(d)})}};Ft.default=Z;var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.default=void 0,G.getContainer=at,G.getScroll=ft,G.getScrollSize=function(t){return s.default.window(t)&&(t=window.document.body),{x:t.scrollWidth,y:t.scrollHeight}},G.getScrollSizeDelta=function(t,e){var n=t.interaction,r=t.element,d=n&&n.interactable.options[n.prepared.name].autoScroll;if(!d||!d.enabled)return e(),{x:0,y:0};var P=at(d.container,n.interactable,r),F=ft(P);e();var T=ft(P);return{x:T.x-F.x,y:T.y-F.y}};var J={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(t){J.isScrolling=!0,Ft.default.cancel(J.i),t.autoScroll=J,J.interaction=t,J.prevTime=J.now(),J.i=Ft.default.request(J.scroll)},stop:function(){J.isScrolling=!1,J.interaction&&(J.interaction.autoScroll=null),Ft.default.cancel(J.i)},scroll:function(){var t=J.interaction,e=t.interactable,n=t.element,r=t.prepared.name,d=e.options[r].autoScroll,P=at(d.container,e,n),F=J.now(),T=(F-J.prevTime)/1e3,N=d.speed*T;if(N>=1){var nt={x:J.x*N,y:J.y*N};if(nt.x||nt.y){var rt=ft(P);s.default.window(P)?P.scrollBy(nt.x,nt.y):P&&(P.scrollLeft+=nt.x,P.scrollTop+=nt.y);var ut=ft(P),pt={x:ut.x-rt.x,y:ut.y-rt.y};(pt.x||pt.y)&&e.fire({type:"autoscroll",target:n,interactable:e,delta:pt,interaction:t,container:P})}J.prevTime=F}J.isScrolling&&(Ft.default.cancel(J.i),J.i=Ft.default.request(J.scroll))},check:function(t,e){var n;return(n=t.options[e].autoScroll)==null?void 0:n.enabled},onInteractionMove:function(t){var e=t.interaction,n=t.pointer;if(e.interacting()&&J.check(e.interactable,e.prepared.name))if(e.simulation)J.x=J.y=0;else{var r,d,P,F,T=e.interactable,N=e.element,nt=e.prepared.name,rt=T.options[nt].autoScroll,ut=at(rt.container,T,N);if(s.default.window(ut))F=n.clientX<J.margin,r=n.clientY<J.margin,d=n.clientX>ut.innerWidth-J.margin,P=n.clientY>ut.innerHeight-J.margin;else{var pt=E.getElementClientRect(ut);F=n.clientX<pt.left+J.margin,r=n.clientY<pt.top+J.margin,d=n.clientX>pt.right-J.margin,P=n.clientY>pt.bottom-J.margin}J.x=d?1:F?-1:0,J.y=P?1:r?-1:0,J.isScrolling||(J.margin=rt.margin,J.speed=rt.speed,J.start(e))}}};function at(t,e,n){return(s.default.string(t)?(0,y.getStringOptionResult)(t,e,n):t)||(0,h.getWindow)(n)}function ft(t){return s.default.window(t)&&(t=window.document.body),{x:t.scrollLeft,y:t.scrollTop}}var St={id:"auto-scroll",install:function(t){var e=t.defaults,n=t.actions;t.autoScroll=J,J.now=function(){return t.now()},n.phaselessTypes.autoscroll=!0,e.perAction.autoScroll=J.defaults},listeners:{"interactions:new":function(t){t.interaction.autoScroll=null},"interactions:destroy":function(t){t.interaction.autoScroll=null,J.stop(),J.interaction&&(J.interaction=null)},"interactions:stop":J.stop,"interactions:action-move":function(t){return J.onInteractionMove(t)}}},Lt=St;G.default=Lt;var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.copyAction=function(t,e){return t.name=e.name,t.axis=e.axis,t.edges=e.edges,t},wt.sign=void 0,wt.warnOnce=function(t,e){var n=!1;return function(){return n||(h.window.console.warn(e),n=!0),t.apply(this,arguments)}},wt.sign=function(t){return t>=0?1:-1};var Tt={};function jt(t){return s.default.bool(t)?(this.options.styleCursor=t,this):t===null?(delete this.options.styleCursor,this):this.options.styleCursor}function Gt(t){return s.default.func(t)?(this.options.actionChecker=t,this):t===null?(delete this.options.actionChecker,this):this.options.actionChecker}Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.default=void 0;var zt={id:"auto-start/interactableMethods",install:function(t){var e=t.Interactable;e.prototype.getAction=function(n,r,d,P){var F=function(T,N,nt,rt,ut){var pt=T.getRect(rt),mt={action:null,interactable:T,interaction:nt,element:rt,rect:pt,buttons:N.buttons||{0:1,1:4,3:8,4:16}[N.button]};return ut.fire("auto-start:check",mt),mt.action}(this,r,d,P,t);return this.options.actionChecker?this.options.actionChecker(n,r,F,this,P,d):F},e.prototype.ignoreFrom=(0,wt.warnOnce)(function(n){return this._backCompatOption("ignoreFrom",n)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),e.prototype.allowFrom=(0,wt.warnOnce)(function(n){return this._backCompatOption("allowFrom",n)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),e.prototype.actionChecker=Gt,e.prototype.styleCursor=jt}};Tt.default=zt;var Ht={};function Zt(t,e,n,r,d){return e.testIgnoreAllow(e.options[t.name],n,r)&&e.options[t.name].enabled&&Ae(e,n,t,d)?t:null}function ue(t,e,n,r,d,P,F){for(var T=0,N=r.length;T<N;T++){var nt=r[T],rt=d[T],ut=nt.getAction(e,n,t,rt);if(ut){var pt=Zt(ut,nt,rt,P,F);if(pt)return{action:pt,interactable:nt,element:rt}}}return{action:null,interactable:null,element:null}}function fn(t,e,n,r,d){var P=[],F=[],T=r;function N(rt){P.push(rt),F.push(T)}for(;s.default.element(T);){P=[],F=[],d.interactables.forEachMatch(T,N);var nt=ue(t,e,n,P,F,r,d);if(nt.action&&!nt.interactable.options[nt.action.name].manualStart)return nt;T=E.parentNode(T)}return{action:null,interactable:null,element:null}}function hn(t,e,n){var r=e.action,d=e.interactable,P=e.element;r=r||{name:null},t.interactable=d,t.element=P,(0,wt.copyAction)(t.prepared,r),t.rect=d&&r.name?d.getRect(P):null,he(t,n),n.fire("autoStart:prepared",{interaction:t})}function Ae(t,e,n,r){var d=t.options,P=d[n.name].max,F=d[n.name].maxPerElement,T=r.autoStart.maxInteractions,N=0,nt=0,rt=0;if(!(P&&F&&T))return!1;for(var ut=0;ut<r.interactions.list.length;ut++){var pt=r.interactions.list[ut],mt=pt.prepared.name;if(pt.interacting()&&(++N>=T||pt.interactable===t&&((nt+=mt===n.name?1:0)>=P||pt.element===e&&(rt++,mt===n.name&&rt>=F))))return!1}return T>0}function In(t,e){return s.default.number(t)?(e.autoStart.maxInteractions=t,this):e.autoStart.maxInteractions}function Pn(t,e,n){var r=n.autoStart.cursorElement;r&&r!==t&&(r.style.cursor=""),t.ownerDocument.documentElement.style.cursor=e,t.style.cursor=e,n.autoStart.cursorElement=e?t:null}function he(t,e){var n=t.interactable,r=t.element,d=t.prepared;if(t.pointerType==="mouse"&&n&&n.options.styleCursor){var P="";if(d.name){var F=n.options[d.name].cursorChecker;P=s.default.func(F)?F(d,n,r,t._interacting):e.actions.map[d.name].getCursor(d)}Pn(t.element,P||"",e)}else e.autoStart.cursorElement&&Pn(e.autoStart.cursorElement,"",e)}Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.default=void 0;var An={id:"auto-start/base",before:["actions"],install:function(t){var e=t.interactStatic,n=t.defaults;t.usePlugin(Tt.default),n.base.actionChecker=null,n.base.styleCursor=!0,(0,O.default)(n.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),e.maxInteractions=function(r){return In(r,t)},t.autoStart={maxInteractions:1/0,withinInteractionLimit:Ae,cursorElement:null}},listeners:{"interactions:down":function(t,e){var n=t.interaction,r=t.pointer,d=t.event,P=t.eventTarget;n.interacting()||hn(n,fn(n,r,d,P,e),e)},"interactions:move":function(t,e){(function(n,r){var d=n.interaction,P=n.pointer,F=n.event,T=n.eventTarget;d.pointerType!=="mouse"||d.pointerIsDown||d.interacting()||hn(d,fn(d,P,F,T,r),r)})(t,e),function(n,r){var d=n.interaction;if(d.pointerIsDown&&!d.interacting()&&d.pointerWasMoved&&d.prepared.name){r.fire("autoStart:before-start",n);var P=d.interactable,F=d.prepared.name;F&&P&&(P.options[F].manualStart||!Ae(P,d.element,d.prepared,r)?d.stop():(d.start(d.prepared,P,d.element),he(d,r)))}}(t,e)},"interactions:stop":function(t,e){var n=t.interaction,r=n.interactable;r&&r.options.styleCursor&&Pn(n.element,"",e)}},maxInteractions:In,withinInteractionLimit:Ae,validateAction:Zt},oi=An;Ht.default=oi;var kn={};Object.defineProperty(kn,"__esModule",{value:!0}),kn.default=void 0;var ke={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(t,e){var n=t.interaction,r=t.eventTarget,d=t.dx,P=t.dy;if(n.prepared.name==="drag"){var F=Math.abs(d),T=Math.abs(P),N=n.interactable.options.drag,nt=N.startAxis,rt=F>T?"x":F<T?"y":"xy";if(n.prepared.axis=N.lockAxis==="start"?rt[0]:N.lockAxis,rt!=="xy"&&nt!=="xy"&&nt!==rt){n.prepared.name=null;for(var ut=r,pt=function(dt){if(dt!==n.interactable){var At=n.interactable.options.drag;if(!At.manualStart&&dt.testIgnoreAllow(At,ut,r)){var It=dt.getAction(n.downPointer,n.downEvent,n,ut);if(It&&It.name==="drag"&&function(kt,Rt){if(!Rt)return!1;var Ut=Rt.options.drag.startAxis;return kt==="xy"||Ut==="xy"||Ut===kt}(rt,dt)&&Ht.default.validateAction(It,dt,ut,r,e))return dt}}};s.default.element(ut);){var mt=e.interactables.forEachMatch(ut,pt);if(mt){n.prepared.name="drag",n.interactable=mt,n.element=ut;break}ut=(0,E.parentNode)(ut)}}}}}};kn.default=ke;var ce={};function en(t){var e=t.prepared&&t.prepared.name;if(!e)return null;var n=t.interactable.options;return n[e].hold||n[e].delay}Object.defineProperty(ce,"__esModule",{value:!0}),ce.default=void 0;var ze={id:"auto-start/hold",install:function(t){var e=t.defaults;t.usePlugin(Ht.default),e.perAction.hold=0,e.perAction.delay=0},listeners:{"interactions:new":function(t){t.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(t){var e=t.interaction,n=en(e);n>0&&(e.autoStartHoldTimer=setTimeout(function(){e.start(e.prepared,e.interactable,e.element)},n))},"interactions:move":function(t){var e=t.interaction,n=t.duplicate;e.autoStartHoldTimer&&e.pointerWasMoved&&!n&&(clearTimeout(e.autoStartHoldTimer),e.autoStartHoldTimer=null)},"autoStart:before-start":function(t){var e=t.interaction;en(e)>0&&(e.prepared.name=null)}},getHoldDuration:en},pn=ze;ce.default=pn;var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0;var Ue={id:"auto-start",install:function(t){t.usePlugin(Ht.default),t.usePlugin(ce.default),t.usePlugin(kn.default)}};Ee.default=Ue;var Ie={};function gn(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):s.default.bool(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault}function si(t){var e=t.interaction,n=t.event;e.interactable&&e.interactable.checkAndPreventDefault(n)}function Br(t){var e=t.Interactable;e.prototype.preventDefault=gn,e.prototype.checkAndPreventDefault=function(n){return function(r,d,P){var F=r.options.preventDefault;if(F!=="never")if(F!=="always"){if(d.events.supportsPassive&&/^touch(start|move)$/.test(P.type)){var T=(0,h.getWindow)(P.target).document,N=d.getDocOptions(T);if(!N||!N.events||N.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(P.type)||s.default.element(P.target)&&(0,E.matchesSelector)(P.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||P.preventDefault()}else P.preventDefault()}(this,t,n)},t.interactions.docEvents.push({type:"dragstart",listener:function(n){for(var r=0;r<t.interactions.list.length;r++){var d=t.interactions.list[r];if(d.element&&(d.element===n.target||(0,E.nodeContains)(d.element,n.target)))return void d.interactable.checkAndPreventDefault(n)}}})}Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.default=void 0,Ie.install=Br;var gs={id:"core/interactablePreventDefault",install:Br,listeners:["down","move","up","cancel"].reduce(function(t,e){return t["interactions:".concat(e)]=si,t},{})};Ie.default=gs;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.default=void 0,Xi.default={};var Nn,ai={};Object.defineProperty(ai,"__esModule",{value:!0}),ai.default=void 0,function(t){t.touchAction="touchAction",t.boxSizing="boxSizing",t.noListeners="noListeners"}(Nn||(Nn={})),Nn.touchAction,Nn.boxSizing,Nn.noListeners;var vs={id:"dev-tools",install:function(){}};ai.default=vs;var vn={};Object.defineProperty(vn,"__esModule",{value:!0}),vn.default=function t(e){var n={};for(var r in e){var d=e[r];s.default.plainObject(d)?n[r]=t(d):s.default.array(d)?n[r]=xt.from(d):n[r]=d}return n};var mn={};function qr(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var P,F,T=[],N=!0,nt=!1;try{for(d=d.call(n);!(N=(P=d.next()).done)&&(T.push(P.value),!r||T.length!==r);N=!0);}catch(rt){nt=!0,F=rt}finally{try{N||d.return==null||d.return()}finally{if(nt)throw F}}return T}}(t,e)||function(n,r){if(n){if(typeof n=="string")return zr(n,r);var d=Object.prototype.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?zr(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function zr(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(mn,"__esModule",{value:!0}),mn.default=void 0,mn.getRectOffset=Ur;var ys=function(){function t(r){(function(d,P){if(!(d instanceof P))throw new TypeError("Cannot call a class as a function")})(this,t),nn(this,"states",[]),nn(this,"startOffset",{left:0,right:0,top:0,bottom:0}),nn(this,"startDelta",void 0),nn(this,"result",void 0),nn(this,"endResult",void 0),nn(this,"startEdges",void 0),nn(this,"edges",void 0),nn(this,"interaction",void 0),this.interaction=r,this.result=li(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}var e,n;return e=t,(n=[{key:"start",value:function(r,d){var P=r.phase,F=this.interaction,T=function(nt){var rt=nt.interactable.options[nt.prepared.name],ut=rt.modifiers;return ut&&ut.length?ut:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(pt){var mt=rt[pt];return mt&&mt.enabled&&{options:mt,methods:mt._methods}}).filter(function(pt){return!!pt})}(F);this.prepareStates(T),this.startEdges=(0,O.default)({},F.edges),this.edges=(0,O.default)({},this.startEdges),this.startOffset=Ur(F.rect,d),this.startDelta={x:0,y:0};var N=this.fillArg({phase:P,pageCoords:d,preEnd:!1});return this.result=li(),this.startAll(N),this.result=this.setAll(N)}},{key:"fillArg",value:function(r){var d=this.interaction;return r.interaction=d,r.interactable=d.interactable,r.element=d.element,r.rect||(r.rect=d.rect),r.edges||(r.edges=this.startEdges),r.startOffset=this.startOffset,r}},{key:"startAll",value:function(r){for(var d=0;d<this.states.length;d++){var P=this.states[d];P.methods.start&&(r.state=P,P.methods.start(r))}}},{key:"setAll",value:function(r){var d=r.phase,P=r.preEnd,F=r.skipModifiers,T=r.rect,N=r.edges;r.coords=(0,O.default)({},r.pageCoords),r.rect=(0,O.default)({},T),r.edges=(0,O.default)({},N);for(var nt=F?this.states.slice(F):this.states,rt=li(r.coords,r.rect),ut=0;ut<nt.length;ut++){var pt,mt=nt[ut],dt=mt.options,At=(0,O.default)({},r.coords),It=null;(pt=mt.methods)!=null&&pt.set&&this.shouldDo(dt,P,d)&&(r.state=mt,It=mt.methods.set(r),y.addEdges(r.edges,r.rect,{x:r.coords.x-At.x,y:r.coords.y-At.y})),rt.eventProps.push(It)}(0,O.default)(this.edges,r.edges),rt.delta.x=r.coords.x-r.pageCoords.x,rt.delta.y=r.coords.y-r.pageCoords.y,rt.rectDelta.left=r.rect.left-T.left,rt.rectDelta.right=r.rect.right-T.right,rt.rectDelta.top=r.rect.top-T.top,rt.rectDelta.bottom=r.rect.bottom-T.bottom;var kt=this.result.coords,Rt=this.result.rect;if(kt&&Rt){var Ut=rt.rect.left!==Rt.left||rt.rect.right!==Rt.right||rt.rect.top!==Rt.top||rt.rect.bottom!==Rt.bottom;rt.changed=Ut||kt.x!==rt.coords.x||kt.y!==rt.coords.y}return rt}},{key:"applyToInteraction",value:function(r){var d=this.interaction,P=r.phase,F=d.coords.cur,T=d.coords.start,N=this.result,nt=this.startDelta,rt=N.delta;P==="start"&&(0,O.default)(this.startDelta,N.delta);for(var ut=0;ut<[[T,nt],[F,rt]].length;ut++){var pt=qr([[T,nt],[F,rt]][ut],2),mt=pt[0],dt=pt[1];mt.page.x+=dt.x,mt.page.y+=dt.y,mt.client.x+=dt.x,mt.client.y+=dt.y}var At=this.result.rectDelta,It=r.rect||d.rect;It.left+=At.left,It.right+=At.right,It.top+=At.top,It.bottom+=At.bottom,It.width=It.right-It.left,It.height=It.bottom-It.top}},{key:"setAndApply",value:function(r){var d=this.interaction,P=r.phase,F=r.preEnd,T=r.skipModifiers,N=this.setAll(this.fillArg({preEnd:F,phase:P,pageCoords:r.modifiedCoords||d.coords.cur.page}));if(this.result=N,!N.changed&&(!T||T<this.states.length)&&d.interacting())return!1;if(r.modifiedCoords){var nt=d.coords.cur.page,rt={x:r.modifiedCoords.x-nt.x,y:r.modifiedCoords.y-nt.y};N.coords.x+=rt.x,N.coords.y+=rt.y,N.delta.x+=rt.x,N.delta.y+=rt.y}this.applyToInteraction(r)}},{key:"beforeEnd",value:function(r){var d=r.interaction,P=r.event,F=this.states;if(F&&F.length){for(var T=!1,N=0;N<F.length;N++){var nt=F[N];r.state=nt;var rt=nt.options,ut=nt.methods,pt=ut.beforeEnd&&ut.beforeEnd(r);if(pt)return this.endResult=pt,!1;T=T||!T&&this.shouldDo(rt,!0,r.phase,!0)}T&&d.move({event:P,preEnd:!0})}}},{key:"stop",value:function(r){var d=r.interaction;if(this.states&&this.states.length){var P=(0,O.default)({states:this.states,interactable:d.interactable,element:d.element,rect:null},r);this.fillArg(P);for(var F=0;F<this.states.length;F++){var T=this.states[F];P.state=T,T.methods.stop&&T.methods.stop(P)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(r){this.states=[];for(var d=0;d<r.length;d++){var P=r[d],F=P.options,T=P.methods,N=P.name;this.states.push({options:F,methods:T,index:d,name:N})}return this.states}},{key:"restoreInteractionCoords",value:function(r){var d=r.interaction,P=d.coords,F=d.rect,T=d.modification;if(T.result){for(var N=T.startDelta,nt=T.result,rt=nt.delta,ut=nt.rectDelta,pt=[[P.start,N],[P.cur,rt]],mt=0;mt<pt.length;mt++){var dt=qr(pt[mt],2),At=dt[0],It=dt[1];At.page.x-=It.x,At.page.y-=It.y,At.client.x-=It.x,At.client.y-=It.y}F.left-=ut.left,F.right-=ut.right,F.top-=ut.top,F.bottom-=ut.bottom}}},{key:"shouldDo",value:function(r,d,P,F){return!(!r||r.enabled===!1||F&&!r.endOnly||r.endOnly&&!d||P==="start"&&!r.setStart)}},{key:"copyFrom",value:function(r){this.startOffset=r.startOffset,this.startDelta=r.startDelta,this.startEdges=r.startEdges,this.edges=r.edges,this.states=r.states.map(function(d){return(0,vn.default)(d)}),this.result=li((0,O.default)({},r.result.coords),(0,O.default)({},r.result.rect))}},{key:"destroy",value:function(){for(var r in this)this[r]=null}}])&&ms(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function li(t,e){return{rect:e,coords:t,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Ur(t,e){return t?{left:e.x-t.left,top:e.y-t.top,right:t.right-e.x,bottom:t.bottom-e.y}:{left:0,top:0,right:0,bottom:0}}mn.default=ys;var ve={};function ui(t){var e=t.iEvent,n=t.interaction.modification.result;n&&(e.modifiers=n.eventProps)}Object.defineProperty(ve,"__esModule",{value:!0}),ve.addEventModifiers=ui,ve.default=void 0,ve.makeModifier=function(t,e){var n=t.defaults,r={start:t.start,set:t.set,beforeEnd:t.beforeEnd,stop:t.stop},d=function(P){var F=P||{};for(var T in F.enabled=F.enabled!==!1,n)T in F||(F[T]=n[T]);var N={options:F,methods:r,name:e,enable:function(){return F.enabled=!0,N},disable:function(){return F.enabled=!1,N}};return N};return e&&typeof e=="string"&&(d._defaults=n,d._methods=r),d};var bs={id:"modifiers/base",before:["actions"],install:function(t){t.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(t){var e=t.interaction;e.modification=new mn.default(e)},"interactions:before-action-start":function(t){var e=t.interaction,n=t.interaction.modification;n.start(t,e.coords.start.page),e.edges=n.edges,n.applyToInteraction(t)},"interactions:before-action-move":function(t){var e=t.interaction,n=e.modification,r=n.setAndApply(t);return e.edges=n.edges,r},"interactions:before-action-end":function(t){var e=t.interaction,n=e.modification,r=n.beforeEnd(t);return e.edges=n.startEdges,r},"interactions:action-start":ui,"interactions:action-move":ui,"interactions:action-end":ui,"interactions:after-action-start":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-move":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:stop":function(t){return t.interaction.modification.stop(t)}}},_s=bs;ve.default=_s;var Fn={};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.defaults=void 0,Fn.defaults={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}};var Rn={};function Wi(t){return Wi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wi(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ki(t,e){return Ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ki(t,e)}function Es(t,e){if(e&&(Wi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return te(t)}function te(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ci(t){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ci(t)}function se(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.InteractEvent=void 0;var Vr=function(t){(function(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),N&&Ki(T,N)})(F,t);var e,n,r,d,P=(r=F,d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var T,N=ci(r);if(d){var nt=ci(this).constructor;T=Reflect.construct(N,arguments,nt)}else T=N.apply(this,arguments);return Es(this,T)});function F(T,N,nt,rt,ut,pt,mt){var dt;(function(ne,Kt){if(!(ne instanceof Kt))throw new TypeError("Cannot call a class as a function")})(this,F),se(te(dt=P.call(this,T)),"relatedTarget",null),se(te(dt),"screenX",void 0),se(te(dt),"screenY",void 0),se(te(dt),"button",void 0),se(te(dt),"buttons",void 0),se(te(dt),"ctrlKey",void 0),se(te(dt),"shiftKey",void 0),se(te(dt),"altKey",void 0),se(te(dt),"metaKey",void 0),se(te(dt),"page",void 0),se(te(dt),"client",void 0),se(te(dt),"delta",void 0),se(te(dt),"rect",void 0),se(te(dt),"x0",void 0),se(te(dt),"y0",void 0),se(te(dt),"t0",void 0),se(te(dt),"dt",void 0),se(te(dt),"duration",void 0),se(te(dt),"clientX0",void 0),se(te(dt),"clientY0",void 0),se(te(dt),"velocity",void 0),se(te(dt),"speed",void 0),se(te(dt),"swipe",void 0),se(te(dt),"axes",void 0),se(te(dt),"preEnd",void 0),ut=ut||T.element;var At=T.interactable,It=(At&&At.options||Fn.defaults).deltaSource,kt=(0,Q.default)(At,ut,nt),Rt=rt==="start",Ut=rt==="end",Xt=Rt?te(dt):T.prevEvent,Jt=Rt?T.coords.start:Ut?{page:Xt.page,client:Xt.client,timeStamp:T.coords.cur.timeStamp}:T.coords.cur;return dt.page=(0,O.default)({},Jt.page),dt.client=(0,O.default)({},Jt.client),dt.rect=(0,O.default)({},T.rect),dt.timeStamp=Jt.timeStamp,Ut||(dt.page.x-=kt.x,dt.page.y-=kt.y,dt.client.x-=kt.x,dt.client.y-=kt.y),dt.ctrlKey=N.ctrlKey,dt.altKey=N.altKey,dt.shiftKey=N.shiftKey,dt.metaKey=N.metaKey,dt.button=N.button,dt.buttons=N.buttons,dt.target=ut,dt.currentTarget=ut,dt.preEnd=pt,dt.type=mt||nt+(rt||""),dt.interactable=At,dt.t0=Rt?T.pointers[T.pointers.length-1].downTime:Xt.t0,dt.x0=T.coords.start.page.x-kt.x,dt.y0=T.coords.start.page.y-kt.y,dt.clientX0=T.coords.start.client.x-kt.x,dt.clientY0=T.coords.start.client.y-kt.y,dt.delta=Rt||Ut?{x:0,y:0}:{x:dt[It].x-Xt[It].x,y:dt[It].y-Xt[It].y},dt.dt=T.coords.delta.timeStamp,dt.duration=dt.timeStamp-dt.t0,dt.velocity=(0,O.default)({},T.coords.velocity[It]),dt.speed=(0,S.default)(dt.velocity.x,dt.velocity.y),dt.swipe=Ut||rt==="inertiastart"?dt.getSwipe():null,dt}return e=F,(n=[{key:"getSwipe",value:function(){var T=this._interaction;if(T.prevEvent.speed<600||this.timeStamp-T.prevEvent.timeStamp>150)return null;var N=180*Math.atan2(T.prevEvent.velocityY,T.prevEvent.velocityX)/Math.PI;N<0&&(N+=360);var nt=112.5<=N&&N<247.5,rt=202.5<=N&&N<337.5;return{up:rt,down:!rt&&22.5<=N&&N<157.5,left:nt,right:!nt&&(292.5<=N||N<67.5),angle:N,speed:T.prevEvent.speed,velocity:{x:T.prevEvent.velocityX,y:T.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&Ss(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),F}(yt.BaseEvent);Rn.InteractEvent=Vr,Object.defineProperties(Vr.prototype,{pageX:{get:function(){return this.page.x},set:function(t){this.page.x=t}},pageY:{get:function(){return this.page.y},set:function(t){this.page.y=t}},clientX:{get:function(){return this.client.x},set:function(t){this.client.x=t}},clientY:{get:function(){return this.client.y},set:function(t){this.client.y=t}},dx:{get:function(){return this.delta.x},set:function(t){this.delta.x=t}},dy:{get:function(){return this.delta.y},set:function(t){this.delta.y=t}},velocityX:{get:function(){return this.velocity.x},set:function(t){this.velocity.x=t}},velocityY:{get:function(){return this.velocity.y},set:function(t){this.velocity.y=t}}});var Bn={};function Hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ws(t,e,n){return e&&Hr(t.prototype,e),n&&Hr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.PointerInfo=void 0;var Cs=ws(function t(e,n,r,d,P){(function(F,T){if(!(F instanceof T))throw new TypeError("Cannot call a class as a function")})(this,t),qn(this,"id",void 0),qn(this,"pointer",void 0),qn(this,"event",void 0),qn(this,"downTime",void 0),qn(this,"downTarget",void 0),this.id=e,this.pointer=n,this.event=r,this.downTime=d,this.downTarget=P});Bn.PointerInfo=Cs;var di,fi,De={};function xs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ae(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(De,"__esModule",{value:!0}),De.Interaction=void 0,Object.defineProperty(De,"PointerInfo",{enumerable:!0,get:function(){return Bn.PointerInfo}}),De.default=De._ProxyValues=De._ProxyMethods=void 0,De._ProxyValues=di,function(t){t.interactable="",t.element="",t.prepared="",t.pointerIsDown="",t.pointerWasMoved="",t._proxy=""}(di||(De._ProxyValues=di={})),De._ProxyMethods=fi,function(t){t.start="",t.move="",t.end="",t.stop="",t.interacting=""}(fi||(De._ProxyMethods=fi={}));var Ps=0,$r=function(){function t(r){var d=this,P=r.pointerType,F=r.scopeFire;(function(pt,mt){if(!(pt instanceof mt))throw new TypeError("Cannot call a class as a function")})(this,t),ae(this,"interactable",null),ae(this,"element",null),ae(this,"rect",null),ae(this,"_rects",void 0),ae(this,"edges",null),ae(this,"_scopeFire",void 0),ae(this,"prepared",{name:null,axis:null,edges:null}),ae(this,"pointerType",void 0),ae(this,"pointers",[]),ae(this,"downEvent",null),ae(this,"downPointer",{}),ae(this,"_latestPointer",{pointer:null,event:null,eventTarget:null}),ae(this,"prevEvent",null),ae(this,"pointerIsDown",!1),ae(this,"pointerWasMoved",!1),ae(this,"_interacting",!1),ae(this,"_ending",!1),ae(this,"_stopped",!0),ae(this,"_proxy",null),ae(this,"simulation",null),ae(this,"doMove",(0,wt.warnOnce)(function(pt){this.move(pt)},"The interaction.doMove() method has been renamed to interaction.move()")),ae(this,"coords",{start:M.newCoords(),prev:M.newCoords(),cur:M.newCoords(),delta:M.newCoords(),velocity:M.newCoords()}),ae(this,"_id",Ps++),this._scopeFire=F,this.pointerType=P;var T=this;this._proxy={};var N=function(pt){Object.defineProperty(d._proxy,pt,{get:function(){return T[pt]}})};for(var nt in di)N(nt);var rt=function(pt){Object.defineProperty(d._proxy,pt,{value:function(){return T[pt].apply(T,arguments)}})};for(var ut in fi)rt(ut);this._scopeFire("interactions:new",{interaction:this})}var e,n;return e=t,n=[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(r,d,P){var F=this.updatePointer(r,d,P,!0),T=this.pointers[F];this._scopeFire("interactions:down",{pointer:r,event:d,eventTarget:P,pointerIndex:F,pointerInfo:T,type:"down",interaction:this})}},{key:"start",value:function(r,d,P){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(r.name==="gesture"?2:1)||!d.options[r.name].enabled)&&((0,wt.copyAction)(this.prepared,r),this.interactable=d,this.element=P,this.rect=d.getRect(P),this.edges=this.prepared.edges?(0,O.default)({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(r,d,P){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(r,d,P,!1);var F,T,N=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(F=this.coords.cur.client.x-this.coords.start.client.x,T=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=(0,S.default)(F,T)>this.pointerMoveTolerance);var nt=this.getPointerIndex(r),rt={pointer:r,pointerIndex:nt,pointerInfo:this.pointers[nt],event:d,type:"move",eventTarget:P,dx:F,dy:T,duplicate:N,interaction:this};N||M.setCoordVelocity(this.coords.velocity,this.coords.delta),this._scopeFire("interactions:move",rt),N||this.simulation||(this.interacting()&&(rt.type=null,this.move(rt)),this.pointerWasMoved&&M.copyCoords(this.coords.prev,this.coords.cur))}},{key:"move",value:function(r){r&&r.event||M.setZeroCoords(this.coords.delta),(r=(0,O.default)({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},r||{})).phase="move",this._doPhase(r)}},{key:"pointerUp",value:function(r,d,P,F){var T=this.getPointerIndex(r);T===-1&&(T=this.updatePointer(r,d,P,!1));var N=/cancel$/i.test(d.type)?"cancel":"up";this._scopeFire("interactions:".concat(N),{pointer:r,pointerIndex:T,pointerInfo:this.pointers[T],event:d,eventTarget:P,type:N,curEventTarget:F,interaction:this}),this.simulation||this.end(d),this.removePointer(r,d)}},{key:"documentBlur",value:function(r){this.end(r),this._scopeFire("interactions:blur",{event:r,type:"blur",interaction:this})}},{key:"end",value:function(r){var d;this._ending=!0,r=r||this._latestPointer.event,this.interacting()&&(d=this._doPhase({event:r,interaction:this,phase:"end"})),this._ending=!1,d===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(r){var d=M.getPointerId(r);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:xt.findIndex(this.pointers,function(P){return P.id===d})}},{key:"getPointerInfo",value:function(r){return this.pointers[this.getPointerIndex(r)]}},{key:"updatePointer",value:function(r,d,P,F){var T=M.getPointerId(r),N=this.getPointerIndex(r),nt=this.pointers[N];return F=F!==!1&&(F||/(down|start)$/i.test(d.type)),nt?nt.pointer=r:(nt=new Bn.PointerInfo(T,r,d,null,null),N=this.pointers.length,this.pointers.push(nt)),M.setCoords(this.coords.cur,this.pointers.map(function(rt){return rt.pointer}),this._now()),M.setCoordDeltas(this.coords.delta,this.coords.prev,this.coords.cur),F&&(this.pointerIsDown=!0,nt.downTime=this.coords.cur.timeStamp,nt.downTarget=P,M.pointerExtend(this.downPointer,r),this.interacting()||(M.copyCoords(this.coords.start,this.coords.cur),M.copyCoords(this.coords.prev,this.coords.cur),this.downEvent=d,this.pointerWasMoved=!1)),this._updateLatestPointer(r,d,P),this._scopeFire("interactions:update-pointer",{pointer:r,event:d,eventTarget:P,down:F,pointerInfo:nt,pointerIndex:N,interaction:this}),N}},{key:"removePointer",value:function(r,d){var P=this.getPointerIndex(r);if(P!==-1){var F=this.pointers[P];this._scopeFire("interactions:remove-pointer",{pointer:r,event:d,eventTarget:null,pointerIndex:P,pointerInfo:F,interaction:this}),this.pointers.splice(P,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(r,d,P){this._latestPointer.pointer=r,this._latestPointer.event=d,this._latestPointer.eventTarget=P}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(r,d,P,F){return new Rn.InteractEvent(this,r,this.prepared.name,d,this.element,P,F)}},{key:"_fireEvent",value:function(r){var d;(d=this.interactable)==null||d.fire(r),(!this.prevEvent||r.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=r)}},{key:"_doPhase",value:function(r){var d=r.event,P=r.phase,F=r.preEnd,T=r.type,N=this.rect;if(N&&P==="move"&&(y.addEdges(this.edges,N,this.coords.delta[this.interactable.options.deltaSource]),N.width=N.right-N.left,N.height=N.bottom-N.top),this._scopeFire("interactions:before-action-".concat(P),r)===!1)return!1;var nt=r.iEvent=this._createPreparedEvent(d,P,F,T);return this._scopeFire("interactions:action-".concat(P),r),P==="start"&&(this.prevEvent=nt),this._fireEvent(nt),this._scopeFire("interactions:after-action-".concat(P),r),!0}},{key:"_now",value:function(){return Date.now()}}],n&&xs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();De.Interaction=$r;var As=$r;De.default=As;var rn={};function Gr(t){t.pointerIsDown&&(Zi(t.coords.cur,t.offset.total),t.offset.pending.x=0,t.offset.pending.y=0)}function Yr(t){Ji(t.interaction)}function Ji(t){if(!function(n){return!(!n.offset.pending.x&&!n.offset.pending.y)}(t))return!1;var e=t.offset.pending;return Zi(t.coords.cur,e),Zi(t.coords.delta,e),y.addEdges(t.edges,t.rect,e),e.x=0,e.y=0,!0}function ks(t){var e=t.x,n=t.y;this.offset.pending.x+=e,this.offset.pending.y+=n,this.offset.total.x+=e,this.offset.total.y+=n}function Zi(t,e){var n=t.page,r=t.client,d=e.x,P=e.y;n.x+=d,n.y+=P,r.x+=d,r.y+=P}Object.defineProperty(rn,"__esModule",{value:!0}),rn.addTotal=Gr,rn.applyPending=Ji,rn.default=void 0,De._ProxyMethods.offsetBy="";var Ds={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(t){t.Interaction.prototype.offsetBy=ks},listeners:{"interactions:new":function(t){t.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(t){return Gr(t.interaction)},"interactions:before-action-start":Yr,"interactions:before-action-move":Yr,"interactions:before-action-end":function(t){var e=t.interaction;if(Ji(e))return e.move({offset:!0}),e.end(),!1},"interactions:stop":function(t){var e=t.interaction;e.offset.total.x=0,e.offset.total.y=0,e.offset.pending.x=0,e.offset.pending.y=0}}},Os=Ds;rn.default=Os;var yn={};function Ts(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(yn,"__esModule",{value:!0}),yn.default=yn.InertiaState=void 0;var Xr=function(){function t(r){(function(d,P){if(!(d instanceof P))throw new TypeError("Cannot call a class as a function")})(this,t),ge(this,"active",!1),ge(this,"isModified",!1),ge(this,"smoothEnd",!1),ge(this,"allowResume",!1),ge(this,"modification",void 0),ge(this,"modifierCount",0),ge(this,"modifierArg",void 0),ge(this,"startCoords",void 0),ge(this,"t0",0),ge(this,"v0",0),ge(this,"te",0),ge(this,"targetOffset",void 0),ge(this,"modifiedOffset",void 0),ge(this,"currentOffset",void 0),ge(this,"lambda_v0",0),ge(this,"one_ve_v0",0),ge(this,"timeout",void 0),ge(this,"interaction",void 0),this.interaction=r}var e,n;return e=t,(n=[{key:"start",value:function(r){var d=this.interaction,P=hi(d);if(!P||!P.enabled)return!1;var F=d.coords.velocity.client,T=(0,S.default)(F.x,F.y),N=this.modification||(this.modification=new mn.default(d));if(N.copyFrom(d.modification),this.t0=d._now(),this.allowResume=P.allowResume,this.v0=T,this.currentOffset={x:0,y:0},this.startCoords=d.coords.cur.page,this.modifierArg=N.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-d.coords.cur.timeStamp<50&&T>P.minSpeed&&T>P.endSpeed)this.startInertia();else{if(N.result=N.setAll(this.modifierArg),!N.result.changed)return!1;this.startSmoothEnd()}return d.modification.result.rect=null,d.offsetBy(this.targetOffset),d._doPhase({interaction:d,event:r,phase:"inertiastart"}),d.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),d.modification.result.rect=null,this.active=!0,d.simulation=this,!0}},{key:"startInertia",value:function(){var r=this,d=this.interaction.coords.velocity.client,P=hi(this.interaction),F=P.resistance,T=-Math.log(P.endSpeed/this.v0)/F;this.targetOffset={x:(d.x-T)/F,y:(d.y-T)/F},this.te=T,this.lambda_v0=F/this.v0,this.one_ve_v0=1-P.endSpeed/this.v0;var N=this.modification,nt=this.modifierArg;nt.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},N.result=N.setAll(nt),N.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+N.result.delta.x,y:this.targetOffset.y+N.result.delta.y}),this.onNextFrame(function(){return r.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var r=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return r.smoothEndTick()})}},{key:"onNextFrame",value:function(r){var d=this;this.timeout=Ft.default.request(function(){d.active&&r()})}},{key:"inertiaTick",value:function(){var r,d,P,F,T,N=this,nt=this.interaction,rt=hi(nt).resistance,ut=(nt._now()-this.t0)/1e3;if(ut<this.te){var pt,mt=1-(Math.exp(-rt*ut)-this.lambda_v0)/this.one_ve_v0;this.isModified?(r=this.targetOffset.x,d=this.targetOffset.y,P=this.modifiedOffset.x,F=this.modifiedOffset.y,pt={x:Wr(T=mt,0,r,P),y:Wr(T,0,d,F)}):pt={x:this.targetOffset.x*mt,y:this.targetOffset.y*mt};var dt={x:pt.x-this.currentOffset.x,y:pt.y-this.currentOffset.y};this.currentOffset.x+=dt.x,this.currentOffset.y+=dt.y,nt.offsetBy(dt),nt.move(),this.onNextFrame(function(){return N.inertiaTick()})}else nt.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var r=this,d=this.interaction,P=d._now()-this.t0,F=hi(d).smoothEndDuration;if(P<F){var T={x:Kr(P,0,this.targetOffset.x,F),y:Kr(P,0,this.targetOffset.y,F)},N={x:T.x-this.currentOffset.x,y:T.y-this.currentOffset.y};this.currentOffset.x+=N.x,this.currentOffset.y+=N.y,d.offsetBy(N),d.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return r.smoothEndTick()})}else d.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(r){var d=r.pointer,P=r.event,F=r.eventTarget,T=this.interaction;T.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),T.updatePointer(d,P,F,!0),T._doPhase({interaction:T,event:P,phase:"resume"}),(0,M.copyCoords)(T.coords.prev,T.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Ft.default.cancel(this.timeout)}}])&&Ts(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function hi(t){var e=t.interactable,n=t.prepared;return e&&e.options&&n.name&&e.options[n.name].inertia}yn.InertiaState=Xr;var Ms={id:"inertia",before:["modifiers","actions"],install:function(t){var e=t.defaults;t.usePlugin(rn.default),t.usePlugin(ve.default),t.actions.phases.inertiastart=!0,t.actions.phases.resume=!0,e.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(t){var e=t.interaction;e.inertia=new Xr(e)},"interactions:before-action-end":function(t){var e=t.interaction,n=t.event;return(!e._interacting||e.simulation||!e.inertia.start(n))&&null},"interactions:down":function(t){var e=t.interaction,n=t.eventTarget,r=e.inertia;if(r.active)for(var d=n;s.default.element(d);){if(d===e.element){r.resume(t);break}d=E.parentNode(d)}},"interactions:stop":function(t){var e=t.interaction.inertia;e.active&&e.stop()},"interactions:before-action-resume":function(t){var e=t.interaction.modification;e.stop(t),e.start(t,t.interaction.coords.cur.page),e.applyToInteraction(t)},"interactions:before-action-inertiastart":function(t){return t.interaction.modification.setAndApply(t)},"interactions:action-resume":ve.addEventModifiers,"interactions:action-inertiastart":ve.addEventModifiers,"interactions:after-action-inertiastart":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-resume":function(t){return t.interaction.modification.restoreInteractionCoords(t)}}};function Wr(t,e,n,r){var d=1-t;return d*d*e+2*d*t*n+t*t*r}function Kr(t,e,n,r){return-n*(t/=r)*(t-2)+e}var js=Ms;yn.default=js;var zn={};function Ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Un(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(t.immediatePropagationStopped)break;r(t)}}Object.defineProperty(zn,"__esModule",{value:!0}),zn.Eventable=void 0;var Is=function(){function t(r){(function(d,P){if(!(d instanceof P))throw new TypeError("Cannot call a class as a function")})(this,t),Un(this,"options",void 0),Un(this,"types",{}),Un(this,"propagationStopped",!1),Un(this,"immediatePropagationStopped",!1),Un(this,"global",void 0),this.options=(0,O.default)({},r||{})}var e,n;return e=t,(n=[{key:"fire",value:function(r){var d,P=this.global;(d=this.types[r.type])&&Jr(r,d),!r.propagationStopped&&P&&(d=P[r.type])&&Jr(r,d)}},{key:"on",value:function(r,d){var P=(0,it.default)(r,d);for(r in P)this.types[r]=xt.merge(this.types[r]||[],P[r])}},{key:"off",value:function(r,d){var P=(0,it.default)(r,d);for(r in P){var F=this.types[r];if(F&&F.length)for(var T=0;T<P[r].length;T++){var N=P[r][T],nt=F.indexOf(N);nt!==-1&&F.splice(nt,1)}}}},{key:"getRect",value:function(r){return null}}])&&Ls(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();zn.Eventable=Is;var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.default=function(t,e){if(e.phaselessTypes[t])return!0;for(var n in e.map)if(t.indexOf(n)===0&&t.substr(n.length)in e.phases)return!0;return!1};var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.createInteractStatic=function(t){var e=function n(r,d){var P=t.interactables.get(r,d);return P||((P=t.interactables.new(r,d)).events.global=n.globalEvents),P};return e.getPointerAverage=M.pointerAverage,e.getTouchBBox=M.touchBBox,e.getTouchDistance=M.touchDistance,e.getTouchAngle=M.touchAngle,e.getElementRect=E.getElementRect,e.getElementClientRect=E.getElementClientRect,e.matchesSelector=E.matchesSelector,e.closest=E.closest,e.globalEvents={},e.version="1.10.19",e.scope=t,e.use=function(n,r){return this.scope.usePlugin(n,r),this},e.isSet=function(n,r){return!!this.scope.interactables.get(n,r&&r.context)},e.on=(0,wt.warnOnce)(function(n,r,d){if(s.default.string(n)&&n.search(" ")!==-1&&(n=n.trim().split(/ +/)),s.default.array(n)){for(var P=0;P<n.length;P++){var F=n[P];this.on(F,r,d)}return this}if(s.default.object(n)){for(var T in n)this.on(T,n[T],r);return this}return(0,Vn.default)(n,this.scope.actions)?this.globalEvents[n]?this.globalEvents[n].push(r):this.globalEvents[n]=[r]:this.scope.events.add(this.scope.document,n,r,{options:d}),this},"The interact.on() method is being deprecated"),e.off=(0,wt.warnOnce)(function(n,r,d){if(s.default.string(n)&&n.search(" ")!==-1&&(n=n.trim().split(/ +/)),s.default.array(n)){for(var P=0;P<n.length;P++){var F=n[P];this.off(F,r,d)}return this}if(s.default.object(n)){for(var T in n)this.off(T,n[T],r);return this}var N;return(0,Vn.default)(n,this.scope.actions)?n in this.globalEvents&&(N=this.globalEvents[n].indexOf(r))!==-1&&this.globalEvents[n].splice(N,1):this.scope.events.remove(this.scope.document,n,r,d),this},"The interact.off() method is being deprecated"),e.debug=function(){return this.scope},e.supportsTouch=function(){return I.default.supportsTouch},e.supportsPointerEvent=function(){return I.default.supportsPointerEvent},e.stop=function(){for(var n=0;n<this.scope.interactions.list.length;n++)this.scope.interactions.list[n].stop();return this},e.pointerMoveTolerance=function(n){return s.default.number(n)?(this.scope.interactions.pointerMoveTolerance=n,this):this.scope.interactions.pointerMoveTolerance},e.addDocument=function(n,r){this.scope.addDocument(n,r)},e.removeDocument=function(n){this.scope.removeDocument(n)},e};var pi={};function Ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function We(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(pi,"__esModule",{value:!0}),pi.Interactable=void 0;var Fs=function(){function t(r,d,P,F){(function(T,N){if(!(T instanceof N))throw new TypeError("Cannot call a class as a function")})(this,t),We(this,"options",void 0),We(this,"_actions",void 0),We(this,"target",void 0),We(this,"events",new zn.Eventable),We(this,"_context",void 0),We(this,"_win",void 0),We(this,"_doc",void 0),We(this,"_scopeEvents",void 0),We(this,"_rectChecker",void 0),this._actions=d.actions,this.target=r,this._context=d.context||P,this._win=(0,h.getWindow)((0,E.trySelector)(r)?this._context:r),this._doc=this._win.document,this._scopeEvents=F,this.set(d)}var e,n;return e=t,(n=[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(r,d){return s.default.func(d.onstart)&&this.on("".concat(r,"start"),d.onstart),s.default.func(d.onmove)&&this.on("".concat(r,"move"),d.onmove),s.default.func(d.onend)&&this.on("".concat(r,"end"),d.onend),s.default.func(d.oninertiastart)&&this.on("".concat(r,"inertiastart"),d.oninertiastart),this}},{key:"updatePerActionListeners",value:function(r,d,P){(s.default.array(d)||s.default.object(d))&&this.off(r,d),(s.default.array(P)||s.default.object(P))&&this.on(r,P)}},{key:"setPerAction",value:function(r,d){var P=this._defaults;for(var F in d){var T=F,N=this.options[r],nt=d[T];T==="listeners"&&this.updatePerActionListeners(r,N.listeners,nt),s.default.array(nt)?N[T]=xt.from(nt):s.default.plainObject(nt)?(N[T]=(0,O.default)(N[T]||{},(0,vn.default)(nt)),s.default.object(P.perAction[T])&&"enabled"in P.perAction[T]&&(N[T].enabled=nt.enabled!==!1)):s.default.bool(nt)&&s.default.object(P.perAction[T])?N[T].enabled=nt:N[T]=nt}}},{key:"getRect",value:function(r){return r=r||(s.default.element(this.target)?this.target:null),s.default.string(this.target)&&(r=r||this._context.querySelector(this.target)),(0,E.getElementRect)(r)}},{key:"rectChecker",value:function(r){var d=this;return s.default.func(r)?(this._rectChecker=r,this.getRect=function(P){var F=(0,O.default)({},d._rectChecker(P));return"width"in F||(F.width=F.right-F.left,F.height=F.bottom-F.top),F},this):r===null?(delete this.getRect,delete this._rectChecker,this):this.getRect}},{key:"_backCompatOption",value:function(r,d){if((0,E.trySelector)(d)||s.default.object(d)){for(var P in this.options[r]=d,this._actions.map)this.options[P][r]=d;return this}return this.options[r]}},{key:"origin",value:function(r){return this._backCompatOption("origin",r)}},{key:"deltaSource",value:function(r){return r==="page"||r==="client"?(this.options.deltaSource=r,this):this.options.deltaSource}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(r){return this._context===r.ownerDocument||(0,E.nodeContains)(this._context,r)}},{key:"testIgnoreAllow",value:function(r,d,P){return!this.testIgnore(r.ignoreFrom,d,P)&&this.testAllow(r.allowFrom,d,P)}},{key:"testAllow",value:function(r,d,P){return!r||!!s.default.element(P)&&(s.default.string(r)?(0,E.matchesUpTo)(P,r,d):!!s.default.element(r)&&(0,E.nodeContains)(r,P))}},{key:"testIgnore",value:function(r,d,P){return!(!r||!s.default.element(P))&&(s.default.string(r)?(0,E.matchesUpTo)(P,r,d):!!s.default.element(r)&&(0,E.nodeContains)(r,P))}},{key:"fire",value:function(r){return this.events.fire(r),this}},{key:"_onOff",value:function(r,d,P,F){s.default.object(d)&&!s.default.array(d)&&(F=P,P=null);var T=r==="on"?"add":"remove",N=(0,it.default)(d,P);for(var nt in N){nt==="wheel"&&(nt=I.default.wheelEvent);for(var rt=0;rt<N[nt].length;rt++){var ut=N[nt][rt];(0,Vn.default)(nt,this._actions)?this.events[r](nt,ut):s.default.string(this.target)?this._scopeEvents["".concat(T,"Delegate")](this.target,this._context,nt,ut,F):this._scopeEvents[T](this.target,nt,ut,F)}}return this}},{key:"on",value:function(r,d,P){return this._onOff("on",r,d,P)}},{key:"off",value:function(r,d,P){return this._onOff("off",r,d,P)}},{key:"set",value:function(r){var d=this._defaults;for(var P in s.default.object(r)||(r={}),this.options=(0,vn.default)(d.base),this._actions.methodDict){var F=P,T=this._actions.methodDict[F];this.options[F]={},this.setPerAction(F,(0,O.default)((0,O.default)({},d.perAction),d.actions[F])),this[T](r[F])}for(var N in r)s.default.func(this[N])&&this[N](r[N]);return this}},{key:"unset",value:function(){if(s.default.string(this.target))for(var r in this._scopeEvents.delegatedEvents)for(var d=this._scopeEvents.delegatedEvents[r],P=d.length-1;P>=0;P--){var F=d[P],T=F.selector,N=F.context,nt=F.listeners;T===this.target&&N===this._context&&d.splice(P,1);for(var rt=nt.length-1;rt>=0;rt--)this._scopeEvents.removeDelegate(this.target,this._context,r,nt[rt][0],nt[rt][1])}else this._scopeEvents.remove(this.target,"all")}}])&&Ns(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();pi.Interactable=Fs;var gi={};function Rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(gi,"__esModule",{value:!0}),gi.InteractableSet=void 0;var Bs=function(){function t(r){var d=this;(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,t),tr(this,"list",[]),tr(this,"selectorMap",{}),tr(this,"scope",void 0),this.scope=r,r.addListeners({"interactable:unset":function(P){var F=P.interactable,T=F.target,N=F._context,nt=s.default.string(T)?d.selectorMap[T]:T[d.scope.id],rt=xt.findIndex(nt,function(ut){return ut.context===N});nt[rt]&&(nt[rt].context=null,nt[rt].interactable=null),nt.splice(rt,1)}})}var e,n;return e=t,(n=[{key:"new",value:function(r,d){d=(0,O.default)(d||{},{actions:this.scope.actions});var P=new this.scope.Interactable(r,d,this.scope.document,this.scope.events),F={context:P._context,interactable:P};return this.scope.addDocument(P._doc),this.list.push(P),s.default.string(r)?(this.selectorMap[r]||(this.selectorMap[r]=[]),this.selectorMap[r].push(F)):(P.target[this.scope.id]||Object.defineProperty(r,this.scope.id,{value:[],configurable:!0}),r[this.scope.id].push(F)),this.scope.fire("interactable:new",{target:r,options:d,interactable:P,win:this.scope._win}),P}},{key:"get",value:function(r,d){var P=d&&d.context||this.scope.document,F=s.default.string(r),T=F?this.selectorMap[r]:r[this.scope.id];if(!T)return null;var N=xt.find(T,function(nt){return nt.context===P&&(F||nt.interactable.inContext(r))});return N&&N.interactable}},{key:"forEachMatch",value:function(r,d){for(var P=0;P<this.list.length;P++){var F=this.list[P],T=void 0;if((s.default.string(F.target)?s.default.element(r)&&E.matchesSelector(r,F.target):r===F.target)&&F.inContext(r)&&(T=d(F)),T!==void 0)return T}}}])&&Rs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();gi.InteractableSet=Bs;var vi={};function qs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function er(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nr(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var P,F,T=[],N=!0,nt=!1;try{for(d=d.call(n);!(N=(P=d.next()).done)&&(T.push(P.value),!r||T.length!==r);N=!0);}catch(rt){nt=!0,F=rt}finally{try{N||d.return==null||d.return()}finally{if(nt)throw F}}return T}}(t,e)||function(n,r){if(n){if(typeof n=="string")return Zr(n,r);var d=Object.prototype.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?Zr(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Zr(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(vi,"__esModule",{value:!0}),vi.default=void 0;var zs=function(){function t(r){(function(d,P){if(!(d instanceof P))throw new TypeError("Cannot call a class as a function")})(this,t),er(this,"currentTarget",void 0),er(this,"originalEvent",void 0),er(this,"type",void 0),this.originalEvent=r,(0,c.default)(this,r)}var e,n;return e=t,(n=[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}])&&qs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Hn(t){if(!s.default.object(t))return{capture:!!t,passive:!1};var e=(0,O.default)({},t);return e.capture=!!t.capture,e.passive=!!t.passive,e}var Us={id:"events",install:function(t){var e,n=[],r={},d=[],P={add:F,remove:T,addDelegate:function(rt,ut,pt,mt,dt){var At=Hn(dt);if(!r[pt]){r[pt]=[];for(var It=0;It<d.length;It++){var kt=d[It];F(kt,pt,N),F(kt,pt,nt,!0)}}var Rt=r[pt],Ut=xt.find(Rt,function(Xt){return Xt.selector===rt&&Xt.context===ut});Ut||(Ut={selector:rt,context:ut,listeners:[]},Rt.push(Ut)),Ut.listeners.push([mt,At])},removeDelegate:function(rt,ut,pt,mt,dt){var At,It=Hn(dt),kt=r[pt],Rt=!1;if(kt)for(At=kt.length-1;At>=0;At--){var Ut=kt[At];if(Ut.selector===rt&&Ut.context===ut){for(var Xt=Ut.listeners,Jt=Xt.length-1;Jt>=0;Jt--){var ne=nr(Xt[Jt],2),Kt=ne[0],ee=ne[1],Ne=ee.capture,Je=ee.passive;if(Kt===mt&&Ne===It.capture&&Je===It.passive){Xt.splice(Jt,1),Xt.length||(kt.splice(At,1),T(ut,pt,N),T(ut,pt,nt,!0)),Rt=!0;break}}if(Rt)break}}},delegateListener:N,delegateUseCapture:nt,delegatedEvents:r,documents:d,targets:n,supportsOptions:!1,supportsPassive:!1};function F(rt,ut,pt,mt){var dt=Hn(mt),At=xt.find(n,function(It){return It.eventTarget===rt});At||(At={eventTarget:rt,events:{}},n.push(At)),At.events[ut]||(At.events[ut]=[]),rt.addEventListener&&!xt.contains(At.events[ut],pt)&&(rt.addEventListener(ut,pt,P.supportsOptions?dt:dt.capture),At.events[ut].push(pt))}function T(rt,ut,pt,mt){var dt=Hn(mt),At=xt.findIndex(n,function(Jt){return Jt.eventTarget===rt}),It=n[At];if(It&&It.events)if(ut!=="all"){var kt=!1,Rt=It.events[ut];if(Rt){if(pt==="all"){for(var Ut=Rt.length-1;Ut>=0;Ut--)T(rt,ut,Rt[Ut],dt);return}for(var Xt=0;Xt<Rt.length;Xt++)if(Rt[Xt]===pt){rt.removeEventListener(ut,pt,P.supportsOptions?dt:dt.capture),Rt.splice(Xt,1),Rt.length===0&&(delete It.events[ut],kt=!0);break}}kt&&!Object.keys(It.events).length&&n.splice(At,1)}else for(ut in It.events)It.events.hasOwnProperty(ut)&&T(rt,ut,"all")}function N(rt,ut){for(var pt=Hn(ut),mt=new zs(rt),dt=r[rt.type],At=nr(M.getEventTargets(rt),1)[0],It=At;s.default.element(It);){for(var kt=0;kt<dt.length;kt++){var Rt=dt[kt],Ut=Rt.selector,Xt=Rt.context;if(E.matchesSelector(It,Ut)&&E.nodeContains(Xt,At)&&E.nodeContains(Xt,It)){var Jt=Rt.listeners;mt.currentTarget=It;for(var ne=0;ne<Jt.length;ne++){var Kt=nr(Jt[ne],2),ee=Kt[0],Ne=Kt[1],Je=Ne.capture,_r=Ne.passive;Je===pt.capture&&_r===pt.passive&&ee(mt)}}}It=E.parentNode(It)}}function nt(rt){return N(rt,!0)}return(e=t.document)==null||e.createElement("div").addEventListener("test",null,{get capture(){return P.supportsOptions=!0},get passive(){return P.supportsPassive=!0}}),t.events=P,P}};vi.default=Us;var mi={};Object.defineProperty(mi,"__esModule",{value:!0}),mi.default=void 0;var yi={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(t){for(var e=0;e<yi.methodOrder.length;e++){var n;n=yi.methodOrder[e];var r=yi[n](t);if(r)return r}return null},simulationResume:function(t){var e=t.pointerType,n=t.eventType,r=t.eventTarget,d=t.scope;if(!/down|start/i.test(n))return null;for(var P=0;P<d.interactions.list.length;P++){var F=d.interactions.list[P],T=r;if(F.simulation&&F.simulation.allowResume&&F.pointerType===e)for(;T;){if(T===F.element)return F;T=E.parentNode(T)}}return null},mouseOrPen:function(t){var e,n=t.pointerId,r=t.pointerType,d=t.eventType,P=t.scope;if(r!=="mouse"&&r!=="pen")return null;for(var F=0;F<P.interactions.list.length;F++){var T=P.interactions.list[F];if(T.pointerType===r){if(T.simulation&&!Qr(T,n))continue;if(T.interacting())return T;e||(e=T)}}if(e)return e;for(var N=0;N<P.interactions.list.length;N++){var nt=P.interactions.list[N];if(!(nt.pointerType!==r||/down/i.test(d)&&nt.simulation))return nt}return null},hasPointer:function(t){for(var e=t.pointerId,n=t.scope,r=0;r<n.interactions.list.length;r++){var d=n.interactions.list[r];if(Qr(d,e))return d}return null},idle:function(t){for(var e=t.pointerType,n=t.scope,r=0;r<n.interactions.list.length;r++){var d=n.interactions.list[r];if(d.pointers.length===1){var P=d.interactable;if(P&&(!P.options.gesture||!P.options.gesture.enabled))continue}else if(d.pointers.length>=2)continue;if(!d.interacting()&&e===d.pointerType)return d}return null}};function Qr(t,e){return t.pointers.some(function(n){return n.id===e})}var Vs=yi;mi.default=Vs;var bi={};function ir(t){return ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ir(t)}function to(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var P,F,T=[],N=!0,nt=!1;try{for(d=d.call(n);!(N=(P=d.next()).done)&&(T.push(P.value),!r||T.length!==r);N=!0);}catch(rt){nt=!0,F=rt}finally{try{N||d.return==null||d.return()}finally{if(nt)throw F}}return T}}(t,e)||function(n,r){if(n){if(typeof n=="string")return eo(n,r);var d=Object.prototype.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?eo(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function eo(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Hs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(t,e){return rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},rr(t,e)}function Gs(t,e){if(e&&(ir(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(t)}function _i(t){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_i(t)}Object.defineProperty(bi,"__esModule",{value:!0}),bi.default=void 0;var or=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function no(t,e){return function(n){var r=e.interactions.list,d=M.getPointerType(n),P=to(M.getEventTargets(n),2),F=P[0],T=P[1],N=[];if(/^touch/.test(n.type)){e.prevTouchTime=e.now();for(var nt=0;nt<n.changedTouches.length;nt++){var rt=n.changedTouches[nt],ut={pointer:rt,pointerId:M.getPointerId(rt),pointerType:d,eventType:n.type,eventTarget:F,curEventTarget:T,scope:e},pt=io(ut);N.push([ut.pointer,ut.eventTarget,ut.curEventTarget,pt])}}else{var mt=!1;if(!I.default.supportsPointerEvent&&/mouse/.test(n.type)){for(var dt=0;dt<r.length&&!mt;dt++)mt=r[dt].pointerType!=="mouse"&&r[dt].pointerIsDown;mt=mt||e.now()-e.prevTouchTime<500||n.timeStamp===0}if(!mt){var At={pointer:n,pointerId:M.getPointerId(n),pointerType:d,eventType:n.type,curEventTarget:T,eventTarget:F,scope:e},It=io(At);N.push([At.pointer,At.eventTarget,At.curEventTarget,It])}}for(var kt=0;kt<N.length;kt++){var Rt=to(N[kt],4),Ut=Rt[0],Xt=Rt[1],Jt=Rt[2];Rt[3][t](Ut,n,Xt,Jt)}}}function io(t){var e=t.pointerType,n=t.scope,r={interaction:mi.default.search(t),searchDetails:t};return n.fire("interactions:find",r),r.interaction||n.interactions.new({pointerType:e})}function sr(t,e){var n=t.doc,r=t.scope,d=t.options,P=r.interactions.docEvents,F=r.events,T=F[e];for(var N in r.browser.isIOS&&!d.events&&(d.events={passive:!1}),F.delegatedEvents)T(n,N,F.delegateListener),T(n,N,F.delegateUseCapture,!0);for(var nt=d&&d.events,rt=0;rt<P.length;rt++){var ut=P[rt];T(n,ut.type,ut.listener,nt)}}var Ys={id:"core/interactions",install:function(t){for(var e={},n=0;n<or.length;n++){var r=or[n];e[r]=no(r,t)}var d,P=I.default.pEventTypes;function F(){for(var T=0;T<t.interactions.list.length;T++){var N=t.interactions.list[T];if(N.pointerIsDown&&N.pointerType==="touch"&&!N._interacting)for(var nt=function(){var ut=N.pointers[rt];t.documents.some(function(pt){var mt=pt.doc;return(0,E.nodeContains)(mt,ut.downTarget)})||N.removePointer(ut.pointer,ut.event)},rt=0;rt<N.pointers.length;rt++)nt()}}(d=z.default.PointerEvent?[{type:P.down,listener:F},{type:P.down,listener:e.pointerDown},{type:P.move,listener:e.pointerMove},{type:P.up,listener:e.pointerUp},{type:P.cancel,listener:e.pointerUp}]:[{type:"mousedown",listener:e.pointerDown},{type:"mousemove",listener:e.pointerMove},{type:"mouseup",listener:e.pointerUp},{type:"touchstart",listener:F},{type:"touchstart",listener:e.pointerDown},{type:"touchmove",listener:e.pointerMove},{type:"touchend",listener:e.pointerUp},{type:"touchcancel",listener:e.pointerUp}]).push({type:"blur",listener:function(T){for(var N=0;N<t.interactions.list.length;N++)t.interactions.list[N].documentBlur(T)}}),t.prevTouchTime=0,t.Interaction=function(T){(function(dt,At){if(typeof At!="function"&&At!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(At&&At.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),At&&rr(dt,At)})(mt,T);var N,nt,rt,ut,pt=(rt=mt,ut=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,At=_i(rt);if(ut){var It=_i(this).constructor;dt=Reflect.construct(At,arguments,It)}else dt=At.apply(this,arguments);return Gs(this,dt)});function mt(){return Hs(this,mt),pt.apply(this,arguments)}return N=mt,(nt=[{key:"pointerMoveTolerance",get:function(){return t.interactions.pointerMoveTolerance},set:function(dt){t.interactions.pointerMoveTolerance=dt}},{key:"_now",value:function(){return t.now()}}])&&$s(N.prototype,nt),Object.defineProperty(N,"prototype",{writable:!1}),mt}(De.default),t.interactions={list:[],new:function(T){T.scopeFire=function(nt,rt){return t.fire(nt,rt)};var N=new t.Interaction(T);return t.interactions.list.push(N),N},listeners:e,docEvents:d,pointerMoveTolerance:1},t.usePlugin(Ie.default)},listeners:{"scope:add-document":function(t){return sr(t,"add")},"scope:remove-document":function(t){return sr(t,"remove")},"interactable:unset":function(t,e){for(var n=t.interactable,r=e.interactions.list.length-1;r>=0;r--){var d=e.interactions.list[r];d.interactable===n&&(d.stop(),e.fire("interactions:destroy",{interaction:d}),d.destroy(),e.interactions.list.length>2&&e.interactions.list.splice(r,1))}}},onDocSignal:sr,doOnInteractions:no,methodNames:or},Xs=Ys;bi.default=Xs;var $n={};function ar(t){return ar=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ar(t)}function Si(){return Si=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ws(t,e);if(r){var d=Object.getOwnPropertyDescriptor(r,e);return d.get?d.get.call(arguments.length<3?t:n):d.value}},Si.apply(this,arguments)}function Ws(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=bn(t))!==null;);return t}function lr(t,e){return lr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},lr(t,e)}function Ks(t,e){if(e&&(ar(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(t)}function bn(t){return bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bn(t)}function ro(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function so(t,e,n){return e&&oo(t.prototype,e),n&&oo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty($n,"__esModule",{value:!0}),$n.Scope=void 0,$n.initScope=ao;var Js=function(){function t(){var e=this;ro(this,t),me(this,"id","__interact_scope_".concat(Math.floor(100*Math.random()))),me(this,"isInitialized",!1),me(this,"listenerMaps",[]),me(this,"browser",I.default),me(this,"defaults",(0,vn.default)(Fn.defaults)),me(this,"Eventable",zn.Eventable),me(this,"actions",{map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}}),me(this,"interactStatic",(0,Qi.createInteractStatic)(this)),me(this,"InteractEvent",Rn.InteractEvent),me(this,"Interactable",void 0),me(this,"interactables",new gi.InteractableSet(this)),me(this,"_win",void 0),me(this,"document",void 0),me(this,"window",void 0),me(this,"documents",[]),me(this,"_plugins",{list:[],map:{}}),me(this,"onWindowUnload",function(r){return e.removeDocument(r.target)});var n=this;this.Interactable=function(r){(function(N,nt){if(typeof nt!="function"&&nt!==null)throw new TypeError("Super expression must either be null or a function");N.prototype=Object.create(nt&&nt.prototype,{constructor:{value:N,writable:!0,configurable:!0}}),Object.defineProperty(N,"prototype",{writable:!1}),nt&&lr(N,nt)})(T,r);var d,P,F=(d=T,P=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var N,nt=bn(d);if(P){var rt=bn(this).constructor;N=Reflect.construct(nt,arguments,rt)}else N=nt.apply(this,arguments);return Ks(this,N)});function T(){return ro(this,T),F.apply(this,arguments)}return so(T,[{key:"_defaults",get:function(){return n.defaults}},{key:"set",value:function(N){return Si(bn(T.prototype),"set",this).call(this,N),n.fire("interactable:set",{options:N,interactable:this}),this}},{key:"unset",value:function(){Si(bn(T.prototype),"unset",this).call(this);var N=n.interactables.list.indexOf(this);N<0||(n.interactables.list.splice(N,1),n.fire("interactable:unset",{interactable:this}))}}]),T}(pi.Interactable)}return so(t,[{key:"addListeners",value:function(e,n){this.listenerMaps.push({id:n,map:e})}},{key:"fire",value:function(e,n){for(var r=0;r<this.listenerMaps.length;r++){var d=this.listenerMaps[r].map[e];if(d&&d(n,this,e)===!1)return!1}}},{key:"init",value:function(e){return this.isInitialized?this:ao(this,e)}},{key:"pluginIsInstalled",value:function(e){return this._plugins.map[e.id]||this._plugins.list.indexOf(e)!==-1}},{key:"usePlugin",value:function(e,n){if(!this.isInitialized)return this;if(this.pluginIsInstalled(e))return this;if(e.id&&(this._plugins.map[e.id]=e),this._plugins.list.push(e),e.install&&e.install(this,n),e.listeners&&e.before){for(var r=0,d=this.listenerMaps.length,P=e.before.reduce(function(T,N){return T[N]=!0,T[lo(N)]=!0,T},{});r<d;r++){var F=this.listenerMaps[r].id;if(P[F]||P[lo(F)])break}this.listenerMaps.splice(r,0,{id:e.id,map:e.listeners})}else e.listeners&&this.listenerMaps.push({id:e.id,map:e.listeners});return this}},{key:"addDocument",value:function(e,n){if(this.getDocIndex(e)!==-1)return!1;var r=h.getWindow(e);n=n?(0,O.default)({},n):{},this.documents.push({doc:e,options:n}),this.events.documents.push(e),e!==this.document&&this.events.add(r,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:e,window:r,scope:this,options:n})}},{key:"removeDocument",value:function(e){var n=this.getDocIndex(e),r=h.getWindow(e),d=this.documents[n].options;this.events.remove(r,"unload",this.onWindowUnload),this.documents.splice(n,1),this.events.documents.splice(n,1),this.fire("scope:remove-document",{doc:e,window:r,scope:this,options:d})}},{key:"getDocIndex",value:function(e){for(var n=0;n<this.documents.length;n++)if(this.documents[n].doc===e)return n;return-1}},{key:"getDocOptions",value:function(e){var n=this.getDocIndex(e);return n===-1?null:this.documents[n].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),t}();function ao(t,e){return t.isInitialized=!0,s.default.window(e)&&h.init(e),z.default.init(e),I.default.init(e),Ft.default.init(e),t.window=e,t.document=e.document,t.usePlugin(bi.default),t.usePlugin(vi.default),t}function lo(t){return t&&t.replace(/\/.*$/,"")}$n.Scope=Js;var we={};Object.defineProperty(we,"__esModule",{value:!0}),we.default=void 0;var uo=new $n.Scope,Zs=uo.interactStatic;we.default=Zs;var Qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:void 0;uo.init(Qs);var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.default=void 0,Ei.default=function(){};var wi={};Object.defineProperty(wi,"__esModule",{value:!0}),wi.default=void 0,wi.default=function(){};var Ci={};function co(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var P,F,T=[],N=!0,nt=!1;try{for(d=d.call(n);!(N=(P=d.next()).done)&&(T.push(P.value),!r||T.length!==r);N=!0);}catch(rt){nt=!0,F=rt}finally{try{N||d.return==null||d.return()}finally{if(nt)throw F}}return T}}(t,e)||function(n,r){if(n){if(typeof n=="string")return fo(n,r);var d=Object.prototype.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?fo(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function fo(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.default=void 0,Ci.default=function(t){var e=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(r){var d=co(r,2),P=d[0],F=d[1];return P in t||F in t}),n=function(r,d){for(var P=t.range,F=t.limits,T=F===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:F,N=t.offset,nt=N===void 0?{x:0,y:0}:N,rt={range:P,grid:t,x:null,y:null},ut=0;ut<e.length;ut++){var pt=co(e[ut],2),mt=pt[0],dt=pt[1],At=Math.round((r-nt.x)/t[mt]),It=Math.round((d-nt.y)/t[dt]);rt[mt]=Math.max(T.left,Math.min(T.right,At*t[mt]+nt.x)),rt[dt]=Math.max(T.top,Math.min(T.bottom,It*t[dt]+nt.y))}return rt};return n.grid=t,n.coordFields=e,n};var Gn={};Object.defineProperty(Gn,"__esModule",{value:!0}),Object.defineProperty(Gn,"edgeTarget",{enumerable:!0,get:function(){return Ei.default}}),Object.defineProperty(Gn,"elements",{enumerable:!0,get:function(){return wi.default}}),Object.defineProperty(Gn,"grid",{enumerable:!0,get:function(){return Ci.default}});var xi={};Object.defineProperty(xi,"__esModule",{value:!0}),xi.default=void 0;var ta={id:"snappers",install:function(t){var e=t.interactStatic;e.snappers=(0,O.default)(e.snappers||{},Gn),e.createSnapGrid=e.snappers.grid}},ea=ta;xi.default=ea;var Dn={};function ho(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,r)}return n}function ur(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ho(Object(n),!0).forEach(function(r){na(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ho(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function na(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.default=Dn.aspectRatio=void 0;var po={start:function(t){var e=t.state,n=t.rect,r=t.edges,d=t.pageCoords,P=e.options,F=P.ratio,T=P.enabled,N=e.options,nt=N.equalDelta,rt=N.modifiers;F==="preserve"&&(F=n.width/n.height),e.startCoords=(0,O.default)({},d),e.startRect=(0,O.default)({},n),e.ratio=F,e.equalDelta=nt;var ut=e.linkedEdges={top:r.top||r.left&&!r.bottom,left:r.left||r.top&&!r.right,bottom:r.bottom||r.right&&!r.top,right:r.right||r.bottom&&!r.left};if(e.xIsPrimaryAxis=!(!r.left&&!r.right),e.equalDelta){var pt=(ut.left?1:-1)*(ut.top?1:-1);e.edgeSign={x:pt,y:pt}}else e.edgeSign={x:ut.left?-1:1,y:ut.top?-1:1};if(T!==!1&&(0,O.default)(r,ut),rt!=null&&rt.length){var mt=new mn.default(t.interaction);mt.copyFrom(t.interaction.modification),mt.prepareStates(rt),e.subModification=mt,mt.startAll(ur({},t))}},set:function(t){var e=t.state,n=t.rect,r=t.coords,d=e.linkedEdges,P=(0,O.default)({},r),F=e.equalDelta?ia:ra;if((0,O.default)(t.edges,d),F(e,e.xIsPrimaryAxis,r,n),!e.subModification)return null;var T=(0,O.default)({},n);(0,y.addEdges)(d,T,{x:r.x-P.x,y:r.y-P.y});var N=e.subModification.setAll(ur(ur({},t),{},{rect:T,edges:d,pageCoords:r,prevCoords:r,prevRect:T})),nt=N.delta;return N.changed&&(F(e,Math.abs(nt.x)>Math.abs(nt.y),N.coords,N.rect),(0,O.default)(r,N.coords)),N.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function ia(t,e,n){var r=t.startCoords,d=t.edgeSign;e?n.y=r.y+(n.x-r.x)*d.y:n.x=r.x+(n.y-r.y)*d.x}function ra(t,e,n,r){var d=t.startRect,P=t.startCoords,F=t.ratio,T=t.edgeSign;if(e){var N=r.width/F;n.y=P.y+(N-d.height)*T.y}else{var nt=r.height*F;n.x=P.x+(nt-d.width)*T.x}}Dn.aspectRatio=po;var oa=(0,ve.makeModifier)(po,"aspectRatio");Dn.default=oa;var _n={};Object.defineProperty(_n,"__esModule",{value:!0}),_n.default=void 0;var go=function(){};go._defaults={};var sa=go;_n.default=sa;var cr={};Object.defineProperty(cr,"__esModule",{value:!0}),Object.defineProperty(cr,"default",{enumerable:!0,get:function(){return _n.default}});var xe={};function dr(t,e,n){return s.default.func(t)?y.resolveRectLike(t,e.interactable,e.element,[n.x,n.y,e]):y.resolveRectLike(t,e.interactable,e.element)}Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0,xe.getRestrictionRect=dr,xe.restrict=void 0;var vo={start:function(t){var e=t.rect,n=t.startOffset,r=t.state,d=t.interaction,P=t.pageCoords,F=r.options,T=F.elementRect,N=(0,O.default)({left:0,top:0,right:0,bottom:0},F.offset||{});if(e&&T){var nt=dr(F.restriction,d,P);if(nt){var rt=nt.right-nt.left-e.width,ut=nt.bottom-nt.top-e.height;rt<0&&(N.left+=rt,N.right+=rt),ut<0&&(N.top+=ut,N.bottom+=ut)}N.left+=n.left-e.width*T.left,N.top+=n.top-e.height*T.top,N.right+=n.right-e.width*(1-T.right),N.bottom+=n.bottom-e.height*(1-T.bottom)}r.offset=N},set:function(t){var e=t.coords,n=t.interaction,r=t.state,d=r.options,P=r.offset,F=dr(d.restriction,n,e);if(F){var T=y.xywhToTlbr(F);e.x=Math.max(Math.min(T.right-P.right,e.x),T.left+P.left),e.y=Math.max(Math.min(T.bottom-P.bottom,e.y),T.top+P.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}};xe.restrict=vo;var aa=(0,ve.makeModifier)(vo,"restrict");xe.default=aa;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.restrictEdges=Ve.default=void 0;var mo={top:1/0,left:1/0,bottom:-1/0,right:-1/0},yo={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function bo(t,e){for(var n=["top","left","bottom","right"],r=0;r<n.length;r++){var d=n[r];d in t||(t[d]=e[d])}return t}var _o={noInner:mo,noOuter:yo,start:function(t){var e,n=t.interaction,r=t.startOffset,d=t.state,P=d.options;if(P){var F=(0,xe.getRestrictionRect)(P.offset,n,n.coords.start.page);e=y.rectToXY(F)}e=e||{x:0,y:0},d.offset={top:e.y+r.top,left:e.x+r.left,bottom:e.y-r.bottom,right:e.x-r.right}},set:function(t){var e=t.coords,n=t.edges,r=t.interaction,d=t.state,P=d.offset,F=d.options;if(n){var T=(0,O.default)({},e),N=(0,xe.getRestrictionRect)(F.inner,r,T)||{},nt=(0,xe.getRestrictionRect)(F.outer,r,T)||{};bo(N,mo),bo(nt,yo),n.top?e.y=Math.min(Math.max(nt.top+P.top,T.y),N.top+P.top):n.bottom&&(e.y=Math.max(Math.min(nt.bottom+P.bottom,T.y),N.bottom+P.bottom)),n.left?e.x=Math.min(Math.max(nt.left+P.left,T.x),N.left+P.left):n.right&&(e.x=Math.max(Math.min(nt.right+P.right,T.x),N.right+P.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}};Ve.restrictEdges=_o;var la=(0,ve.makeModifier)(_o,"restrictEdges");Ve.default=la;var On={};Object.defineProperty(On,"__esModule",{value:!0}),On.restrictRect=On.default=void 0;var ua=(0,O.default)({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(t){}},xe.restrict.defaults),So={start:xe.restrict.start,set:xe.restrict.set,defaults:ua};On.restrictRect=So;var ca=(0,ve.makeModifier)(So,"restrictRect");On.default=ca;var Tn={};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.restrictSize=Tn.default=void 0;var da={width:-1/0,height:-1/0},fa={width:1/0,height:1/0},Eo={start:function(t){return Ve.restrictEdges.start(t)},set:function(t){var e=t.interaction,n=t.state,r=t.rect,d=t.edges,P=n.options;if(d){var F=y.tlbrToXywh((0,xe.getRestrictionRect)(P.min,e,t.coords))||da,T=y.tlbrToXywh((0,xe.getRestrictionRect)(P.max,e,t.coords))||fa;n.options={endOnly:P.endOnly,inner:(0,O.default)({},Ve.restrictEdges.noInner),outer:(0,O.default)({},Ve.restrictEdges.noOuter)},d.top?(n.options.inner.top=r.bottom-F.height,n.options.outer.top=r.bottom-T.height):d.bottom&&(n.options.inner.bottom=r.top+F.height,n.options.outer.bottom=r.top+T.height),d.left?(n.options.inner.left=r.right-F.width,n.options.outer.left=r.right-T.width):d.right&&(n.options.inner.right=r.left+F.width,n.options.outer.right=r.left+T.width),Ve.restrictEdges.set(t),n.options=P}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}};Tn.restrictSize=Eo;var ha=(0,ve.makeModifier)(Eo,"restrictSize");Tn.default=ha;var fr={};Object.defineProperty(fr,"__esModule",{value:!0}),Object.defineProperty(fr,"default",{enumerable:!0,get:function(){return _n.default}});var on={};Object.defineProperty(on,"__esModule",{value:!0}),on.snap=on.default=void 0;var wo={start:function(t){var e,n=t.interaction,r=t.interactable,d=t.element,P=t.rect,F=t.state,T=t.startOffset,N=F.options,nt=N.offsetWithOrigin?function(pt){var mt=pt.interaction.element;return(0,y.rectToXY)((0,y.resolveRectLike)(pt.state.options.origin,null,null,[mt]))||(0,Q.default)(pt.interactable,mt,pt.interaction.prepared.name)}(t):{x:0,y:0};if(N.offset==="startCoords")e={x:n.coords.start.page.x,y:n.coords.start.page.y};else{var rt=(0,y.resolveRectLike)(N.offset,r,d,[n]);(e=(0,y.rectToXY)(rt)||{x:0,y:0}).x+=nt.x,e.y+=nt.y}var ut=N.relativePoints;F.offsets=P&&ut&&ut.length?ut.map(function(pt,mt){return{index:mt,relativePoint:pt,x:T.left-P.width*pt.x+e.x,y:T.top-P.height*pt.y+e.y}}):[{index:0,relativePoint:null,x:e.x,y:e.y}]},set:function(t){var e=t.interaction,n=t.coords,r=t.state,d=r.options,P=r.offsets,F=(0,Q.default)(e.interactable,e.element,e.prepared.name),T=(0,O.default)({},n),N=[];d.offsetWithOrigin||(T.x-=F.x,T.y-=F.y);for(var nt=0;nt<P.length;nt++)for(var rt=P[nt],ut=T.x-rt.x,pt=T.y-rt.y,mt=0,dt=d.targets.length;mt<dt;mt++){var At,It=d.targets[mt];(At=s.default.func(It)?It(ut,pt,e._proxy,rt,mt):It)&&N.push({x:(s.default.number(At.x)?At.x:ut)+rt.x,y:(s.default.number(At.y)?At.y:pt)+rt.y,range:s.default.number(At.range)?At.range:d.range,source:It,index:mt,offset:rt})}for(var kt={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},Rt=0;Rt<N.length;Rt++){var Ut=N[Rt],Xt=Ut.range,Jt=Ut.x-T.x,ne=Ut.y-T.y,Kt=(0,S.default)(Jt,ne),ee=Kt<=Xt;Xt===1/0&&kt.inRange&&kt.range!==1/0&&(ee=!1),kt.target&&!(ee?kt.inRange&&Xt!==1/0?Kt/Xt<kt.distance/kt.range:Xt===1/0&&kt.range!==1/0||Kt<kt.distance:!kt.inRange&&Kt<kt.distance)||(kt.target=Ut,kt.distance=Kt,kt.range=Xt,kt.inRange=ee,kt.delta.x=Jt,kt.delta.y=ne)}return kt.inRange&&(n.x=kt.target.x,n.y=kt.target.y),r.closest=kt,kt},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}};on.snap=wo;var pa=(0,ve.makeModifier)(wo,"snap");on.default=pa;var Ke={};function Co(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.snapSize=Ke.default=void 0;var xo={start:function(t){var e=t.state,n=t.edges,r=e.options;if(!n)return null;t.state={options:{targets:null,relativePoints:[{x:n.left?0:1,y:n.top?0:1}],offset:r.offset||"self",origin:{x:0,y:0},range:r.range}},e.targetFields=e.targetFields||[["width","height"],["x","y"]],on.snap.start(t),e.offsets=t.state.offsets,t.state=e},set:function(t){var e,n,r=t.interaction,d=t.state,P=t.coords,F=d.options,T=d.offsets,N={x:P.x-T[0].x,y:P.y-T[0].y};d.options=(0,O.default)({},F),d.options.targets=[];for(var nt=0;nt<(F.targets||[]).length;nt++){var rt=(F.targets||[])[nt],ut=void 0;if(ut=s.default.func(rt)?rt(N.x,N.y,r):rt){for(var pt=0;pt<d.targetFields.length;pt++){var mt=(e=d.targetFields[pt],n=2,function(kt){if(Array.isArray(kt))return kt}(e)||function(kt,Rt){var Ut=kt==null?null:typeof Symbol<"u"&&kt[Symbol.iterator]||kt["@@iterator"];if(Ut!=null){var Xt,Jt,ne=[],Kt=!0,ee=!1;try{for(Ut=Ut.call(kt);!(Kt=(Xt=Ut.next()).done)&&(ne.push(Xt.value),!Rt||ne.length!==Rt);Kt=!0);}catch(Ne){ee=!0,Jt=Ne}finally{try{Kt||Ut.return==null||Ut.return()}finally{if(ee)throw Jt}}return ne}}(e,n)||function(kt,Rt){if(kt){if(typeof kt=="string")return Co(kt,Rt);var Ut=Object.prototype.toString.call(kt).slice(8,-1);return Ut==="Object"&&kt.constructor&&(Ut=kt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(kt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Co(kt,Rt):void 0}}(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),dt=mt[0],At=mt[1];if(dt in ut||At in ut){ut.x=ut[dt],ut.y=ut[At];break}}d.options.targets.push(ut)}}var It=on.snap.set(t);return d.options=F,It},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}};Ke.snapSize=xo;var ga=(0,ve.makeModifier)(xo,"snapSize");Ke.default=ga;var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.snapEdges=Mn.default=void 0;var Po={start:function(t){var e=t.edges;return e?(t.state.targetFields=t.state.targetFields||[[e.left?"left":"right",e.top?"top":"bottom"]],Ke.snapSize.start(t)):null},set:Ke.snapSize.set,defaults:(0,O.default)((0,vn.default)(Ke.snapSize.defaults),{targets:null,range:null,offset:{x:0,y:0}})};Mn.snapEdges=Po;var va=(0,ve.makeModifier)(Po,"snapEdges");Mn.default=va;var hr={};Object.defineProperty(hr,"__esModule",{value:!0}),Object.defineProperty(hr,"default",{enumerable:!0,get:function(){return _n.default}});var pr={};Object.defineProperty(pr,"__esModule",{value:!0}),Object.defineProperty(pr,"default",{enumerable:!0,get:function(){return _n.default}});var jn={};Object.defineProperty(jn,"__esModule",{value:!0}),jn.default=void 0;var ma={aspectRatio:Dn.default,restrictEdges:Ve.default,restrict:xe.default,restrictRect:On.default,restrictSize:Tn.default,snapEdges:Mn.default,snap:on.default,snapSize:Ke.default,spring:hr.default,avoid:cr.default,transform:pr.default,rubberband:fr.default};jn.default=ma;var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.default=void 0;var ya={id:"modifiers",install:function(t){var e=t.interactStatic;for(var n in t.usePlugin(ve.default),t.usePlugin(xi.default),e.modifiers=jn.default,jn.default){var r=jn.default[n],d=r._defaults,P=r._methods;d._methods=P,t.defaults.perAction[n]=d}}},ba=ya;Yn.default=ba;var Sn={};function gr(t){return gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gr(t)}function _a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vr(t,e){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},vr(t,e)}function Sa(t,e){if(e&&(gr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mr(t)}function mr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pi(t){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pi(t)}Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.default=Sn.PointerEvent=void 0;var Ea=function(t){(function(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),N&&vr(T,N)})(F,t);var e,n,r,d,P=(r=F,d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var T,N=Pi(r);if(d){var nt=Pi(this).constructor;T=Reflect.construct(N,arguments,nt)}else T=N.apply(this,arguments);return Sa(this,T)});function F(T,N,nt,rt,ut,pt){var mt;if(function(It,kt){if(!(It instanceof kt))throw new TypeError("Cannot call a class as a function")}(this,F),mt=P.call(this,ut),M.pointerExtend(mr(mt),nt),nt!==N&&M.pointerExtend(mr(mt),N),mt.timeStamp=pt,mt.originalEvent=nt,mt.type=T,mt.pointerId=M.getPointerId(N),mt.pointerType=M.getPointerType(N),mt.target=rt,mt.currentTarget=null,T==="tap"){var dt=ut.getPointerIndex(N);mt.dt=mt.timeStamp-ut.pointers[dt].downTime;var At=mt.timeStamp-ut.tapTime;mt.double=!!ut.prevTap&&ut.prevTap.type!=="doubletap"&&ut.prevTap.target===mt.target&&At<500}else T==="doubletap"&&(mt.dt=N.timeStamp-ut.tapTime,mt.double=!0);return mt}return e=F,(n=[{key:"_subtractOrigin",value:function(T){var N=T.x,nt=T.y;return this.pageX-=N,this.pageY-=nt,this.clientX-=N,this.clientY-=nt,this}},{key:"_addOrigin",value:function(T){var N=T.x,nt=T.y;return this.pageX+=N,this.pageY+=nt,this.clientX+=N,this.clientY+=nt,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}])&&_a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),F}(yt.BaseEvent);Sn.PointerEvent=Sn.default=Ea;var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.default=void 0;var Ai={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(t){t.pointerEvents=Ai,t.defaults.actions.pointerEvents=Ai.defaults,(0,O.default)(t.actions.phaselessTypes,Ai.types)},listeners:{"interactions:new":function(t){var e=t.interaction;e.prevTap=null,e.tapTime=0},"interactions:update-pointer":function(t){var e=t.down,n=t.pointerInfo;!e&&n.hold||(n.hold={duration:1/0,timeout:null})},"interactions:move":function(t,e){var n=t.interaction,r=t.pointer,d=t.event,P=t.eventTarget;t.duplicate||n.pointerIsDown&&!n.pointerWasMoved||(n.pointerIsDown&&yr(t),sn({interaction:n,pointer:r,event:d,eventTarget:P,type:"move"},e))},"interactions:down":function(t,e){(function(n,r){for(var d=n.interaction,P=n.pointer,F=n.event,T=n.eventTarget,N=n.pointerIndex,nt=d.pointers[N].hold,rt=E.getPath(T),ut={interaction:d,pointer:P,event:F,eventTarget:T,type:"hold",targets:[],path:rt,node:null},pt=0;pt<rt.length;pt++){var mt=rt[pt];ut.node=mt,r.fire("pointerEvents:collect-targets",ut)}if(ut.targets.length){for(var dt=1/0,At=0;At<ut.targets.length;At++){var It=ut.targets[At].eventable.options.holdDuration;It<dt&&(dt=It)}nt.duration=dt,nt.timeout=setTimeout(function(){sn({interaction:d,eventTarget:T,pointer:P,event:F,type:"hold"},r)},dt)}})(t,e),sn(t,e)},"interactions:up":function(t,e){yr(t),sn(t,e),function(n,r){var d=n.interaction,P=n.pointer,F=n.event,T=n.eventTarget;d.pointerWasMoved||sn({interaction:d,eventTarget:T,pointer:P,event:F,type:"tap"},r)}(t,e)},"interactions:cancel":function(t,e){yr(t),sn(t,e)}},PointerEvent:Sn.PointerEvent,fire:sn,collectEventTargets:Ao,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function sn(t,e){var n=t.interaction,r=t.pointer,d=t.event,P=t.eventTarget,F=t.type,T=t.targets,N=T===void 0?Ao(t,e):T,nt=new Sn.PointerEvent(F,r,d,P,n,e.now());e.fire("pointerEvents:new",{pointerEvent:nt});for(var rt={interaction:n,pointer:r,event:d,eventTarget:P,targets:N,type:F,pointerEvent:nt},ut=0;ut<N.length;ut++){var pt=N[ut];for(var mt in pt.props||{})nt[mt]=pt.props[mt];var dt=(0,Q.default)(pt.eventable,pt.node);if(nt._subtractOrigin(dt),nt.eventable=pt.eventable,nt.currentTarget=pt.node,pt.eventable.fire(nt),nt._addOrigin(dt),nt.immediatePropagationStopped||nt.propagationStopped&&ut+1<N.length&&N[ut+1].node!==nt.currentTarget)break}if(e.fire("pointerEvents:fired",rt),F==="tap"){var At=nt.double?sn({interaction:n,pointer:r,event:d,eventTarget:P,type:"doubletap"},e):nt;n.prevTap=At,n.tapTime=At.timeStamp}return nt}function Ao(t,e){var n=t.interaction,r=t.pointer,d=t.event,P=t.eventTarget,F=t.type,T=n.getPointerIndex(r),N=n.pointers[T];if(F==="tap"&&(n.pointerWasMoved||!N||N.downTarget!==P))return[];for(var nt=E.getPath(P),rt={interaction:n,pointer:r,event:d,eventTarget:P,type:F,path:nt,targets:[],node:null},ut=0;ut<nt.length;ut++){var pt=nt[ut];rt.node=pt,e.fire("pointerEvents:collect-targets",rt)}return F==="hold"&&(rt.targets=rt.targets.filter(function(mt){var dt;return mt.eventable.options.holdDuration===((dt=n.pointers[T])==null?void 0:dt.hold.duration)})),rt.targets}function yr(t){var e=t.interaction,n=t.pointerIndex,r=e.pointers[n].hold;r&&r.timeout&&(clearTimeout(r.timeout),r.timeout=null)}var wa=Ai;Xn.default=wa;var ki={};function Ca(t){var e=t.interaction;e.holdIntervalHandle&&(clearInterval(e.holdIntervalHandle),e.holdIntervalHandle=null)}Object.defineProperty(ki,"__esModule",{value:!0}),ki.default=void 0;var xa={id:"pointer-events/holdRepeat",install:function(t){t.usePlugin(Xn.default);var e=t.pointerEvents;e.defaults.holdRepeatInterval=0,e.types.holdrepeat=t.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(t,e){return t["pointerEvents:".concat(e)]=Ca,t},{"pointerEvents:new":function(t){var e=t.pointerEvent;e.type==="hold"&&(e.count=(e.count||0)+1)},"pointerEvents:fired":function(t,e){var n=t.interaction,r=t.pointerEvent,d=t.eventTarget,P=t.targets;if(r.type==="hold"&&P.length){var F=P[0].eventable.options.holdRepeatInterval;F<=0||(n.holdIntervalHandle=setTimeout(function(){e.pointerEvents.fire({interaction:n,eventTarget:d,type:"hold",pointer:r,event:r},e)},F))}}})},Pa=xa;ki.default=Pa;var Di={};function Aa(t){return(0,O.default)(this.events.options,t),this}Object.defineProperty(Di,"__esModule",{value:!0}),Di.default=void 0;var ka={id:"pointer-events/interactableTargets",install:function(t){var e=t.Interactable;e.prototype.pointerEvents=Aa;var n=e.prototype._backCompatOption;e.prototype._backCompatOption=function(r,d){var P=n.call(this,r,d);return P===this&&(this.events.options[r]=d),P}},listeners:{"pointerEvents:collect-targets":function(t,e){var n=t.targets,r=t.node,d=t.type,P=t.eventTarget;e.interactables.forEachMatch(r,function(F){var T=F.events,N=T.options;T.types[d]&&T.types[d].length&&F.testIgnoreAllow(N,r,P)&&n.push({node:r,eventable:T,props:{interactable:F}})})},"interactable:new":function(t){var e=t.interactable;e.events.getRect=function(n){return e.getRect(n)}},"interactable:set":function(t,e){var n=t.interactable,r=t.options;(0,O.default)(n.events.options,e.pointerEvents.defaults),(0,O.default)(n.events.options,r.pointerEvents||{})}}},Da=ka;Di.default=Da;var Wn={};Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.default=void 0;var Oa={id:"pointer-events",install:function(t){t.usePlugin(Xn),t.usePlugin(ki.default),t.usePlugin(Di.default)}},Ta=Oa;Wn.default=Ta;var Ln={};function ko(t){var e=t.Interactable;t.actions.phases.reflow=!0,e.prototype.reflow=function(n){return function(r,d,P){for(var F=s.default.string(r.target)?xt.from(r._context.querySelectorAll(r.target)):[r.target],T=P.window.Promise,N=T?[]:null,nt=function(){var ut=F[rt],pt=r.getRect(ut);if(!pt)return"break";var mt=xt.find(P.interactions.list,function(Rt){return Rt.interacting()&&Rt.interactable===r&&Rt.element===ut&&Rt.prepared.name===d.name}),dt=void 0;if(mt)mt.move(),N&&(dt=mt._reflowPromise||new T(function(Rt){mt._reflowResolve=Rt}));else{var At=(0,y.tlbrToXywh)(pt),It={page:{x:At.x,y:At.y},client:{x:At.x,y:At.y},timeStamp:P.now()},kt=M.coordsToEvent(It);dt=function(Rt,Ut,Xt,Jt,ne){var Kt=Rt.interactions.new({pointerType:"reflow"}),ee={interaction:Kt,event:ne,pointer:ne,eventTarget:Xt,phase:"reflow"};Kt.interactable=Ut,Kt.element=Xt,Kt.prevEvent=ne,Kt.updatePointer(ne,ne,Xt,!0),M.setZeroCoords(Kt.coords.delta),(0,wt.copyAction)(Kt.prepared,Jt),Kt._doPhase(ee);var Ne=Rt.window.Promise,Je=Ne?new Ne(function(_r){Kt._reflowResolve=_r}):void 0;return Kt._reflowPromise=Je,Kt.start(Jt,Ut,Xt),Kt._interacting?(Kt.move(ee),Kt.end(ne)):(Kt.stop(),Kt._reflowResolve()),Kt.removePointer(ne,ne),Je}(P,r,ut,d,kt)}N&&N.push(dt)},rt=0;rt<F.length&&nt()!=="break";rt++);return N&&T.all(N).then(function(){return r})}(this,n,t)}}Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.default=void 0,Ln.install=ko;var Ma={id:"reflow",install:ko,listeners:{"interactions:stop":function(t,e){var n=t.interaction;n.pointerType==="reflow"&&(n._reflowResolve&&n._reflowResolve(),xt.remove(e.interactions.list,n))}}},ja=Ma;Ln.default=ja;var En={};Object.defineProperty(En,"__esModule",{value:!0}),En.default=void 0,we.default.use(Ie.default),we.default.use(rn.default),we.default.use(Wn.default),we.default.use(yn.default),we.default.use(Yn.default),we.default.use(Ee.default),we.default.use(qt.default),we.default.use(G.default),we.default.use(Ln.default);var La=we.default;En.default=La,we.default.default=we.default,qt.default,G.default,Ee.default,Ie.default,ai.default,yn.default,we.default,Yn.default,rn.default,Wn.default,Ln.default;var wn={exports:{}};function br(t){return br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},br(t)}Object.defineProperty(wn.exports,"__esModule",{value:!0}),wn.exports.default=void 0;var Ia=En.default;if(wn.exports.default=Ia,br(wn)==="object"&&wn)try{wn.exports=En.default}catch{}return En.default.default=En.default,wn.exports})})(os);var Yl=os.exports,ei=Na(Yl);const qo={},Xl=class Zn extends Ko{constructor(a,i={data:{},top:"20px",left:"20px",width:"",height:"",uid:null},h={}){super(),this.workspace=a,this.properties=i,this.configuration=h,this.settings={},this.data={},this.drawSettings={cssClass:"agent-card",shortDescription:"",color:"#3B82F6"},this._destroyed=!1,this.skills=[],this._init_state_populated=!1,this._uid=this.properties.uid||"A"+kr(),this.properties||(this.properties={top:"",left:""}),this.data=this.properties.data||{},this.prepare().then(this.init.bind(this)).then(()=>{this.redraw().then(()=>{this.handleSkillsConnections(this.configuration).then(()=>{this._init_state_populated=!0}),this.workspace.addEventListener("componentAdded",j=>{j.displayName==="APIEndpoint"&&this.handleCompConn(j.uid)})})}).catch(j=>{console.error("Error initializing agent card:",j)}),qo[this.uid]=this}get uid(){return this._uid}async prepare(){return Promise.resolve()}async init(){return Promise.resolve()}async redraw(){const a=this.workspace,i=document.createElement("div");i.className=`agent-card exclude-panzoom ${this.drawSettings.cssClass||""}`,i.id=`agent-card-${this._uid}`,i.style.position="absolute",i.style.left=this.properties.left||"20px",i.style.top=this.properties.top||"20px",this.properties.width&&(i.style.width=this.properties.width),this.properties.height&&(i.style.height=this.properties.height);let h=null;const j=document.querySelector("#agent-avatar");j?h=j.src:(h=window.sessionStorage.getItem(`agent-avatar-${this.workspace.agent?.id}`),window.sessionStorage.removeItem(`agent-avatar-${this.workspace.agent?.id}`));const C=document.createElement("div");C.className="agent-card-content";const A=document.createElement("div");A.className="agent-image-container";const s=document.createElement("img");s.src=h||"",s.alt="Agent",s.className=`agent-image ${h?"":"hidden"}`,s.id="agent-card-avatar",A.appendChild(s);const _=document.createElement("div");_.id="agent-card-avatar-placeholder",_.className=`h-full w-full flex items-center justify-center bg-uipink rounded-[7px]  w-8 h-8 flex items-center justify-center text-white font-medium truncate ${h?"hidden":""}`,_.style.fontSize="77px",setTimeout(()=>{_.textContent=this.workspace.agent?.data?.name?.charAt(0)||document.querySelector(".agent-avatar-placeholder-topbar")?.textContent||""},200),A.appendChild(_);const u=document.createElement("div");u.className="agent-info";const o=document.createElement("div");o.className="agent-header";const m=document.createElement("div"),D=document.createElement("h2");D.className="agent-name",setTimeout(()=>{D.textContent=this.workspace.agent?.data?.name||""},200),m.appendChild(D);const L=document.createElement("div");L.className="p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors cursor-pointer menu-button",L.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="1"></circle>
        <circle cx="12" cy="5" r="1"></circle>
        <circle cx="12" cy="19" r="1"></circle>
      </svg>
    `,o.appendChild(m),o.appendChild(L),u.appendChild(o);const k=document.createElement("div");k.className="agent-actions py-2";const v=document.createElement("div");v.className="ep-control inputs justify-self-end flex items-center ";const l=document.createElement("span");l.className="text-[#5A5A5A] font-medium pr-2",l.textContent="Add skill",v.appendChild(l);const z=document.createElement("button");z.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",z.id="add-skill-button",z.style.fontSize="20px",z.textContent="+",v.appendChild(z);const q=document.createElement("div");q.className="flex justify-self-end mt-2 agent-card-connection",q.setAttribute("smt-name","Skills"),q.setAttribute("smt-color","#3C89F9");const tt=document.createElement("span");tt.className="name",tt.style.borderImage="linear-gradient(90deg, transparent 20%, rgb(60, 137, 249)) 1 / 1 / 0 stretch",tt.innerHTML='<span class="label text-gray-500"># Skills</span>',q.appendChild(tt);const Y=document.createElement("span");Y.className="block absolute ep w-[15px] h-[15px] rounded-full -right-[23px] float-left border-0 top-1/2 -translate-y-1/2",Y.style.backgroundColor="#3C89F9",q.appendChild(Y);const I=document.createElement("button");I.className="preview-button w-full ",I.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <span>Preview as Chatbot</span>
    `,k.appendChild(v),k.appendChild(q),u.appendChild(k),u.appendChild(I),C.appendChild(A),C.appendChild(u),await ye(50);const H=this.workspace.jsPlumbInstance.addEndpoint(q,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:-1,cssClass:"exclude-panzoom"});q.endpoint=H,H._domElement=q,i.appendChild(C),this.domElement=i,i._control=this,a.domElement.appendChild(i),this.makeDraggable(),this.addEventListeners(),this.emit("AgentCardCreated")}makeDraggable(){const a=this.workspace,i=this;ei(this.domElement).draggable({allowFrom:".agent-card",ignoreFrom:".agent-name",listeners:{start(h){if(a?.locked)return!1;i.domElement.classList.add("dragging"),i.domElement.style.cursor="grabbing"},move(h){if(a?.locked)return!1;if(!h.target)return;let j=[h.target];for(let C of j){const A=(parseFloat(C.style.left)||0)+h.dx/a.scale,s=(parseFloat(C.style.top)||0)+h.dy/a.scale;C.style.left=A+"px",C.style.top=s+"px",C._control.repaint()}},end(h){if(a?.locked)return!1;i.repaint(!0),i.domElement.style.cursor="",setTimeout(()=>{i.workspace.saveAgent(),i.domElement.classList.remove("dragging")},200)}},inertia:!0}).styleCursor(!1)}addEventListeners(){const a=this.domElement.querySelector("#add-skill-button");a&&a.addEventListener("click",async j=>{j.stopPropagation();const C=this.workspace.agent?.data?.components?.filter(o=>o.name==="APIEndpoint");if(C.length===0){const o=this.domElement.getBoundingClientRect(),m=await this.workspace.addComponent("APIEndpoint",{top:Number(this.properties.top.split("px")[0])+o.height+100+"px",left:Number(this.properties.left.split("px")[0])+o.width+450+"px"},!0);this.workspace.scrollToComponent(m),this.workspace.refreshComponentSelection(m);return}const A=C.reduce((o,m)=>Number(o.top.split("px")[0]||0)<Number(m.top.split("px")[0]||0)?m:o),s=document.querySelector(`#${A.id}`);let _;if(s){const o=s.getBoundingClientRect();_=Number(A.top.split("px")[0])+o.height+200+"px"}else _=Number(A.top.split("px")[0])+400+"px";const u=await this.workspace.addComponent("APIEndpoint",{top:_,left:A.left},!0);this.workspace.scrollToComponent(u),this.workspace.refreshComponentSelection(u)}),this.domElement.addEventListener("click",j=>{j.stopPropagation(),Fa(),Ra({rootID:"agent-settings-in-right-sidebar-root"})});const i=this.domElement.querySelector(".preview-button");i&&i.addEventListener("click",j=>{j.stopPropagation(),Ze.track("app_preview_as_chatbot_click");const C=document.querySelector("#btn-emb-chatbot-main"),A=document.querySelector("[data-embodiment-type='chat']"),s=document.querySelector("#right-container.open");if(!s&&C)C?.click(),A&&A?.click();else if(s){const _=document.querySelector("[data-embodiment-type='chat']");_&&_?.click()}});const h=this.domElement.querySelector(".agent-name");this.domElement.addEventListener("mousedown",j=>{j.stopPropagation()}),this.workspace.addEventListener("AgentSaved",()=>{h&&this.workspace.agent?.data?.name!=h.textContent&&(h.textContent=this.workspace.agent?.data?.name||""),document.querySelector("#agent-card-avatar"),document.querySelector("#agent-card-avatar-placeholder")}),this.workspace.agent.addEventListener("AvatarUpdated",j=>{const C=document.querySelector("#agent-card-avatar");C&&(C.src=j)})}makeAgentNameEditable(a){}destroy(){this._destroyed||(this.domElement&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),delete qo[this.uid],this._destroyed=!0)}async repaint(a=!1){if(a){let i=[...this.domElement.querySelectorAll(".endpoint")].map(h=>h?.endpoint?.connections).flat(1/0);i=[...new Set(i)],i.forEach(h=>{this.workspace.updateConnectionStyle(h)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async handleSkillsConnections(a){const i=a?.components?.filter(h=>h.name==="APIEndpoint");if(i)for(const h of i)await this.handleCompConn(h.id)}async handleCompConn(a){const i=document.querySelector(".agent-card .agent-card-connection");if(!i)return;const h=document.querySelector(`#${a} `);if(!h)return;const j=()=>{const _=h.querySelector(".agent-card-connection");_&&this.workspace.jsPlumbInstance.getConnections({source:i.id,target:_.id}).length===0&&this.workspace.jsPlumbInstance.connect({source:i.endpoint,target:_.endpoint,detachable:!0,cssClass:"exclude-panzoom",paintStyle:Zn.connPaintStyles})},C=()=>{const _=h.querySelector(".agent-card-connection");_&&this.workspace.jsPlumbInstance.getConnections({source:i.id,target:_.id}).forEach(u=>{this.workspace.jsPlumbInstance.deleteConnection(u)})};if(!h._control)return;const A=(_=>{_?.ai_exposed?j():C()}).bind(this),s=C.bind(this);h._control.removeEventListener("settingsSaved",A),h._control.removeEventListener("settingsDraftUpdated",A),h._control.removeEventListener("beforeDelete",s),h._control.addEventListener("settingsSaved",A),h._control.addEventListener("settingsDraftUpdated",A),h._control.addEventListener("beforeDelete",s),h._control.data.ai_exposed?j():C(),h._control.addEventListener("connectionDetached",async(_,u,o)=>{this._init_state_populated&&o.source.classList.contains("agent-card-connection")&&(h._control.data.ai_exposed=!1,await ye(100),this.workspace.saveAgent())}),h._control.addEventListener("connectionAttached",async(_,u,o)=>{this._init_state_populated&&o.source.classList.contains("agent-card-connection")&&(h._control.data.ai_exposed=!0,await ye(100),this.workspace.saveAgent())})}static checkConnValidity(a){return!a.target.classList.contains("agent-card-connection")&&a.source.classList.contains("agent-card-connection")||!a.source.classList.contains("agent-card-connection")&&a.target.classList.contains("agent-card-connection")?(Ba("Unsupported Connection",'You can only connect skill components directly to the agent. Please add a skill component first and then connect it to the agent card. <a href="https://smythos.com/documentation/#/" target="_blank" class="text-v2-blue underline hover:text-v2-blue/80">Read documentation</a>.',"OK","error"),!1):!0}static setConnPaintStyles(a){a.__smt_color=Zn.connPaintStyles.stroke,a.__smt_dashstyle=Zn.connPaintStyles.dashstyle,a.__smt_thickness=Zn.connPaintStyles.strokeWidth}static isCardConn(a){return a.source.classList.contains("agent-card-connection")}};Xl.connPaintStyles={stroke:"#8F8F8F",strokeWidth:2,dashstyle:"4 4"};typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(a,i){i=i||{bubbles:!1,cancelable:!1,detail:null};var h=document.createEvent("CustomEvent");return h.initCustomEvent(a,i.bubbles,i.cancelable,i.detail),h}));function Wl(g){var a=g.jsPlumb,i=g.jsPlumbUtil,h="Straight",j="Arc",C=function(A){this.type="SmythFlowchart",A=A||{},A.stub=A.stub==null?30:A.stub;var s,_=a.Connectors.AbstractConnector.apply(this,arguments),u=A.midpoint==null||isNaN(A.midpoint)?.5:A.midpoint,o=A.alwaysRespectStubs===!0,m=null,D=null,L=A.cornerRadius!=null?A.cornerRadius:0;A.loopbackRadius;var k=function(Y){return Y<0?-1:Y===0?0:1},v=function(Y){return[k(Y[2]-Y[0]),k(Y[3]-Y[1])]},l=function(Y,I,H,p){if(!(m===I&&D===H)){var E=m??p.sx,x=D??p.sy,B=E===I?"v":"h";m=I,D=H,Y.push([E,x,I,H,B])}},z=function(Y){return Math.sqrt(Math.pow(Y[0]-Y[2],2)+Math.pow(Y[1]-Y[3],2))},q=function(Y){var I=[];return I.push.apply(I,Y),I},tt=function(Y,I,H){for(var p=null,E,x,B,W=0;W<I.length-1;W++){if(p=p||q(I[W]),E=q(I[W+1]),x=v(p),B=v(E),L>0&&p[4]!==E[4]){var w=Math.min(z(p),z(E)),K=Math.min(L,w/1.5);p[2]-=x[0]*K,p[3]-=x[1]*K,E[0]+=B[0]*K,E[1]+=B[1]*K;var U=x[1]===B[0]&&B[0]===1||x[1]===B[0]&&B[0]===0&&x[0]!==B[1]||x[1]===B[0]&&B[0]===-1,O=E[1]>p[3]?1:-1,y=E[0]>p[2]?1:-1,X=O===y,ot=X&&U||!X&&!U?E[0]:p[2],Q=X&&U||!X&&!U?p[3]:E[1];_.addSegment(Y,h,{x1:p[0],y1:p[1],x2:p[2],y2:p[3]}),_.addSegment(Y,j,{r:K,x1:p[2],y1:p[3],x2:E[0],y2:E[1],cx:ot,cy:Q,ac:U})}else{var it=p[2]===p[0]?0:p[2]>p[0]?H.lw/2:-(H.lw/2),f=p[3]===p[1]?0:p[3]>p[1]?H.lw/2:-(H.lw/2);_.addSegment(Y,h,{x1:p[0]-it,y1:p[1]-f,x2:p[2]+it,y2:p[3]+f})}p=E}E!=null&&_.addSegment(Y,h,{x1:E[0],y1:E[1],x2:E[2],y2:E[3]})};this.midpoint=u,this._compute=function(Y,I){s=[],m=null,D=null,Y._meta||(Y._meta={});var H=I.sourceEndpoint._domElement,p=I.targetEndpoint._domElement;H.classList.contains("output-endpoint")||([H,p]=[p,H]);let E=0;const x=this._jsPlumb.instance.getZoom();if(H&&p){const M=H.getBoundingClientRect(),V=p.getBoundingClientRect(),et=Y._meta.sourceComponentElement||H.closest(".component");Y._meta.sourceComponentElement=et;const lt=et.getBoundingClientRect(),st=Y._meta.targetComponentElement||p.closest(".component");Y._meta.targetComponentElement=st;const ct=st.getBoundingClientRect(),Et=Y._meta.outputsElement||et.querySelector(".ep-control.outputs");Y._meta.outputsElement=Et;const yt=Y._meta.inputsElement||st.querySelector(".ep-control.inputs");Y._meta.inputsElement=yt;const vt=Et.getBoundingClientRect(),Ct=yt.getBoundingClientRect();if(V.left<=M.right){const Ot=(lt.bottom-M.top)/(lt.bottom-vt.bottom);u=(lt.bottom-15*x-M.top)/(V.bottom-M.bottom),u+=ct.bottom>lt.bottom?Ot/10:-Ot/10,ct.bottom<lt.top&&(u=(M.top-lt.top+15*x)/(M.bottom-V.bottom),u+=ct.bottom<lt.bottom?Ot/10:-Ot/10),E=26*Ot}else{const Ot=V.left-M.right;u=(lt.bottom-M.top)/(lt.bottom-vt.bottom),Ct.bottom<vt.top&&(u=1-u),Ot>110&&(u*=1/Ot*100*.6),u*=x}}var B=function(){return[Y.startStubX,Y.startStubY,Y.endStubX,Y.endStubY]},W={perpendicular:B,orthogonal:B,opposite:function(M){var V=Y,et=M==="x"?0:1,lt={x:function(){return V.so[et]===1&&(V.startStubX>V.endStubX&&V.tx>V.startStubX||V.sx>V.endStubX&&V.tx>V.sx)||V.so[et]===-1&&(V.startStubX<V.endStubX&&V.tx<V.startStubX||V.sx<V.endStubX&&V.tx<V.sx)},y:function(){return V.so[et]===1&&(V.startStubY>V.endStubY&&V.ty>V.startStubY||V.sy>V.endStubY&&V.ty>V.sy)||V.so[et]===-1&&(V.startStubY<V.endStubY&&V.ty<V.startStubY||V.sy<V.endStubY&&V.ty<V.sy)}};return!o&&lt[M]()?{x:[(Y.sx+Y.tx)/2,Y.startStubY,(Y.sx+Y.tx)/2,Y.endStubY],y:[Y.startStubX,(Y.sy+Y.ty)/2,Y.endStubX,(Y.sy+Y.ty)/2]}[M]:[Y.startStubX+E,Y.startStubY,Y.endStubX+E-20,Y.endStubY]}},w=W[Y.anchorOrientation](Y.sourceAxis),K=Y.sourceAxis==="x"?0:1,U=Y.sourceAxis==="x"?1:0,O=w[K],y=w[U],X=w[K+2],ot=w[U+2];l(s,w[0],w[1],Y);var Q=Y.startStubX+(Y.endStubX-Y.startStubX)*u,it=Y.startStubY+(Y.endStubY-Y.startStubY)*u,f={x:[0,1],y:[1,0]},S={perpendicular:function(M){var V=Y,et={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},lt={x:[[V.startStubX,V.endStubX],null,[V.endStubX,V.startStubX]],y:[[V.startStubY,V.endStubY],null,[V.endStubY,V.startStubY]]},st={x:[[Q,V.startStubY],[Q,V.endStubY]],y:[[V.startStubX,it],[V.endStubX,it]]},ct={x:[[V.endStubX,V.startStubY]],y:[[V.startStubX,V.endStubY]]},Et={x:[[V.startStubX,V.endStubY],[V.endStubX,V.endStubY]],y:[[V.endStubX,V.startStubY],[V.endStubX,V.endStubY]]},yt={x:[[V.startStubX,it],[V.endStubX,it],[V.endStubX,V.endStubY]],y:[[Q,V.startStubY],[Q,V.endStubY],[V.endStubX,V.endStubY]]},vt={x:[V.startStubY,V.endStubY],y:[V.startStubX,V.endStubX]},Ct=f[M][0],Ot=f[M][1],xt=V.so[Ct]+1,Pt=V.to[Ot]+1,Bt=V.to[Ot]===-1&&vt[M][1]<vt[M][0]||V.to[Ot]===1&&vt[M][1]>vt[M][0],Mt=lt[M][xt][0],gt=lt[M][xt][1],ht=et[M][xt][Pt];if(V.segment===ht[3]||V.segment===ht[2]&&Bt)return st[M];if(V.segment===ht[2]&&gt<Mt)return ct[M];if(V.segment===ht[2]&&gt>=Mt||V.segment===ht[1]&&!Bt)return yt[M];if(V.segment===ht[0]||V.segment===ht[1]&&Bt)return Et[M]},orthogonal:function(M,V,et,lt,st){var ct=Y,Et={x:ct.so[0]===-1?Math.min(V,lt):Math.max(V,lt),y:ct.so[1]===-1?Math.min(V,lt):Math.max(V,lt)}[M];return{x:[[Et,et],[Et,st],[lt,st]],y:[[et,Et],[st,Et],[st,lt]]}[M]},opposite:function(M,V,et,lt){var st=Y,ct={x:"y",y:"x"}[M],Et={x:"height",y:"width"}[M],yt=st["is"+M.toUpperCase()+"GreaterThanStubTimes2"];if(I.sourceEndpoint.elementId===I.targetEndpoint.elementId){var vt=et+(1-I.sourceEndpoint.anchor[ct])*I.sourceInfo[Et]+_.maxStub;return{x:[[V,vt],[lt,vt]],y:[[vt,V],[vt,lt]]}[M]}else{if(!yt||st.so[K]===1&&V>lt||st.so[K]===-1&&V<lt)return{x:[[V,it],[lt,it]],y:[[Q,V],[Q,lt]]}[M];if(st.so[K]===1&&V<lt||st.so[K]===-1&&V>lt)return{x:[[Q,st.sy],[Q,st.ty]],y:[[st.sx,it],[st.tx,it]]}[M]}}},c=S[Y.anchorOrientation](Y.sourceAxis,O,y,X,ot);if(c)for(var R=0;R<c.length;R++)l(s,c[R][0],c[R][1],Y);l(s,w[2],w[3],Y),l(s,Y.tx,Y.ty,Y),tt(this,s,Y)}};a.Connectors.SmythFlowchart=C,i.extend(a.Connectors.SmythFlowchart,a.Connectors.AbstractConnector)}function Kl(g){var a=g.jsPlumb,i=g.jsPlumbUtil,h=function(j){j=j||{},this.type="SmythBezier";var C=a.Connectors.AbstractBezierConnector.apply(this,arguments),A=j.curviness||150,s=10;this.getCurviness=function(){return A},this._findControlPoint=function(_,u,o,m,D,L,k){let v=A,l=m._domElement,z=D._domElement;try{if(l&&z){l.classList.contains("output-endpoint")||([l,z]=[z,l]);var q=l.closest(".component").getBoundingClientRect(),tt=z.closest(".component").getBoundingClientRect();const H=tt.left-q.right,p=q.bottom<tt.top||tt.bottom<q.top,E=Math.min(Math.abs(q.top-tt.bottom),Math.abs(q.bottom-tt.top));v=p||H>150?A:50}else v=s}catch(H){console.log("Error in _findControlPoint",H)}var Y=L[0]!==k[0]||L[1]===k[1],I=[];return Y?(k[0]===0?I.push(o[0]<u[0]?_[0]+s:_[0]-s):I.push(_[0]+v*k[0]),k[1]===0?I.push(o[1]<u[1]?_[1]+s:_[1]-s):I.push(_[1]+v*L[1])):(L[0]===0?I.push(u[0]<o[0]?_[0]+s:_[0]-s):I.push(_[0]-v*L[0]),L[1]===0?I.push(u[1]<o[1]?_[1]+s:_[1]-s):I.push(_[1]+v*k[1])),I},this._computeBezier=function(_,u,o,m,D,L){var k,v,l=o[0]<m[0]?D:0,z=o[1]<m[1]?L:0,q=o[0]<m[0]?0:D,tt=o[1]<m[1]?0:L;k=this._findControlPoint([l,z],o,m,u.sourceEndpoint,u.targetEndpoint,_.so,_.to),v=this._findControlPoint([q,tt],m,o,u.targetEndpoint,u.sourceEndpoint,_.to,_.so),C.addSegment(this,"Bezier",{x1:l,y1:z,x2:q,y2:tt,cp1x:k[0],cp1y:k[1],cp2x:v[0],cp2y:v[1]})}};a.Connectors.SmythBezier=h,i.extend(h,a.Connectors.AbstractBezierConnector)}function Jl(){Wl(window),Kl(window)}var Er=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function wr(g,a,i,h){g.addEventListener?g.addEventListener(a,i,h):g.attachEvent&&g.attachEvent("on".concat(a),function(){i(window.event)})}function ss(g,a){for(var i=a.slice(0,a.length-1),h=0;h<i.length;h++)i[h]=g[i[h].toLowerCase()];return i}function as(g){typeof g!="string"&&(g=""),g=g.replace(/\s/g,"");for(var a=g.split(","),i=a.lastIndexOf("");i>=0;)a[i-1]+=",",a.splice(i,1),i=a.lastIndexOf("");return a}function Zl(g,a){for(var i=g.length>=a.length?g:a,h=g.length>=a.length?a:g,j=!0,C=0;C<i.length;C++)h.indexOf(i[C])===-1&&(j=!1);return j}var ni={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":Er?173:189,"=":Er?61:187,";":Er?59:186,"'":222,"[":219,"]":221,"\\":220},$e={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},Or={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},be={16:!1,18:!1,17:!1,91:!1},le={};for(var Ri=1;Ri<20;Ri++)ni["f".concat(Ri)]=111+Ri;var re=[],zo=!1,ls="all",us=[],ri=function(a){return ni[a.toLowerCase()]||$e[a.toLowerCase()]||a.toUpperCase().charCodeAt(0)},Ql=function(a){return Object.keys(ni).find(function(i){return ni[i]===a})},tu=function(a){return Object.keys($e).find(function(i){return $e[i]===a})};function cs(g){ls=g||"all"}function ii(){return ls||"all"}function eu(){return re.slice(0)}function nu(){return re.map(function(g){return Ql(g)||tu(g)||String.fromCharCode(g)})}function iu(){var g=[];return Object.keys(le).forEach(function(a){le[a].forEach(function(i){var h=i.key,j=i.scope,C=i.mods,A=i.shortcut;g.push({scope:j,shortcut:A,mods:C,keys:h.split("+").map(function(s){return ri(s)})})})}),g}function ru(g){var a=g.target||g.srcElement,i=a.tagName,h=!0;return(a.isContentEditable||(i==="INPUT"||i==="TEXTAREA"||i==="SELECT")&&!a.readOnly)&&(h=!1),h}function ou(g){return typeof g=="string"&&(g=ri(g)),re.indexOf(g)!==-1}function su(g,a){var i,h;g||(g=ii());for(var j in le)if(Object.prototype.hasOwnProperty.call(le,j))for(i=le[j],h=0;h<i.length;)i[h].scope===g?i.splice(h,1):h++;ii()===g&&cs(a||"all")}function au(g){var a=g.keyCode||g.which||g.charCode,i=re.indexOf(a);if(i>=0&&re.splice(i,1),g.key&&g.key.toLowerCase()==="meta"&&re.splice(0,re.length),(a===93||a===224)&&(a=91),a in be){be[a]=!1;for(var h in $e)$e[h]===a&&(an[h]=!1)}}function lu(g){if(typeof g>"u")Object.keys(le).forEach(function(A){return delete le[A]});else if(Array.isArray(g))g.forEach(function(A){A.key&&Cr(A)});else if(typeof g=="object")g.key&&Cr(g);else if(typeof g=="string"){for(var a=arguments.length,i=new Array(a>1?a-1:0),h=1;h<a;h++)i[h-1]=arguments[h];var j=i[0],C=i[1];typeof j=="function"&&(C=j,j=""),Cr({key:g,scope:j,method:C,splitKey:"+"})}}var Cr=function(a){var i=a.key,h=a.scope,j=a.method,C=a.splitKey,A=C===void 0?"+":C,s=as(i);s.forEach(function(_){var u=_.split(A),o=u.length,m=u[o-1],D=m==="*"?"*":ri(m);if(le[D]){h||(h=ii());var L=o>1?ss($e,u):[];le[D]=le[D].filter(function(k){var v=j?k.method===j:!0;return!(v&&k.scope===h&&Zl(k.mods,L))})}})};function Uo(g,a,i,h){if(a.element===h){var j;if(a.scope===i||a.scope==="all"){j=a.mods.length>0;for(var C in be)Object.prototype.hasOwnProperty.call(be,C)&&(!be[C]&&a.mods.indexOf(+C)>-1||be[C]&&a.mods.indexOf(+C)===-1)&&(j=!1);(a.mods.length===0&&!be[16]&&!be[18]&&!be[17]&&!be[91]||j||a.shortcut==="*")&&(a.keys=[],a.keys=a.keys.concat(re),a.method(g,a)===!1&&(g.preventDefault?g.preventDefault():g.returnValue=!1,g.stopPropagation&&g.stopPropagation(),g.cancelBubble&&(g.cancelBubble=!0)))}}}function Vo(g,a){var i=le["*"],h=g.keyCode||g.which||g.charCode;if(an.filter.call(this,g)){if((h===93||h===224)&&(h=91),re.indexOf(h)===-1&&h!==229&&re.push(h),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(k){var v=Or[k];g[k]&&re.indexOf(v)===-1?re.push(v):!g[k]&&re.indexOf(v)>-1?re.splice(re.indexOf(v),1):k==="metaKey"&&g[k]&&re.length===3&&(g.ctrlKey||g.shiftKey||g.altKey||(re=re.slice(re.indexOf(v))))}),h in be){be[h]=!0;for(var j in $e)$e[j]===h&&(an[j]=!0);if(!i)return}for(var C in be)Object.prototype.hasOwnProperty.call(be,C)&&(be[C]=g[Or[C]]);g.getModifierState&&!(g.altKey&&!g.ctrlKey)&&g.getModifierState("AltGraph")&&(re.indexOf(17)===-1&&re.push(17),re.indexOf(18)===-1&&re.push(18),be[17]=!0,be[18]=!0);var A=ii();if(i)for(var s=0;s<i.length;s++)i[s].scope===A&&(g.type==="keydown"&&i[s].keydown||g.type==="keyup"&&i[s].keyup)&&Uo(g,i[s],A,a);if(h in le){for(var _=0;_<le[h].length;_++)if((g.type==="keydown"&&le[h][_].keydown||g.type==="keyup"&&le[h][_].keyup)&&le[h][_].key){for(var u=le[h][_],o=u.splitKey,m=u.key.split(o),D=[],L=0;L<m.length;L++)D.push(ri(m[L]));D.sort().join("")===re.sort().join("")&&Uo(g,u,A,a)}}}}function uu(g){return us.indexOf(g)>-1}function an(g,a,i){re=[];var h=as(g),j=[],C="all",A=document,s=0,_=!1,u=!0,o="+",m=!1;for(i===void 0&&typeof a=="function"&&(i=a),Object.prototype.toString.call(a)==="[object Object]"&&(a.scope&&(C=a.scope),a.element&&(A=a.element),a.keyup&&(_=a.keyup),a.keydown!==void 0&&(u=a.keydown),a.capture!==void 0&&(m=a.capture),typeof a.splitKey=="string"&&(o=a.splitKey)),typeof a=="string"&&(C=a);s<h.length;s++)g=h[s].split(o),j=[],g.length>1&&(j=ss($e,g)),g=g[g.length-1],g=g==="*"?"*":ri(g),g in le||(le[g]=[]),le[g].push({keyup:_,keydown:u,scope:C,mods:j,shortcut:h[s],method:i,key:h[s],splitKey:o,element:A});typeof A<"u"&&!uu(A)&&window&&(us.push(A),wr(A,"keydown",function(D){Vo(D,A)},m),zo||(zo=!0,wr(window,"focus",function(){re=[]},m)),wr(A,"keyup",function(D){Vo(D,A),au(D)},m))}function cu(g){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(le).forEach(function(i){var h=le[i].filter(function(j){return j.scope===a&&j.shortcut===g});h.forEach(function(j){j&&j.method&&j.method()})})}var xr={getPressedKeyString:nu,setScope:cs,getScope:ii,deleteScope:su,getPressedKeyCodes:eu,getAllKeyCodes:iu,isPressed:ou,filter:ru,trigger:cu,unbind:lu,keyMap:ni,modifier:$e,modifierMap:Or};for(var Pr in xr)Object.prototype.hasOwnProperty.call(xr,Pr)&&(an[Pr]=xr[Pr]);if(typeof window<"u"){var du=window.hotkeys;an.noConflict=function(g){return g&&window.hotkeys===an&&(window.hotkeys=du),an},window.hotkeys=an}var fu={exports:{}};(function(g,a){(function(i,h){h()})(ie,function(){function i(u,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function h(u,o,m){var D=new XMLHttpRequest;D.open("GET",u),D.responseType="blob",D.onload=function(){_(D.response,o,m)},D.onerror=function(){console.error("could not download file")},D.send()}function j(u){var o=new XMLHttpRequest;o.open("HEAD",u,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function C(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(o)}}var A=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ie=="object"&&ie.global===ie?ie:void 0,s=A.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=A.saveAs||(typeof window!="object"||window!==A?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,o,m){var D=A.URL||A.webkitURL,L=document.createElement("a");o=o||u.name||"download",L.download=o,L.rel="noopener",typeof u=="string"?(L.href=u,L.origin===location.origin?C(L):j(L.href)?h(u,o,m):C(L,L.target="_blank")):(L.href=D.createObjectURL(u),setTimeout(function(){D.revokeObjectURL(L.href)},4e4),setTimeout(function(){C(L)},0))}:"msSaveOrOpenBlob"in navigator?function(u,o,m){if(o=o||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(i(u,m),o);else if(j(u))h(u,o,m);else{var D=document.createElement("a");D.href=u,D.target="_blank",setTimeout(function(){C(D)})}}:function(u,o,m,D){if(D=D||open("","_blank"),D&&(D.document.title=D.document.body.innerText="downloading..."),typeof u=="string")return h(u,o,m);var L=u.type==="application/octet-stream",k=/constructor/i.test(A.HTMLElement)||A.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||L&&k||s)&&typeof FileReader<"u"){var l=new FileReader;l.onloadend=function(){var tt=l.result;tt=v?tt:tt.replace(/^data:[^;]*;/,"data:attachment/file;"),D?D.location.href=tt:location=tt,D=null},l.readAsDataURL(u)}else{var z=A.URL||A.webkitURL,q=z.createObjectURL(u);D?D.location=q:location.href=q,D=null,setTimeout(function(){z.revokeObjectURL(q)},4e4)}});A.saveAs=_.saveAs=_,g.exports=_})})(fu);window.__GLOBAL_TEMPLATE_VARIABLES__=new Map;function Ho(g,a,i){if(!a)return;const h=Array.isArray(a)?a:a.trim().split(/\s+/);g.classList[i](...h)}function Nr(g={step:{enable:!1},run:{enable:!1,tooltipText:"Run",icon:"mif-play"},stop:{enable:!1},attach:{enable:!1}},a={}){for(const[C,A]of Object.entries(g)){if(!A)continue;const s=document.getElementById(`debug-menubtn-${C}`);if(!s)continue;const{enable:_,classesToAdd:u,classesToRemove:o,tooltipText:m,icon:D}=A;if(_?s.removeAttribute("disabled"):s.setAttribute("disabled","true"),Ho(s,u,"add"),Ho(s,o,"remove"),m){const L=document.querySelector(`#tooltip-${C}`);L&&(L.textContent=m)}if(D){s.querySelectorAll(".debug-btn-icon").forEach(k=>k.classList.add("hidden"));const L=s.querySelector(`.${D}`);L&&L.classList.remove("hidden")}}const i=document.getElementById("debug-controls-overlay"),h=document.getElementById("tooltip-controls-overlay"),j=a.controlsOverlay;j?.enable?(i?.classList.remove("hidden"),j.tooltipText&&h&&(h.textContent=j.tooltipText)):i?.classList.add("hidden")}function ds(g={}){Nr({run:{enable:!0},step:{enable:!0},stop:{enable:!0},attach:{enable:!0}},g)}function $o(){const g=!!document.querySelector(".component.selected"),a=!!document.querySelector(".component.dbg-active"),i=!!document.querySelector(".component.dbg-running");if(a||i)return;const h=document.getElementById("debug-menu-tgl")?.checked;g&&h?ds({controlsOverlay:{enable:!1}}):Nr({run:{enable:!1},step:{enable:!1},stop:{enable:!1},attach:{enable:h}},{controlsOverlay:{enable:!h||!g,tooltipText:h?"Please select a component":"Click to toggle debug"}})}class fs{static send(a,i){let h=typeof a=="string"?a:JSON.stringify(a);const j=i.includes("all");(j||i.includes("chatbot"))&&this.sendChatbotMsg(h),(j||i.includes("swagger"))&&this.sendSwaggerMsg(h)}static sendChatbotMsg(a){const i=document.querySelector("#chatbot-iframe");i&&i.contentWindow.postMessage(a,"*")}static sendSwaggerMsg(a){const i=document.querySelector("#swagger-iframe");i&&i.contentWindow.postMessage(a,"*")}}Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;var hu=`/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
`;qa(hu);const pu=g=>/^-?\d+(\.\d+)?$/.test(g.trim()),gu=g=>{const a=parseFloat(g);return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER&&a.toString()===g.trim()};function vu(g){if(!g)return null;if(pu(g)&&!gu(g)||!g.trim().startsWith("{")&&!g.trim().startsWith("["))return g;try{return JSON.parse(g)}catch{try{return JSON.parse(rs(g))}catch(a){return console.error("Error on parseJson: ",a.toString()),console.error("   Tried to parse: ",g),null}}}class mu{constructor(a,i={}){this.wrapper=a,this.options={debounceDelay:300,mutatingClass:"mutating",mutatingWrapperClass:"jfs_has_mutating",mutationDuration:300,jsonFieldClass:"jfs_json_field",...i},this.parentMap=new Map,this.previousValues=new Map,this.initializeStructure(),this.bindEvents()}initializeStructure(){Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression]`)).filter(a=>!/[\.\[\]]/.test(a.dataset.expression)).forEach(a=>{const i=a.dataset.expression,h=this.findChildren(i),j=h.some(C=>C.path.includes("["));this.parentMap.set(a,{data:j?[]:{},children:h,isArray:j})})}findChildren(a){return Array.from(this.wrapper.querySelectorAll(`.${this.options.jsonFieldClass}[data-expression^="${a}["], .${this.options.jsonFieldClass}[data-expression^="${a}."]`)).map(i=>({element:i,path:i.dataset.expression.replace(a,"")}))}bindEvents(){this.parentMap.forEach((a,i)=>{let h;i.addEventListener("input",()=>{clearTimeout(h),h=setTimeout(()=>this.handleParentUpdate(i,a),this.options.debounceDelay)}),a.children.forEach(j=>{j.element.addEventListener("input",()=>this.handleChildUpdate(i,j,a)),j.element.addEventListener("focus",()=>this.handleFocus(j.element,i)),j.element.addEventListener("blur",()=>this.handleBlur(j.element,i))}),i.addEventListener("focus",()=>this.handleFocus(i,i)),i.addEventListener("blur",()=>this.handleBlur(i,i))})}handleParentUpdate(a,i){const h=a.value?.trim()||"";try{let j,C=!0;if(i.data&&(i.isArray&&!Array.isArray(i.data)&&(C=!1),!i.isArray&&typeof i.data!="object"&&(C=!1)),C||(i.data=i.isArray?[]:{}),h)try{j=JSON.parse(h)}catch{try{const A=_=>{try{return JSON.parse(_)}catch{try{if(!s(_))return _.startsWith("[")?[]:{};let u=_;u=u.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let o=!1,m=!1,D="";for(let k=0;k<u.length;k++){const v=u[k];v==='"'&&(k===0||u[k-1]!=="\\")?(m||(o=!o),D+=v):v==="'"&&(k===0||u[k-1]!=="\\")?o?D+=v:(m=!m,D+='"'):D+=v}u=D.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const L=u.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(L)}catch{return _.startsWith("[")?[]:{}}}},s=_=>{let u=!1,o=!1,m=[];for(let D=0;D<_.length;D++){const L=_[D],k=D>0?_[D-1]:"";if(L==='"'&&k!=="\\"?o||(u=!u):L==="'"&&k!=="\\"&&(u||(o=!o)),!(u||o)){if(L==="{"||L==="[")m.push(L);else if(L==="}"){if(m.length===0||m.pop()!=="{")return!1}else if(L==="]"&&(m.length===0||m.pop()!=="["))return!1}}return!u&&!o&&m.length===0};j=A(h)}catch{j=i.isArray?[]:{}}}else j=i.isArray?[]:{};i.data=j,typeof j!="object"||j===null?i.children.forEach(A=>{A.element.value=""}):this.updateChildren(i,a),a.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass)}catch{i.data=i.isArray?[]:{},i.children.forEach(j=>{j.element.value=""})}}handleChildUpdate(a,i,h){let j=i.element.value?.trim()||"";try{let C;try{if(C=JSON.parse(a.value),h.isArray&&!Array.isArray(C))throw new Error("Parent data structure mismatch");if(!h.isArray&&typeof C!="object")throw new Error("Parent data structure mismatch")}catch{C=h.isArray?[]:{}}h.data=C;const A=this.parsePath(i.path,h.isArray);this.clearAllMutations(),a.classList.add(this.options.mutatingClass),i.element.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass);let s=j;if(j&&(j.startsWith("{")&&j.endsWith("}")||j.startsWith("[")&&j.endsWith("]")))try{s=JSON.parse(j)}catch{try{s=(_=>{try{return JSON.parse(_)}catch{try{let u=_;u=u.replace(/\\"/g,"___ESCAPED_DOUBLE_QUOTE___");let o=!1,m=!1,D="";for(let k=0;k<u.length;k++){const v=u[k],l=u[k+1]||"";v==='"'&&(k===0||u[k-1]!=="\\")?(m||(o=!o),D+=v):v==="'"&&(k===0||u[k-1]!=="\\")?o?D+=v:(m=!m,D+='"'):D+=v}u=D.replace(/___ESCAPED_DOUBLE_QUOTE___/g,'\\"');const L=u.replace(/({|\[|\,)\s*?(\w+)\s*?:/g,'$1"$2":');return JSON.parse(L)}catch{return _}}})(j)}catch{}}this.updateValue(h.data,A,s),a.value=JSON.stringify(h.data,null,2),typeof s=="object"&&s!==null?this.previousValues.set(i.element,JSON.stringify(s)):this.previousValues.set(i.element,String(s)),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration)}catch{}}updateValue(a,i,h){if(i.isArray){let j=a;for(let A=0;A<i.indices.length-1;A++){const s=i.indices[A];for(;j.length<=s;)j.push(A===i.indices.length-2?[]:{});Array.isArray(j[s])||(j[s]=[]),j=j[s]}const C=i.indices[i.indices.length-1];for(;j.length<=C;)j.push({});if(i.props.length>0){let A=j[C];for(let s=0;s<i.props.length-1;s++){const _=i.props[s];(!A[_]||typeof A[_]!="object")&&(A[_]={}),A=A[_]}A[i.props[i.props.length-1]]=h}else j[C]=h}else{let j=a;i.props.length>0&&(i.props.slice(0,-1).forEach(C=>{(!j[C]||typeof j[C]!="object")&&(j[C]={}),j=j[C]}),j[i.props[i.props.length-1]]=h)}}parsePath(a,i){const h=[...a.matchAll(/\[(\d+)\]/g)].map(j=>parseInt(j[1]));if(h.length>0){const j=a.replace(/\[\d+\]/g,"").replace(/^\./,""),C=j?j.split(".").filter(Boolean):[];return{isArray:!0,indices:h,props:C}}return{isArray:!1,props:a.replace(/^\./,"").split(".").filter(Boolean)}}updateChildren(a,i){if(this.clearAllMutations(),typeof a.data!="object"||a.data===null){a.children.forEach(j=>{j.element.value=""});return}let h=!1;a.children.forEach(j=>{try{const C=this.parsePath(j.path,a.isArray),A=this.previousValues.get(j.element)||"",s=this.getValue(a.data,C);let _=!1;if(s.startsWith("{")||s.startsWith("["))try{const u=A?JSON.parse(A):null,o=s?JSON.parse(s):null;_=JSON.stringify(u)!==JSON.stringify(o)}catch{_=s!==A}else _=s!==A;_&&(j.element.classList.add(this.options.mutatingClass),h=!0,this.previousValues.set(j.element,s)),j.element.value=s}catch(C){console.error("Child update error:",C),j.element.value=""}}),h&&(i.classList.add(this.options.mutatingClass),this.wrapper.classList.add(this.options.mutatingWrapperClass),setTimeout(()=>this.clearAllMutations(),this.options.mutationDuration))}getValue(a,i){if(!a||typeof a!="object")return"";let h=a;if(i.isArray){for(const j of i.indices){if(!Array.isArray(h)||j>=h.length)return"";h=h[j]}for(const j of i.props)if(!h||typeof h!="object"||(h=h[j],h===void 0))return"";return this.formatValueForDisplay(h)}else{for(let j=0;j<i.props.length;j++){const C=i.props[j];if(!h||typeof h!="object"||(h=h[C],h===void 0))return""}return this.formatValueForDisplay(h)}}formatValueForDisplay(a){return a==null?"":typeof a=="object"?JSON.stringify(a,null,2):String(a)}handleFocus(a,i){clearTimeout(this.blurTimeout),this.wrapper.classList.add("jfs_has_focused"),this.wrapper.querySelectorAll(".focused").forEach(h=>h.classList.remove("focused")),a.classList.add("focused"),a===i?this.parentMap.get(i).children.forEach(h=>h.element.classList.add("focused")):i.classList.add("focused")}handleBlur(a,i){this.blurTimeout=setTimeout(()=>{const h=[i,...this.parentMap.get(i).children.map(j=>j.element)];h.some(j=>j.matches(":focus"))||(h.forEach(j=>j.classList.remove("focused")),this.wrapper.querySelector(".focused")||this.wrapper.classList.remove("jfs_has_focused"))},50)}clearAllMutations(){this.wrapper.querySelectorAll(`.${this.options.mutatingClass}`).forEach(a=>a.classList.remove(this.options.mutatingClass)),this.wrapper.classList.remove(this.options.mutatingWrapperClass)}}async function Tr(g){return(await Fr(g))?.enabled===!0}async function Fr(g){const a=Hi.get($i)||{};let i=a?.[g];if(!i)try{const h=workspace?.agent?.id;i=(await(await fetch(`/api/page/builder/mock-data/${h}/${g}`)).json())?.data,Hi.set($i,{...a,[g]:i})}catch{console.warn("Failed to fetch mock data:")}return i||{}}async function hs(g,a){const i={...a,updatedAt:new Date().toISOString()};try{const h=workspace?.agent?.id;if((await fetch(`/api/page/builder/mock-data/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[g]:i})})).ok){const j=Hi.get($i)||{},C={...j?.[g]||{},...i};j[g]=C,Hi.set($i,j)}}catch{console.warn("Failed to save Mock Data")}}const ln={BUTTON_CLASS:"_mock_data_toggle_btn",SAVE_BTN_CLASS:"_mock_data_save_btn",SAVE_BTN_LABEL_CLASS:"_mock_data_save_btn__label",LABEL_CLASS:"_btn_label",ICON_CLASS:"_btn_icon"},je={ENABLED:{icon:"fa-toggle-on",label:"Mock Data Enabled",color:"text-[#3C89F9]"},DISABLED:{icon:"fa-toggle-off",label:"Use Mock Data",color:"text-grey-600"}};function ps(g){return new Promise(async(a,i)=>{const h=async(A,s)=>{const _=(await Fr(g.uid))?.data?.outputs||{};return A.map((u,o)=>{let m=_?.[u?.name]??"";m=typeof m=="object"?JSON.stringify(m,null,2):String(m);const D=u?.fieldClasses||"",L=Object.entries(u?.attributes||{}).map(([k,v])=>`${k}="${v}"`).join(" ");return u.type==="file"?`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${u.name}
                </span>
                <input type="file" name="${u.name}" id="${s}-input-${o}" class="${s}-input input
                  block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4 file:rounded-md
                  file:border-0 file:text-sm file:font-semibold
                  file:bg-gray-200 file:text-gray-900
                  hover:file:bg-gray-300 pl-5
                " multiple>
              </div>`:`
              <div class="flex mb-5">
                <span class="inline-flex w-40 items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600 break-all">
                  ${u.name}
                </span>
                <textarea id="${s}-input-${o}" name="${u.name}" class="${s}-input input block p-1 w-full text-sm text-gray-900 bg-gray-50 rounded-e-md border border-gray-300 focus:ring-blue-500 focus:border-blue-500 ${D}" style="min-height:44px; height: 44px;" ${L}>${m}</textarea>
              </div>`}).join("")},j=[...g.domElement.querySelectorAll(".output-endpoint")].map(A=>{const s=A.getAttribute("smt-name"),_=A.getAttribute("smt-expression")||s;return{name:s,expression:_,fieldClasses:Do,attributes:{"data-expression":_}}}),C=await h(j,"outputs");Jo({title:"Configure Mock Output Data",content:`
        <div class="mb-4">
          <p class="text-xs text-gray-500">
            Mock output data allows you to test your component without requiring actual API keys or credentials. 
            Configure sample responses below to simulate the component's behavior.
          </p>
        </div>
        ${C}
      `,actions:[{label:`<span class="flex items-center gap-2">
                  <span class="fa-solid fa-save"></span>
                  <span class="!text-[#3b82f6] group-hover:!text-white ${ln.SAVE_BTN_LABEL_CLASS}">Save</span>
                </span>`,cssClass:`border border-[#3b82f6] bg-white hover:bg-[#3b82f6] group transition-all duration-200 !text-[#3b82f6] hover:!text-white ${ln.SAVE_BTN_CLASS}`,callback:async(A,s)=>{const _=s.querySelector(`.${ln.SAVE_BTN_CLASS}`),u=_.querySelector(`.${ln.SAVE_BTN_LABEL_CLASS}`);_.disabled=!0,_?.classList.add("cursor-not-allowed"),u.textContent="Saving...";const o={},m=Array.from(s.querySelectorAll(".outputs-input.input")).reduce((D,L,k)=>{let v;try{o[k]?v=o[k].value:v=vu(L.value)||L.value}catch{v=L.value}return D[j[k].name]=v,D},{});try{await hs(g.uid,{enabled:!0,data:{outputs:m}}),Ze.track("app_set_mock_data"),a("saved")}finally{_.disabled=!1,_?.classList.remove("cursor-not-allowed"),u.textContent="Save",Gi(s)}}}],onCloseClick:(A,s)=>{i("close"),Gi(s)},onDOMReady:function(A){new mu(A.querySelector(".__content"),{jsonFieldClass:Do});const s=A.querySelector(".__actions");s.classList.remove("justify-center"),s.classList.add("justify-end")}})})}async function Rr(g){const a=[...g.domElement.querySelectorAll(".output-endpoint")];if(await Tr(g.uid)){const i=await Fr(g.uid);for(const h of a){const j=h.getAttribute("smt-name");let C=i?.data?.outputs?.[j];C&&h.setAttribute("smt-mock-data",typeof C=="object"?JSON.stringify(C):C)}}else a.forEach(i=>{i.removeAttribute("smt-mock-data")})}const Qn={elements(g){return{button:g.domElement.querySelector(`.${ln.BUTTON_CLASS}`),label:g.domElement.querySelector(`.${ln.LABEL_CLASS}`),icon:g.domElement.querySelector(`.${ln.ICON_CLASS}`)}},turnOn(g){const{button:a,label:i,icon:h}=this.elements(g);a.classList.remove(je.DISABLED.color),a.classList.add(je.ENABLED.color),i.textContent=je.ENABLED.label,h.classList.remove(je.DISABLED.icon),h.classList.add(je.ENABLED.icon)},turnOff(g){const{button:a,label:i,icon:h}=this.elements(g);a.classList.remove(je.ENABLED.color),a.classList.add(je.DISABLED.color),i.textContent=je.DISABLED.label,h.classList.remove(je.ENABLED.icon),h.classList.add(je.DISABLED.icon)},setLoadingState(g){const{button:a}=this.elements(g);a.classList.contains("text-[#3C89F9]")&&a.classList.remove("text-[#3C89F9]"),a.disabled=!0,a.classList.add("cursor-not-allowed")},clearLoadingState(g){const{button:a}=this.elements(g);a.disabled=!1,a.classList.remove("cursor-not-allowed")}},Ar=new Set;async function yu(g){const a=g.uid;if(!Ar.has(a)){Ar.add(a);try{const i=await Tr(a)?"ENABLED":"DISABLED";let h=je[i].label,j=je[i].icon,C=je[i].color;g.addComponentButton(`<div class="fa-solid ${j} text-base _btn_icon"></div>
       <span class="ml-2 font-semibold _btn_label">${h}</span>`," ",{class:`${ln.BUTTON_CLASS} ${C} transition-opacity duration-300`,customStyle:"toggle",position:"top"},async()=>{try{const A=async()=>{await Tr(a)?(await hs(g.uid,{enabled:!1}),Qn.turnOff(g)):(Ze.track("app_mock_screen_impression",{source:"use_mock_data_button"}),await ps(g),Qn.turnOn(g))};Qn.setLoadingState(g),await A(),await Rr(g)}catch{console.error("Failed to toggle mock data")}finally{Qn.clearLoadingState(g)}})}finally{Ar.delete(a)}}}Oo.languages.smythLog={error:{pattern:/^Error\s:.*$/m,inside:{keyword:/^Error/},greedy:!0},json:{pattern:/{[^{}]*}/,inside:Oo.languages.json,greedy:!0}};Jl();const Fe={conStartColor:"#3C89F9",conEndColor:"#F35063"};function bu(g){const a=this;g.querySelector(".title");const i=g.querySelector(".dialog-actions");g.querySelector(".title-right-buttons");const h=g.querySelector(".title-left-buttons"),j=i.querySelector("button.del-btn");j.classList.remove("hidden"),j.onclick=a.delete.bind(this,!1);const C=a.properties?.template?.templateInfo?.docPath||"/not-set",A=a.properties?.template?a.workspace.serverData.docUrl+"/#"+C:a.docUrl,s=h.querySelector(".action-help");s.onclick=()=>{window.open(A,"_blank")},a.properties?.template&&!a.properties?.template?.templateInfo?.docPath&&s.classList.add("hidden"),a.workspace?.locked?(Ua(g,["close-btn","action-help"]),g.querySelector(".save-btn").classList.add("hidden"),g.querySelector(".del-btn").classList.add("hidden")):(g.querySelector(".save-btn").classList.remove("hidden"),g.querySelector(".del-btn").classList.remove("hidden"));const _=g.querySelector("form");function u(m){wu(a)}const o=Ha(u,500);_.addEventListener("input",function(m){(m.target.tagName==="INPUT"||m.target.tagName==="TEXTAREA")&&o(m)}),_.addEventListener("change",function(m){(m.target.tagName==="SELECT"||m.target.tagName==="INPUT"&&(m.target.type==="checkbox"||m.target.type==="radio"))&&o(m)}),a.emit("settingsOpened",g,this)}function _u(g){const a=this;a.properties.template,g.querySelector(".title");const i=g.querySelector(".dialog-actions"),h=g.querySelector(".title-right-buttons"),j=g.querySelector(".title-left-buttons");h.querySelector("button.close-btn").classList.remove("hidden"),h.querySelector("button.save-btn").classList.add("hidden"),i.querySelector("button.del-btn").classList.add("hidden"),j.querySelector(".action-help").classList.add("hidden"),a.data._templateVars;const C=a.properties?.template?.templateInfo,A=g.querySelector("form.Settings");if(A){const s=[...A.querySelectorAll(".form-box")],_=(u,o)=>{let m=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm.exec(u.value);const D=u.closest(".form-box").querySelector(".chk-bind-setting");if(!D)return;const L=D?.previousElementSibling;m?(D.checked=!1,D.disabled=!0,D.classList.add("hidden"),L.innerHTML="Override Not allowed With Custom Variables"):(D.disabled=!1,D.classList.remove("hidden"),L.innerText="Allow Override")};for(let u of s){const o=document.createElement("div");u.appendChild(o);const m=u.querySelectorAll("input, textarea");m?.forEach(tt=>{tt.addEventListener("change",Y=>{console.log("Change Event",Y),_(Y.target)}),tt.addEventListener("mouseout",Y=>_(Y.target)),tt.addEventListener("keyup",Y=>{(Y.ctrlKey||Y.metaKey)&&_(Y.target)}),setTimeout(()=>_(tt),1e3)}),A.addEventListener("mouseout",tt=>{m.forEach(Y=>{_(Y)})});const D=document.createElement("div");D.className="float-right inline-block rounded-full",D.style.pointerEvents="auto";const L=document.createElement("div");L.className="bg-gray-300 rounded-full pr-6 pl-2 py-1 absolute inset-0",L.style.pointerEvents="none";const k=document.createElement("div");k.className="relative flex items-center gap-2",k.style.pointerEvents="none";const v=document.createElement("label");v.innerText="Allow Override",v.className="px-1 cursor-pointer";const l=document.createElement("input");l.type="checkbox",l.className="chk-bind-setting w-4 h-4 text-gray-600 focus:outline-none cursor-pointer relative z-10",l.style.pointerEvents="auto";const z=`chk-${u.getAttribute("data-field-name")}`;l.id=z,v.htmlFor=z,k.appendChild(v),k.appendChild(l),D.appendChild(L),D.appendChild(k),o.appendChild(D);const q=u.getAttribute("data-field-name");l.checked=q&&C?.includedSettings?.includes(q)}}}async function Go(g){if(!g){console.log("Invalid form");return}const a=this,i=g.Settings;if(a.emit("settingsSaving",i),i?.prompt&&(a.title===a.displayName||a.aiTitle===a.title)){const h=a.settingsEntries;i?.prompt&&i?.prompt!==h?.prompt?.value&&await a.updateTitle()}if(!await a.save(i)){de("Error saving settings","Error","alert");return}if(a.properties.template){const h=a.templateSettings;a.data._templateVars;const j=a.properties?.template?.templateInfo?.includedSettings||[];for(let C of j)a.data[C]=i[C];a.data._templateVars={};for(let C in h)a.data._templateVars[C]=i[C]}else for(let h in a.settings)a.data[h]=i[h];a.emit("settingsSaved",i),a.emit("settingsClosed"),a.domElement.classList.remove("active"),Re.curComponentSettings=null,await ye(100),a.workspace.saveAgent(),a.unsetTemplateEditMode()}async function Su(g){const a=this,i=g.Settings;let h={};for(let j in i)h[j]=i[j]?.value||"";a.emit("settingsDraftUpdated",h)}const Eu={html1:{type:"div",classOverride:"all-initial p-2 px-4",html:`
<h1 class="text-lg font-bold text-emerald-600 mt-6">Component Template Builder Help</h1>

<div class="bg-gray-200 p-4 rounded-md" ><b>Note : </b> This help section explains the usage of custom template variables, this is an MVP implementation, a <b>Visual Editor</b> will replace it later</div>

<p class="mt-4">You can use the following annotations inside text inputs in order to generate additional fields in the new component : </p>
<ul>
<li><b class="w-8"> * Select</b> : {{<span class="font-bold text-indigo-700">SELECT</span>:<span class="font-bold text-emerald-700">Select label</span>:<span class="font-bold text-blue-700">["value1", "value2", "value3"]</span>}}</li>
<li><b class="w-8"> * Range</b> : {{<span class="font-bold text-indigo-700">RANGE</span>:<span class="font-bold text-emerald-700">Range label</span>:<span class="font-bold text-blue-700">{"min":0,"max":10,"step":1,"value":5}</span>}}</li>
<li><b class="w-8"> * Key-Value</b> : {{<span class="font-bold text-indigo-700">KVJSON</span>:<span class="font-bold text-emerald-700">KV label</span>:<span class="font-bold text-blue-700">{"field1":"value1","field2":10,"field3":""}</span>}}</li>
<li><b class="w-8"> * Text Input</b> : {{<span class="font-bold text-indigo-700">INPUT</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}} </li>
<li><b class="w-8"> * Text Area</b> : {{<span class="font-bold text-indigo-700">TEXTAREA</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
<li><b class="w-8"> * Password</b> : {{<span class="font-bold text-indigo-700">PASSWORD</span>:<span class="font-bold text-emerald-700">Input label</span>:<span class="font-bold text-blue-700">[""]</span>}}</li>
</ul>


<p class="mt-4">

The <span class="font-bold text-indigo-700">first field</span> (in CAPITAL letters) is the field type, it should always be one of the following : SELECT, INPUT, TEXTAREA, PASSWORD.<br/>
you can use variant annotations like : <br />
 - VARINPUT, VARTEXTAREA for an text inputs that accepts variables<br />
 - VAULTPASSWORD for a password field that can be managed using the vault <br />
</p>

<p class="mt-4">
The <span class="font-bold text-emerald-700">second field</span> is the label that will be displayed in the component settings, this is a free text, but keep it short.
</p>

<p class="mt-4">
The <span class="font-bold text-blue-700">last field</span> should be an array of possible values for SELECT input, or an empty element [""].<br/>
<b>It's important to use the empty element [""] even if no value is configured.</b>
</p>

        `}};async function wu(g){const a=g.getSettingsSidebar();if(!a)return;const i=await $a(a);if(!i)return;const h=i.Settings;if(!g.properties.template)for(let j in g.settings)h[j]&&h[j].valid&&(g.data[j]=h[j].value);g.checkSettings()}async function Cu(g,a=!1){const i=g.settingsChanged();!a&&i&&(await g.confirmSaveSettings(),await ye(100)),await za(),Re.curComponentSettings=null,g.domElement.classList.remove("active")}async function xu(g){Re.curComponentSettings=g,g.workspace.domElement.querySelectorAll(".component.active").forEach(L=>{L.classList.remove("active")}),g.domElement.classList.add("active");const a={};for(let L in g.settings){const k=g.settings[L],v={...k,value:g.data[L]};k?.type==="composite"?a[L]=zi(v):a[L]=v}let i=null;if(g.properties.template){i={};const L=g.properties?.template?.templateInfo?.includedSettings||[];for(let v of L)i[v]=g.settings[v],i[v].value=g.data[v];const k=g.data._templateVars;for(let v in g.templateSettings){const l=g.templateSettings[v],z={...l,value:k[v]||l.value||""};l?.type==="composite"?i[v]=zi(z):i[v]=z}}g.settingsEntries=g.properties.template?i:a;const h=g.properties?.template?.templateInfo?.name||g.title||"",j=async()=>(await g.confirmSaveSettings(),!0),C=()=>{Re.curComponentSettings=null,g.emit("settingsClosed"),g.domElement.classList.remove("active"),g.unsetTemplateEditMode()},A=L=>{const k=L.target.value,v=k.match(/<i class="([^"]+)"/),l=v?v[1]:k;L.target.value=l;const z=L.target.closest(".form-box");if(z){let q=z.querySelector(".tpl-icon-preview");q||(q=document.createElement("div"),q.classList.add("tpl-icon-preview","absolute","bottom-0","right-0","w-12","h-12"),z.appendChild(q)),l.startsWith("fa")?q.innerHTML=`<i class="icon tpl-fa-icon ${l}"></i>`:q.innerHTML=`<div class="w-8 h-8">${l}</div>`}};un=null;async function s(L,k="#000000",v=""){try{const l=await fetch("/api/page/collection/create-collection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L,color:k,icon:v})});if(!l.ok)throw new Error("Failed to add new collection");const z=await l.json();return z.error?(de("Error adding new collection","","alert"),null):z}catch{return de("Error adding new collection","","alert"),null}}const _={name:{type:"input",label:"Name",value:g.properties?.template?.templateInfo?.name||g.title||""},description:{type:"textarea",label:"Description",value:g.properties?.template?.templateInfo?.description||g.description||""},icon:{type:"textarea",label:"Font Awesome Class or SVG",value:g.properties?.template?.templateInfo?.icon||"",events:{change:A,mouseup:A,keyup:L=>{(L.ctrlKey||L.metaKey)&&A(L)}}},color:{type:"color",value:g.properties?.template?.templateInfo?.color||"#000000"},docPath:{type:"input",label:"Documentation Path",value:g.properties?.template?.templateInfo?.docPath||""},ytLink:{type:"input",label:"Youtube Tutorial Link",value:g.properties?.template?.templateInfo?.ytLink||""},newCollectionCheckbox:{type:"checkbox",label:"Do you want to create a new collection?",value:!1,events:{change:L=>{const k=document.querySelector('[data-field-name="newCollectionInput"]'),v=document.querySelector('[data-field-name="newCollectionButton"]');L.target.checked?(k.classList.remove("invisible","hidden"),k.classList.add("block","visible"),v.classList.remove("invisible","hidden"),v.classList.add("inline-block","visible")):(k.classList.remove("block","visible"),k.classList.add("invisible","hidden"),v.classList.remove("inline-block","visible"),v.classList.add("invisible","hidden"))}}},newCollectionInput:{type:"input",label:"New Collection Name",value:"",class:"invisible hidden"},newCollectionButton:{type:"button",label:"Add Collection",class:"invisible hidden",attributes:{},events:{click:async L=>{const k=L.target,v=k.innerHTML,l=document.querySelector('[data-field-name="newCollectionInput"]'),z=l.querySelector("input").value.trim(),q=document.getElementById("color").value.trim(),tt=document.getElementById("icon").value.trim();if(z){k.innerHTML='<i class="fas fa-spinner fa-spin"></i>',k.disabled=!0;const Y=await s(z,q,tt);if(k.innerHTML=v,k.disabled=!1,Y){l.querySelector("input").value="";const I=document.getElementById("newCollectionCheckbox");I.checked=!1;const H=document.querySelector('[data-field-name="newCollectionButton"]');l.classList.remove("block","visible"),l.classList.add("invisible","hidden"),H.classList.remove("inline-block","visible"),H.classList.add("invisible","hidden"),de("New collection added","Success")}}else de("Please enter a collection name","Error","alert")}}},collection:{type:"select",label:"Collection",value:g.properties?.template?.templateInfo?.collection||"",options:Pu.bind(g),events:{change:L=>{const k=un.find(tt=>tt.value===L.target.value),v=document.querySelector('.form-box[data-field-name="icon"] #icon'),l=g.properties?.template?.templateInfo?.icon||"",z=g.properties?.template?.templateInfo?.color||"#000000";(v&&!l||!v?.value)&&(v.value=k.icon);const q=document.querySelector('.form-box[data-field-name="color"] #color');if(!z||z=="#000000"||q.value=="#000000"){q.value=k.color,q.setAttribute("value",k.color);const tt=q.closest(".clr-field");tt&&(tt.style.color=k.color)}}}},version:{type:"input",label:"Version",validate:"custom=isValidSemVer",validateMessage:"Invalid version number. Must be in the format x.x.x",value:g.properties?.template?.templateInfo?.version||"1.0.0"},published:{type:"checkbox",class:"w-32",label:"Published",value:g.properties?.template?.templateInfo?.published||!1}},u=g?.templateSupport&&g.workspace?.userData?.acl?.["/templates"]=="rw"&&g.workspace?.userData?.isSmythStaff?{template:{type:"button",label:g.properties.template?'<i class="fa-solid fa-pen-to-square"></i>':'<i class="fa-solid fa-screwdriver-wrench"></i>',icon:"",hint:g.properties.template?"Edit This Template":"Create Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async()=>{let L=!0;g.properties.template&&(L=!1,g.settingsEntries=a);const k={Info:_,Settings:g.settingsEntries,Help:Eu},v={template:{type:"button",label:'<i class="fa-regular fa-floppy-disk"></i>',icon:"",hint:"Save Template Component",hintPosition:"right",class:"bg-transparent font-semibold text-base hover:bg-gray-300 hover:text-emerald-600",click:async l=>{console.log("collecting settings data");const z=l.target.closest(".right-sidebar")?.querySelector("form.Settings");let q={};z&&(q=[...z.querySelectorAll(".chk-bind-setting")].filter(p=>p.checked).map(p=>p.closest(".form-box").getAttribute("data-field-name")),console.log(q));const tt={};for(let p in k){const E=document.querySelector(`#right-sidebar form.${p}`),x=k[p];if(Va(E),await ye(30),E.querySelector(".invalid"))return;const B=Ui(E,x);tt[p]=B}const Y=tt.Settings;if(g.emit("settingsSaving",Y),!await g.save(Y)){de("Error saving settings","Error","alert");return}if(!g.properties.template||!L)for(let p in g.settings)g.data[p]=Y[p];else{const p=g.templateSettings,E=g.data._templateVars,x=g.properties?.template?.templateInfo?.includedSettings||[];for(let B of x)g.data[B]=Y[B];for(let B in p)E[B]=Y[B]}console.log("template save settings",g.settings);const I=g.exportTemplate();I.templateInfo={...g.properties.template?.templateInfo,...tt.Info,includedSettings:q},I.data={...I.data,...g.data},I.templateInfo.icon,g.emit("settingsSaved",Y);let H=L?null:I?.templateInfo?.id;try{const p=un.find(w=>w.value===I.templateInfo.collection);let E=I.templateInfo.icon||"";E||(I.templateInfo.icon=p?p.icon:E);let x=I.templateInfo.color||"#000000";x==="#000000"&&(I.templateInfo.color=p?p.color:x);const B=await Au(H,I,I.templateInfo?.published||!1).catch(w=>({error:w}));if(B.error){console.log("error saving template",B.error),de(B.error?.error?.message||"Cannot save component","Error Saving template","alert");return}I.templateInfo.id=B.component.id,g.properties.template=I,g.title=I.templateInfo.name,g.description=I.templateInfo.description,g.domElement.querySelector(".internal-name").textContent=`T: ${I.templateInfo.name}`;const W=g.domElement.querySelector(".title-bar");if(W){W.querySelector(".title .text").textContent=I.templateInfo.name,W.querySelector(".description .text").textContent=I.templateInfo.description;const w=un.find(y=>y.value===I.templateInfo.collection),K=W.querySelector(".icon");let U=I.templateInfo.icon||"",O=I.templateInfo.color||"#000000";if(U.startsWith("<svg")){K.className="icon w-6 h-6";const y=U.replace(/<path/g,"<path");K.innerHTML=`${y}`;const X=K.querySelectorAll("path");[...X].find(ot=>ot.getAttribute("fill")&&ot.getAttribute("fill")!=="none")||X.forEach(ot=>ot.setAttribute("fill",O))}else K.className=`icon tpl-fa-icon ${U}`,K.innerHTML="",K.style.backgroundColor="",K.style.color=O}if(L){g.data._templateVars=g.data._templateVars||{};let w=null;if(g.properties.template){w={};const K=g.data._templateVars;for(let U in g.templateSettings){const O=g.templateSettings[U],y={...O,value:K[U]};O?.type==="composite"?w[U]=zi(y):w[U]=y}}g.settingsEntries=w}L=!1,g.workspace.saveAgent(),L?de("Component Template Created","Success"):de("Component Template Updated","Success")}catch(p){console.log("error saving template",p),de("Error saving template","Error","alert")}}}};g.setTemplateEditMode(),To({title:`Template Editor : ${h}`,entriesObject:k,features:{templateVars:!0},actions:v,onSave:Go.bind(g),onBeforeCancel:j,onCancel:C,onLoad:_u.bind(g)})}}}:null,o=ku(g),m=g.constructor.name;let D="";switch(m){case"ServerlessCode":D="Run scalable, cloud-based code. This option supports npm packages and third-party libraries, making it perfect for more complex, enterprise-level workflows.";break;case"Code":D="Execute pure JavaScript in a secure, sandboxed environment\u2014ideal for lightweight tasks.";break;default:D=""}To({title:o,entriesObject:{Settings:g.settingsEntries},features:{templateVars:!0},actions:u,onSave:Go.bind(g),onDraft:Su.bind(g),onBeforeCancel:j,onCancel:C,onLoad:bu.bind(g),helpTooltip:D}),g.emit("settingsOpened",g.getSettingsSidebar())}let un;async function Pu(){if(un)return un;console.log("getComponentsCollections");const g=await fetch("/api/page/builder/app-config/collections").then(a=>a.json());return g.error?(de("Error fetching collections","","alert"),[]):(console.log("collectionResult",g),un=(g?.collections||[]).map(a=>({value:a.id,text:a.name,color:a.color||"#000000",icon:a.icon})),un)}async function Au(g,a,i=!1){let h="/api/page/builder/app-config/components";g&&(h+=`/${g}`);const j=a?.templateInfo?.name||a.name,C=a?.templateInfo?.collection||null,A={name:j,data:JSON.stringify(a),collectionId:C,visible:i};return await fetch(h,{method:g?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}).then(s=>s.json())}function ku(g){const a=g.properties?.template?.templateInfo?.name||g.title||"";let i=g.data?.logoUrl||g?.logoUrl,h="";const j=["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost","Await","MultimodalLLM","LLMAssistant"],C=["APIEndpoint","GenAILLM","ImageGenerator","Classifier","Note","APIOutput"];let A="w-6 h-6",s="";if(!i&&g?.drawSettings?.iconCSSClass==="svg-icon HuggingFace"&&(i="https://huggingface.co/front/assets/huggingface_logo-noborder.svg"),typeof i=="string"&&i.trim()!=="")j.some(_=>a.includes(_))&&(A="w-8 h-8"),h=`<img src="${i}" alt="${a} icon" class="inline-block align-middle ${A} object-contain rounded">`;else{let _=g.drawSettings.iconCSSClass||"";s=_;const u="#242424";if(j.some(o=>s.includes(o))&&(A="w-8 h-8"),_.startsWith("fa"))h=`<i class="${_.includes("tpl-fa-icon")?_:`tpl-fa-icon ${_}`} inline-block align-middle" style="color: ${u}; font-size: 1.5rem; vertical-align: middle;"></i>`;else if(_.trim().startsWith("<svg")){let o=_;o=o.replace(/<path[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),o=o.replace(/<svg[^>]*?\sfill="[^"]*"[^>]*>/g,m=>m.replace(/\sfill="[^"]*"/,"")),o.includes('class="')?(o=o.replace("<svg",`<svg fill="${u}"`),o.includes("w-full")||(o=o.replace(/class="([^"]*)"/,'class="$1 w-full"')),o.includes("h-full")||(o=o.replace(/class="([^"]*)"/,'class="$1 h-full"'))):o=o.replace("<svg",`<svg fill="${u}" class="w-full h-full"`),h=`<span class="inline-block align-middle ${A}">${o}</span>`}else if(_){_.includes("svg-icon")||(_=`svg-icon ${_}`);const o=C.some(D=>_.includes(D)),m=`background-color: ${u}${o?" !important":""};`;h=`<span class="${_} ${A} inline-block align-middle" style="${m}"></span>`}}return`
    <div class="flex items-center gap-2">
      ${h}
      <span class="truncate">${a}</span>
    </div>
  `}const Mr={},Du={VANILLA:Ka,REACT:g=>Ja({config:g})};window.__INPUT_TEMPLATE_VARIABLES__={};window.__FIELD_TEMPLATE_VARIABLES__={};window.interact=ei;function Ou(g){const a=h=>/^-?\d+(\.\d+)?$/.test(h.trim()),i=h=>{const j=parseFloat(h);return!isNaN(j)&&j<=Number.MAX_SAFE_INTEGER&&j>=Number.MIN_SAFE_INTEGER&&j.toString()===h.trim()};if(!g)return null;if(a(g)&&!i(g)||!g.trim().startsWith("{")&&!g.trim().startsWith("["))return g;try{return JSON.parse(g)}catch{return JSON.parse(rs(g))}}function jr(g){if(Array.isArray(g)){for(let i=0;i<g.length;i++)g[i]=jr(g[i]);return g}if(typeof g=="object"&&g!==null){for(let i in g)g[i]=jr(g[i]);return g}const a=typeof g=="string"?g:JSON.stringify(g);return a.length>100?a.substring(0,100)+"...(long content truncated)":a}class Re extends Ko{constructor(a,i={outputs:[],inputs:[],data:{},top:"",left:"",width:"",height:"",title:"",description:"",sender:null,uid:null,template:null,aiTitle:"",displayName:""},h=!0){if(super(),this.workspace=a,this.properties=i,this.settings={},this.inputEditor=Du.VANILLA,this.inputSettings={defaultVal:{type:"string",default:"",allowDefaultEdit:!0,editConfig:{type:"textarea",label:"Default Value",fieldCls:"min-h-[50px] px-3 py-1 resize-y",attributes:{"data-agent-vars":"true","data-auto-size":"false",style:"height: 34px;"},section:"Advanced_Options",hint:"Value assigned if no specific value provided by user.",hintPosition:"after_label"}}},this.outputSettings={expression:{type:"string",default:"",editConfig:{type:"input",section:"Advanced_Options",help:"JSON path"}}},this.data={},this.drawSettings={displayName:this.constructor.name,cssClass:"",iconCSSClass:"mif-cog",showSettings:!0,addOutputButton:"Outputs",addInputButton:"Inputs",inputMaxConnections:-1,outputMaxConnections:-1,firendlyName:this.constructor.name,category:"Base",componentDescription:"",shortDescription:"",color:"#fff"},this._destroyed=!1,this.docUrl=this.workspace.serverData.docUrl+"/#/components/"+this.constructor.name,this.settingsEntries={},this.async=!1,this.templateSupport=!1,this.templateEditing=!1,this._ready=!1,this.displayName=this.constructor.name,this._uid=this.properties.uid||"C"+kr(),this.properties||(this.properties={top:"",left:""}),this.properties.defaultOutputs=["Output"],this.properties.defaultInputs=[],this.properties.outputs||(this.properties.outputs=[]),this.properties.inputs||(this.properties.inputs=[]),this.properties.inputProps||(this.properties.inputProps=[]),this.properties.outputProps||(this.properties.outputProps=[]),this.data=this.properties.data||{},this.properties.template){const j=this.properties.template;this.properties.inputs=[...new Set([...this.properties.inputs,...j.inputs?.map(s=>s.name)||[]])],this.properties.outputs=[...new Set([...this.properties.outputs,...j.outputs?.map(s=>s.name)||[]])];const C=[];for(let s of this.properties.inputs){const _=j.inputs?.find(o=>o.name===s),u=this.properties.inputProps.find(o=>o.name===s);C.push({..._,...u})}this.properties.inputProps=C;const A=[];for(let s of this.properties.outputs){const _=j.outputs?.find(o=>o.name===s),u=this.properties.outputProps.find(o=>o.name===s);A.push({..._,...u})}this.properties.outputProps=A}this.prepare().then(this.init.bind(this)).then(()=>{this.title=this.properties.aiTitle||this.properties.title||this.drawSettings.displayName,this.aiTitle=this.properties.aiTitle||"",this.description=this.properties.description||this.drawSettings.shortDescription||this.drawSettings.componentDescription||"";const j=this.properties.defaultOutputs.reverse();for(let A of j)this.properties.outputs.indexOf(A)===-1&&this.properties.outputs.unshift(A);const C=this.properties.defaultInputs.reverse();for(let A of C)this.properties.inputs.indexOf(A)===-1&&this.properties.inputs.unshift(A);this.redraw(h),this._ready=!0}).then(this.run.bind(this)).finally(()=>{this.syncTemplateVars()}),Mr[this.uid]=this}get uid(){return this._uid}get settingsOpen(){return Re.curComponentSettings==this}get templateSettings(){return this.properties?.template?.settings}set templateSettings(a){this.properties?.template&&(this.properties.template.settings=a)}async prepare(){return!0}async run(){return!0}syncTemplateVars(){window.__INPUT_TEMPLATE_VARIABLES__[this._uid]=new Map;const a=C=>{const A={var:`{{${C}}}`,type:"input"};window.__INPUT_TEMPLATE_VARIABLES__[this._uid].set(C,A)},i=C=>{window.__INPUT_TEMPLATE_VARIABLES__[this._uid].delete(C)},h=()=>{const C=window.__INPUT_TEMPLATE_VARIABLES__?.[this._uid]||new Map,A=window.__LAST_FIELD_WITH_TEMPLATE_VARS__,s=window.__FIELD_TEMPLATE_VARIABLES__?.[A]||new Map,_=new Map([...C,...s]);Za(_,this._uid)};this.properties.inputs?.forEach(C=>a(C));const j=C=>C.classList.contains("input-endpoint");this.addEventListener("endpointAdded",(C,A)=>{j(A)&&(a(C),h())}),this.addEventListener("endpointChanged",(C,A,s,_)=>{C==="name"&&j(A)&&(i(s),a(_),h())}),this.addEventListener("endpointRemoved",(C,A)=>{j(A)&&(i(C),h())})}addFieldVariable(a,i){const h=window.__FIELD_TEMPLATE_VARIABLES__?.[a]||new Map;for(const[j,C]of Object.entries(i))h.set(j,{var:C,type:"field"});window.__FIELD_TEMPLATE_VARIABLES__[a]=h}ready(a){return new Promise((i,h)=>{if(this._ready)return i(!0);const j=setInterval(()=>{this._ready&&(clearInterval(j),a&&a(),i(!0))},15)})}async repaint(a=!1){if(a){let i=[...this.domElement.querySelectorAll(".endpoint")].map(h=>h?.endpoint?.connections).flat(1/0);i=[...new Set(i)],i.forEach(h=>{this.workspace.updateConnectionStyle(h)})}this.workspace.jsPlumbInstance.repaint(this.domElement)}async init(){}async clean(){return!0}isFunctionalComponent(){return["FSign","FEncDec","FSleep","FTimestamp","FHash"].includes(this.constructor.name)}isLogicalComponent(){return["LogicAND","LogicOR","LogicXOR","LogicAtLeast","LogicAtMost"].includes(this.constructor.name)}addDebugButton(){if(!this.domElement)return;const a=this.domElement.querySelector(".title-bar");if(!a)return;a.querySelector(".btn-debug")?.remove();const i=document.createElement("button");i.className="btn-debug button-icon absolute z-10",this.isFunctionalComponent()?(i.style.top="1px",i.style.right="4px"):(i.style.top="9px",i.style.right="7px");const h=document.createElement("div");h.className="debug-icon-container",h.innerHTML=`
          <img src="" class="debug-icon default-icon w-8 h-8" alt="Debug" style="opacity: 1;" />
      `,i.appendChild(h),i.onclick=this.openDebugDialog.bind(this),new al(i,{text:"Run with Debug",position:this.isLogicalComponent()?"left":"top",showWhen:"hover"}),a.appendChild(i)}async checkSettings(){this.clearComponentMessages();const{data:a}=await Ga({scope:void 0}),i=Object.values(a);let h=[];for(let o in this.settings){const m=this.settings[o];m.validate?.includes("required")&&h.push({id:o,name:m.label||o})}const j=h.filter(o=>!this.data[o.id]);j.length>0&&this.addComponentMessage(`Missing Settings ${j.map(o=>o.name).join(", ")}`,"alert pointer",()=>{Ze.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});const C="_manage_keys_message",A=this.hasComponentMessage(`.${C}`),s=async({addMockToggle:o=!1,addManageMessage:m=!1})=>{try{m&&this?.addComponentMessage("Manage keys","info pointer",()=>window.open("/vault","_blank"),C),o&&(await yu(this),await Rr(this))}catch{console.error("Failed to update UI for vault keys")}};if(this.properties.template){let o=null;if(this.properties.template){o={};const m=this.properties?.template?.templateInfo?.includedSettings||[];for(let L of m)this.settings?.[L]?.type!=="button"&&(o[L]=this.settings[L],o[L].value=this.data[L]);const D=this.data._templateVars;for(let L in this.templateSettings){const k=this.templateSettings[L],v={...k,value:D[L]||k.value||""};k?.type==="composite"?o[L]=zi(v):o[L]=v}}if(Object.keys(o||{}).filter(m=>{const D=this.data?._templateVars?.[m],L=this.data?.[m],k=v=>v==null||typeof v=="string"&&v.trim()==="";return k(D)&&k(L)}).length>0)this.addComponentMessage("Missing Settings","alert pointer",()=>{Ze.track("app_component_alert_click",{type:"missing settings"}),this.editSettings()});else{const m=Object.keys(o||[]).filter(k=>Ya(this.data?._templateVars?.[k]));let D=!1,L=!1;for(let k of m){const v=this.data?._templateVars?.[k],l=await this.checkVaultKeys(v,i);l?.allKeys?.size>0&&(D=!0),l?.existKeys?.size>0&&!A&&(L=!0)}s({addMockToggle:D,addManageMessage:L})}}let _=!1,u=!1;for(let o in this.settings){let m="";try{m=decodeURIComponent(this.data[o])}catch{m=this.data[o]}const D=await this.checkVaultKeys(m,i);D?.allKeys?.size>0&&(_=!0),D?.existKeys?.size>0&&!A&&(u=!0)}s({addMockToggle:_,addManageMessage:u});for(let o in this.settings){let m="";try{m=decodeURI(this.data[o])}catch{m=this.data[o]}const D=/{{INFO\:([^}]*)}}/g;let L;for(;(L=D.exec(m))!==null;){const k=L[1];this.addComponentMessage(k,"warning pointer",()=>{window.open("/vault","_blank")})}}}async checkVaultKeys(a="",i){const h=/{{KEY\(([^}]*)\)}}/g;let j=[],C;for(;(C=h.exec(a))!==null;)C[1]&&j.push(C[1]);const A=new Set(j),s=new Set,_=new Set;for(let u of j)if(console.log("debug: keyName",u),console.log("debug: vaultEntries",i),console.log("debug: vaultEntries.find",i.find(o=>o.name===u||o.name===u.replace(/\+/g," "))),console.log("debug: condition",u&&i.find(o=>o.name===u||o.name===u.replace(/\+/g," "))),u&&i.find(o=>o.name===u||o.name===u.replace(/\+/g," ")))console.log("Vault Key Found",u),s.add(u);else{if(console.log("Vault Key Missing",u),_.add(u),this.hasComponentMessage(`.${Lr(u)}`))continue;this.addComponentMessage(`Missing Key "${u}"`,"alert pointer",()=>{Ze.track("app_component_alert_click",{type:"missing key"}),ju.bind(this,u)()},Lr(u))}return{allKeys:A,existKeys:s,missingKeys:_}}async save(a){return this.checkSettings(),setTimeout(async()=>{this.checkSettings()},1e3),!0}destroy(){this._destroyed=!0,this.domElement.remove()}getSettingsSidebar(){return Re.curComponentSettings!==this?null:document.querySelector("#right-sidebar")}async deleteEndpoint(a){this.workspace.jsPlumbInstance.deleteEndpoint(a.endpoint),a.classList.contains("input-endpoint")&&(this.properties.inputs=this.properties.inputs.filter(i=>i!==a.getAttribute("smt-name")),this.properties.inputProps=this.properties.inputProps.filter(i=>i.name!==a.getAttribute("smt-name"))),a.classList.contains("output-endpoint")&&(this.properties.outputs=this.properties.outputs.filter(i=>i!==a.getAttribute("smt-name")),this.properties.outputProps=this.properties.outputProps.filter(i=>i.name!==a.getAttribute("smt-name"))),a.remove(),this.workspace.redraw(),this.workspace.saveAgent()}syncProps(a,i,h){const j=a==="input"?"inputs":"outputs",C=a==="input"?"inputProps":"outputProps",A=this.properties[j].findIndex(u=>u===i),s=this.properties[C],_=s.findIndex(u=>u?.name===i);if(A>=0&&_>=0){this.properties[j][A]=h.name;const u=s.find(o=>o?.name===i);this.properties[C][_]={...u,...h}}}inputNameExists(a){return!!this.inputContainer.querySelector(`.input-endpoint[smt-name="${a}"]`)}outputNameExists(a){return!!this.outputContainer.querySelector(`.output-endpoint[smt-name="${a}"]`)}parseOutputProp(a,i,h){if(!this.outputSettings[i])return;const j=this.properties.outputProps?.find(A=>A.name===a),C=this.outputSettings[i];switch(C?.type){case"string":return j?.[i]||C?.default||h;case"number":return j?.[i]||C?.default||h;case"boolean":return j?.[i]||C?.default||h}}async addOutput(a,i,h={},j={}){if(this.outputNameExists(i)){de(`${i} already exists`,"Error","alert");return}const C=this.workspace.jsPlumbInstance,A=document.createElement("div");A.className=`smyth endpoint output-endpoint ${this.constructor.name}`,A.setAttribute("smt-name",i);const s=this.properties.outputProps?.find(q=>q.name===i),_=s?.color||`${Fe.conStartColor}`;A.setAttribute("smt-color",_);for(let q in this.outputSettings)A.setAttribute(`smt-${q}`,this.parseOutputProp(i,q,""));for(let q in h)this.inputSettings[q]&&A.setAttribute(`smt-${q}`,h[q]);for(let q in h)this.outputSettings[q]&&A.setAttribute(`smt-${q}`,h[q]);Object.keys(h)?.length>0&&this.properties.outputs.push(i),a.appendChild(A),await ye(50);const u=C.addEndpoint(A,{paintStyle:{fill:"#ddddff00"},endpoint:["Rectangle",{height:10,width:40}],anchor:"Right",isSource:!0,maxConnections:this.drawSettings.outputMaxConnections,cssClass:"exclude-panzoom"}),o=document.createElement("span");o.className="name",o.innerHTML=`<span class="label">${i}</span>`,A.appendChild(o);const m=this.properties.defaultOutputs.includes(i),D=!this.templateEditing&&this.properties.template?.outputs?.find(q=>q.name==i),L=document.createElement("button");L.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",L.innerHTML='<span class="icon mif-pencil"></span>',L.setAttribute("rel",A.id),L.addEventListener("click",async q=>{q.stopPropagation();let tt=!0;if(j.onEditBtnClick&&(tt=await j.onEditBtnClick(q),tt===!1))return;q.stopImmediatePropagation();const Y=A.getAttribute("smt-name"),I=!this.templateEditing&&this.properties.template?.outputs?.find(W=>W.name==Y),H=A.getAttribute("smt-color")||`${Fe.conStartColor}`,p={name:{label:"Output Name",type:"text",class:"stg-output stg-name",value:Y,readonly:m||I,validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:qi(H)};for(let W in this.outputSettings){const w=this.outputSettings[W];if(w){let K=A.getAttribute(`smt-${W}`);K==="true"&&(K=!0),K==="false"&&(K=!1),p[W]={...w.editConfig,value:K},w.allowDefaultEdit||(p[W].readonly=m||I,p[W].class+=m||I?" hidden":"")}}p?.description&&(p.description.section="Advanced_Options");const E=this.constructor.name===Jn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Output</span>':'<span class="text-xl">Edit Output</span>',x=Bi(p,["description","expression","additionalOptionsLabel","color"]),B=await this.inputEditor({title:E,fields:x,onDOMReady:W=>{const w=W.querySelector("#name"),K=W.querySelector(".agent-skill-dialog-title"),U=document.querySelector("#add-skill-input-info-icon");K&&U&&(U.classList.remove("hidden"),K.appendChild(U)),ye(50).then(()=>Oi(w))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(B){if(B.name!=Y){if(this.outputNameExists(B.name)){de(`${B.name} already used`,"Error","alert");return}A.setAttribute("smt-name",B.name),A.querySelector(".name").innerHTML=B.name,this.emit("endpointChanged","name",A,Y,B.name)}if(A&&B.color!=H){A.setAttribute("smt-color",B.color),A.querySelector(".ep").style.backgroundColor=B.color||`${Fe.conStartColor}`,A.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${B.color}) 1`;const W=A.endpoint;if(W&&W.connections)for(let w of W.connections)this.workspace.updateConnectionColors(w);this.emit("endpointChanged","color",A,H,B.color)}for(let W in this.outputSettings){const w=this.outputSettings[W];if(A&&w){const K=A.getAttribute(`smt-${W}`);B[W]!==K&&B[W]!=null&&(A.setAttribute(`smt-${W}`,B[W]),this.emit("endpointChanged",W,A,K,B[W]))}}this.syncProps("output",Y,B),this.workspace.saveAgent()}});const k=document.createElement("button");k.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",k.innerHTML='<span class="icon mif-bin"></span>',k.setAttribute("rel",A.id),k.addEventListener("click",async q=>{const tt=A.getAttribute("smt-name"),Y=!this.templateEditing&&this.properties.template?.outputs?.find(I=>I.name==tt);if(!(m||Y))return q.stopPropagation(),q.stopImmediatePropagation(),await Ti("Deleting Output. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})?this.deleteEndpoint(A):!1}),!m&&D&&k.setAttribute("templateEditable","true"),A.appendChild(k),k.classList.add("hidden"),!m&&!D?k.classList.remove("hidden"):A.classList.add("default"),A.appendChild(L);const v=document.createElement("button");v.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",v.innerHTML='<span class="icon mif-arrow-up"></span>',v.addEventListener("click",async q=>{q.stopPropagation(),A.parentElement.insertBefore(A,A.previousSibling),this.repaint(),this.workspace.saveAgent()}),A.appendChild(v);const l=document.createElement("button");l.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",l.innerHTML='<span class="icon mif-arrow-down"></span>',l.addEventListener("click",async q=>{q.stopPropagation(),A?.parentElement?.insertBefore(A?.nextSibling,A),this.repaint(),this.workspace.saveAgent()}),A.appendChild(l);const z=document.createElement("span");z.className=`ep ep-Output ep-${i}`,z.innerHTML=" ",z.style.backgroundColor=s?.color||`${Fe.conStartColor}`,A.appendChild(z),A.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${_}) 1`;for(let q of u.connections)this.workspace.updateConnectionColors(q);return A.endpoint=u,u._domElement=A,!s&&h.name&&(h.default||(h.default=!1),this.properties.outputProps.push(h)),this.emit("endpointAdded",i,A),this.workspace.saveAgent(),A}setTemplateEditMode(){this.templateEditing=!0,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(a=>a.classList.remove("hidden"))}unsetTemplateEditMode(){this.templateEditing=!1,this.domElement.querySelectorAll('[templateEditable="true"]').forEach(a=>a.classList.add("hidden"))}parseInputProp(a,i,h){if(!this.inputSettings[i])return;const j=this.properties.inputProps?.find(A=>A.name===a),C=this.inputSettings[i];switch(C?.type){case"string":return j?.[i]||C?.default||h;case"number":return j?.[i]||C?.default||h;case"boolean":return j?.[i]||C?.default||h}}async addInput(a,i,h={}){if(this.inputNameExists(i)){de(`${i} already exists`,"Error","alert");return}const j=this.workspace.jsPlumbInstance,C=document.createElement("div");C.className=`smyth endpoint input-endpoint ${this.constructor.name}`,C.setAttribute("smt-name",i);const A=this.properties.inputProps?.find(l=>l.name===i);C.setAttribute("smt-optional",A?.optional||"false"),C.setAttribute("smt-color",A?.color||`${Fe.conEndColor}`),C.setAttribute("smt-type",A?.type||"Any"),C.setAttribute("smt-friendly-input-type",A?.friendlyInputType||""),C.setAttribute("smt-core-input-type",A?.coreInputType||""),A?.optional?C.classList.add("optional"):C.classList.remove("optional");for(let l in this.inputSettings)C.setAttribute(`smt-${l}`,this.parseInputProp(i,l,""));for(let l in h)this.inputSettings[l]&&C.setAttribute(`smt-${l}`,h[l]);Object.keys(h)?.length>0&&this.properties.inputs.push(i),a.appendChild(C),await ye(50);const s=j.addEndpoint(C,{paintStyle:{fill:"transparent"},endpoint:["Dot",{radius:10}],anchor:["Left",{dx:40}],isTarget:!0,maxConnections:this.drawSettings.inputMaxConnections,cssClass:"exclude-panzoom"});s._listeners.mouseup||(s._listeners.mouseup=[]),s._listeners.mouseup.push(()=>{if(this.workspace._draggingConnection){const l=this.workspace._draggingConnection.source.endpoint;if(l.connections.find(z=>z.endpoints.includes(s)))return;this.workspace.jsPlumbInstance.connect({source:l,target:s,cssClass:"exclude-panzoom"}),this.workspace.jsPlumbInstance.deleteConnection(this.workspace._draggingConnection)}document.querySelectorAll(".endpoint.active").forEach(l=>l.classList.remove("active"))});const _=document.createElement("span");_.className=`ep ep-Input ep-${i}`,_.innerHTML=" ",_.style.backgroundColor=A?.color||`${Fe.conEndColor}`,C.appendChild(_);const u=document.createElement("span");u.className="name",u.innerHTML=i,C.appendChild(u);const o=this.properties.defaultInputs.includes(i),m=!this.templateEditing&&this.properties.template?.inputs?.find(l=>l.name==i),D=document.createElement("button");D.className="btn-edit-endpoint  button text-gray-310 bg-white hover:text-emerald-600 mini",D.innerHTML='<span class="icon mif-pencil"></span>',D.setAttribute("rel",C.id),D.addEventListener("click",async l=>{l.stopPropagation();const z=C.getAttribute("smt-name"),q=this.properties.inputProps?.find(y=>y.name===z),tt=!this.templateEditing&&this.properties.template?.inputs?.find(y=>y.name==z),Y=C.getAttribute("smt-optional")=="true",I=C.getAttribute("smt-color")||`${Fe.conEndColor}`;let H=C.getAttribute("smt-type")&&C.getAttribute("smt-type")!=="undefined"?C.getAttribute("smt-type"):"",p=C.getAttribute("smt-friendly-input-type")||"",E=C.getAttribute("smt-core-input-type")||"";H&&!p&&(p="Others",E=H);const x=C.getAttribute("smt-isfile")=="true";let B=!1;x&&(B=!0,H="Binary");const W=o||tt,w={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:z,readonly:o||tt,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores."}};if(!W){const y=Wo({compName:this.constructor.name,values:{friendlyInputType:p,coreInputType:q?.type||E,type:q?.type||H}});y?.friendlyInputType&&(w.friendlyInputType=y.friendlyInputType),y?.coreInputType&&(w.coreInputType=y.coreInputType),y?.type&&(w.type=y.type)}w.additionalOptionsLabel={type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},w.optional=Xo(Y,o||tt),w.color=qi(I);for(let y in this.inputSettings){const X=this.inputSettings[y];if(X){let ot=C.getAttribute(`smt-${y}`);ot==="true"&&(ot=!0),ot==="false"&&(ot=!1),w[y]={...X.editConfig,value:ot},X.allowDefaultEdit||(w[y].readonly=o||tt,w[y].class+=o||tt?" hidden":"")}}const K=this.constructor.name===Jn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Edit Skill Input</span>':'<span class="text-xl">Edit Input</span>';w?.description&&(w.description.section="Advanced_Options");const U=Bi(w,["name","type","description","additionalOptionsLabel","optional","color"]),O=await this.inputEditor({title:K,fields:U,onDOMReady:y=>{const X=y.querySelector("#name"),ot=y.querySelector(".agent-skill-dialog-title"),Q=document.querySelector("#add-skill-input-info-icon");ot&&Q&&(Q.classList.remove("hidden"),ot.appendChild(Q)),ye(50).then(()=>Oi(X))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(O){if(O.name!==z){if(this.inputNameExists(O.name)){de(`${O.name} already used`,"Error","alert");return}C.setAttribute("smt-name",O.name),C.querySelector(".name").innerHTML=O.name,this.emit("endpointChanged","name",C,z,O.name)}if(O.optional!==Y&&(C.setAttribute("smt-optional",O.optional),O.optional?C.classList.add("optional"):C.classList.remove("optional"),this.emit("endpointChanged","optional",C,Y,O.optional)),C&&O.color!==I){C.setAttribute("smt-color",O.color),C.querySelector(".ep").style.backgroundColor=O.color||`${Fe.conEndColor}`,C.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${O.color}) 1`;const y=C.endpoint;if(y&&y.connections)for(let X of y.connections)this.workspace.updateConnectionColors(X);this.emit("endpointChanged","color",C,I,O.color)}O.type||(O.type="Any"),(C&&O.type!==H||B)&&(C.setAttribute("smt-type",O.type),this.emit("endpointChanged","type",C,H,O.type)),C?.setAttribute("smt-friendly-input-type",O?.friendlyInputType||""),C?.setAttribute("smt-core-input-type",O?.coreInputType||"");for(let y in this.inputSettings){const X=this.inputSettings[y];if(C&&X){const ot=C.getAttribute(`smt-${y}`);O[y]!==ot&&O[y]!=null&&(C.setAttribute(`smt-${y}`,O[y]),this.emit("endpointChanged",y,C,ot,O[y]))}}this.syncProps("input",z,O),this.workspace.saveAgent()}});const L=document.createElement("button");L.className="btn-delete-endpoint button text-smyth-red-500 hover:text-white hover:bg-smyth-red-500 mini outline",L.innerHTML='<span class="icon mif-bin"></span>',L.setAttribute("rel",C.id),L.addEventListener("click",async l=>{const z=C.getAttribute("smt-name"),q=!this.templateEditing&&this.properties.template?.inputs?.find(tt=>tt.name==z);if(!(o||q)){if(l.stopPropagation(),l.stopImmediatePropagation(),await Ti("Deleting Input. Are you sure ?","",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){this.deleteEndpoint(C);const tt=C.getAttribute("smt-name");return this.emit("endpointRemoved",tt,C),!0}return!1}}),!o&&m&&L.setAttribute("templateEditable","true"),C.appendChild(L),L.classList.add("hidden"),!o&&!m?L.classList.remove("hidden"):C.classList.add("default"),C.appendChild(D);const k=document.createElement("button");k.className="btn-moveup-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",k.innerHTML='<span class="icon mif-arrow-up"></span>',k.addEventListener("click",async l=>{l.stopPropagation(),C.parentElement.insertBefore(C,C.previousSibling),this.repaint(),this.workspace.saveAgent()}),C.appendChild(k);const v=document.createElement("button");v.className="btn-movedown-endpoint button text-gray-310 bg-white hover:text-emerald-600 mini",v.innerHTML='<span class="icon mif-arrow-down"></span>',v.addEventListener("click",async l=>{l.stopPropagation(),C.parentElement.insertBefore(C.nextSibling,C),this.repaint(),this.workspace.saveAgent()}),C.appendChild(v);for(let l of s.connections)this.workspace.updateConnectionColors(l);return C.endpoint=s,s._domElement=C,!A&&h.name&&(h.default||(h.default=!1),this.properties.inputProps.push(h)),this.emit("endpointAdded",i,C),this.workspace.saveAgent(),C}refreshSettingsSidebar(){this.settingsOpen&&this.editSettings()}parseTemplateString(a,i){let h=/{{([A-Z]+):([\w\s]+):\[(.*?)\]}}/gm,j=/{{([A-Z]+):([\w\s]+):(\{.*?\})}}/gm;const C=a.matchAll(h),A=a.matchAll(j),s=[...C,...A];for(const _ of s){const u={"data-template-vars":"false"};let o=_[1].toUpperCase();const m=`${o}-${kr()}`;o.startsWith("VAR")&&(o=o.replace("VAR",""),u["data-template-vars"]="true"),o.startsWith("VAULT")&&(o=o.replace("VAULT",""),u["data-vault"]=`${this.constructor.name},All`);const D=_[2];let L,k;if(_[3].trim().startsWith("{")&&_[3].trim().endsWith("}"))try{k=JSON.parse(_[3])}catch{}if(!k)try{const z=JSON.parse(`[${_[3]||""}]`);z.length>1?(L=z.map(q=>({text:q,value:q})),L.unshift({text:" ",value:""})):L=z}catch{L=[]}let v=L?.[0]||"",l={};switch(o){case"KVJSON":v=JSON.stringify(k,null,2);break;default:l=k}i[m]={id:m,type:o,label:D,value:v,options:L,attributes:u,_templateEntry:!0,...l},a=a.replace(_[0],`{{${m}}}`)}return a}parseCompositeTemplateString(a,i){let h=JSON.parse(a||"{}")||{};const j=Array.isArray(h);h=j?h[0]:h;for(let C in h){let A=h[C];typeof A=="object"&&A!==null?(A=this.parseCompositeTemplateString(JSON.stringify(A),i),A=JSON.parse(A)):typeof A=="string"&&(A=this.parseTemplateString(A,i)),h[C]=A}return JSON.stringify(j?[h]:h)}normalizeTemplateSettings(a){}async editSettings(){return xu(this)}async confirmSaveSettings(){if(this.settingsChanged()&&await Ti("Settings Changed","You have unsaved changes. Are you sure you want to discard your changes?",{btnNoLabel:"Discard Changes",btnYesLabel:"Save Changes"})){const a=document.querySelector("#right-sidebar form"),i=Ui(a,this.settingsEntries);if(!await this.save(i)){de("Error saving settings","Error","alert");return}if(this.properties.template){const h=this.data._templateVars,j=this.templateSettings,C=this.properties?.template?.templateInfo?.includedSettings||[];for(let A of C)this.data[A]=i[A];for(let A in j)h[A]=i[A]}else for(let h in this.settings)this.data[h]=i[h];return console.log("new settings",i),this.emit("settingsSaved",i),!0}return!1}settingsChanged(){if(!this.settingsOpen)return!1;const a=this.settingsEntries,i=document.querySelector("#right-sidebar form.Settings");if(!i)return!1;const h=Ui(i,a);if(console.log("settingsChanged()",h,a),this.properties.template){const j=this.data._templateVars;for(let C in a)if(j[C]!==void 0&&j[C]!=h[C])return!0}else for(let j in a)if(this.data[j]!==void 0&&this.data[j]!=h[j])return!0}async closeSettings(a=!1){return Cu(this,a)}showOverlay(a){this.overlay.querySelector(".content").innerHTML=a,this.overlay.style.display="block"}hideOverlay(){this.overlay.querySelector(".content").innerHTML="",this.overlay.style.display="none"}hasComponentMessage(a){return this.domElement.querySelector(a)!==null}hasComponentButton(a){return this.domElement.querySelector(a)!==null}clearComponentMessage(a){const i=this.domElement.querySelector(a);i&&i.remove()}clearComponentMessages(){this.domElement.querySelector(".messages-container").innerHTML=""}addComponentMessage(a,i="info",h,j){const C=document.createElement("div");return C.className=`message ${i} ${j}`,C.innerHTML=typeof a=="string"?a:a.text,h&&(C.style.cursor="pointer",C.addEventListener("click",h)),this.domElement.querySelector(".messages-container").appendChild(C),C}addComponentButton(a,i="info",h,j){const C=document.createElement("div");C.className=`message ${i} flex flex-wrap justify-center items-center p-2`,C.id="component-button";const A=document.createElement("button"),s={primary:"flex flex-row w-full items-center content-center text-xs justify-start gap-1 h-sm px-2 py-1 rounded-xl text-white bg-blue-500 pointer active:text-gray-100 active:bg-blue-600 active:ring-0",secondary:"flex flex-row w-full items-center justify-center text-xs gap-1 h-sm px-2 py-2 rounded-md text-[#3C89F9] border-[#3C89F9] bg-transparent pointer border-2 ",toggle:"flex flex-row w-full items-center justify-start text-xs gap-1 h-sm px-1 rounded-md bg-transparent pointer"};if(A.className=s[h?.customStyle]||s.primary,A.innerHTML=a,h)for(let _ in h)_=="class"?A.className+=` ${h[_]}`:A.setAttribute(_,h[_]);return j&&(A.onclick=j),C.appendChild(A),h?.position==="top"?this.domElement.querySelector(".messages-container").prepend(C):this.domElement.querySelector(".messages-container").appendChild(C),C}redraw(a=!0){this.workspace.jsPlumbInstance;const i=this.workspace,h=this,j=this.properties.outputs||[],C=this.properties.inputs||[],A=document.createElement("div");A.className=`component exclude-panzoom group ${this.drawSettings.cssClass||""}`,A.id=`${this._uid}`,A.style.left=this.properties.left||"20px",A.style.top=this.properties.top||"20px",this.properties.width&&(A.style.width=this.properties.width),this.properties.height&&(A.style.height=this.properties.height),A.classList.add(this.constructor.name);const s=document.createElement("div");s.className="internal-name";const _=this.properties.template?.templateInfo?.name||this.properties.template?.name||this.drawSettings.displayName||this.constructor.name;this.displayName=_,this.properties.template?.templateInfo?.description||this.properties.template?.shortDescription||this.drawSettings.shortDescription||this.drawSettings.componentDescription,s.innerHTML=this.properties.template?"T:"+_:_,A.appendChild(s);const u=document.createElement("div");u.className="title-bar";const o=this.drawSettings.iconCSSClass||"";if(o.startsWith("<svg")){const Q=this.drawSettings.color||"#000",it=o.replace(/<path/g,"<path ");u.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
          <span class="icon w-6 h-6">${it}</span>
          <span class="title">${this.title}</span>
        </div>
        <span class="description">${this.description}</span>
      `;const f=u.querySelectorAll("path");[...f].find(S=>S.getAttribute("fill")&&S.getAttribute("fill")!=="none")||f.forEach(S=>S.setAttribute("fill",Q))}else u.innerHTML=`<div class="flex flex-row items-center gap-1 title-bar-top">
        <span class="icon ${o} h-full"></span>
        <span class="title">${this.title}</span>
      </div>
      <span class="description">${this.description}</span>
      `;u.setAttribute("smt-name",this.constructor.name);const m=u.querySelector(".title"),D=u.querySelector(".description");m.style.cursor="default",D.style.cursor="default",A.appendChild(u),setTimeout(()=>{this.addDebugButton()},500);const L=(Q,it)=>{const f=Q.target;if(f instanceof HTMLElement){if(f.hasAttribute("contenteditable")){Q.stopPropagation();return}!Q.ctrlKey&&!Q.metaKey&&(this.workspace.refreshComponentSelection(),ot(Q)),it.classList.toggle("selected"),it.classList.remove("unselected"),document.querySelectorAll("#workspace-container .component:not(.selected)").forEach(S=>S.classList.add("unselected")),$o()}};m.addEventListener("click",Q=>L(Q,A)),D.addEventListener("click",Q=>L(Q,A)),setTimeout(()=>{Mo(m,{callback:Q=>{Q||(Q=_||""),m.querySelector(".text").textContent=Q,this.title=Q,this.aiTitle="",this.workspace.saveAgent()},editOnClick:!1,showButtons:!0}),Mo(D,{callback:Q=>{Q||(Q=""),D.querySelector(".text").textContent=Q,this.description=Q,this.workspace.saveAgent()},editOnClick:!1,showButtons:!0})},500),setTimeout(()=>{const Q=m.querySelector(".text");Q&&Q.classList.add("truncate")},550);const k=document.createElement("div");k.className=`debug-bar cursor-pointer px-[10px] mx-auto text-white variant_2 rounded-lg ${this.isFunctionalComponent()?"mt-[10px]":""}`,A.appendChild(k),k.addEventListener("click",Q=>{Q.stopPropagation(),Q.stopImmediatePropagation(),this.workspace.refreshComponentSelection(A)});const v=document.createElement("div");v.className="debug-info hidden",k.appendChild(v);const l=document.createElement("button");l.innerHTML='<span class="mif-search icon"></span> Log',l.className="btn-debug-log button primary mini outline hidden",l.onclick=Q=>{Q.stopPropagation(),Q.stopImmediatePropagation(),this.workspace.refreshComponentSelection(A);const it=this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"]`);if(it?.classList?.toggle("hidden"),it.classList.contains("hidden"))it._connection.canvas.classList.add("hidden");else{if(!it._connection&&!it.classList.contains("hidden")){const f=i.jsPlumbInstance.connect({source:it.querySelector("h2"),target:k,detachable:!1,cssClass:"exclude-panzoom z-100",anchors:["Continuous","Left"]});f.setPaintStyle({stroke:"#7d7c96",strokeWidth:1,dashstyle:"4 3"}),f.removeAllOverlays(),f.endpoints[0]._domElement=it,f.endpoints[1]._domElement=k,it._connection=f}it._connection.canvas.classList.remove("hidden")}},k.appendChild(l);const z=document.createElement("button");z.innerHTML=' <i class="fa-solid fa-wand-magic-sparkles"></i> Fix with AI',z.className="btn-fix-with-ai button primary mini outline hidden",z.onclick=async Q=>{Q.stopPropagation(),this.workspace.refreshComponentSelection(A);const it=document.getElementById("builder-button");if(!it){de("Agent Weaver is not enabled","Error","alert");return}const f=localStorage.getItem("sidebarOpen")==="true",S=localStorage.getItem("currentSidebarTab");(!f||S!=="agentBuilderTab")&&it.click();const c=document.getElementById("agentMessageInput"),R=document.getElementById("agentSendButton");this.workspace.domElement.querySelector(`.debug-box[rel="${this._uid}"] .dbg-log`)?.textContent;const M=z.getAttribute("data-error")||"",V=this.domElement.querySelectorAll(".input-container .endpoint");let et="";for(let ct of V){const Et=ct.querySelector("span.name").innerText;let yt=ct.querySelector("div.dbg-output textarea.dbg").value,vt;try{vt=Ou(yt),vt=jr(vt),Array.isArray(vt)&&vt.length>3&&(vt=vt.slice(0,3),vt.push("...(truncated to 3 items)")),et+=`${Et}: ${JSON.stringify(vt)}
`,et=et.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}catch{yt.length>300&&(yt=yt.substring(0,300)+"...(long content truncated)"),et+=`${Et}: ${yt}
`}}et&&(et=`===
Received Inputs:
${et}

`);const lt=`Component With ID=${this._uid} has a runtime error:
      ${M.substring(0,500)}

      ${et}
      ####

      
Please fix the issue, or explain it if you can't fix it`;console.log("Weaver Error fix prompt: ",lt),c.value=lt,await ye(50),R.click(),await ye(50);const st=document.querySelector("#agentChatHistory .user-messages-container:last-child");st&&st.innerText.includes(`Component With ID=${this._uid}`)&&st.classList.add("user-message-weaver-fix")},k.appendChild(z);const q=document.createElement("div");if(q.className="ep-control inputs px-2",q.innerHTML=`<span>${this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton}</span>`,A.appendChild(q),this.drawSettings.addInputButton){const Q=document.createElement("button");Q.innerHTML="+",q.innerHTML="",Q.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",q.appendChild(Q);const it=document.createElement("span");it.innerHTML=this.drawSettings.addInputButtonLabel||this.drawSettings.addInputButton,q.appendChild(it),Q.onclick=f=>{f.stopPropagation(),f.stopImmediatePropagation(),this.addInputDialog()}}const tt=document.createElement("div");tt.className="input-container",A.appendChild(tt);const Y=document.createElement("div");if(Y.className="ep-control outputs px-2",Y.innerHTML=`<span>${this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton}</span>`,A.appendChild(Y),this.drawSettings.addOutputButton){const Q=document.createElement("button");Q.innerHTML="+",Y.innerHTML="",Q.className="btn-add-endpoint button mini w-6 h-6 bg-smythos-blue-500 text-white rounded",Y.appendChild(Q);const it=document.createElement("span");it.innerHTML=this.drawSettings.addOutputButtonLabel||this.drawSettings.addOutputButton,Y.appendChild(it),Q.onclick=f=>{f.stopPropagation(),f.stopImmediatePropagation(),this.addOutputDialog()}}const I=document.createElement("div");I.className="output-container",A.appendChild(I);const H=document.createElement("div");H.className="button-container messages-container",H.addEventListener("click",Q=>{Q.stopPropagation()}),A.appendChild(H);const p=document.createElement("div");p.className="right-side-button-container absolute right-0 flex transition-opacity opacity-0 group-hover:opacity-100";const E=document.createElement("button");E.className="w-6 h-6 rounded del-btn relative group/delete",E.innerHTML='<i class="fas fa-trash text-[#757575] text-xs hover:text-[#aaa]"></i>',E.onclick=Q=>{Q.stopPropagation(),h.delete(!1)};const x=document.createElement("div");x.className="absolute left-[-20px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/delete:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",x.innerText="Delete",E.appendChild(x),p.appendChild(E);const B=h.properties?.template?.templateInfo?.docPath||"/not-set",W=h.properties?.template?h.workspace.serverData.docUrl+"/#"+B:h.docUrl,w=document.createElement("button");w.className="w-6 h-6 rounded action-help relative group/help",w.innerHTML='<span class="font-bold text-lg text-[#757575] hover:text-[#aaa]">?</span>',w.onclick=Q=>{Q.stopPropagation(),window.open(W,"_blank")},h.properties?.template&&!h.properties?.template?.templateInfo?.docPath&&w.classList.add("hidden");const K=document.createElement("div");K.className="absolute left-[-15px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/help:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",K.innerText="Help",w.appendChild(K),p.appendChild(w);const U=document.createElement("button");U.className="w-6 h-6 rounded relative group/settings",U.innerHTML='<i class="fas fa-cog text-[#757575] text-xs hover:text-[#aaa]"></i>';const O=document.createElement("div");O.className="absolute left-[-25px] z-10 inline-block px-3 py-2 w-max text-sm font-medium text-white bg-gray-950 rounded-lg shadow-sm tooltip dark:bg-gray-700 opacity-0 group-hover/settings:opacity-100 transition-opacity duration-300 bottom-full right-0 mb-2 whitespace-nowrap pointer-events-none",this.drawSettings?.showSettings!==!1&&p.appendChild(U),O.innerText="Settings",U.appendChild(O),p.appendChild(U),A.appendChild(p);const y=document.createElement("div");y.className="loading-icon",y.innerHTML=`
      <svg
        aria-hidden="true"
        class="inline text-gray-200 animate-spin dark:text-gray-600 fill-primary-100 w-8 h-8"
        viewBox="0 0 100 101"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
          fill="currentColor"
        />
        <path
          d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
          fill="currentFill"
        />
      </svg>
    `,y.classList.add("hidden"),A.appendChild(y);const X=document.createElement("div");X.className="cpt-overlay",X.innerHTML=`<div class="content"></div><span class="dbg-loader"><svg height="48px" width="64px">
    <polyline id="front" points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24"></polyline>
  </svg></span>`,A.appendChild(X),X.style.display="none";const ot=async Q=>{this.domElement.classList.contains("dragging")||this.domElement.classList.contains("resizing")||m.hasAttribute("contenteditable")&&Q.target==m||D.hasAttribute("contenteditable")&&Q.target==D||Q.target?.classList?.contains("dbg")||!A.querySelector(".debug-info").classList.contains("hidden")||[...A.querySelectorAll(".dbg-element")].filter(it=>it.checkVisibility?.()).length>0||(Re.curComponentSettings&&Re.curComponentSettings!==this&&await Re.curComponentSettings.confirmSaveSettings(),this.settingsOpen?this.closeSettings():this.editSettings())};return A.addEventListener("click",Q=>{if(Q.target!==U){!Q.ctrlKey&&!Q.metaKey&&(this.workspace.refreshComponentSelection(),ot(Q)),this.domElement.classList.toggle("selected"),this.domElement.classList.remove("unselected");const it=document.querySelectorAll("#workspace-container .component:not(.selected)");for(let f of it)f.classList.add("unselected");$o()}}),U.addEventListener("click",Q=>{Q.stopPropagation(),ot(Q),this.workspace.refreshComponentSelection(this.domElement)}),this.inputContainer=tt,this.outputContainer=I,this.buttonContainer=H,this.overlay=X,this.loadingIcon=y,j.forEach((Q,it)=>{this.addOutput(I,Q)}),C.forEach((Q,it)=>{this.addInput(tt,Q)}),ei(A).draggable({allowFrom:".component",ignoreFrom:".dbg-element,.debug-info",listeners:{start(Q){if(i?.locked)return!1;h.domElement.classList.add("dragging"),h.domElement.style.cursor="grabbing"},move(Q){if(i?.locked)return!1;if(!Q.target)return;let it=[Q.target];Q.target.classList.contains("selected")?it=[...document.querySelectorAll(".component.selected")]:document.querySelectorAll(".component.selected").forEach(f=>f.classList.remove("selected"));for(let f of it){const S=(parseFloat(f.style.left)||0)+Q.dx/i.scale,c=(parseFloat(f.style.top)||0)+Q.dy/i.scale;f.style.left=S+"px",f.style.top=c+"px",f._control.repaint()}},end(Q){if(i?.locked)return!1;h.repaint(!0),h.domElement.style.cursor="",setTimeout(()=>{h.workspace.saveAgent(),h.domElement.classList.remove("dragging")},200)}},modifiers:[],inertia:!0}).styleCursor(!1),$(u.querySelector(".svg-icon")).css("background-color","#000"),$(u.querySelector(".tpl-fa-icon")).css("color",this.drawSettings.color),this.domElement=A,this.workspace.domElement.appendChild(A),A.addEventListener("mousedown",function(Q){Q.stopPropagation()}),A.addEventListener("click",function(Q){Q.stopPropagation()}),ei(A).resizable({edges:{left:!1,right:!0,bottom:!1,top:!1},listeners:{start(Q){if(i?.locked||[...h.domElement.querySelectorAll(".pinned")].length>0)return!1;h.domElement.classList.add("resizing")},move(Q){if(i?.locked||[...h.domElement.querySelectorAll(".pinned")].length>0)return!1;const it=Q.target;it.style.width=Q.rect.width/i.scale+"px",h.repaint()},end(Q){if(i?.locked||[...h.domElement.querySelectorAll(".pinned")].length>0)return!1;h.repaint(),setTimeout(()=>{h.workspace.saveAgent(),h.domElement.classList.remove("resizing")},200)}},modifiers:[ei.modifiers.restrictSize({min:{width:100,height:50}})],inertia:!1}),A._control=this,this.checkSettings(),a&&(setTimeout(()=>{this.workspace.saveAgent()},300),!this.properties.template&&this.drawSettings.showSettings&&this.editSettings()),this.emit("componentCreated",this),A}async delete(a=!0,i=!0){const h=this.workspace.jsPlumbInstance,j=this.domElement;if(a||await Ti("Are you sure you want to delete this component?","This action cannot be undone. Deleting will remove the component permanently.",{btnYesLabel:"Yes, Delete",btnNoLabel:"No, Cancel",btnYesClass:"bg-smyth-red-500 border-smyth-red-500"})){if(this.settingsOpen&&this.closeSettings(!0),this.showOverlay("Deleting..."),this.emit("beforeDelete",this),!await this.clean()){this.hideOverlay();return}const C=[...j.querySelectorAll(".output-endpoint"),...j.querySelectorAll(".input-endpoint"),...j.querySelectorAll(".agent-card-connection")].map(_=>h.getEndpoints(_)).flat(),A=[];for(let _ of C)A.push(_);A.forEach(_=>h.deleteEndpoint(_)),this.destroy();const s=document.querySelector(`.debug-box[rel="${this.uid}"]`);if(s){const _=s._connection;_&&h.deleteConnection(_),s.remove()}document.querySelectorAll(".component").forEach(_=>_.classList.remove("selected","unselected")),delete Mr[this.uid],i&&this.workspace.saveAgent(),this.hideOverlay()}}async addInputDialog(){const a={name:{type:"text",label:"Input Name",class:"stg-input stg-name",value:"",required:!0,validate:"required custom=isValidInputName",validateMessage:"Name is required and can only contain letters, numbers, and underscores.",attributes:{placeholder:"E.g. Username"}},...Wo({compName:this.constructor.name,values:{type:"Any"}}),additionalOptionsLabel:{type:"div",html:'<small class="field-hint">Choose whether this input is mandatory or optional. You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:qi(`${Fe.conEndColor}`),optional:Xo()};for(let C in this.inputSettings){const A=this.inputSettings[C];A&&(a[C]={...A.editConfig,value:A.editConfig?.defaultVal||""})}const i=this.constructor.name===Jn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Input</span>':'<span class="text-xl">Add Input</span>';a?.description&&(a.description.section="Advanced_Options");const h=Bi(a,["name","type","description","additionalOptionsLabel","optional","color"]),j=await this.inputEditor({title:i,fields:h,onDOMReady:C=>{const A=C.querySelector("#name"),s=C.querySelector(".agent-skill-dialog-title"),_=document.querySelector("#add-skill-input-info-icon");s&&_&&(_.classList.remove("hidden"),s.appendChild(_)),ye(50).then(()=>Oi(A))},contentClasses:"min-h-[425px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(j?.name){const C=await this.addInput(this.inputContainer,j.name,j);if(j.optional&&(C.setAttribute("smt-optional",j.optional),j.optional?C.classList.add("optional"):C.classList.remove("optional")),C&&j.color){C.setAttribute("smt-color",j.color),C.querySelector(".ep").style.backgroundColor=j.color||`${Fe.conEndColor}`,C.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${j.color}) 1`;const A=C.endpoint;if(A&&A.connections)for(let s of A.connections)this.workspace.updateConnectionColors(s)}C?.setAttribute("smt-type",j?.type||""),C?.setAttribute("smt-friendly-input-type",j?.friendlyInputType||""),C?.setAttribute("smt-core-input-type",j?.coreInputType||"");for(let A in this.inputSettings){const s=this.inputSettings[A];if(C&&s){const _=C.getAttribute(`smt-${A}`);j[A]!==_&&j[A]!=null&&C.setAttribute(`smt-${A}`,j[A])}}this.repaint(),this.workspace.saveAgent()}}async addOutputDialog(){const a={name:{type:"text",label:"Output Name",class:"stg-input stg-name",value:"",validate:"required custom=isValidOutputName",validateMessage:"Name is required and allow JSON path notation, e.g., Response.text, items[0], data['key'], etc."},additionalOptionsLabel:{type:"div",html:'<small class="field-hint">You can also assign a color label to this input for better organization or categorization.</small>',section:"Advanced_Options",formControlCls:"bg-white"},color:qi(`${Fe.conStartColor}`)};for(let C in this.outputSettings){const A=this.outputSettings[C];A&&(a[C]={...A.editConfig,value:A.editConfig?.defaultVal||""})}a?.description&&(a.description.section="Advanced_Options");const i=this.constructor.name===Jn.apiEndpoint?'<span class="text-xl agent-skill-dialog-title">Add Skill Output</span>':'<span class="text-xl">Add Output</span>',h=Bi(a,["description","expression","additionalOptionsLabel","color"]),j=await this.inputEditor({title:i,fields:h,onDOMReady:C=>{const A=C.querySelector("#name"),s=C.querySelector(".agent-skill-dialog-title"),_=document.querySelector("#add-skill-input-info-icon");s&&_&&(_.classList.remove("hidden"),s.appendChild(_)),ye(50).then(()=>Oi(A))},contentClasses:"min-h-[335px]",dialogClasses:"dialog-center rounded-[18px] p-2 pb-3",showCloseButton:!0});if(j?.name){const C=await this.addOutput(this.outputContainer,j.name,j);if(C&&j.color){C.setAttribute("smt-color",j.color),C.querySelector(".ep").style.backgroundColor=j.color||`${Fe.conStartColor}`,C.querySelector(".name").style.borderImage=`linear-gradient(90deg, transparent 20%, ${j.color}) 1`;const A=C.endpoint;if(A&&A.connections)for(let s of A.connections)this.workspace.updateConnectionColors(s)}for(let A in this.outputSettings){const s=this.outputSettings[A];if(C&&s){const _=C.getAttribute(`smt-${A}`);j[A]!==_&&j[A]!=null&&C.setAttribute(`smt-${A}`,j[A])}}this.repaint()}}async openDebugDialog(a,i="step"){Ze.track("app_debug_inject_click",{}),a.stopPropagation(),a.stopImmediatePropagation();const h=this.domElement.querySelector(".btn-debug"),j=[...this.domElement.querySelectorAll(".input-endpoint")].map(A=>({name:A.getAttribute("smt-name"),type:A.getAttribute("smt-isfile")=="true"||Xa.includes(A.getAttribute("smt-type"))?"file":"text"})),C=[...this.domElement.querySelectorAll(".output-endpoint")].map(A=>({name:A.getAttribute("smt-name")}));return new Promise((A,s)=>{this.workspace.debugger.createDebugInjectDialog(this,j,C,async _=>{if(this.workspace.debugger.getDebugSessionID())return null;Nr({step:{enable:!1},run:i==="run"?{enable:!0,icon:"mif-pause",tooltipText:"Pause"}:{enable:!1},stop:{enable:i!=="run"},attach:{enable:!1}});const u=this.workspace.agent;try{this.workspace.domElement.classList.add("debugging"),h.classList.add("active"),await this.workspace.debugger.injectComponentDebugInfo(u.id,this._uid,_);const o=await this.workspace.debugger.readDebugStep(u.id);return A({status:"success"}),o}catch(o){return o&&o?.status==413&&de("Payload Too Large","","alert"),de("Something went wrong, please try again later!","","alert"),s({status:"error"}),{errorOccurred:!0}}finally{ds()}},i)})}exportTemplate(){return null}export(){const a=this,i=this.domElement;return{id:i.id,name:i.querySelector(".title-bar").getAttribute("smt-name"),outputs:[...i.querySelectorAll(".output-endpoint")].map((h,j)=>({name:h.getAttribute("smt-name"),color:h.getAttribute("smt-color"),...workspace.extractComponentOutputProps(i,h),index:j,uuid:h.endpoint?.getUuid(),default:a.properties.defaultOutputs.includes(h.getAttribute("smt-name"))})),inputs:[...i.querySelectorAll(".input-endpoint")].map((h,j)=>({name:h.getAttribute("smt-name"),type:h.getAttribute("smt-type"),friendlyInputType:h.getAttribute("smt-friendly-input-type"),coreInputType:h.getAttribute("smt-core-input-type"),color:h.getAttribute("smt-color"),optional:h.getAttribute("smt-optional")==="true",...workspace.extractComponentInputProps(i,h),index:j,uuid:h.endpoint?.getUuid(),default:a.properties.defaultInputs.includes(h.getAttribute("smt-name"))})),data:typeof a.data=="object"?JSON.parse(JSON.stringify(a.data)):a.data,top:i.style.top,left:i.style.left,width:i.style.width,height:i.style.height,displayName:a.drawSettings.displayName,title:a.title,aiTitle:a.aiTitle,description:a.description,template:typeof a.properties.template=="object"?JSON.parse(JSON.stringify(a.properties.template)):a.properties.template}}async updateTitle(){const a=this.settingsEntries,i=document.querySelector("#right-sidebar form"),h=Ui(i,a),j=Wa("Generating Title..."),C=this.domElement.querySelector(".title-bar .title"),A=C.querySelector(".text"),s=C.querySelector(".btn-edit-inline");A.style.display="none",s.style.display="none",C.appendChild(j);try{const _=await this.generateTitle(h?.prompt);_&&(this.aiTitle=_,A.textContent=_)}finally{j.remove(),A.style.display="inline",s.style.display="inline-flex"}}async generateTitle(a){if(!(!a||typeof a!="string"))try{const i=await(await fetch("/api/page/builder/data/generate-component-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:a})})).json();if(!i?.success)throw new Error("Error generating title!");return i?.data}catch{return""}}}function Bi(g,a){const i={...g};let h={};for(let j of a)i[j]&&(h[j]=i[j],delete i[j]);return h={...h,...i},h}function Tu({value:g="",label:a=""}){const i=[{value:"Text",text:"Text",classes:{check:"svg-icon Text border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Image",text:"Image",classes:{check:"svg-icon Image border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Audio",text:"Audio",classes:{check:"svg-icon Audio border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Video",text:"Video",classes:{check:"svg-icon Video border-0 rounded-none w-6 h-6",caption:"text-base"}},{value:"Others",text:"Others",classes:{check:"svg-icon Others border-0 rounded-none w-6 h-6",caption:"text-base"}}];for(let[h,j]of i.entries())j.classes.radio=j.value===g?"active":"",i[h]=j;return ye(100).then(()=>{if(g==="Others"){const h=document.querySelector('[data-field-name="coreInputType"]'),j=document.getElementById("type");h?.classList?.remove("hidden");const C=document.getElementById("coreInputType");j&&(j.value=C?.value||"Any")}}),{type:"radio",label:a,class:"stg-input stg-type",formControlCls:"flex justify-between bg-white",fieldCls:"border border-solid border-[#D9D9D9] rounded-lg p-3 h-auto",value:g,options:i,events:{change:h=>{const j=h.target,C=j.value,A=document.querySelector('[data-field-name="coreInputType"]'),s=document.getElementById("type");if(C==="Others"){A?.classList?.remove("hidden");const u=document.getElementById("coreInputType");s&&(s.value=u?.value||"Any")}else A?.classList?.add("hidden"),s&&(s.value=C);j.closest(".form-group").querySelectorAll(".radio")?.forEach(u=>u.classList.remove("active"));const _=j.closest(".radio");_&&_.classList.add("active")}}}}function Yo({value:g="",label:a="",classes:i=""}){return{type:"select",class:i,label:a,value:g,options:[{value:"Any",text:"Any"},{value:"String",text:"String"},{value:"Number",text:"Number (can include floating point)"},{value:"Integer",text:"Integer (without a fraction part)"},{value:"Boolean",text:"Boolean"},{value:"Array",text:"Array"},{value:"Object",text:"Object"},{value:"Binary",text:"Binary"},{value:"Date",text:"Date (ISO 8601 Standard)"}],events:{change:h=>{const j=h.target.value,C=document.getElementById("type");C&&(C.value=j)}}}}function qi(g=""){return{type:"color",class:"w-44 stg-input stg-color stg-circle-color-picker",value:g,section:"Advanced_Options",fieldsGroup:"additionalOptions"}}function Xo(g=!1,a=!1){return{type:"radio",label:"",value:g,section:"Advanced_Options",class:"w-2/4 stg-input stg-optional",fieldsGroup:"additionalOptions",readonly:a,options:[{value:!1,text:"Required"},{value:!0,text:"Optional"}]}}function Wo({compName:g,values:a}){return g===Jn.apiEndpoint?{friendlyInputType:Tu({value:a.friendlyInputType,label:"Input type"}),coreInputType:Yo({value:a.coreInputType,classes:"w-full h-12 hidden"}),type:{type:"hidden",class:"stg-input stg-type",value:a.type,attributes:{"data-cls-option":"option-input-type"}}}:{coreInputType:Yo({value:a.coreInputType,label:"Input type",classes:"w-full"}),type:{type:"hidden",class:"stg-input stg-type",value:a.type,attributes:{"data-cls-option":"option-input-type"}}}}function Mu({keyName:g,component:a,onSuccess:i,onError:h}){const j={keyName:{label:"Name",type:"text",class:"w-2/5",value:g,readonly:!0},apiKey:{label:"Key",type:"textarea",fieldCls:"max-h-64 min-h-[34px] h-[34px] px-3 py-1",class:"w-3/5",validate:"required maxlength=10000",validateMessage:"API Key is required",value:"",autoSize:!1,attributes:{placeholder:"Please enter your Key"}}},C="_add_missing_key_submit_btn",A="_mock_data_btn",s=async(o,m)=>{const{keyName:D,apiKey:L}=o,k=tl("white","mr-2"),v=m.querySelector(`.${C}`);v.textContent="Adding Key...",v.prepend(k),v.disabled=!0;try{const l=["All"],z=await fetch(`${el.env.UI_SERVER}/api/page/builder/keys`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyName:D,key:L,scope:l})}).then(q=>q.json());Gi(m),i({[z?.data?.keyId]:{name:D,scope:l}})}catch{h()}finally{k.remove(),v.disabled=!1,v.textContent="Add Key"}},_={label:"Skip for now and set mock data",cssClass:`underline hover:no-underline text-gray-500 ${A}`,callback:async(o,m)=>{const D=v=>(v+Math.random()).toString(36).replace(".",""),L=`sos-mock-key-${D(Date.now())}-${D(123456789)}`,k=m.querySelector("#apiKey");k.value=L,await s({...o,apiKey:L},m),Ze.track("app_mock_screen_impression",{source:"skip_and_set_mock_data"}),await ps(a),Qn.turnOn(a),await Rr(a)}},u={label:"Continue",cssClass:`disabled:opacity-50 bg-v2-blue hover:bg-v2-blue/80 text-white cursor-pointer ml-auto mt-2 ${C}`,requiresValidation:!0,callback:s};Jo({title:"Configure API Key",fields:j,content:`<span class="text-xs text-gray-500 block mb-4">The component <span class="font-bold">${a?.title||""}</span> requires an API key to function. Please retrieve your API key from the provider and securely store it in the SmythOS vault.</span>`,actions:[_,u],onCloseClick:(o,m)=>{Gi(m)},onDOMReady:async o=>{const m=o.querySelector(`.${C}`);m.classList.remove("w-[340px]"),m.classList.add("w-40");const D=o.querySelector(`.${A}`);D?.classList.remove("w-[340px]"),D?.classList.remove("text-white"),D?.classList.remove("hover:opacity-75"),D?.classList.add("auto");const L=o.querySelector(".__actions");L?.classList.remove("justify-center"),L?.classList.add("justify-between")}},"auto","auto","none","672px","672px")}function Lr(g){return"_comp_message_"+g.replace(/\+/g,"_").replace(/\s+/g,"_").toLowerCase()}function ju(g,a){Mu({keyName:g,component:this,onSuccess:i=>{de("Key saved successfully","Success","success"),this?.clearComponentMessage(`.${Lr(g)}`),Qa(i);const h=this.workspace?.agent?.data?.components.map(j=>{const C=j.data,A=[];for(const s in C){let _=C[s];if(!_||(_=typeof _=="object"?JSON.stringify(_):_,typeof _!="string"))continue;const u=/{{KEY\(([^}]*)\)}}/g;let o;for(;(o=u.exec(_))!==null;)if(o[1]){const m=o[1];(m===g||m.replace(/\+/g," ")===g)&&A.push({id:j.id,keyName:m})}}return A}).flat(1/0).filter(j=>j.id);h.length>0&&h.forEach(async({id:j,keyName:C})=>{await Mr[j]?.checkSettings()})},onError:()=>{de("Error saving key, please try again or contact support.","Error","alert")}})}let cn;async function xn(g,a={},i,h){Re.curComponentSettings&&await Re.curComponentSettings.closeSettings(),cn.domElement.classList.contains("debug-enabled");const j=document.querySelector("#embodiment-sidebar").querySelector(".title");let C;if(g)C=await il(i,g,a,h);else{C=await rl();const A=ol(i,h);j.innerHTML=A}C.querySelector("button.close-btn")?.classList?.remove("hidden")}async function Lu(){cn.agent.domain,cn.serverData.agent_domain.includes(":");{xn('<div class="p-4">Agent domain is not set. Cannot provide chatGPT configuration</div>',{},"ChatGPT deployment instructions");return}}async function Iu(){cn.agent.domain,cn.serverData.agent_domain.includes(":");{xn('<div class="p-4">Agent domain is not set. Cannot provide Postman features</div>',{},Be.api.title,Be.api.tooltipTitle);return}}async function Nu(){const g="",a=document.querySelector(".modalBox");a&&(a.style.width="600px");let i=document.querySelector("#chatbot-iframe"),h,j={};const C=`${g}/chatBot?allowAttachments=true`,A=`chatbot-spinner-${Date.now()}`,s='<span class="mif-refresh text-[#757575] hover:text-[#374151] cursor-pointer flex items-center justify-center w-4 h-4"></span>',_=`<svg class="w-4 h-4 animate-spin cursor-default flex items-center justify-center" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
    <path fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
  </svg>`;(!i||i.src!=C)&&(h=`
      <div class="p-4 h-full">
        <div class="flex items-center gap-2">
          <p class="text-gray-700">${Be.chat.description}</p>
        </div>
        <div id="${A}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
        <iframe src="${C}" id="chatbot-iframe" frameborder="0" style="width:100%;height:calc(100% - 2rem);"></iframe>
      </div>
    `,j={Refresh:{click:async o=>{const m=document.querySelector(".refresh-chat-btn"),D=document.querySelector("#chatbot-iframe");if(D&&m&&!m.classList.contains("loading")){m.classList.add("loading"),m.style.pointerEvents="none",m.style.opacity="0.7",m.innerHTML=_;const L=()=>{m.innerHTML=s,m.classList.remove("loading"),m.style.pointerEvents="auto",m.style.opacity="1",D.removeEventListener("load",L)};D.addEventListener("load",L),D.src+=""}},label:`<span class="refresh-chat-btn loading flex items-center justify-center w-4 h-4" style="pointer-events: none; opacity: 0.7;">${_}</span>`,tooltip:"Refresh chat session",tooltipPlacement:"left"}}),await xn(h,j,Be.chat.title,Be.chat.tooltipTitle),i=document.querySelector("#chatbot-iframe");const u=document.getElementById(A);i&&i.addEventListener("load",async()=>{u&&u.style.setProperty("display","none","important"),i.style.display="block";const o=document.querySelector(".refresh-chat-btn");o&&(o.innerHTML=s,o.classList.remove("loading"),o.style.pointerEvents="auto",o.style.opacity="1"),await ye(200),cn.debugger.stopDebugSession(),fs.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["chatbot"])})}async function Fu(){const g="",a=document.querySelector(".modalBox");a&&(a.style.width="800px");const i=`${g}/swagger`,h=`swagger-spinner-${Date.now()}`,j=`
    <div class="p-4 h-full">
      <div class="flex items-center gap-2 mb-4">
        <p class="text-gray-700">${Be.api.description}</p>
      </div>
      <div id="${h}" class="flex items-center justify-center" style="height: calc(100% - 3rem);">
        <div role="status">
          <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#0366d6" stroke-width="4" fill="none"></circle>
            <path  fill="none" stroke="white" stroke-width="4" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <iframe src="${i}" id="swagger-iframe" frameborder="0" style="width:100%;height:calc(100% - 3rem);display:none;"></iframe>
    </div>
  `;await xn(j,{},Be.api.title,Be.api.tooltipTitle);const C=document.querySelector("#swagger-iframe"),A=document.getElementById(h);C&&C.addEventListener("load",async()=>{A&&A.style.setProperty("display","none","important"),C.style.display="block",await ye(200),fs.send({function:"attachHeaders",args:[{"X-MONITOR-ID":window.currentMonitorId}]},["swagger"])})}async function Ru(){Ze.track("mcp_embodiment_click",{position:"top right of builder inside dropdown"}),cn.serverData.agent_domain.includes(":"),cn.agent.domain;{xn('<div class="p-4">Agent domain is not set. Cannot provide MCP features</div>',{},Be.mcp.title,Be.mcp.tooltipTitle);return}}async function Bu(){const g=document.querySelector(".modalBox");g&&(g.style.width="800px");const a="skill-preview-sidebar-root",i=`
    <div class="p-4 h-full">
      <div id="${a}"></div>
    </div>`;await xn(i,{},Be.agent_skill.title,Be.agent_skill.tooltipTitle),sl({rootID:a})}nl({openEmbodimentDialog:xn,openChatGPTEmbodiment:Lu,openPostmanEmbodiment:Iu,openChatbotEmbodiment:Nu,openAPIEmbodiment:Fu,openFormPreviewEmbodiment:Bu,openMCPEmbodiment:Ru});export{Fu as openAPIEmbodiment,Lu as openChatGPTEmbodiment,Nu as openChatbotEmbodiment,xn as openEmbodimentDialog,Ru as openMCPEmbodiment,Iu as openPostmanEmbodiment};
