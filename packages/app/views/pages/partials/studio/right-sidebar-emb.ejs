<div
  class="z-10 right-sidebar border border-gray-300/80 border-solid rounded-lg embodiment h-full pb-4 hidden"
  x-data="embodimentSidebar()"
  x-bind:style="'width: ' + width"
  id="embodiment-sidebar"
>
  <div class="container flex flex-col h-full">
    <div class="dialog-title flex">
      <div class="inline-flex w-full overflow-hidden" role="group">
        <div
          class="title flex items-center flex-1 text-base font-semibold overflow-hidden min-w-0"
        ></div>

        <!-- <div class="title-left-buttons inline-flex text-sm"></div>
        <div class="title-right-buttons inline-flex" dir="rtl">
          <div class="dialog-actions actions m-0 flex">
            <div class="action-buttons w-full inline-flex justify-end px-0 m-0">
              <div class="action-content w-full flex"></div>
            </div>
          </div>
          <button
            type="button"
            class="close-btn items-center py-2 text-xs font-medium text-gray-900 bg-transparent hover:text-gray-600 active:text-gray-900 focus:z-10"
          >
            <span class="mif-cross"></span>
          </button>
        </div> -->
      </div>
    </div>
    <div class="tab-container border-b border-gray-200 order-2 py-3 px-4 relative">
      <nav
        class="flex -mb-px items-center overflow-hidden justify-between mr-6"
        aria-label="Tabs"
      ></nav>
      <!-- More tabs dropdown button -->
      <button
        id="tab-more-button"
        class="hidden inline-flex items-center pt-2 pb-1 mb-1 text-sm font-medium text-gray-500 hover:text-gray-700 ml-2 flex-shrink-0"
        aria-label="More tabs"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24 ">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"
          />
        </svg>
      </button>
      <!-- Dropdown menu for overflow tabs -->
      <div
        id="tab-dropdown-menu"
        class="hidden absolute right-4 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[120px]"
      >
        <div class="py-1" role="menu" aria-orientation="vertical"></div>
      </div>
    </div>
    <div class="dialog-content content flex-grow overflow-y-auto overflow-x-hidden"></div>
  </div>
</div>

<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('embodimentSidebar', () => ({
      width: '520px',
      init() {
        this.checkWidth();
        window.addEventListener('sidebarStateChanged', () => {
          const sidebarEl = document.getElementById('embodiment-sidebar');
          if (sidebarEl && sidebarEl.offsetParent !== null) {
            this.checkWidth();
          }
        });
        // Listen for resize events to update width in real-time
        window.addEventListener('rightSidebarResized', (event) => {
          this.width = event.detail.width;
        });
      },
      checkWidth() {
        const DEFAULT_WIDTH = '520px';
        let storedWidth = localStorage.getItem('right-sidebar-common-width') || DEFAULT_WIDTH;

        // Validate width doesn't exceed half screen
        if (parseInt(storedWidth) > window.innerWidth / 2) {
          storedWidth = DEFAULT_WIDTH;
          localStorage.setItem('right-sidebar-common-width', storedWidth);
        }
        this.width = storedWidth;
      },
    }));
  });
</script>
